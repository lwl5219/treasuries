<div id="pf3df" class="pf w2 h11" data-page-no="3df"><div class="pc pc3df w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg3df.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">990<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>11<span class="_ _3d"> </span>Network<span class="_ _10"> </span>Programming</span></div><div class="t m5 x1d h31 y390 ff7 fs21 fc2 sc0 ls0 ws0">Environment<span class="_"> </span>variable<span class="_ _78"> </span>Description</div><div class="t m5 x1d h31 yc94 ff7 fs21 fc2 sc0 ls0 ws0">QUER<span class="_ _3"></span>Y_STRING<span class="_ _bd"> </span>Program<span class="_"> </span>arguments</div><div class="t m5 x1d h31 yc96 ff7 fs21 fc2 sc0 ls0 ws0">SER<span class="_ _3"></span>VER_POR<span class="_ _0"></span>T<span class="_ _1b4"> </span>P<span class="_ _0"></span>ort<span class="_"> </span>that<span class="_"> </span>the<span class="_"> </span>parent<span class="_"> </span>is<span class="_"> </span>listening<span class="_"> </span>on</div><div class="t m5 x1d h31 y5521 ff7 fs21 fc2 sc0 ls0 ws0">REQUEST_METHOD<span class="_ _26"> </span>GET<span class="_"> </span>or<span class="_"> </span>POST</div><div class="t m5 x1d h31 y5522 ff7 fs21 fc2 sc0 ls0 ws0">REMOTE_HOST<span class="_ _71"> </span>Domain<span class="_"> </span>name<span class="_"> </span>of<span class="_"> </span>client</div><div class="t m5 x1d h31 y5683 ff7 fs21 fc2 sc0 ls0 ws0">REMOTE_ADDR<span class="_ _7e"> </span>Dotted-decimal<span class="_"> </span>IP<span class="_"> </span>address<span class="_"> </span>of<span class="_"> </span>client</div><div class="t m5 x1d h31 y5684 ff7 fs21 fc2 sc0 ls0 ws0">CONTENT_TYPE<span class="_ _7e"> </span>POST<span class="_"> </span>only:<span class="_"> </span>MIME<span class="_"> </span>type<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>request<span class="_"> </span>body</div><div class="t m5 x1d h31 y5685 ff7 fs21 fc2 sc0 ls0 ws0">CONTENT_LENGTH<span class="_ _1f9"> </span>POST<span class="_"> </span>only:<span class="_"> </span>Size<span class="_"> </span>in<span class="_"> </span>bytes<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>request<span class="_"> </span>body</div><div class="t m5 x1d h2f y298e ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>11.26<span class="_ _66"> </span><span class="fc1">Examples<span class="_"> </span>of<span class="_"> </span>CGI<span class="_"> </span>environment<span class="_"> </span>variables.</span></div><div class="t m5 x1d h26 y7d98 ff7 fs19 fc1 sc0 ls0 ws0">it<span class="_ _13"> </span>calls<span class="_"> </span><span class="ffd">fork<span class="_ _13"> </span></span>to<span class="_ _13"> </span>create<span class="_"> </span>a<span class="_ _13"> </span>child<span class="_ _13"> </span>process<span class="_"> </span>and<span class="_ _13"> </span>calls<span class="_ _13"> </span><span class="ffd">execve<span class="_ _10"> </span></span>to<span class="_ _13"> </span>run<span class="_ _13"> </span>the<span class="_"> </span><span class="ffd">/cgi-bin/adder</span></div><div class="t m5 x1d h26 y7d99 ff7 fs19 fc1 sc0 ls0 ws0">program<span class="_ _11"> </span>in<span class="_ _16"> </span>the<span class="_ _11"> </span>context<span class="_ _16"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>child.<span class="_ _16"> </span>Programs<span class="_ _11"> </span>like<span class="_ _16"> </span>the<span class="_ _11"> </span><span class="ffd">adder<span class="_ _16"> </span></span>program<span class="_ _11"> </span>are<span class="_ _11"> </span>often</div><div class="t m5 x1d h26 y7d9a ff7 fs19 fc1 sc0 ls0 ws0">referred<span class="_ _16"> </span>to<span class="_ _16"> </span>as<span class="_ _14"> </span><span class="ffa">CGI<span class="_ _16"> </span>programs<span class="_ _16"> </span></span>because<span class="_ _14"> </span>they<span class="_ _16"> </span>obey<span class="_ _16"> </span>the<span class="_ _16"> </span>rules<span class="_ _14"> </span>of<span class="_ _16"> </span>the<span class="_ _16"> </span>CGI<span class="_ _14"> </span>standard.</div><div class="t m5 x1d h26 y7d9b ff7 fs19 fc1 sc0 ls0 ws0">Before<span class="_ _16"> </span>the<span class="_ _16"> </span>call<span class="_ _16"> </span>to<span class="_ _14"> </span><span class="ffd">execve</span>,<span class="_ _14"> </span>the<span class="_ _16"> </span>child<span class="_ _16"> </span>process<span class="_ _16"> </span>sets<span class="_ _14"> </span>the<span class="_ _16"> </span>CGI<span class="_ _16"> </span>environment<span class="_ _16"> </span>variable</div><div class="t m5 x1d h26 y7d9c ff7 fs19 fc1 sc0 ls0 ws0">QUER<span class="_ _3"></span>Y_STRING<span class="_"> </span>to<span class="_ _13"> </span><span class="ffd">15000&amp;213</span>,<span class="_"> </span>which<span class="_"> </span>the<span class="_ _13"> </span><span class="ffd">adder<span class="_ _10"> </span></span>program<span class="_"> </span>can<span class="_"> </span>reference<span class="_ _13"> </span>at<span class="_"> </span>run</div><div class="t m5 x1d h26 y7d9d ff7 fs19 fc1 sc0 ls0 ws0">time<span class="_"> </span>using<span class="_"> </span>the<span class="_"> </span>Linux<span class="_"> </span><span class="ffd">getenv<span class="_ _10"> </span></span>function.</div><div class="t m5 x1d h42 y7d9e ff6 fs29 fc6 sc0 ls0 ws0">How<span class="_ _11"> </span>Does<span class="_ _16"> </span>the<span class="_ _16"> </span>Server<span class="_ _16"> </span>Pass<span class="_ _11"> </span>Other<span class="_ _16"> </span>Information<span class="_ _16"> </span>to<span class="_ _11"> </span>the<span class="_ _16"> </span>Child?</div><div class="t m5 x1d h26 y7d9f ff7 fs19 fc1 sc0 ls0 ws0">CGI<span class="_ _16"> </span>deÔ¨Ånes<span class="_ _16"> </span>a<span class="_ _16"> </span>number<span class="_ _16"> </span>of<span class="_ _14"> </span>other<span class="_ _16"> </span>environment<span class="_ _16"> </span>variables<span class="_ _16"> </span>that<span class="_ _16"> </span>a<span class="_ _14"> </span>CGI<span class="_ _16"> </span>program<span class="_ _16"> </span>can</div><div class="t m5 x1d h26 y7da0 ff7 fs19 fc1 sc0 ls0 ws0">expect<span class="_"> </span>to<span class="_"> </span>be<span class="_"> </span>set<span class="_"> </span>when<span class="_"> </span>it<span class="_"> </span>runs<span class="_ _1"></span>.<span class="_"> </span>F<span class="_ _1"></span>igure<span class="_"> </span>11.26<span class="_"> </span>shows<span class="_"> </span>a<span class="_"> </span>subset.</div><div class="t m5 x1d h42 y7da1 ff6 fs29 fc6 sc0 ls0 ws0">Where<span class="_ _11"> </span>Does<span class="_ _16"> </span>the<span class="_ _16"> </span>Child<span class="_ _11"> </span>Send<span class="_ _16"> </span>Its<span class="_ _16"> </span>Output?</div><div class="t m5 x1d h26 y7da2 ff7 fs19 fc1 sc0 ls0 ws0">A<span class="_ _14"> </span>CGI<span class="_ _15"> </span>program<span class="_ _15"> </span>sends<span class="_ _14"> </span>its<span class="_ _15"> </span>dynamic<span class="_ _15"> </span>content<span class="_ _14"> </span>to<span class="_ _15"> </span>the<span class="_ _14"> </span>standard<span class="_ _15"> </span>output.<span class="_ _15"> </span>Before<span class="_ _14"> </span>the</div><div class="t m5 x1d h26 y7da3 ff7 fs19 fc1 sc0 ls0 ws0">child<span class="_ _16"> </span>process<span class="_ _16"> </span>loads<span class="_ _14"> </span>and<span class="_ _16"> </span>runs<span class="_ _14"> </span>the<span class="_ _16"> </span>CGI<span class="_ _16"> </span>program,<span class="_ _15"> </span>it<span class="_ _16"> </span>uses<span class="_ _16"> </span>the<span class="_ _14"> </span>Linux<span class="_ _16"> </span><span class="ffd">dup2<span class="_ _14"> </span></span>function</div><div class="t m5 x1d h26 y7da4 ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_ _14"> </span>redirect<span class="_ _15"> </span>standard<span class="_ _15"> </span>output<span class="_ _14"> </span>to<span class="_ _15"> </span>the<span class="_ _15"> </span>connected<span class="_ _14"> </span>descriptor<span class="_ _15"> </span>that<span class="_ _15"> </span>is<span class="_ _14"> </span>associated<span class="_ _15"> </span>with</div><div class="t m5 x1d h26 y7da5 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _16"> </span>client.<span class="_ _16"> </span>T<span class="_ _1"></span>hus<span class="_ _1"></span>,<span class="_ _14"> </span>anything<span class="_ _16"> </span>that<span class="_ _16"> </span>the<span class="_ _16"> </span>CGI<span class="_ _16"> </span>program<span class="_ _16"> </span>writes<span class="_ _16"> </span>to<span class="_ _16"> </span>standard<span class="_ _11"> </span>output<span class="_ _16"> </span>goes</div><div class="t m5 x1d h26 y7da6 ff7 fs19 fc1 sc0 ls0 ws0">directly<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>client.</div><div class="t m5 x29 h26 y7da7 ff7 fs19 fc1 sc0 ls0 ws0">Notice<span class="_ _13"> </span>that<span class="_ _13"> </span>since<span class="_ _13"> </span>the<span class="_ _13"> </span>parent<span class="_ _13"> </span>does<span class="_ _13"> </span>not<span class="_ _13"> </span>know<span class="_ _13"> </span>the<span class="_"> </span>type<span class="_ _13"> </span>or<span class="_ _13"> </span>size<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>content<span class="_ _13"> </span>that</div><div class="t m5 x1d h26 y7da8 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>child<span class="_"> </span>generates<span class="_ _3"></span>,<span class="_"> </span>the<span class="_"> </span>child<span class="_"> </span>is<span class="_ _13"> </span>responsible<span class="_"> </span>for<span class="_"> </span>generating<span class="_"> </span>the<span class="_ _13"> </span><span class="ffd">Content-type<span class="_ _10"> </span></span>and</div><div class="t m5 x1d h26 y7da9 ffd fs19 fc1 sc0 ls0 ws0">Content-length<span class="_ _11"> </span><span class="ff7">response<span class="_"> </span>headers<span class="_ _0"></span>,<span class="_ _11"> </span>as<span class="_ _11"> </span>well<span class="_ _11"> </span>as<span class="_"> </span>the<span class="_ _11"> </span>empty<span class="_ _11"> </span>line<span class="_ _11"> </span>that<span class="_ _11"> </span>terminates<span class="_ _11"> </span>the</span></div><div class="t m5 x1d h26 y7daa ff7 fs19 fc1 sc0 ls0 ws0">headers<span class="_ _1"></span>.</div><div class="t m5 x29 h26 y7dab ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_ _16"> </span>11.27<span class="_ _16"> </span>shows<span class="_ _16"> </span>a<span class="_ _11"> </span>simple<span class="_ _16"> </span>CGI<span class="_ _16"> </span>program<span class="_ _16"> </span>that<span class="_ _16"> </span>sums<span class="_ _11"> </span>its<span class="_ _16"> </span>two<span class="_ _16"> </span>arguments<span class="_ _16"> </span>and</div><div class="t m5 x1d h26 y7dac ff7 fs19 fc1 sc0 ls0 ws0">returns<span class="_ _11"> </span>an<span class="_ _16"> </span>HTML<span class="_ _11"> </span>Ô¨Åle<span class="_ _11"> </span>with<span class="_ _16"> </span>the<span class="_ _11"> </span>result<span class="_ _11"> </span>to<span class="_ _16"> </span>the<span class="_ _11"> </span>client.<span class="_ _11"> </span>Figure<span class="_"> </span>11.28<span class="_ _16"> </span>shows<span class="_ _11"> </span>an<span class="_ _16"> </span>HTTP</div><div class="t m5 x1d h26 y7dad ff7 fs19 fc1 sc0 ls0 ws0">transaction<span class="_"> </span>that<span class="_"> </span>serves<span class="_"> </span>dynamic<span class="_"> </span>content<span class="_"> </span>from<span class="_"> </span>the<span class="_"> </span><span class="ffd">adder<span class="_ _10"> </span></span>program.</div><div class="t m5 x1d h47 ybdf ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>11.5<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>1005)</span></div><div class="t m5 x1d h26 y2270 ff7 fs19 fc1 sc0 ls0 ws0">Assume<span class="_"> </span>that<span class="_"> </span>a<span class="_ _11"> </span>CGI<span class="_"> </span>program<span class="_"> </span>needs<span class="_ _11"> </span>to<span class="_"> </span>send<span class="_ _11"> </span>dynamic<span class="_"> </span>content<span class="_"> </span>to<span class="_ _11"> </span>the<span class="_"> </span>client.<span class="_"> </span>This<span class="_"> </span>is</div><div class="t m5 x1d h26 y7dae ff7 fs19 fc1 sc0 ls0 ws0">typically<span class="_ _6"> </span>done<span class="_ _13"> </span>by<span class="_ _a"> </span>making<span class="_ _13"> </span>the<span class="_ _6"> </span>CGI<span class="_ _6"> </span>program<span class="_ _13"> </span>send<span class="_ _6"> </span>its<span class="_ _6"> </span>content<span class="_ _13"> </span>to<span class="_ _6"> </span>the<span class="_ _6"> </span>standard<span class="_ _13"> </span>output.</div><div class="t m5 x1d h26 y7daf ff7 fs19 fc1 sc0 ls0 ws0">Explain<span class="_"> </span>how<span class="_"> </span>this<span class="_"> </span>content<span class="_"> </span>is<span class="_"> </span>sent<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>client.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
