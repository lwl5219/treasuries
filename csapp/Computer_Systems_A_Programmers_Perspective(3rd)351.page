<div id="pf15f" class="pf w2 h11" data-page-no="15f"><div class="pc pc15f w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg15f.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">350<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>3<span class="_ _3d"> </span>Machine-Level<span class="_ _10"> </span>Representation<span class="_ _10"> </span>of<span class="_ _10"> </span>Programs</span></div><div class="t m5 x1c5 h2d ye7 ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">/*<span class="_ _1f"> </span>Enumerated<span class="_ _e"> </span>type<span class="_ _1f"> </span>creates<span class="_ _1f"> </span>set<span class="_ _e"> </span>of<span class="_ _1f"> </span>constants<span class="_ _e"> </span>numbered<span class="_ _1f"> </span>0<span class="_ _1f"> </span>and<span class="_ _e"> </span>upward<span class="_ _1f"> </span>*/</span></div><div class="t m5 x1c5 h2d yc4d ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _1c"> </span><span class="ffd fs1e fc2">typedef<span class="_ _1f"> </span>enum<span class="_ _e"> </span>{MODE_A,<span class="_ _1f"> </span>MODE_B,<span class="_ _1f"> </span>MODE_C,<span class="_ _e"> </span>MODE_D,<span class="_ _1f"> </span>MODE_E}<span class="_ _e"> </span>mode_t;</span></div><div class="t m5 x1c5 h2e yecb ff6 fs20 fc6 sc0 ls0 ws0">3</div><div class="t m5 x1c5 h2e y31ac ff6 fs20 fc6 sc0 ls0 ws0">4</div><div class="t m5 x17e h2d yecc ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>switch3(long<span class="_ _1f"> </span>*p1,<span class="_ _1f"> </span>long<span class="_ _e"> </span>*p2,<span class="_ _1f"> </span>mode_t<span class="_ _e"> </span>action)</div><div class="t m5 x1c5 h2d yecd ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x1c5 h2d yece ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _20"> </span><span class="ffd fs1e fc2">long<span class="_ _e"> </span>result<span class="_ _1f"> </span>=<span class="_ _1f"> </span>0;</span></div><div class="t m5 x1c5 h2d yecf ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _20"> </span><span class="ffd fs1e fc2">switch(action)<span class="_ _e"> </span>{</span></div><div class="t m5 x1c5 h2d yed0 ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _20"> </span><span class="ffd fs1e fc2">case<span class="_ _e"> </span>MODE_A:</span></div><div class="t m5 x1c5 h2e y20fe ff6 fs20 fc6 sc0 ls0 ws0">9</div><div class="t m5 x22a h2e y31ad ff6 fs20 fc6 sc0 ls0 ws0">10</div><div class="t m5 xc2 h2d yed3 ffd fs1e fc2 sc0 ls0 ws0">case<span class="_ _e"> </span>MODE_B:</div><div class="t m5 x22a h2e yed4 ff6 fs20 fc6 sc0 ls0 ws0">11</div><div class="t m5 x22a h2e y31ae ff6 fs20 fc6 sc0 ls0 ws0">12</div><div class="t m5 xc2 h2d y462 ffd fs1e fc2 sc0 ls0 ws0">case<span class="_ _e"> </span>MODE_C:</div><div class="t m5 x22a h2e y26dd ff6 fs20 fc6 sc0 ls0 ws0">13</div><div class="t m5 x22a h2e y31af ff6 fs20 fc6 sc0 ls0 ws0">14</div><div class="t m5 xc2 h2d y2651 ffd fs1e fc2 sc0 ls0 ws0">case<span class="_ _e"> </span>MODE_D:</div><div class="t m5 x22a h2e yeab ff6 fs20 fc6 sc0 ls0 ws0">15</div><div class="t m5 x22a h2e y31b0 ff6 fs20 fc6 sc0 ls0 ws0">16</div><div class="t m5 xc2 h2d y19a5 ffd fs1e fc2 sc0 ls0 ws0">case<span class="_ _e"> </span>MODE_E:</div><div class="t m5 x22a h2e y682 ff6 fs20 fc6 sc0 ls0 ws0">17</div><div class="t m5 x22a h2e y31b1 ff6 fs20 fc6 sc0 ls0 ws0">18</div><div class="t m5 xc2 h2d y19a9 ffd fs1e fc2 sc0 ls0 ws0">default:</div><div class="t m5 x22a h2e y418 ff6 fs20 fc6 sc0 ls0 ws0">19</div><div class="t m5 x22a h2e y31b2 ff6 fs20 fc6 sc0 ls0 ws0">20</div><div class="t m5 xc2 h2d y2a38 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x22a h2d y3ed ff6 fs20 fc6 sc0 ls0 ws0">21<span class="_ _20"> </span><span class="ffd fs1e fc2">return<span class="_ _e"> </span>result;</span></div><div class="t m5 x22a h2d y2656 ff6 fs20 fc6 sc0 ls0 ws0">22<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x29 h26 y31b3 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _13"> </span>part<span class="_ _13"> </span>of<span class="_ _6"> </span>the<span class="_ _13"> </span>generated<span class="_ _13"> </span>assembly<span class="_ _13"> </span>code<span class="_ _6"> </span>implementing<span class="_ _13"> </span>the<span class="_ _13"> </span>different<span class="_ _6"> </span>actions<span class="_ _13"> </span>is</div><div class="t m5 x1d h26 y31b4 ff7 fs19 fc2 sc0 ls0 ws0">shown<span class="_ _6"> </span>in<span class="_ _13"> </span>F<span class="_ _1"></span>igure<span class="_ _6"> </span>3.52.<span class="_ _13"> </span>T<span class="_ _1"></span>he<span class="_ _6"> </span>annotations<span class="_ _13"> </span>indicate<span class="_ _6"> </span>the<span class="_ _6"> </span>argument<span class="_ _13"> </span>locations<span class="_ _3"></span>,<span class="_ _13"> </span>the<span class="_ _6"> </span>register</div><div class="t m5 x1d h26 y31b5 ff7 fs19 fc2 sc0 ls0 ws0">values<span class="_ _1"></span>,<span class="_"> </span>and<span class="_"> </span>the<span class="_"> </span>case<span class="_"> </span>labels<span class="_"> </span>for<span class="_"> </span>the<span class="_"> </span>different<span class="_"> </span>jump<span class="_"> </span>destinations<span class="_ _1"></span>.</div><div class="t m5 x29 h26 y31b6 ff7 fs19 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>ill<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>missing<span class="_"> </span>parts<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>C<span class="_"> </span>code<span class="_ _1"></span>.<span class="_"> </span>It<span class="_"> </span>contained<span class="_"> </span>one<span class="_"> </span>case<span class="_"> </span>that<span class="_"> </span>fell<span class="_"> </span>through</div><div class="t m5 x1d h26 y31b7 ff7 fs19 fc2 sc0 ls0 ws0">to<span class="_"> </span>another<span class="_ _1"></span>—try<span class="_"> </span>to<span class="_"> </span>reconstruct<span class="_"> </span>this<span class="_ _1"></span>.</div><div class="t m5 x1d h73 y31b8 ffe fs1e fc6 sc0 ls0 ws0">3.63<span class="_ _23"> </span><span class="ff10 fs19">◆◆</span></div><div class="t m5 x1d h26 y31b9 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_"> </span>problem<span class="_ _13"> </span>will<span class="_"> </span>give<span class="_"> </span>you<span class="_ _13"> </span>a<span class="_"> </span>chance<span class="_ _13"> </span>to<span class="_"> </span>reverse<span class="_ _13"> </span>engineer<span class="_"> </span>a<span class="_"> </span><span class="ffd">switch<span class="_ _13"> </span></span>statement<span class="_"> </span>from</div><div class="t m5 x1d h26 y31ba ff7 fs19 fc1 sc0 ls0 ws0">disassembled<span class="_ _11"> </span>machine<span class="_ _11"> </span>code<span class="_ _0"></span>.<span class="_ _11"> </span>In<span class="_ _11"> </span>the<span class="_ _11"> </span>following<span class="_ _16"> </span>procedure<span class="_ _1"></span>,<span class="_ _11"> </span>the<span class="_ _16"> </span>body<span class="_"> </span>of<span class="_ _16"> </span>the<span class="_"> </span><span class="ffd">switch</span></div><div class="t m5 x1d h26 y31bb ff7 fs19 fc1 sc0 ls0 ws0">statement<span class="_"> </span>has<span class="_"> </span>been<span class="_"> </span>omitted:</div><div class="t m5 x1f h2d y31bc ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">long<span class="_ _1f"> </span>switch_prob(long<span class="_ _e"> </span>x,<span class="_ _1f"> </span>long<span class="_ _1f"> </span>n)<span class="_ _e"> </span>{</span></div><div class="t m5 x1f h2d y31bd ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _20"> </span><span class="ffd fs1e fc2">long<span class="_ _e"> </span>result<span class="_ _1f"> </span>=<span class="_ _1f"> </span>x;</span></div><div class="t m5 x1f h2e y31be ff6 fs20 fc6 sc0 ls0 ws0">3</div><div class="t m5 x33 h2d y31bf ffd fs1e fc2 sc0 ls0 ws0">switch(n)<span class="_ _e"> </span>{</div><div class="t m5 x1f h2d y31c0 ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _70"> </span><span class="ffd fs1e fc2">/*<span class="_ _e"> </span>Fill<span class="_ _1f"> </span>in<span class="_ _1f"> </span>code<span class="_ _e"> </span>here<span class="_ _1f"> </span>*/</span></div><div class="t m5 x1f h2e y31c1 ff6 fs20 fc6 sc0 ls0 ws0">5</div><div class="t m5 x1f h2e y31c2 ff6 fs20 fc6 sc0 ls0 ws0">6</div><div class="t m5 x33 h2d y31c3 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x1f h2d y31c4 ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _20"> </span><span class="ffd fs1e fc2">return<span class="_ _e"> </span>result;</span></div><div class="t m5 x1f h2d y31c5 ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
