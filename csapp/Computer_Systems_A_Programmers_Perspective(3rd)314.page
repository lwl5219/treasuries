<div id="pf13a" class="pf w2 h11" data-page-no="13a"><div class="pc pc13a w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg13a.png"/><div class="t m5 xf8 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>3.10<span class="_ _60"> </span>Combining<span class="_ _10"> </span>Control<span class="_ _10"> </span>and<span class="_ _10"> </span>Data<span class="_ _10"> </span>in<span class="_ _10"> </span>Machine-Level<span class="_ _10"> </span>Programs<span class="_ _3e"> </span><span class="ffe fs1e">313</span></div><div class="t m5 x17 h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">how<span class="_ _13"> </span>machine-level<span class="_"> </span>programs<span class="_ _13"> </span>implement<span class="_"> </span>cases<span class="_ _13"> </span>where<span class="_"> </span>the<span class="_ _13"> </span>amount<span class="_"> </span>of<span class="_ _13"> </span>stack<span class="_"> </span>storage</div><div class="t m5 x17 h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">required<span class="_"> </span>by<span class="_"> </span>a<span class="_"> </span>function<span class="_"> </span>can<span class="_"> </span>vary<span class="_"> </span>from<span class="_"> </span>one<span class="_"> </span>execution<span class="_"> </span>to<span class="_"> </span>another.</div><div class="t m5 x17 h41 y2cfc ffe fs29 fc2 sc0 ls0 ws0">3.10.1<span class="_ _48"> </span><span class="fs19">Understanding<span class="_"> </span>Pointers</span></div><div class="t m5 x17 h26 y2cfd ff7 fs19 fc2 sc0 ls0 ws0">P<span class="_ _1"></span>ointers<span class="_ _14"> </span>are<span class="_ _14"> </span>a<span class="_ _16"> </span>central<span class="_ _14"> </span>feature<span class="_ _14"> </span>of<span class="_ _14"> </span>the<span class="_ _16"> </span>C<span class="_ _14"> </span>programming<span class="_ _14"> </span>language<span class="_ _0"></span>.<span class="_ _16"> </span>They<span class="_ _16"> </span>serve<span class="_ _14"> </span>as<span class="_ _16"> </span>a</div><div class="t m5 x17 h26 y2cfe ff7 fs19 fc2 sc0 ls0 ws0">uniform<span class="_ _11"> </span>way<span class="_ _11"> </span>to<span class="_ _11"> </span>generate<span class="_ _11"> </span>references<span class="_ _11"> </span>to<span class="_ _11"> </span>elements<span class="_ _11"> </span>within<span class="_ _11"> </span>different<span class="_ _11"> </span>data<span class="_ _11"> </span>structures<span class="_ _1"></span>.</div><div class="t m5 x17 h26 y2cff ff7 fs19 fc2 sc0 ls0 ws0">P<span class="_ _1"></span>ointers<span class="_ _14"> </span>are<span class="_ _14"> </span>a<span class="_ _16"> </span>source<span class="_ _14"> </span>of<span class="_ _14"> </span>confusion<span class="_ _14"> </span>for<span class="_ _14"> </span>novice<span class="_ _16"> </span>programmers<span class="_ _0"></span>,<span class="_ _14"> </span>but<span class="_ _14"> </span>the<span class="_ _14"> </span>underlying</div><div class="t m5 x17 h26 y2d00 ff7 fs19 fc2 sc0 ls0 ws0">concepts<span class="_"> </span>are<span class="_"> </span>fairly<span class="_"> </span>simple<span class="_ _1"></span>.<span class="_"> </span>Here<span class="_"> </span>we<span class="_"> </span>highlight<span class="_ _13"> </span>some<span class="_"> </span>key<span class="_"> </span>principles<span class="_"> </span>of<span class="_"> </span>pointers<span class="_"> </span>and</div><div class="t m5 x17 h26 y2d01 ff7 fs19 fc2 sc0 ls0 ws0">their<span class="_"> </span>mapping<span class="_"> </span>into<span class="_"> </span>machine<span class="_"> </span>code<span class="_ _1"></span>.</div><div class="t m5 x72 h3d y2d02 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y2d03 ffa fs19 fc1 sc0 ls0 ws0">Every<span class="_ _11"> </span>pointer<span class="_ _11"> </span>has<span class="_ _11"> </span>an<span class="_ _11"> </span>associated<span class="_ _11"> </span>type<span class="ff7">.<span class="_ _11"> </span>T<span class="_ _0"></span>his<span class="_ _11"> </span>type<span class="_ _11"> </span>indicates<span class="_ _11"> </span>what<span class="_ _11"> </span>kind<span class="_ _11"> </span>of<span class="_ _11"> </span>object</span></div><div class="t m5 x26 h26 y2d04 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _13"> </span>pointer<span class="_"> </span>points<span class="_ _13"> </span>to.<span class="_ _13"> </span>Using<span class="_ _13"> </span>the<span class="_"> </span>following<span class="_ _13"> </span>pointer<span class="_"> </span>declarations<span class="_ _13"> </span>as<span class="_"> </span>illustrations</div><div class="t m5 x19f h2d y2d05 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>*ip;</div><div class="t m5 x19f h2d y2d06 ffd fs1e fc2 sc0 ls0 ws0">char<span class="_ _e"> </span>**cpp;</div><div class="t m5 x26 h26 y19a9 ff7 fs19 fc2 sc0 ls0 ws0">variable<span class="_ _11"> </span><span class="ffd">ip<span class="_ _11"> </span></span>is<span class="_ _11"> </span>a<span class="_ _11"> </span>pointer<span class="_ _11"> </span>to<span class="_ _11"> </span>an<span class="_ _11"> </span>object<span class="_ _11"> </span>of<span class="_ _11"> </span>type<span class="_ _11"> </span><span class="ffd">int</span>,<span class="_ _11"> </span>while<span class="_ _11"> </span><span class="ffd">cpp<span class="_ _11"> </span></span>is<span class="_ _11"> </span>a<span class="_ _11"> </span>pointer<span class="_ _11"> </span>to<span class="_ _11"> </span>an</div><div class="t m5 x26 h26 y19aa ff7 fs19 fc2 sc0 ls0 ws0">object<span class="_ _13"> </span>that<span class="_ _13"> </span>itself<span class="_ _13"> </span>is<span class="_"> </span>a<span class="_ _13"> </span>pointer<span class="_ _13"> </span>to<span class="_ _13"> </span>an<span class="_ _13"> </span>object<span class="_ _13"> </span>of<span class="_"> </span>type<span class="_ _13"> </span><span class="ffd">char</span>.<span class="_ _13"> </span>In<span class="_ _13"> </span>general,<span class="_ _13"> </span>if<span class="_"> </span>the<span class="_ _13"> </span>object</div><div class="t m5 x26 h26 y19ab ff7 fs19 fc2 sc0 ls0 ws0">has<span class="_ _13"> </span>type<span class="_ _13"> </span><span class="ff11">T<span class="_ _13"> </span></span>,<span class="_ _13"> </span>then<span class="_"> </span>the<span class="_ _13"> </span>pointer<span class="_ _13"> </span>has<span class="_ _13"> </span>type<span class="_ _13"> </span><span class="ffd">*<span class="ff11">T<span class="_ _13"> </span></span></span>.<span class="_ _13"> </span>T<span class="_ _1"></span>he<span class="_ _13"> </span>special<span class="_"> </span><span class="ffd">void<span class="_ _11"> </span>*<span class="_ _13"> </span></span>type<span class="_ _13"> </span>represents<span class="_ _13"> </span>a</div><div class="t m5 x26 h26 y19ac ff7 fs19 fc2 sc0 ls0 ws0">generic<span class="_"> </span>pointer.<span class="_ _11"> </span>F<span class="_ _1"></span>or<span class="_"> </span>example,<span class="_"> </span>the<span class="_ _11"> </span><span class="ffd">malloc<span class="_ _11"> </span></span>function<span class="_ _11"> </span>returns<span class="_"> </span>a<span class="_ _11"> </span>generic<span class="_ _11"> </span>pointer,</div><div class="t m5 x26 h26 y19ad ff7 fs19 fc2 sc0 ls0 ws0">which<span class="_ _15"> </span>is<span class="_ _15"> </span>converted<span class="_ _15"> </span>to<span class="_ _21"> </span>a<span class="_ _15"> </span>typed<span class="_ _15"> </span>pointer<span class="_ _15"> </span>via<span class="_ _21"> </span>either<span class="_ _15"> </span>an<span class="_ _15"> </span>explicit<span class="_ _15"> </span>cast<span class="_ _21"> </span>or<span class="_ _15"> </span>by<span class="_ _15"> </span>the</div><div class="t m5 x26 h26 y19ae ff7 fs19 fc2 sc0 ls0 ws0">implicit<span class="_ _15"> </span>casting<span class="_ _15"> </span>of<span class="_ _15"> </span>the<span class="_ _15"> </span>assignment<span class="_ _21"> </span>operation.<span class="_ _15"> </span>P<span class="_ _1"></span>ointer<span class="_ _15"> </span>types<span class="_ _21"> </span>are<span class="_ _15"> </span>not<span class="_ _15"> </span>part<span class="_ _15"> </span>of</div><div class="t m5 x26 h26 y2d07 ff7 fs19 fc2 sc0 ls0 ws0">machine<span class="_ _16"> </span>code;<span class="_ _14"> </span>they<span class="_ _14"> </span>are<span class="_ _16"> </span>an<span class="_ _16"> </span>abstraction<span class="_ _16"> </span>provided<span class="_ _16"> </span>by<span class="_ _14"> </span>C<span class="_ _16"> </span>to<span class="_ _16"> </span>help<span class="_ _16"> </span>programmers</div><div class="t m5 x26 h26 y2d08 ff7 fs19 fc2 sc0 ls0 ws0">avoid<span class="_"> </span>addressing<span class="_"> </span>errors<span class="_ _1"></span>.</div><div class="t m5 x72 h3d y2d09 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y2d0a ffa fs19 fc1 sc0 ls0 ws0">Every<span class="_ _21"> </span>pointer<span class="_ _21"> </span>has<span class="_ _21"> </span>a<span class="_ _21"> </span>value<span class="ff7">.<span class="_ _21"> </span>T<span class="_ _0"></span>his<span class="_ _21"> </span>value<span class="_ _21"> </span>is<span class="_ _21"> </span>an<span class="_ _21"> </span>address<span class="_ _21"> </span>of<span class="_ _21"> </span>some<span class="_ _21"> </span>object<span class="_ _21"> </span>of<span class="_ _21"> </span>the</span></div><div class="t m5 x26 h26 y2d0b ff7 fs19 fc1 sc0 ls0 ws0">designated<span class="_ _14"> </span>type<span class="_ _1"></span>.<span class="_ _14"> </span>The<span class="_ _16"> </span>special<span class="_ _14"> </span><span class="ffd">NULL<span class="_ _14"> </span></span>(0)<span class="_ _14"> </span>value<span class="_ _14"> </span>indicates<span class="_ _14"> </span>that<span class="_ _16"> </span>the<span class="_ _14"> </span>pointer<span class="_ _14"> </span>does</div><div class="t m5 x26 h26 y2d0c ff7 fs19 fc1 sc0 ls0 ws0">not<span class="_"> </span>point<span class="_"> </span>anywhere<span class="_ _1"></span>.</div><div class="t m5 x72 h3d y2d0d ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y2c5b ffa fs19 fc1 sc0 ls0 ws0">P<span class="_ _1"></span>ointers<span class="_"> </span>are<span class="_"> </span>created<span class="_ _13"> </span>with<span class="_"> </span>the<span class="_"> </span>‘<span class="ffd">&amp;</span>’<span class="_"> </span>operator<span class="ff7">.<span class="_"> </span>T<span class="_ _0"></span>his<span class="_"> </span>operator<span class="_"> </span>can<span class="_ _13"> </span>be<span class="_"> </span>applied<span class="_"> </span>to<span class="_"> </span>any</span></div><div class="t m5 x26 h26 y2d0e ff7 fs19 fc1 sc0 ls0 ws0">C<span class="_"> </span>expression<span class="_"> </span>that<span class="_"> </span>is<span class="_ _13"> </span>categorized<span class="_"> </span>as<span class="_"> </span>an<span class="_"> </span><span class="ffa">lvalue</span>,<span class="_"> </span>meaning<span class="_"> </span>an<span class="_"> </span>expression<span class="_ _13"> </span>that<span class="_"> </span>can</div><div class="t m5 x26 h26 y2d0f ff7 fs19 fc1 sc0 ls0 ws0">appear<span class="_"> </span>on<span class="_"> </span>the<span class="_"> </span>left<span class="_"> </span>side<span class="_"> </span>of<span class="_"> </span>an<span class="_"> </span>assignment.<span class="_"> </span>Examples<span class="_ _13"> </span>include<span class="_"> </span>variables<span class="_"> </span>and<span class="_"> </span>the</div><div class="t m5 x26 h26 y2d10 ff7 fs19 fc1 sc0 ls0 ws0">elements<span class="_ _16"> </span>of<span class="_ _14"> </span>structures<span class="_ _1"></span>,<span class="_ _14"> </span>unions<span class="_ _1"></span>,<span class="_ _14"> </span>and<span class="_ _16"> </span>arrays<span class="_ _1"></span>.<span class="_ _14"> </span>W<span class="_ _3"></span>e<span class="_ _14"> </span>have<span class="_ _16"> </span>seen<span class="_ _14"> </span>that<span class="_ _16"> </span>the<span class="_ _14"> </span>machine-</div><div class="t m5 x26 h26 y2d11 ff7 fs19 fc1 sc0 ls0 ws0">code<span class="_ _13"> </span>realization<span class="_ _13"> </span>of<span class="_ _6"> </span>the<span class="_ _13"> </span>‘<span class="ffd">&amp;</span>’<span class="_ _13"> </span>operator<span class="_ _13"> </span>often<span class="_ _6"> </span>uses<span class="_ _13"> </span>the<span class="_ _13"> </span><span class="ffd">leaq<span class="_ _13"> </span></span>instruction<span class="_ _6"> </span>to<span class="_ _13"> </span>compute</div><div class="t m5 x26 h26 y2d12 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _13"> </span>expression<span class="_ _13"> </span>value<span class="_ _1"></span>,<span class="_"> </span>since<span class="_ _13"> </span>this<span class="_ _13"> </span>instruction<span class="_ _13"> </span>is<span class="_ _13"> </span>designed<span class="_ _13"> </span>to<span class="_ _13"> </span>compute<span class="_ _13"> </span>the<span class="_ _13"> </span>address</div><div class="t m5 x26 h26 y2d13 ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_"> </span>a<span class="_"> </span>memory<span class="_"> </span>reference<span class="_ _1"></span>.</div><div class="t m5 x72 h3d y2d14 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y2d15 ffa fs19 fc1 sc0 ls0 ws0">P<span class="_ _1"></span>ointers<span class="_ _13"> </span>are<span class="_ _13"> </span>dereferenced<span class="_ _13"> </span>with<span class="_ _13"> </span>the<span class="_"> </span>‘<span class="ffd">*</span>’<span class="_ _13"> </span>operator<span class="ff7">.<span class="_"> </span>T<span class="_ _3"></span>he<span class="_"> </span>result<span class="_ _13"> </span>is<span class="_ _13"> </span>a<span class="_ _13"> </span>value<span class="_ _13"> </span>having<span class="_ _13"> </span>the</span></div><div class="t m5 x26 h26 y2d16 ff7 fs19 fc1 sc0 ls0 ws0">type<span class="_ _13"> </span>associated<span class="_"> </span>with<span class="_ _13"> </span>the<span class="_ _13"> </span>pointer.<span class="_ _13"> </span>Dereferencing<span class="_ _13"> </span>is<span class="_"> </span>implemented<span class="_ _13"> </span>by<span class="_ _13"> </span>a<span class="_"> </span>memory</div><div class="t m5 x26 h26 y2d17 ff7 fs19 fc1 sc0 ls0 ws0">reference<span class="_ _1"></span>,<span class="_"> </span>either<span class="_"> </span>storing<span class="_"> </span>to<span class="_"> </span>or<span class="_"> </span>retrieving<span class="_"> </span>from<span class="_"> </span>the<span class="_"> </span>speciﬁed<span class="_"> </span>address<span class="_ _1"></span>.</div><div class="t m5 x72 h3d y2d18 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 yc21 ffa fs19 fc1 sc0 ls0 ws0">Arrays<span class="_ _a"> </span>and<span class="_ _13"> </span>pointers<span class="_ _a"> </span>are<span class="_ _13"> </span>closely<span class="_ _a"> </span>related<span class="_ _2"></span><span class="ff7">.<span class="_ _6"> </span>The<span class="_ _a"> </span>name<span class="_ _13"> </span>of<span class="_ _a"> </span>an<span class="_ _13"> </span>array<span class="_ _a"> </span>can<span class="_ _13"> </span>be<span class="_ _a"> </span>referenced</span></div><div class="t m5 x26 h26 yc22 ff7 fs19 fc1 sc0 ls0 ws0">(but<span class="_ _15"> </span>not<span class="_ _15"> </span>updated)<span class="_ _15"> </span>as<span class="_ _15"> </span>if<span class="_ _15"> </span>it<span class="_ _15"> </span>were<span class="_ _15"> </span>a<span class="_ _15"> </span>pointer<span class="_ _15"> </span>variable.<span class="_ _14"> </span>Array<span class="_ _15"> </span>referencing<span class="_ _15"> </span>(e.g<span class="_ _0"></span>.,</div><div class="t m5 x26 h26 yc23 ffd fs19 fc1 sc0 ls0 ws0">a[3]<span class="ff7">)<span class="_"> </span>has<span class="_ _13"> </span>the<span class="_"> </span>exact<span class="_ _13"> </span>same<span class="_"> </span>effect<span class="_"> </span>as<span class="_ _13"> </span>pointer<span class="_"> </span>arithmetic<span class="_"> </span>and<span class="_ _13"> </span>dereferencing<span class="_"> </span>(e<span class="_ _1"></span>.g.,</span></div><div class="t m5 x26 h26 yc24 ffd fs19 fc1 sc0 ls0 ws0">*(a+3)<span class="ff7">).<span class="_ _14"> </span>Both<span class="_ _14"> </span>array<span class="_ _14"> </span>referencing<span class="_ _14"> </span>and<span class="_ _16"> </span>pointer<span class="_ _14"> </span>arithmetic<span class="_ _14"> </span>require<span class="_ _14"> </span>scaling<span class="_ _14"> </span>the</span></div><div class="t m5 x26 h26 yc25 ff7 fs19 fc1 sc0 ls0 ws0">offsets<span class="_ _13"> </span>by<span class="_"> </span>the<span class="_ _13"> </span>object<span class="_"> </span>size<span class="_ _1"></span>.<span class="_"> </span>W<span class="_ _1"></span>hen<span class="_"> </span>we<span class="_ _13"> </span>write<span class="_"> </span>an<span class="_ _13"> </span>expression<span class="_ _13"> </span><span class="ffd">p+i<span class="_ _10"> </span></span>for<span class="_ _13"> </span>pointer<span class="_"> </span><span class="ffd">p<span class="_ _13"> </span></span>with</div><div class="t m5 x26 h46 yc26 ff7 fs19 fc1 sc0 ls0 ws0">value<span class="_"> </span><span class="ff11">p<span class="_ _2"></span></span>,<span class="_"> </span>the<span class="_"> </span>resulting<span class="_ _11"> </span>address<span class="_"> </span>is<span class="_"> </span>computed<span class="_"> </span>as<span class="_ _11"> </span><span class="ff11">p<span class="_ _10"> </span><span class="ff12">+<span class="_ _10"> </span></span>L</span></div><div class="t m5 x1b4 h45 y2d19 ff11 fs19 fc1 sc0 ls0 ws0">.</div><div class="t m5 xfb h26 yc26 ff11 fs19 fc1 sc0 ls0 ws0">i<span class="_ _2"></span><span class="ff7">,<span class="_ _11"> </span>where<span class="_"> </span></span>L<span class="_ _11"> </span><span class="ff7">is<span class="_"> </span>the<span class="_"> </span>size<span class="_"> </span>of</span></div><div class="t m5 x26 h26 y14b5 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>data<span class="_"> </span>type<span class="_"> </span>associated<span class="_"> </span>with<span class="_"> </span><span class="ffd">p</span>.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
