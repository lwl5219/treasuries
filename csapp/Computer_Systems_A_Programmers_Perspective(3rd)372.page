<div id="pf174" class="pf w2 h11" data-page-no="174"><div class="pc pc174 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg174.png"/><div class="t m5 x107 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Solutions<span class="_ _10"> </span>to<span class="_ _10"> </span>Practice<span class="_ _10"> </span>Problems<span class="_ _1b"> </span><span class="ffe fs1e">371</span></div><div class="t m5 x1c5 h61 ye7 ff13 fs35 fc6 sc0 ls0 ws0">short<span class="_ _f"> </span>dw_loop(short<span class="_ _f"> </span>x)</div><div class="t m5 x1c5 h61 y26dc ff13 fs35 fc6 sc0 ls0 ws0">x<span class="_ _f"> </span>initially<span class="_ _f"> </span>in<span class="_ _f"> </span>%rdi</div><div class="t m5 x146 h2d yecb ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">dw_loop:</span></div><div class="t m5 x146 h2d yecc ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _45"> </span><span class="ffd fs1e fc2">movq<span class="_ _46"> </span>%rdi,<span class="_ _e"> </span>%rbx<span class="_ _107"> </span></span><span class="ff13 fs35">Copy<span class="_ _f"> </span>x<span class="_ _f"> </span>to<span class="_ _e"> </span>%rbx</span></div><div class="t m5 x146 h2d yecd ff6 fs20 fc6 sc0 ls0 ws0">3<span class="_ _45"> </span><span class="ffd fs1e fc2">movq<span class="_ _46"> </span>%rdi,<span class="_ _e"> </span>%rcx</span></div><div class="t m5 x146 h2d yece ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _45"> </span><span class="ffd fs1e fc2">idivq<span class="_ _3f"> </span>$9,<span class="_ _e"> </span>%rcx<span class="_ _c1"> </span></span><span class="ff13 fs35">Comput<span class="ls156">ey=x<span class="_ _8a"></span>/<span class="_ _8a"></span>9</span></span></div><div class="t m5 x146 h2d yecf ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _45"> </span><span class="ffd fs1e fc2">leaq<span class="_ _46"> </span>(,%rdi,4),<span class="_ _e"> </span>%rdx<span class="_ _2a"> </span></span><span class="ff13 fs35">Comput<span class="ls156">en=4<span class="_ _8a"></span>*<span class="_ _12"></span>x</span></span></div><div class="t m5 x146 h2d yed0 ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _1c"> </span><span class="ffd fs1e fc2">.L2:<span class="_ _15c"> </span></span><span class="ff2d fs35">loop:</span></div><div class="t m5 x146 h2e y20fe ff6 fs20 fc6 sc0 ls0 ws0">7</div><div class="t m5 x1b0 h2d y1a10 ffd fs1e fc2 sc0 ls0 ws0">leaq<span class="_ _46"> </span>5(%rbx,%rcx),<span class="_ _e"> </span>%rcx<span class="_ _93"> </span><span class="ff13 fs35 fc6">Compute<span class="_ _e"> </span>y<span class="_ _21"> </span>+<span class="ls156">=x+5</span></span></div><div class="t m5 x146 h2d yed3 ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _45"> </span><span class="ffd fs1e fc2">subq<span class="_ _46"> </span>$2,<span class="_ _e"> </span>%rdx<span class="_ _c1"> </span></span><span class="ff13 fs35">Decrement<span class="_ _f"> </span>n<span class="_ _f"> </span>by<span class="_ _e"> </span>2</span></div><div class="t m5 x146 h2d yed4 ff6 fs20 fc6 sc0 ls0 ws0">9<span class="_ _45"> </span><span class="ffd fs1e fc2">testq<span class="_ _3f"> </span>%rdx,<span class="_ _e"> </span>%rdx<span class="_ _107"> </span></span><span class="ff13 fs35">Test<span class="_ _f"> </span>n</span></div><div class="t m5 x2d h2d y462 ff6 fs20 fc6 sc0 ls0 ws0">10<span class="_ _45"> </span><span class="ffd fs1e fc2">jg<span class="_ _5a"> </span>.L2<span class="_ _14f"> </span></span><span class="ff13 fs35">If<span class="_ _f"> </span>&gt;<span class="_ _e"> </span>0,<span class="_ _21"> </span>goto<span class="_ _f"> </span><span class="ff2d">loop</span></span></div><div class="t m5 x2d h2d y26dd ff6 fs20 fc6 sc0 ls0 ws0">11<span class="_ _45"> </span><span class="ffd fs1e fc2">rep;<span class="_ _e"> </span>ret<span class="_ _14f"> </span></span><span class="ff13 fs35">Return</span></div><div class="t m5 x17 h28 y3421 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>3.24<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>260)</span></div><div class="t m5 x17 h26 y3422 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _14"> </span>assembly<span class="_ _15"> </span>code<span class="_ _14"> </span>is<span class="_ _14"> </span>a<span class="_ _14"> </span>fairly<span class="_ _15"> </span>straightforward<span class="_ _14"> </span>translation<span class="_ _14"> </span>of<span class="_ _14"> </span>the<span class="_ _15"> </span>loop<span class="_ _14"> </span>using<span class="_ _14"> </span>the</div><div class="t m5 x17 h26 y3423 ff7 fs19 fc1 sc0 ls0 ws0">jump-to-middle<span class="_"> </span>method.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_"> </span>full<span class="_"> </span>C<span class="_"> </span>code<span class="_"> </span>is<span class="_"> </span>as<span class="_"> </span>follows:</div><div class="t m5 x17 h2d y3424 ffd fs1e fc2 sc0 ls0 ws0">short<span class="_ _e"> </span>loop_while(short<span class="_ _1f"> </span>a,<span class="_ _1f"> </span>short<span class="_ _e"> </span>b)</div><div class="t m5 x17 h2d y3425 ffd fs1e fc2 sc0 ls0 ws0">{</div><div class="t m5 x1b6 h2d y3426 ffd fs1e fc2 sc0 ls0 ws0">short<span class="_ _e"> </span>result<span class="_ _1f"> </span>=<span class="_ _1f"> </span>0;</div><div class="t m5 x1b6 h2d y3427 ffd fs1e fc2 sc0 ls0 ws0">while<span class="_ _e"> </span>(a<span class="_ _1f"> </span>&gt;<span class="_ _1f"> </span>b)<span class="_ _e"> </span>{</div><div class="t m5 x21e h2d y3428 ffd fs1e fc2 sc0 ls0 ws0">result<span class="_ _e"> </span>=<span class="_ _1f"> </span>result<span class="_ _1f"> </span>+<span class="_ _e"> </span>(a*b);</div><div class="t m5 x21e h2d y3429 ffd fs1e fc2 sc0 ls0 ws0">a<span class="_ _e"> </span>=<span class="_ _1f"> </span>a-1;</div><div class="t m5 x1b6 h2d y342a ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x1b6 h2d y342b ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>result;</div><div class="t m5 x17 h2d y342c ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x17 h28 y342d ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>3.25</div><div class="t m5 x112 h2f y342e ffe fs16 fc6 sc0 ls0 ws0">(page<span class="_"> </span>262)</div><div class="t m5 x17 h26 y342f ff7 fs19 fc1 sc0 ls0 ws0">While<span class="_ _16"> </span>the<span class="_ _14"> </span>generated<span class="_ _14"> </span>code<span class="_ _14"> </span>does<span class="_ _14"> </span>not<span class="_ _14"> </span>follow<span class="_ _14"> </span>the<span class="_ _14"> </span>exact<span class="_ _14"> </span>pattern<span class="_ _14"> </span>of<span class="_ _14"> </span>the<span class="_ _14"> </span>guarded-do</div><div class="t m5 x17 h26 y3430 ff7 fs19 fc1 sc0 ls0 ws0">translation,<span class="_"> </span>we<span class="_"> </span>can<span class="_"> </span>see<span class="_"> </span>that<span class="_"> </span>it<span class="_"> </span>is<span class="_"> </span>equivalent<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>C<span class="_"> </span>code:</div><div class="t m5 x17 h2d y3431 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>loop_while2(long<span class="_ _1f"> </span>a,<span class="_ _1f"> </span>long<span class="_ _e"> </span>b)</div><div class="t m5 x17 h2d y3432 ffd fs1e fc2 sc0 ls0 ws0">{</div><div class="t m5 x1b6 h2d y3433 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>result<span class="_ _1f"> </span>=<span class="_ _1f"> </span>b;</div><div class="t m5 x1b6 h2d y3434 ffd fs1e fc2 sc0 ls0 ws0">while<span class="_ _e"> </span>(b<span class="_ _1f"> </span>&gt;<span class="_ _1f"> </span>0)<span class="_ _e"> </span>{</div><div class="t m5 x21e h2d y3435 ffd fs1e fc2 sc0 ls0 ws0">result<span class="_ _e"> </span>=<span class="_ _1f"> </span>result<span class="_ _1f"> </span>*<span class="_ _e"> </span>a;</div><div class="t m5 x21e h2d y3436 ffd fs1e fc2 sc0 ls0 ws0">b<span class="_ _e"> </span>=<span class="_ _1f"> </span>b-a;</div><div class="t m5 x1b6 h2d y3437 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x1b6 h2d y3438 ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>result;</div><div class="t m5 x17 h2d y3439 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x26 h26 y832 ff7 fs19 fc2 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_"> </span>will<span class="_"> </span>often<span class="_"> </span>see<span class="_"> </span>cases<span class="_ _0"></span>,<span class="_"> </span>especially<span class="_"> </span>when<span class="_"> </span>compiling<span class="_"> </span>with<span class="_"> </span>higher<span class="_"> </span>levels<span class="_"> </span>of<span class="_"> </span>opti-</div><div class="t m5 x17 h26 y833 ff7 fs19 fc2 sc0 ls0 ws0">mization,<span class="_ _13"> </span>where<span class="_ _13"> </span><span class="ff9">gcc<span class="_ _6"> </span></span>takes<span class="_ _13"> </span>some<span class="_ _13"> </span>liberties<span class="_ _6"> </span>in<span class="_ _13"> </span>the<span class="_ _6"> </span>exact<span class="_ _13"> </span>form<span class="_ _13"> </span>of<span class="_ _6"> </span>the<span class="_ _13"> </span>code<span class="_ _13"> </span>it<span class="_ _6"> </span>generates<span class="_ _1"></span>,</div><div class="t m5 x17 h26 y834 ff7 fs19 fc2 sc0 ls0 ws0">while<span class="_"> </span>preserving<span class="_"> </span>the<span class="_"> </span>required<span class="_"> </span>functionality<span class="_ _3"></span>.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
