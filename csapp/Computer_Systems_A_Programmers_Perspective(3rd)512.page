<div id="pf200" class="pf w2 h11" data-page-no="200"><div class="pc pc200 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg200.png"/><div class="t m5 x5f h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Homework<span class="_ _10"> </span>Problems<span class="_ _1b"> </span><span class="ffe fs1e">511</span></div><div class="t m5 x17 h2d y46ca ffd fs1e fc2 sc0 ls0 ws0">#include<span class="_ _e"> </span>&lt;stdio.h&gt;</div><div class="t m5 x17 h2d y46cb ffd fs1e fc2 sc0 ls0 ws0">/*<span class="_ _e"> </span>Example<span class="_ _1f"> </span>use<span class="_ _1f"> </span>of<span class="_ _e"> </span>switch<span class="_ _1f"> </span>statement<span class="_ _e"> </span>*/</div><div class="t m5 x17 h2d y46cc ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>switchv(long<span class="_ _1f"> </span>idx)<span class="_ _1f"> </span>{</div><div class="t m5 x1b6 h2d y46cd ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>result<span class="_ _1f"> </span>=<span class="_ _1f"> </span>0;</div><div class="t m5 x1b6 h2d y46ce ffd fs1e fc2 sc0 ls0 ws0">switch(idx)<span class="_ _e"> </span>{</div><div class="t m5 x1b6 h2d y46cf ffd fs1e fc2 sc0 ls0 ws0">case<span class="_ _e"> </span>0:</div><div class="t m5 x21e h2d y46d0 ffd fs1e fc2 sc0 ls0 ws0">result<span class="_ _e"> </span>=<span class="_ _1f"> </span>0xaaa;</div><div class="t m5 x21e h2d y46d1 ffd fs1e fc2 sc0 ls0 ws0">break;</div><div class="t m5 x1b6 h2d y46d2 ffd fs1e fc2 sc0 ls0 ws0">case<span class="_ _e"> </span>2:</div><div class="t m5 x1b6 h2d y46d3 ffd fs1e fc2 sc0 ls0 ws0">case<span class="_ _e"> </span>5:</div><div class="t m5 x21e h2d y46d4 ffd fs1e fc2 sc0 ls0 ws0">result<span class="_ _e"> </span>=<span class="_ _1f"> </span>0xbbb;</div><div class="t m5 x21e h2d y46d5 ffd fs1e fc2 sc0 ls0 ws0">break;</div><div class="t m5 x1b6 h2d y46d6 ffd fs1e fc2 sc0 ls0 ws0">case<span class="_ _e"> </span>3:</div><div class="t m5 x21e h2d y46d7 ffd fs1e fc2 sc0 ls0 ws0">result<span class="_ _e"> </span>=<span class="_ _1f"> </span>0xccc;</div><div class="t m5 x21e h2d y46d8 ffd fs1e fc2 sc0 ls0 ws0">break;</div><div class="t m5 x1b6 h2d y46d9 ffd fs1e fc2 sc0 ls0 ws0">default:</div><div class="t m5 x21e h2d y46da ffd fs1e fc2 sc0 ls0 ws0">result<span class="_ _e"> </span>=<span class="_ _1f"> </span>0xddd;</div><div class="t m5 x1b6 h2d y46db ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x1b6 h2d y46dc ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>result;</div><div class="t m5 x52 h2d y46dd ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x17 h2d y46de ffd fs1e fc2 sc0 ls0 ws0">/*<span class="_ _e"> </span>Testing<span class="_ _1f"> </span>Code<span class="_ _1f"> </span>*/</div><div class="t m5 x17 h2d y46df ffd fs1e fc2 sc0 ls0 ws0">#define<span class="_ _e"> </span>CNT<span class="_ _1f"> </span>8</div><div class="t m5 x17 h2d y46e0 ffd fs1e fc2 sc0 ls0 ws0">#define<span class="_ _e"> </span>MINVAL<span class="_ _1f"> </span>-1</div><div class="t m5 x17 h2d y46e1 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>main()<span class="_ _1f"> </span>{</div><div class="t m5 x1b6 h2d y46e2 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>vals[CNT];</div><div class="t m5 x1b6 h2d y46e3 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>i;</div><div class="t m5 x1b6 h2d y46e4 ffd fs1e fc2 sc0 ls0 ws0">for<span class="_ _e"> </span>(i<span class="_ _1f"> </span>=<span class="_ _1f"> </span>0;<span class="_ _e"> </span>i<span class="_ _1f"> </span>&lt;<span class="_ _e"> </span>CNT;<span class="_ _1f"> </span>i++)<span class="_ _1f"> </span>{</div><div class="t m5 x21e h2d y46e5 ffd fs1e fc2 sc0 ls0 ws0">vals[i]<span class="_ _e"> </span>=<span class="_ _1f"> </span>switchv(i<span class="_ _1f"> </span>+<span class="_ _e"> </span>MINVAL);</div><div class="t m5 x21e h2d y46e6 ffd fs1e fc2 sc0 ls0 ws0">printf(&quot;idx<span class="_ _e"> </span>=<span class="_ _1f"> </span>%ld,<span class="_ _1f"> </span>val<span class="_ _e"> </span>=<span class="_ _1f"> </span>0x%lx\n&quot;,<span class="_ _e"> </span>i<span class="_ _1f"> </span>+<span class="_ _1f"> </span>MINVAL,<span class="_ _e"> </span>vals[i]);</div><div class="t m5 x1b6 h2d y46e7 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x1b6 h2d y46e8 ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>0;</div><div class="t m5 x17 h2d y46e9 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x17 h34 y46ea ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _16"> </span>4.69<span class="_ _c"> </span><span class="fc1">Switch<span class="_ _16"> </span>statements<span class="_ _16"> </span>can<span class="_ _16"> </span>be<span class="_ _16"> </span>translated<span class="_ _16"> </span>into<span class="_ _16"> </span>Y86-64<span class="_ _16"> </span>code.<span class="_ _16"> </span><span class="ff6">This<span class="_ _16"> </span>requires</span></span></div><div class="t m5 x17 h34 y46eb ff6 fs16 fc1 sc0 ls0 ws0">implementation<span class="_ _10"> </span>of<span class="_ _11"> </span>a<span class="_ _10"> </span>jump<span class="_ _10"> </span>table.</div><div class="t m5 x17 h26 y2878 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _16"> </span>C<span class="_ _14"> </span>code<span class="_ _14"> </span>shown<span class="_ _14"> </span>in<span class="_ _14"> </span>F<span class="_ _1"></span>igure<span class="_ _14"> </span>4.69<span class="_ _14"> </span>for<span class="_ _14"> </span>a<span class="_ _14"> </span>function<span class="_ _14"> </span><span class="ffd">switchv</span>,<span class="_ _14"> </span>along<span class="_ _14"> </span>with<span class="_ _14"> </span>associated</div><div class="t m5 x17 h26 y2879 ff7 fs19 fc1 sc0 ls0 ws0">test<span class="_"> </span>code<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y287a ff7 fs19 fc1 sc0 ls0 ws0">Implement<span class="_ _16"> </span><span class="ffd">switchv<span class="_ _11"> </span></span>in<span class="_ _16"> </span>Y86-64<span class="_ _16"> </span>using<span class="_ _16"> </span>a<span class="_ _16"> </span>jump<span class="_ _11"> </span>table.<span class="_ _11"> </span>Although<span class="_ _16"> </span>the<span class="_ _16"> </span>Y86-64<span class="_ _16"> </span>in-</div><div class="t m5 x17 h26 y287b ff7 fs19 fc1 sc0 ls0 ws0">struction<span class="_"> </span>set<span class="_ _11"> </span>does<span class="_ _11"> </span>not<span class="_ _11"> </span>include<span class="_ _11"> </span>an<span class="_ _11"> </span>indirect<span class="_"> </span>jump<span class="_ _11"> </span>instruction,<span class="_ _11"> </span>you<span class="_ _11"> </span>can<span class="_ _11"> </span>get<span class="_ _11"> </span>the<span class="_ _11"> </span>same</div><div class="t m5 x17 h26 y287c ff7 fs19 fc1 sc0 ls0 ws0">effect<span class="_"> </span>by<span class="_ _11"> </span>pushing<span class="_ _11"> </span>a<span class="_"> </span>computed<span class="_ _11"> </span>address<span class="_ _11"> </span>onto<span class="_ _11"> </span>the<span class="_"> </span>stack<span class="_ _11"> </span>and<span class="_ _11"> </span>then<span class="_"> </span>executing<span class="_ _11"> </span>the<span class="_ _11"> </span><span class="ffd">ret</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
