<div id="pf1fd" class="pf w2 h11" data-page-no="1fd"><div class="pc pc1fd w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1fd.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">508<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>4<span class="_ _3d"> </span>Processor<span class="_ _10"> </span>Architecture</span></div><div class="t m5 x28 h2a y257 fff fs1c fc2 sc0 ls0 ws0">W<span class="_ _1"></span>eb<span class="_ _16"> </span>Aside<span class="_ _14"> </span>ARCH:HCL<span class="_ _1b"> </span><span class="ff6 fs19">HCL<span class="_ _11"> </span>descriptions<span class="_ _11"> </span>of<span class="_ _11"> </span>Y86-64<span class="_ _16"> </span>processors</span></div><div class="t m5 x28 h2b y2d0 ff7 fs1e fc2 sc0 ls0 ws0">In<span class="_ _11"> </span>this<span class="_ _11"> </span>chapter,<span class="_ _10"> </span>we<span class="_ _11"> </span>have<span class="_ _11"> </span>looked<span class="_ _11"> </span>at<span class="_ _11"> </span>portions<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>HCL<span class="_ _11"> </span>code<span class="_ _11"> </span>for<span class="_ _11"> </span>several<span class="_ _11"> </span>simple<span class="_ _11"> </span>logic<span class="_ _11"> </span>designs<span class="_ _10"> </span>and<span class="_ _11"> </span>for</div><div class="t m5 x28 h2b y2d1 ff7 fs1e fc2 sc0 ls0 ws0">the<span class="_ _11"> </span>control<span class="_ _11"> </span>logic<span class="_ _11"> </span>for<span class="_ _11"> </span>Y86-64<span class="_ _11"> </span>processors<span class="_ _16"> </span>SEQ<span class="_ _11"> </span>and<span class="_ _11"> </span>PIPE.<span class="_ _11"> </span>F<span class="_ _1"></span>or<span class="_ _11"> </span>reference,<span class="_ _11"> </span>we<span class="_ _11"> </span>provide<span class="_ _11"> </span>documentation<span class="_ _11"> </span>of</div><div class="t m5 x28 h2b y2d2 ff7 fs1e fc2 sc0 ls0 ws0">the<span class="_"> </span>HCL<span class="_ _13"> </span>language<span class="_ _13"> </span>and<span class="_"> </span>complete<span class="_ _13"> </span>HCL<span class="_"> </span>descriptions<span class="_ _13"> </span>for<span class="_"> </span>the<span class="_ _13"> </span>control<span class="_"> </span>logic<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_"> </span>two<span class="_ _13"> </span>processors<span class="_ _1"></span>.<span class="_"> </span>Each<span class="_ _13"> </span>of</div><div class="t m5 x28 h2b y2d3 ff7 fs1e fc2 sc0 ls0 ws0">these<span class="_"> </span>descriptions<span class="_ _13"> </span>requires<span class="_ _13"> </span>only<span class="_"> </span>ﬁve<span class="_ _13"> </span>to<span class="_"> </span>seven<span class="_ _13"> </span>pages<span class="_ _13"> </span>of<span class="_"> </span>HCL<span class="_ _13"> </span>code<span class="_ _1"></span>,<span class="_"> </span>and<span class="_"> </span>it<span class="_ _13"> </span>is<span class="_ _13"> </span>worthwhile<span class="_"> </span>to<span class="_ _13"> </span>study<span class="_"> </span>them<span class="_ _13"> </span>in</div><div class="t m5 x28 h2b y2d4 ff7 fs1e fc2 sc0 ls0 ws0">their<span class="_"> </span>entirety<span class="_ _3"></span>.</div><div class="t m5 x1d h26 y4668 ff7 fs19 fc2 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_ _11"> </span>enhanced<span class="_ _16"> </span>the<span class="_ _11"> </span>pipeline<span class="_ _11"> </span>performance<span class="_ _11"> </span>by<span class="_ _16"> </span>adding<span class="_ _11"> </span>forwarding<span class="_ _11"> </span>logic<span class="_ _11"> </span>to<span class="_ _16"> </span>speed<span class="_ _11"> </span>the</div><div class="t m5 x1d h26 y4669 ff7 fs19 fc2 sc0 ls0 ws0">sending<span class="_"> </span>of<span class="_ _11"> </span>a<span class="_"> </span>result<span class="_ _11"> </span>from<span class="_"> </span>one<span class="_ _11"> </span>instruction<span class="_"> </span>to<span class="_ _11"> </span>another.<span class="_"> </span>Several<span class="_"> </span>special<span class="_ _11"> </span>cases<span class="_"> </span>require</div><div class="t m5 x1d h26 y466a ff7 fs19 fc2 sc0 ls0 ws0">additional<span class="_"> </span>pipeline<span class="_"> </span>control<span class="_"> </span>logic<span class="_"> </span>to<span class="_"> </span>stall<span class="_"> </span>or<span class="_"> </span>cancel<span class="_"> </span>some<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>pipeline<span class="_"> </span>stages<span class="_ _1"></span>.</div><div class="t m5 x29 h26 y466b ff7 fs19 fc2 sc0 ls0 ws0">Our<span class="_ _16"> </span>design<span class="_ _14"> </span>included<span class="_ _14"> </span>rudimentary<span class="_ _14"> </span>mechanisms<span class="_ _14"> </span>to<span class="_ _14"> </span>handle<span class="_ _14"> </span>exceptions<span class="_ _1"></span>,<span class="_ _14"> </span>where</div><div class="t m5 x1d h26 y466c ff7 fs19 fc2 sc0 ls0 ws0">we<span class="_ _15"> </span>make<span class="_ _15"> </span>sure<span class="_ _21"> </span>that<span class="_ _15"> </span>only<span class="_ _21"> </span>instructions<span class="_ _15"> </span>up<span class="_ _21"> </span>to<span class="_ _15"> </span>the<span class="_ _21"> </span>excepting<span class="_ _15"> </span>instruction<span class="_ _21"> </span>affect<span class="_ _15"> </span>the</div><div class="t m5 x1d h26 y466d ff7 fs19 fc2 sc0 ls0 ws0">programmer<span class="_ _1"></span>-visible<span class="_ _13"> </span>state<span class="_ _1"></span>.<span class="_ _13"> </span>Implementing<span class="_ _13"> </span>a<span class="_ _6"> </span>complete<span class="_ _13"> </span>handling<span class="_ _13"> </span>of<span class="_ _6"> </span>exceptions<span class="_ _13"> </span>would</div><div class="t m5 x1d h26 y466e ff7 fs19 fc2 sc0 ls0 ws0">be<span class="_ _16"> </span>signiﬁcantly<span class="_ _16"> </span>more<span class="_ _16"> </span>challenging.<span class="_ _16"> </span>Properly<span class="_ _16"> </span>handling<span class="_ _16"> </span>exceptions<span class="_ _16"> </span>gets<span class="_ _14"> </span>even<span class="_ _16"> </span>more</div><div class="t m5 x1d h26 y466f ff7 fs19 fc2 sc0 ls0 ws0">complex<span class="_"> </span>in<span class="_"> </span>systems<span class="_"> </span>that<span class="_"> </span>employ<span class="_"> </span>greater<span class="_"> </span>degrees<span class="_"> </span>of<span class="_"> </span>pipelining<span class="_"> </span>and<span class="_"> </span>parallelism.</div><div class="t m5 x29 h26 y4670 ff7 fs19 fc2 sc0 ls0 ws0">In<span class="_ _16"> </span>this<span class="_ _14"> </span>chapter,<span class="_ _16"> </span>we<span class="_ _14"> </span>have<span class="_ _16"> </span>learned<span class="_ _14"> </span>several<span class="_ _16"> </span>important<span class="_ _14"> </span>lessons<span class="_ _16"> </span>about<span class="_ _14"> </span>processor</div><div class="t m5 x1d h26 y4671 ff7 fs19 fc2 sc0 ls0 ws0">design:</div><div class="t m5 x75 h3d y4672 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x29 h26 y4673 ffa fs19 fc1 sc0 ls0 ws0">Managing<span class="_"> </span>complexity<span class="_ _11"> </span>is<span class="_ _11"> </span>a<span class="_"> </span>top<span class="_ _11"> </span>priority<span class="ff7">.<span class="_"> </span>W<span class="_ _1"></span>e<span class="_ _11"> </span>want<span class="_"> </span>to<span class="_ _11"> </span>make<span class="_ _11"> </span>optimum<span class="_"> </span>use<span class="_ _11"> </span>of<span class="_ _11"> </span>the</span></div><div class="t m5 x29 h26 y4674 ff7 fs19 fc1 sc0 ls0 ws0">hardware<span class="_ _11"> </span>resources<span class="_ _11"> </span>to<span class="_ _16"> </span>get<span class="_ _11"> </span>maximum<span class="_ _11"> </span>performance<span class="_ _16"> </span>at<span class="_ _11"> </span>minimum<span class="_ _11"> </span>cost.<span class="_ _16"> </span>W<span class="_ _3"></span>e<span class="_ _11"> </span>did</div><div class="t m5 x29 h26 y4675 ff7 fs19 fc1 sc0 ls0 ws0">this<span class="_ _13"> </span>by<span class="_ _13"> </span>creating<span class="_ _13"> </span>a<span class="_ _13"> </span>very<span class="_ _13"> </span>simple<span class="_ _13"> </span>and<span class="_ _13"> </span>uniform<span class="_ _13"> </span>framework<span class="_ _13"> </span>for<span class="_ _13"> </span>processing<span class="_ _13"> </span>all<span class="_ _13"> </span>of<span class="_ _13"> </span>the</div><div class="t m5 x29 h26 y4676 ff7 fs19 fc1 sc0 ls0 ws0">different<span class="_ _13"> </span>instruction<span class="_ _13"> </span>types<span class="_ _3"></span>.<span class="_ _13"> </span>W<span class="_ _0"></span>ith<span class="_ _13"> </span>this<span class="_ _13"> </span>framework,<span class="_ _13"> </span>we<span class="_ _6"> </span>could<span class="_ _13"> </span>share<span class="_ _13"> </span>the<span class="_ _13"> </span>hardware</div><div class="t m5 x29 h26 y4677 ff7 fs19 fc1 sc0 ls0 ws0">units<span class="_"> </span>among<span class="_"> </span>the<span class="_"> </span>logic<span class="_"> </span>for<span class="_"> </span>processing<span class="_"> </span>the<span class="_"> </span>different<span class="_"> </span>instruction<span class="_"> </span>types<span class="_ _1"></span>.</div><div class="t m5 x75 h3d y4678 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x29 h26 y4679 ffa fs19 fc1 sc0 ls0 ws0">W<span class="_ _1"></span>e<span class="_"> </span>do<span class="_ _13"> </span>not<span class="_"> </span>need<span class="_ _13"> </span>to<span class="_ _13"> </span>implement<span class="_"> </span>the<span class="_ _13"> </span>ISA<span class="_"> </span>directly<span class="ff7">.<span class="_ _13"> </span>A<span class="_"> </span>direct<span class="_ _13"> </span>implementation<span class="_"> </span>of<span class="_ _13"> </span>the</span></div><div class="t m5 x29 h26 y467a ff7 fs19 fc1 sc0 ls0 ws0">ISA<span class="_ _16"> </span>would<span class="_ _14"> </span>imply<span class="_ _16"> </span>a<span class="_ _14"> </span>very<span class="_ _16"> </span>sequential<span class="_ _16"> </span>design.<span class="_ _14"> </span>T<span class="_ _3"></span>o<span class="_ _16"> </span>achieve<span class="_ _16"> </span>higher<span class="_ _14"> </span>performance<span class="_ _0"></span>,</div><div class="t m5 x29 h26 y467b ff7 fs19 fc1 sc0 ls0 ws0">we<span class="_ _14"> </span>want<span class="_ _14"> </span>to<span class="_ _15"> </span>exploit<span class="_ _14"> </span>the<span class="_ _15"> </span>ability<span class="_ _14"> </span>in<span class="_ _14"> </span>hardware<span class="_ _15"> </span>to<span class="_ _14"> </span>perform<span class="_ _14"> </span>many<span class="_ _15"> </span>operations<span class="_ _14"> </span>si-</div><div class="t m5 x29 h26 y467c ff7 fs19 fc1 sc0 ls0 ws0">multaneously<span class="_ _3"></span>.<span class="_"> </span>T<span class="_ _3"></span>his<span class="_"> </span>led<span class="_"> </span>to<span class="_ _13"> </span>the<span class="_"> </span>use<span class="_"> </span>of<span class="_ _13"> </span>a<span class="_"> </span>pipelined<span class="_"> </span>design.<span class="_ _13"> </span>By<span class="_"> </span>careful<span class="_"> </span>design<span class="_ _13"> </span>and</div><div class="t m5 x29 h26 y467d ff7 fs19 fc1 sc0 ls0 ws0">analysis<span class="_ _1"></span>,<span class="_"> </span>we<span class="_ _13"> </span>can<span class="_ _13"> </span>handle<span class="_"> </span>the<span class="_ _13"> </span>various<span class="_"> </span>pipeline<span class="_ _13"> </span>hazards<span class="_ _1"></span>,<span class="_"> </span>so<span class="_ _13"> </span>that<span class="_"> </span>the<span class="_ _13"> </span>overall<span class="_ _13"> </span>effect</div><div class="t m5 x29 h26 y467e ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_"> </span>running<span class="_ _11"> </span>a<span class="_"> </span>program<span class="_ _11"> </span>exactly<span class="_"> </span>matches<span class="_ _11"> </span>what<span class="_"> </span>would<span class="_"> </span>be<span class="_ _11"> </span>obtained<span class="_"> </span>with<span class="_ _11"> </span>the<span class="_"> </span>ISA</div><div class="t m5 x29 h26 y467f ff7 fs19 fc1 sc0 ls0 ws0">model.</div><div class="t m5 x75 h3d y4680 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x29 h26 y4681 ffa fs19 fc1 sc0 ls0 ws0">Hardware<span class="_ _15"> </span>designers<span class="_ _f"> </span>must<span class="_ _21"> </span>be<span class="_ _f"> </span>meticulous<span class="_ _1"></span>.<span class="_ _16"> </span><span class="ff7">Once<span class="_ _21"> </span>a<span class="_ _f"> </span>chip<span class="_ _21"> </span>has<span class="_ _f"> </span>been<span class="_ _21"> </span>fabricated,</span></div><div class="t m5 x29 h26 y4682 ff7 fs19 fc1 sc0 ls0 ws0">it<span class="_ _14"> </span>is<span class="_ _14"> </span>nearly<span class="_ _14"> </span>impossible<span class="_ _14"> </span>to<span class="_ _14"> </span>correct<span class="_ _14"> </span>any<span class="_ _14"> </span>errors<span class="_ _1"></span>.<span class="_ _14"> </span>It<span class="_ _14"> </span>is<span class="_ _14"> </span>very<span class="_ _15"> </span>important<span class="_ _14"> </span>to<span class="_ _14"> </span>get<span class="_ _14"> </span>the</div><div class="t m5 x29 h26 y4683 ff7 fs19 fc1 sc0 ls0 ws0">design<span class="_ _6"> </span>right<span class="_ _6"> </span>on<span class="_ _6"> </span>the<span class="_ _a"> </span>ﬁrst<span class="_ _6"> </span>try<span class="_ _3"></span>.<span class="_ _6"> </span>This<span class="_ _a"> </span>means<span class="_ _6"> </span>carefully<span class="_ _6"> </span>analyzing<span class="_ _6"> </span>different<span class="_ _6"> </span>instruction</div><div class="t m5 x29 h26 y4684 ff7 fs19 fc1 sc0 ls0 ws0">types<span class="_ _15"> </span>and<span class="_ _21"> </span>combinations<span class="_ _1"></span>,<span class="_ _f"> </span>even<span class="_ _15"> </span>ones<span class="_ _21"> </span>that<span class="_ _21"> </span>do<span class="_ _15"> </span>not<span class="_ _21"> </span>seem<span class="_ _21"> </span>to<span class="_ _15"> </span>make<span class="_ _21"> </span>sense<span class="_ _0"></span>,<span class="_ _21"> </span>such</div><div class="t m5 x29 h26 y4685 ff7 fs19 fc1 sc0 ls0 ws0">as<span class="_ _f"> </span>popping<span class="_ _f"> </span>to<span class="_ _f"> </span>the<span class="_ _e"> </span>stack<span class="_ _21"> </span>pointer.<span class="_ _f"> </span>Designs<span class="_ _f"> </span>must<span class="_ _f"> </span>be<span class="_ _e"> </span>thoroughly<span class="_ _21"> </span>tested<span class="_ _f"> </span>with</div><div class="t m5 x29 h26 y4686 ff7 fs19 fc1 sc0 ls0 ws0">systematic<span class="_ _13"> </span>simulation<span class="_ _13"> </span>test<span class="_ _13"> </span>programs<span class="_ _3"></span>.<span class="_ _13"> </span>In<span class="_ _13"> </span>developing<span class="_ _13"> </span>the<span class="_ _13"> </span>control<span class="_ _13"> </span>logic<span class="_ _13"> </span>for<span class="_ _6"> </span>PIPE,</div><div class="t m5 x29 h26 y4687 ff7 fs19 fc1 sc0 ls0 ws0">our<span class="_ _21"> </span>design<span class="_ _f"> </span>had<span class="_ _f"> </span>a<span class="_ _21"> </span>subtle<span class="_ _f"> </span>bug<span class="_ _f"> </span>that<span class="_ _f"> </span>was<span class="_ _21"> </span>uncovered<span class="_ _f"> </span>only<span class="_ _f"> </span>after<span class="_ _21"> </span>a<span class="_ _f"> </span>careful<span class="_ _f"> </span>and</div><div class="t m5 x29 h26 y4688 ff7 fs19 fc1 sc0 ls0 ws0">systematic<span class="_"> </span>analysis<span class="_"> </span>of<span class="_"> </span>control<span class="_"> </span>combinations<span class="_ _1"></span>.</div><div class="t m5 x1d h41 y2270 ffe fs29 fc1 sc0 ls0 ws0">4.6.1<span class="_ _48"> </span><span class="fs19">Y86-64<span class="_"> </span>Simulators</span></div><div class="t m5 x1d h26 y77e ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _e"> </span>lab<span class="_ _21"> </span>materials<span class="_ _e"> </span>for<span class="_ _f"> </span>this<span class="_ _f"> </span>chapter<span class="_ _e"> </span>include<span class="_ _21"> </span>simulators<span class="_ _e"> </span>for<span class="_ _f"> </span>the<span class="_ _f"> </span>SEQ<span class="_ _e"> </span>and<span class="_ _21"> </span>PIPE</div><div class="t m5 x1d h26 y77f ff7 fs19 fc1 sc0 ls0 ws0">processors<span class="_ _1"></span>.<span class="_"> </span>Each<span class="_"> </span>simulator<span class="_"> </span>has<span class="_"> </span>two<span class="_"> </span>versions:</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
