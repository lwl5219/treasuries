<div id="pf438" class="pf w2 h11" data-page-no="438"><div class="pc pc438 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg438.png"/><div class="t m5 x1fc h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>A.2<span class="_ _60"> </span>Error-Handling<span class="_ _10"> </span>Wrappers<span class="_ _1b"> </span><span class="ffe fs1e">1079</span></div><div class="t m5 x26 h26 ye7 ff7 fs19 fc2 sc0 lsd ws0">Th<span class="_ _2"></span>e<span class="_ _16"> </span><span class="ffd ls0">gai_strerror<span class="_ _16"> </span><span class="ff7">function<span class="_ _11"> </span>returns<span class="_ _16"> </span>a<span class="_ _11"> </span>text<span class="_ _16"> </span>description<span class="_ _11"> </span>for<span class="_ _16"> </span>a<span class="_ _11"> </span>particular<span class="_ _16"> </span>value</span></span></div><div class="t m5 x17 h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">of<span class="_"> </span><span class="ffd">retcode</span>.</div><div class="t m5 x17 h42 ye97 ff6 fs29 fc6 sc0 ls0 ws0">Summary<span class="_ _16"> </span>of<span class="_ _11"> </span>Error-Reporting<span class="_ _16"> </span>Functions</div><div class="t m5 x17 h26 y5f5e ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>houghout<span class="_ _13"> </span>this<span class="_ _13"> </span>book,<span class="_ _13"> </span>we<span class="_ _13"> </span>use<span class="_ _13"> </span>the<span class="_ _6"> </span>following<span class="_ _13"> </span>error<span class="_ _1"></span>-reporting<span class="_ _13"> </span>functions<span class="_ _13"> </span>to<span class="_ _13"> </span>accommo-</div><div class="t m5 x17 h26 y8634 ff7 fs19 fc1 sc0 ls0 ws0">date<span class="_"> </span>different<span class="_"> </span>error<span class="_ _1"></span>-handling<span class="_"> </span>styles<span class="_ _1"></span>.</div><div class="t m5 x31 h2d y8635 ffd fs1e fc2 sc0 ls0 ws0">#include<span class="_ _e"> </span>&quot;csapp.h&quot;</div><div class="t m5 x31 h2d y8636 ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>unix_error(char<span class="_ _1f"> </span>*msg);</div><div class="t m5 x31 h2d y8637 ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>posix_error(int<span class="_ _1f"> </span>code,<span class="_ _1f"> </span>char<span class="_ _e"> </span>*msg);</div><div class="t m5 x31 h2d y8638 ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>gai_error(int<span class="_ _1f"> </span>code,<span class="_ _1f"> </span>char<span class="_ _e"> </span>*msg);</div><div class="t m5 x31 h2d y8639 ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>app_error(char<span class="_ _1f"> </span>*msg);</div><div class="t m5 x6d hf1 y863a ff7 fs1f fc2 sc0 ls0 ws0">Returns:<span class="_"> </span>nothing</div><div class="t m5 x17 h26 y863b ff7 fs19 fc2 sc0 ls0 ws0">As<span class="_"> </span>their<span class="_ _13"> </span>names<span class="_"> </span>suggest,<span class="_ _13"> </span>the<span class="_"> </span><span class="ffd">unix_error</span>,<span class="_"> </span><span class="ffd">posix_error</span>,<span class="_ _13"> </span>and<span class="_"> </span><span class="ffd">gai_error<span class="_ _13"> </span></span>functions</div><div class="t m5 x17 h26 y863c ff7 fs19 fc2 sc0 ls0 ws0">report<span class="_ _13"> </span>Unix-style,<span class="_ _13"> </span>P<span class="_ _1"></span>osix-style<span class="_ _0"></span>,<span class="_ _13"> </span>and<span class="_"> </span>GAI-style<span class="_ _13"> </span>errors<span class="_ _13"> </span>and<span class="_ _13"> </span>then<span class="_"> </span>terminate<span class="_ _1"></span>.<span class="_ _13"> </span>T<span class="_ _0"></span>he<span class="_ _13"> </span><span class="ffd">app_</span></div><div class="t m5 x17 h26 y863d ffd fs19 fc2 sc0 ls0 ws0">error<span class="_ _13"> </span><span class="ff7">function<span class="_ _13"> </span>is<span class="_ _13"> </span>included<span class="_ _13"> </span>as<span class="_ _13"> </span>a<span class="_ _13"> </span>convenience<span class="_ _13"> </span>for<span class="_ _13"> </span>application<span class="_ _13"> </span>errors<span class="_ _1"></span>.<span class="_ _13"> </span>It<span class="_ _13"> </span>simply<span class="_ _13"> </span>prints</span></div><div class="t m5 x17 h26 y863e ff7 fs19 fc2 sc0 ls0 ws0">its<span class="_ _11"> </span>input<span class="_ _16"> </span>and<span class="_ _11"> </span>then<span class="_ _11"> </span>terminates<span class="_ _1"></span>.<span class="_ _16"> </span>F<span class="_ _1"></span>igure<span class="_ _16"> </span>A.1<span class="_ _11"> </span>shows<span class="_ _16"> </span>the<span class="_ _11"> </span>code<span class="_ _11"> </span>for<span class="_ _16"> </span>the<span class="_ _11"> </span>error<span class="_ _1"></span>-reporting</div><div class="t m5 x17 h26 y863f ff7 fs19 fc2 sc0 ls0 ws0">functions<span class="_ _1"></span>.</div><div class="t m5 x17 h3b y8640 fff fs24 fc6 sc0 ls0 ws0">A.2<span class="_ _17"> </span><span class="ffe fs18">Error-Handling<span class="_"> </span>Wrappers</span></div><div class="t m5 x17 h26 y8641 ff7 fs19 fc1 sc0 ls0 ws0">Here<span class="_"> </span>are<span class="_"> </span>some<span class="_"> </span>examples<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>different<span class="_"> </span>error<span class="_ _1"></span>-handling<span class="_"> </span>wrappers<span class="_ _1"></span>.</div><div class="t m5 x72 h26 y8642 ffa fs19 fc1 sc0 ls0 ws0">Unix-style<span class="_ _6"> </span>error-handling<span class="_ _a"> </span>wrappers<span class="_ _0"></span>.<span class="_ _21"> </span><span class="ff7">F<span class="_ _0"></span>igure<span class="_ _6"> </span>A.2<span class="_ _13"> </span>shows<span class="_ _6"> </span>the<span class="_ _6"> </span>wrapper<span class="_ _13"> </span>for<span class="_ _6"> </span>the<span class="_ _6"> </span>Unix-</span></div><div class="t m5 x30 h26 y8643 ff7 fs19 fc1 sc0 ls0 ws0">style<span class="_"> </span><span class="ffd">wait<span class="_ _10"> </span></span>function.<span class="_"> </span>If<span class="_"> </span>the<span class="_"> </span><span class="ffd">wait<span class="_ _10"> </span></span>returns<span class="_"> </span>with<span class="_"> </span>an<span class="_"> </span>error,<span class="_"> </span>the<span class="_"> </span>wrapper<span class="_"> </span>prints</div><div class="t m5 x30 h26 y8644 ff7 fs19 fc1 sc0 ls0 ws0">an<span class="_ _13"> </span>informative<span class="_"> </span>message<span class="_ _13"> </span>and<span class="_"> </span>then<span class="_ _13"> </span>exits<span class="_ _1"></span>.<span class="_"> </span>Otherwise<span class="_ _1"></span>,<span class="_"> </span>it<span class="_ _13"> </span>returns<span class="_"> </span>a<span class="_ _13"> </span>PID<span class="_"> </span>to<span class="_ _13"> </span>the</div><div class="t m5 x30 h26 y8645 ff7 fs19 fc1 sc0 ls0 ws0">caller.<span class="_ _16"> </span>Figure<span class="_ _16"> </span>A.3<span class="_ _14"> </span>shows<span class="_ _14"> </span>the<span class="_ _14"> </span>wrapper<span class="_ _14"> </span>for<span class="_ _14"> </span>the<span class="_ _14"> </span>Unix-style<span class="_ _14"> </span><span class="ffd">kill<span class="_ _14"> </span></span>function.</div><div class="t m5 x30 h26 y8646 ff7 fs19 fc1 sc0 ls0 ws0">Notice<span class="_"> </span>that<span class="_"> </span>this<span class="_"> </span>function,<span class="_"> </span>unlike<span class="_"> </span><span class="ffd">wait</span>,<span class="_"> </span>returns<span class="_"> </span><span class="ffd">void<span class="_ _10"> </span></span>on<span class="_"> </span>success<span class="_ _1"></span>.</div><div class="t m5 x72 h26 y8647 ffa fs19 fc1 sc0 ls0 ws0">P<span class="_ _1"></span>osix-style<span class="_ _e"> </span>error<span class="_ _1"></span>-handling<span class="_ _e"> </span>wrappers<span class="_ _1"></span>.<span class="_ _f"> </span><span class="ff7">F<span class="_ _0"></span>igure<span class="_ _e"> </span>A.4<span class="_ _e"> </span>shows<span class="_ _e"> </span>the<span class="_ _e"> </span>wrapper<span class="_ _e"> </span>for<span class="_ _e"> </span>the</span></div><div class="t m5 x30 h26 y8648 ff7 fs19 fc1 sc0 ls0 ws0">P<span class="_ _1"></span>osix-style<span class="_"> </span><span class="ffd">pthread_detach<span class="_ _11"> </span></span>function.<span class="_"> </span>Like<span class="_ _11"> </span>most<span class="_"> </span>P<span class="_ _1"></span>osix-style<span class="_ _11"> </span>functions<span class="_ _1"></span>,<span class="_ _11"> </span>it</div><div class="t m5 x30 h26 y8649 ff7 fs19 fc1 sc0 ls0 ws0">does<span class="_ _11"> </span>not<span class="_ _11"> </span>overload<span class="_ _11"> </span>useful<span class="_ _11"> </span>results<span class="_ _11"> </span>with<span class="_ _11"> </span>error<span class="_ _1"></span>-return<span class="_ _11"> </span>codes<span class="_ _1"></span>,<span class="_ _11"> </span>so<span class="_ _11"> </span>the<span class="_ _11"> </span>wrapper</div><div class="t m5 x30 h26 y864a ff7 fs19 fc1 sc0 ls0 ws0">returns<span class="_"> </span><span class="ffd">void<span class="_ _10"> </span></span>on<span class="_"> </span>success<span class="_ _1"></span>.</div><div class="t m5 x72 h26 y864b ffa fs19 fc1 sc0 ls0 ws0">GAI-style<span class="_"> </span>error<span class="_ _1"></span>-handling<span class="_"> </span>wrappers<span class="_ _3"></span>.<span class="_ _21"> </span><span class="ff7">Figure<span class="_ _13"> </span>A.5<span class="_"> </span>shows<span class="_"> </span>the<span class="_ _13"> </span>error<span class="_ _1"></span>-handling<span class="_"> </span>wrap-</span></div><div class="t m5 x30 h26 y864c ff7 fs19 fc1 sc0 ls0 ws0">per<span class="_"> </span>for<span class="_"> </span>the<span class="_"> </span>GAI-style<span class="_"> </span><span class="ffd">getaddrinfo<span class="_ _10"> </span></span>function.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
