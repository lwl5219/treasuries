<div id="pf3c2" class="pf w2 h11" data-page-no="3c2"><div class="pc pc3c2 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg3c2.png"/><div class="t m5 x19c h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>11.3<span class="_ _60"> </span>The<span class="_ _10"> </span>Global<span class="_ _10"> </span>IP<span class="_ _10"> </span>Internet<span class="_ _3e"> </span><span class="ffe fs1e">961</span></div><div class="t m5 x34 h2a y548 fff fs1c fc2 sc0 ls0 ws0">Aside<span class="_ _1b"> </span><span class="ff6 fs19">IPv4<span class="_ _11"> </span>and<span class="_ _11"> </span>IPv6</span></div><div class="t m5 x34 h2b y2d0 ff7 fs1e fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _13"> </span>original<span class="_ _13"> </span>Internet<span class="_ _6"> </span>protocol,<span class="_ _13"> </span>with<span class="_ _13"> </span>its<span class="_ _6"> </span>32-bit<span class="_ _13"> </span>addresses<span class="_ _1"></span>,<span class="_ _13"> </span>is<span class="_ _6"> </span>known<span class="_ _13"> </span>as<span class="_ _13"> </span>Internet<span class="_ _6"> </span>Protocol<span class="_ _13"> </span>V<span class="_ _3"></span>ersion<span class="_ _6"> </span>4<span class="_ _13"> </span>(IPv4).</div><div class="t m5 x34 h2b y2d1 ff7 fs1e fc2 sc0 ls0 ws0">In<span class="_ _16"> </span>1996,<span class="_ _14"> </span>the<span class="_ _16"> </span>Internet<span class="_ _16"> </span>Engineering<span class="_ _16"> </span>T<span class="_ _3"></span>ask<span class="_ _16"> </span>F<span class="_ _1"></span>orce<span class="_ _16"> </span>(IETF)<span class="_ _16"> </span>proposed<span class="_ _14"> </span>a<span class="_ _16"> </span>new<span class="_ _16"> </span>version<span class="_ _16"> </span>of<span class="_ _16"> </span>IP<span class="_ _7"></span>,<span class="_ _16"> </span>called<span class="_ _16"> </span>Internet</div><div class="t m5 x34 h2b y2d2 ff7 fs1e fc2 sc0 ls0 ws0">Protocol<span class="_"> </span>V<span class="_ _3"></span>ersion<span class="_ _10"> </span>6<span class="_ _10"> </span>(IPv6),<span class="_ _11"> </span>that<span class="_"> </span>uses<span class="_"> </span>128-bit<span class="_ _11"> </span>addresses<span class="_"> </span>and<span class="_"> </span>that<span class="_ _11"> </span>was<span class="_"> </span>intended<span class="_"> </span>as<span class="_ _11"> </span>the<span class="_"> </span>successor<span class="_"> </span>to<span class="_ _10"> </span>IPv4.</div><div class="t m5 x34 h2b y2d3 ff7 fs1e fc2 sc0 ls0 ws0">However,<span class="_"> </span>as<span class="_ _11"> </span>of<span class="_ _10"> </span>2015,<span class="_ _11"> </span>almost<span class="_ _11"> </span>20<span class="_ _10"> </span>years<span class="_ _11"> </span>later,<span class="_ _10"> </span>the<span class="_ _11"> </span>vast<span class="_ _10"> </span>majority<span class="_ _11"> </span>of<span class="_ _11"> </span>Internet<span class="_ _10"> </span>trafﬁc<span class="_ _11"> </span>is<span class="_ _11"> </span>still<span class="_"> </span>carried<span class="_ _11"> </span>by<span class="_ _11"> </span>IPv4</div><div class="t m5 x34 h2b y2d4 ff7 fs1e fc2 sc0 ls0 ws0">networks<span class="_ _1"></span>.<span class="_"> </span>F<span class="_ _1"></span>or<span class="_"> </span>example,<span class="_"> </span>only<span class="_"> </span>4<span class="_"> </span>percent<span class="_"> </span>of<span class="_"> </span>users<span class="_"> </span>access<span class="_"> </span>Google<span class="_"> </span>services<span class="_"> </span>using<span class="_"> </span>IPv6<span class="_"> </span>[42].</div><div class="t m5 x35 h2b y2d5 ff7 fs1e fc2 sc0 ls0 ws0">Because<span class="_"> </span>of<span class="_"> </span>its<span class="_"> </span>low<span class="_ _10"> </span>adoption<span class="_ _10"> </span>rate,<span class="_"> </span>we<span class="_"> </span>will<span class="_"> </span>not<span class="_"> </span>discuss<span class="_"> </span>IPv6<span class="_"> </span>in<span class="_ _10"> </span>any<span class="_ _10"> </span>detail<span class="_ _10"> </span>in<span class="_ _10"> </span>this<span class="_ _10"> </span>book<span class="_ _10"> </span>and<span class="_ _10"> </span>will<span class="_ _10"> </span>focus</div><div class="t m5 x34 h2b y2d6 ff7 fs1e fc2 sc0 ls0 ws0">exclusively<span class="_ _6"> </span>on<span class="_ _13"> </span>the<span class="_ _6"> </span>concepts<span class="_ _6"> </span>behind<span class="_ _13"> </span>IPv4.<span class="_ _6"> </span>When<span class="_ _6"> </span>we<span class="_ _6"> </span>talk<span class="_ _13"> </span>about<span class="_ _6"> </span>the<span class="_ _13"> </span>Internet,<span class="_ _6"> </span>what<span class="_ _13"> </span>we<span class="_ _a"> </span>mean<span class="_ _13"> </span>is<span class="_ _6"> </span>the<span class="_ _6"> </span>Internet</div><div class="t m5 x34 h2b y549 ff7 fs1e fc2 sc0 ls0 ws0">based<span class="_"> </span>on<span class="_"> </span>IPv4.<span class="_"> </span>Nonetheless<span class="_ _0"></span>,<span class="_"> </span>the<span class="_"> </span>techniques<span class="_"> </span>for<span class="_ _10"> </span>writing<span class="_"> </span>clients<span class="_ _10"> </span>and<span class="_ _10"> </span>servers<span class="_ _10"> </span>that<span class="_ _10"> </span>we<span class="_ _10"> </span>will<span class="_ _10"> </span>teach<span class="_ _10"> </span>you<span class="_"> </span>later</div><div class="t m5 x34 h2b y54a ff7 fs1e fc2 sc0 ls0 ws0">in<span class="_"> </span>this<span class="_"> </span>chapter<span class="_"> </span>are<span class="_"> </span>based<span class="_"> </span>on<span class="_"> </span>modern<span class="_"> </span>interfaces<span class="_"> </span>that<span class="_"> </span>are<span class="_"> </span>independent<span class="_"> </span>of<span class="_"> </span>any<span class="_"> </span>particular<span class="_"> </span>protocol.</div><div class="t m5 x72 h3d y7aab ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y7aac ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _13"> </span>set<span class="_"> </span>of<span class="_ _13"> </span>IP<span class="_ _13"> </span>addresses<span class="_ _13"> </span>is<span class="_ _13"> </span>mapped<span class="_ _13"> </span>to<span class="_ _13"> </span>a<span class="_ _13"> </span>set<span class="_ _13"> </span>of<span class="_ _13"> </span>identiﬁers<span class="_"> </span>called<span class="_ _13"> </span><span class="ffa">Internet<span class="_ _13"> </span>domain</span></div><div class="t m5 x26 h30 y7aad ffa fs19 fc1 sc0 ls0 ws0">names<span class="_ _1"></span>.</div><div class="t m5 x72 h3d y7aae ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y7aaf ff7 fs19 fc1 sc0 ls0 ws0">A<span class="_ _13"> </span>process<span class="_"> </span>on<span class="_ _13"> </span>one<span class="_"> </span>Internet<span class="_ _13"> </span>host<span class="_"> </span>can<span class="_ _13"> </span>communicate<span class="_ _13"> </span>with<span class="_"> </span>a<span class="_ _13"> </span>process<span class="_"> </span>on<span class="_ _13"> </span>any<span class="_ _13"> </span>other</div><div class="t m5 x26 h26 y7ab0 ff7 fs19 fc1 sc0 ls0 ws0">Internet<span class="_"> </span>host<span class="_"> </span>over<span class="_"> </span>a<span class="_"> </span><span class="ffa">connection</span>.</div><div class="t m5 x17 h26 y7ab1 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>following<span class="_"> </span>sections<span class="_"> </span>discuss<span class="_"> </span>these<span class="_"> </span>fundamental<span class="_"> </span>Internet<span class="_"> </span>ideas<span class="_"> </span>in<span class="_"> </span>more<span class="_"> </span>detail.</div><div class="t m5 x17 h41 y7ab2 ffe fs29 fc1 sc0 ls0 ws0">11.3.1<span class="_ _48"> </span><span class="fs19">IP<span class="_"> </span>Addresses</span></div><div class="t m5 x17 h26 y7ab3 ff7 fs19 fc1 sc0 ls0 ws0">An<span class="_ _13"> </span>IP<span class="_ _13"> </span>address<span class="_ _13"> </span>is<span class="_ _13"> </span>an<span class="_ _13"> </span>unsigned<span class="_ _13"> </span>32-bit<span class="_"> </span>integer<span class="_ _1"></span>.<span class="_ _13"> </span>Network<span class="_"> </span>programs<span class="_ _13"> </span>store<span class="_ _13"> </span>IP<span class="_ _13"> </span>addresses</div><div class="t m5 x17 h26 y7ab4 ff7 fs19 fc1 sc0 ls0 ws0">in<span class="_"> </span>the<span class="_"> </span><span class="ffa">IP<span class="_"> </span>address<span class="_"> </span>structure<span class="_"> </span></span>shown<span class="_"> </span>in<span class="_"> </span>F<span class="_ _0"></span>igure<span class="_"> </span>11.9.</div><div class="t m5 x26 h26 y7ab5 ff7 fs19 fc1 sc0 ls0 ws0">Storing<span class="_ _13"> </span>a<span class="_ _13"> </span>scalar<span class="_ _13"> </span>address<span class="_ _13"> </span>in<span class="_"> </span>a<span class="_ _13"> </span>structure<span class="_ _13"> </span>is<span class="_ _13"> </span>an<span class="_ _13"> </span>unfortunate<span class="_ _13"> </span>artifact<span class="_ _13"> </span>from<span class="_ _13"> </span>the<span class="_ _13"> </span>early</div><div class="t m5 x17 h26 y7ab6 ff7 fs19 fc1 sc0 ls0 ws0">implementations<span class="_ _15"> </span>of<span class="_ _14"> </span>the<span class="_ _15"> </span>sockets<span class="_ _15"> </span>interface.<span class="_ _14"> </span>It<span class="_ _15"> </span>would<span class="_ _15"> </span>make<span class="_ _14"> </span>more<span class="_ _15"> </span>sense<span class="_ _15"> </span>to<span class="_ _15"> </span>deﬁne</div><div class="t m5 x17 h26 y7ab7 ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_ _15"> </span>scalar<span class="_ _14"> </span>type<span class="_ _15"> </span>for<span class="_ _15"> </span>IP<span class="_ _15"> </span>addresses<span class="_ _1"></span>,<span class="_ _21"> </span>but<span class="_ _15"> </span>it<span class="_ _15"> </span>is<span class="_ _15"> </span>too<span class="_ _15"> </span>late<span class="_ _15"> </span>to<span class="_ _15"> </span>change<span class="_ _15"> </span>now<span class="_ _15"> </span>because<span class="_ _15"> </span>of<span class="_ _15"> </span>the</div><div class="t m5 x17 h26 y7ab8 ff7 fs19 fc1 sc0 ls0 ws0">enormous<span class="_"> </span>installed<span class="_"> </span>base<span class="_"> </span>of<span class="_"> </span>applications<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y7ab9 ff7 fs19 fc1 sc0 ls0 ws0">Because<span class="_"> </span>Internet<span class="_"> </span>hosts<span class="_"> </span>can<span class="_"> </span>have<span class="_"> </span>different<span class="_"> </span>host<span class="_"> </span>byte<span class="_"> </span>orders<span class="_ _3"></span>,<span class="_"> </span>TCP/IP<span class="_"> </span>deﬁnes<span class="_"> </span>a</div><div class="t m5 x17 h26 y7aba ff7 fs19 fc1 sc0 ls0 ws0">uniform<span class="_ _6"> </span><span class="ffa">network<span class="_ _13"> </span>byte<span class="_ _6"> </span>order<span class="_ _13"> </span></span>(big-endian<span class="_ _6"> </span>byte<span class="_ _13"> </span>order)<span class="_ _6"> </span>for<span class="_ _13"> </span>any<span class="_ _6"> </span>integer<span class="_ _13"> </span>data<span class="_ _6"> </span>item,<span class="_ _13"> </span>such</div><div class="t m5 x17 h26 y7abb ff7 fs19 fc1 sc0 ls0 ws0">as<span class="_ _6"> </span>an<span class="_ _13"> </span>IP<span class="_ _a"> </span>address<span class="_ _1"></span>,<span class="_ _13"> </span>that<span class="_ _6"> </span>is<span class="_ _13"> </span>carried<span class="_ _a"> </span>across<span class="_ _13"> </span>the<span class="_ _a"> </span>network<span class="_ _13"> </span>in<span class="_ _6"> </span>a<span class="_ _6"> </span>packet<span class="_ _13"> </span>header<span class="_ _1"></span>.<span class="_ _13"> </span>Addresses<span class="_ _a"> </span>in</div><div class="t m5 x17 h26 y7abc ff7 fs19 fc1 sc0 ls0 ws0">IP<span class="_"> </span>address<span class="_"> </span>structures<span class="_"> </span>are<span class="_ _11"> </span>always<span class="_"> </span>stored<span class="_"> </span>in<span class="_ _11"> </span>(big-endian)<span class="_"> </span>network<span class="_"> </span>byte<span class="_ _11"> </span>order,<span class="_"> </span>even</div><div class="t m5 x17 h26 y28d4 ff7 fs19 fc1 sc0 ls0 ws0">if<span class="_ _16"> </span>the<span class="_ _16"> </span>host<span class="_ _16"> </span>byte<span class="_ _14"> </span>order<span class="_ _16"> </span>is<span class="_ _16"> </span>little-endian.<span class="_ _14"> </span>Unix<span class="_ _16"> </span>provides<span class="_ _16"> </span>the<span class="_ _16"> </span>following<span class="_ _14"> </span>functions<span class="_ _16"> </span>for</div><div class="t m5 x17 h26 y7abd ff7 fs19 fc1 sc0 ls0 ws0">converting<span class="_"> </span>between<span class="_"> </span>network<span class="_"> </span>and<span class="_"> </span>host<span class="_"> </span>byte<span class="_"> </span>order.</div><div class="t m5 x1e9 h2c y7abe ffa fs16 fc1 sc0 ls0 ws0">code/netp/netpfragments<span class="_ _1"></span>.c</div><div class="t m5 x1b6 h2d y684d ffd fs1e fc2 sc0 ls0 ws0">/*<span class="_ _e"> </span>IP<span class="_ _1f"> </span>address<span class="_ _1f"> </span>structure<span class="_ _e"> </span>*/</div><div class="t m5 x1b6 h2d y7abf ffd fs1e fc2 sc0 ls0 ws0">struct<span class="_ _e"> </span>in_addr<span class="_ _1f"> </span>{</div><div class="t m5 x21e h2d y7ac0 ffd fs1e fc2 sc0 ls0 ws0">uint32_t<span class="_ _1a"> </span>s_addr;<span class="_ _e"> </span>/*<span class="_ _1f"> </span>Address<span class="_ _1f"> </span>in<span class="_ _e"> </span>network<span class="_ _1f"> </span>byte<span class="_ _e"> </span>order<span class="_ _1f"> </span>(big-endian)<span class="_ _1f"> </span>*/</div><div class="t m5 x1b6 h2d y7ac1 ffd fs1e fc2 sc0 ls0 ws0">};</div><div class="t m5 x1e9 h2c y7ac2 ffa fs16 fc2 sc0 ls0 ws0">code/netp/netpfragments<span class="_ _1"></span>.c</div><div class="t m5 x17 h2f y7ac3 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>11.9<span class="_ _66"> </span><span class="fc1">IP<span class="_"> </span>address<span class="_"> </span>structure.</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
