<div id="pf2cc" class="pf w2 h11" data-page-no="2cc"><div class="pc pc2cc w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg2cc.png"/><div class="t m5 x84 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>7.6<span class="_ _60"> </span>Symbol<span class="_ _10"> </span>Resolution<span class="_ _3e"> </span><span class="ffe fs1e">715</span></div><div class="t m5 x17 h31 ye7 ff7 fs21 fc2 sc0 ls0 ws0">Symbol<span class="_ _26"> </span><span class="ffd fs1e">.symtab<span class="_ _10"> </span></span>entry?<span class="_ _26"> </span>Symbol<span class="_"> </span>type<span class="_ _26"> </span>Module<span class="_"> </span>where<span class="_"> </span>deﬁned<span class="_ _85"> </span>Section</div><div class="t m5 x17 h2d yb20 ffd fs1e fc2 sc0 ls0 ws0">buf</div><div class="t m5 x17 h2d y9bb ffd fs1e fc1 sc0 ls0 ws0">bufp0</div><div class="t m5 x17 h2d y9bc ffd fs1e fc1 sc0 ls0 ws0">bufp1</div><div class="t m5 x17 h2d y9bd ffd fs1e fc1 sc0 ls0 ws0">swap</div><div class="t m5 x17 h2d y9be ffd fs1e fc1 sc0 ls0 ws0">temp</div><div class="t m5 x17 h3b y5f04 fff fs24 fc6 sc0 ls0 ws0">7.6<span class="_ _17"> </span><span class="ffe fs18">Symbol<span class="_"> </span>Resolution</span></div><div class="t m5 x17 h26 y5f05 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _11"> </span>linker<span class="_"> </span>resolves<span class="_"> </span>symbol<span class="_ _11"> </span>references<span class="_"> </span>by<span class="_ _11"> </span>associating<span class="_"> </span>each<span class="_ _11"> </span>reference<span class="_"> </span>with<span class="_"> </span>exactly</div><div class="t m5 x17 h26 y5f06 ff7 fs19 fc1 sc0 ls0 ws0">one<span class="_"> </span>symbol<span class="_ _11"> </span>deﬁnition<span class="_"> </span>from<span class="_ _11"> </span>the<span class="_"> </span>symbol<span class="_ _11"> </span>tables<span class="_"> </span>of<span class="_"> </span>its<span class="_ _11"> </span>input<span class="_"> </span>relocatable<span class="_ _11"> </span>object<span class="_"> </span>ﬁles<span class="_ _0"></span>.</div><div class="t m5 x17 h26 y5f07 ff7 fs19 fc1 sc0 ls0 ws0">Symbol<span class="_"> </span>resolution<span class="_ _11"> </span>is<span class="_ _11"> </span>straightforward<span class="_ _11"> </span>for<span class="_ _11"> </span>references<span class="_ _11"> </span>to<span class="_ _11"> </span>local<span class="_ _11"> </span>symbols<span class="_ _11"> </span>that<span class="_ _11"> </span>are<span class="_ _11"> </span>de-</div><div class="t m5 x17 h26 y5f08 ff7 fs19 fc1 sc0 ls0 ws0">ﬁned<span class="_ _13"> </span>in<span class="_ _6"> </span>the<span class="_ _13"> </span>same<span class="_ _13"> </span>module<span class="_ _6"> </span>as<span class="_ _13"> </span>the<span class="_ _13"> </span>reference<span class="_ _1"></span>.<span class="_ _13"> </span>T<span class="_ _1"></span>he<span class="_ _13"> </span>compiler<span class="_ _13"> </span>allows<span class="_ _6"> </span>only<span class="_ _13"> </span>one<span class="_ _13"> </span>deﬁnition</div><div class="t m5 x17 h26 y5f09 ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_"> </span>each<span class="_"> </span>local<span class="_"> </span>symbol<span class="_"> </span>per<span class="_"> </span>module<span class="_ _1"></span>.<span class="_"> </span>The<span class="_ _13"> </span>compiler<span class="_"> </span>also<span class="_"> </span>ensures<span class="_"> </span>that<span class="_"> </span>static<span class="_"> </span>local<span class="_"> </span>vari-</div><div class="t m5 x17 h26 y5f0a ff7 fs19 fc1 sc0 ls0 ws0">ables<span class="_ _1"></span>,<span class="_"> </span>which<span class="_"> </span>get<span class="_"> </span>local<span class="_"> </span>linker<span class="_"> </span>symbols<span class="_ _1"></span>,<span class="_"> </span>have<span class="_"> </span>unique<span class="_"> </span>names<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y5f0b ff7 fs19 fc1 sc0 ls0 ws0">Resolving<span class="_"> </span>references<span class="_ _11"> </span>to<span class="_ _11"> </span>global<span class="_ _11"> </span>symbols<span class="_ _1"></span>,<span class="_ _11"> </span>however,<span class="_ _11"> </span>is<span class="_ _11"> </span>trickier.<span class="_"> </span>When<span class="_"> </span>the<span class="_ _11"> </span>com-</div><div class="t m5 x17 h26 y5f0c ff7 fs19 fc1 sc0 ls0 ws0">piler<span class="_"> </span>encounters<span class="_ _13"> </span>a<span class="_"> </span>symbol<span class="_"> </span>(either<span class="_"> </span>a<span class="_ _13"> </span>variable<span class="_"> </span>or<span class="_"> </span>function<span class="_ _13"> </span>name)<span class="_"> </span>that<span class="_"> </span>is<span class="_"> </span>not<span class="_ _13"> </span>deﬁned</div><div class="t m5 x17 h26 y5f0d ff7 fs19 fc1 sc0 ls0 ws0">in<span class="_"> </span>the<span class="_ _11"> </span>current<span class="_ _11"> </span>module,<span class="_"> </span>it<span class="_ _11"> </span>assumes<span class="_ _11"> </span>that<span class="_ _11"> </span>it<span class="_ _11"> </span>is<span class="_ _11"> </span>deﬁned<span class="_ _11"> </span>in<span class="_ _11"> </span>some<span class="_ _11"> </span>other<span class="_ _11"> </span>module<span class="_ _0"></span>,<span class="_ _11"> </span>gener<span class="_ _1"></span>-</div><div class="t m5 x17 h26 y5f0e ff7 fs19 fc1 sc0 ls0 ws0">ates<span class="_ _13"> </span>a<span class="_"> </span>linker<span class="_ _13"> </span>symbol<span class="_ _13"> </span>table<span class="_"> </span>entry<span class="_ _7"></span>,<span class="_"> </span>and<span class="_ _13"> </span>leaves<span class="_ _13"> </span>it<span class="_"> </span>for<span class="_ _13"> </span>the<span class="_ _13"> </span>linker<span class="_"> </span>to<span class="_ _13"> </span>handle<span class="_ _0"></span>.<span class="_ _13"> </span>If<span class="_"> </span>the<span class="_ _13"> </span>linker</div><div class="t m5 x17 h26 y5f0f ff7 fs19 fc1 sc0 ls0 ws0">is<span class="_ _13"> </span>unable<span class="_ _13"> </span>to<span class="_ _13"> </span>ﬁnd<span class="_ _13"> </span>a<span class="_"> </span>deﬁnition<span class="_ _13"> </span>for<span class="_ _13"> </span>the<span class="_ _13"> </span>referenced<span class="_ _13"> </span>symbol<span class="_ _13"> </span>in<span class="_ _13"> </span>any<span class="_ _13"> </span>of<span class="_"> </span>its<span class="_ _13"> </span>input<span class="_ _13"> </span>modules<span class="_ _3"></span>,</div><div class="t m5 x17 h26 y5f10 ff7 fs19 fc1 sc0 ls0 ws0">it<span class="_ _13"> </span>prints<span class="_"> </span>an<span class="_ _13"> </span>(often<span class="_ _13"> </span>cryptic)<span class="_"> </span>error<span class="_ _13"> </span>message<span class="_"> </span>and<span class="_ _13"> </span>terminates<span class="_ _1"></span>.<span class="_ _13"> </span>F<span class="_ _1"></span>or<span class="_"> </span>example<span class="_ _1"></span>,<span class="_"> </span>if<span class="_ _13"> </span>we<span class="_ _13"> </span>try<span class="_"> </span>to</div><div class="t m5 x17 h26 y5f11 ff7 fs19 fc1 sc0 ls0 ws0">compile<span class="_"> </span>and<span class="_"> </span>link<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>source<span class="_"> </span>ﬁle<span class="_"> </span>on<span class="_"> </span>a<span class="_"> </span>Linux<span class="_"> </span>machine<span class="_ _1"></span>,</div><div class="t m5 x2c h2d y5f12 ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">void<span class="_ _1f"> </span>foo(void);</span></div><div class="t m5 x2c h2e y5f13 ff6 fs20 fc6 sc0 ls0 ws0">2</div><div class="t m5 x2c h2e y5f14 ff6 fs20 fc6 sc0 ls0 ws0">3</div><div class="t m5 x2d h2d y5f15 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>main()<span class="_ _1f"> </span>{</div><div class="t m5 x2c h2d y5f16 ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _20"> </span><span class="ffd fs1e fc2">foo();</span></div><div class="t m5 x2c h2e y5f17 ff6 fs20 fc6 sc0 ls0 ws0">5</div><div class="t m5 x142 h2d y5f18 ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>0;</div><div class="t m5 x2c h2d y5f19 ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x17 h26 y5f1a ff7 fs19 fc2 sc0 ls0 ws0">then<span class="_ _11"> </span>the<span class="_ _11"> </span>compiler<span class="_ _11"> </span>runs<span class="_"> </span>without<span class="_ _11"> </span>a<span class="_ _11"> </span>hitch,<span class="_ _16"> </span>but<span class="_"> </span>the<span class="_ _11"> </span>linker<span class="_ _11"> </span>terminates<span class="_ _11"> </span>when<span class="_ _11"> </span>it<span class="_ _11"> </span>cannot</div><div class="t m5 x17 h26 y5f1b ff7 fs19 fc2 sc0 ls0 ws0">resolve<span class="_"> </span>the<span class="_"> </span>reference<span class="_"> </span>to<span class="_"> </span><span class="ffd">foo</span>:</div><div class="t m5 x17 h2d y5f1c ffd fs1e fc2 sc0 ls0 ws0">linux&gt;<span class="_ _e"> </span><span class="ff13">gcc<span class="_ _1f"> </span>-Wall<span class="_ _1f"> </span>-Og<span class="_ _e"> </span>-o<span class="_ _1f"> </span>linkerror<span class="_ _e"> </span>linkerror.c</span></div><div class="t m5 x17 h2d y5f1d ffd fs1e fc2 sc0 ls0 ws0">/tmp/ccSz5uti.o:<span class="_ _e"> </span>In<span class="_ _1f"> </span>function<span class="_ _1f"> </span>‘main’:</div><div class="t m5 x17 h2d y5f1e ffd fs1e fc2 sc0 ls0 ws0">/tmp/ccSz5uti.o(.text+0x7):<span class="_ _e"> </span>undefined<span class="_ _1f"> </span>reference<span class="_ _1f"> </span>to<span class="_ _e"> </span>‘foo’</div><div class="t m5 x26 h26 y24e1 ff7 fs19 fc2 sc0 ls0 ws0">Symbol<span class="_ _16"> </span>resolution<span class="_ _16"> </span>for<span class="_ _14"> </span>global<span class="_ _16"> </span>symbols<span class="_ _14"> </span>is<span class="_ _16"> </span>also<span class="_ _16"> </span>tricky<span class="_ _14"> </span>because<span class="_ _16"> </span>multiple<span class="_ _14"> </span>object</div><div class="t m5 x17 h26 y4657 ff7 fs19 fc2 sc0 ls0 ws0">modules<span class="_"> </span>might<span class="_"> </span>deﬁne<span class="_"> </span>global<span class="_"> </span>symbols<span class="_"> </span>with<span class="_"> </span>the<span class="_ _13"> </span>same<span class="_"> </span>name.<span class="_"> </span>In<span class="_ _13"> </span>this<span class="_"> </span>case,<span class="_"> </span>the<span class="_"> </span>linker</div><div class="t m5 x17 h26 y4658 ff7 fs19 fc2 sc0 ls0 ws0">must<span class="_ _16"> </span>either<span class="_ _16"> </span>ﬂag<span class="_ _16"> </span>an<span class="_ _16"> </span>error<span class="_ _16"> </span>or<span class="_ _16"> </span>somehow<span class="_ _11"> </span>choose<span class="_ _16"> </span>one<span class="_ _16"> </span>of<span class="_ _16"> </span>the<span class="_ _16"> </span>deﬁnitions<span class="_ _16"> </span>and<span class="_ _16"> </span>discard</div><div class="t m5 x17 h26 y4659 ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _11"> </span>rest.<span class="_ _11"> </span>The<span class="_"> </span>approach<span class="_ _11"> </span>adopted<span class="_ _16"> </span>by<span class="_ _11"> </span>Linux<span class="_ _11"> </span>systems<span class="_ _11"> </span>involves<span class="_ _16"> </span>cooperation<span class="_ _11"> </span>between</div><div class="t m5 x17 h26 y465a ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _11"> </span>compiler,<span class="_ _11"> </span>assembler,<span class="_ _11"> </span>and<span class="_ _16"> </span>linker<span class="_ _11"> </span>and<span class="_ _11"> </span>can<span class="_ _16"> </span>introduce<span class="_ _11"> </span>some<span class="_ _11"> </span>bafﬂing<span class="_ _16"> </span>bugs<span class="_ _11"> </span>to<span class="_ _11"> </span>the</div><div class="t m5 x17 h26 y271e ff7 fs19 fc2 sc0 ls0 ws0">unwary<span class="_"> </span>programmer.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
