<div id="pf1bc" class="pf w2 h11" data-page-no="1bc"><div class="pc pc1bc w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1bc.png"/><div class="t m5 x99 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>4.3<span class="_ _60"> </span>Sequential<span class="_ _10"> </span>Y86-64<span class="_ _10"> </span>Implementations<span class="_ _3e"> </span><span class="ffe fs1e">443</span></div><div class="t m5 x17 h2f ye7 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>4.28</div><div class="t m5 x17 h2f y58a ffe fs16 fc1 sc0 ls0 ws0">SEQ<span class="_ _16"> </span>decode<span class="_ _16"> </span>and<span class="_ _14"> </span>write-back</div><div class="t m5 x17 h34 y58b ffe fs16 fc1 sc0 ls0 ws0">stage.<span class="_ _11"> </span><span class="ff6">The<span class="_ _11"> </span>instruction<span class="_ _11"> </span>ﬁelds<span class="_ _16"> </span>are</span></div><div class="t m5 x17 h34 y58c ff6 fs16 fc1 sc0 ls0 ws0">decoded<span class="_ _16"> </span>to<span class="_ _16"> </span>generate<span class="_ _14"> </span>register</div><div class="t m5 x17 h34 y58d ff6 fs16 fc1 sc0 ls0 ws0">identiﬁers<span class="_ _10"> </span>for<span class="_ _10"> </span>four<span class="_ _10"> </span>addresses<span class="_ _10"> </span>(two</div><div class="t m5 x17 h34 y58e ff6 fs16 fc1 sc0 ls0 ws0">read<span class="_ _16"> </span>and<span class="_ _14"> </span>two<span class="_ _16"> </span>write)<span class="_ _14"> </span>used<span class="_ _14"> </span>by</div><div class="t m5 x17 h34 y58f ff6 fs16 fc1 sc0 ls0 ws0">the<span class="_ _11"> </span>register<span class="_ _11"> </span>ﬁle.<span class="_ _11"> </span>The<span class="_ _11"> </span>values<span class="_ _11"> </span>read</div><div class="t m5 x17 h34 y8d9 ff6 fs16 fc1 sc0 ls0 ws0">from<span class="_ _10"> </span>the<span class="_ _11"> </span>register<span class="_ _10"> </span>ﬁle<span class="_ _11"> </span>become<span class="_ _11"> </span>the</div><div class="t m5 x17 h34 y8da ff6 fs16 fc1 sc0 ls0 ws0">signals<span class="_ _16"> </span>valA<span class="_ _11"> </span>and<span class="_ _16"> </span>valB.<span class="_ _16"> </span>The<span class="_ _11"> </span>two</div><div class="t m5 x17 h34 y8db ff6 fs16 fc1 sc0 ls0 ws0">write-back<span class="_ _11"> </span>values<span class="_ _11"> </span>valE<span class="_ _11"> </span>and<span class="_ _11"> </span>valM</div><div class="t m5 x17 h34 y3d33 ff6 fs16 fc1 sc0 ls0 ws0">serve<span class="_ _10"> </span>as<span class="_ _11"> </span>the<span class="_ _10"> </span>data<span class="_ _11"> </span>for<span class="_ _10"> </span>the<span class="_ _11"> </span>writes.</div><div class="t m5 x7b h94 y3d34 ff41 fs58 fc1 sc0 ls0 ws0">valA<span class="_ _1b5"></span>Cnd<span class="_ _a7"> </span>valB<span class="_ _46"> </span>valM<span class="_ _ea"> </span>valE</div><div class="t m5 xd2 h94 y3d35 ff41 fs58 fc1 sc0 ls0 ws0">Register</div><div class="t m5 x39 h94 y3d36 ff41 fs58 fc1 sc0 ls0 ws0">file</div><div class="t m5 xb8 h95 y3d37 ff41 fs59 fc1 sc0 ls0 ws0">A</div><div class="t m5 x15 h96 y3d38 ff41 fs5a fc1 sc0 ls0 ws0">dstE<span class="_ _25"> </span>dstM<span class="_ _24"> </span>srcA<span class="_ _24"> </span>srcB</div><div class="t m5 x16e h94 y3d39 ff41 fs58 fc1 sc0 ls0 ws0">dstE<span class="_ _23"> </span>dstM<span class="_ _23"> </span>srcA<span class="_ _22"> </span>srcB</div><div class="t m5 x19d h94 y3d3a ff41 fs58 fc1 sc0 ls0 ws0">rA<span class="_ _1a5"></span>icode<span class="_ _138"> </span>rB</div><div class="t m5 xc0 h95 y3d37 ff41 fs59 fc1 sc0 ls0 ws0">B</div><div class="t m5 x19c h95 y3d3b ff41 fs59 fc1 sc0 ls0 ws0">M</div><div class="t m5 xe8 h95 y3d3c ff41 fs59 fc1 sc0 ls0 ws0">E</div><div class="t m5 x17 h26 y3d3d ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _13"> </span>desired<span class="_ _13"> </span>value<span class="_ _13"> </span>depends<span class="_ _6"> </span>on<span class="_ _13"> </span>the<span class="_ _13"> </span>instruction<span class="_ _13"> </span>type<span class="_ _1"></span>,<span class="_ _13"> </span>as<span class="_ _13"> </span>shown<span class="_ _13"> </span>in<span class="_ _6"> </span>the<span class="_ _13"> </span>ﬁrst<span class="_ _13"> </span>row<span class="_ _13"> </span>for<span class="_ _6"> </span>the</div><div class="t m5 x17 h26 y3d3e ff7 fs19 fc1 sc0 ls0 ws0">decode<span class="_ _11"> </span>stage<span class="_ _16"> </span>in<span class="_ _11"> </span>F<span class="_ _0"></span>igures<span class="_ _11"> </span>4.18<span class="_ _16"> </span>to<span class="_ _11"> </span>4.21.<span class="_ _11"> </span>Combining<span class="_ _16"> </span>all<span class="_ _11"> </span>of<span class="_ _11"> </span>these<span class="_ _16"> </span>entries<span class="_ _11"> </span>into<span class="_ _16"> </span>a<span class="_ _11"> </span>single</div><div class="t m5 x17 h26 y3d3f ff7 fs19 fc1 sc0 ls0 ws0">computation<span class="_"> </span>gives<span class="_ _11"> </span>the<span class="_ _11"> </span>following<span class="_ _11"> </span>HCL<span class="_ _11"> </span>description<span class="_ _11"> </span>of<span class="_ _11"> </span><span class="ff6">srcA<span class="_ _10"> </span></span>(recall<span class="_ _11"> </span>that<span class="_ _11"> </span><span class="ffd">RESP<span class="_ _11"> </span></span>is<span class="_"> </span>the</div><div class="t m5 x17 h26 y3d40 ff7 fs19 fc1 sc0 ls0 ws0">register<span class="_"> </span>ID<span class="_"> </span>of<span class="_"> </span><span class="ffd">%rsp</span>):</div><div class="t m5 x17 h2d y3d41 ffd fs1e fc2 sc0 ls0 ws0">word<span class="_ _e"> </span>srcA<span class="_ _1f"> </span>=<span class="_ _1f"> </span>[</div><div class="t m5 x21e h2d y3d42 ffd fs1e fc2 sc0 ls0 ws0">icode<span class="_ _e"> </span>in<span class="_ _1f"> </span>{<span class="_ _1f"> </span>IRRMOVQ,<span class="_ _e"> </span>IRMMOVQ,<span class="_ _1f"> </span>IOPQ,<span class="_ _e"> </span>IPUSHQ<span class="_ _1a"> </span>}<span class="_ _1f"> </span>:<span class="_ _1f"> </span>rA;</div><div class="t m5 x21e h2d y3d43 ffd fs1e fc2 sc0 ls0 ws0">icode<span class="_ _e"> </span>in<span class="_ _1f"> </span>{<span class="_ _1f"> </span>IPOPQ,<span class="_ _e"> </span>IRET<span class="_ _1f"> </span>}<span class="_ _e"> </span>:<span class="_ _1f"> </span>RRSP;</div><div class="t m5 x21e h2d y3d44 ffd fs1e fc2 sc0 ls0 ws0">1<span class="_ _e"> </span>:<span class="_ _1f"> </span>RNONE;<span class="_ _1f"> </span>#<span class="_ _e"> </span>Don’t<span class="_ _1f"> </span>need<span class="_ _e"> </span>register</div><div class="t m5 x17 h2d y3d45 ffd fs1e fc2 sc0 ls0 ws0">];</div><div class="t m5 x17 h47 y3d46 ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>4.20<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>524)</span></div><div class="t m5 x17 h26 y3d47 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _14"> </span>register<span class="_ _16"> </span>signal<span class="_ _14"> </span><span class="ff6">srcB<span class="_ _16"> </span></span>indicates<span class="_ _16"> </span>which<span class="_ _16"> </span>register<span class="_ _14"> </span>should<span class="_ _16"> </span>be<span class="_ _14"> </span>read<span class="_ _16"> </span>to<span class="_ _14"> </span>generate<span class="_ _16"> </span>the</div><div class="t m5 x17 h26 y3d48 ff7 fs19 fc1 sc0 ls0 ws0">signal<span class="_ _11"> </span><span class="ff6">valB</span>.<span class="_ _11"> </span>T<span class="_ _1"></span>he<span class="_ _11"> </span>desired<span class="_ _11"> </span>value<span class="_ _16"> </span>is<span class="_"> </span>shown<span class="_ _11"> </span>as<span class="_ _11"> </span>the<span class="_ _11"> </span>second<span class="_ _11"> </span>step<span class="_ _11"> </span>in<span class="_ _16"> </span>the<span class="_"> </span>decode<span class="_ _11"> </span>stage<span class="_ _11"> </span>in</div><div class="t m5 x17 h26 y3d49 ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>igures<span class="_"> </span>4.18<span class="_"> </span>to<span class="_"> </span>4.21.<span class="_"> </span>Write<span class="_"> </span>HCL<span class="_"> </span>code<span class="_"> </span>for<span class="_"> </span><span class="ff6">srcB</span>.</div><div class="t m5 x26 h26 y3d4a ff7 fs19 fc1 sc0 ls0 ws0">Register<span class="_ _13"> </span>ID<span class="_"> </span><span class="ff6">dstE<span class="_ _13"> </span></span>indicates<span class="_ _13"> </span>the<span class="_"> </span>destination<span class="_ _13"> </span>register<span class="_ _13"> </span>for<span class="_ _13"> </span>write<span class="_"> </span>port<span class="_ _13"> </span>E,<span class="_ _13"> </span>where<span class="_"> </span>the</div><div class="t m5 x17 h26 y3d4b ff7 fs19 fc1 sc0 ls0 ws0">computed<span class="_ _14"> </span>value<span class="_ _16"> </span><span class="ff6">valE<span class="_ _14"> </span></span>is<span class="_ _14"> </span>stored.<span class="_ _14"> </span>T<span class="_ _0"></span>his<span class="_ _16"> </span>is<span class="_ _14"> </span>shown<span class="_ _14"> </span>in<span class="_ _14"> </span>Figures<span class="_ _16"> </span>4.18<span class="_ _14"> </span>to<span class="_ _16"> </span>4.21<span class="_ _14"> </span>as<span class="_ _14"> </span>the<span class="_ _14"> </span>ﬁrst</div><div class="t m5 x17 h26 y3d4c ff7 fs19 fc1 sc0 ls0 ws0">step<span class="_ _16"> </span>in<span class="_ _16"> </span>the<span class="_ _16"> </span>write-back<span class="_ _16"> </span>stage<span class="_ _1"></span>.<span class="_ _16"> </span>If<span class="_ _16"> </span>we<span class="_ _16"> </span>ignore<span class="_ _16"> </span>for<span class="_ _16"> </span>the<span class="_ _16"> </span>moment<span class="_ _16"> </span>the<span class="_ _16"> </span>conditional<span class="_ _16"> </span>move</div><div class="t m5 x17 h26 y3d4d ff7 fs19 fc1 sc0 ls0 ws0">instructions<span class="_ _1"></span>,<span class="_"> </span>then<span class="_"> </span>we<span class="_"> </span>can<span class="_ _13"> </span>combine<span class="_"> </span>the<span class="_"> </span>destination<span class="_"> </span>registers<span class="_"> </span>for<span class="_ _13"> </span>all<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>different</div><div class="t m5 x17 h26 y3d4e ff7 fs19 fc1 sc0 ls0 ws0">instructions<span class="_"> </span>to<span class="_"> </span>give<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>HCL<span class="_"> </span>description<span class="_"> </span>of<span class="_"> </span><span class="ff6">dstE</span>:</div><div class="t m5 x17 h2d y3d4f ffd fs1e fc2 sc0 ls0 ws0">#<span class="_ _e"> </span>WARNING:<span class="_ _1f"> </span>Conditional<span class="_ _1f"> </span>move<span class="_ _e"> </span>not<span class="_ _1f"> </span>implemented<span class="_ _e"> </span>correctly<span class="_ _1f"> </span>here</div><div class="t m5 x17 h2d y3d50 ffd fs1e fc2 sc0 ls0 ws0">word<span class="_ _e"> </span>dstE<span class="_ _1f"> </span>=<span class="_ _1f"> </span>[</div><div class="t m5 x21e h2d y3d51 ffd fs1e fc2 sc0 ls0 ws0">icode<span class="_ _e"> </span>in<span class="_ _1f"> </span>{<span class="_ _1f"> </span>IRRMOV<span class="ls33">Q}:r<span class="_ _41"></span>B<span class="_ _41"></span>;</span></div><div class="t m5 x21e h2d y3d52 ffd fs1e fc2 sc0 ls0 ws0">icode<span class="_ _e"> </span>in<span class="_ _1f"> </span>{<span class="_ _1f"> </span>IIRMOVQ,<span class="_ _e"> </span>IOPQ}<span class="_ _1f"> </span>:<span class="_ _e"> </span>rB;</div><div class="t m5 x21e h2d y3d53 ffd fs1e fc2 sc0 ls0 ws0">icode<span class="_ _e"> </span>in<span class="_ _1f"> </span>{<span class="_ _1f"> </span>IPUSHQ,<span class="_ _e"> </span>IPOPQ,<span class="_ _1f"> </span>ICALL,<span class="_ _e"> </span>IRET<span class="_ _1f"> </span>}<span class="_ _1f"> </span>:<span class="_ _e"> </span>RRSP;</div><div class="t m5 x21e h2d y3d54 ffd fs1e fc2 sc0 ls0 ws0">1<span class="_ _e"> </span>:<span class="_ _1f"> </span>RNONE;<span class="_ _1a"> </span>#<span class="_ _1f"> </span>Don’t<span class="_ _e"> </span>write<span class="_ _1f"> </span>any<span class="_ _e"> </span>register</div><div class="t m5 x17 h2d y3d55 ffd fs1e fc2 sc0 ls0 ws0">];</div><div class="t m5 x26 h26 y15bf ff7 fs19 fc2 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_"> </span>will<span class="_"> </span>revisit<span class="_ _11"> </span>this<span class="_"> </span>signal<span class="_"> </span>and<span class="_"> </span>how<span class="_ _11"> </span>to<span class="_"> </span>implement<span class="_"> </span>conditional<span class="_"> </span>moves<span class="_ _11"> </span>when<span class="_"> </span>we</div><div class="t m5 x17 h26 y15c0 ff7 fs19 fc2 sc0 ls0 ws0">examine<span class="_"> </span>the<span class="_"> </span>execute<span class="_"> </span>stage<span class="_ _1"></span>.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
