<div id="pf1fa" class="pf w2 h11" data-page-no="1fa"><div class="pc pc1fa w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1fa.png"/><div class="t m5 x13d h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>4.5<span class="_ _60"> </span>Pipelined<span class="_ _10"> </span>Y86-64<span class="_ _10"> </span>Implementations<span class="_ _3e"> </span><span class="ffe fs1e">505</span></div><div class="t m5 x17 h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">division<span class="_"> </span>and<span class="_"> </span>ﬂoating-point<span class="_ _11"> </span>operations<span class="_ _1"></span>.<span class="_"> </span>In<span class="_ _11"> </span>a<span class="_"> </span>medium-performance<span class="_ _11"> </span>processor<span class="_"> </span>such</div><div class="t m5 x17 h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">as<span class="_"> </span>PIPE,<span class="_"> </span>typical<span class="_"> </span>execution<span class="_ _13"> </span>times<span class="_"> </span>for<span class="_"> </span>these<span class="_"> </span>operations<span class="_"> </span>range<span class="_"> </span>from<span class="_"> </span>3<span class="_ _13"> </span>or<span class="_"> </span>4<span class="_"> </span>cycles<span class="_"> </span>for</div><div class="t m5 x17 h26 y2a8 ff7 fs19 fc2 sc0 ls0 ws0">ﬂoating-point<span class="_ _16"> </span>addition<span class="_ _14"> </span>up<span class="_ _14"> </span>to<span class="_ _14"> </span>64<span class="_ _16"> </span>cycles<span class="_ _14"> </span>for<span class="_ _16"> </span>integer<span class="_ _14"> </span>division.<span class="_ _14"> </span>T<span class="_ _3"></span>o<span class="_ _16"> </span>implement<span class="_ _14"> </span>these</div><div class="t m5 x17 h26 y2f7 ff7 fs19 fc2 sc0 ls0 ws0">instructions<span class="_ _1"></span>,<span class="_ _14"> </span>we<span class="_ _16"> </span>require<span class="_ _16"> </span>both<span class="_ _16"> </span>additional<span class="_ _14"> </span>hardware<span class="_ _16"> </span>to<span class="_ _16"> </span>perform<span class="_ _14"> </span>the<span class="_ _16"> </span>computations</div><div class="t m5 x17 h26 y2f8 ff7 fs19 fc2 sc0 ls0 ws0">and<span class="_"> </span>a<span class="_ _11"> </span>mechanism<span class="_"> </span>to<span class="_ _11"> </span>coordinate<span class="_"> </span>the<span class="_ _11"> </span>processing<span class="_ _11"> </span>of<span class="_"> </span>these<span class="_ _11"> </span>instructions<span class="_"> </span>with<span class="_ _11"> </span>the<span class="_"> </span>rest</div><div class="t m5 x17 h26 y2f9 ff7 fs19 fc2 sc0 ls0 ws0">of<span class="_"> </span>the<span class="_"> </span>pipeline<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y2fa ff7 fs19 fc2 sc0 ls0 ws0">One<span class="_ _15"> </span>simple<span class="_ _15"> </span>approach<span class="_ _21"> </span>to<span class="_ _15"> </span>implementing<span class="_ _15"> </span>multicycle<span class="_ _15"> </span>instructions<span class="_ _15"> </span>is<span class="_ _21"> </span>to<span class="_ _15"> </span>simply</div><div class="t m5 x17 h26 y2fb ff7 fs19 fc2 sc0 ls0 ws0">expand<span class="_"> </span>the<span class="_ _11"> </span>capabilities<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>execute<span class="_ _11"> </span>stage<span class="_ _11"> </span>logic<span class="_ _11"> </span>with<span class="_ _11"> </span>integer<span class="_ _11"> </span>and<span class="_ _11"> </span>ﬂoating-point</div><div class="t m5 x17 h26 y2fc ff7 fs19 fc2 sc0 ls0 ws0">arithmetic<span class="_ _16"> </span>units<span class="_ _1"></span>.<span class="_ _14"> </span>An<span class="_ _16"> </span>instruction<span class="_ _16"> </span>remains<span class="_ _14"> </span>in<span class="_ _16"> </span>the<span class="_ _14"> </span>execute<span class="_ _16"> </span>stage<span class="_ _16"> </span>for<span class="_ _14"> </span>as<span class="_ _16"> </span>many<span class="_ _14"> </span>clock</div><div class="t m5 x17 h26 y2fd ff7 fs19 fc2 sc0 ls0 ws0">cycles<span class="_"> </span>as<span class="_ _13"> </span>it<span class="_"> </span>requires<span class="_ _1"></span>,<span class="_"> </span>causing<span class="_"> </span>the<span class="_"> </span>fetch<span class="_"> </span>and<span class="_"> </span>decode<span class="_ _13"> </span>stages<span class="_"> </span>to<span class="_"> </span>stall.<span class="_"> </span>T<span class="_ _1"></span>his<span class="_"> </span>approach<span class="_"> </span>is</div><div class="t m5 x17 h26 y2fe ff7 fs19 fc2 sc0 ls0 ws0">simple<span class="_"> </span>to<span class="_"> </span>implement,<span class="_"> </span>but<span class="_"> </span>the<span class="_"> </span>resulting<span class="_"> </span>performance<span class="_"> </span>is<span class="_"> </span>not<span class="_"> </span>very<span class="_"> </span>good.</div><div class="t m5 x26 h26 y2ff ff7 fs19 fc2 sc0 ls0 ws0">Better<span class="_ _16"> </span>performance<span class="_ _16"> </span>can<span class="_ _14"> </span>be<span class="_ _16"> </span>achieved<span class="_ _14"> </span>by<span class="_ _16"> </span>handling<span class="_ _16"> </span>the<span class="_ _14"> </span>more<span class="_ _16"> </span>complex<span class="_ _14"> </span>opera-</div><div class="t m5 x17 h26 y300 ff7 fs19 fc2 sc0 ls0 ws0">tions<span class="_ _14"> </span>with<span class="_ _15"> </span>special<span class="_ _15"> </span>hardware<span class="_ _15"> </span>functional<span class="_ _15"> </span>units<span class="_ _14"> </span>that<span class="_ _15"> </span>operate<span class="_ _15"> </span>independently<span class="_ _15"> </span>of<span class="_ _14"> </span>the</div><div class="t m5 x17 h26 y21a ff7 fs19 fc2 sc0 ls0 ws0">main<span class="_"> </span>pipeline.<span class="_"> </span>T<span class="_ _7"></span>ypically<span class="_ _3"></span>,<span class="_ _11"> </span>there<span class="_ _11"> </span>is<span class="_"> </span>one<span class="_ _11"> </span>functional<span class="_ _11"> </span>unit<span class="_ _11"> </span>for<span class="_"> </span>performing<span class="_ _11"> </span>integer<span class="_ _11"> </span>mul-</div><div class="t m5 x17 h26 y450 ff7 fs19 fc2 sc0 ls0 ws0">tiplication<span class="_"> </span>and<span class="_ _13"> </span>division,<span class="_"> </span>and<span class="_ _13"> </span>another<span class="_"> </span>for<span class="_ _13"> </span>performing<span class="_"> </span>ﬂoating-point<span class="_"> </span>operations<span class="_ _3"></span>.<span class="_"> </span>As</div><div class="t m5 x17 h26 y451 ff7 fs19 fc2 sc0 ls0 ws0">an<span class="_ _6"> </span>instruction<span class="_ _13"> </span>enters<span class="_ _a"> </span>the<span class="_ _13"> </span>decode<span class="_ _6"> </span>stage<span class="_ _1"></span>,<span class="_ _13"> </span>it<span class="_ _6"> </span>can<span class="_ _13"> </span>be<span class="_ _a"> </span><span class="ffa">issued<span class="_ _13"> </span></span>to<span class="_ _13"> </span>the<span class="_ _a"> </span>special<span class="_ _13"> </span>unit.<span class="_ _6"> </span>While<span class="_ _a"> </span>the</div><div class="t m5 x17 h26 y452 ff7 fs19 fc2 sc0 ls0 ws0">unit<span class="_"> </span>performs<span class="_ _13"> </span>the<span class="_"> </span>operation,<span class="_ _13"> </span>the<span class="_"> </span>pipeline<span class="_"> </span>continues<span class="_ _13"> </span>processing<span class="_"> </span>other<span class="_ _13"> </span>instructions<span class="_ _1"></span>.</div><div class="t m5 x17 h26 y453 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _7"></span>ypically<span class="_ _3"></span>,<span class="_ _16"> </span>the<span class="_ _11"> </span>ﬂoating-point<span class="_ _16"> </span>unit<span class="_ _11"> </span>is<span class="_ _16"> </span>itself<span class="_ _11"> </span>pipelined,<span class="_ _16"> </span>and<span class="_ _16"> </span>thus<span class="_ _11"> </span>multiple<span class="_ _16"> </span>operations</div><div class="t m5 x17 h26 y454 ff7 fs19 fc2 sc0 ls0 ws0">can<span class="_"> </span>execute<span class="_"> </span>concurrently<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>main<span class="_"> </span>pipeline<span class="_"> </span>and<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>different<span class="_"> </span>units<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y455 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>operations<span class="_ _13"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>different<span class="_"> </span>units<span class="_ _13"> </span>must<span class="_"> </span>be<span class="_ _13"> </span>synchronized<span class="_"> </span>to<span class="_ _13"> </span>avoid<span class="_"> </span>incorrect</div><div class="t m5 x17 h26 y456 ff7 fs19 fc2 sc0 ls0 ws0">behavior.<span class="_ _21"> </span>F<span class="_ _0"></span>or<span class="_ _f"> </span>example,<span class="_ _e"> </span>if<span class="_ _f"> </span>there<span class="_ _f"> </span>are<span class="_ _e"> </span>data<span class="_ _f"> </span>dependencies<span class="_ _f"> </span>between<span class="_ _e"> </span>the<span class="_ _f"> </span>different</div><div class="t m5 x17 h26 y457 ff7 fs19 fc2 sc0 ls0 ws0">operations<span class="_ _16"> </span>being<span class="_ _14"> </span>handled<span class="_ _16"> </span>by<span class="_ _14"> </span>different<span class="_ _16"> </span>units<span class="_ _1"></span>,<span class="_ _14"> </span>the<span class="_ _14"> </span>control<span class="_ _16"> </span>logic<span class="_ _14"> </span>may<span class="_ _16"> </span>need<span class="_ _14"> </span>to<span class="_ _16"> </span>stall</div><div class="t m5 x17 h26 y458 ff7 fs19 fc2 sc0 ls0 ws0">one<span class="_"> </span>part<span class="_"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>system<span class="_"> </span>until<span class="_"> </span>the<span class="_"> </span>results<span class="_"> </span>from<span class="_"> </span>an<span class="_"> </span>operation<span class="_ _13"> </span>handled<span class="_"> </span>by<span class="_"> </span>some<span class="_"> </span>other</div><div class="t m5 x17 h26 y459 ff7 fs19 fc2 sc0 ls0 ws0">part<span class="_ _13"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>system<span class="_"> </span>have<span class="_ _13"> </span>been<span class="_"> </span>completed.<span class="_ _13"> </span>Often,<span class="_"> </span>different<span class="_ _13"> </span>forms<span class="_"> </span>of<span class="_ _13"> </span>forwarding<span class="_"> </span>are</div><div class="t m5 x17 h26 y45a ff7 fs19 fc2 sc0 ls0 ws0">used<span class="_ _11"> </span>to<span class="_ _11"> </span>convey<span class="_ _11"> </span>results<span class="_ _11"> </span>from<span class="_ _11"> </span>one<span class="_ _11"> </span>part<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>system<span class="_ _11"> </span>to<span class="_ _11"> </span>other<span class="_ _11"> </span>parts<span class="_ _1"></span>,<span class="_ _11"> </span>just<span class="_ _11"> </span>as<span class="_ _11"> </span>we<span class="_ _11"> </span>saw</div><div class="t m5 x17 h26 y45b ff7 fs19 fc2 sc0 ls0 ws0">between<span class="_"> </span>the<span class="_"> </span>different<span class="_"> </span>stages<span class="_"> </span>of<span class="_"> </span>PIPE.<span class="_ _13"> </span>The<span class="_"> </span>overall<span class="_ _13"> </span>design<span class="_"> </span>becomes<span class="_"> </span>more<span class="_"> </span>complex</div><div class="t m5 x17 h26 y45c ff7 fs19 fc2 sc0 ls0 ws0">than<span class="_ _13"> </span>we<span class="_ _13"> </span>have<span class="_ _13"> </span>seen<span class="_ _13"> </span>with<span class="_ _13"> </span>PIPE,<span class="_ _13"> </span>but<span class="_ _13"> </span>the<span class="_ _13"> </span>same<span class="_ _6"> </span>techniques<span class="_ _13"> </span>of<span class="_ _13"> </span>stalling,<span class="_ _13"> </span>forwarding,<span class="_ _13"> </span>and</div><div class="t m5 x17 h26 y227 ff7 fs19 fc2 sc0 ls0 ws0">pipeline<span class="_ _16"> </span>control<span class="_ _11"> </span>can<span class="_ _16"> </span>be<span class="_ _16"> </span>used<span class="_ _11"> </span>to<span class="_ _16"> </span>make<span class="_ _11"> </span>the<span class="_ _16"> </span>overall<span class="_ _16"> </span>behavior<span class="_ _11"> </span>match<span class="_ _16"> </span>the<span class="_ _16"> </span>sequential</div><div class="t m5 x17 h26 y45d ff7 fs19 fc2 sc0 ls0 ws0">ISA<span class="_"> </span>model.</div><div class="t m5 x17 h42 y29a8 ff6 fs29 fc6 sc0 ls0 ws0">Interfacing<span class="_ _16"> </span>with<span class="_ _11"> </span>the<span class="_ _16"> </span>Memory<span class="_ _16"> </span>System</div><div class="t m5 x17 h26 y464d ff7 fs19 fc1 sc0 ls0 ws0">In<span class="_ _15"> </span>our<span class="_ _21"> </span>presentation<span class="_ _21"> </span>of<span class="_ _21"> </span>PIPE,<span class="_ _e"> </span>we<span class="_ _15"> </span>assumed<span class="_ _21"> </span>that<span class="_ _21"> </span>both<span class="_ _21"> </span>the<span class="_ _21"> </span>instruction<span class="_ _21"> </span>fetch<span class="_ _21"> </span>unit</div><div class="t m5 x17 h26 y464e ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_ _21"> </span>the<span class="_ _f"> </span>data<span class="_ _21"> </span>memory<span class="_ _f"> </span>could<span class="_ _f"> </span>read<span class="_ _21"> </span>or<span class="_ _f"> </span>write<span class="_ _f"> </span>any<span class="_ _21"> </span>memory<span class="_ _f"> </span>location<span class="_ _f"> </span>in<span class="_ _21"> </span>one<span class="_ _f"> </span>clock</div><div class="t m5 x17 h26 y464f ff7 fs19 fc1 sc0 ls0 ws0">cycle<span class="_ _1"></span>.<span class="_"> </span>W<span class="_ _3"></span>e<span class="_"> </span>also<span class="_"> </span>ignored<span class="_ _11"> </span>the<span class="_"> </span>possible<span class="_"> </span>hazards<span class="_"> </span>caused<span class="_"> </span>by<span class="_"> </span>self-modifying<span class="_"> </span>code<span class="_"> </span>where</div><div class="t m5 x17 h26 y4650 ff7 fs19 fc1 sc0 ls0 ws0">one<span class="_"> </span>instruction<span class="_ _11"> </span>writes<span class="_ _11"> </span>to<span class="_ _11"> </span>the<span class="_"> </span>region<span class="_ _11"> </span>of<span class="_ _11"> </span>memory<span class="_ _11"> </span>from<span class="_"> </span>which<span class="_ _11"> </span>later<span class="_ _11"> </span>instructions<span class="_ _11"> </span>are</div><div class="t m5 x17 h26 y4651 ff7 fs19 fc1 sc0 ls0 ws0">fetched.<span class="_ _11"> </span>Furthermore,<span class="_ _11"> </span>we<span class="_ _16"> </span>reference<span class="_ _11"> </span>memory<span class="_ _16"> </span>locations<span class="_ _11"> </span>according<span class="_ _16"> </span>to<span class="_ _11"> </span>their<span class="_ _16"> </span>virtual</div><div class="t m5 x17 h26 y1fde ff7 fs19 fc1 sc0 ls0 ws0">addresses<span class="_ _1"></span>,<span class="_ _13"> </span>and<span class="_ _6"> </span>these<span class="_ _13"> </span>require<span class="_ _13"> </span>a<span class="_ _6"> </span>translation<span class="_ _13"> </span>into<span class="_ _6"> </span>physical<span class="_ _13"> </span>addresses<span class="_ _6"> </span>before<span class="_ _13"> </span>the<span class="_ _13"> </span>actual</div><div class="t m5 x17 h26 y1fdf ff7 fs19 fc1 sc0 ls0 ws0">read<span class="_"> </span>or<span class="_ _13"> </span>write<span class="_"> </span>operation<span class="_ _13"> </span>can<span class="_"> </span>be<span class="_ _13"> </span>performed.<span class="_"> </span>Clearly<span class="_ _3"></span>,<span class="_"> </span>it<span class="_ _13"> </span>is<span class="_"> </span>unrealistic<span class="_ _13"> </span>to<span class="_"> </span>do<span class="_"> </span>all<span class="_ _13"> </span>of<span class="_"> </span>this</div><div class="t m5 x17 h26 y4652 ff7 fs19 fc1 sc0 ls0 ws0">processing<span class="_"> </span>in<span class="_"> </span>a<span class="_ _13"> </span>single<span class="_"> </span>clock<span class="_"> </span>cycle<span class="_ _1"></span>.<span class="_"> </span>Even<span class="_"> </span>worse<span class="_ _1"></span>,<span class="_"> </span>the<span class="_"> </span>memory<span class="_"> </span>values<span class="_ _13"> </span>being<span class="_"> </span>accessed</div><div class="t m5 x17 h26 y4653 ff7 fs19 fc1 sc0 ls0 ws0">may<span class="_ _16"> </span>reside<span class="_ _11"> </span>on<span class="_ _16"> </span>disk,<span class="_ _16"> </span>requiring<span class="_ _16"> </span>millions<span class="_ _11"> </span>of<span class="_ _16"> </span>clock<span class="_ _16"> </span>cycles<span class="_ _11"> </span>to<span class="_ _16"> </span>read<span class="_ _11"> </span>into<span class="_ _16"> </span>the<span class="_ _16"> </span>processor</div><div class="t m5 x17 h26 y4654 ff7 fs19 fc1 sc0 ls0 ws0">memory<span class="_ _3"></span>.</div><div class="t m5 x26 h26 y4655 ff7 fs19 fc1 sc0 ls0 ws0">As<span class="_ _11"> </span>will<span class="_ _11"> </span>be<span class="_ _11"> </span>discussed<span class="_ _11"> </span>in<span class="_ _16"> </span>Chapters<span class="_"> </span>6<span class="_ _16"> </span>and<span class="_"> </span>9,<span class="_ _16"> </span>the<span class="_ _11"> </span>memory<span class="_ _11"> </span>system<span class="_ _11"> </span>of<span class="_ _11"> </span>a<span class="_ _11"> </span>processor</div><div class="t m5 x17 h26 y4656 ff7 fs19 fc1 sc0 ls0 ws0">uses<span class="_ _14"> </span>a<span class="_ _14"> </span>combination<span class="_ _14"> </span>of<span class="_ _14"> </span>multiple<span class="_ _14"> </span>hardware<span class="_ _14"> </span>memories<span class="_ _14"> </span>and<span class="_ _14"> </span>operating<span class="_ _14"> </span>system<span class="_ _14"> </span>soft-</div><div class="t m5 x17 h26 y1fe4 ff7 fs19 fc1 sc0 ls0 ws0">ware<span class="_ _13"> </span>to<span class="_"> </span>manage<span class="_ _13"> </span>the<span class="_ _13"> </span>virtual<span class="_"> </span>memory<span class="_ _13"> </span>system.<span class="_ _13"> </span>T<span class="_ _0"></span>he<span class="_ _13"> </span>memory<span class="_"> </span>system<span class="_ _13"> </span>is<span class="_ _13"> </span>organized<span class="_"> </span>as<span class="_ _13"> </span>a</div><div class="t m5 x17 h26 y1fe5 ff7 fs19 fc1 sc0 ls0 ws0">hierarchy<span class="_ _3"></span>,<span class="_ _13"> </span>with<span class="_ _13"> </span>faster<span class="_"> </span>but<span class="_ _13"> </span>smaller<span class="_ _13"> </span>memories<span class="_ _13"> </span>holding<span class="_ _13"> </span>a<span class="_"> </span>subset<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>memory<span class="_ _13"> </span>being</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
