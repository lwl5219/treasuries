<div id="pf31e" class="pf w2 h11" data-page-no="31e"><div class="pc pc31e w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg31e.png"/><div class="t m5 x1e0 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>8.5<span class="_ _60"> </span>Signals<span class="_ _3e"> </span><span class="ffe fs1e">797</span></div><div class="t m5 x26 h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _7"></span>yping<span class="_"> </span>Ctrl+C<span class="_"> </span>at<span class="_ _11"> </span>the<span class="_"> </span>keyboard<span class="_"> </span>causes<span class="_ _11"> </span>the<span class="_"> </span>kernel<span class="_"> </span>to<span class="_"> </span>send<span class="_ _11"> </span>a<span class="_"> </span>SIGINT<span class="_"> </span>signal<span class="_"> </span>to</div><div class="t m5 x17 h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">every<span class="_"> </span>process<span class="_ _13"> </span>in<span class="_"> </span>the<span class="_"> </span>foreground<span class="_ _13"> </span>process<span class="_"> </span>group<span class="_ _1"></span>.<span class="_"> </span>In<span class="_ _13"> </span>the<span class="_"> </span>default<span class="_"> </span>case<span class="_ _1"></span>,<span class="_"> </span>the<span class="_"> </span>result<span class="_ _13"> </span>is<span class="_"> </span>to</div><div class="t m5 x17 h26 y2a8 ff7 fs19 fc2 sc0 ls0 ws0">terminate<span class="_ _13"> </span>the<span class="_ _13"> </span>foreground<span class="_"> </span>job<span class="_ _1"></span>.<span class="_ _13"> </span>Similarly<span class="_ _3"></span>,<span class="_"> </span>typing<span class="_ _13"> </span>Ctrl+Z<span class="_ _13"> </span>causes<span class="_ _13"> </span>the<span class="_ _13"> </span>kernel<span class="_"> </span>to<span class="_ _13"> </span>send<span class="_ _13"> </span>a</div><div class="t m5 x17 h26 y2f7 ff7 fs19 fc2 sc0 ls0 ws0">SIGTSTP<span class="_"> </span>signal<span class="_"> </span>to<span class="_"> </span>every<span class="_"> </span>process<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>foreground<span class="_"> </span>process<span class="_"> </span>group.<span class="_"> </span>In<span class="_"> </span>the<span class="_"> </span>default</div><div class="t m5 x17 h26 y2f8 ff7 fs19 fc2 sc0 ls0 ws0">case<span class="_ _1"></span>,<span class="_"> </span>the<span class="_"> </span>result<span class="_"> </span>is<span class="_"> </span>to<span class="_"> </span>stop<span class="_"> </span>(suspend)<span class="_"> </span>the<span class="_"> </span>foreground<span class="_"> </span>job.</div><div class="t m5 x17 h42 y6831 ff6 fs29 fc6 sc0 ls0 ws0">Sending<span class="_ _11"> </span>Signals<span class="_ _16"> </span>with<span class="_ _16"> </span>the<span class="_ _11"> </span><span class="ffd fs2b">kill<span class="_ _16"> </span></span>Function</div><div class="t m5 x17 h26 y6832 ff7 fs19 fc1 sc0 ls0 ws0">Processes<span class="_ _14"> </span>send<span class="_ _14"> </span>signals<span class="_ _15"> </span>to<span class="_ _14"> </span>other<span class="_ _15"> </span>processes<span class="_ _14"> </span>(including<span class="_ _15"> </span>themselves)<span class="_ _14"> </span>by<span class="_ _14"> </span>calling<span class="_ _15"> </span>the</div><div class="t m5 x17 h26 y6833 ffd fs19 fc1 sc0 ls0 ws0">kill<span class="_ _10"> </span><span class="ff7">function.</span></div><div class="t m5 x31 h2d y6834 ffd fs1e fc2 sc0 ls0 ws0">#include<span class="_ _e"> </span>&lt;sys/types.h&gt;</div><div class="t m5 x31 h2d y6835 ffd fs1e fc2 sc0 ls0 ws0">#include<span class="_ _e"> </span>&lt;signal.h&gt;</div><div class="t m5 x31 h2d y6836 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>kill(pid_t<span class="_ _1f"> </span>pid,<span class="_ _1f"> </span>int<span class="_ _e"> </span>sig);</div><div class="t m5 x1db hf2 y6837 ff7 fs1f fc2 sc0 ls0 ws0">Returns:<span class="_"> </span>0<span class="_"> </span>if<span class="_"> </span>OK,<span class="_"> </span><span class="ff12">âˆ’</span>1<span class="_ _13"> </span>on<span class="_"> </span>error</div><div class="t m5 x17 h26 y6838 ff7 fs19 fc2 sc0 ls0 ws0">If<span class="_ _14"> </span><span class="ffd">pid<span class="_ _14"> </span></span>is<span class="_ _14"> </span>greater<span class="_ _14"> </span>than<span class="_ _14"> </span>zero,<span class="_ _14"> </span>then<span class="_ _14"> </span>the<span class="_ _14"> </span><span class="ffd">kill<span class="_ _14"> </span></span>function<span class="_ _14"> </span>sends<span class="_ _14"> </span>signal<span class="_ _14"> </span>number<span class="_ _14"> </span><span class="ffd">sig<span class="_ _14"> </span></span>to</div><div class="t m5 x17 h26 y6839 ff7 fs19 fc2 sc0 ls0 ws0">process<span class="_ _11"> </span><span class="ffd">pid</span><span class="ls285">.I<span class="_ _49"></span>f<span class="ffd ls0">pid<span class="_ _16"> </span><span class="ff7">is<span class="_ _11"> </span>equal<span class="_ _11"> </span>to<span class="_ _16"> </span>zero<span class="_ _1"></span>,<span class="_ _16"> </span>then<span class="_ _11"> </span><span class="ffd">kill<span class="_ _16"> </span></span>sends<span class="_ _11"> </span>signal<span class="_ _16"> </span><span class="ffd">sig<span class="_ _11"> </span></span>to<span class="_ _11"> </span>every<span class="_ _16"> </span>process</span></span></span></div><div class="t m5 x17 h26 y683a ff7 fs19 fc2 sc0 ls0 ws0">in<span class="_ _11"> </span>the<span class="_ _16"> </span>process<span class="_ _11"> </span>group<span class="_ _11"> </span>of<span class="_ _16"> </span>the<span class="_ _11"> </span>calling<span class="_ _11"> </span>process<span class="_ _1"></span>,<span class="_ _16"> </span>including<span class="_ _11"> </span>the<span class="_ _16"> </span>calling<span class="_ _11"> </span>process<span class="_ _11"> </span>itself<span class="_ _0"></span>.<span class="_ _11"> </span>If</div><div class="t m5 x17 h26 y683b ffd fs19 fc2 sc0 ls0 ws0">pid<span class="_ _13"> </span><span class="ff7">is<span class="_"> </span>less<span class="_ _13"> </span>than<span class="_"> </span>zero<span class="_ _1"></span>,<span class="_"> </span>then<span class="_ _13"> </span><span class="ffd">kill<span class="_ _10"> </span></span>sends<span class="_ _13"> </span>signal<span class="_"> </span><span class="ffd">sig<span class="_ _13"> </span></span>to<span class="_ _13"> </span>every<span class="_"> </span>process<span class="_ _13"> </span>in<span class="_"> </span>process<span class="_ _13"> </span>group</span></div><div class="t m5 x17 h46 y683c ff12 fs19 fc2 sc0 ls0 ws0">|<span class="ffd">pid</span>|<span class="_ _11"> </span><span class="ff7">(the<span class="_ _11"> </span>absolute<span class="_ _16"> </span>value<span class="_"> </span>of<span class="_ _11"> </span><span class="ffd">pid</span>).<span class="_ _16"> </span>F<span class="_ _1"></span>igure<span class="_ _11"> </span>8.29<span class="_ _11"> </span>shows<span class="_ _11"> </span>an<span class="_ _16"> </span>example<span class="_"> </span>of<span class="_ _11"> </span>a<span class="_ _11"> </span>parent<span class="_ _16"> </span>that</span></div><div class="t m5 x17 h26 y683d ff7 fs19 fc2 sc0 ls0 ws0">uses<span class="_"> </span>the<span class="_"> </span><span class="ffd">kill<span class="_ _10"> </span></span>function<span class="_"> </span>to<span class="_"> </span>send<span class="_"> </span>a<span class="_"> </span>SIGKILL<span class="_"> </span>signal<span class="_"> </span>to<span class="_"> </span>its<span class="_"> </span>child.</div><div class="t m5 x11a h2c y683e ffa fs16 fc2 sc0 ls0 ws0">code/ecf/kill.c</div><div class="t m5 x2c h2d y683f ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">#include<span class="_ _1f"> </span>&quot;csapp.h&quot;</span></div><div class="t m5 x2c h2e y6840 ff6 fs20 fc6 sc0 ls0 ws0">2</div><div class="t m5 x2c h2e y6841 ff6 fs20 fc6 sc0 ls0 ws0">3</div><div class="t m5 x2d h2d y6842 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>main()</div><div class="t m5 x2c h2d y6843 ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x2c h2d y6844 ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _20"> </span><span class="ffd fs1e fc2">pid_t<span class="_ _e"> </span>pid;</span></div><div class="t m5 x2c h2e y6845 ff6 fs20 fc6 sc0 ls0 ws0">6</div><div class="t m5 x2c h2e y6846 ff6 fs20 fc6 sc0 ls0 ws0">7</div><div class="t m5 x142 h2d y6847 ffd fs1e fc2 sc0 ls0 ws0">/*<span class="_ _e"> </span>Child<span class="_ _1f"> </span>sleeps<span class="_ _1f"> </span>until<span class="_ _e"> </span>SIGKILL<span class="_ _1f"> </span>signal<span class="_ _e"> </span>received,<span class="_ _1f"> </span>then<span class="_ _1f"> </span>dies<span class="_ _e"> </span>*/</div><div class="t m5 x2c h2d y6848 ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _20"> </span><span class="ffd fs1e fc2">if<span class="_ _e"> </span>((pid<span class="_ _1f"> </span>=<span class="_ _1f"> </span>Fork())<span class="_ _e"> </span>==<span class="_ _1f"> </span>0)<span class="_ _e"> </span>{</span></div><div class="t m5 x2c h2d y6849 ff6 fs20 fc6 sc0 ls0 ws0">9<span class="_ _70"> </span><span class="ffd fs1e fc2">Pause();<span class="_ _1a"> </span>/*<span class="_ _e"> </span>Wait<span class="_ _1f"> </span>for<span class="_ _1f"> </span>a<span class="_ _e"> </span>signal<span class="_ _1f"> </span>to<span class="_ _e"> </span>arrive<span class="_ _1f"> </span>*/</span></div><div class="t m5 x17 h2d y684a ff6 fs20 fc6 sc0 ls0 ws0">10<span class="_ _70"> </span><span class="ffd fs1e fc2">printf(&quot;control<span class="_ _e"> </span>should<span class="_ _1f"> </span>never<span class="_ _1f"> </span>reach<span class="_ _e"> </span>here!\n&quot;);</span></div><div class="t m5 x17 h2d y684b ff6 fs20 fc6 sc0 ls0 ws0">11<span class="_ _70"> </span><span class="ffd fs1e fc2">exit(0);</span></div><div class="t m5 x17 h2d y684c ff6 fs20 fc6 sc0 ls0 ws0">12<span class="_ _20"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x17 h2e y684d ff6 fs20 fc6 sc0 ls0 ws0">13</div><div class="t m5 x17 h2e y684e ff6 fs20 fc6 sc0 ls0 ws0">14</div><div class="t m5 x142 h2d ya26 ffd fs1e fc2 sc0 ls0 ws0">/*<span class="_ _e"> </span>Parent<span class="_ _1f"> </span>sends<span class="_ _1f"> </span>a<span class="_ _e"> </span>SIGKILL<span class="_ _1f"> </span>signal<span class="_ _e"> </span>to<span class="_ _1f"> </span>a<span class="_ _1f"> </span>child<span class="_ _e"> </span>*/</div><div class="t m5 x17 h2d y684f ff6 fs20 fc6 sc0 ls0 ws0">15<span class="_ _20"> </span><span class="ffd fs1e fc2">Kill(pid,<span class="_ _e"> </span>SIGKILL);</span></div><div class="t m5 x17 h2d y1862 ff6 fs20 fc6 sc0 ls0 ws0">16<span class="_ _20"> </span><span class="ffd fs1e fc2">exit(0);</span></div><div class="t m5 x17 h2d y18db ff6 fs20 fc6 sc0 ls0 ws0">17<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x11a h2c y6850 ffa fs16 fc2 sc0 ls0 ws0">code/ecf/kill.c</div><div class="t m5 x17 h2f y6851 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>8.29<span class="_ _66"> </span><span class="fc1">Using<span class="_"> </span>the</span></div><div class="t m5 x22b h3a y126e ffd fs19 fc1 sc0 ls0 ws0">kill<span class="_ _10"> </span><span class="ffe fs16">function<span class="_"> </span>to<span class="_"> </span>send<span class="_"> </span>a<span class="_"> </span>signal<span class="_"> </span>to<span class="_"> </span>a<span class="_"> </span>child.</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
