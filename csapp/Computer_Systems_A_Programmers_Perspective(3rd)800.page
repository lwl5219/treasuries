<div id="pf320" class="pf w2 h11" data-page-no="320"><div class="pc pc320 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg320.png"/><div class="t m5 x1e0 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>8.5<span class="_ _60"> </span>Signals<span class="_ _3e"> </span><span class="ffe fs1e">799</span></div><div class="t m5 x26 h26 ye7 ff7 fs19 fc2 sc0 lsd ws0">Th<span class="_ _2"></span>e<span class="_ _10"> </span><span class="ffd ls0">signal<span class="_ _10"> </span><span class="ff7">function<span class="_ _13"> </span>can<span class="_"> </span>change<span class="_ _13"> </span>the<span class="_ _13"> </span>action<span class="_"> </span>associated<span class="_ _13"> </span>with<span class="_ _13"> </span>a<span class="_"> </span>signal<span class="_ _13"> </span></span>signum<span class="_ _10"> </span><span class="ff7">in</span></span></div><div class="t m5 x17 h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">one<span class="_"> </span>of<span class="_"> </span>three<span class="_"> </span>ways:</div><div class="t m5 x72 h3d y687b ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y687c ff7 fs19 fc1 sc0 ls0 ws0">If<span class="_"> </span><span class="ffd">handler<span class="_ _10"> </span></span>is<span class="_"> </span>SIG_IGN<span class="_ _3"></span>,<span class="_"> </span>then<span class="_"> </span>signals<span class="_"> </span>of<span class="_"> </span>type<span class="_"> </span><span class="ffd">signum<span class="_ _10"> </span></span>are<span class="_"> </span>ignored.</div><div class="t m5 x72 h3d y687d ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y687e ff7 fs19 fc1 sc0 ls0 ws0">If<span class="_"> </span><span class="ffd">handler<span class="_ _10"> </span></span>is<span class="_"> </span>SIG_DFL,<span class="_ _11"> </span>then<span class="_"> </span>the<span class="_"> </span>action<span class="_"> </span>for<span class="_"> </span>signals<span class="_"> </span>of<span class="_ _11"> </span>type<span class="_"> </span><span class="ffd">signum<span class="_ _10"> </span></span>reverts<span class="_"> </span>to</div><div class="t m5 x26 h26 y687f ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>default<span class="_"> </span>action.</div><div class="t m5 x72 h3d y6880 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y6881 ff7 fs19 fc1 sc0 ls0 ws0">Otherwise<span class="_ _1"></span>,<span class="_ _16"> </span><span class="ffd">handler<span class="_ _11"> </span></span>is<span class="_ _11"> </span>the<span class="_ _11"> </span>address<span class="_ _11"> </span>of<span class="_ _16"> </span>a<span class="_ _11"> </span>user<span class="_ _1"></span>-deﬁned<span class="_ _11"> </span>function,<span class="_ _11"> </span>called<span class="_ _16"> </span>a<span class="_ _11"> </span><span class="ffa">signal</span></div><div class="t m5 x26 h26 y6882 ffa fs19 fc1 sc0 ls0 ws0">handler<span class="_ _2"></span><span class="ff7">,<span class="_ _15"> </span>that<span class="_ _15"> </span>will<span class="_ _15"> </span>be<span class="_ _15"> </span>called<span class="_ _14"> </span>whenever<span class="_ _15"> </span>the<span class="_ _15"> </span>process<span class="_ _15"> </span>receives<span class="_ _14"> </span>a<span class="_ _15"> </span>signal<span class="_ _15"> </span>of<span class="_ _15"> </span>type</span></div><div class="t m5 x26 h26 y6883 ffd fs19 fc1 sc0 ls0 ws0">signum<span class="ff7">.<span class="_ _16"> </span>Changing<span class="_ _16"> </span>the<span class="_ _16"> </span>default<span class="_ _16"> </span>action<span class="_ _16"> </span>by<span class="_ _16"> </span>passing<span class="_ _16"> </span>the<span class="_ _16"> </span>address<span class="_ _14"> </span>of<span class="_ _16"> </span>a<span class="_ _16"> </span>handler<span class="_ _16"> </span>to</span></div><div class="t m5 x26 h26 y6884 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span><span class="ffd">signal<span class="_ _10"> </span></span>function<span class="_ _11"> </span>is<span class="_"> </span>known<span class="_"> </span>as<span class="_ _11"> </span><span class="ffa">installing<span class="_"> </span>the<span class="_"> </span>handler<span class="_ _2"></span></span>.<span class="_"> </span>The<span class="_"> </span>invocation<span class="_"> </span>of<span class="_"> </span>the</div><div class="t m5 x26 h26 y6885 ff7 fs19 fc1 sc0 ls0 ws0">handler<span class="_"> </span>is<span class="_"> </span>called<span class="_"> </span><span class="ffa">catching<span class="_"> </span>the<span class="_"> </span>signal<span class="_ _5"></span></span>.<span class="_"> </span>T<span class="_ _0"></span>he<span class="_"> </span>execution<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>handler<span class="_ _11"> </span>is<span class="_"> </span>referred</div><div class="t m5 x26 h26 y6886 ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_"> </span>as<span class="_"> </span><span class="ffa">handling<span class="_"> </span>the<span class="_"> </span>signal<span class="_ _2"></span></span>.</div><div class="t m5 x26 h26 y6887 ff7 fs19 fc1 sc0 ls0 ws0">When<span class="_"> </span>a<span class="_ _13"> </span>process<span class="_"> </span>catches<span class="_"> </span>a<span class="_"> </span>signal<span class="_"> </span>of<span class="_"> </span>type<span class="_ _13"> </span><span class="ff11">k<span class="_ _5"></span></span>,<span class="_"> </span>the<span class="_"> </span>handler<span class="_"> </span>installed<span class="_ _13"> </span>for<span class="_"> </span>signal<span class="_"> </span><span class="ff11">k<span class="_ _11"> </span></span>is</div><div class="t m5 x17 h26 y6888 ff7 fs19 fc1 sc0 ls0 ws0">invoked<span class="_ _16"> </span>with<span class="_ _11"> </span>a<span class="_ _16"> </span>single<span class="_ _16"> </span>integer<span class="_ _16"> </span>argument<span class="_ _11"> </span>set<span class="_ _16"> </span>to<span class="_ _16"> </span><span class="ff11">k<span class="_ _2"></span></span>.<span class="_ _16"> </span>T<span class="_ _1"></span>his<span class="_ _16"> </span>argument<span class="_ _16"> </span>allows<span class="_ _11"> </span>the<span class="_ _16"> </span>same</div><div class="t m5 x17 h26 y6889 ff7 fs19 fc1 sc0 ls0 ws0">handler<span class="_"> </span>function<span class="_"> </span>to<span class="_"> </span>catch<span class="_"> </span>different<span class="_"> </span>types<span class="_"> </span>of<span class="_"> </span>signals<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y688a ff7 fs19 fc1 sc0 ls0 ws0">When<span class="_ _a"> </span>the<span class="_ _6"> </span>handler<span class="_ _6"> </span>executes<span class="_ _6"> </span>its<span class="_ _6"> </span><span class="ffd">return<span class="_ _13"> </span></span>statement,<span class="_ _6"> </span>control<span class="_ _6"> </span>(usually)<span class="_ _6"> </span>passes<span class="_ _6"> </span>back</div><div class="t m5 x17 h26 y688b ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_ _16"> </span>the<span class="_ _14"> </span>instruction<span class="_ _14"> </span>in<span class="_ _14"> </span>the<span class="_ _14"> </span>control<span class="_ _16"> </span>ﬂow<span class="_ _14"> </span>where<span class="_ _14"> </span>the<span class="_ _14"> </span>process<span class="_ _14"> </span>was<span class="_ _16"> </span>interrupted<span class="_ _14"> </span>by<span class="_ _14"> </span>the</div><div class="t m5 x17 h26 y688c ff7 fs19 fc1 sc0 ls0 ws0">receipt<span class="_ _6"> </span>of<span class="_ _6"> </span>the<span class="_ _6"> </span>signal.<span class="_ _13"> </span>W<span class="_ _3"></span>e<span class="_ _6"> </span>say<span class="_ _6"> </span>“usually”<span class="_ _6"> </span>because<span class="_ _13"> </span>in<span class="_ _a"> </span>some<span class="_ _6"> </span>systems<span class="_ _0"></span>,<span class="_ _6"> </span>interrupted<span class="_ _13"> </span>system</div><div class="t m5 x17 h26 y688d ff7 fs19 fc1 sc0 ls0 ws0">calls<span class="_"> </span>return<span class="_"> </span>immediately<span class="_"> </span>with<span class="_"> </span>an<span class="_"> </span>error.</div><div class="t m5 x26 h26 y688e ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_ _f"> </span>8.30<span class="_ _f"> </span>shows<span class="_ _f"> </span>a<span class="_ _f"> </span>program<span class="_ _f"> </span>that<span class="_ _f"> </span>catches<span class="_ _f"> </span>the<span class="_ _21"> </span>SIGINT<span class="_ _f"> </span>signal<span class="_ _f"> </span>that<span class="_ _f"> </span>is<span class="_ _f"> </span>sent</div><div class="t m5 x17 h26 y688f ff7 fs19 fc1 sc0 ls0 ws0">whenever<span class="_"> </span>the<span class="_ _11"> </span>user<span class="_"> </span>types<span class="_ _11"> </span>Ctrl+C<span class="_"> </span>at<span class="_ _11"> </span>the<span class="_"> </span>keyboard.<span class="_"> </span>The<span class="_"> </span>default<span class="_"> </span>action<span class="_"> </span>for<span class="_ _11"> </span>SIGINT</div><div class="t m5 x53 h2c y6890 ffa fs16 fc1 sc0 ls0 ws0">code/ecf/sigint.c</div><div class="t m5 x2c h2d y6891 ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">#include<span class="_ _1f"> </span>&quot;csapp.h&quot;</span></div><div class="t m5 x2c h2e y683f ff6 fs20 fc6 sc0 ls0 ws0">2</div><div class="t m5 x2c h2e y6892 ff6 fs20 fc6 sc0 ls0 ws0">3</div><div class="t m5 x2d h2d y6893 ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>sigint_handler(int<span class="_ _1f"> </span>sig)<span class="_ _1f"> </span>/*<span class="_ _e"> </span>SIGINT<span class="_ _1f"> </span>handler<span class="_ _e"> </span>*/</div><div class="t m5 x2c h2d y6894 ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x2c h2d y6895 ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _20"> </span><span class="ffd fs1e fc2">printf(&quot;Caught<span class="_ _e"> </span>SIGINT!\n&quot;);</span></div><div class="t m5 x2c h2d y6896 ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _20"> </span><span class="ffd fs1e fc2">exit(0);</span></div><div class="t m5 x2c h2d y6897 ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x2c h2e y6898 ff6 fs20 fc6 sc0 ls0 ws0">8</div><div class="t m5 x2c h2e y6899 ff6 fs20 fc6 sc0 ls0 ws0">9</div><div class="t m5 x2d h2d y689a ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>main()</div><div class="t m5 x17 h2d y689b ff6 fs20 fc6 sc0 ls0 ws0">10<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x17 h2d y689c ff6 fs20 fc6 sc0 ls0 ws0">11<span class="_ _20"> </span><span class="ffd fs1e fc2">/*<span class="_ _e"> </span>Install<span class="_ _1f"> </span>the<span class="_ _1f"> </span>SIGINT<span class="_ _e"> </span>handler<span class="_ _1f"> </span>*/</span></div><div class="t m5 x17 h2e y689d ff6 fs20 fc6 sc0 ls0 ws0">12</div><div class="t m5 x142 h2d y689e ffd fs1e fc2 sc0 ls0 ws0">if<span class="_ _e"> </span>(signal(SIGINT,<span class="_ _1f"> </span>sigint_handler)<span class="_ _1f"> </span>==<span class="_ _e"> </span>SIG_ERR)</div><div class="t m5 x17 h2d y689f ff6 fs20 fc6 sc0 ls0 ws0">13<span class="_ _70"> </span><span class="ffd fs1e fc2">unix_error(&quot;signal<span class="_ _e"> </span>error&quot;);</span></div><div class="t m5 x17 h2e y68a0 ff6 fs20 fc6 sc0 ls0 ws0">14</div><div class="t m5 x17 h2e y68a1 ff6 fs20 fc6 sc0 ls0 ws0">15</div><div class="t m5 x142 h2d y68a2 ffd fs1e fc2 sc0 ls0 ws0">pause();<span class="_ _e"> </span>/*<span class="_ _1f"> </span>Wait<span class="_ _1f"> </span>for<span class="_ _e"> </span>the<span class="_ _1f"> </span>receipt<span class="_ _e"> </span>of<span class="_ _1f"> </span>a<span class="_ _1f"> </span>signal<span class="_ _e"> </span>*/</div><div class="t m5 x17 h2e y68a3 ff6 fs20 fc6 sc0 ls0 ws0">16</div><div class="t m5 x17 h2e y68a4 ff6 fs20 fc6 sc0 ls0 ws0">17</div><div class="t m5 x142 h2d y68a5 ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>0;</div><div class="t m5 x17 h2d y68a6 ff6 fs20 fc6 sc0 ls0 ws0">18<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x53 h2c y68a7 ffa fs16 fc2 sc0 ls0 ws0">code/ecf/sigint.c</div><div class="t m5 x17 h2f y68a8 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>8.30<span class="_ _66"> </span><span class="fc1">A<span class="_"> </span>program<span class="_"> </span>that<span class="_"> </span>uses<span class="_"> </span>a<span class="_"> </span>signal<span class="_"> </span>handler<span class="_"> </span>to<span class="_"> </span>catch<span class="_"> </span>a<span class="_"> </span>SIGINT<span class="_"> </span>signal.</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
