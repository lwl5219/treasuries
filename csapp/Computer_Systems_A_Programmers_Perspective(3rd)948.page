<div id="pf3b4" class="pf w2 h11" data-page-no="3b4"><div class="pc pc3b4 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg3b4.png"/><div class="t m5 xf0 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>10.11<span class="_ _60"> </span>Putting<span class="_ _10"> </span>It<span class="_ _10"> </span>T<span class="_ _1"></span>ogether:<span class="_ _10"> </span>Which<span class="_ _10"> </span>I/O<span class="_ _10"> </span>Functions<span class="_ _10"> </span>Should<span class="_ _10"> </span>I<span class="_ _10"> </span>Use?<span class="_ _3e"> </span><span class="ffe fs1e">947</span></div><div class="t m5 x17 h3b y9c fff fs24 fc6 sc0 ls0 ws0">10.10<span class="_ _17"> </span><span class="ffe fs18">Standard<span class="_"> </span>I/O</span></div><div class="t m5 x17 h26 y327 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>C<span class="_ _13"> </span>language<span class="_ _13"> </span>deﬁnes<span class="_"> </span>a<span class="_ _13"> </span>set<span class="_ _13"> </span>of<span class="_ _13"> </span>higher<span class="_ _0"></span>-level<span class="_ _13"> </span>input<span class="_"> </span>and<span class="_ _13"> </span>output<span class="_ _13"> </span>functions<span class="_ _1"></span>,<span class="_"> </span>called<span class="_ _13"> </span>the</div><div class="t m5 x17 h26 y328 ffa fs19 fc1 sc0 ls0 ws0">standard<span class="_ _16"> </span>I/O<span class="_ _16"> </span>library<span class="ff7">,<span class="_ _14"> </span>that<span class="_ _14"> </span>provides<span class="_ _16"> </span>programmers<span class="_ _14"> </span>with<span class="_ _14"> </span>a<span class="_ _16"> </span>higher<span class="_ _1"></span>-level<span class="_ _14"> </span>alternative</span></div><div class="t m5 x17 h26 y329 ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_ _16"> </span>Unix<span class="_ _16"> </span>I/O<span class="_ _3"></span>.<span class="_ _16"> </span>T<span class="_ _0"></span>he<span class="_ _16"> </span>library<span class="_ _16"> </span>(<span class="ffd">libc</span>)<span class="_ _16"> </span>provides<span class="_ _16"> </span>functions<span class="_ _16"> </span>for<span class="_ _16"> </span>opening<span class="_ _16"> </span>and<span class="_ _16"> </span>closing<span class="_ _16"> </span>ﬁles</div><div class="t m5 x17 h26 y32a ff7 fs19 fc1 sc0 ls0 ws0">(<span class="ffd">fopen<span class="_ _10"> </span></span>and<span class="_"> </span><span class="ffd">fclose</span>),<span class="_ _11"> </span>reading<span class="_"> </span>and<span class="_ _11"> </span>writing<span class="_"> </span>bytes<span class="_"> </span>(<span class="ffd">fread<span class="_ _11"> </span></span>and<span class="_"> </span><span class="ffd">fwrite</span>),<span class="_"> </span>reading<span class="_ _11"> </span>and</div><div class="t m5 x17 h26 y32b ff7 fs19 fc1 sc0 ls0 ws0">writing<span class="_ _16"> </span>strings<span class="_ _16"> </span>(<span class="ffd">fgets<span class="_ _14"> </span></span>and<span class="_ _16"> </span><span class="ffd">fputs</span>),<span class="_ _14"> </span>and<span class="_ _14"> </span>sophisticated<span class="_ _16"> </span>formatted<span class="_ _16"> </span>I/O<span class="_ _14"> </span>(<span class="ffd">scanf<span class="_ _16"> </span></span>and</div><div class="t m5 x17 h26 y32c ffd fs19 fc1 sc0 ls0 ws0">printf<span class="ff7">).</span></div><div class="t m5 x26 h26 y32d ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _13"> </span>standard<span class="_ _a"> </span>I/O<span class="_ _13"> </span>library<span class="_ _6"> </span>models<span class="_ _6"> </span>an<span class="_ _13"> </span>open<span class="_ _a"> </span>ﬁle<span class="_ _13"> </span>as<span class="_ _6"> </span>a<span class="_ _6"> </span><span class="ffa">stream</span>.<span class="_ _6"> </span>T<span class="_ _3"></span>o<span class="_ _6"> </span>the<span class="_ _13"> </span>programmer<span class="_ _0"></span>,<span class="_ _13"> </span>a</div><div class="t m5 x17 h26 y32e ff7 fs19 fc1 sc0 ls0 ws0">stream<span class="_ _13"> </span>is<span class="_ _13"> </span>a<span class="_ _6"> </span>pointer<span class="_ _13"> </span>to<span class="_ _13"> </span>a<span class="_ _13"> </span>structure<span class="_ _6"> </span>of<span class="_ _13"> </span>type<span class="_ _13"> </span><span class="ffd">FILE</span>.<span class="_ _13"> </span>Every<span class="_ _6"> </span>ANSI<span class="_ _13"> </span>C<span class="_ _13"> </span>program<span class="_ _13"> </span>begins<span class="_ _13"> </span>with</div><div class="t m5 x17 h26 y1cf ff7 fs19 fc1 sc0 ls0 ws0">three<span class="_ _16"> </span>open<span class="_ _14"> </span>streams<span class="_ _1"></span>,<span class="_ _14"> </span><span class="ffd">stdin</span>,<span class="_ _15"> </span><span class="ffd">stdout</span>,<span class="_ _14"> </span>and<span class="_ _14"> </span><span class="ffd">stderr</span>,<span class="_ _14"> </span>which<span class="_ _14"> </span>correspond<span class="_ _16"> </span>to<span class="_ _14"> </span>standard</div><div class="t m5 x17 h26 y32f ff7 fs19 fc1 sc0 ls0 ws0">input,<span class="_"> </span>standard<span class="_"> </span>output,<span class="_"> </span>and<span class="_"> </span>standard<span class="_"> </span>error,<span class="_"> </span>respectively:</div><div class="t m5 x17 h2d y7930 ffd fs1e fc2 sc0 ls0 ws0">#include<span class="_ _e"> </span>&lt;stdio.h&gt;</div><div class="t m5 x17 h2d y7931 ffd fs1e fc2 sc0 ls0 ws0">extern<span class="_ _e"> </span>FILE<span class="_ _1f"> </span>*stdin;<span class="_ _46"> </span>/*<span class="_ _1f"> </span>Standard<span class="_ _e"> </span>input<span class="_ _1f"> </span>(descriptor<span class="_ _e"> </span>0)<span class="_ _1f"> </span>*/</div><div class="t m5 x17 h2d y7932 ffd fs1e fc2 sc0 ls0 ws0">extern<span class="_ _e"> </span>FILE<span class="_ _1f"> </span>*stdout;<span class="_ _3f"> </span>/*<span class="_ _1f"> </span>Standard<span class="_ _e"> </span>output<span class="_ _1f"> </span>(descriptor<span class="_ _e"> </span>1)<span class="_ _1f"> </span>*/</div><div class="t m5 x17 h2d y7933 ffd fs1e fc2 sc0 ls0 ws0">extern<span class="_ _e"> </span>FILE<span class="_ _1f"> </span>*stderr;<span class="_ _3f"> </span>/*<span class="_ _1f"> </span>Standard<span class="_ _e"> </span>error<span class="_ _1f"> </span>(descriptor<span class="_ _e"> </span>2)<span class="_ _1f"> </span>*/</div><div class="t m5 x26 h26 y7934 ff7 fs19 fc2 sc0 ls0 ws0">A<span class="_ _14"> </span>stream<span class="_ _15"> </span>of<span class="_ _14"> </span>type<span class="_ _15"> </span>FILE<span class="_ _14"> </span>is<span class="_ _15"> </span>an<span class="_ _14"> </span>abstraction<span class="_ _15"> </span>for<span class="_ _14"> </span>a<span class="_ _15"> </span>ﬁle<span class="_ _14"> </span>descriptor<span class="_ _15"> </span>and<span class="_ _14"> </span>a<span class="_ _15"> </span><span class="ffa">stream</span></div><div class="t m5 x17 h26 y7935 ffa fs19 fc2 sc0 ls0 ws0">buffer<span class="_ _2"></span><span class="ff7">.<span class="_ _16"> </span>T<span class="_ _0"></span>he<span class="_ _16"> </span>purpose<span class="_ _16"> </span>of<span class="_ _14"> </span>the<span class="_ _16"> </span>stream<span class="_ _14"> </span>buffer<span class="_ _16"> </span>is<span class="_ _16"> </span>the<span class="_ _14"> </span>same<span class="_ _16"> </span>as<span class="_ _14"> </span>the<span class="_ _16"> </span><span class="ff9">Rio<span class="_ _14"> </span></span>read<span class="_ _16"> </span>buffer:<span class="_ _16"> </span>to</span></div><div class="t m5 x17 h26 y7936 ff7 fs19 fc2 sc0 ls0 ws0">minimize<span class="_"> </span>the<span class="_"> </span>number<span class="_ _11"> </span>of<span class="_"> </span>expensive<span class="_ _11"> </span>Linux<span class="_"> </span>I/O<span class="_ _11"> </span>system<span class="_"> </span>calls<span class="_ _1"></span>.<span class="_ _11"> </span>F<span class="_ _1"></span>or<span class="_"> </span>example,<span class="_"> </span>suppose</div><div class="t m5 x17 h26 y7937 ff7 fs19 fc2 sc0 ls0 ws0">we<span class="_"> </span>have<span class="_ _11"> </span>a<span class="_ _11"> </span>program<span class="_ _11"> </span>that<span class="_ _11"> </span>makes<span class="_ _11"> </span>repeated<span class="_ _11"> </span>calls<span class="_ _11"> </span>to<span class="_ _11"> </span>the<span class="_ _11"> </span>standard<span class="_ _11"> </span>I/O<span class="_"> </span><span class="ffd">getc<span class="_ _11"> </span></span>function,</div><div class="t m5 x17 h26 y7938 ff7 fs19 fc2 sc0 ls0 ws0">where<span class="_"> </span>each<span class="_ _13"> </span>invocation<span class="_"> </span>returns<span class="_"> </span>the<span class="_"> </span>next<span class="_ _13"> </span>character<span class="_"> </span>from<span class="_"> </span>a<span class="_ _13"> </span>ﬁle.<span class="_ _13"> </span>When<span class="_"> </span><span class="ffd">getc<span class="_ _13"> </span></span>is<span class="_"> </span>called</div><div class="t m5 x17 h26 y7939 ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _6"> </span>ﬁrst<span class="_ _6"> </span>time<span class="_ _1"></span>,<span class="_ _13"> </span>the<span class="_ _a"> </span>library<span class="_ _6"> </span>ﬁlls<span class="_ _6"> </span>the<span class="_ _6"> </span>stream<span class="_ _6"> </span>buffer<span class="_ _6"> </span>with<span class="_ _6"> </span>a<span class="_ _6"> </span>single<span class="_ _6"> </span>call<span class="_ _6"> </span>to<span class="_ _6"> </span>the<span class="_ _6"> </span><span class="ffd">read<span class="_ _6"> </span></span>function</div><div class="t m5 x17 h26 y793a ff7 fs19 fc2 sc0 ls0 ws0">and<span class="_ _13"> </span>then<span class="_ _13"> </span>returns<span class="_ _13"> </span>the<span class="_ _13"> </span>ﬁrst<span class="_ _13"> </span>byte<span class="_ _13"> </span>in<span class="_"> </span>the<span class="_ _13"> </span>buffer<span class="_ _13"> </span>to<span class="_ _13"> </span>the<span class="_ _13"> </span>application.<span class="_ _13"> </span>As<span class="_ _13"> </span>long<span class="_ _13"> </span>as<span class="_ _13"> </span>there<span class="_ _13"> </span>are</div><div class="t m5 x17 h26 y793b ff7 fs19 fc2 sc0 ls0 ws0">unread<span class="_ _11"> </span>bytes<span class="_ _16"> </span>in<span class="_ _11"> </span>the<span class="_ _11"> </span>buffer,<span class="_ _16"> </span>subsequent<span class="_ _11"> </span>calls<span class="_ _11"> </span>to<span class="_ _16"> </span><span class="ffd">getc<span class="_ _11"> </span></span>can<span class="_ _11"> </span>be<span class="_ _16"> </span>served<span class="_ _11"> </span>directly<span class="_ _16"> </span>from</div><div class="t m5 x17 h26 y793c ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span>stream<span class="_"> </span>buffer.</div><div class="t m5 x17 h3b y793d fff fs24 fc6 sc0 ls0 ws0">10.11<span class="_ _17"> </span><span class="ffe fs18">Putting<span class="_ _10"> </span>It<span class="_ _10"> </span>T<span class="_ _3"></span>ogether:<span class="_ _10"> </span>Which<span class="_ _10"> </span>I/O<span class="_ _10"> </span>Functions<span class="_ _10"> </span>Should<span class="_ _10"> </span>I<span class="_ _10"> </span>Use?</span></div><div class="t m5 x17 h26 y793e ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_ _11"> </span>10.16<span class="_ _11"> </span>summarizes<span class="_"> </span>the<span class="_ _11"> </span>various<span class="_"> </span>I/O<span class="_ _11"> </span>packages<span class="_ _11"> </span>that<span class="_"> </span>we<span class="_ _11"> </span>have<span class="_"> </span>discussed<span class="_ _11"> </span>in<span class="_ _11"> </span>this</div><div class="t m5 x17 h26 y793f ff7 fs19 fc1 sc0 ls0 ws0">chapter.</div><div class="t m5 x48 h3f y7940 ffd2 fs27 fc1 sc0 ls0 ws0">C application program</div><div class="t m5 x154 h3f y7941 ffd2 fs27 fc1 sc0 ls0 ws0">Standard I/O</div><div class="t m5 x18e h3f y7942 ffd2 fs27 fc1 sc0 ls0 ws0">functions</div><div class="t m5 x114 h3f y7943 ffd2 fs27 fc1 sc0 ls0 ws0">Rio</div><div class="t m5 x92 h3f y7944 ffd2 fs27 fc1 sc0 ls0 ws0">functions</div><div class="t m5 xe7 h3f y7945 ffd2 fs27 fc1 sc0 ls0 ws0">Unix I/O functions</div><div class="t m5 xb3 h3f y7946 ffd2 fs27 fc1 sc0 ls0 ws0">(accessed via system calls)</div><div class="t m5 xef h40 y7947 ffd3 fs28 fc1 sc0 ls0 ws0">fopen</div><div class="t m5 xef h40 y7948 ffd3 fs28 fc1 sc0 ls0 ws0">fread</div><div class="t m5 xef h40 y7949 ffd3 fs28 fc1 sc0 ls0 ws0">fscanf</div><div class="t m5 xef h40 y794a ffd3 fs28 fc1 sc0 ls0 ws0">sscanf</div><div class="t m5 xef h40 y794b ffd3 fs28 fc1 sc0 ls0 ws0">fgets</div><div class="t m5 xef h40 y794c ffd3 fs28 fc1 sc0 ls0 ws0">fflush</div><div class="t m5 xef h40 y794d ffd3 fs28 fc1 sc0 ls0 ws0">fclose</div><div class="t m5 x142 h40 y7947 ffd3 fs28 fc1 sc0 ls0 ws0">fdopen</div><div class="t m5 x142 h40 y7948 ffd3 fs28 fc1 sc0 ls0 ws0">fwrite</div><div class="t m5 x142 h40 y7949 ffd3 fs28 fc1 sc0 ls0 ws0">fprintf</div><div class="t m5 x142 h40 y794a ffd3 fs28 fc1 sc0 ls0 ws0">sprintf</div><div class="t m5 x142 h40 y794b ffd3 fs28 fc1 sc0 ls0 ws0">fputs</div><div class="t m5 x142 h40 y794c ffd3 fs28 fc1 sc0 ls0 ws0">fseek</div><div class="t m5 x84 h40 y794e ffd3 fs28 fc1 sc0 ls0 ws0">rio_readn</div><div class="t m5 x84 h40 y794f ffd3 fs28 fc1 sc0 ls0 ws0">rio_writen</div><div class="t m5 x84 h40 y7950 ffd3 fs28 fc1 sc0 ls0 ws0">rio_readinitb</div><div class="t m5 x84 h40 y7951 ffd3 fs28 fc1 sc0 ls0 ws0">rio_readlineb</div><div class="t m5 x84 h40 y7952 ffd3 fs28 fc1 sc0 ls0 ws0">rio_readnb</div><div class="t m5 x2f h40 y7953 ffd3 fs28 fc1 sc0 ls0 ws0">open</div><div class="t m5 x2f h40 y7954 ffd3 fs28 fc1 sc0 ls0 ws0">write</div><div class="t m5 x2f h40 y7955 ffd3 fs28 fc1 sc0 ls0 ws0">stat</div><div class="t m5 x5b h40 y7953 ffd3 fs28 fc1 sc0 ls0 ws0">read</div><div class="t m5 x5b h40 y7954 ffd3 fs28 fc1 sc0 ls0 ws0">lseek</div><div class="t m5 x5b h40 y7955 ffd3 fs28 fc1 sc0 ls0 ws0">close</div><div class="t m5 x17 h2f y7956 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>10.16<span class="_ _66"> </span><span class="fc1">Relationship<span class="_"> </span>between<span class="_"> </span>Unix<span class="_"> </span>I/O,<span class="_"> </span>standard<span class="_"> </span>I/O,<span class="_"> </span>and<span class="_"> </span><span class="ff1b">Rio</span>.</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
