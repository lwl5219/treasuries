<div id="pf290" class="pf w2 h11" data-page-no="290"><div class="pc pc290 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg290.png"/><div class="t m5 xf2 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>6.4<span class="_ _60"> </span>Cache<span class="_ _10"> </span>Memories<span class="_ _3e"> </span><span class="ffe fs1e">655</span></div><div class="t m5 x17 h42 ye7 ff6 fs29 fc6 sc0 ls0 ws0">W<span class="_ _1"></span>ord<span class="_ _16"> </span>Selection<span class="_ _16"> </span>in<span class="_ _11"> </span>Direct-Mapped<span class="_ _16"> </span>Caches</div><div class="t m5 x17 h26 y5bd ff7 fs19 fc1 sc0 ls0 ws0">Once<span class="_ _14"> </span>we<span class="_ _14"> </span>have<span class="_ _14"> </span>a<span class="_ _14"> </span>hit,<span class="_ _15"> </span>we<span class="_ _14"> </span>know<span class="_ _14"> </span>that<span class="_ _14"> </span><span class="ff11">w<span class="_ _15"> </span></span>is<span class="_ _14"> </span>somewhere<span class="_ _14"> </span>in<span class="_ _14"> </span>the<span class="_ _14"> </span>block.<span class="_ _14"> </span>This<span class="_ _16"> </span>last<span class="_ _14"> </span>step</div><div class="t m5 x17 h26 y5be ff7 fs19 fc1 sc0 ls0 ws0">determines<span class="_ _11"> </span>where<span class="_ _11"> </span>the<span class="_ _11"> </span>desired<span class="_ _16"> </span>word<span class="_"> </span>starts<span class="_ _16"> </span>in<span class="_"> </span>the<span class="_ _16"> </span>block.<span class="_"> </span>As<span class="_ _16"> </span>shown<span class="_"> </span>in<span class="_ _16"> </span>F<span class="_ _1"></span>igure<span class="_ _11"> </span>6.29,</div><div class="t m5 x17 h26 y5bf ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _13"> </span>block<span class="_ _13"> </span>offset<span class="_ _13"> </span>bits<span class="_"> </span>provide<span class="_ _13"> </span>us<span class="_ _13"> </span>with<span class="_ _13"> </span>the<span class="_ _13"> </span>offset<span class="_ _13"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>ﬁrst<span class="_ _13"> </span>byte<span class="_ _13"> </span>in<span class="_ _13"> </span>the<span class="_ _13"> </span>desired<span class="_"> </span>word.</div><div class="t m5 x17 h26 y5c0 ff7 fs19 fc1 sc0 ls0 ws0">Similar<span class="_ _11"> </span>to<span class="_ _11"> </span>our<span class="_ _16"> </span>view<span class="_"> </span>of<span class="_ _16"> </span>a<span class="_ _11"> </span>cache<span class="_ _11"> </span>as<span class="_ _11"> </span>an<span class="_ _16"> </span>array<span class="_"> </span>of<span class="_ _16"> </span>lines<span class="_ _3"></span>,<span class="_ _16"> </span>we<span class="_ _11"> </span>can<span class="_ _11"> </span>think<span class="_ _16"> </span>of<span class="_ _11"> </span>a<span class="_ _11"> </span>block<span class="_ _11"> </span>as<span class="_ _16"> </span>an</div><div class="t m5 x17 h26 y5c1 ff7 fs19 fc1 sc0 ls0 ws0">array<span class="_"> </span>of<span class="_"> </span>bytes<span class="_ _1"></span>,<span class="_"> </span>and<span class="_"> </span>the<span class="_"> </span>byte<span class="_"> </span>offset<span class="_"> </span>as<span class="_"> </span>an<span class="_"> </span>index<span class="_"> </span>into<span class="_"> </span>that<span class="_"> </span>array<span class="_ _3"></span>.<span class="_"> </span>In<span class="_"> </span>the<span class="_"> </span>example<span class="_ _1"></span>,<span class="_"> </span>the</div><div class="t m5 x17 h26 y5c2 ff7 fs19 fc1 sc0 ls0 ws0">block<span class="_ _11"> </span>offset<span class="_ _16"> </span>bits<span class="_ _11"> </span>of<span class="_ _11"> </span>100</div><div class="t m5 x17f h3c y574c ff7 fs25 fc1 sc0 ls0 ws0">2</div><div class="t m5 xe0 h26 y4969 ff7 fs19 fc1 sc0 ls0 ws0">indicate<span class="_ _11"> </span>that<span class="_ _16"> </span>the<span class="_ _11"> </span>copy<span class="_ _11"> </span>of<span class="_ _16"> </span><span class="ff11">w<span class="_"> </span></span>starts<span class="_"> </span>at<span class="_ _16"> </span>byte<span class="_ _11"> </span>4<span class="_ _11"> </span>in<span class="_ _16"> </span>the<span class="_ _11"> </span>block.</div><div class="t m5 x17 h26 y574d ff7 fs19 fc1 sc0 ls0 ws0">(W<span class="_ _3"></span>e<span class="_"> </span>are<span class="_"> </span>assuming<span class="_"> </span>that<span class="_"> </span>words<span class="_"> </span>are<span class="_"> </span>4<span class="_"> </span>bytes<span class="_"> </span>long.)</div><div class="t m5 x17 h42 y574e ff6 fs29 fc6 sc0 ls0 ws0">Line<span class="_ _11"> </span>Replacement<span class="_ _16"> </span>on<span class="_ _16"> </span>Misses<span class="_ _11"> </span>in<span class="_ _16"> </span>Direct-Mapped<span class="_ _16"> </span>Caches</div><div class="t m5 x17 h26 y574f ff7 fs19 fc1 sc0 ls0 ws0">If<span class="_ _16"> </span>the<span class="_ _16"> </span>cache<span class="_ _16"> </span>misses<span class="_ _1"></span>,<span class="_ _14"> </span>then<span class="_ _16"> </span>it<span class="_ _16"> </span>needs<span class="_ _16"> </span>to<span class="_ _16"> </span>retrieve<span class="_ _14"> </span>the<span class="_ _16"> </span>requested<span class="_ _16"> </span>block<span class="_ _16"> </span>from<span class="_ _16"> </span>the<span class="_ _16"> </span>next</div><div class="t m5 x17 h26 y5750 ff7 fs19 fc1 sc0 ls0 ws0">level<span class="_ _13"> </span>in<span class="_"> </span>the<span class="_ _13"> </span>memory<span class="_ _13"> </span>hierarchy<span class="_ _13"> </span>and<span class="_"> </span>store<span class="_ _13"> </span>the<span class="_ _13"> </span>new<span class="_ _13"> </span>block<span class="_"> </span>in<span class="_ _13"> </span>one<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_"> </span>cache<span class="_ _13"> </span>lines<span class="_ _13"> </span>of</div><div class="t m5 x17 h26 y5751 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _6"> </span>set<span class="_ _13"> </span>indicated<span class="_ _a"> </span>by<span class="_ _13"> </span>the<span class="_ _6"> </span>set<span class="_ _6"> </span>index<span class="_ _13"> </span>bits<span class="_ _3"></span>.<span class="_ _13"> </span>In<span class="_ _a"> </span>general,<span class="_ _13"> </span>if<span class="_ _6"> </span>the<span class="_ _13"> </span>set<span class="_ _a"> </span>is<span class="_ _13"> </span>full<span class="_ _6"> </span>of<span class="_ _6"> </span>valid<span class="_ _13"> </span>cache<span class="_ _a"> </span>lines<span class="_ _1"></span>,</div><div class="t m5 x17 h26 y5752 ff7 fs19 fc1 sc0 ls0 ws0">then<span class="_"> </span>one<span class="_ _11"> </span>of<span class="_"> </span>the<span class="_ _11"> </span>existing<span class="_"> </span>lines<span class="_ _11"> </span>must<span class="_ _11"> </span>be<span class="_"> </span>evicted.<span class="_ _11"> </span>F<span class="_ _1"></span>or<span class="_"> </span>a<span class="_ _11"> </span>direct-mapped<span class="_"> </span>cache,<span class="_"> </span>where</div><div class="t m5 x17 h26 y5753 ff7 fs19 fc1 sc0 ls0 ws0">each<span class="_ _13"> </span>set<span class="_ _13"> </span>contains<span class="_ _6"> </span>exactly<span class="_ _13"> </span>one<span class="_ _13"> </span>line<span class="_ _1"></span>,<span class="_ _13"> </span>the<span class="_ _13"> </span>replacement<span class="_ _13"> </span>polic<span class="_ _0"></span>y<span class="_ _13"> </span>is<span class="_ _6"> </span>trivial:<span class="_ _13"> </span>the<span class="_ _13"> </span>current<span class="_ _13"> </span>line</div><div class="t m5 x17 h26 y5754 ff7 fs19 fc1 sc0 ls0 ws0">is<span class="_"> </span>replaced<span class="_"> </span>by<span class="_"> </span>the<span class="_"> </span>newly<span class="_"> </span>fetched<span class="_"> </span>line<span class="_ _1"></span>.</div><div class="t m5 x17 h42 y5755 ff6 fs29 fc6 sc0 ls0 ws0">Putting<span class="_ _11"> </span>It<span class="_ _16"> </span>T<span class="_ _3"></span>ogether:<span class="_ _16"> </span>A<span class="_ _16"> </span>Direct-Mapped<span class="_ _11"> </span>Cache<span class="_ _16"> </span>in<span class="_ _16"> </span>Action</div><div class="t m5 x17 h26 y5756 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _16"> </span>mechanisms<span class="_ _11"> </span>that<span class="_ _11"> </span>a<span class="_ _11"> </span>cache<span class="_ _16"> </span>uses<span class="_ _11"> </span>to<span class="_ _11"> </span>select<span class="_ _16"> </span>sets<span class="_"> </span>and<span class="_ _16"> </span>identify<span class="_ _11"> </span>lines<span class="_ _11"> </span>are<span class="_ _16"> </span>extremely</div><div class="t m5 x17 h26 y5757 ff7 fs19 fc1 sc0 ls0 ws0">simple<span class="_ _1"></span>.<span class="_ _e"> </span>T<span class="_ _3"></span>hey<span class="_ _e"> </span>have<span class="_ _21"> </span>to<span class="_ _f"> </span>be,<span class="_ _e"> </span>because<span class="_ _21"> </span>the<span class="_ _f"> </span>hardware<span class="_ _f"> </span>must<span class="_ _f"> </span>perform<span class="_ _e"> </span>them<span class="_ _21"> </span>in<span class="_ _f"> </span>a<span class="_ _f"> </span>few</div><div class="t m5 x17 h26 y5758 ff7 fs19 fc1 sc0 ls0 ws0">nanoseconds<span class="_ _1"></span>.<span class="_ _f"> </span>However,<span class="_ _e"> </span>manipulating<span class="_ _f"> </span>bits<span class="_ _e"> </span>in<span class="_ _21"> </span>this<span class="_ _e"> </span>way<span class="_ _21"> </span>can<span class="_ _e"> </span>be<span class="_ _21"> </span>confusing<span class="_ _e"> </span>to<span class="_ _f"> </span>us</div><div class="t m5 x17 h26 y5759 ff7 fs19 fc1 sc0 ls0 ws0">humans<span class="_ _1"></span>.<span class="_ _15"> </span>A<span class="_ _15"> </span>concrete<span class="_ _15"> </span>example<span class="_ _21"> </span>will<span class="_ _15"> </span>help<span class="_ _15"> </span>clarify<span class="_ _15"> </span>the<span class="_ _15"> </span>process<span class="_ _0"></span>.<span class="_ _15"> </span>Suppose<span class="_ _15"> </span>we<span class="_ _15"> </span>have<span class="_ _15"> </span>a</div><div class="t m5 x17 h26 y575a ff7 fs19 fc1 sc0 ls0 ws0">direct-mapped<span class="_"> </span>cache<span class="_"> </span>described<span class="_"> </span>by</div><div class="t m5 x25 h46 y575b ff11 fs19 fc1 sc0 ls42 ws0">(<span class="_ _80"></span>S<span class="_ _8"></span>,E<span class="_ _4"></span>,B<span class="_ _4"></span>,m<span class="_ _80"></span>)<span class="ff12 ls0">=<span class="_ _13"> </span><span class="ff11">(<span class="ff7">4</span>,<span class="_ _10"> </span><span class="ff7">1<span class="_ _1"></span><span class="ff11">,<span class="_ _10"> </span><span class="ff7">2</span>,<span class="_ _13"> </span><span class="ff7">4</span>)</span></span></span></span></div><div class="t m5 x17 h26 y575c ff7 fs19 fc1 sc0 ls0 ws0">In<span class="_"> </span>other<span class="_"> </span>words<span class="_ _1"></span>,<span class="_"> </span>the<span class="_"> </span>cache<span class="_ _11"> </span>has<span class="_"> </span>four<span class="_"> </span>sets<span class="_ _1"></span>,<span class="_"> </span>one<span class="_ _11"> </span>line<span class="_"> </span>per<span class="_"> </span>set,<span class="_"> </span>2<span class="_"> </span>bytes<span class="_ _11"> </span>per<span class="_"> </span>block,<span class="_"> </span>and<span class="_"> </span>4-</div><div class="t m5 x17 h26 y575d ff7 fs19 fc1 sc0 ls0 ws0">bit<span class="_ _13"> </span>addresses<span class="_ _1"></span>.<span class="_"> </span>W<span class="_ _7"></span>e<span class="_"> </span>will<span class="_ _13"> </span>also<span class="_ _13"> </span>assume<span class="_ _13"> </span>that<span class="_"> </span>each<span class="_ _13"> </span>word<span class="_ _13"> </span>is<span class="_ _13"> </span>a<span class="_"> </span>single<span class="_ _13"> </span>byte<span class="_ _1"></span>.<span class="_"> </span>Of<span class="_ _13"> </span>course<span class="_ _1"></span>,<span class="_"> </span>these</div><div class="t m5 x17 h26 y575e ff7 fs19 fc1 sc0 ls0 ws0">assumptions<span class="_ _13"> </span>are<span class="_"> </span>totally<span class="_ _13"> </span>unrealistic,<span class="_ _13"> </span>but<span class="_"> </span>they<span class="_ _13"> </span>will<span class="_ _13"> </span>help<span class="_"> </span>us<span class="_ _13"> </span>keep<span class="_ _13"> </span>the<span class="_"> </span>example<span class="_ _13"> </span>simple<span class="_ _0"></span>.</div><div class="t m5 x26 h26 y575f ff7 fs19 fc1 sc0 ls0 ws0">When<span class="_ _13"> </span>you<span class="_ _6"> </span>are<span class="_ _13"> </span>ﬁrst<span class="_ _13"> </span>learning<span class="_ _13"> </span>about<span class="_ _13"> </span>caches<span class="_ _1"></span>,<span class="_ _13"> </span>it<span class="_ _13"> </span>can<span class="_ _13"> </span>be<span class="_ _13"> </span>very<span class="_ _13"> </span>instructive<span class="_ _6"> </span>to<span class="_ _13"> </span>enumer<span class="_ _1"></span>-</div><div class="t m5 x17 h26 y5760 ff7 fs19 fc1 sc0 ls0 ws0">ate<span class="_ _13"> </span>the<span class="_ _13"> </span>entire<span class="_ _13"> </span>address<span class="_"> </span>space<span class="_ _13"> </span>and<span class="_ _13"> </span>partition<span class="_ _13"> </span>the<span class="_ _13"> </span>bits<span class="_ _1"></span>,<span class="_"> </span>as<span class="_ _13"> </span>we’<span class="_ _0"></span>ve<span class="_ _13"> </span>done<span class="_ _13"> </span>in<span class="_"> </span>F<span class="_ _1"></span>igure<span class="_ _13"> </span>6.30<span class="_ _13"> </span>for</div><div class="t m5 x17 h26 y5761 ff7 fs19 fc1 sc0 ls0 ws0">our<span class="_"> </span>4-bit<span class="_ _13"> </span>example<span class="_ _0"></span>.<span class="_"> </span>T<span class="_ _3"></span>here<span class="_"> </span>are<span class="_"> </span>some<span class="_ _13"> </span>interesting<span class="_"> </span>things<span class="_ _13"> </span>to<span class="_"> </span>notice<span class="_ _13"> </span>about<span class="_"> </span>this<span class="_"> </span>enumer<span class="_ _3"></span>-</div><div class="t m5 x17 h26 y5762 ff7 fs19 fc1 sc0 ls0 ws0">ated<span class="_"> </span>space:</div><div class="t m5 x72 h3d y5763 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y3478 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>concatenation<span class="_ _11"> </span>of<span class="_"> </span>the<span class="_"> </span>tag<span class="_ _11"> </span>and<span class="_"> </span>index<span class="_"> </span>bits<span class="_"> </span>uniquely<span class="_ _11"> </span>identiﬁes<span class="_"> </span>each<span class="_"> </span>block<span class="_"> </span>in</div><div class="t m5 x26 h26 y5764 ff7 fs19 fc1 sc0 ls0 ws0">memory<span class="_ _3"></span>.<span class="_"> </span>F<span class="_ _1"></span>or<span class="_ _11"> </span>example<span class="_ _0"></span>,<span class="_"> </span>block<span class="_ _11"> </span>0<span class="_ _11"> </span>consists<span class="_"> </span>of<span class="_ _11"> </span>addresses<span class="_ _11"> </span>0<span class="_"> </span>and<span class="_ _11"> </span>1,<span class="_ _11"> </span>block<span class="_"> </span>1<span class="_ _11"> </span>consists</div><div class="t m5 x26 h26 y5765 ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_"> </span>addresses<span class="_"> </span>2<span class="_"> </span>and<span class="_"> </span>3,<span class="_"> </span>block<span class="_"> </span>2<span class="_"> </span>consists<span class="_"> </span>of<span class="_"> </span>addresses<span class="_"> </span>4<span class="_"> </span>and<span class="_"> </span>5,<span class="_"> </span>and<span class="_"> </span>so<span class="_"> </span>on.</div><div class="t m5 x72 h3d y5766 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y12d9 ff7 fs19 fc1 sc0 ls0 ws0">Since<span class="_ _13"> </span>there<span class="_"> </span>are<span class="_ _13"> </span>eight<span class="_"> </span>memory<span class="_ _13"> </span>blocks<span class="_ _13"> </span>but<span class="_"> </span>only<span class="_ _13"> </span>four<span class="_ _13"> </span>cache<span class="_"> </span>sets<span class="_ _3"></span>,<span class="_"> </span>multiple<span class="_ _13"> </span>blocks</div><div class="t m5 x26 h26 y5767 ff7 fs19 fc1 sc0 ls0 ws0">map<span class="_ _11"> </span>to<span class="_ _11"> </span>the<span class="_ _11"> </span>same<span class="_"> </span>cache<span class="_ _11"> </span>set<span class="_ _11"> </span>(i.e.,<span class="_"> </span>they<span class="_ _11"> </span>have<span class="_ _11"> </span>the<span class="_ _11"> </span>same<span class="_ _11"> </span>set<span class="_ _11"> </span>index).<span class="_ _11"> </span>F<span class="_ _1"></span>or<span class="_ _11"> </span>example,</div><div class="t m5 x26 h26 y5768 ff7 fs19 fc1 sc0 ls0 ws0">blocks<span class="_"> </span>0<span class="_"> </span>and<span class="_ _13"> </span>4<span class="_"> </span>both<span class="_"> </span>map<span class="_"> </span>to<span class="_"> </span>set<span class="_ _13"> </span>0,<span class="_"> </span>blocks<span class="_"> </span>1<span class="_"> </span>and<span class="_"> </span>5<span class="_ _13"> </span>both<span class="_"> </span>map<span class="_"> </span>to<span class="_"> </span>set<span class="_"> </span>1,<span class="_ _13"> </span>and<span class="_"> </span>so<span class="_"> </span>on.</div><div class="t m5 x72 h3d y5769 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y7a6 ff7 fs19 fc1 sc0 ls0 ws0">Blocks<span class="_"> </span>that<span class="_"> </span>map<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>same<span class="_"> </span>cache<span class="_"> </span>set<span class="_"> </span>are<span class="_"> </span>uniquely<span class="_"> </span>identiﬁed<span class="_"> </span>by<span class="_"> </span>the<span class="_"> </span>tag<span class="_ _0"></span>.<span class="_"> </span>F<span class="_ _1"></span>or</div><div class="t m5 x26 h26 y7a7 ff7 fs19 fc1 sc0 ls0 ws0">example<span class="_ _1"></span>,<span class="_"> </span>block<span class="_"> </span>0<span class="_"> </span>has<span class="_ _13"> </span>a<span class="_"> </span>tag<span class="_"> </span>bit<span class="_"> </span>of<span class="_ _13"> </span>0<span class="_"> </span>while<span class="_"> </span>block<span class="_"> </span>4<span class="_ _13"> </span>has<span class="_"> </span>a<span class="_"> </span>tag<span class="_"> </span>bit<span class="_ _13"> </span>of<span class="_"> </span>1,<span class="_"> </span>block<span class="_"> </span>1<span class="_ _13"> </span>has</div><div class="t m5 x26 h26 y7a8 ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_"> </span>tag<span class="_"> </span>bit<span class="_"> </span>of<span class="_"> </span>0<span class="_"> </span>while<span class="_"> </span>block<span class="_"> </span>5<span class="_"> </span>has<span class="_"> </span>a<span class="_"> </span>tag<span class="_"> </span>bit<span class="_"> </span>of<span class="_"> </span>1,<span class="_"> </span>and<span class="_"> </span>so<span class="_"> </span>on.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
