<div id="pf182" class="pf w2 h11" data-page-no="182"><div class="pc pc182 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg182.png"/><div class="t m5 x107 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Solutions<span class="_ _10"> </span>to<span class="_ _10"> </span>Practice<span class="_ _10"> </span>Problems<span class="_ _1b"> </span><span class="ffe fs1e">385</span></div><div class="t m5 x2e h61 ye7 ff13 fs35 fc6 sc0 ls0 ws0">Refer<span class="_ _f"> </span>to<span class="_ _f"> </span>arguments<span class="_ _f"> </span>as<span class="_ _e"> </span>i1<span class="_ _21"> </span>(%rdi),<span class="_ _f"> </span>i2<span class="_ _e"> </span>(%esi)</div><div class="t m5 x1a h61 y26dc ff13 fs35 fc6 sc0 ls0 ws0">f1<span class="_ _f"> </span>(%xmm0),<span class="_ _f"> </span>and<span class="_ _f"> </span>f2<span class="_ _e"> </span>(%xmm1)</div><div class="t m5 x2e h61 y3616 ff13 fs35 fc6 sc0 ls0 ws0">double<span class="_ _f"> </span>funct1(arg1_t<span class="_ _f"> </span>p,<span class="_ _f"> </span>arg2_t<span class="_ _e"> </span>q,<span class="_ _21"> </span>arg3_t<span class="_ _f"> </span>r,<span class="_ _e"> </span>arg4_t<span class="_ _21"> </span>s)</div><div class="t m5 x2c h2d yecd ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">funct1:</span></div><div class="t m5 x2c h2d yece ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _45"> </span><span class="ffd fs1e fc2">vcvtsi2ssq<span class="_ _5a"> </span>%rsi,<span class="_ _1f"> </span>%xmm2,<span class="_ _e"> </span>%xmm2<span class="_ _f1"> </span></span><span class="ff13 fs35">Get<span class="_ _21"> </span>i2<span class="_ _e"> </span>and<span class="_ _21"> </span>convert<span class="_ _f"> </span>from<span class="_ _e"> </span>long<span class="_ _21"> </span>to<span class="_ _f"> </span>float</span></div><div class="t m5 x2c h2d yecf ff6 fs20 fc6 sc0 ls0 ws0">3<span class="_ _45"> </span><span class="ffd fs1e fc2">vaddss<span class="_ _1a"> </span>%xmm0,<span class="_ _e"> </span>%xmm2,<span class="_ _1f"> </span>%xmm0<span class="_ _c2"> </span></span><span class="ff13 fs35">Add<span class="_ _f"> </span>f1<span class="_ _f"> </span>(type<span class="_ _e"> </span>float)</span></div><div class="t m5 x2c h2d yed0 ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _45"> </span><span class="ffd fs1e fc2">vcvtsi2ss<span class="_ _6f"> </span>%edi,<span class="_ _1f"> </span>%xmm2,<span class="_ _e"> </span>%xmm2<span class="_ _95"> </span></span><span class="ff13 fs35">Get<span class="_ _e"> </span>i1<span class="_ _21"> </span>and<span class="_ _f"> </span>convert<span class="_ _e"> </span>from<span class="_ _21"> </span>int<span class="_ _f"> </span>to<span class="_ _e"> </span>float</span></div><div class="t m5 x2c h2d y1a10 ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _45"> </span><span class="ffd fs1e fc2">vdivss<span class="_ _1a"> </span>%xmm0,<span class="_ _e"> </span>%xmm2,<span class="_ _1f"> </span>%xmm0<span class="_ _c2"> </span></span><span class="ff13 fs35">Compute<span class="_ _f"> </span>i1<span class="_ _f"> </span>/<span class="_ _e"> </span>(i2<span class="_ _21"> </span>+<span class="_ _f"> </span>f1)</span></div><div class="t m5 x2c h2d yed3 ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _45"> </span><span class="ffd fs1e fc2">vunpcklps<span class="_ _6f"> </span>%xmm0,<span class="_ _1f"> </span>%xmm0,<span class="_ _e"> </span>%xmm0</span></div><div class="t m5 x2c h2d yed4 ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _45"> </span><span class="ffd fs1e fc2">vcvtps2pd<span class="_ _6f"> </span>%xmm0,<span class="_ _1f"> </span>%xmm0<span class="_ _14c"> </span></span><span class="ff13 fs35">Convert<span class="_ _e"> </span>to<span class="_ _21"> </span>double</span></div><div class="t m5 x2c h2e y462 ff6 fs20 fc6 sc0 ls0 ws0">8</div><div class="t m5 xd1 h2d y1ab0 ffd fs1e fc2 sc0 ls0 ws0">vsubsd<span class="_ _1a"> </span>%xmm1,<span class="_ _e"> </span>%xmm0,<span class="_ _1f"> </span>%xmm0<span class="_ _c2"> </span><span class="ff13 fs35 fc6">Compute<span class="_ _f"> </span>i1<span class="_ _f"> </span>/<span class="_ _e"> </span>(i2<span class="_ _21"> </span>+<span class="_ _f"> </span>f1)<span class="_ _e"> </span>-<span class="_ _21"> </span>f2<span class="_ _f"> </span>(double)</span></div><div class="t m5 x2c h2d y26dd ff6 fs20 fc6 sc0 ls0 ws0">9<span class="_ _45"> </span><span class="ffd fs1e fc2">ret</span></div><div class="t m5 x17 h26 y3617 ff7 fs19 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>rom<span class="_ _11"> </span>this<span class="_ _11"> </span>we<span class="_ _11"> </span>see<span class="_"> </span>that<span class="_ _11"> </span>the<span class="_ _11"> </span>code<span class="_"> </span>computes<span class="_ _11"> </span>the<span class="_ _11"> </span>value<span class="_ _11"> </span><span class="ffd">i1/(i2+f1)-f2</span>.<span class="_"> </span>W<span class="_ _1"></span>e<span class="_"> </span>can<span class="_ _11"> </span>also</div><div class="t m5 x17 h26 y3618 ff7 fs19 fc2 sc0 ls0 ws0">see<span class="_ _16"> </span>that<span class="_ _16"> </span><span class="ffd">i1<span class="_ _16"> </span></span>has<span class="_ _16"> </span>type<span class="_ _16"> </span><span class="ffd">int</span>,<span class="_ _14"> </span><span class="ffd">i2<span class="_ _16"> </span></span>has<span class="_ _14"> </span>type<span class="_ _16"> </span><span class="ffd">long</span>,<span class="_ _16"> </span><span class="ffd">f1<span class="_ _14"> </span></span>has<span class="_ _16"> </span>type<span class="_ _16"> </span><span class="ffd">float</span>,<span class="_ _14"> </span>and<span class="_ _16"> </span><span class="ffd">f2<span class="_ _16"> </span></span>has<span class="_ _16"> </span>type</div><div class="t m5 x17 h26 y3619 ffd fs19 fc2 sc0 ls0 ws0">double<span class="ff7">.<span class="_ _16"> </span>The<span class="_ _16"> </span>only<span class="_ _14"> </span>ambiguity<span class="_ _16"> </span>in<span class="_ _14"> </span>matching<span class="_ _14"> </span>arguments<span class="_ _14"> </span>to<span class="_ _16"> </span>the<span class="_ _14"> </span>named<span class="_ _14"> </span>values<span class="_ _14"> </span>stems</span></div><div class="t m5 x17 h26 y361a ff7 fs19 fc2 sc0 ls0 ws0">from<span class="_"> </span>the<span class="_"> </span>commutativity<span class="_"> </span>of<span class="_"> </span>multiplication—yielding<span class="_"> </span>two<span class="_"> </span>possible<span class="_"> </span>results:</div><div class="t m5 x17 h2d y361b ffd fs1e fc2 sc0 ls0 ws0">double<span class="_ _e"> </span>funct1a(int<span class="_ _1f"> </span>p,<span class="_ _1f"> </span>float<span class="_ _e"> </span>q,<span class="_ _1f"> </span>long<span class="_ _e"> </span>r,<span class="_ _1f"> </span>double<span class="_ _1f"> </span>s);</div><div class="t m5 x17 h2d y361c ffd fs1e fc2 sc0 ls0 ws0">double<span class="_ _e"> </span>funct1b(int<span class="_ _1f"> </span>p,<span class="_ _1f"> </span>long<span class="_ _e"> </span>q,<span class="_ _1f"> </span>float<span class="_ _e"> </span>r,<span class="_ _1f"> </span>double<span class="_ _1f"> </span>s);</div><div class="t m5 x17 h28 y361d ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>3.54</div><div class="t m5 x112 h2f y361e ffe fs16 fc6 sc0 ls0 ws0">(page<span class="_"> </span>339)</div><div class="t m5 x17 h26 y361f ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _16"> </span>problem<span class="_ _16"> </span>can<span class="_ _16"> </span>readily<span class="_ _16"> </span>be<span class="_ _16"> </span>solved<span class="_ _16"> </span>by<span class="_ _16"> </span>stepping<span class="_ _16"> </span>through<span class="_ _16"> </span>the<span class="_ _16"> </span>assembly<span class="_ _16"> </span>code<span class="_ _16"> </span>and</div><div class="t m5 x17 h26 y3620 ff7 fs19 fc1 sc0 ls0 ws0">determining<span class="_ _13"> </span>what<span class="_ _13"> </span>is<span class="_ _13"> </span>computed<span class="_ _13"> </span>on<span class="_ _13"> </span>each<span class="_ _13"> </span>step<span class="_ _1"></span>,<span class="_ _13"> </span>as<span class="_ _13"> </span>shown<span class="_ _13"> </span>with<span class="_ _13"> </span>the<span class="_ _13"> </span>annotations<span class="_ _13"> </span>below:</div><div class="t m5 x2e h61 y3621 ff13 fs35 fc6 sc0 ls0 ws0">double<span class="_ _f"> </span>funct2(double<span class="_ _f"> </span>w,<span class="_ _f"> </span>int<span class="_ _e"> </span>x,<span class="_ _21"> </span>float<span class="_ _f"> </span>y,<span class="_ _e"> </span>long<span class="_ _21"> </span>z)</div><div class="t m5 x2e h61 y3622 ff13 fs35 fc6 sc0 ls0 ws0">w<span class="_ _f"> </span>in<span class="_ _f"> </span>%xmm0,<span class="_ _f"> </span>x<span class="_ _e"> </span>in<span class="_ _21"> </span>%edi,<span class="_ _f"> </span>y<span class="_ _e"> </span>in<span class="_ _21"> </span>%xmm1,<span class="_ _f"> </span>z<span class="_ _e"> </span>in<span class="_ _21"> </span>%rsi</div><div class="t m5 x2c h2e y3623 ff6 fs20 fc6 sc0 ls0 ws0">1</div><div class="t m5 x2d h2d y3624 ffd fs1e fc2 sc0 ls0 ws0">funct2:</div><div class="t m5 x2c h2e y3625 ff6 fs20 fc6 sc0 ls0 ws0">2</div><div class="t m5 xd1 h2d y3626 ffd fs1e fc2 sc0 ls0 ws0">vcvtsi2ss<span class="_ _6f"> </span>%edi,<span class="_ _1f"> </span>%xmm2,<span class="_ _e"> </span>%xmm2<span class="_ _93"> </span><span class="ff13 fs35 fc6">Convert<span class="_ _f"> </span>x<span class="_ _f"> </span>to<span class="_ _e"> </span>float</span></div><div class="t m5 x2c h2d y3627 ff6 fs20 fc6 sc0 ls0 ws0">3<span class="_ _45"> </span><span class="ffd fs1e fc2">vmulss<span class="_ _1a"> </span>%xmm1,<span class="_ _e"> </span>%xmm2,<span class="_ _1f"> </span>%xmm1<span class="_ _12b"> </span></span><span class="ff13 fs35">Multiply<span class="_ _f"> </span>by<span class="_ _f"> </span>y</span></div><div class="t m5 x2c h2d y3628 ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _45"> </span><span class="ffd fs1e fc2">vunpcklps<span class="_ _6f"> </span>%xmm1,<span class="_ _1f"> </span>%xmm1,<span class="_ _e"> </span>%xmm1</span></div><div class="t m5 x2c h2d y3629 ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _45"> </span><span class="ffd fs1e fc2">vcvtps2pd<span class="_ _6f"> </span>%xmm1,<span class="_ _1f"> </span>%xmm2<span class="_ _d6"> </span></span><span class="ff13 fs35">Convert<span class="_ _e"> </span>x*y<span class="_ _21"> </span>to<span class="_ _f"> </span>double</span></div><div class="t m5 x2c h2e y362a ff6 fs20 fc6 sc0 ls0 ws0">6</div><div class="t m5 xd1 h2d y362b ffd fs1e fc2 sc0 ls0 ws0">vcvtsi2sdq<span class="_ _5a"> </span>%rsi,<span class="_ _1f"> </span>%xmm1,<span class="_ _e"> </span>%xmm1<span class="_ _93"> </span><span class="ff13 fs35 fc6">Convert<span class="_ _f"> </span>z<span class="_ _e"> </span>to<span class="_ _21"> </span>double</span></div><div class="t m5 x2c h2d y362c ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _45"> </span><span class="ffd fs1e fc2">vdivsd<span class="_ _1a"> </span>%xmm1,<span class="_ _e"> </span>%xmm0,<span class="_ _1f"> </span>%xmm0<span class="_ _12b"> </span></span><span class="ff13 fs35">Compute<span class="_ _f"> </span>w/z</span></div><div class="t m5 x2c h2d y362d ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _45"> </span><span class="ffd fs1e fc2">vsubsd<span class="_ _1a"> </span>%xmm0,<span class="_ _e"> </span>%xmm2,<span class="_ _1f"> </span>%xmm0<span class="_ _12b"> </span></span><span class="ff13 fs35">Subtract<span class="_ _f"> </span>from<span class="_ _f"> </span>x*y</span></div><div class="t m5 x2c h2d y362e ff6 fs20 fc6 sc0 ls0 ws0">9<span class="_ _45"> </span><span class="ffd fs1e fc2">ret<span class="_ _19a"> </span></span><span class="ff13 fs35">Return</span></div><div class="t m5 x17 h46 y362f ff7 fs19 fc2 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_"> </span>can<span class="_"> </span>conclude<span class="_"> </span>from<span class="_"> </span>this<span class="_"> </span>analysis<span class="_"> </span>that<span class="_"> </span>the<span class="_"> </span>function<span class="_"> </span>computes<span class="_"> </span><span class="ffd">y<span class="_ _10"> </span><span class="ff12">∗<span class="_ _13"></span></span>x<span class="_ _10"> </span><span class="ff12">−<span class="_ _13"></span></span>w<span class="_ _2"></span><span class="ff11">/</span>z<span class="_ _0"></span><span class="ff7">.</span></span></div><div class="t m5 x17 h28 y3630 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>3.55<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>341)</span></div><div class="t m5 x17 h26 y2e18 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _14"> </span>problem<span class="_ _16"> </span>involves<span class="_ _16"> </span>the<span class="_ _16"> </span>same<span class="_ _14"> </span>reasoning<span class="_ _16"> </span>as<span class="_ _16"> </span>was<span class="_ _14"> </span>required<span class="_ _16"> </span>to<span class="_ _16"> </span>see<span class="_ _14"> </span>that<span class="_ _16"> </span>numbers</div><div class="t m5 x17 h26 y2e19 ff7 fs19 fc1 sc0 ls0 ws0">declared<span class="_"> </span>at<span class="_"> </span>label<span class="_"> </span><span class="ffd">.LC2<span class="_ _10"> </span></span>encode<span class="_"> </span>1.8,<span class="_"> </span>but<span class="_"> </span>with<span class="_"> </span>a<span class="_"> </span>simpler<span class="_"> </span>example<span class="_ _0"></span>.</div><div class="t m5 x26 h26 y3631 ff7 fs19 fc1 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_ _14"> </span>see<span class="_ _15"> </span>that<span class="_ _14"> </span>the<span class="_ _14"> </span>two<span class="_ _14"> </span>values<span class="_ _15"> </span>are<span class="_ _14"> </span>0<span class="_ _14"> </span>and<span class="_ _14"> </span>1077936128<span class="_ _14"> </span>(<span class="ffd">0x40400000</span>).<span class="_ _15"> </span>F<span class="_ _1"></span>rom<span class="_ _15"> </span>the</div><div class="t m5 x17 h26 y3632 ff7 fs19 fc1 sc0 ls0 ws0">high-order<span class="_ _16"> </span>bytes<span class="_ _1"></span>,<span class="_ _16"> </span>we<span class="_ _16"> </span>can<span class="_ _16"> </span>extract<span class="_ _16"> </span>an<span class="_ _16"> </span>exponent<span class="_ _16"> </span>ﬁeld<span class="_ _16"> </span>of<span class="_ _16"> </span><span class="ffd">0x404<span class="_ _16"> </span></span>(1028),<span class="_ _16"> </span>from<span class="_ _16"> </span>which</div><div class="t m5 x17 h26 y3633 ff7 fs19 fc1 sc0 ls0 ws0">we<span class="_ _13"> </span>subtract<span class="_"> </span>a<span class="_ _13"> </span>bias<span class="_"> </span>of<span class="_ _13"> </span>1023<span class="_"> </span>to<span class="_ _13"> </span>get<span class="_"> </span>an<span class="_ _13"> </span>exponent<span class="_ _13"> </span>of<span class="_"> </span>5.<span class="_ _13"> </span>Concatenating<span class="_"> </span>the<span class="_ _13"> </span>fraction<span class="_"> </span>bits</div><div class="t m5 x17 h26 y3634 ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_ _11"> </span>the<span class="_ _11"> </span>two<span class="_ _11"> </span>values<span class="_ _1"></span>,<span class="_ _16"> </span>we<span class="_"> </span>get<span class="_ _16"> </span>a<span class="_"> </span>fraction<span class="_ _11"> </span>ﬁeld<span class="_ _16"> </span>of<span class="_"> </span>0,<span class="_ _16"> </span>but<span class="_ _11"> </span>with<span class="_ _11"> </span>the<span class="_ _11"> </span>implied<span class="_ _11"> </span>leading<span class="_ _11"> </span>value</div><div class="t m5 x17 h46 y3635 ff7 fs19 fc1 sc0 ls0 ws0">giving<span class="_"> </span>value<span class="_"> </span>1.0.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_"> </span>constant<span class="_"> </span>is<span class="_"> </span>therefore<span class="_"> </span>1<span class="_ _0"></span><span class="ff11">.<span class="ff7">0<span class="_"> </span><span class="ff12">×<span class="_ _13"></span></span>2</span></span></div><div class="t m5 x101 h3c y1632 ff7 fs25 fc1 sc0 ls0 ws0">5</div><div class="t m5 x215 h46 y1db4 ff12 fs19 fc1 sc0 ls0 ws0">=<span class="_ _13"> </span><span class="ff7">32<span class="_ _2"></span><span class="ff11">.</span><span class="ls93">0.</span></span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
