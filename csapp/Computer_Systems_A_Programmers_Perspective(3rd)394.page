<div id="pf18a" class="pf w2 h11" data-page-no="18a"><div class="pc pc18a w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg18a.png"/><div class="t m5 xfc h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>4.1<span class="_ _60"> </span>The<span class="_ _10"> </span>Y86-64<span class="_ _10"> </span>Instruction<span class="_ _10"> </span>Set<span class="_ _10"> </span>Architecture<span class="_ _1b"> </span><span class="ffe fs1e">393</span></div><div class="t m5 x17 h86 y36bd ff31 fs4b fc1 sc0 ls0 ws0">halt</div><div class="t m5 x17 h86 y36be ff31 fs4b fc1 sc0 ls0 ws0">nop</div><div class="t m5 x17 h86 y36bf ff31 fs4b fc1 sc0 ls0 ws0">rrmovq </div><div class="t m5 xe h86 y36c0 ff21 fs4c fc1 sc0 ls0 ws0">rA<span class="ff31 fs4b">,<span class="fs4d"> </span></span>rB</div><div class="t m5 x17 h86 y36c1 ff31 fs4b fc1 sc0 ls0 ws0">irmovq <span class="ff21 fs4c">V</span>,<span class="fs4d"> <span class="ff21 fs4c">rB</span></span></div><div class="t m5 x17 h86 y36c2 ff31 fs4b fc1 sc0 ls0 ws0">rmmovq <span class="ff21 fs4c">rA</span>,<span class="fs4d"> <span class="ff21 fs4c">D</span></span>(<span class="ff21 fs4c">rB</span>)</div><div class="t m5 x17 h86 y36c3 ff31 fs4b fc1 sc0 ls0 ws0">mrmovq </div><div class="t m5 xe h86 y36c4 ff21 fs4c fc1 sc0 ls0 ws0">D<span class="ff31 fs4b">(</span>rB<span class="ff31 fs4b">),<span class="fs4d"> </span></span>rA</div><div class="t m5 x17 h86 y36c5 ff31 fs4b fc1 sc0 ls0 ws0">OPq <span class="ff21 fs4c">rA</span>,<span class="fs4d"> <span class="ff21 fs4c">rB</span></span></div><div class="t m5 x17 h86 y36c6 ff31 fs4b fc1 sc0 ls0 ws0">jXX <span class="ff21 fs4c">Dest</span></div><div class="t m5 x17 h86 y36c7 ff31 fs4b fc1 sc0 ls0 ws0">cmovXX <span class="ff21 fs4c">rA</span>,<span class="fs4d"> <span class="ff21 fs4c">rB</span></span></div><div class="t m5 x17 h86 y36c8 ff31 fs4b fc1 sc0 ls0 ws0">call <span class="ff21 fs4c">Dest</span></div><div class="t m5 x17 h86 y36c9 ff31 fs4b fc1 sc0 ls0 ws0">ret</div><div class="t m5 x17 h86 y36ca ff31 fs4b fc1 sc0 ls0 ws0">pushq </div><div class="t m5 x23e h87 y36cb ff21 fs4c fc1 sc0 ls0 ws0">rA</div><div class="t m5 x17 h86 y36cc ff31 fs4b fc1 sc0 ls0 ws0">popq <span class="ff21 fs4c">rA</span></div><div class="t m5 x177 h86 y36bd ff31 fs4b fc1 sc0 ls0 ws0">0</div><div class="t m5 x177 h86 y36be ff31 fs4b fc1 sc0 ls0 ws0">1</div><div class="t m5 x177 h86 y36bf ff31 fs4b fc1 sc0 ls0 ws0">2</div><div class="t m5 x177 h86 y36cd ff31 fs4b fc1 sc0 ls0 ws0">3</div><div class="t m5 x177 h86 y36ce ff31 fs4b fc1 sc0 ls0 ws0">4</div><div class="t m5 x177 h86 y36cf ff31 fs4b fc1 sc0 ls0 ws0">5</div><div class="t m5 x177 h86 y36d0 ff31 fs4b fc1 sc0 ls0 ws0">6</div><div class="t m5 x177 h86 y36d1 ff31 fs4b fc1 sc0 ls0 ws0">7</div><div class="t m5 x177 h86 y36d2 ff31 fs4b fc1 sc0 ls0 ws0">2</div><div class="t m5 x177 h86 y36d3 ff31 fs4b fc1 sc0 ls0 ws0">8</div><div class="t m5 x177 h86 y36d4 ff31 fs4b fc1 sc0 ls0 ws0">9</div><div class="t m5 x177 h86 y36d5 ff31 fs4b fc1 sc0 ls0 ws0">A</div><div class="t m5 x177 h86 y36d6 ff31 fs4b fc1 sc0 ls0 ws0">B</div><div class="t m5 xc1 h87 y36d7 ff21 fs4c fc1 sc0 ls0 ws0">rB</div><div class="t m5 xc1 h87 y36d8 ff21 fs4c fc1 sc0 ls0 ws0">rB</div><div class="t m5 xc1 h87 y36d9 ff21 fs4c fc1 sc0 ls0 ws0">rB</div><div class="t m5 xc1 h87 y36da ff21 fs4c fc1 sc0 ls0 ws0">rB</div><div class="t m5 xc1 h87 y36db ff21 fs4c fc1 sc0 ls0 ws0">rB</div><div class="t m5 xc1 h87 y36dc ff21 fs4c fc1 sc0 ls0 ws0">rB</div><div class="t m5 x1d9 h87 y36d8 ff21 fs4c fc1 sc0 ls0 ws0">V</div><div class="t m5 x1d9 h87 y36d9 ff21 fs4c fc1 sc0 ls0 ws0">D</div><div class="t m5 x1d9 h87 y36da ff21 fs4c fc1 sc0 ls0 ws0">D</div><div class="t m5 xd4 h87 y36dd ff21 fs4c fc1 sc0 ls0 ws0">Dest</div><div class="t m5 xd4 h87 y36de ff21 fs4c fc1 sc0 ls0 ws0">Dest</div><div class="t m5 x177 h86 y36df ff31 fs4b fc1 sc0 ls0 ws0">0<span class="_ _19e"></span><span class="ff21 fs4d">Byte<span class="_ _98"> </span><span class="ff31 fs4b ls1ab">12<span class="_ _2"></span>3<span class="_ _2"></span>456789</span></span></div><div class="t m5 x145 h87 y36e0 ff21 fs4c fc1 sc0 ls0 ws0">rA</div><div class="t m5 x145 h87 y36e1 ff21 fs4c fc1 sc0 ls0 ws0">rA</div><div class="t m5 x10d h86 y36bd ff31 fs4b fc1 sc0 ls0 ws0">0</div><div class="t m5 x10d h86 y36be ff31 fs4b fc1 sc0 ls0 ws0">0</div><div class="t m5 x10d h86 y36bf ff31 fs4b fc1 sc0 ls0 ws0">0</div><div class="t m5 x10d h86 y36cd ff31 fs4b fc1 sc0 ls0 ws0">0</div><div class="t m5 x10d h86 y36ce ff31 fs4b fc1 sc0 ls0 ws0">0</div><div class="t m5 x10d h86 y36cf ff31 fs4b fc1 sc0 ls0 ws0">0</div><div class="t m5 x58 h87 y36c5 ff21 fs4c fc1 sc0 ls0 ws0">fn</div><div class="t m5 x58 h87 y36e2 ff21 fs4c fc1 sc0 ls0 ws0">fn</div><div class="t m5 x58 h87 y36e3 ff21 fs4c fc1 sc0 ls0 ws0">fn</div><div class="t m5 x10d h86 y36c8 ff31 fs4b fc1 sc0 ls0 ws0">0</div><div class="t m5 x10d h86 y36e4 ff31 fs4b fc1 sc0 ls0 ws0">0</div><div class="t m5 x10d h86 y36e5 ff31 fs4b fc1 sc0 ls0 ws0">0</div><div class="t m5 x10d h86 y36e6 ff31 fs4b fc1 sc0 ls0 ws0">0</div><div class="t m5 x25 h86 y36e7 ff31 fs4b fc1 sc0 ls0 ws0">F</div><div class="t m5 x25 h86 y36e8 ff31 fs4b fc1 sc0 ls0 ws0">F</div><div class="t m5 x145 h87 y36e9 ff21 fs4c fc1 sc0 ls0 ws0">rA</div><div class="t m5 x1a8 h86 y36ea ff31 fs4b fc1 sc0 ls0 ws0">F</div><div class="t m5 x145 h87 y36eb ff21 fs4c fc1 sc0 ls0 ws0">rA</div><div class="t m5 x145 h87 y36ec ff21 fs4c fc1 sc0 ls0 ws0">rA</div><div class="t m5 x145 h87 y36ed ff21 fs4c fc1 sc0 ls0 ws0">rA</div><div class="t m5 x145 h87 y36ee ff21 fs4c fc1 sc0 ls0 ws0">rA</div><div class="t m5 x17 h34 y36ef ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _16"> </span>4.2<span class="_ _c"> </span><span class="fc1">Y86-64<span class="_ _14"> </span>instruction<span class="_ _14"> </span>set.<span class="_ _16"> </span><span class="ff6">Instruction<span class="_ _14"> </span>encodings<span class="_ _14"> </span>range<span class="_ _14"> </span>between<span class="_ _16"> </span>1<span class="_ _14"> </span>and<span class="_ _14"> </span>10</span></span></div><div class="t m5 x17 h34 y36f0 ff6 fs16 fc1 sc0 ls0 ws0">bytes.<span class="_ _11"> </span>An<span class="_ _11"> </span>instruction<span class="_ _11"> </span>consists<span class="_ _11"> </span>of<span class="_ _11"> </span>a<span class="_ _11"> </span>1-byte<span class="_ _11"> </span>instruction<span class="_ _11"> </span>speciﬁer<span class="_ _1"></span>,<span class="_ _16"> </span>possibly<span class="_ _10"> </span>a<span class="_ _11"> </span>1-byte<span class="_ _11"> </span>register</div><div class="t m5 x17 h34 y36f1 ff6 fs16 fc1 sc0 ls0 ws0">speciﬁer<span class="_ _1"></span>,<span class="_ _16"> </span>and<span class="_ _16"> </span>possibly<span class="_ _16"> </span>an<span class="_ _16"> </span>8-byte<span class="_ _16"> </span>constant<span class="_ _16"> </span>word.<span class="_ _16"> </span>Field</div><div class="t m5 x92 h3a y36f2 ffd fs19 fc1 sc0 ls0 ws0">fn<span class="_ _16"> </span><span class="ff6 fs16">speciﬁes<span class="_ _16"> </span>a<span class="_ _16"> </span>particular<span class="_ _16"> </span>integer</span></div><div class="t m5 x17 h34 y36f3 ff6 fs16 fc1 sc0 ls0 ws0">operation<span class="_ _16"> </span>(</div><div class="t m5 x12 h3a y36f4 ffd fs19 fc1 sc0 ls0 ws0">OPq<span class="ff6 fs16">),<span class="_ _16"> </span>data<span class="_ _14"> </span>movement<span class="_ _16"> </span>condition<span class="_ _16"> </span>(</span>cmovXX<span class="ff6 fs16">),<span class="_ _14"> </span>or<span class="_ _16"> </span>branch<span class="_ _16"> </span>condition<span class="_ _14"> </span>(</span>jXX<span class="ff6 fs16">).<span class="_ _16"> </span>All</span></div><div class="t m5 x17 h34 y36f5 ff6 fs16 fc1 sc0 ls0 ws0">numeric<span class="_ _10"> </span>values<span class="_ _11"> </span>are<span class="_ _10"> </span>shown<span class="_ _10"> </span>in<span class="_ _11"> </span>hexadecimal.</div><div class="t m5 x72 h3d y36f6 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y7fe ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>seven<span class="_ _13"> </span>jump<span class="_ _13"> </span>instructions<span class="_"> </span>(shown<span class="_ _13"> </span>in<span class="_ _13"> </span>Figure<span class="_ _13"> </span>4.2<span class="_ _13"> </span>as<span class="_"> </span><span class="ffd">jXX</span>)<span class="_ _13"> </span>are<span class="_ _13"> </span><span class="ffd">jmp</span>,<span class="_"> </span><span class="ffd">jle</span>,<span class="_ _13"> </span><span class="ffd">jl</span>,<span class="_"> </span><span class="ffd">je</span>,</div><div class="t m5 x26 h26 y7ff ffd fs19 fc1 sc0 ls0 ws0">jne<span class="ff7">,<span class="_"> </span></span>jge<span class="ff7">,<span class="_ _13"> </span>and<span class="_"> </span></span>jg<span class="ff7">.<span class="_"> </span>Branches<span class="_ _13"> </span>are<span class="_"> </span>taken<span class="_"> </span>according<span class="_ _13"> </span>to<span class="_"> </span>the<span class="_"> </span>type<span class="_ _13"> </span>of<span class="_"> </span>branch<span class="_"> </span>and<span class="_ _13"> </span>the</span></div><div class="t m5 x26 h26 y800 ff7 fs19 fc1 sc0 ls0 ws0">settings<span class="_ _16"> </span>of<span class="_ _16"> </span>the<span class="_ _16"> </span>condition<span class="_ _11"> </span>codes<span class="_ _0"></span>.<span class="_ _16"> </span>T<span class="_ _1"></span>he<span class="_ _16"> </span>branch<span class="_ _16"> </span>conditions<span class="_ _16"> </span>are<span class="_ _16"> </span>the<span class="_ _16"> </span>same<span class="_ _16"> </span>as<span class="_ _11"> </span>with</div><div class="t m5 x26 h26 y801 ff7 fs19 fc1 sc0 ls0 ws0">x86-64<span class="_"> </span>(F<span class="_ _1"></span>igure<span class="_"> </span>3.15).</div><div class="t m5 x72 h3d y36f7 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y36f8 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>here<span class="_"> </span>are<span class="_ _11"> </span>six<span class="_"> </span>conditional<span class="_"> </span>move<span class="_"> </span>instructions<span class="_"> </span>(shown<span class="_ _11"> </span>in<span class="_"> </span>F<span class="_ _0"></span>igure<span class="_"> </span>4.2<span class="_"> </span>as<span class="_"> </span><span class="ffd">cmovXX</span>):</div><div class="t m5 x26 h26 y36f9 ffd fs19 fc1 sc0 ls0 ws0">cmovle<span class="ff7">,<span class="_ _e"> </span></span>cmovl<span class="ff7">,<span class="_ _f"> </span></span>cmove<span class="ff7">,<span class="_ _e"> </span></span>cmovne<span class="ff7">,<span class="_ _f"> </span></span>cmovge<span class="ff7">,<span class="_ _e"> </span>and<span class="_ _21"> </span></span>cmovg<span class="ff7">.<span class="_ _21"> </span>T<span class="_ _0"></span>hese<span class="_ _21"> </span>have<span class="_ _f"> </span>the<span class="_ _21"> </span>same</span></div><div class="t m5 x26 h26 y36fa ff7 fs19 fc1 sc0 ls0 ws0">format<span class="_ _11"> </span>as<span class="_ _16"> </span>the<span class="_ _11"> </span>register<span class="_ _1"></span>–register<span class="_ _16"> </span>move<span class="_ _11"> </span>instruction<span class="_ _16"> </span><span class="ffd">rrmovq</span>,<span class="_ _11"> </span>but<span class="_ _16"> </span>the<span class="_ _11"> </span>destination</div><div class="t m5 x26 h26 y36fb ff7 fs19 fc1 sc0 ls0 ws0">register<span class="_ _13"> </span>is<span class="_ _13"> </span>updated<span class="_ _6"> </span>only<span class="_ _13"> </span>if<span class="_ _13"> </span>the<span class="_ _13"> </span>condition<span class="_ _13"> </span>codes<span class="_ _13"> </span>satisfy<span class="_ _6"> </span>the<span class="_ _13"> </span>required<span class="_ _13"> </span>constraints<span class="_ _1"></span>.</div><div class="t m5 x72 h3d y36fc ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y36fd ff7 fs19 fc1 sc0 lsd ws0">Th<span class="_ _2"></span>e<span class="_ _11"> </span><span class="ffd ls0">call<span class="_ _13"> </span><span class="ff7">instruction<span class="_"> </span>pushes<span class="_"> </span>the<span class="_ _13"> </span>return<span class="_"> </span>address<span class="_"> </span>on<span class="_ _13"> </span>the<span class="_"> </span>stack<span class="_ _13"> </span>and<span class="_"> </span>jumps<span class="_"> </span>to<span class="_ _13"> </span>the</span></span></div><div class="t m5 x26 h26 y36fe ff7 fs19 fc1 sc0 ls0 ws0">destination<span class="_"> </span>address<span class="_ _1"></span>.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_"> </span><span class="ffd">ret<span class="_ _11"> </span></span>instruction<span class="_"> </span>returns<span class="_"> </span>from<span class="_"> </span>such<span class="_"> </span>a<span class="_"> </span>call.</div><div class="t m5 x72 h3d y36ff ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y831 ff7 fs19 fc1 sc0 lsd ws0">Th<span class="_ _2"></span>e<span class="_ _16"> </span><span class="ffd ls0">pushq<span class="_ _10"> </span><span class="ff7">and<span class="_"> </span></span>popq<span class="_ _11"> </span><span class="ff7">instructions<span class="_"> </span>implement<span class="_ _11"> </span>push<span class="_"> </span>and<span class="_ _11"> </span>pop<span class="_ _0"></span>,<span class="_"> </span>just<span class="_ _11"> </span>as<span class="_"> </span>they<span class="_ _11"> </span>do<span class="_"> </span>in</span></span></div><div class="t m5 x26 h26 y3700 ff7 fs19 fc1 sc0 ls0 ws0">x86-64.</div><div class="t m5 x72 h3d y3701 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y8d6 ff7 fs19 fc1 sc0 lsd ws0">Th<span class="_ _2"></span>e<span class="_ _21"> </span><span class="ffd ls0">halt<span class="_ _15"> </span><span class="ff7">instruction<span class="_ _14"> </span>stops<span class="_ _15"> </span>instruction<span class="_ _15"> </span>execution.<span class="_ _14"> </span>x86-64<span class="_ _15"> </span>has<span class="_ _15"> </span>a<span class="_ _15"> </span>comparable</span></span></div><div class="t m5 x26 h26 y8d7 ff7 fs19 fc1 sc0 ls0 ws0">instruction,<span class="_"> </span>called<span class="_"> </span><span class="ffd">hlt</span>.<span class="_"> </span>x86-64<span class="_"> </span>application<span class="_"> </span>programs<span class="_"> </span>are<span class="_"> </span>not<span class="_"> </span>permitted<span class="_ _13"> </span>to<span class="_"> </span>use</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
