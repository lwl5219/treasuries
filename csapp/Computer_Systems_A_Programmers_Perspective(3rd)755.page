<div id="pf2f3" class="pf w2 h11" data-page-no="2f3"><div class="pc pc2f3 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg2f3.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">754<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>7<span class="_ _3d"> </span>Linking</span></div><div class="t m5 x1d h31 ye7 ff7 fs21 fc2 sc0 ls0 ws0">Symbol<span class="_ _26"> </span><span class="ffd fs1e">.symtab<span class="_ _10"> </span></span>entry?<span class="_ _26"> </span>Symbol<span class="_"> </span>type<span class="_ _26"> </span>Module<span class="_"> </span>where<span class="_"> </span>deﬁned<span class="_ _78"> </span>Section</div><div class="t m5 x1d h31 yb20 ffd fs1e fc2 sc0 ls0 ws0">buf<span class="_ _16d"> </span><span class="ff7 fs21">Y<span class="_ _7"></span>es<span class="_ _192"> </span>extern<span class="_ _158"> </span><span class="ffd fs1e">m.o<span class="_ _144"> </span>.data</span></span></div><div class="t m5 x1d h2d y1d5a ffd fs1e fc2 sc0 ls0 ws0">bufp0</div><div class="t m5 x27a h31 y9bb ff7 fs21 fc2 sc0 ls0 ws0">Y<span class="_ _3"></span>es<span class="_ _192"> </span>global<span class="_ _6a"> </span><span class="ffd fs1e">swap.o<span class="_ _8f"> </span>.data</span></div><div class="t m5 x1d h2d y6348 ffd fs1e fc2 sc0 ls0 ws0">bufp1</div><div class="t m5 x27a h31 y9bc ff7 fs21 fc2 sc0 ls0 ws0">Y<span class="_ _3"></span>es<span class="_ _192"> </span>global<span class="_ _6a"> </span><span class="ffd fs1e">swap.o<span class="_ _121"> </span></span>COMMON</div><div class="t m5 x1d h31 y9bd ffd fs1e fc2 sc0 ls0 ws0">swap<span class="_ _56"> </span><span class="ff7 fs21">Y<span class="_ _3"></span>es<span class="_ _6b"> </span>global<span class="_ _89"> </span><span class="ffd fs1e">swap.o<span class="_ _1b1"> </span>.text</span></span></div><div class="t m5 x1d h2d y6349 ffd fs1e fc2 sc0 ls0 ws0">temp</div><div class="t m5 x8f h31 y9be ff7 fs21 fc2 sc0 ls0 ws0">No<span class="_ _107"> </span>—<span class="_ _138"> </span>—<span class="_ _15f"> </span>—</div><div class="t m5 x1d h28 y634a ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>7.2<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>720)</span></div><div class="t m5 x1d h26 y634b ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _13"> </span>is<span class="_ _13"> </span>a<span class="_ _13"> </span>simple<span class="_ _13"> </span>drill<span class="_ _13"> </span>that<span class="_ _13"> </span>checks<span class="_ _13"> </span>your<span class="_ _13"> </span>understanding<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>rules<span class="_ _13"> </span>that<span class="_ _13"> </span>a<span class="_ _13"> </span>Unix<span class="_ _13"> </span>linker</div><div class="t m5 x1d h26 y634c ff7 fs19 fc1 sc0 ls0 ws0">uses<span class="_ _11"> </span>when<span class="_ _16"> </span>it<span class="_ _11"> </span>resolves<span class="_ _16"> </span>global<span class="_ _11"> </span>symbols<span class="_ _16"> </span>that<span class="_ _11"> </span>are<span class="_ _16"> </span>deﬁned<span class="_ _11"> </span>in<span class="_ _16"> </span>more<span class="_ _11"> </span>than<span class="_ _16"> </span>one<span class="_ _16"> </span>module<span class="_ _1"></span>.</div><div class="t m5 x1d h26 y634d ff7 fs19 fc1 sc0 ls0 ws0">Understanding<span class="_"> </span>these<span class="_"> </span>rules<span class="_"> </span>can<span class="_"> </span>help<span class="_"> </span>you<span class="_"> </span>avoid<span class="_"> </span>some<span class="_"> </span>nasty<span class="_"> </span>programming<span class="_"> </span>bugs<span class="_ _1"></span>.</div><div class="t m5 x124 h26 y634e ff7 fs19 fc1 sc0 ls0 ws0">A.<span class="_ _1f"> </span>T<span class="_ _1"></span>he<span class="_ _14"> </span>linker<span class="_ _14"> </span>chooses<span class="_ _14"> </span>the<span class="_ _14"> </span>strong<span class="_ _14"> </span>symbol<span class="_ _16"> </span>deﬁned<span class="_ _14"> </span>in<span class="_ _14"> </span>module<span class="_ _14"> </span>1<span class="_ _14"> </span>over<span class="_ _14"> </span>the<span class="_ _14"> </span>weak</div><div class="t m5 x4f h26 y634f ff7 fs19 fc1 sc0 ls0 ws0">symbol<span class="_"> </span>deﬁned<span class="_"> </span>in<span class="_"> </span>module<span class="_"> </span>2<span class="_"> </span>(rule<span class="_"> </span>2):</div><div class="t m5 x4f h46 y6350 ff7 fs19 fc1 sc0 ls0 ws0">(a)<span class="_ _1d"> </span><span class="ffd">REF<span class="ff11">(</span>main<span class="_ _2"></span><span class="ff11">.</span>1<span class="_ _1"></span><span class="ff11">)<span class="_ _13"> </span><span class="ff12">→<span class="_ _10"> </span><span class="ffd">DEF</span></span>(<span class="ffd">main</span>.<span class="ffd">1<span class="_ _1"></span><span class="ff11">)</span></span></span></span></div><div class="t m5 x4f h46 y6351 ff7 fs19 fc1 sc0 ls0 ws0">(b)<span class="_ _24"> </span><span class="ffd">REF<span class="ff11">(</span>main<span class="ff11">.</span>2<span class="ff11">)<span class="_ _13"> </span><span class="ff12">→<span class="_ _10"> </span></span></span>DEF<span class="ff11">(</span>main<span class="ff11">.</span>1<span class="_ _1"></span><span class="ff11">)</span></span></div><div class="t m5 x124 h26 y6352 ff7 fs19 fc1 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>This<span class="_ _6"> </span>is<span class="_ _13"> </span>an<span class="_ _13"> </span><span class="ff9">error</span>,<span class="_ _13"> </span>because<span class="_ _13"> </span>each<span class="_ _13"> </span>module<span class="_ _13"> </span>deﬁnes<span class="_ _13"> </span>a<span class="_ _13"> </span>strong<span class="_ _13"> </span>symbol<span class="_ _13"> </span><span class="ffd">main<span class="_ _13"> </span></span>(rule<span class="_ _13"> </span>1).</div><div class="t m5 x124 h26 y6353 ff7 fs19 fc1 sc0 ls0 ws0">C.<span class="_ _25"> </span>T<span class="_ _1"></span>he<span class="_ _14"> </span>linker<span class="_ _14"> </span>chooses<span class="_ _14"> </span>the<span class="_ _14"> </span>strong<span class="_ _16"> </span>symbol<span class="_ _14"> </span>deﬁned<span class="_ _14"> </span>in<span class="_ _14"> </span>module<span class="_ _14"> </span>2<span class="_ _14"> </span>over<span class="_ _14"> </span>the<span class="_ _14"> </span>weak</div><div class="t m5 x4f h26 y6354 ff7 fs19 fc1 sc0 ls0 ws0">symbol<span class="_"> </span>deﬁned<span class="_"> </span>in<span class="_"> </span>module<span class="_"> </span>1<span class="_"> </span>(rule<span class="_"> </span>2):</div><div class="t m5 x4f h46 y6355 ff7 fs19 fc1 sc0 ls0 ws0">(a)<span class="_ _1d"> </span><span class="ffd">REF<span class="ff11">(</span>x<span class="ff11">.</span>1<span class="_ _1"></span><span class="ff11">)<span class="_ _10"> </span><span class="ff12">→<span class="_ _13"> </span><span class="ffd">DEF</span></span>(<span class="ffd">x</span>.<span class="ffd">2</span>)</span></span></div><div class="t m5 x4f h46 y6356 ff7 fs19 fc1 sc0 ls0 ws0">(b)<span class="_ _24"> </span><span class="ffd">REF<span class="ff11">(</span>x<span class="ff11">.</span>2<span class="_ _0"></span><span class="ff11">)<span class="_ _13"> </span><span class="ff12">→<span class="_ _10"> </span><span class="ffd">DEF</span></span>(<span class="ffd">x</span>.<span class="ffd">2<span class="_ _0"></span><span class="ff11">)</span></span></span></span></div><div class="t m5 x1d h28 y2657 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>7.3<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>725)</span></div><div class="t m5 x1d h26 y6357 ff7 fs19 fc1 sc0 ls0 ws0">Placing<span class="_ _6"> </span>static<span class="_ _13"> </span>libraries<span class="_ _a"> </span>in<span class="_ _13"> </span>the<span class="_ _a"> </span>wrong<span class="_ _13"> </span>order<span class="_ _6"> </span>on<span class="_ _6"> </span>the<span class="_ _13"> </span>command<span class="_ _a"> </span>line<span class="_ _13"> </span>is<span class="_ _a"> </span>a<span class="_ _13"> </span>common<span class="_ _6"> </span>source</div><div class="t m5 x1d h26 y6358 ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_ _13"> </span>linker<span class="_ _13"> </span>errors<span class="_ _13"> </span>that<span class="_"> </span>confuses<span class="_ _13"> </span>many<span class="_ _13"> </span>programmers<span class="_ _1"></span>.<span class="_ _13"> </span>However,<span class="_ _13"> </span>once<span class="_ _13"> </span>you<span class="_ _13"> </span>understand</div><div class="t m5 x1d h26 y6359 ff7 fs19 fc1 sc0 ls0 ws0">how<span class="_ _16"> </span>linkers<span class="_ _16"> </span>use<span class="_ _16"> </span>static<span class="_ _16"> </span>libraries<span class="_ _16"> </span>to<span class="_ _16"> </span>resolve<span class="_ _16"> </span>references<span class="_ _1"></span>,<span class="_ _14"> </span>it’s<span class="_ _16"> </span>pretty<span class="_ _16"> </span>straightforward.</div><div class="t m5 x1d h26 y635a ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_"> </span>little<span class="_"> </span>drill<span class="_"> </span>checks<span class="_"> </span>your<span class="_"> </span>understanding<span class="_"> </span>of<span class="_"> </span>this<span class="_"> </span>idea:</div><div class="t m5 x124 h26 y635b ff7 fs19 fc1 sc0 ls0 ws0">A.</div><div class="t m5 x4f h2d y635c ffd fs1e fc2 sc0 ls0 ws0">linux&gt;<span class="_ _1a"> </span>gcc<span class="_ _e"> </span>p.o<span class="_ _1f"> </span>libx.a</div><div class="t m5 x124 h26 y635d ff7 fs19 fc2 sc0 ls2a ws0">B.<span class="_ _66"> </span><span class="ffd fs1e ls0">linux&gt;<span class="_ _1a"> </span>gcc<span class="_ _e"> </span>p.o<span class="_ _1f"> </span>libx.a<span class="_ _1f"> </span>liby.a</span></div><div class="t m5 x124 h26 y635e ff7 fs19 fc2 sc0 ls22 ws0">C.</div><div class="t m5 x4f h2d y635f ffd fs1e fc2 sc0 ls0 ws0">linux&gt;<span class="_ _1a"> </span>gcc<span class="_ _e"> </span>p.o<span class="_ _1f"> </span>libx.a<span class="_ _1f"> </span>liby.a<span class="_ _e"> </span>libx.a</div><div class="t m5 x1d h28 y6360 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>7.4</div><div class="t m5 x1ed h2f y6361 ffe fs16 fc6 sc0 ls0 ws0">(page<span class="_"> </span>730)</div><div class="t m5 x1d h26 y2604 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _f"> </span>problem<span class="_ _21"> </span>concerns<span class="_ _21"> </span>the<span class="_ _f"> </span>disassembly<span class="_ _21"> </span>listing<span class="_ _21"> </span>in<span class="_ _f"> </span>F<span class="_ _0"></span>igure<span class="_ _21"> </span>7.12(a).<span class="_ _21"> </span>Our<span class="_ _f"> </span>purpose</div><div class="t m5 x1d h26 y6362 ff7 fs19 fc1 sc0 ls0 ws0">here<span class="_ _11"> </span>is<span class="_ _11"> </span>to<span class="_ _16"> </span>give<span class="_ _11"> </span>you<span class="_ _11"> </span>some<span class="_ _16"> </span>practice<span class="_"> </span>reading<span class="_ _16"> </span>disassembly<span class="_ _11"> </span>listings<span class="_ _11"> </span>and<span class="_ _16"> </span>to<span class="_ _11"> </span>check<span class="_ _11"> </span>your</div><div class="t m5 x1d h26 y6363 ff7 fs19 fc1 sc0 ls0 ws0">understanding<span class="_"> </span>of<span class="_"> </span>PC-relative<span class="_"> </span>addressing.</div><div class="t m5 x124 h26 y6364 ff7 fs19 fc1 sc0 ls0 ws0">A.<span class="_ _1f"> </span>T<span class="_ _1"></span>he<span class="_"> </span>hex<span class="_"> </span>address<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>relocated<span class="_"> </span>reference<span class="_"> </span>in<span class="_"> </span>line<span class="_"> </span>5<span class="_"> </span>is<span class="_"> </span><span class="ffd">0x4004df</span>.</div><div class="t m5 x124 h26 y6365 ff7 fs19 fc1 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>The<span class="_ _16"> </span>hex<span class="_ _16"> </span>value<span class="_ _14"> </span>of<span class="_ _16"> </span>the<span class="_ _14"> </span>relocated<span class="_ _16"> </span>reference<span class="_ _14"> </span>in<span class="_ _14"> </span>line<span class="_ _16"> </span>5<span class="_ _14"> </span>is<span class="_ _14"> </span><span class="ffd">0x5</span>.<span class="_ _16"> </span>Remember<span class="_ _14"> </span>that</div><div class="t m5 x4f h26 y6366 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>disassembly<span class="_ _13"> </span>listing<span class="_"> </span>shows<span class="_ _13"> </span>the<span class="_"> </span>value<span class="_ _13"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>reference<span class="_"> </span>in<span class="_"> </span>little-endian<span class="_ _13"> </span>byte</div><div class="t m5 x4f h26 y6367 ff7 fs19 fc1 sc0 ls0 ws0">order.</div><div class="t m5 x1d h28 y1d3d ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>7.5<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>731)</span></div><div class="t m5 x1d h26 yc2 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _15"> </span>problem<span class="_ _14"> </span>tests<span class="_ _15"> </span>your<span class="_ _14"> </span>understanding<span class="_ _15"> </span>of<span class="_ _15"> </span>how<span class="_ _14"> </span>the<span class="_ _15"> </span>linker<span class="_ _14"> </span>relocates<span class="_ _15"> </span>PC-relative</div><div class="t m5 x1d h26 y35ee ff7 fs19 fc1 sc0 ls0 ws0">references<span class="_ _1"></span>.<span class="_"> </span>Y<span class="_ _3"></span>ou<span class="_"> </span>were<span class="_"> </span>given<span class="_"> </span>that</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
