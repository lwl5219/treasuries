<div id="pf31b" class="pf w2 h11" data-page-no="31b"><div class="pc pc31b w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg31b.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">794<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>8<span class="_ _3d"> </span>Exceptional<span class="_ _10"> </span>Control<span class="_ _10"> </span>Flow</span></div><div class="t m5 x1d h26 y9c ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span>occurrence<span class="_"> </span>of<span class="_"> </span>such<span class="_"> </span>exceptions<span class="_"> </span>to<span class="_"> </span>user<span class="_"> </span>processes<span class="_ _1"></span>.<span class="_"> </span>F<span class="_ _1"></span>or<span class="_"> </span>example,<span class="_"> </span>if<span class="_"> </span>a<span class="_"> </span>process<span class="_"> </span>at-</div><div class="t m5 x1d h26 y409 ff7 fs19 fc2 sc0 ls0 ws0">tempts<span class="_ _16"> </span>to<span class="_ _16"> </span>divide<span class="_ _16"> </span>by<span class="_ _16"> </span>zero<span class="_ _1"></span>,<span class="_ _16"> </span>then<span class="_ _16"> </span>the<span class="_ _16"> </span>kernel<span class="_ _16"> </span>sends<span class="_ _16"> </span>it<span class="_ _16"> </span>a<span class="_ _16"> </span>SIGFPE<span class="_ _16"> </span>signal<span class="_ _16"> </span>(number<span class="_ _16"> </span>8).</div><div class="t m5 x1d h26 y40a ff7 fs19 fc2 sc0 ls0 ws0">If<span class="_ _16"> </span>a<span class="_ _14"> </span>process<span class="_ _14"> </span>executes<span class="_ _16"> </span>an<span class="_ _14"> </span>illegal<span class="_ _14"> </span>instruction,<span class="_ _14"> </span>the<span class="_ _14"> </span>kernel<span class="_ _16"> </span>sends<span class="_ _14"> </span>it<span class="_ _14"> </span>a<span class="_ _16"> </span>SIGILL<span class="_ _14"> </span>signal</div><div class="t m5 x1d h26 y40b ff7 fs19 fc2 sc0 ls0 ws0">(number<span class="_"> </span>4).<span class="_"> </span>If<span class="_"> </span>a<span class="_ _13"> </span>process<span class="_"> </span>makes<span class="_"> </span>an<span class="_"> </span>illegal<span class="_"> </span>memory<span class="_"> </span>reference<span class="_ _1"></span>,<span class="_"> </span>the<span class="_"> </span>kernel<span class="_"> </span>sends<span class="_ _13"> </span>it<span class="_"> </span>a</div><div class="t m5 x1d h26 y40c ff7 fs19 fc2 sc0 ls0 ws0">SIGSEGV<span class="_"> </span>signal<span class="_ _13"> </span>(number<span class="_"> </span>11).<span class="_"> </span>Other<span class="_ _13"> </span>signals<span class="_"> </span>correspond<span class="_"> </span>to<span class="_ _13"> </span>higher<span class="_ _1"></span>-level<span class="_"> </span>software</div><div class="t m5 x1d h26 y40d ff7 fs19 fc2 sc0 ls0 ws0">events<span class="_ _11"> </span>in<span class="_ _16"> </span>the<span class="_ _16"> </span>kernel<span class="_ _11"> </span>or<span class="_ _16"> </span>in<span class="_ _16"> </span>other<span class="_ _11"> </span>user<span class="_ _16"> </span>processes<span class="_ _1"></span>.<span class="_ _16"> </span>F<span class="_ _3"></span>or<span class="_ _16"> </span>example<span class="_ _0"></span>,<span class="_ _16"> </span>if<span class="_ _16"> </span>you<span class="_ _11"> </span>type<span class="_ _16"> </span>Ctrl+C</div><div class="t m5 x1d h26 y40e ff7 fs19 fc2 sc0 ls0 ws0">(i.e<span class="_ _1"></span>.,<span class="_"> </span>press<span class="_ _13"> </span>the<span class="_ _13"> </span>Ctrl<span class="_ _13"> </span>key<span class="_"> </span>and<span class="_ _13"> </span>the<span class="_ _13"> </span>‘c’<span class="_ _13"> </span>key<span class="_ _13"> </span>at<span class="_"> </span>the<span class="_ _13"> </span>same<span class="_ _13"> </span>time)<span class="_ _13"> </span>while<span class="_ _13"> </span>a<span class="_"> </span>process<span class="_ _13"> </span>is<span class="_ _13"> </span>running</div><div class="t m5 x1d h26 y40f ff7 fs19 fc2 sc0 ls0 ws0">in<span class="_"> </span>the<span class="_ _13"> </span>foreground,<span class="_"> </span>then<span class="_ _13"> </span>the<span class="_"> </span>kernel<span class="_"> </span>sends<span class="_ _13"> </span>a<span class="_"> </span>SIGINT<span class="_ _13"> </span>(number<span class="_"> </span>2)<span class="_ _13"> </span>to<span class="_"> </span>each<span class="_"> </span>process<span class="_ _13"> </span>in</div><div class="t m5 x1d h26 y410 ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _11"> </span>foreground<span class="_ _11"> </span>process<span class="_ _11"> </span>group<span class="_ _0"></span>.<span class="_ _11"> </span>A<span class="_ _11"> </span>process<span class="_ _11"> </span>can<span class="_ _11"> </span>forcibly<span class="_ _11"> </span>terminate<span class="_ _11"> </span>another<span class="_ _16"> </span>process</div><div class="t m5 x1d h26 y411 ff7 fs19 fc2 sc0 ls0 ws0">by<span class="_ _11"> </span>sending<span class="_ _11"> </span>it<span class="_ _11"> </span>a<span class="_ _11"> </span>SIGKILL<span class="_ _11"> </span>signal<span class="_ _11"> </span>(number<span class="_ _11"> </span>9).<span class="_ _11"> </span>When<span class="_"> </span>a<span class="_ _11"> </span>child<span class="_ _16"> </span>process<span class="_"> </span>terminates<span class="_ _11"> </span>or</div><div class="t m5 x1d h26 y412 ff7 fs19 fc2 sc0 ls0 ws0">stops<span class="_ _1"></span>,<span class="_"> </span>the<span class="_"> </span>kernel<span class="_"> </span>sends<span class="_"> </span>a<span class="_"> </span>SIGCHLD<span class="_"> </span>signal<span class="_"> </span>(number<span class="_"> </span>17)<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>parent.</div><div class="t m5 x1d h41 y67c3 ffe fs29 fc2 sc0 ls0 ws0">8.5.1<span class="_ _48"> </span><span class="fs19">Signal<span class="_"> </span>T<span class="_ _3"></span>erminology</span></div><div class="t m5 x1d h26 y67c4 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>transfer<span class="_"> </span>of<span class="_"> </span>a<span class="_"> </span>signal<span class="_"> </span>to<span class="_"> </span>a<span class="_"> </span>destination<span class="_"> </span>process<span class="_"> </span>occurs<span class="_"> </span>in<span class="_"> </span>two<span class="_"> </span>distinct<span class="_"> </span>steps:</div><div class="t m5 x75 h26 y67c5 ffa fs19 fc2 sc0 ls0 ws0">Sending<span class="_ _13"> </span>a<span class="_ _13"> </span>signal.<span class="_ _15"> </span><span class="ff7">The<span class="_ _13"> </span>kernel<span class="_ _6"> </span></span>sends<span class="_ _13"> </span><span class="ff7">(</span>delivers<span class="ff7">)<span class="_ _13"> </span>a<span class="_ _13"> </span>signal<span class="_ _13"> </span>to<span class="_ _13"> </span>a<span class="_ _13"> </span>destination<span class="_ _13"> </span>process<span class="_ _13"> </span>by</span></div><div class="t m5 xcd h26 y67c6 ff7 fs19 fc2 sc0 ls0 ws0">updating<span class="_"> </span>some<span class="_"> </span>state<span class="_ _11"> </span>in<span class="_"> </span>the<span class="_ _11"> </span>context<span class="_"> </span>of<span class="_"> </span>the<span class="_ _11"> </span>destination<span class="_"> </span>process<span class="_ _1"></span>.<span class="_ _11"> </span>T<span class="_ _0"></span>he<span class="_"> </span>signal</div><div class="t m5 xcd h26 y67c7 ff7 fs19 fc2 sc0 ls0 ws0">is<span class="_"> </span>delivered<span class="_"> </span>for<span class="_"> </span>one<span class="_"> </span>of<span class="_"> </span>two<span class="_"> </span>reasons:<span class="_"> </span>(1)<span class="_"> </span>T<span class="_ _3"></span>he<span class="_"> </span>kernel<span class="_"> </span>has<span class="_"> </span>detected<span class="_"> </span>a<span class="_"> </span>system</div><div class="t m5 xcd h26 y67c8 ff7 fs19 fc2 sc0 ls0 ws0">event<span class="_ _13"> </span>such<span class="_"> </span>as<span class="_ _13"> </span>a<span class="_ _13"> </span>divide-by-zero<span class="_"> </span>error<span class="_ _13"> </span>or<span class="_ _13"> </span>the<span class="_"> </span>termination<span class="_ _13"> </span>of<span class="_ _13"> </span>a<span class="_"> </span>child<span class="_ _13"> </span>process<span class="_ _1"></span>.</div><div class="t m5 xcd h26 y67c9 ff7 fs19 fc2 sc0 ls0 ws0">(2)<span class="_ _6"> </span>A<span class="_ _6"> </span>process<span class="_ _6"> </span>has<span class="_ _6"> </span>invoked<span class="_ _6"> </span>the<span class="_ _6"> </span><span class="ffd">kill<span class="_ _6"> </span></span>function<span class="_ _6"> </span>(discussed<span class="_ _6"> </span>in<span class="_ _6"> </span>the<span class="_ _6"> </span>next<span class="_ _6"> </span>section)</div><div class="t m5 xcd h26 y67ca ff7 fs19 fc2 sc0 ls0 ws0">to<span class="_ _13"> </span>explicitly<span class="_"> </span>request<span class="_ _13"> </span>the<span class="_ _13"> </span>kernel<span class="_ _13"> </span>to<span class="_"> </span>send<span class="_ _13"> </span>a<span class="_ _13"> </span>signal<span class="_ _13"> </span>to<span class="_"> </span>the<span class="_ _13"> </span>destination<span class="_ _13"> </span>process<span class="_ _1"></span>.</div><div class="t m5 xcd h26 y67cb ff7 fs19 fc2 sc0 ls0 ws0">A<span class="_"> </span>process<span class="_"> </span>can<span class="_"> </span>send<span class="_"> </span>a<span class="_"> </span>signal<span class="_"> </span>to<span class="_"> </span>itself<span class="_ _1"></span>.</div><div class="t m5 x75 h26 y67cc ffa fs19 fc2 sc0 ls0 ws0">Receiving<span class="_"> </span>a<span class="_ _11"> </span>signal.<span class="_ _f"> </span><span class="ff7">A<span class="_ _11"> </span>destination<span class="_ _11"> </span>process<span class="_ _11"> </span></span>receives<span class="_ _11"> </span><span class="ff7">a<span class="_ _11"> </span>signal<span class="_ _11"> </span>when<span class="_ _11"> </span>it<span class="_"> </span>is<span class="_ _11"> </span>forced<span class="_ _11"> </span>by</span></div><div class="t m5 xcd h26 y67cd ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span>kernel<span class="_"> </span>to<span class="_"> </span>react<span class="_"> </span>in<span class="_"> </span>some<span class="_ _13"> </span>way<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>delivery<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>signal.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_"> </span>process</div><div class="t m5 xcd h26 y67ce ff7 fs19 fc2 sc0 ls0 ws0">can<span class="_ _16"> </span>either<span class="_ _16"> </span>ignore<span class="_ _16"> </span>the<span class="_ _16"> </span>signal,<span class="_ _14"> </span>terminate<span class="_ _1"></span>,<span class="_ _14"> </span>or<span class="_ _16"> </span><span class="ffa">catch<span class="_ _16"> </span></span>the<span class="_ _16"> </span>signal<span class="_ _16"> </span>by<span class="_ _16"> </span>executing</div><div class="t m5 xcd h26 y67cf ff7 fs19 fc2 sc0 ls0 ws0">a<span class="_ _11"> </span>user<span class="_ _1"></span>-level<span class="_ _11"> </span>function<span class="_ _11"> </span>called<span class="_ _11"> </span>a<span class="_ _11"> </span><span class="ffa">signal<span class="_ _16"> </span>handler<span class="_ _2"></span></span>.<span class="_"> </span>Figure<span class="_"> </span>8.27<span class="_ _11"> </span>shows<span class="_ _11"> </span>the<span class="_ _11"> </span>basic</div><div class="t m5 xcd h26 y67d0 ff7 fs19 fc2 sc0 ls0 ws0">idea<span class="_"> </span>of<span class="_"> </span>a<span class="_"> </span>handler<span class="_"> </span>catching<span class="_"> </span>a<span class="_"> </span>signal.</div><div class="t m5 x29 h26 y67d1 ff7 fs19 fc2 sc0 ls0 ws0">A<span class="_"> </span>signal<span class="_"> </span>that<span class="_ _13"> </span>has<span class="_"> </span>been<span class="_"> </span>sent<span class="_"> </span>but<span class="_ _13"> </span>not<span class="_"> </span>yet<span class="_"> </span>received<span class="_"> </span>is<span class="_"> </span>called<span class="_ _13"> </span>a<span class="_"> </span><span class="ffa">pending<span class="_"> </span>signal<span class="_ _2"></span></span><span class="ls282">.A<span class="_ _4a"></span>t</span></div><div class="t m5 x1d h26 y67d2 ff7 fs19 fc2 sc0 ls0 ws0">any<span class="_ _16"> </span>point<span class="_ _16"> </span>in<span class="_ _16"> </span>time,<span class="_ _16"> </span>there<span class="_ _16"> </span>can<span class="_ _14"> </span>be<span class="_ _16"> </span>at<span class="_ _16"> </span>most<span class="_ _16"> </span>one<span class="_ _14"> </span>pending<span class="_ _16"> </span>signal<span class="_ _16"> </span>of<span class="_ _14"> </span>a<span class="_ _16"> </span>particular<span class="_ _16"> </span>type.</div><div class="t m5 x1d h26 y67d3 ff7 fs19 fc2 sc0 ls0 ws0">If<span class="_ _16"> </span>a<span class="_ _16"> </span>process<span class="_ _16"> </span>has<span class="_ _16"> </span>a<span class="_ _16"> </span>pending<span class="_ _14"> </span>signal<span class="_ _16"> </span>of<span class="_ _16"> </span>type<span class="_ _16"> </span><span class="ff11">k<span class="_ _2"></span></span>,<span class="_ _14"> </span>then<span class="_ _16"> </span>any<span class="_ _16"> </span>subsequent<span class="_ _16"> </span>signals<span class="_ _14"> </span>of<span class="_ _16"> </span>type</div><div class="t m5 x1d h26 y67d4 ff11 fs19 fc2 sc0 ls0 ws0">k<span class="_"> </span><span class="ff7">sent<span class="_ _16"> </span>to<span class="_ _16"> </span>that<span class="_ _11"> </span>process<span class="_ _16"> </span>are<span class="_ _16"> </span><span class="ffa">not<span class="_ _14"> </span></span>queued;<span class="_ _16"> </span>they<span class="_ _16"> </span>are<span class="_ _16"> </span>simply<span class="_ _16"> </span>discarded.<span class="_ _11"> </span>A<span class="_ _16"> </span>process<span class="_ _16"> </span>can</span></div><div class="t m5 x1d h26 y67d5 ff7 fs19 fc2 sc0 ls0 ws0">selectively<span class="_"> </span><span class="ffa">block<span class="_"> </span></span>the<span class="_"> </span>receipt<span class="_"> </span>of<span class="_"> </span>certain<span class="_ _13"> </span>signals<span class="_ _1"></span>.<span class="_"> </span>When<span class="_"> </span>a<span class="_"> </span>signal<span class="_"> </span>is<span class="_ _13"> </span>blocked,<span class="_"> </span>it<span class="_"> </span>can<span class="_"> </span>be</div><div class="t m5 x14 h2f y67d6 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>8.27</div><div class="t m5 x14 h34 y67d7 ffe fs16 fc1 sc0 ls0 ws0">Signal<span class="_ _11"> </span>handling.<span class="_ _16"> </span><span class="ff6">Receipt</span></div><div class="t m5 x14 h34 y67d8 ff6 fs16 fc1 sc0 ls0 ws0">of<span class="_ _14"> </span>a<span class="_ _15"> </span>signal<span class="_ _15"> </span>triggers<span class="_ _15"> </span>a</div><div class="t m5 x14 h34 y67d9 ff6 fs16 fc1 sc0 ls0 ws0">control<span class="_ _11"> </span>transfer<span class="_ _11"> </span>to<span class="_ _10"> </span>a<span class="_ _11"> </span>signal</div><div class="t m5 x14 h34 y67da ff6 fs16 fc1 sc0 ls0 ws0">handler<span class="_ _3"></span>.<span class="_ _16"> </span>After<span class="_ _14"> </span>it<span class="_ _16"> </span>ﬁnishes</div><div class="t m5 x14 h34 y67db ff6 fs16 fc1 sc0 ls0 ws0">processing,<span class="_ _16"> </span>the<span class="_ _14"> </span>handler</div><div class="t m5 x14 h34 y67dc ff6 fs16 fc1 sc0 ls0 ws0">returns<span class="_ _14"> </span>control<span class="_ _14"> </span>to<span class="_ _14"> </span>the</div><div class="t m5 x14 h34 y67dd ff6 fs16 fc1 sc0 ls0 ws0">interrupted<span class="_ _10"> </span>program.</div><div class="t m5 xb1 h3f y67de ff9e fs27 fc1 sc0 ls0 ws0">(2) Control passes</div><div class="t m5 xd8 h3f y67df ff9e fs27 fc1 sc0 ls0 ws0">to signal handler</div><div class="t m5 x44 h3f y67e0 ff9e fs27 fc1 sc0 ls0 ws0">(3) Signal</div><div class="t m5 x44 h3f y67e1 ff9e fs27 fc1 sc0 ls0 ws0">handler run</div><div class="c xe0 yc2 w2d h104"><div class="t m5 x157 h3f y67e2 ff9e fs27 fc1 sc0 ls0 ws0">s</div></div><div class="t m5 x114 h3f y67e3 ff9e fs27 fc1 sc0 ls0 ws0">(4) Signal handler </div><div class="t m5 x1b4 h3f y67e4 ff9e fs27 fc1 sc0 ls0 ws0">returns to </div><div class="t m5 x250 h3f y67e5 ff9e fs27 fc1 sc0 ls0 ws0">next instruction</div><div class="t m5 xe0 h3f y67e6 ff9e fs27 fc1 sc0 ls0 ws0">(1) Signal received</div><div class="t m5 x21d h3f y67e7 ff9e fs27 fc1 sc0 ls0 ws0">by process</div><div class="t m5 xe4 h3f y67e8 ff9e fs27 fc1 sc0 ls0 ws0">I</div><div class="t m5 x186 h65 y67e9 ff9c fs38 fc1 sc0 ls0 ws0">curr</div><div class="t m5 xe4 h3f y67ea ff9e fs27 fc1 sc0 ls0 ws0">I</div><div class="t m5 x186 h65 y67eb ff9c fs38 fc1 sc0 ls0 ws0">next</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
