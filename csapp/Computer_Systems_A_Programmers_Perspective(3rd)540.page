<div id="pf21c" class="pf w2 h11" data-page-no="21c"><div class="pc pc21c w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg21c.png"/><div class="t m5 x114 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>5.2<span class="_ _60"> </span>Expressing<span class="_ _10"> </span>Program<span class="_ _10"> </span>Performance<span class="_ _3e"> </span><span class="ffe fs1e">539</span></div><div class="t m5 x2c h2d y4a2c ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">/*<span class="_ _1f"> </span>Compute<span class="_ _e"> </span>prefix<span class="_ _1f"> </span>sum<span class="_ _1f"> </span>of<span class="_ _e"> </span>vector<span class="_ _1f"> </span>a<span class="_ _e"> </span>*/</span></div><div class="t m5 x2c h2d y4a2d ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _1c"> </span><span class="ffd fs1e fc2">void<span class="_ _1f"> </span>psum1(float<span class="_ _e"> </span>a[],<span class="_ _1f"> </span>float<span class="_ _1f"> </span>p[],<span class="_ _e"> </span>long<span class="_ _1f"> </span>n)</span></div><div class="t m5 x2c h2d y4a2e ff6 fs20 fc6 sc0 ls0 ws0">3<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x2c h2e y4a2f ff6 fs20 fc6 sc0 ls0 ws0">4</div><div class="t m5 x142 h2d y4a30 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>i;</div><div class="t m5 x2c h2d y4a31 ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _20"> </span><span class="ffd fs1e fc2">p[0]<span class="_ _e"> </span>=<span class="_ _1f"> </span>a[0];</span></div><div class="t m5 x2c h2d y4a32 ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _20"> </span><span class="ffd fs1e fc2 ls33">f<span class="_ _41"></span>o<span class="_ _41"></span>r(<span class="_ _41"></span>i=1<span class="_ _41"></span>;i&lt;n<span class="_ _41"></span>;<span class="ls0">i++)</span></span></div><div class="t m5 x2c h2d y4a33 ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _70"> </span><span class="ffd fs1e fc2">p[i]<span class="_ _e"> </span>=<span class="_ _1f"> </span>p[i-1]<span class="_ _1f"> </span>+<span class="_ _e"> </span>a[i];</span></div><div class="t m5 x2c h2d y4a34 ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x2c h2e y4a35 ff6 fs20 fc6 sc0 ls0 ws0">9</div><div class="t m5 x17 h2e y4a36 ff6 fs20 fc6 sc0 ls0 ws0">10</div><div class="t m5 x2d h2d y4a37 ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>psum2(float<span class="_ _1f"> </span>a[],<span class="_ _1f"> </span>float<span class="_ _e"> </span>p[],<span class="_ _1f"> </span>long<span class="_ _e"> </span>n)</div><div class="t m5 x17 h2d y4a38 ff6 fs20 fc6 sc0 ls0 ws0">11<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x17 h2d y4a39 ff6 fs20 fc6 sc0 ls0 ws0">12<span class="_ _20"> </span><span class="ffd fs1e fc2">long<span class="_ _e"> </span>i;</span></div><div class="t m5 x17 h2d y4a3a ff6 fs20 fc6 sc0 ls0 ws0">13<span class="_ _20"> </span><span class="ffd fs1e fc2">p[0]<span class="_ _e"> </span>=<span class="_ _1f"> </span>a[0];</span></div><div class="t m5 x17 h2d y4a3b ff6 fs20 fc6 sc0 ls0 ws0">14<span class="_ _20"> </span><span class="ffd fs1e fc2">for<span class="_ _e"> </span>(i<span class="_ _1f"> </span>=<span class="_ _1f"> </span>1;<span class="_ _e"> </span>i<span class="_ _1f"> </span>&lt;<span class="_ _e"> </span>n-1;<span class="_ _1f"> </span>i+=2)<span class="_ _1f"> </span>{</span></div><div class="t m5 x17 h2d y4a3c ff6 fs20 fc6 sc0 ls0 ws0">15<span class="_ _70"> </span><span class="ffd fs1e fc2">float<span class="_ _e"> </span>mid_val<span class="_ _1f"> </span>=<span class="_ _1f"> </span>p[i-1]<span class="_ _e"> </span>+<span class="_ _1f"> </span>a[i];</span></div><div class="t m5 x17 h2d y4a3d ff6 fs20 fc6 sc0 ls0 ws0">16<span class="_ _70"> </span><span class="ffd fs1e fc2">p[i]<span class="_ _46"> </span>=<span class="_ _e"> </span>mid_val;</span></div><div class="t m5 x17 h2d y4a3e ff6 fs20 fc6 sc0 ls0 ws0">17<span class="_ _70"> </span><span class="ffd fs1e fc2">p[i+1]<span class="_ _1a"> </span>=<span class="_ _e"> </span>mid_val<span class="_ _1f"> </span>+<span class="_ _1f"> </span>a[i+1];</span></div><div class="t m5 x17 h2d y4a3f ff6 fs20 fc6 sc0 ls0 ws0">18<span class="_ _20"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x17 h2d y4a40 ff6 fs20 fc6 sc0 ls0 ws0">19<span class="_ _20"> </span><span class="ffd fs1e fc2">/*<span class="_ _e"> </span>For<span class="_ _1f"> </span>even<span class="_ _1f"> </span>n,<span class="_ _e"> </span>finish<span class="_ _1f"> </span>remaining<span class="_ _e"> </span>element<span class="_ _1f"> </span>*/</span></div><div class="t m5 x17 h2d y4a41 ff6 fs20 fc6 sc0 ls0 ws0">20<span class="_ _20"> </span><span class="ffd fs1e fc2">if<span class="_ _e"> </span>(i<span class="_ _1f"> </span>&lt;<span class="_ _1f"> </span>n)</span></div><div class="t m5 x17 h2d y4a42 ff6 fs20 fc6 sc0 ls0 ws0">21<span class="_ _70"> </span><span class="ffd fs1e fc2">p[i]<span class="_ _e"> </span>=<span class="_ _1f"> </span>p[i-1]<span class="_ _1f"> </span>+<span class="_ _e"> </span>a[i];</span></div><div class="t m5 x17 h2d y4a43 ff6 fs20 fc6 sc0 ls0 ws0">22<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x17 h34 y4a44 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _13"> </span>5.1<span class="_ _66"> </span><span class="fc1">Preﬁx-sum<span class="_ _13"> </span>functions.<span class="_ _6"> </span><span class="ff6">These<span class="_ _13"> </span>functions<span class="_ _6"> </span>provide<span class="_ _13"> </span>examples<span class="_ _13"> </span>for<span class="_ _6"> </span>how<span class="_ _13"> </span>we<span class="_ _6"> </span>express</span></span></div><div class="t m5 x17 h34 y4a45 ff6 fs16 fc1 sc0 ls0 ws0">program<span class="_ _10"> </span>performance.</div><div class="t m5 x1f5 h84 y4a46 ff53 fs49 fc1 sc0 ls206 ws0">2500</div><div class="t m5 x1f5 h84 y4a47 ff53 fs49 fc1 sc0 ls206 ws0">2000</div><div class="t m5 x1f5 h84 y4a48 ff53 fs49 fc1 sc0 ls206 ws0">1500</div><div class="t m5 x1f5 h84 y4a49 ff53 fs49 fc1 sc0 ls206 ws0">1000</div><div class="t m5 x37 h84 y4a4a ff53 fs49 fc1 sc0 ls206 ws0">500</div><div class="t m5 x23e h84 y4a4b ff53 fs49 fc1 sc0 ls0 ws0">0</div><div class="t m5 x77 h84 y4a4c ff53 fs49 fc1 sc0 ls207 ws0">06<span class="_ _1bf"></span>0<span class="_ _1d9"></span><span class="ls206">20<span class="_ _79"> </span>40</span></div><div class="t m5 x113 h85 y4a4d ff54 fs4a fc1 sc0 ls208 ws0">psum1</div><div class="t m5 x1c8 h84 y4a4e ff53 fs49 fc1 sc0 ls206 ws0">Slope = 9.0</div><div class="t m5 x49 h85 y4a4f ff54 fs4a fc1 sc0 ls208 ws0">psum2</div><div class="t m5 xec h84 y4a50 ff53 fs49 fc1 sc0 ls206 ws0">Slope = 6.0</div><div class="t m5 x1ed h84 y4a51 ff53 fs49 fc1 sc0 ls206 ws0">100<span class="_ _125"></span>80<span class="_ _1c2"> </span>140<span class="_ _3f"> </span>160<span class="_ _3f"> </span>180<span class="_ _1da"></span>120<span class="_ _d8"> </span>200</div><div class="t m5 x116 h84 y4a52 ff21 fs49 fc1 sc0 ls0 ws0">Elements</div><div class="t m7 xef h84 y4a53 ff21 fs49 fc1 sc0 ls209 ws0">Cycles</div><div class="t m5 x17 h34 y4a54 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>5.2<span class="_ _c"> </span><span class="fc1">Performance<span class="_"> </span>of<span class="_ _11"> </span>preﬁx-sum<span class="_"> </span>functions.<span class="_"> </span><span class="ff6">The<span class="_ _11"> </span>slope<span class="_ _11"> </span>of<span class="_ _10"> </span>the<span class="_ _11"> </span>lines<span class="_ _10"> </span>indicates<span class="_ _11"> </span>the</span></span></div><div class="t m5 x17 h34 y4a55 ff6 fs16 fc1 sc0 ls0 ws0">number<span class="_ _10"> </span>of<span class="_ _11"> </span>clock<span class="_ _10"> </span>cycles<span class="_ _10"> </span>per<span class="_ _11"> </span>element<span class="_ _10"> </span>(CPE).</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
