<div id="pf201" class="pf w2 h11" data-page-no="201"><div class="pc pc201 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg201.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">512<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>4<span class="_ _3d"> </span>Processor<span class="_ _10"> </span>Architecture</span></div><div class="t m5 x1d h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">instruction.<span class="_ _13"> </span>Implement<span class="_ _13"> </span>test<span class="_ _6"> </span>code<span class="_ _13"> </span>similar<span class="_ _13"> </span>to<span class="_ _13"> </span>what<span class="_ _13"> </span>is<span class="_ _13"> </span>shown<span class="_ _6"> </span>in<span class="_ _13"> </span>C<span class="_ _13"> </span>to<span class="_ _13"> </span>demonstrate<span class="_ _13"> </span>that</div><div class="t m5 x1d h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">your<span class="_"> </span>implementation<span class="_ _11"> </span>of<span class="_"> </span><span class="ffd">switchv<span class="_ _11"> </span></span>will<span class="_"> </span>handle<span class="_ _11"> </span>both<span class="_"> </span>the<span class="_ _11"> </span>cases<span class="_"> </span>handled<span class="_ _11"> </span>explicitly<span class="_"> </span>as</div><div class="t m5 x1d h26 y2a8 ff7 fs19 fc2 sc0 ls0 ws0">well<span class="_"> </span>as<span class="_"> </span>those<span class="_"> </span>that<span class="_"> </span>trigger<span class="_"> </span>the<span class="_"> </span><span class="ffd">default<span class="_ _10"> </span></span>case<span class="_ _0"></span>.</div><div class="t m5 x1d h73 y46ec ffe fs1e fc6 sc0 ls0 ws0">4.51<span class="_ _23"> </span><span class="ff10 fs19">◆</span></div><div class="t m5 x1d h26 y46ed ff7 fs19 fc1 sc0 ls0 ws0">Practice<span class="_ _13"> </span>Problem<span class="_ _13"> </span>4.3<span class="_"> </span>introduced<span class="_ _13"> </span>the<span class="_ _13"> </span><span class="ffd">iaddq<span class="_ _13"> </span></span>instruction<span class="_"> </span>to<span class="_ _13"> </span>add<span class="_ _13"> </span>immediate<span class="_ _13"> </span>data<span class="_ _13"> </span>to<span class="_"> </span>a</div><div class="t m5 x1d h26 y46ee ff7 fs19 fc1 sc0 ls0 ws0">register.<span class="_ _13"> </span>Describe<span class="_ _6"> </span>the<span class="_ _13"> </span>computations<span class="_ _13"> </span>performed<span class="_ _13"> </span>to<span class="_ _13"> </span>implement<span class="_ _13"> </span>this<span class="_ _13"> </span>instruction.<span class="_ _13"> </span>Use</div><div class="t m5 x1d h26 y46ef ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>computations<span class="_"> </span>for<span class="_"> </span><span class="ffd">irmovq<span class="_ _10"> </span></span>and<span class="_"> </span><span class="ffd">OPq<span class="_ _10"> </span></span>(F<span class="_ _0"></span>igure<span class="_"> </span>4.18)<span class="_"> </span>as<span class="_"> </span>a<span class="_"> </span>guide<span class="_ _1"></span>.</div><div class="t m5 x1d h73 y46f0 ffe fs1e fc6 sc0 ls0 ws0">4.52<span class="_ _23"> </span><span class="ff10 fs19">◆◆</span></div><div class="t m5 x1d h26 y46f1 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _15"> </span>ﬁle<span class="_ _15"> </span><span class="ffd">seq-full.hcl<span class="_ _15"> </span></span>contains<span class="_ _15"> </span>the<span class="_ _15"> </span>HCL<span class="_ _15"> </span>description<span class="_ _15"> </span>for<span class="_ _15"> </span>SEQ,<span class="_ _21"> </span>along<span class="_ _15"> </span>with<span class="_ _14"> </span>the</div><div class="t m5 x1d h26 y46f2 ff7 fs19 fc1 sc0 ls0 ws0">declaration<span class="_ _13"> </span>of<span class="_ _13"> </span>a<span class="_ _13"> </span>constant<span class="_ _13"> </span><span class="ffd">IIADDQ<span class="_ _6"> </span></span>having<span class="_ _13"> </span>hexadecimal<span class="_ _13"> </span>value<span class="_ _13"> </span><span class="ffd">C</span>,<span class="_ _13"> </span>the<span class="_ _13"> </span>instruction<span class="_ _13"> </span>code</div><div class="t m5 x1d h26 y46f3 ff7 fs19 fc1 sc0 ls0 ws0">for<span class="_"> </span><span class="ffd">iaddq</span>.<span class="_"> </span>Modify<span class="_ _13"> </span>the<span class="_"> </span>HCL<span class="_"> </span>descriptions<span class="_"> </span>of<span class="_ _13"> </span>the<span class="_"> </span>control<span class="_"> </span>logic<span class="_"> </span>blocks<span class="_"> </span>to<span class="_ _13"> </span>implement</div><div class="t m5 x1d h26 y46f4 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _13"> </span><span class="ffd">iaddq<span class="_ _10"> </span></span>instruction,<span class="_ _13"> </span>as<span class="_"> </span>described<span class="_ _13"> </span>in<span class="_ _13"> </span>Practice<span class="_"> </span>Problem<span class="_ _13"> </span>4.3<span class="_ _13"> </span>and<span class="_"> </span>Problem<span class="_ _13"> </span>4.51.<span class="_ _13"> </span>See</div><div class="t m5 x1d h26 y46f5 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _11"> </span>lab<span class="_ _16"> </span>material<span class="_ _16"> </span>for<span class="_ _11"> </span>directions<span class="_ _16"> </span>on<span class="_ _16"> </span>how<span class="_ _11"> </span>to<span class="_ _16"> </span>generate<span class="_ _11"> </span>a<span class="_ _16"> </span>simulator<span class="_ _16"> </span>for<span class="_ _11"> </span>your<span class="_ _16"> </span>solution</div><div class="t m5 x1d h26 y46f6 ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_"> </span>how<span class="_"> </span>to<span class="_"> </span>test<span class="_"> </span>it.</div><div class="t m5 x1d h73 y46f7 ffe fs1e fc6 sc0 ls0 ws0">4.53<span class="_ _23"> </span><span class="ff10 fs19">◆◆◆</span></div><div class="t m5 x1d h26 y46f8 ff7 fs19 fc1 sc0 ls0 ws0">Suppose<span class="_ _13"> </span>we<span class="_"> </span>wanted<span class="_ _13"> </span>to<span class="_ _13"> </span>create<span class="_ _13"> </span>a<span class="_"> </span>lower<span class="_ _3"></span>-cost<span class="_"> </span>pipelined<span class="_ _13"> </span>processor<span class="_ _13"> </span>based<span class="_ _13"> </span>on<span class="_"> </span>the<span class="_ _13"> </span>struc-</div><div class="t m5 x1d h46 y46f9 ff7 fs19 fc1 sc0 ls0 ws0">ture<span class="_ _6"> </span>we<span class="_ _6"> </span>devised<span class="_ _6"> </span>for<span class="_ _13"> </span>PIPE<span class="ff12">−<span class="_ _a"></span></span>(Figure<span class="_ _a"> </span>4.41),<span class="_ _13"> </span>without<span class="_ _a"> </span>any<span class="_ _13"> </span>bypassing<span class="_ _1"></span>.<span class="_ _13"> </span>T<span class="_ _3"></span>his<span class="_ _13"> </span>design<span class="_ _a"> </span>would</div><div class="t m5 x1d h26 y46fa ff7 fs19 fc1 sc0 ls0 ws0">handle<span class="_"> </span>all<span class="_ _13"> </span>data<span class="_"> </span>dependencies<span class="_ _13"> </span>by<span class="_"> </span>stalling<span class="_ _13"> </span>until<span class="_"> </span>the<span class="_ _13"> </span>instruction<span class="_"> </span>generating<span class="_"> </span>a<span class="_ _13"> </span>needed</div><div class="t m5 x1d h26 y46fb ff7 fs19 fc1 sc0 ls0 ws0">value<span class="_"> </span>has<span class="_"> </span>passed<span class="_"> </span>through<span class="_"> </span>the<span class="_"> </span>write-back<span class="_"> </span>stage<span class="_ _1"></span>.</div><div class="t m5 x29 h26 y46fc ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _14"> </span>ﬁle<span class="_ _14"> </span><span class="ffd">pipe-stall.hcl<span class="_ _16"> </span></span>contains<span class="_ _14"> </span>a<span class="_ _14"> </span>modiﬁed<span class="_ _16"> </span>version<span class="_ _14"> </span>of<span class="_ _14"> </span>the<span class="_ _16"> </span>HCL<span class="_ _14"> </span>code<span class="_ _14"> </span>for</div><div class="t m5 x1d h26 y46fd ff7 fs19 fc1 sc0 ls0 ws0">PIPE<span class="_ _16"> </span>in<span class="_ _11"> </span>which<span class="_ _16"> </span>the<span class="_ _16"> </span>bypassing<span class="_ _16"> </span>logic<span class="_ _11"> </span>has<span class="_ _16"> </span>been<span class="_ _16"> </span>disabled.<span class="_ _16"> </span>T<span class="_ _1"></span>hat<span class="_ _16"> </span>is<span class="_ _1"></span>,<span class="_ _16"> </span>the<span class="_ _16"> </span>signals<span class="_ _16"> </span><span class="ff6">e_valA</span></div><div class="t m5 x1d h26 y46fe ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_"> </span><span class="ff6">e_valB<span class="_ _10"> </span></span>are<span class="_"> </span>simply<span class="_"> </span>declared<span class="_"> </span>as<span class="_"> </span>follows:</div><div class="t m5 x1d h2d y46ff ffd fs1e fc2 sc0 ls0 ws0">##<span class="_ _1a"> </span>DO<span class="_ _e"> </span>NOT<span class="_ _1f"> </span>MODIFY<span class="_ _1f"> </span>THE<span class="_ _e"> </span>FOLLOWING<span class="_ _1f"> </span>CODE.</div><div class="t m5 x1d h2d y4700 ffd fs1e fc2 sc0 ls0 ws0">##<span class="_ _e"> </span>No<span class="_ _1f"> </span>forwarding.<span class="_ _1a"> </span>valA<span class="_ _1f"> </span>is<span class="_ _e"> </span>either<span class="_ _1f"> </span>valP<span class="_ _e"> </span>or<span class="_ _1f"> </span>value<span class="_ _1f"> </span>from<span class="_ _e"> </span>register<span class="_ _1f"> </span>file</div><div class="t m5 x1d h2d y4701 ffd fs1e fc2 sc0 ls0 ws0">word<span class="_ _e"> </span>d_valA<span class="_ _1f"> </span>=<span class="_ _1f"> </span>[</div><div class="t m5 x22b h2d y4702 ffd fs1e fc2 sc0 ls0 ws0">D_icode<span class="_ _e"> </span>in<span class="_ _1f"> </span>{<span class="_ _1f"> </span>ICALL,<span class="_ _e"> </span>IJXX<span class="_ _1f"> </span>}<span class="_ _e"> </span>:<span class="_ _1f"> </span>D_valP;<span class="_ _1f"> </span>#<span class="_ _e"> </span>Use<span class="_ _1f"> </span>incremented<span class="_ _e"> </span>PC</div><div class="t m5 x22b h2d y4703 ffd fs1e fc2 sc0 ls0 ws0">1<span class="_ _e"> </span>:<span class="_ _1f"> </span>d_rvalA;<span class="_ _1a"> </span>#<span class="_ _1f"> </span>Use<span class="_ _e"> </span>value<span class="_ _1f"> </span>read<span class="_ _e"> </span>from<span class="_ _1f"> </span>register<span class="_ _1f"> </span>file</div><div class="t m5 x1d h2d y4704 ffd fs1e fc2 sc0 ls0 ws0">];</div><div class="t m5 x1d h2d y4705 ffd fs1e fc2 sc0 ls0 ws0">##<span class="_ _e"> </span>No<span class="_ _1f"> </span>forwarding.<span class="_ _1a"> </span>valB<span class="_ _1f"> </span>is<span class="_ _e"> </span>value<span class="_ _1f"> </span>from<span class="_ _e"> </span>register<span class="_ _1f"> </span>file</div><div class="t m5 x1d h2d y4706 ffd fs1e fc2 sc0 ls0 ws0">word<span class="_ _e"> </span>d_valB<span class="_ _1f"> </span>=<span class="_ _1f"> </span>d_rvalB;</div><div class="t m5 x29 h26 y4707 ff7 fs19 fc2 sc0 ls0 ws0">Modify<span class="_ _13"> </span>the<span class="_ _13"> </span>pipeline<span class="_ _13"> </span>control<span class="_"> </span>logic<span class="_ _13"> </span>at<span class="_ _13"> </span>the<span class="_ _13"> </span>end<span class="_ _13"> </span>of<span class="_ _13"> </span>this<span class="_ _13"> </span>ﬁle<span class="_"> </span>so<span class="_ _13"> </span>that<span class="_ _13"> </span>it<span class="_ _13"> </span>correctly<span class="_ _13"> </span>han-</div><div class="t m5 x1d h26 y4708 ff7 fs19 fc2 sc0 ls0 ws0">dles<span class="_ _13"> </span>all<span class="_ _6"> </span>possible<span class="_ _13"> </span>control<span class="_ _6"> </span>and<span class="_ _13"> </span>data<span class="_ _6"> </span>hazards<span class="_ _1"></span>.<span class="_ _13"> </span>As<span class="_ _6"> </span>part<span class="_ _13"> </span>of<span class="_ _13"> </span>your<span class="_ _6"> </span>design<span class="_ _13"> </span>effort,<span class="_ _13"> </span>you<span class="_ _6"> </span>should</div><div class="t m5 x1d h26 y4709 ff7 fs19 fc2 sc0 ls0 ws0">analyze<span class="_"> </span>the<span class="_ _13"> </span>different<span class="_"> </span>combinations<span class="_"> </span>of<span class="_"> </span>control<span class="_ _13"> </span>cases<span class="_ _1"></span>,<span class="_"> </span>as<span class="_"> </span>we<span class="_"> </span>did<span class="_"> </span>in<span class="_ _13"> </span>the<span class="_"> </span>design<span class="_"> </span>of<span class="_ _13"> </span>the</div><div class="t m5 x1d h26 y470a ff7 fs19 fc2 sc0 ls0 ws0">pipeline<span class="_ _16"> </span>control<span class="_ _16"> </span>logic<span class="_ _16"> </span>for<span class="_ _16"> </span>PIPE.<span class="_ _16"> </span>Y<span class="_ _3"></span>ou<span class="_ _16"> </span>will<span class="_ _14"> </span>ﬁnd<span class="_ _16"> </span>that<span class="_ _16"> </span>many<span class="_ _16"> </span>different<span class="_ _16"> </span>combinations</div><div class="t m5 x1d h26 y470b ff7 fs19 fc2 sc0 ls0 ws0">can<span class="_ _16"> </span>occur,<span class="_ _14"> </span>since<span class="_ _14"> </span>many<span class="_ _16"> </span>more<span class="_ _14"> </span>conditions<span class="_ _14"> </span>require<span class="_ _16"> </span>the<span class="_ _14"> </span>pipeline<span class="_ _16"> </span>to<span class="_ _14"> </span>stall.<span class="_ _14"> </span>Make<span class="_ _16"> </span>sure</div><div class="t m5 x1d h26 y470c ff7 fs19 fc2 sc0 ls0 ws0">your<span class="_ _16"> </span>control<span class="_ _14"> </span>logic<span class="_ _14"> </span>handles<span class="_ _16"> </span>each<span class="_ _14"> </span>combination<span class="_ _14"> </span>correctly<span class="_ _3"></span>.<span class="_ _16"> </span>See<span class="_ _14"> </span>the<span class="_ _14"> </span>lab<span class="_ _14"> </span>material<span class="_ _16"> </span>for</div><div class="t m5 x1d h26 y470d ff7 fs19 fc2 sc0 ls0 ws0">directions<span class="_"> </span>on<span class="_"> </span>how<span class="_"> </span>to<span class="_"> </span>generate<span class="_"> </span>a<span class="_"> </span>simulator<span class="_"> </span>for<span class="_"> </span>your<span class="_"> </span>solution<span class="_"> </span>and<span class="_"> </span>how<span class="_"> </span>to<span class="_"> </span>test<span class="_"> </span>it.</div><div class="t m5 x1d h73 y8d6 ffe fs1e fc6 sc0 ls0 ws0">4.54<span class="_ _23"> </span><span class="ff10 fs19">◆◆</span></div><div class="t m5 x1d h26 y8d7 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _13"> </span>ﬁle<span class="_ _a"> </span><span class="ffd">pipe-full.hcl<span class="_ _6"> </span></span>contains<span class="_ _13"> </span>a<span class="_ _a"> </span>copy<span class="_ _13"> </span>of<span class="_ _a"> </span>the<span class="_ _13"> </span>PIPE<span class="_ _a"> </span>HCL<span class="_ _6"> </span>description,<span class="_ _13"> </span>along<span class="_ _6"> </span>with<span class="_ _6"> </span>a</div><div class="t m5 x1d h26 y8d8 ff7 fs19 fc1 sc0 ls0 ws0">declaration<span class="_ _13"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>constant<span class="_ _13"> </span>value<span class="_"> </span><span class="ffd">IIADDQ</span>.<span class="_ _13"> </span>Modify<span class="_ _13"> </span>this<span class="_"> </span>ﬁle<span class="_ _13"> </span>to<span class="_ _13"> </span>implement<span class="_"> </span>the<span class="_ _13"> </span><span class="ffd">iaddq</span></div><div class="t m5 x1d h26 y99 ff7 fs19 fc1 sc0 ls0 ws0">instruction,<span class="_ _14"> </span>as<span class="_ _16"> </span>described<span class="_ _16"> </span>in<span class="_ _16"> </span>Practice<span class="_ _14"> </span>Problem<span class="_ _16"> </span>4.3<span class="_ _16"> </span>and<span class="_ _14"> </span>Problem<span class="_ _16"> </span>4.51.<span class="_ _16"> </span>See<span class="_ _14"> </span>the<span class="_ _16"> </span>lab</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
