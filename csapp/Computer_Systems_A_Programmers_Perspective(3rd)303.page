<div id="pf12f" class="pf w2 h11" data-page-no="12f"><div class="pc pc12f w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg12f.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">302<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>3<span class="_ _3d"> </span>Machine-Level<span class="_ _10"> </span>Representation<span class="_ _10"> </span>of<span class="_ _10"> </span>Programs</span></div><div class="t m5 x28 h2a y257 fff fs1c fc2 sc0 ls0 ws0">New<span class="_ _16"> </span>to<span class="_ _16"> </span>C?<span class="_ _1b"> </span><span class="ff6 fs19">Representing<span class="_ _11"> </span>an<span class="_ _11"> </span>object<span class="_ _16"> </span>as<span class="_ _11"> </span>a<span class="_ _11"> </span><span class="ffd fs2b">struct</span></span></div><div class="t m5 x28 h2b y258 ff7 fs1e fc2 sc0 ls31 ws0">Th<span class="_ _2"></span>e<span class="_"> </span><span class="ffd ls0">struct<span class="_ _6"> </span><span class="ff7">data<span class="_ _13"> </span>type<span class="_ _a"> </span>constructor<span class="_ _13"> </span>is<span class="_ _6"> </span>the<span class="_ _6"> </span>closest<span class="_ _13"> </span>thing<span class="_ _6"> </span>C<span class="_ _6"> </span>provides<span class="_ _13"> </span>to<span class="_ _a"> </span>the<span class="_ _13"> </span>objects<span class="_ _6"> </span>of<span class="_ _6"> </span>C++<span class="_ _13"> </span>and<span class="_ _a"> </span>J<span class="_ _1"></span>ava.<span class="_ _13"> </span>It<span class="_ _a"> </span>allows</span></span></div><div class="t m5 x28 h2b y259 ff7 fs1e fc2 sc0 ls0 ws0">the<span class="_ _13"> </span>programmer<span class="_"> </span>to<span class="_ _13"> </span>keep<span class="_ _13"> </span>information<span class="_"> </span>about<span class="_ _13"> </span>some<span class="_ _13"> </span>entity<span class="_ _13"> </span>in<span class="_"> </span>a<span class="_ _13"> </span>single<span class="_ _13"> </span>data<span class="_"> </span>structure<span class="_ _13"> </span>and<span class="_ _13"> </span>to<span class="_"> </span>reference<span class="_ _13"> </span>that</div><div class="t m5 x28 h2b y25a ff7 fs1e fc2 sc0 ls0 ws0">information<span class="_"> </span>with<span class="_"> </span>names<span class="_ _1"></span>.</div><div class="t m5 x57 h2b y4e2 ff7 fs1e fc2 sc0 ls0 ws0">F<span class="_ _1"></span>or<span class="_"> </span>example<span class="_ _0"></span>,<span class="_"> </span>a<span class="_"> </span>graphics<span class="_"> </span>program<span class="_"> </span>might<span class="_"> </span>represent<span class="_"> </span>a<span class="_"> </span>rectangle<span class="_"> </span>as<span class="_"> </span>a<span class="_"> </span>structure:</div><div class="t m5 x28 h2d y2ba8 ffd fs1e fc2 sc0 ls0 ws0">struct<span class="_ _e"> </span>rect<span class="_ _1f"> </span>{</div><div class="t m5 x243 h2d y2ba9 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>llx;<span class="_ _87"> </span>/*<span class="_ _e"> </span>X<span class="_ _1f"> </span>coordinate<span class="_ _1f"> </span>of<span class="_ _e"> </span>lower-left<span class="_ _1f"> </span>corner<span class="_ _e"> </span>*/</div><div class="t m5 x243 h2d y2baa ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>lly;<span class="_ _87"> </span>/*<span class="_ _e"> </span>Y<span class="_ _1f"> </span>coordinate<span class="_ _1f"> </span>of<span class="_ _e"> </span>lower-left<span class="_ _1f"> </span>corner<span class="_ _e"> </span>*/</div><div class="t m5 x243 h2d y2bab ffd fs1e fc2 sc0 ls0 ws0">unsigned<span class="_ _e"> </span>long<span class="_ _1f"> </span>width;<span class="_ _1a"> </span>/*<span class="_ _1f"> </span>Width<span class="_ _e"> </span>(in<span class="_ _1f"> </span>pixels)<span class="_ _15a"> </span>*/</div><div class="t m5 x243 h2d y2bac ffd fs1e fc2 sc0 ls0 ws0">unsigned<span class="_ _e"> </span>long<span class="_ _1f"> </span>height;<span class="_ _1f"> </span>/*<span class="_ _e"> </span>Height<span class="_ _1f"> </span>(in<span class="_ _e"> </span>pixels)<span class="_ _12a"> </span>*/</div><div class="t m5 x243 h2d y2bad ffd fs1e fc2 sc0 ls0 ws0">unsigned<span class="_ _e"> </span>color;<span class="_ _2b"> </span>/*<span class="_ _e"> </span>Coding<span class="_ _1f"> </span>of<span class="_ _1f"> </span>color<span class="_ _159"> </span>*/</div><div class="t m5 x28 h2d y2bae ffd fs1e fc2 sc0 ls0 ws0">};</div><div class="t m5 x57 h2b y2baf ff7 fs1e fc2 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_"> </span>can<span class="_"> </span>declare<span class="_"> </span>a<span class="_"> </span>variable<span class="_"> </span><span class="ffd">r<span class="_ _10"> </span></span>of<span class="_"> </span>type<span class="_"> </span><span class="ffd">struct<span class="_ _11"> </span>rect<span class="_ _10"> </span></span>and<span class="_"> </span>set<span class="_"> </span>its<span class="_"> </span>ﬁeld<span class="_"> </span>values<span class="_"> </span>as<span class="_"> </span>follows:</div><div class="t m5 x243 h2d y2bb0 ffd fs1e fc2 sc0 ls0 ws0">struct<span class="_ _e"> </span>rect<span class="_ _1f"> </span>r;</div><div class="t m5 x243 h2d y2bb1 ffd fs1e fc2 sc0 ls0 ws0">r.llx<span class="_ _e"> </span>=<span class="_ _1f"> </span>r.lly<span class="_ _1f"> </span>=<span class="_ _e"> </span>0;</div><div class="t m5 x243 h2d y2bb2 ffd fs1e fc2 sc0 ls0 ws0">r.color<span class="_ _e"> </span>=<span class="_ _1f"> </span>0xFF00FF;</div><div class="t m5 x243 h2d y2bb3 ffd fs1e fc2 sc0 ls0 ws0">r.width<span class="_ _e"> </span>=<span class="_ _1f"> </span>10;</div><div class="t m5 x243 h2d y2bb4 ffd fs1e fc2 sc0 ls0 ws0">r.height<span class="_ _e"> </span>=<span class="_ _1f"> </span>20;</div><div class="t m5 x28 h2b y2bb5 ff7 fs1e fc2 sc0 ls0 ws0">where<span class="_"> </span>the<span class="_"> </span>expression<span class="_"> </span><span class="ffd">r.llx<span class="_ _10"> </span></span>selects<span class="_"> </span>ﬁeld<span class="_"> </span><span class="ffd">llx<span class="_ _10"> </span></span>of<span class="_"> </span>structure<span class="_"> </span><span class="ffd">r</span>.</div><div class="t m5 x57 h2b y2bb6 ff7 fs1e fc2 sc0 ls0 ws0">Alternatively<span class="_ _3"></span>,<span class="_"> </span>we<span class="_"> </span>can<span class="_"> </span>both<span class="_"> </span>declare<span class="_"> </span>the<span class="_"> </span>variable<span class="_"> </span>and<span class="_"> </span>initialize<span class="_"> </span>its<span class="_"> </span>ﬁelds<span class="_"> </span>with<span class="_"> </span>a<span class="_"> </span>single<span class="_"> </span>statement:</div><div class="t m5 x243 h2d y2bb7 ffd fs1e fc2 sc0 ls0 ws0">struct<span class="_ _e"> </span>rec<span class="ls33">tr={0<span class="_ _41"></span>,0<span class="_ _41"></span>,<span class="ls0">0xFF00FF,<span class="_ _1f"> </span>10,<span class="_ _1f"> </span>20<span class="_ _e"> </span>};</span></span></div><div class="t m5 x57 h2b y2bb8 ff7 fs1e fc2 sc0 ls0 ws0">It<span class="_ _10"> </span>is<span class="_ _11"> </span>common<span class="_ _11"> </span>to<span class="_ _11"> </span>pass<span class="_ _10"> </span>pointers<span class="_ _11"> </span>to<span class="_ _11"> </span>structures<span class="_ _11"> </span>from<span class="_ _11"> </span>one<span class="_ _10"> </span>place<span class="_ _11"> </span>to<span class="_ _11"> </span>another<span class="_ _11"> </span>rather<span class="_ _10"> </span>than<span class="_ _11"> </span>copying<span class="_ _11"> </span>them.</div><div class="t m5 x28 h2b y2bb9 ff7 fs1e fc2 sc0 ls0 ws0">F<span class="_ _1"></span>or<span class="_"> </span>example<span class="_ _1"></span>,<span class="_"> </span>the<span class="_"> </span>following<span class="_ _13"> </span>function<span class="_"> </span>computes<span class="_ _13"> </span>the<span class="_ _13"> </span>area<span class="_"> </span>of<span class="_ _13"> </span>a<span class="_"> </span>rectangle<span class="_ _1"></span>,<span class="_"> </span>where<span class="_"> </span>a<span class="_ _13"> </span>pointer<span class="_"> </span>to<span class="_ _13"> </span>the<span class="_"> </span>rectangle</div><div class="t m5 x28 h2b y2bba ffd fs1e fc2 sc0 ls0 ws0">struct<span class="_ _10"> </span><span class="ff7">is<span class="_"> </span>passed<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>function:</span></div><div class="t m5 x28 h2d y2bbb ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>area(struct<span class="_ _1f"> </span>rect<span class="_ _1f"> </span>*rp)<span class="_ _e"> </span>{</div><div class="t m5 x243 h2d y2bbc ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>(*rp).width<span class="_ _1f"> </span>*<span class="_ _1f"> </span>(*rp).height;</div><div class="t m5 x28 h2d y2bbd ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x57 h2b y2bbe ff7 fs1e fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>expression<span class="_ _10"> </span><span class="ffd">(*rp).width<span class="_ _10"> </span></span>dereferences<span class="_"> </span>the<span class="_"> </span>pointer<span class="_ _10"> </span>and<span class="_"> </span>selects<span class="_ _10"> </span>the<span class="_ _10"> </span><span class="ffd">width<span class="_ _10"> </span></span>ﬁeld<span class="_"> </span>of<span class="_"> </span>the<span class="_ _10"> </span>resulting</div><div class="t m5 x28 h2b y2bbf ff7 fs1e fc2 sc0 ls0 ws0">structure<span class="_ _1"></span>.<span class="_ _13"> </span>Parentheses<span class="_ _13"> </span>are<span class="_ _6"> </span>required,<span class="_"> </span>because<span class="_ _6"> </span>the<span class="_ _13"> </span>compiler<span class="_ _6"> </span>would<span class="_ _13"> </span>interpret<span class="_ _13"> </span>the<span class="_ _6"> </span>expression<span class="_ _13"> </span><span class="ffd">*rp.width<span class="_ _13"> </span></span>as</div><div class="t m5 x28 h2b y2bc0 ffd fs1e fc2 sc0 ls0 ws0">*(rp.width)<span class="ff7">,<span class="_ _10"> </span>which<span class="_ _11"> </span>is<span class="_"> </span>not<span class="_ _11"> </span>valid.<span class="_ _10"> </span>This<span class="_"> </span>combination<span class="_ _10"> </span>of<span class="_ _11"> </span>dereferencing<span class="_"> </span>and<span class="_ _11"> </span>ﬁeld<span class="_ _10"> </span>selection<span class="_ _11"> </span>is<span class="_ _10"> </span>so<span class="_ _11"> </span>common</span></div><div class="t m5 x28 h2b y2bc1 ff7 fs1e fc2 sc0 ls0 ws0">that<span class="_ _16"> </span>C<span class="_ _16"> </span>provides<span class="_ _16"> </span>an<span class="_ _11"> </span>alternative<span class="_ _16"> </span>notation<span class="_ _16"> </span>using<span class="_ _16"> </span><span class="ffd">-&gt;</span>.<span class="_ _16"> </span>T<span class="_ _0"></span>hat<span class="_ _16"> </span>is<span class="_ _1"></span>,<span class="_ _16"> </span><span class="ffd">rp-&gt;width<span class="_ _16"> </span></span>is<span class="_ _16"> </span>equivalent<span class="_ _16"> </span>to<span class="_ _16"> </span>the<span class="_ _16"> </span>expression</div><div class="t m5 x28 h2b y2bc2 ffd fs1e fc2 sc0 ls0 ws0">(*rp).width<span class="ff7">.<span class="_ _16"> </span>F<span class="_ _1"></span>or<span class="_ _16"> </span>example<span class="_ _1"></span>,<span class="_ _16"> </span>we<span class="_ _16"> </span>can<span class="_ _16"> </span>write<span class="_ _16"> </span>a<span class="_ _16"> </span>function<span class="_ _16"> </span>that<span class="_ _11"> </span>rotates<span class="_ _16"> </span>a<span class="_ _16"> </span>rectangle<span class="_ _16"> </span>counterclockwise<span class="_ _16"> </span>by<span class="_ _11"> </span>90</span></div><div class="t m5 x28 h2b y2bc3 ff7 fs1e fc2 sc0 ls0 ws0">degrees<span class="_"> </span>as</div><div class="t m5 x28 h2d y2bc4 ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>rotate_left(struct<span class="_ _1f"> </span>rect<span class="_ _1f"> </span>*rp)<span class="_ _e"> </span>{</div><div class="t m5 x243 h2d y2bc5 ffd fs1e fc2 sc0 ls0 ws0">/*<span class="_ _e"> </span>Exchange<span class="_ _1f"> </span>width<span class="_ _1f"> </span>and<span class="_ _e"> </span>height<span class="_ _1f"> </span>*/</div><div class="t m5 x243 h2d y2bc6 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>t<span class="_ _1f"> </span>=<span class="_ _1f"> </span>rp-&gt;height;</div><div class="t m5 x243 h2d y2bc7 ffd fs1e fc2 sc0 ls0 ws0">rp-&gt;height<span class="_ _e"> </span>=<span class="_ _1f"> </span>rp-&gt;width;</div><div class="t m5 x243 h2d y2bc8 ffd fs1e fc2 sc0 ls0 ws0">rp-&gt;width<span class="_ _1a"> </span>=<span class="_ _e"> </span>t;</div><div class="t m5 x243 h2d y2bc9 ffd fs1e fc2 sc0 ls0 ws0">/*<span class="_ _e"> </span>Shift<span class="_ _1f"> </span>to<span class="_ _1f"> </span>new<span class="_ _e"> </span>lower-left<span class="_ _1f"> </span>corner<span class="_ _e"> </span>*/</div><div class="t m5 x243 h2d y2bca ffd fs1e fc2 sc0 ls0 ws0">rp-&gt;llx<span class="_ _3f"> </span>-=<span class="_ _e"> </span>t;</div><div class="t m5 x28 h2d y2bcb ffd fs1e fc2 sc0 ls0 ws0">}</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
