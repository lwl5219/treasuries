<div id="pf1e5" class="pf w2 h11" data-page-no="1e5"><div class="pc pc1e5 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1e5.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">484<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>4<span class="_ _3d"> </span>Processor<span class="_ _10"> </span>Architecture</span></div><div class="t m5 x179 h98 y4385 ff49 fs5c fc1 sc0 ls0 ws0">Need</div><div class="t m5 x92 h98 y4386 ff49 fs5c fc1 sc0 ls0 ws0">valC</div><div class="t m5 x179 h98 y4387 ff49 fs5c fc1 sc0 ls0 ws0">Need</div><div class="t m5 x139 h98 y4388 ff49 fs5c fc1 sc0 ls0 ws0">regids</div><div class="t m5 x1fd h98 y4389 ff49 fs5c fc1 sc0 ls0 ws0">Predict</div><div class="t m5 xae h98 y438a ff49 fs5c fc1 sc0 ls0 ws0">PC</div><div class="t m5 xf1 h3f y438b ff49 fs27 fc1 sc0 ls0 ws0">Select</div><div class="t m5 x183 h3f y438c ff49 fs27 fc1 sc0 ls0 ws0">PC</div><div class="t m5 x1aa h3f y438d ff49 fs27 fc1 sc0 ls0 ws0">PC</div><div class="t m5 xfe h3f y438e ff49 fs27 fc1 sc0 ls0 ws0">increment</div><div class="t m5 xbe h3f y438f ff49 fs27 fc1 sc0 ls0 ws0">Align</div><div class="t m5 x176 h65 y4390 ff49 fs38 fc1 sc0 ls0 ws0">Bytes 1–9</div><div class="t m5 x1af h65 y4391 ff49 fs38 fc1 sc0 ls0 ws0">f_pc</div><div class="t m5 x235 h65 y4392 ff49 fs38 fc1 sc0 ls0 ws0">Byte 0</div><div class="t m5 x1ee h65 y4393 ff49 fs38 fc1 sc0 ls0 ws0">imem_error</div><div class="t m5 x1f2 h3f y4394 ff49 fs27 fc1 sc0 ls0 ws0">Instruction</div><div class="t m5 x238 h3f y4395 ff49 fs27 fc1 sc0 ls0 ws0">memory</div><div class="t m5 x112 h3f y4396 ff49 fs27 fc1 sc0 ls0 ws0">Split</div><div class="t m5 x10b h98 y4397 ff49 fs5c fc1 sc0 ls0 ws0">Instr</div><div class="t m5 x10b h98 y4398 ff49 fs5c fc1 sc0 ls0 ws0">valid</div><div class="t m5 xc5 h3f y4399 ff49 fs27 fc0 sc0 ls0 ws0">D<span class="_ _63"> </span><span class="fc1">icode<span class="_ _11d"></span>stat<span class="_ _128"> </span>ifun<span class="_ _115"> </span>valC<span class="_ _81"> </span>valP<span class="_ _1cf"></span>rB<span class="_ _ef"></span>rA</span></div><div class="t m5 x127 h3f y439a ff49 fs27 fc0 sc0 ls0 ws0">F<span class="_ _77"> </span><span class="fc1">predPC</span></div><div class="t m5 x1cf h65 y439b ff49 fs38 fc1 sc0 ls0 ws0">M_icode</div><div class="t m5 x97 h65 y439c ff49 fs38 fc1 sc0 ls0 ws0">M_Cnd</div><div class="t m5 xe9 h65 y439d ff49 fs38 fc1 sc0 ls0 ws0">M_valA</div><div class="t m5 x13f h65 y439e ff49 fs38 fc1 sc0 ls0 ws0">W_icode</div><div class="t m5 x1e5 h65 y439f ff49 fs38 fc1 sc0 ls0 ws0">W_valM</div><div class="t m5 x145 h98 y43a0 ff49 fs5c fc1 sc0 ls0 ws0">icode</div><div class="t m5 x1ff h98 y43a1 ff49 fs5c fc1 sc0 ls0 ws0">Stat</div><div class="t m5 x235 h98 y43a0 ff49 fs5c fc1 sc0 ls0 ws0">ifun</div><div class="t m5 x1d h34 y43a2 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _16"> </span>4.57<span class="_ _66"> </span><span class="fc1">PIPE<span class="_ _16"> </span>PC<span class="_ _16"> </span>selection<span class="_ _11"> </span>and<span class="_ _16"> </span>fetch<span class="_ _16"> </span>logic.<span class="_ _16"> </span><span class="ff6">W<span class="_ _0"></span>ithin<span class="_ _16"> </span>the<span class="_ _11"> </span>one<span class="_ _16"> </span>cycle<span class="_ _16"> </span>time<span class="_ _16"> </span>limit,<span class="_ _16"> </span>the</span></span></div><div class="t m5 x1d h34 y43a3 ff6 fs16 fc1 sc0 ls0 ws0">processor<span class="_ _10"> </span>can<span class="_ _11"> </span>only<span class="_ _10"> </span>predict<span class="_ _10"> </span>the<span class="_ _11"> </span>address<span class="_ _10"> </span>of<span class="_ _11"> </span>the<span class="_ _10"> </span>next<span class="_ _11"> </span>instruction.</div><div class="t m5 x1d h26 y43a4 ff7 fs19 fc1 sc0 ls0 ws0">memory<span class="_ _16"> </span>and<span class="_ _11"> </span>for<span class="_ _16"> </span>extracting<span class="_ _16"> </span>the<span class="_ _11"> </span>different<span class="_ _16"> </span>instruction<span class="_ _11"> </span>ﬁelds<span class="_ _16"> </span>are<span class="_ _16"> </span>the<span class="_ _11"> </span>same<span class="_ _16"> </span>as<span class="_ _16"> </span>those</div><div class="t m5 x1d h26 y43a5 ff7 fs19 fc1 sc0 ls0 ws0">we<span class="_"> </span>considered<span class="_"> </span>for<span class="_"> </span>SEQ<span class="_"> </span>(see<span class="_"> </span>the<span class="_"> </span>fetch<span class="_"> </span>stage<span class="_"> </span>in<span class="_"> </span>Section<span class="_"> </span>4.3.4).</div><div class="t m5 x29 h26 y43a6 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>PC<span class="_"> </span>selection<span class="_ _13"> </span>logic<span class="_"> </span>chooses<span class="_"> </span>between<span class="_ _13"> </span>three<span class="_"> </span>program<span class="_ _13"> </span>counter<span class="_"> </span>sources<span class="_ _1"></span>.<span class="_"> </span>As<span class="_ _13"> </span>a</div><div class="t m5 x1d h26 y43a7 ff7 fs19 fc1 sc0 ls0 ws0">mispredicted<span class="_ _13"> </span>branch<span class="_ _6"> </span>enters<span class="_ _13"> </span>the<span class="_ _13"> </span>memory<span class="_ _6"> </span>stage,<span class="_ _6"> </span>the<span class="_ _13"> </span>value<span class="_ _13"> </span>of<span class="_ _6"> </span><span class="ff6">valP<span class="_ _13"> </span></span>for<span class="_ _13"> </span>this<span class="_ _6"> </span>instruction</div><div class="t m5 x1d h26 y43a8 ff7 fs19 fc1 sc0 ls0 ws0">(indicating<span class="_"> </span>the<span class="_ _13"> </span>address<span class="_"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>following<span class="_"> </span>instruction)<span class="_"> </span>is<span class="_ _13"> </span>read<span class="_"> </span>from<span class="_"> </span>pipeline<span class="_ _13"> </span>register</div><div class="t m5 x1d h26 y43a9 ff7 fs19 fc1 sc0 ls0 ws0">M<span class="_ _13"> </span>(signal<span class="_ _13"> </span><span class="ff6">M_valA</span>).<span class="_"> </span>W<span class="_ _1"></span>hen<span class="_ _13"> </span>a<span class="_"> </span><span class="ffd">ret<span class="_ _13"> </span></span>instruction<span class="_ _13"> </span>enters<span class="_ _13"> </span>the<span class="_ _13"> </span>write-back<span class="_ _13"> </span>stage,<span class="_ _13"> </span>the<span class="_ _13"> </span>return</div><div class="t m5 x1d h26 y43aa ff7 fs19 fc1 sc0 ls0 ws0">address<span class="_"> </span>is<span class="_"> </span>read<span class="_ _13"> </span>from<span class="_"> </span>pipeline<span class="_"> </span>register<span class="_"> </span>W<span class="_"> </span>(signal<span class="_ _13"> </span><span class="ff6">W_valM</span>).<span class="_"> </span>All<span class="_"> </span>other<span class="_"> </span>cases<span class="_"> </span>use<span class="_ _13"> </span>the</div><div class="t m5 x1d h26 y43ab ff7 fs19 fc1 sc0 ls0 ws0">predicted<span class="_"> </span>value<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>PC,<span class="_"> </span>stored<span class="_"> </span>in<span class="_"> </span>pipeline<span class="_"> </span>register<span class="_"> </span>F<span class="_"> </span>(signal<span class="_"> </span><span class="ff6">F_predPC</span>):</div><div class="t m5 x1d h2d y561 ffd fs1e fc2 sc0 ls0 ws0">word<span class="_ _e"> </span>f_pc<span class="_ _1f"> </span>=<span class="_ _1f"> </span>[</div><div class="t m5 x22b h2d y43ac ffd fs1e fc2 sc0 ls0 ws0">#<span class="_ _e"> </span>Mispredicted<span class="_ _1f"> </span>branch.<span class="_ _1a"> </span>Fetch<span class="_ _1f"> </span>at<span class="_ _e"> </span>incremented<span class="_ _1f"> </span>PC</div><div class="t m5 x22b h2d y43ad ffd fs1e fc2 sc0 ls0 ws0">M_icode<span class="_ _e"> </span>==<span class="_ _1f"> </span>IJXX<span class="_ _1f"> </span>&amp;&amp;<span class="_ _e"> </span>!M_Cnd<span class="_ _1f"> </span>:<span class="_ _e"> </span>M_valA;</div><div class="t m5 x22b h2d y43ae ffd fs1e fc2 sc0 ls0 ws0">#<span class="_ _e"> </span>Completion<span class="_ _1f"> </span>of<span class="_ _1f"> </span>RET<span class="_ _e"> </span>instruction</div><div class="t m5 x22b h2d y43af ffd fs1e fc2 sc0 ls0 ws0">W_icode<span class="_ _e"> </span>==<span class="_ _1f"> </span>IRET<span class="_ _1f"> </span>:<span class="_ _e"> </span>W_valM;</div><div class="t m5 x22b h2d y43b0 ffd fs1e fc2 sc0 ls0 ws0">#<span class="_ _e"> </span>Default:<span class="_ _1f"> </span>Use<span class="_ _1f"> </span>predicted<span class="_ _e"> </span>value<span class="_ _1f"> </span>of<span class="_ _e"> </span>PC</div><div class="t m5 x22b h2d y43b1 ffd fs1e fc2 sc0 ls0 ws0">1<span class="_ _e"> </span>:<span class="_ _1f"> </span>F_predPC;</div><div class="t m5 x1d h2d y43b2 ffd fs1e fc2 sc0 ls0 ws0">];</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
