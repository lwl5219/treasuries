<div id="pf359" class="pf w2 h11" data-page-no="359"><div class="pc pc359 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg359.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">856<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>9<span class="_ _3d"> </span>Virtual<span class="_ _10"> </span>Memory</span></div><div class="t m8 x1a3 h3f y6eb3 ffb1 fs27 fc1 sc0 ls0 ws0">. . .</div><div class="t m5 x1c2 h3f y6eb4 ffb1 fs27 fc1 sc0 ls0 ws0">VP 1,023</div><div class="t m5 x1c2 h3f y6eb5 ffb1 fs27 fc1 sc0 ls0 ws0">VP 1,024</div><div class="t m5 x1c2 h3f y6eb6 ffb1 fs27 fc1 sc0 ls0 ws0">VP 2,047</div><div class="t m5 x12e h3f y6eb7 ffb1 fs27 fc1 sc0 ls0 ws0">Gap</div><div class="t m5 x161 h3f y6eb8 ffb1 fs27 fc1 sc0 ls0 ws0">PTE 0</div><div class="t m5 x161 h3f y6eb9 ffb1 fs27 fc1 sc0 ls0 ws0">PTE 1</div><div class="t m5 x155 h3f y6eba ffb1 fs27 fc1 sc0 ls0 ws0">PTE 2 (null)</div><div class="t m5 xfe h3f y6ebb ffb1 fs27 fc1 sc0 ls0 ws0">VP 0</div><div class="t m5 x42 h3f y6ebc ffb1 fs27 fc1 sc0 ls0 ws0">1,023</div><div class="t m5 xf5 h3f y6ebd ffb1 fs27 fc1 sc0 ls0 ws0">unallocated</div><div class="t m5 x1fc h3f y6ebe ffb1 fs27 fc1 sc0 ls0 ws0">pages</div><div class="t m5 x155 h3f y6ebf ffb1 fs27 fc1 sc0 ls0 ws0">PTE 3 (null)</div><div class="t m5 x155 h3f y6ec0 ffb1 fs27 fc1 sc0 ls0 ws0">PTE 4 (null)</div><div class="t m5 x155 h3f y6ec1 ffb1 fs27 fc1 sc0 ls0 ws0">PTE 5 (null)</div><div class="t m5 x155 h3f y6ec2 ffb1 fs27 fc1 sc0 ls0 ws0">PTE 6 (null)</div><div class="t m5 xe2 h3f y6ec0 ffb1 fs27 fc1 sc0 ls0 ws0">PTE 0</div><div class="t m5 x167 h3f y6ec2 ffb1 fs27 fc1 sc0 ls0 ws0">PTE 1,023</div><div class="t m5 xe2 h3f y6ec3 ffb1 fs27 fc1 sc0 ls0 ws0">PTE 0</div><div class="t m5 x167 h3f y6ec4 ffb1 fs27 fc1 sc0 ls0 ws0">PTE 1,023</div><div class="t m5 xed h3f y6ec5 ffb1 fs27 fc1 sc0 ls0 ws0">1,023 null</div><div class="t m5 xec h3f y6ec6 ffb1 fs27 fc1 sc0 ls0 ws0">PTEs</div><div class="t m5 x155 h3f y6ec7 ffb1 fs27 fc1 sc0 ls0 ws0">PTE 7 (null)</div><div class="t m5 x161 h3f y6ec8 ffb1 fs27 fc1 sc0 ls0 ws0">PTE 8</div><div class="t m5 x124 h3f y6ec9 ffb1 fs27 fc1 sc0 ls0 ws0">(1 K– 9)</div><div class="t m5 xc5 h3f y6eca ffb1 fs27 fc1 sc0 ls0 ws0">null PTEs</div><div class="t m5 x167 h3f y6ecb ffb1 fs27 fc1 sc0 ls0 ws0">PTE 1,023</div><div class="t m5 xbe h3f y6ecc ffb1 fs27 fc1 sc0 ls0 ws0">. . .</div><div class="t m5 xbe h3f y6ecd ffb1 fs27 fc1 sc0 ls0 ws0">. . .</div><div class="t m5 xfb h3f y6ece ffb1 fs27 fc1 sc0 ls0 ws0">VP 9,215</div><div class="t m5 xb6 h3f y6ecf ffb2 fs27 fc1 sc0 ls0 ws0">2 K allocated <span class="_ _1"></span>VM pages</div><div class="t m5 xb6 h3f y6ed0 ffb2 fs27 fc1 sc0 ls0 ws0">for code and data</div><div class="t m5 xb6 h3f y6ed1 ffb2 fs27 fc1 sc0 ls0 ws0">6 K unallocated <span class="_ _1"></span>VM page</div><div class="c x1d y6ed2 w31 h109"><div class="t m5 x24 h3f y6ed3 ffb2 fs27 fc1 sc0 ls0 ws0">s</div></div><div class="t m5 xb6 h3f y6ed4 ffb2 fs27 fc1 sc0 ls0 ws0">1,023 unallocated pages</div><div class="t m5 xb6 h3f y6ed5 ffb2 fs27 fc1 sc0 ls0 ws0">1 allocated <span class="_ _1"></span>VM page</div><div class="t m5 xb6 h3f y6ed6 ffb2 fs27 fc1 sc0 ls0 ws0">for the stac<span class="_ _1"></span>k</div><div class="t m5 x1fc h3f y6ed7 ffb1 fs27 fc1 sc0 ls0 ws0">Virtual</div><div class="t m5 x51 h3f y6ed8 ffb1 fs27 fc1 sc0 ls0 ws0">memory</div><div class="t m5 x110 h3f y6ed7 ffb1 fs27 fc1 sc0 ls0 ws0">Level 2</div><div class="t m5 xdc h3f y6ed8 ffb1 fs27 fc1 sc0 ls0 ws0">page tables</div><div class="t m5 x17e h3f y6ed7 ffb1 fs27 fc1 sc0 ls0 ws0">Level 1</div><div class="t m5 x1f h3f y6ed8 ffb1 fs27 fc1 sc0 ls0 ws0">page table</div><div class="t m5 x107 h65 y6ed9 ffb1 fs38 fc1 sc0 ls0 ws0">0</div><div class="t m5 x175 h3f y6eda ffb1 fs27 fc1 sc0 ls0 ws0">. . .</div><div class="t m5 x175 h3f y6edb ffb1 fs27 fc1 sc0 ls0 ws0">. . .</div><div class="t m5 x1d h34 y6edc ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _16"> </span>9.17<span class="_ _66"> </span><span class="fc1">A<span class="_ _16"> </span>two-level<span class="_ _14"> </span>page<span class="_ _16"> </span>table<span class="_ _16"> </span>hierarchy<span class="_ _3"></span>.<span class="_ _16"> </span><span class="ff6">Notice<span class="_ _16"> </span>that<span class="_ _16"> </span>addresses<span class="_ _16"> </span>increase<span class="_ _16"> </span>from</span></span></div><div class="t m5 x1d h34 y6edd ff6 fs16 fc1 sc0 ls0 ws0">top<span class="_ _10"> </span>to<span class="_ _11"> </span>bottom.</div><div class="t m5 xe1 h3f y6ede ffb1 fs27 fc1 sc0 ls0 ws0">PPN<span class="_ _152"> </span>PPO</div><div class="t m5 x136 h3f y6edf ffb1 fs27 fc1 sc0 ls0 ws0">. . .</div><div class="t m5 x136 h3f y6ee0 ffb1 fs27 fc1 sc0 ls0 ws0">. . .<span class="_ _24"> </span>. . .</div><div class="t m5 x1ac h65 y6ee1 ffb2 fs38 fc1 sc0 ls0 ws0">m<span class="_ _2"></span><span class="ffb1">–1</span></div><div class="t m5 x155 h65 y6ee2 ffb2 fs38 fc1 sc0 ls0 ws0">n<span class="_ _2"></span><span class="ffb1">–1<span class="_ _218"> </span></span>p<span class="_ _2"></span><span class="ffb1">–1<span class="_ _8b"> </span>0</span></div><div class="t m5 x1bc h65 y6ee1 ffb2 fs38 fc1 sc0 ls0 ws0">p<span class="_ _2"></span><span class="ffb1">–1<span class="_ _1f9"> </span>0</span></div><div class="t m5 xe7 h3f y6ee3 ffb1 fs27 fc1 sc0 ls0 ws0">Virtual address</div><div class="t m5 xdc h3f y6ee4 ffb1 fs27 fc1 sc0 ls0 ws0">Physical address</div><div class="t m5 x4c h3f y6ee5 ffb1 fs27 fc1 sc0 ls0 ws0">VPN 1<span class="_ _119"> </span>VPN 2<span class="_ _10c"> </span>VPN <span class="ffb2">k<span class="_ _4f"> </span></span>VPO</div><div class="t m5 x177 h3f y6ee6 ffb1 fs27 fc1 sc0 ls0 ws0">Level 1</div><div class="t m5 x4c h3f y6ee7 ffb1 fs27 fc1 sc0 ls0 ws0">page table</div><div class="t m5 x150 h3f y6ee6 ffb1 fs27 fc1 sc0 ls0 ws0">Level 2</div><div class="t m5 x25 h3f y6ee7 ffb1 fs27 fc1 sc0 ls0 ws0">page table</div><div class="t m5 x1ae h3f y6ee6 ffb1 fs27 fc1 sc0 ls0 ws0">Level <span class="ffb2">k</span></div><div class="t m5 x9a h3f y6ee7 ffb1 fs27 fc1 sc0 ls0 ws0">page table</div><div class="t m5 x40 h3f y6ee8 ffb1 fs27 fc1 sc0 ls0 ws0">PPN</div><div class="t m5 x1d h2f y6ee9 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>9.18<span class="_ _66"> </span><span class="fc1">Address<span class="_"> </span>translation<span class="_"> </span>with<span class="_"> </span>a<span class="_"> </span><span class="ff11">k<span class="_ _2"></span></span>-level<span class="_"> </span>page<span class="_"> </span>table.</span></div><div class="t m5 x29 h26 y8ff ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_ _13"> </span>9.18<span class="_ _a"> </span>summarizes<span class="_ _13"> </span>address<span class="_ _a"> </span>translation<span class="_ _13"> </span>with<span class="_ _a"> </span>a<span class="_ _13"> </span><span class="ff11">k<span class="_ _2"></span></span>-level<span class="_ _6"> </span>page<span class="_ _6"> </span>table<span class="_ _6"> </span>hierarchy<span class="_ _3"></span>.</div><div class="t m5 x1d h46 y900 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>virtual<span class="_"> </span>address<span class="_ _13"> </span>is<span class="_"> </span>partitioned<span class="_"> </span>into<span class="_ _13"> </span><span class="ff11">k<span class="_ _11"> </span></span>VPNs<span class="_"> </span>and<span class="_ _13"> </span>a<span class="_"> </span>VPO<span class="_ _3"></span>.<span class="_"> </span>Each<span class="_"> </span>VPN<span class="_ _13"> </span><span class="ff11">i<span class="_ _5"></span></span><span class="ls29d">,1<span class="_ _1"></span><span class="ff12 ls0">≤<span class="_ _13"></span><span class="ff11">i<span class="_ _11"> </span></span>≤<span class="_ _10"> </span><span class="ff11">k<span class="_ _2"></span><span class="ff7">,</span></span></span></span></div><div class="t m5 x1d h46 y901 ff7 fs19 fc1 sc0 ls0 ws0">is<span class="_"> </span>an<span class="_"> </span>index<span class="_"> </span>into<span class="_ _11"> </span>a<span class="_"> </span>page<span class="_"> </span>table<span class="_"> </span>at<span class="_ _11"> </span>level<span class="_"> </span><span class="ff11">i<span class="_ _5"></span></span>.<span class="_"> </span>Each<span class="_"> </span>PTE<span class="_ _11"> </span>in<span class="_"> </span>a<span class="_"> </span>level<span class="_ _11"> </span><span class="ff11">j<span class="_ _14"> </span></span>table,<span class="_"> </span>1<span class="_ _6"> </span><span class="ff12">≤<span class="_ _10"> </span><span class="ff11">j<span class="_"> </span></span>≤<span class="_ _13"> </span><span class="ff11">k<span class="_ _11"> </span></span>−<span class="_ _10"> </span></span><span class="ls25">1,</span></div><div class="t m5 x1d h46 y902 ff7 fs19 fc1 sc0 ls0 ws0">points<span class="_ _11"> </span>to<span class="_ _11"> </span>the<span class="_ _16"> </span>base<span class="_ _11"> </span>of<span class="_ _11"> </span>some<span class="_ _16"> </span>page<span class="_"> </span>table<span class="_ _16"> </span>at<span class="_ _11"> </span>level<span class="_ _11"> </span><span class="ff11">j<span class="_"> </span><span class="ff12">+<span class="_ _10"> </span></span></span>1<span class="_ _1"></span>.<span class="_ _11"> </span>Each<span class="_ _16"> </span>PTE<span class="_ _11"> </span>in<span class="_ _11"> </span>a<span class="_ _11"> </span>level<span class="_ _16"> </span><span class="ff11">k<span class="_"> </span></span>table</div><div class="t m5 x1d h26 y903 ff7 fs19 fc1 sc0 ls0 ws0">contains<span class="_ _14"> </span>either<span class="_ _15"> </span>the<span class="_ _15"> </span>PPN<span class="_ _14"> </span>of<span class="_ _15"> </span>some<span class="_ _15"> </span>physical<span class="_ _14"> </span>page<span class="_ _15"> </span>or<span class="_ _14"> </span>the<span class="_ _15"> </span>address<span class="_ _15"> </span>of<span class="_ _14"> </span>a<span class="_ _15"> </span>disk<span class="_ _15"> </span>block.</div><div class="t m5 x1d h26 y904 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _7"></span>o<span class="_ _15"> </span>construct<span class="_ _14"> </span>the<span class="_ _14"> </span>physical<span class="_ _14"> </span>address<span class="_ _1"></span>,<span class="_ _15"> </span>the<span class="_ _15"> </span>MMU<span class="_ _14"> </span>must<span class="_ _14"> </span>access<span class="_ _14"> </span><span class="ff11">k<span class="_ _21"> </span></span>PTEs<span class="_ _14"> </span>before<span class="_ _14"> </span>it<span class="_ _14"> </span>can</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
