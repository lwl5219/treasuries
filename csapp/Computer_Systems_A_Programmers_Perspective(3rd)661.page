<div id="pf295" class="pf w2 h11" data-page-no="295"><div class="pc pc295 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg295.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">660<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>6<span class="_ _3d"> </span>The<span class="_ _10"> </span>Memory<span class="_ _10"> </span>Hierarchy</span></div><div class="t m5 x1d h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>or<span class="_ _14"> </span>example,<span class="_ _14"> </span>instead<span class="_ _15"> </span>of<span class="_ _14"> </span>deﬁning<span class="_ _15"> </span><span class="ffd">x<span class="_ _15"> </span></span>to<span class="_ _14"> </span>be<span class="_ _15"> </span><span class="ffd">float<span class="_ _11"> </span>x[8]</span>,<span class="_ _21"> </span>we<span class="_ _15"> </span>deﬁne<span class="_ _14"> </span>it<span class="_ _15"> </span>to<span class="_ _14"> </span>be<span class="_ _15"> </span><span class="ffd">float</span></div><div class="t m5 x1d h26 y2a7 ffd fs19 fc2 sc0 ls0 ws0">x[12]<span class="ff7">.<span class="_ _11"> </span>Assuming<span class="_ _11"> </span></span>y<span class="_ _16"> </span><span class="ff7">starts<span class="_"> </span>immediately<span class="_ _16"> </span>after<span class="_ _11"> </span></span>x<span class="_ _11"> </span><span class="ff7">in<span class="_ _11"> </span>memory<span class="_ _3"></span>,<span class="_ _16"> </span>we<span class="_ _11"> </span>have<span class="_ _11"> </span>the<span class="_ _11"> </span>following</span></div><div class="t m5 x1d h26 y2a8 ff7 fs19 fc2 sc0 ls0 ws0">mapping<span class="_"> </span>of<span class="_"> </span>array<span class="_"> </span>elements<span class="_"> </span>to<span class="_"> </span>sets:</div><div class="t m5 x1d h31 y57f3 ff7 fs21 fc2 sc0 ls0 ws0">Element<span class="_ _26"> </span>Address<span class="_ _26"> </span>Set<span class="_"> </span>index<span class="_ _5a"> </span>Element<span class="_ _26"> </span>Address<span class="_ _26"> </span>Set<span class="_"> </span>index</div><div class="t m5 x126 h31 y57f4 ffd fs1e fc2 sc0 ls0 ws0">x[0]<span class="_ _10d"> </span><span class="ff7 fs21 ls247">00<span class="_ _1e"> </span></span>y[0]</div><div class="t m5 x108 h31 y57f5 ff7 fs21 fc2 sc0 ls0 ws0">48<span class="_ _c0"> </span>1</div><div class="t m5 x126 h31 y57f6 ffd fs1e fc2 sc0 ls0 ws0">x[1]<span class="_ _10d"> </span><span class="ff7 fs21 ls247">40</span></div><div class="t m5 x19d h31 y57f7 ffd fs1e fc2 sc0 ls0 ws0">y[1]<span class="_ _d0"> </span><span class="ff7 fs21">52<span class="_ _55"> </span>1</span></div><div class="t m5 x126 h31 y57f8 ffd fs1e fc2 sc0 ls0 ws0">x[2]<span class="_ _10d"> </span><span class="ff7 fs21 ls247">80<span class="_ _1e"> </span></span>y[2]<span class="_ _d0"> </span><span class="ff7 fs21">56<span class="_ _55"> </span>1</span></div><div class="t m5 x126 h31 y57f9 ffd fs1e fc2 sc0 ls0 ws0">x[3]<span class="_ _d0"> </span><span class="ff7 fs21">12<span class="_ _55"> </span>0<span class="_ _d6"> </span></span>y[3]<span class="_ _ba"> </span><span class="ff7 fs21">60<span class="_ _c0"> </span>1</span></div><div class="t m5 x126 h31 y57fa ffd fs1e fc2 sc0 ls0 ws0">x[4]<span class="_ _d0"> </span><span class="ff7 fs21">16<span class="_ _55"> </span>1<span class="_ _d6"> </span></span>y[4]<span class="_ _ba"> </span><span class="ff7 fs21">64<span class="_ _c0"> </span>0</span></div><div class="t m5 x126 h31 y57fb ffd fs1e fc2 sc0 ls0 ws0">x[5]<span class="_ _d0"> </span><span class="ff7 fs21">20<span class="_ _55"> </span>1<span class="_ _d6"> </span></span>y[5]<span class="_ _ba"> </span><span class="ff7 fs21">68<span class="_ _c0"> </span>0</span></div><div class="t m5 x126 h31 y57fc ffd fs1e fc2 sc0 ls0 ws0">x[6]<span class="_ _d0"> </span><span class="ff7 fs21">24<span class="_ _55"> </span>1<span class="_ _d6"> </span></span>y[6]<span class="_ _ba"> </span><span class="ff7 fs21">72<span class="_ _c0"> </span>0</span></div><div class="t m5 x126 h31 y57fd ffd fs1e fc2 sc0 ls0 ws0">x[7]<span class="_ _d0"> </span><span class="ff7 fs21">28<span class="_ _55"> </span>1<span class="_ _d6"> </span></span>y[7]<span class="_ _ba"> </span><span class="ff7 fs21">76<span class="_ _c0"> </span>0</span></div><div class="t m5 x1d h26 y57fe ff7 fs19 fc2 sc0 ls0 ws0">W<span class="_ _1"></span>ith<span class="_"> </span>the<span class="_"> </span>padding<span class="_ _13"> </span>at<span class="_"> </span>the<span class="_"> </span>end<span class="_ _13"> </span>of<span class="_"> </span><span class="ffd">x</span>,<span class="_"> </span><span class="ffd">x[i]<span class="_ _13"> </span></span>and<span class="_"> </span><span class="ffd">y[i]<span class="_ _13"> </span></span>now<span class="_"> </span>map<span class="_"> </span>to<span class="_ _13"> </span>different<span class="_"> </span>sets<span class="_ _1"></span>,<span class="_"> </span>which</div><div class="t m5 x1d h26 y57ff ff7 fs19 fc2 sc0 ls0 ws0">eliminates<span class="_"> </span>the<span class="_"> </span>thrashing<span class="_"> </span>conﬂict<span class="_"> </span>misses<span class="_ _1"></span>.</div><div class="t m5 x1d h47 y5800 ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>6.10<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>699)</span></div><div class="t m5 x1d h26 y5801 ff7 fs19 fc1 sc0 ls0 ws0">In<span class="_"> </span>the<span class="_"> </span>previous<span class="_ _13"> </span><span class="ffd">dotprod<span class="_ _10"> </span></span>example,<span class="_ _13"> </span>what<span class="_"> </span>fraction<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>total<span class="_ _13"> </span>references<span class="_"> </span>to<span class="_"> </span><span class="ffd">x<span class="_ _10"> </span></span>and<span class="_"> </span><span class="ffd">y</span></div><div class="t m5 x1d h26 y5802 ff7 fs19 fc1 sc0 ls0 ws0">will<span class="_"> </span>be<span class="_"> </span>hits<span class="_"> </span>once<span class="_"> </span>we<span class="_"> </span>have<span class="_"> </span>padded<span class="_"> </span>array<span class="_"> </span><span class="ffd">x</span>?</div><div class="t m5 x1d h47 y5803 ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>6.11<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>699)</span></div><div class="t m5 x1d h26 y5804 ff7 fs19 fc1 sc0 ls0 ws0">Imagine<span class="_"> </span>a<span class="_ _11"> </span>hypothetical<span class="_ _11"> </span>cache<span class="_ _11"> </span>that<span class="_ _11"> </span>uses<span class="_ _11"> </span>the<span class="_ _11"> </span>high-order<span class="_ _11"> </span><span class="ff11">s<span class="_"> </span></span>bits<span class="_ _11"> </span>of<span class="_ _11"> </span>an<span class="_ _11"> </span>address<span class="_ _11"> </span>as<span class="_ _11"> </span>the</div><div class="t m5 x1d h26 y5805 ff7 fs19 fc1 sc0 ls0 ws0">set<span class="_"> </span>index.<span class="_ _11"> </span>F<span class="_ _1"></span>or<span class="_ _11"> </span>such<span class="_ _11"> </span>a<span class="_"> </span>cache,<span class="_"> </span>contiguous<span class="_"> </span>chunks<span class="_ _11"> </span>of<span class="_ _11"> </span>memory<span class="_ _11"> </span>blocks<span class="_"> </span>are<span class="_ _11"> </span>mapped<span class="_ _11"> </span>to</div><div class="t m5 x1d h26 y5806 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>same<span class="_"> </span>cache<span class="_"> </span>set.</div><div class="t m5 x124 h26 y5807 ff7 fs19 fc1 sc0 ls0 ws0">A.<span class="_ _1f"> </span>How<span class="_"> </span>many<span class="_"> </span>blocks<span class="_"> </span>are<span class="_"> </span>in<span class="_"> </span>each<span class="_"> </span>of<span class="_"> </span>these<span class="_"> </span>contiguous<span class="_"> </span>array<span class="_"> </span>chunks?</div><div class="t m5 x124 h26 y5808 ff7 fs19 fc1 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>Consider<span class="_"> </span>the<span class="_"> </span>following<span class="_ _11"> </span>code<span class="_"> </span>that<span class="_"> </span>runs<span class="_"> </span>on<span class="_"> </span>a<span class="_"> </span>system<span class="_"> </span>with<span class="_ _11"> </span>a<span class="_"> </span>cache<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>form</div><div class="t m5 x4f h46 y5809 ff11 fs19 fc1 sc0 ls42 ws0">(<span class="_ _80"></span>S<span class="_ _8"></span>,E<span class="_ _4"></span>,B<span class="_ _4"></span>,m<span class="_ _80"></span>)<span class="ff12 ls0">=<span class="_ _13"> </span><span class="ff11">(<span class="ff7">512<span class="_ _2"></span></span>,<span class="_ _13"> </span><span class="ff7">1<span class="_ _1"></span><span class="ff11">,<span class="_ _10"> </span><span class="ff7">32</span>,<span class="_ _10"> </span><span class="ff7">32</span>)<span class="ff7">:</span></span></span></span></span></div><div class="t m5 x4f h2d y580a ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>array[4096];</div><div class="t m5 x4f h2d y580b ffd fs1e fc2 sc0 ls0 ws0">for<span class="_ _e"> </span>(i<span class="_ _1f"> </span>=<span class="_ _1f"> </span>0;<span class="_ _e"> </span>i<span class="_ _1f"> </span>&lt;<span class="_ _e"> </span>4096;<span class="_ _1f"> </span>i++)</div><div class="t m5 x33 h2d y580c ffd fs1e fc2 sc0 ls0 ws0">sum<span class="_ _e"> </span>+=<span class="_ _1f"> </span>array[i];</div><div class="t m5 x4f h26 y580d ff7 fs19 fc2 sc0 ls0 ws0">What<span class="_"> </span>is<span class="_ _16"> </span>the<span class="_ _11"> </span>maximum<span class="_ _16"> </span>number<span class="_ _11"> </span>of<span class="_ _16"> </span>array<span class="_ _11"> </span>blocks<span class="_ _11"> </span>that<span class="_ _16"> </span>are<span class="_ _11"> </span>stored<span class="_ _16"> </span>in<span class="_ _11"> </span>the<span class="_ _11"> </span>cache</div><div class="t m5 x4f h26 y580e ff7 fs19 fc2 sc0 ls0 ws0">at<span class="_"> </span>any<span class="_"> </span>point<span class="_"> </span>in<span class="_"> </span>time?</div><div class="t m5 x1d h41 y1051 ffe fs29 fc1 sc0 ls0 ws0">6.4.3<span class="_ _48"> </span><span class="fs19">Set<span class="_"> </span>Associative<span class="_"> </span>Caches</span></div><div class="t m5 x1d h26 y832 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _14"> </span>problem<span class="_ _14"> </span>with<span class="_ _14"> </span>conﬂict<span class="_ _14"> </span>misses<span class="_ _14"> </span>in<span class="_ _14"> </span>direct-mapped<span class="_ _14"> </span>caches<span class="_ _14"> </span>stems<span class="_ _14"> </span>from<span class="_ _14"> </span>the<span class="_ _14"> </span>con-</div><div class="t m5 x1d h46 y833 ff7 fs19 fc1 sc0 ls0 ws0">straint<span class="_ _14"> </span>that<span class="_ _15"> </span>each<span class="_ _15"> </span>set<span class="_ _15"> </span>has<span class="_ _15"> </span>exactly<span class="_ _14"> </span>one<span class="_ _15"> </span>line<span class="_ _15"> </span>(or<span class="_ _15"> </span>in<span class="_ _14"> </span>our<span class="_ _15"> </span>terminology<span class="_ _3"></span>,<span class="_ _21"> </span><span class="ff11">E<span class="_ _11"> </span><span class="ff12">=<span class="_ _10"> </span></span></span><span class="ls25">1)<span class="_ _2"></span>.<span class="_ _f"> </span>A<span class="_ _f"> </span></span><span class="ffa">set</span></div><div class="t m5 x1d h26 y834 ffa fs19 fc1 sc0 ls0 ws0">associative<span class="_ _13"> </span>cac<span class="_ _0"></span>he<span class="_ _13"> </span><span class="ff7">relaxes<span class="_ _13"> </span>this<span class="_ _6"> </span>constraint<span class="_ _13"> </span>so<span class="_ _13"> </span>that<span class="_ _6"> </span>each<span class="_ _13"> </span>set<span class="_ _13"> </span>holds<span class="_ _13"> </span>more<span class="_ _6"> </span>than<span class="_ _13"> </span>one<span class="_ _13"> </span>cache</span></div><div class="t m5 x1d h26 y835 ff7 fs19 fc1 sc0 ls0 ws0">line<span class="_ _1"></span>.<span class="_"> </span>A<span class="_ _13"> </span>cache<span class="_"> </span>with<span class="_ _13"> </span>1<span class="_ _6"> </span><span class="ff11 ls249">&lt;E<span class="_ _5"></span>&lt;C<span class="_ _8"></span>/<span class="_ _80"></span>B<span class="_ _be"></span><span class="ff7 ls0">is<span class="_"> </span>often<span class="_ _13"> </span>called<span class="_ _13"> </span>an<span class="_"> </span><span class="ff11">E<span class="_ _2"></span></span>-way<span class="_ _13"> </span>set<span class="_"> </span>associative<span class="_ _13"> </span>cache<span class="_ _0"></span>.<span class="_ _13"> </span>W<span class="_ _1"></span>e</span></span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
