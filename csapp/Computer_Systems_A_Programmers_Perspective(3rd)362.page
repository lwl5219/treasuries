<div id="pf16a" class="pf w2 h11" data-page-no="16a"><div class="pc pc16a w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg16a.png"/><div class="t m5 x107 h28 y9b ff32 fs1f fc2 sc0 ls0 ws0">Solutions<span class="_ _10"> </span>to<span class="_ _10"> </span>Practice<span class="_ _10"> </span>Problems<span class="_ _1b"> </span><span class="ff33 fs1e">361</span></div><div class="t m5 x17 h2d ye7 ff32 fs20 fc6 sc0 ls0 ws0">11<span class="_ _1c"> </span><span class="ff34 fs1e fc2">double<span class="_ _1f"> </span>complex<span class="_ _e"> </span>c_sub(double<span class="_ _1f"> </span>complex<span class="_ _1f"> </span>x,<span class="_ _e"> </span>double<span class="_ _1f"> </span>complex<span class="_ _e"> </span>y)<span class="_ _1f"> </span>{</span></div><div class="t m5 x17 h2d yc4d ff32 fs20 fc6 sc0 ls0 ws0">12<span class="_ _20"> </span><span class="ff34 fs1e fc2">retur<span class="ls33">nx-y<span class="_ _41"></span>;</span></span></div><div class="t m5 x17 h2d yecb ff32 fs20 fc6 sc0 ls0 ws0">13<span class="_ _1c"> </span><span class="ff34 fs1e fc2">}</span></div><div class="t m5 x26 h26 y32e0 ff35 fs19 fc2 sc0 ls0 ws0">When<span class="_ _11"> </span>compiled,<span class="_ _14"> </span><span class="ff36">gcc<span class="_ _16"> </span></span>generates<span class="_ _16"> </span>the<span class="_ _14"> </span>following<span class="_ _16"> </span>assembly<span class="_ _16"> </span>code<span class="_ _16"> </span>for<span class="_ _16"> </span>these<span class="_ _16"> </span>func-</div><div class="t m5 x17 h26 y32e1 ff35 fs19 fc2 sc0 ls0 ws0">tions:</div><div class="t m5 x2e h61 y32e2 ff37 fs35 fc6 sc0 ls0 ws0">double<span class="_ _f"> </span>c_imag(double<span class="_ _f"> </span>complex<span class="_ _f"> </span>x)</div><div class="t m5 x2c h2d y32e3 ff32 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ff34 fs1e fc2">c_imag:</span></div><div class="t m5 x2c h2d y32e4 ff32 fs20 fc6 sc0 ls0 ws0">2<span class="_ _45"> </span><span class="ff34 fs1e fc2">movapd<span class="_ _1a"> </span>%xmm1,<span class="_ _e"> </span>%xmm0</span></div><div class="t m5 x2c h2d y32e5 ff32 fs20 fc6 sc0 ls0 ws0">3<span class="_ _45"> </span><span class="ff34 fs1e fc2">ret</span></div><div class="t m5 x2e h61 y32e6 ff37 fs35 fc6 sc0 ls0 ws0">double<span class="_ _f"> </span>c_real(double<span class="_ _f"> </span>complex<span class="_ _f"> </span>x)</div><div class="t m5 x2c h2d y32e7 ff32 fs20 fc6 sc0 ls0 ws0">4<span class="_ _1c"> </span><span class="ff34 fs1e fc2">c_real:</span></div><div class="t m5 x2c h2d y32e8 ff32 fs20 fc6 sc0 ls0 ws0">5<span class="_ _45"> </span><span class="ff34 fs1e fc2">rep;<span class="_ _e"> </span>ret</span></div><div class="t m5 x2e h61 y32e9 ff37 fs35 fc6 sc0 ls0 ws0">double<span class="_ _f"> </span>complex<span class="_ _f"> </span>c_sub(double<span class="_ _f"> </span>complex<span class="_ _e"> </span>x,<span class="_ _21"> </span>double<span class="_ _f"> </span>complex<span class="_ _e"> </span>y)</div><div class="t m5 x2c h2d y32ea ff32 fs20 fc6 sc0 ls0 ws0">6<span class="_ _1c"> </span><span class="ff34 fs1e fc2">c_sub:</span></div><div class="t m5 x2c h2d y32eb ff32 fs20 fc6 sc0 ls0 ws0">7<span class="_ _45"> </span><span class="ff34 fs1e fc2">subsd<span class="_ _3f"> </span>%xmm2,<span class="_ _e"> </span>%xmm0</span></div><div class="t m5 x2c h2d y32ec ff32 fs20 fc6 sc0 ls0 ws0">8<span class="_ _45"> </span><span class="ff34 fs1e fc2">subsd<span class="_ _3f"> </span>%xmm3,<span class="_ _e"> </span>%xmm1</span></div><div class="t m5 x2c h2d y32ed ff32 fs20 fc6 sc0 ls0 ws0">9<span class="_ _45"> </span><span class="ff34 fs1e fc2">ret</span></div><div class="t m5 x26 h26 y32ee ff35 fs19 fc2 sc0 ls0 ws0">Based<span class="_ _10"> </span>on<span class="_ _10"> </span>these<span class="_ _10"> </span>examples<span class="_ _1"></span>,<span class="_ _10"> </span>determine<span class="_ _11"> </span>the<span class="_ _10"> </span>following:</div><div class="t m5 x34 h26 y32ef ff35 fs19 fc2 sc0 ls0 ws0">A.<span class="_ _1f"> </span>How<span class="_ _10"> </span>are<span class="_ _10"> </span>complex<span class="_ _10"> </span>arguments<span class="_ _10"> </span>passed<span class="_ _10"> </span>to<span class="_ _11"> </span>a<span class="_ _10"> </span>function?</div><div class="t m5 x34 h26 y32f0 ff35 fs19 fc2 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>How<span class="_ _10"> </span>are<span class="_ _10"> </span>complex<span class="_ _11"> </span>values<span class="_ _10"> </span>returned<span class="_ _10"> </span>from<span class="_ _10"> </span>a<span class="_ _10"> </span>function?</div><div class="t m5 x17 h29 y32f1 ff33 fs14 fc2 sc0 ls0 ws0">Solutions<span class="_ _16"> </span>to<span class="_ _16"> </span>Practice<span class="_ _16"> </span>Problems</div><div class="t m5 x17 h28 y32f2 ff33 fs1e fc6 sc0 ls0 ws0">Solution<span class="_ _11"> </span>to<span class="_ _10"> </span>Problem<span class="_ _11"> </span>3.1<span class="_ _e"> </span><span class="fs16">(page<span class="_ _11"> </span>218)</span></div><div class="t m5 x17 h26 y32f3 ff35 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _10"> </span>exercise<span class="_ _11"> </span>gives<span class="_ _10"> </span>you<span class="_ _10"> </span>practice<span class="_ _10"> </span>with<span class="_ _10"> </span>the<span class="_ _10"> </span>different<span class="_ _11"> </span>operand<span class="_ _10"> </span>forms<span class="_ _1"></span>.</div><div class="t m5 x17 h31 y32f4 ff35 fs21 fc2 sc0 ls0 ws0">Operand<span class="_ _18b"> </span>V<span class="_ _7"></span>alue<span class="_ _f1"> </span>Comment</div><div class="t m5 x17 h31 y32f5 ff34 fs1e fc2 sc0 ls0 ws0">%rax<span class="_ _158"> </span>0x100<span class="_ _26"> </span><span class="ff35 fs21">Register</span></div><div class="t m5 x17 h2d y32f6 ff34 fs1e fc2 sc0 ls0 ws0">0x104<span class="_ _da"> </span>0xAB</div><div class="t m5 x1af h31 y32f7 ff35 fs21 fc2 sc0 ls0 ws0">Absolute<span class="_ _10"> </span>address</div><div class="t m5 x17 h31 y32f8 ff34 fs1e fc2 sc0 ls0 ws0">$0x108<span class="_ _16d"> </span>0x108<span class="_ _26"> </span><span class="ff35 fs21">Immediate</span></div><div class="t m5 x17 h31 y32f9 ff34 fs1e fc2 sc0 ls0 ws0">(%rax)<span class="_ _115"> </span>0xFF<span class="_ _61"> </span><span class="ff35 fs21">Address<span class="_ _10"> </span></span>0x100</div><div class="t m5 x17 h2d y32fa ff34 fs1e fc2 sc0 ls0 ws0">4(%rax)<span class="_ _bb"> </span>0xAB</div><div class="t m5 x1af h31 y32fb ff35 fs21 fc2 sc0 ls0 ws0">Address<span class="_ _10"> </span><span class="ff34 fs1e">0x104</span></div><div class="t m5 x17 h2d y32fc ff34 fs1e fc2 sc0 ls0 ws0">9(%rax,%rdx)<span class="_ _b9"> </span>0x11</div><div class="t m5 x1af h31 y32fd ff35 fs21 fc2 sc0 ls0 ws0">Address<span class="_ _10"> </span><span class="ff34 fs1e">0x10C</span></div><div class="t m5 x17 h2d y32fe ff34 fs1e fc2 sc0 ls0 ws0">260(%rcx,%rdx)<span class="_ _61"> </span>0x13</div><div class="t m5 x1af h31 y32ff ff35 fs21 fc2 sc0 ls0 ws0">Address<span class="_ _10"> </span><span class="ff34 fs1e">0x108</span></div><div class="t m5 x17 h2d y3300 ff34 fs1e fc2 sc0 ls0 ws0">0xFC(,%rcx,4)<span class="_ _72"> </span>0xFF</div><div class="t m5 x1af h31 y3301 ff35 fs21 fc2 sc0 ls0 ws0">Address<span class="_ _10"> </span><span class="ff34 fs1e">0x100</span></div><div class="t m5 x17 h2d y3302 ff34 fs1e fc2 sc0 ls0 ws0">(%rax,%rdx,4)<span class="_ _72"> </span>0x11</div><div class="t m5 x1af h31 y3303 ff35 fs21 fc2 sc0 ls0 ws0">Address<span class="_ _10"> </span><span class="ff34 fs1e">0x10C</span></div><div class="t m5 x17 h28 y3304 ff33 fs1e fc6 sc0 ls0 ws0">Solution<span class="_ _11"> </span>to<span class="_ _10"> </span>Problem<span class="_ _11"> </span>3.2</div><div class="t m5 xc3 h2f y1cbf ff33 fs16 fc6 sc0 ls0 ws0">(page<span class="_ _10"> </span>221)</div><div class="t m5 x17 h26 yd7a ff35 fs19 fc1 sc0 ls0 ws0">As<span class="_ _14"> </span>we<span class="_ _14"> </span>have<span class="_ _16"> </span>seen,<span class="_ _15"> </span>the<span class="_ _14"> </span>assembly<span class="_ _14"> </span>code<span class="_ _14"> </span>generated<span class="_ _14"> </span>by<span class="_ _14"> </span><span class="ff36">gcc<span class="_ _14"> </span></span>includes<span class="_ _14"> </span>sufÔ¨Åxes<span class="_ _14"> </span>on<span class="_ _14"> </span>the</div><div class="t m5 x17 h26 y1cc0 ff35 fs19 fc1 sc0 ls0 ws0">instructions<span class="_ _1"></span>,<span class="_ _10"> </span>while<span class="_ _10"> </span>the<span class="_ _10"> </span>disassembler<span class="_ _13"> </span>does<span class="_ _10"> </span>not.<span class="_ _10"> </span>Being<span class="_ _10"> </span>able<span class="_ _10"> </span>to<span class="_ _10"> </span>switch<span class="_ _10"> </span>between<span class="_ _13"> </span>these</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
