<div id="pf18d" class="pf w2 h11" data-page-no="18d"><div class="pc pc18d w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg18d.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">396<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>4<span class="_ _3d"> </span>Processor<span class="_ _10"> </span>Architecture</span></div><div class="t m5 x28 h2a y257 fff fs1c fc2 sc0 ls0 ws0">Aside<span class="_ _1b"> </span><span class="ff6 fs19">Comparing<span class="_ _11"> </span>x86-64<span class="_ _11"> </span>to<span class="_ _11"> </span>Y86-64<span class="_ _16"> </span>instruction<span class="_ _11"> </span>encodings</span></div><div class="t m5 x28 h2b y2d0 ff7 fs1e fc2 sc0 ls0 ws0">Compared<span class="_"> </span>with<span class="_"> </span>the<span class="_ _10"> </span>instruction<span class="_ _11"> </span>encodings<span class="_"> </span>used<span class="_"> </span>in<span class="_ _10"> </span>x86-64,<span class="_ _10"> </span>the<span class="_ _11"> </span>encoding<span class="_"> </span>of<span class="_"> </span>Y86-64<span class="_ _10"> </span>is<span class="_ _10"> </span>much<span class="_ _11"> </span>simpler<span class="_"> </span>but</div><div class="t m5 x28 h2b y2d1 ff7 fs1e fc2 sc0 ls0 ws0">also<span class="_ _11"> </span>less<span class="_ _11"> </span>compact.<span class="_ _11"> </span>T<span class="_ _0"></span>he<span class="_ _11"> </span>register<span class="_ _11"> </span>ﬁelds<span class="_ _11"> </span>occur<span class="_ _11"> </span>only<span class="_ _11"> </span>in<span class="_ _16"> </span>ﬁxed<span class="_ _10"> </span>positions<span class="_ _16"> </span>in<span class="_ _10"> </span>all<span class="_ _16"> </span>Y86-64<span class="_ _10"> </span>instructions<span class="_ _0"></span>,<span class="_ _11"> </span>whereas</div><div class="t m5 x28 h2b y2d2 ff7 fs1e fc2 sc0 ls0 ws0">they<span class="_ _11"> </span>are<span class="_ _11"> </span>packed<span class="_ _11"> </span>into<span class="_ _11"> </span>various<span class="_ _11"> </span>positions<span class="_ _11"> </span>in<span class="_ _16"> </span>the<span class="_ _10"> </span>different<span class="_ _16"> </span>x86-64<span class="_ _10"> </span>instructions<span class="_ _0"></span>.<span class="_ _11"> </span>An<span class="_ _11"> </span>x86-64<span class="_ _11"> </span>instruction<span class="_ _11"> </span>can</div><div class="t m5 x28 h2b y2d3 ff7 fs1e fc2 sc0 ls0 ws0">encode<span class="_"> </span>constant<span class="_"> </span>values<span class="_"> </span>in<span class="_"> </span>1,<span class="_"> </span>2,<span class="_"> </span>4,<span class="_"> </span>or<span class="_"> </span>8<span class="_"> </span>bytes<span class="_ _1"></span>,<span class="_"> </span>whereas<span class="_"> </span>Y86-64<span class="_"> </span>always<span class="_"> </span>requires<span class="_"> </span>8<span class="_"> </span>bytes<span class="_ _1"></span>.</div><div class="t m5 x1d h26 y372f ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _16"> </span>instruction<span class="_ _16"> </span>sequence<span class="_ _16"> </span>as<span class="_ _16"> </span>long<span class="_ _16"> </span>as<span class="_ _16"> </span>we<span class="_ _16"> </span>start<span class="_ _16"> </span>from<span class="_ _16"> </span>the<span class="_ _16"> </span>ﬁrst<span class="_ _16"> </span>byte<span class="_ _16"> </span>in<span class="_ _16"> </span>the<span class="_ _16"> </span>sequence<span class="_ _1"></span>.</div><div class="t m5 x1d h26 y3730 ff7 fs19 fc2 sc0 ls0 ws0">On<span class="_ _13"> </span>the<span class="_"> </span>other<span class="_ _13"> </span>hand,<span class="_ _13"> </span>if<span class="_"> </span>we<span class="_ _13"> </span>do<span class="_ _13"> </span>not<span class="_ _13"> </span>know<span class="_"> </span>the<span class="_ _13"> </span>starting<span class="_ _13"> </span>position<span class="_"> </span>of<span class="_ _13"> </span>a<span class="_ _13"> </span>code<span class="_ _13"> </span>sequence,<span class="_ _13"> </span>we</div><div class="t m5 x1d h26 y3731 ff7 fs19 fc2 sc0 ls0 ws0">cannot<span class="_ _11"> </span>reliably<span class="_ _11"> </span>determine<span class="_ _16"> </span>how<span class="_ _11"> </span>to<span class="_ _11"> </span>split<span class="_ _16"> </span>the<span class="_"> </span>sequence<span class="_ _16"> </span>into<span class="_ _11"> </span>individual<span class="_ _11"> </span>instructions<span class="_ _1"></span>.</div><div class="t m5 x1d h26 y3732 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _14"> </span>causes<span class="_ _15"> </span>problems<span class="_ _14"> </span>for<span class="_ _14"> </span>disassemblers<span class="_ _14"> </span>and<span class="_ _14"> </span>other<span class="_ _14"> </span>tools<span class="_ _14"> </span>that<span class="_ _14"> </span>attempt<span class="_ _15"> </span>to<span class="_ _14"> </span>extract</div><div class="t m5 x1d h26 y3733 ff7 fs19 fc2 sc0 ls0 ws0">machine-level<span class="_"> </span>programs<span class="_"> </span>directly<span class="_"> </span>from<span class="_"> </span>object-code<span class="_"> </span>byte<span class="_"> </span>sequences<span class="_ _1"></span>.</div><div class="t m5 x1d h47 y3734 ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>4.1<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>516)</span></div><div class="t m5 x1d h26 y3735 ff7 fs19 fc1 sc0 ls0 ws0">Determine<span class="_ _13"> </span>the<span class="_ _13"> </span>byte<span class="_ _6"> </span>encoding<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>Y86-64<span class="_ _6"> </span>instruction<span class="_ _13"> </span>sequence<span class="_ _13"> </span>that<span class="_ _13"> </span>follows<span class="_ _3"></span>.<span class="_ _13"> </span>T<span class="_ _0"></span>he</div><div class="t m5 x1d h26 y3736 ff7 fs19 fc1 sc0 ls0 ws0">line<span class="_ _16"> </span><span class="ffd">.pos<span class="_ _11"> </span>0x100<span class="_ _16"> </span></span>indicates<span class="_ _16"> </span>that<span class="_ _16"> </span>the<span class="_ _16"> </span>starting<span class="_ _16"> </span>address<span class="_ _11"> </span>of<span class="_ _16"> </span>the<span class="_ _16"> </span>object<span class="_ _16"> </span>code<span class="_ _16"> </span>should<span class="_ _16"> </span>be</div><div class="t m5 x1d h26 y3737 ffd fs19 fc1 sc0 ls0 ws0">0x100<span class="ff7">.</span></div><div class="t m5 x1d h2d y3738 ffd fs1e fc2 sc0 ls0 ws0">.pos<span class="_ _e"> </span>0x100<span class="_ _1a"> </span>#<span class="_ _1f"> </span>Start<span class="_ _1f"> </span>code<span class="_ _e"> </span>at<span class="_ _1f"> </span>address<span class="_ _e"> </span>0x100</div><div class="t m5 x10c h2d y3739 ffd fs1e fc2 sc0 ls0 ws0">irmovq<span class="_ _e"> </span>$15,%rbx</div><div class="t m5 x10c h2d y373a ffd fs1e fc2 sc0 ls0 ws0">rrmovq<span class="_ _e"> </span>%rbx,%rcx</div><div class="t m5 x1d h2d y373b ffd fs1e fc2 sc0 ls0 ws0">loop:</div><div class="t m5 x10c h2d y373c ffd fs1e fc2 sc0 ls0 ws0">rmmovq<span class="_ _e"> </span>%rcx,-3(%rbx)</div><div class="t m5 x10c h2d y373d ffd fs1e fc2 sc0 ls0 ws0">addq<span class="_ _3f"> </span>%rbx,%rcx</div><div class="t m5 x10c h2d y373e ffd fs1e fc2 sc0 ls0 ws0">jmp<span class="_ _e"> </span>loop</div><div class="t m5 x1d h47 y373f ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>4.2<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>517)</span></div><div class="t m5 x1d h26 y3740 ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>or<span class="_ _11"> </span>each<span class="_ _16"> </span>byte<span class="_ _11"> </span>sequence<span class="_ _11"> </span>listed,<span class="_ _16"> </span>determine<span class="_ _11"> </span>the<span class="_ _16"> </span>Y86-64<span class="_ _11"> </span>instruction<span class="_ _16"> </span>sequence<span class="_ _11"> </span>it<span class="_ _11"> </span>en-</div><div class="t m5 x1d h26 y3741 ff7 fs19 fc1 sc0 ls0 ws0">codes<span class="_ _1"></span>.<span class="_ _13"> </span>If<span class="_ _13"> </span>there<span class="_ _13"> </span>is<span class="_ _13"> </span>some<span class="_ _13"> </span>invalid<span class="_"> </span>byte<span class="_ _13"> </span>in<span class="_ _13"> </span>the<span class="_ _13"> </span>sequence<span class="_ _1"></span>,<span class="_ _13"> </span>show<span class="_"> </span>the<span class="_ _13"> </span>instruction<span class="_ _13"> </span>sequence</div><div class="t m5 x1d h26 y3742 ff7 fs19 fc1 sc0 ls0 ws0">up<span class="_ _11"> </span>to<span class="_ _11"> </span>that<span class="_ _16"> </span>point<span class="_ _11"> </span>and<span class="_ _11"> </span>indicate<span class="_ _11"> </span>where<span class="_ _16"> </span>the<span class="_ _11"> </span>invalid<span class="_ _11"> </span>value<span class="_ _11"> </span>occurs<span class="_ _1"></span>.<span class="_ _16"> </span>F<span class="_ _3"></span>or<span class="_ _16"> </span>each<span class="_ _11"> </span>sequence<span class="_ _0"></span>,</div><div class="t m5 x1d h26 y3743 ff7 fs19 fc1 sc0 ls0 ws0">we<span class="_"> </span>show<span class="_"> </span>the<span class="_"> </span>starting<span class="_"> </span>address<span class="_ _1"></span>,<span class="_"> </span>then<span class="_"> </span>a<span class="_"> </span>colon,<span class="_"> </span>and<span class="_"> </span>then<span class="_"> </span>the<span class="_"> </span>byte<span class="_"> </span>sequence<span class="_ _1"></span>.</div><div class="t m5 x124 h26 y3744 ff7 fs19 fc1 sc0 ls0 ws0">A.<span class="_ _1f"> </span><span class="ffd">0x100:<span class="_ _11"> </span>30f3fcffffffffffffff40630008000000000000</span></div><div class="t m5 x124 h26 y3745 ff7 fs19 fc1 sc0 ls2a ws0">B.<span class="_ _66"> </span><span class="ffd ls0">0x200:<span class="_ _11"> </span>a06f800c020000000000000030f30a00000000000000</span></div><div class="t m5 x124 h26 y3746 ff7 fs19 fc1 sc0 ls22 ws0">C.<span class="_ _24"> </span><span class="ffd ls0">0x300:<span class="_ _16"> </span>5054070000000000000010f0b01f</span></div><div class="t m5 x124 h26 y3747 ff7 fs19 fc1 sc0 ls2a ws0">D.<span class="_ _24"> </span><span class="ffd ls0">0x400:<span class="_ _11"> </span>611373000400000000000000</span></div><div class="t m5 x124 h26 y3748 ff7 fs19 fc1 sc0 ls0 ws0">E.<span class="_ _25"> </span><span class="ffd">0x500:<span class="_ _11"> </span>6362a0f0</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
