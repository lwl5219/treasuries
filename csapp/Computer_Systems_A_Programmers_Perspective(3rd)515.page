<div id="pf203" class="pf w2 h11" data-page-no="203"><div class="pc pc203 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg203.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">514<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>4<span class="_ _3d"> </span>Processor<span class="_ _10"> </span>Architecture</span></div><div class="t m5 x24c h65 y472e ff53 fs38 fc1 sc0 ls0 ws0">e_Cnd</div><div class="t m5 xec h65 y472f ff53 fs38 fc1 sc0 ls0 ws0">E_icode</div><div class="t m5 x1d h65 y4730 ff53 fs38 fc1 sc0 ls0 ws0">W_stat</div><div class="t m5 xa2 h65 y4731 ff53 fs38 fc1 sc0 ls0 ws0">m_stat</div><div class="t m5 x14d h65 y4732 ff53 fs38 fc1 sc0 ls0 ws0">M_dstM</div><div class="t m5 x202 h65 y4733 ff53 fs38 fc1 sc0 ls0 ws0">E_srcA</div><div class="t m5 x14d h65 y4734 ff53 fs38 fc1 sc0 ls0 ws0">m_valM</div><div class="t m5 x1fb h65 y4735 ff53 fs38 fc1 sc0 ls0 ws0">E_valA</div><div class="t m5 x1f6 h3f y4736 ff53 fs27 fc0 sc0 ls0 ws0">W<span class="_ _63"> </span><span class="fc1">icode<span class="_ _1a1"></span>stat</span></div><div class="t m5 x32 h3f y4737 ff53 fs27 fc1 sc0 ls0 ws0">stat</div><div class="t m5 x32 h3f y4738 ff53 fs27 fc1 sc0 ls0 ws0">stat</div><div class="t m5 x119 h3f y4736 ff53 fs27 fc1 sc0 ls0 ws0">valE<span class="_ _72"> </span>valM<span class="_ _bd"> </span>dstE<span class="_ _e"> </span>dstM</div><div class="t m5 x1f6 h3f y4737 ff53 fs27 fc0 sc0 ls0 ws0">M<span class="_ _18c"> </span><span class="fc1">icode<span class="_ _45"> </span>Cnd<span class="_ _148"> </span>valE<span class="_ _5c"> </span>valA<span class="_ _7e"> </span>dstE<span class="_ _1f"> </span>dstM</span></div><div class="t m5 xcf h3f y4738 ff53 fs27 fc0 sc0 ls0 ws0">E<span class="_ _118"> </span><span class="fc1">icode<span class="_ _25"> </span>ifun<span class="_ _62"> </span>valC<span class="_ _5c"> </span>valA<span class="_ _d3"> </span>valB<span class="_ _55"> </span>dstM<span class="_ _1f"> </span>srcA<span class="_ _1f"> </span>srcB</span></div><div class="t m5 xe3 h98 y4739 ff53 fs5c fc1 sc0 ls0 ws0">ALU</div><div class="t m5 xaa h98 y473a ff53 fs5c fc1 sc0 ls0 ws0">A</div><div class="t m5 x18d h98 y473b ff53 fs5c fc1 sc0 ls0 ws0">Set</div><div class="t m5 x10f h98 y473c ff53 fs5c fc1 sc0 ls0 ws0">CC</div><div class="t m5 x118 h98 y473d ff53 fs5c fc1 sc0 ls0 ws0">ALU</div><div class="t m5 x1ae h98 y473e ff53 fs5c fc1 sc0 ls0 ws0">B</div><div class="t m5 x1df h98 y473f ff53 fs5c fc1 sc0 ls0 ws0">ALU</div><div class="t m5 x1aa h98 y4740 ff53 fs5c fc1 sc0 ls0 ws0">fun.</div><div class="t m5 x185 h3f y4741 ff53 fs27 fc1 sc0 ls0 ws0">ALU</div><div class="t m5 xe7 h3f y4742 ff53 fs27 fc1 sc0 ls0 ws0">CC</div><div class="t m5 x1f4 h3f y4743 ff53 fs27 fc1 sc0 ls0 ws0">cond</div><div class="t m5 x24f h65 y4744 ff53 fs38 fc1 sc0 ls0 ws0">data out</div><div class="t m5 xfe h65 y4745 ff53 fs38 fc1 sc0 ls0 ws0">data in</div><div class="t m5 x139 h65 y4746 ff53 fs38 fc1 sc0 ls0 ws0">read</div><div class="t m5 xd h65 y4747 ff53 fs38 fc1 sc0 ls0 ws0">dmem_error</div><div class="t m5 xfd h65 y4748 ff53 fs38 fc1 sc0 ls0 ws0">write</div><div class="t m5 x254 h98 y4749 ff53 fs5c fc1 sc0 ls0 ws0">Addr</div><div class="t m5 x1b4 h98 y474a ff53 fs5c fc1 sc0 ls0 ws9">Fwd A</div><div class="t m5 x49 h98 y474b ff53 fs5c fc1 sc0 ls0 ws0">Mem.</div><div class="t m5 xe1 h98 y474c ff53 fs5c fc1 sc0 ls0 ws0">read</div><div class="t m5 x49 h98 y474d ff53 fs5c fc1 sc0 ls0 ws0">Mem.</div><div class="t m5 x143 h98 y474e ff53 fs5c fc1 sc0 ls0 ws0">write</div><div class="t m5 x32 h98 y474f ff53 fs5c fc1 sc0 ls0 ws0">Stat</div><div class="t m5 x9 h98 y4750 ff53 fs5c fc1 sc0 ls0 ws0">dstE</div><div class="t m5 xf3 h3f y4751 ff53 fs27 fc1 sc0 ls0 ws0">dstE</div><div class="t m5 x1c9 h3f y4752 ff53 fs27 fc1 sc0 ls0 ws0">Data</div><div class="t m5 x1e2 h3f y4753 ff53 fs27 fc1 sc0 ls0 ws0">memory</div><div class="t m5 x1d h34 y4754 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _11"> </span>4.70<span class="_ _c"> </span><span class="fc1">Execute<span class="_ _11"> </span>and<span class="_ _11"> </span>memor<span class="_ _2"></span>y<span class="_"> </span>stages<span class="_ _16"> </span>capable<span class="_"> </span>of<span class="_ _16"> </span>load<span class="_"> </span>for<span class="_ _2"></span>warding.<span class="_"> </span><span class="ff6">By<span class="_ _16"> </span>adding<span class="_ _11"> </span>a</span></span></div><div class="t m5 x1d h34 y4755 ff6 fs16 fc1 sc0 ls0 ws0">bypass<span class="_ _13"> </span>path<span class="_ _10"> </span>from<span class="_ _13"> </span>the<span class="_ _13"> </span>memory<span class="_ _10"> </span>output<span class="_ _13"> </span>to<span class="_ _13"> </span>the<span class="_ _10"> </span>sour<span class="_ _0"></span>ce<span class="_ _13"> </span>of<span class="_ _10"> </span>valA<span class="_ _13"> </span>in<span class="_ _13"> </span>pipeline<span class="_ _10"> </span>register<span class="_ _13"> </span>M,<span class="_ _13"> </span>we<span class="_ _10"> </span>can</div><div class="t m5 x1d h34 y4756 ff6 fs16 fc1 sc0 ls0 ws0">use<span class="_ _11"> </span>forwarding<span class="_ _16"> </span>rather<span class="_ _11"> </span>than<span class="_ _11"> </span>stalling<span class="_ _16"> </span>for<span class="_ _11"> </span>one<span class="_ _11"> </span>form<span class="_ _11"> </span>of<span class="_ _16"> </span>load/use<span class="_ _11"> </span>hazard.<span class="_ _11"> </span>This<span class="_ _11"> </span>is<span class="_ _16"> </span>the<span class="_ _11"> </span>subject</div><div class="t m5 x1d h34 y4757 ff6 fs16 fc1 sc0 ls0 ws0">of<span class="_ _10"> </span>Problem<span class="_ _11"> </span>4.57.</div><div class="t m5 x1d h26 y4758 ff7 fs19 fc1 sc0 ls0 ws0">used<span class="_"> </span>as<span class="_"> </span>part<span class="_ _11"> </span>of<span class="_"> </span>the<span class="_ _11"> </span>address<span class="_"> </span>computation<span class="_"> </span>by<span class="_ _11"> </span>the<span class="_"> </span>next<span class="_ _11"> </span>instruction,<span class="_"> </span>and<span class="_ _11"> </span>this<span class="_"> </span>value<span class="_"> </span>is</div><div class="t m5 x1d h26 y4759 ff7 fs19 fc1 sc0 ls0 ws0">required<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>execute<span class="_"> </span>stage<span class="_"> </span>rather<span class="_"> </span>than<span class="_"> </span>the<span class="_"> </span>memory<span class="_"> </span>stage<span class="_ _1"></span>.</div><div class="t m5 x124 h26 y475a ff7 fs19 fc1 sc0 ls0 ws0">A.<span class="_ _1f"> </span>Write<span class="_"> </span>a<span class="_"> </span>logic<span class="_"> </span>formula<span class="_ _13"> </span>describing<span class="_"> </span>the<span class="_"> </span>detection<span class="_"> </span>condition<span class="_"> </span>for<span class="_"> </span>a<span class="_"> </span>load/use<span class="_ _13"> </span>haz-</div><div class="t m5 x4f h26 y475b ff7 fs19 fc1 sc0 ls0 ws0">ard,<span class="_ _16"> </span>similar<span class="_ _14"> </span>to<span class="_ _16"> </span>the<span class="_ _16"> </span>one<span class="_ _16"> </span>given<span class="_ _16"> </span>in<span class="_ _14"> </span>F<span class="_ _1"></span>igure<span class="_ _14"> </span>4.64,<span class="_ _16"> </span>except<span class="_ _14"> </span>that<span class="_ _16"> </span>it<span class="_ _16"> </span>will<span class="_ _16"> </span>not<span class="_ _16"> </span>cause<span class="_ _14"> </span>a</div><div class="t m5 x4f h26 y475c ff7 fs19 fc1 sc0 ls0 ws0">stall<span class="_"> </span>in<span class="_"> </span>cases<span class="_"> </span>where<span class="_"> </span>load<span class="_"> </span>forwarding<span class="_"> </span>can<span class="_"> </span>be<span class="_"> </span>used.</div><div class="t m5 x124 h26 y475d ff7 fs19 fc1 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>The<span class="_ _16"> </span>ﬁle<span class="_ _14"> </span><span class="ffd">pipe-lf.hcl<span class="_ _14"> </span></span>contains<span class="_ _14"> </span>a<span class="_ _16"> </span>modiﬁed<span class="_ _14"> </span>version<span class="_ _14"> </span>of<span class="_ _14"> </span>the<span class="_ _14"> </span>control<span class="_ _14"> </span>logic<span class="_ _14"> </span>for</div><div class="t m5 x4f h26 y475e ff7 fs19 fc1 sc0 ls0 ws0">PIPE.<span class="_ _16"> </span>It<span class="_ _16"> </span>contains<span class="_ _16"> </span>the<span class="_ _16"> </span>deﬁnition<span class="_ _14"> </span>of<span class="_ _16"> </span>a<span class="_ _16"> </span>signal<span class="_ _16"> </span><span class="ff6">e_valA<span class="_ _16"> </span></span>to<span class="_ _14"> </span>implement<span class="_ _16"> </span>the<span class="_ _16"> </span>block</div><div class="t m5 x4f h26 y475f ff7 fs19 fc1 sc0 ls0 ws0">labeled<span class="_ _13"> </span>“Fwd<span class="_"> </span>A<span class="_ _4"></span>”<span class="_"> </span>in<span class="_ _13"> </span>F<span class="_ _1"></span>igure<span class="_"> </span>4.70.<span class="_ _13"> </span>It<span class="_ _13"> </span>also<span class="_ _13"> </span>has<span class="_"> </span>the<span class="_ _13"> </span>conditions<span class="_ _13"> </span>for<span class="_ _13"> </span>a<span class="_"> </span>load/use<span class="_ _13"> </span>haz-</div><div class="t m5 x4f h26 y4760 ff7 fs19 fc1 sc0 ls0 ws0">ard<span class="_"> </span>in<span class="_ _13"> </span>the<span class="_"> </span>pipeline<span class="_ _13"> </span>control<span class="_"> </span>logic<span class="_"> </span>set<span class="_ _13"> </span>to<span class="_"> </span>zero<span class="_ _1"></span>,<span class="_"> </span>and<span class="_"> </span>so<span class="_ _13"> </span>the<span class="_"> </span>pipeline<span class="_"> </span>control<span class="_ _13"> </span>logic</div><div class="t m5 x4f h26 y4761 ff7 fs19 fc1 sc0 ls0 ws0">will<span class="_"> </span>not<span class="_"> </span>detect<span class="_ _11"> </span>any<span class="_"> </span>forms<span class="_ _11"> </span>of<span class="_"> </span>load/use<span class="_"> </span>hazards<span class="_ _0"></span>.<span class="_"> </span>Modify<span class="_"> </span>this<span class="_ _11"> </span>HCL<span class="_"> </span>description</div><div class="t m5 x4f h26 y4762 ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_ _13"> </span>implement<span class="_"> </span>load<span class="_ _13"> </span>forwarding.<span class="_ _13"> </span>See<span class="_"> </span>the<span class="_ _13"> </span>lab<span class="_"> </span>material<span class="_ _13"> </span>for<span class="_"> </span>directions<span class="_ _13"> </span>on<span class="_ _13"> </span>how<span class="_"> </span>to</div><div class="t m5 x4f h26 y4763 ff7 fs19 fc1 sc0 ls0 ws0">generate<span class="_"> </span>a<span class="_"> </span>simulator<span class="_"> </span>for<span class="_"> </span>your<span class="_"> </span>solution<span class="_"> </span>and<span class="_"> </span>how<span class="_"> </span>to<span class="_"> </span>test<span class="_"> </span>it.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
