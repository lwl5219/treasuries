<div id="pf13b" class="pf w2 h11" data-page-no="13b"><div class="pc pc13b w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg13b.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">314<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>3<span class="_ _3d"> </span>Machine-Level<span class="_ _10"> </span>Representation<span class="_ _10"> </span>of<span class="_ _10"> </span>Programs</span></div><div class="t m5 x75 h3d y2d1a ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x29 h30 ye7 ffa fs19 fc1 sc0 ls0 ws0">Casting<span class="_ _11"> </span>from<span class="_ _11"> </span>one<span class="_ _11"> </span>type<span class="_ _11"> </span>of<span class="_ _16"> </span>pointer<span class="_"> </span>to<span class="_ _16"> </span>another<span class="_"> </span>changes<span class="_ _11"> </span>its<span class="_ _11"> </span>type<span class="_ _16"> </span>but<span class="_"> </span>not<span class="_ _11"> </span>its<span class="_ _16"> </span>value<span class="_ _1"></span>.</div><div class="t m5 x29 h26 y2a7 ff7 fs19 fc1 sc0 ls0 ws0">One<span class="_ _16"> </span>effect<span class="_ _14"> </span>of<span class="_ _16"> </span>casting<span class="_ _14"> </span>is<span class="_ _16"> </span>to<span class="_ _14"> </span>change<span class="_ _14"> </span>any<span class="_ _16"> </span>scaling<span class="_ _14"> </span>of<span class="_ _16"> </span>pointer<span class="_ _14"> </span>arithmetic.<span class="_ _16"> </span>So<span class="_ _1"></span>,<span class="_ _15"> </span>for</div><div class="t m5 x29 h26 y2a8 ff7 fs19 fc1 sc0 ls0 ws0">example<span class="_ _1"></span>,<span class="_ _16"> </span>if<span class="_"> </span><span class="ffd">p<span class="_ _11"> </span></span>is<span class="_ _11"> </span>a<span class="_ _11"> </span>pointer<span class="_ _11"> </span>of<span class="_ _11"> </span>type<span class="_ _11"> </span><span class="ffd">char<span class="_ _16"> </span>*<span class="_ _11"> </span></span>having<span class="_"> </span>value<span class="_ _11"> </span><span class="ff11">p<span class="_ _2"></span></span>,<span class="_ _11"> </span>then<span class="_ _11"> </span>the<span class="_ _11"> </span>expression</div><div class="t m5 x29 h46 y2f7 ffd fs19 fc1 sc0 ls0 ws0">(int<span class="_ _11"> </span>*)<span class="_ _16"> </span>p+7<span class="_ _10"> </span><span class="ff7">computes<span class="_"> </span><span class="ff11">p<span class="_ _10"> </span><span class="ff12">+<span class="_ _10"> </span></span></span><span class="ls9b">28,<span class="_"> </span>while<span class="_"> </span></span></span>(int<span class="_ _11"> </span>*)<span class="_ _16"> </span>(p+7)<span class="_ _10"> </span><span class="ff7">computes<span class="_"> </span><span class="ff11">p<span class="_ _10"> </span><span class="ff12">+<span class="_ _10"> </span></span></span><span class="ls182">7.<span class="_"> </span>(Recall</span></span></div><div class="t m5 x29 h26 y2f8 ff7 fs19 fc1 sc0 ls0 ws0">that<span class="_"> </span>casting<span class="_"> </span>has<span class="_"> </span>higher<span class="_"> </span>precedence<span class="_"> </span>than<span class="_"> </span>addition.)</div><div class="t m5 x75 h3d y2d1b ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x29 h26 y2d1c ffa fs19 fc1 sc0 ls0 ws0">P<span class="_ _1"></span>ointers<span class="_ _16"> </span>can<span class="_ _14"> </span>also<span class="_ _14"> </span>point<span class="_ _14"> </span>to<span class="_ _16"> </span>functions<span class="_ _0"></span>.<span class="_"> </span><span class="ff7">T<span class="_ _1"></span>his<span class="_ _14"> </span>provides<span class="_ _16"> </span>a<span class="_ _14"> </span>powerful<span class="_ _14"> </span>capability<span class="_ _14"> </span>for</span></div><div class="t m5 x29 h26 y2d1d ff7 fs19 fc1 sc0 ls0 ws0">storing<span class="_ _11"> </span>and<span class="_ _16"> </span>passing<span class="_ _11"> </span>references<span class="_ _11"> </span>to<span class="_ _16"> </span>code<span class="_ _1"></span>,<span class="_ _16"> </span>which<span class="_ _11"> </span>can<span class="_ _16"> </span>be<span class="_ _11"> </span>invoked<span class="_ _11"> </span>in<span class="_ _16"> </span>some<span class="_ _11"> </span>other</div><div class="t m5 x29 h26 y2d1e ff7 fs19 fc1 sc0 ls0 ws0">part<span class="_"> </span>of<span class="_ _13"> </span>the<span class="_"> </span>program.<span class="_ _13"> </span>F<span class="_ _1"></span>or<span class="_"> </span>example<span class="_ _1"></span>,<span class="_"> </span>if<span class="_ _13"> </span>we<span class="_"> </span>have<span class="_"> </span>a<span class="_ _13"> </span>function<span class="_"> </span>deﬁned<span class="_ _13"> </span>by<span class="_"> </span>the<span class="_ _13"> </span>proto-</div><div class="t m5 x29 h26 y2d1f ff7 fs19 fc1 sc0 ls0 ws0">type</div><div class="t m5 x207 h2d y2d20 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>fun(int<span class="_ _1f"> </span>x,<span class="_ _1f"> </span>int<span class="_ _e"> </span>*p);</div><div class="t m5 x29 h26 y2d21 ff7 fs19 fc2 sc0 ls0 ws0">then<span class="_"> </span>we<span class="_"> </span>can<span class="_ _11"> </span>declare<span class="_"> </span>and<span class="_ _11"> </span>assign<span class="_"> </span>a<span class="_ _11"> </span>pointer<span class="_"> </span><span class="ffd">fp<span class="_ _11"> </span></span>to<span class="_"> </span>this<span class="_"> </span>function<span class="_ _11"> </span>by<span class="_"> </span>the<span class="_ _11"> </span>following</div><div class="t m5 x29 h26 y2d22 ff7 fs19 fc2 sc0 ls0 ws0">code<span class="_"> </span>sequence:</div><div class="t m5 x15a h2d y2d23 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>(*fp)(int,<span class="_ _1f"> </span>int<span class="_ _1f"> </span>*);</div><div class="t m5 x15a h2d y2d24 ffd fs1e fc2 sc0 ls0 ws0">fp<span class="_ _1a"> </span>=<span class="_ _e"> </span>fun;</div><div class="t m5 x29 h26 y2d25 ff7 fs19 fc2 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_"> </span>can<span class="_"> </span>then<span class="_"> </span>invoke<span class="_"> </span>the<span class="_"> </span>function<span class="_"> </span>using<span class="_"> </span>this<span class="_"> </span>pointer:</div><div class="t m5 x15a h2d y2d26 ffd fs1e fc2 sc0 ls33 ws0">i<span class="_ _41"></span>n<span class="_ _41"></span>ty=1<span class="_ _41"></span>;</div><div class="t m5 x15a h2d y2d27 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>result<span class="_ _1f"> </span>=<span class="_ _1f"> </span>fp(3,<span class="_ _e"> </span>&amp;y);</div><div class="t m5 x29 h26 y2d28 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _14"> </span>value<span class="_ _16"> </span>of<span class="_ _14"> </span>a<span class="_ _14"> </span>function<span class="_ _16"> </span>pointer<span class="_ _14"> </span>is<span class="_ _16"> </span>the<span class="_ _14"> </span>address<span class="_ _16"> </span>of<span class="_ _14"> </span>the<span class="_ _14"> </span>ﬁrst<span class="_ _16"> </span>instruction<span class="_ _14"> </span>in<span class="_ _16"> </span>the</div><div class="t m5 x29 h26 y2d29 ff7 fs19 fc2 sc0 ls0 ws0">machine-code<span class="_"> </span>representation<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>function.</div><div class="t m5 x28 h2a y2d2a fff fs1c fc2 sc0 ls0 ws0">New<span class="_ _16"> </span>to<span class="_ _16"> </span>C?<span class="_ _1b"> </span><span class="ff6 fs19">Function<span class="_ _11"> </span>pointers</span></div><div class="t m5 x28 h2b y2d2b ff7 fs1e fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>syntax<span class="_ _6"> </span>for<span class="_"> </span>declaring<span class="_ _13"> </span>function<span class="_ _6"> </span>pointers<span class="_"> </span>is<span class="_ _6"> </span>especially<span class="_"> </span>difﬁcult<span class="_ _13"> </span>for<span class="_ _6"> </span>novice<span class="_"> </span>programmers<span class="_ _13"> </span>to<span class="_ _6"> </span>understand.</div><div class="t m5 x28 h2b y2d2c ff7 fs1e fc2 sc0 ls0 ws0">F<span class="_ _1"></span>or<span class="_"> </span>a<span class="_"> </span>declaration<span class="_"> </span>such<span class="_"> </span>as</div><div class="t m5 x24a h2d y2d2d ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>(*f)(int*);</div><div class="t m5 x28 h2b y2d2e ff7 fs1e fc2 sc0 ls0 ws0">it<span class="_"> </span>helps<span class="_"> </span>to<span class="_"> </span>read<span class="_ _10"> </span>it<span class="_ _10"> </span>starting<span class="_"> </span>from<span class="_ _10"> </span>the<span class="_ _10"> </span>inside<span class="_ _10"> </span>(starting<span class="_ _10"> </span>with<span class="_ _10"> </span>‘<span class="ffd">f</span>’)<span class="_ _10"> </span>and<span class="_ _10"> </span>working<span class="_"> </span>outward.<span class="_ _10"> </span>Thus<span class="_ _3"></span>,<span class="_ _10"> </span>we<span class="_ _10"> </span>see<span class="_ _10"> </span>that<span class="_ _10"> </span><span class="ffd">f</span></div><div class="t m5 x28 h2b y2d2f ff7 fs1e fc2 sc0 ls0 ws0">is<span class="_ _10"> </span>a<span class="_ _11"> </span>pointer,<span class="_ _11"> </span>as<span class="_ _10"> </span>indicated<span class="_ _11"> </span>by<span class="_ _11"> </span><span class="ffd">(*f)</span>.<span class="_ _11"> </span>It<span class="_ _10"> </span>is<span class="_ _11"> </span>a<span class="_ _11"> </span>pointer<span class="_ _11"> </span>to<span class="_"> </span>a<span class="_ _11"> </span>function<span class="_ _11"> </span>that<span class="_ _11"> </span>has<span class="_ _10"> </span>a<span class="_ _11"> </span>single<span class="_ _11"> </span><span class="ffd">int<span class="_ _11"> </span>*<span class="_ _11"> </span></span>as<span class="_ _11"> </span>an<span class="_ _10"> </span>argument,</div><div class="t m5 x28 h2b y2d30 ff7 fs1e fc2 sc0 ls0 ws0">as<span class="_ _10"> </span>indicated<span class="_ _11"> </span>by<span class="_ _10"> </span><span class="ffd">(*f)(int*)</span>.<span class="_ _11"> </span>F<span class="_ _0"></span>inally<span class="_ _3"></span>,<span class="_ _11"> </span>we<span class="_"> </span>see<span class="_ _11"> </span>that<span class="_ _11"> </span>it<span class="_"> </span>is<span class="_ _11"> </span>a<span class="_ _10"> </span>pointer<span class="_ _11"> </span>to<span class="_ _11"> </span>a<span class="_"> </span>function<span class="_ _11"> </span>that<span class="_ _11"> </span>takes<span class="_"> </span>an<span class="_ _11"> </span><span class="ffd">int<span class="_ _11"> </span>*<span class="_ _11"> </span></span>as<span class="_ _10"> </span>an</div><div class="t m5 x28 h2b y2d31 ff7 fs1e fc2 sc0 ls0 ws0">argument<span class="_"> </span>and<span class="_"> </span>returns<span class="_"> </span><span class="ffd">int</span>.</div><div class="t m5 x57 h2b y2d32 ff7 fs1e fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>parentheses<span class="_"> </span>around<span class="_"> </span><span class="ffd">*f<span class="_ _10"> </span></span>are<span class="_"> </span>required,<span class="_"> </span>because<span class="_"> </span>otherwise<span class="_"> </span>the<span class="_"> </span>declaration</div><div class="t m5 x24a h2d y2d33 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>*f(int*);</div><div class="t m5 x28 h2b y2d34 ff7 fs1e fc2 sc0 ls0 ws0">would<span class="_"> </span>be<span class="_"> </span>read<span class="_"> </span>as</div><div class="t m5 x24a h2d y2d35 ffd fs1e fc2 sc0 ls0 ws0">(int<span class="_ _e"> </span>*)<span class="_ _1f"> </span>f(int*);</div><div class="t m5 x28 h2b y2d36 ff7 fs1e fc2 sc0 ls0 ws0">T<span class="_ _1"></span>hat<span class="_ _11"> </span>is<span class="_ _1"></span>,<span class="_"> </span>it<span class="_ _11"> </span>would<span class="_"> </span>be<span class="_"> </span>interpreted<span class="_ _11"> </span>as<span class="_"> </span>a<span class="_ _10"> </span>function<span class="_ _11"> </span>prototype<span class="_ _1"></span>,<span class="_ _11"> </span>declaring<span class="_"> </span>a<span class="_ _10"> </span>function<span class="_ _11"> </span><span class="ffd">f<span class="_ _10"> </span></span>that<span class="_"> </span>has<span class="_ _10"> </span>an<span class="_ _11"> </span><span class="ffd">int<span class="_ _11"> </span>*<span class="_ _10"> </span></span>as<span class="_ _10"> </span>its</div><div class="t m5 x28 h2b y2d37 ff7 fs1e fc2 sc0 ls0 ws0">argument<span class="_"> </span>and<span class="_"> </span>returns<span class="_"> </span>an<span class="_"> </span><span class="ffd">int<span class="_ _11"> </span>*</span>.</div><div class="t m5 x57 h2b y2d38 ff7 fs1e fc2 sc0 ls0 ws0">Kernighan<span class="_"> </span>and<span class="_"> </span>Ritchie<span class="_"> </span>[61,<span class="_"> </span>Sect.<span class="_"> </span>5.12]<span class="_"> </span>present<span class="_"> </span>a<span class="_"> </span>helpful<span class="_"> </span>tutorial<span class="_"> </span>on<span class="_"> </span>reading<span class="_"> </span>C<span class="_"> </span>declarations<span class="_ _1"></span>.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
