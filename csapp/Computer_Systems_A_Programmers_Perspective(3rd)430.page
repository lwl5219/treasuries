<div id="pf1ae" class="pf w2 h11" data-page-no="1ae"><div class="pc pc1ae w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1ae.png"/><div class="t m5 x99 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>4.3<span class="_ _60"> </span>Sequential<span class="_ _10"> </span>Y86-64<span class="_ _10"> </span>Implementations<span class="_ _3e"> </span><span class="ffe fs1e">429</span></div><div class="t m5 x17 h31 y390 ff7 fs21 fc2 sc0 ls0 ws0">Stage<span class="_ _55"> </span><span class="ffd fs1e">jXX<span class="_ _11"> </span></span><span class="ff6">Dest<span class="_ _137"> </span><span class="ffd fs1e">call<span class="_ _10"> </span></span>Dest<span class="_ _175"> </span><span class="ffd fs1e">ret</span></span></div><div class="t m5 x17 h32 yc94 ff7 fs21 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>etch<span class="_ _55"> </span><span class="ff6">icode<span class="_ _a"> </span></span>:<span class="_ _be"></span><span class="ff6">ifun<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>M</span></div><div class="t m5 x183 h33 yc95 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x10e h32 yc94 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">PC</span>]<span class="_ _2c"> </span><span class="ff6">icode<span class="_ _a"> </span></span>:<span class="_ _be"></span><span class="ff6">ifun<span class="_ _23"> </span><span class="ff12">←<span class="_ _23"> </span></span>M</span></div><div class="t m5 xff h33 yc95 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x60 h32 yc94 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">PC</span>]<span class="_ _74"> </span><span class="ff6">icode<span class="_ _a"> </span></span>:<span class="_ _be"></span><span class="ff6">ifun<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>M</span></div><div class="t m5 x165 h33 yc95 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x252 h31 yc94 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">PC</span>]</div><div class="t m5 x75 h32 y21d2 ff6 fs21 fc2 sc0 ls0 ws0">valC<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>M</div><div class="t m5 xc1 h33 y21d4 ff7 fs20 fc2 sc0 ls0 ws0">8</div><div class="t m5 x20 h32 y21d3 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">PC<span class="_ _13"> </span><span class="ff12">+<span class="_ _13"> </span></span></span>1]<span class="_ _148"> </span><span class="ff6">valC<span class="_ _25"> </span><span class="ff12">←<span class="_ _25"> </span></span>M</span></div><div class="t m5 x36 h33 y21d4 ff7 fs20 fc2 sc0 ls0 ws0">8</div><div class="t m5 x1c7 h32 y21d3 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">PC<span class="_ _13"> </span><span class="ff12">+<span class="_ _13"> </span></span></span>1]</div><div class="t m5 x75 h32 y3b63 ff6 fs21 fc2 sc0 ls0 ws0">valP<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>PC<span class="_ _13"> </span><span class="ff12">+<span class="_ _13"> </span><span class="ff7">9<span class="_ _169"> </span></span></span>valP<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>PC<span class="_ _13"> </span><span class="ff12">+<span class="_ _10"> </span><span class="ff7">9<span class="_ _65"> </span></span></span>valP<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>PC<span class="_ _10"> </span><span class="ff12">+<span class="_ _13"></span><span class="ff7">1</span></span></div><div class="t m5 x17 h32 y3b64 ff7 fs21 fc2 sc0 ls0 ws0">Decode<span class="_ _1ad"> </span><span class="ff6">valA<span class="_ _25"> </span><span class="ff12">←<span class="_ _25"> </span></span>R</span>[</div><div class="t m5 xea h31 y298b ffd fs1e fc2 sc0 ls0 ws0">%rsp<span class="ff7 fs21">]</span></div><div class="t m5 x88 h32 y3b65 ff6 fs21 fc2 sc0 ls0 ws0">valB<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>R<span class="ff7">[</span></div><div class="t m5 xf4 h32 y298c ffd fs1e fc2 sc0 ls0 ws0">%rsp<span class="ff7 fs21">]<span class="_ _54"> </span><span class="ff6">valB<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>R</span>[</span>%rsp<span class="ff7 fs21">]</span></div><div class="t m5 x17 h32 y3b66 ff7 fs21 fc2 sc0 ls0 ws0">Execute<span class="_ _140"> </span><span class="ff6">valE<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>valB<span class="_ _13"> </span><span class="ff12">+<span class="_ _13"></span><span class="ff11">(</span>−</span></span>8<span class="ff11">)<span class="_ _68"> </span><span class="ff6">valE<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>valB<span class="_ _13"> </span><span class="ff12">+<span class="_ _13"> </span></span></span></span>8</div><div class="t m5 x75 h32 y3b67 ff6 fs21 fc2 sc0 ls0 ws0">Cnd<span class="_ _23"> </span><span class="ff12">←<span class="_ _23"> </span></span>Cond<span class="ff11">(</span>CC<span class="ff11">,<span class="_ _13"> </span></span>ifun<span class="_ _1"></span><span class="ff11">)</span></div><div class="t m5 x17 h31 y3b68 ff7 fs21 fc2 sc0 ls0 ws0">Memory<span class="_ _1ae"> </span><span class="ff6">M</span></div><div class="t m5 x185 h33 y3b69 ff7 fs20 fc2 sc0 ls0 ws0">8</div><div class="t m5 x121 h32 y37bb ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">valE</span>]<span class="_ _22"> </span><span class="ff12">←<span class="_ _25"> </span><span class="ff6">valP<span class="_ _82"> </span>valM<span class="_ _22"> </span></span>←<span class="_ _25"> </span><span class="ff6">M</span></span></div><div class="t m5 x6e h33 y3b69 ff7 fs20 fc2 sc0 ls0 ws0">8</div><div class="t m5 x20f h31 y37bb ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">valA<span class="_ _2"></span></span>]</div><div class="t m5 x17 h31 y3b6a ff7 fs21 fc2 sc0 ls0 ws0">Write<span class="_"> </span>back<span class="_ _1af"> </span><span class="ff6">R</span>[</div><div class="t m5 x185 h2d y3b6b ffd fs1e fc2 sc0 ls0 ws0">%rsp</div><div class="t m5 x13d h32 y3b6c ff7 fs21 fc2 sc0 ls0 ws0">]<span class="_ _22"> </span><span class="ff12">←<span class="_ _25"> </span><span class="ff6">valE<span class="_ _121"> </span>R</span></span>[<span class="ffd fs1e">%rsp</span>]<span class="_ _23"> </span><span class="ff12">←<span class="_ _23"> </span><span class="ff6">valE</span></span></div><div class="t m5 x17 h32 y3b6d ff7 fs21 fc2 sc0 ls0 ws0">PC<span class="_"> </span>update<span class="_ _45"> </span><span class="ff6">PC<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>Cnd<span class="_ _13"> </span></span>?<span class="_ _6"> </span><span class="ff6">valC<span class="_ _13"> </span></span>:<span class="_ _13"> </span><span class="ff6">valP<span class="_ _45"> </span>PC<span class="_ _25"> </span><span class="ff12">←<span class="_ _25"> </span></span>valC<span class="_ _9d"> </span>PC<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>valM</span></div><div class="t m5 x17 h3a y3b6e ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _11"> </span>4.21<span class="_ _c"> </span><span class="fc1">Computations<span class="_ _16"> </span>in<span class="_ _16"> </span>sequential<span class="_ _11"> </span>implementation<span class="_ _16"> </span>of<span class="_ _16"> </span>Y86-64<span class="_ _11"> </span>instructions<span class="_ _16"> </span><span class="ffd fs19">jXX</span>,<span class="_ _16"> </span><span class="ffd fs19">call</span>,<span class="_ _16"> </span>and<span class="_ _11"> </span><span class="ffd fs19">ret</span>.</span></div><div class="t m5 x17 h34 y3b6f ff6 fs16 fc1 sc0 ls0 ws0">These<span class="_ _10"> </span>instructions<span class="_ _11"> </span>cause<span class="_ _10"> </span>control<span class="_ _10"> </span>transfers.</div><div class="t m5 x17 h47 y3b70 ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>4.17<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>522)</span></div><div class="t m5 x17 h26 y3b71 ff7 fs19 fc1 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_ _15"> </span>can<span class="_ _14"> </span>see<span class="_ _15"> </span>by<span class="_ _14"> </span>the<span class="_ _15"> </span>instruction<span class="_ _14"> </span>encodings<span class="_ _15"> </span>(F<span class="_ _0"></span>igures<span class="_ _14"> </span>4.2<span class="_ _15"> </span>and<span class="_ _14"> </span>4.3)<span class="_ _15"> </span>that<span class="_ _14"> </span>the<span class="_ _15"> </span><span class="ffd">rrmovq</span></div><div class="t m5 x17 h26 y3b72 ff7 fs19 fc1 sc0 ls0 ws0">instruction<span class="_ _14"> </span>is<span class="_ _15"> </span>the<span class="_ _15"> </span>unconditional<span class="_ _15"> </span>version<span class="_ _15"> </span>of<span class="_ _15"> </span>a<span class="_ _15"> </span>more<span class="_ _14"> </span>general<span class="_ _15"> </span>class<span class="_ _15"> </span>of<span class="_ _15"> </span>instructions</div><div class="t m5 x17 h26 y3b73 ff7 fs19 fc1 sc0 ls0 ws0">that<span class="_ _13"> </span>include<span class="_"> </span>the<span class="_ _13"> </span>conditional<span class="_"> </span>moves<span class="_ _3"></span>.<span class="_"> </span>Show<span class="_ _13"> </span>how<span class="_"> </span>you<span class="_ _13"> </span>would<span class="_ _13"> </span>modify<span class="_"> </span>the<span class="_ _13"> </span>steps<span class="_"> </span>for<span class="_ _13"> </span>the</div><div class="t m5 x17 h26 y3b74 ffd fs19 fc1 sc0 ls0 ws0">rrmovq<span class="_ _15"> </span><span class="ff7">instruction<span class="_ _14"> </span>below<span class="_ _15"> </span>to<span class="_ _15"> </span>also<span class="_ _15"> </span>handle<span class="_ _15"> </span>the<span class="_ _15"> </span>six<span class="_ _15"> </span>conditional<span class="_ _15"> </span>move<span class="_ _15"> </span>instructions<span class="_ _1"></span>.</span></div><div class="t m5 x17 h26 y3b75 ff7 fs19 fc1 sc0 ls0 ws0">Y<span class="_ _3"></span>ou<span class="_ _15"> </span>may<span class="_ _15"> </span>ﬁnd<span class="_ _15"> </span>it<span class="_ _21"> </span>useful<span class="_ _15"> </span>to<span class="_ _15"> </span>see<span class="_ _21"> </span>how<span class="_ _15"> </span>the<span class="_ _15"> </span>implementation<span class="_ _21"> </span>of<span class="_ _15"> </span>the<span class="_ _15"> </span><span class="ffd">jXX<span class="_ _21"> </span></span>instructions</div><div class="t m5 x17 h26 y3b76 ff7 fs19 fc1 sc0 ls0 ws0">(F<span class="_ _1"></span>igure<span class="_"> </span>4.21)<span class="_"> </span>handles<span class="_"> </span>conditional<span class="_"> </span>behavior.</div><div class="t m5 x17 h31 y3b77 ff7 fs21 fc2 sc0 ls0 ws0">Stage<span class="_ _55"> </span><span class="ffd fs1e">cmovXX<span class="_ _11"> </span></span><span class="ff6">rA<span class="ffd fs1e">,<span class="_ _11"> </span></span>rB</span></div><div class="t m5 x17 h32 y3b78 ff7 fs21 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>etch<span class="_ _55"> </span><span class="ff6">icode<span class="_ _a"> </span></span>:<span class="_ _be"></span><span class="ff6">ifun<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>M</span></div><div class="t m5 x183 h33 y3b79 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x10e h31 y3b78 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">PC</span>]</div><div class="t m5 x75 h32 y3b7a ff6 fs21 fc2 sc0 ls0 ws0">rA<span class="_ _6"> </span><span class="ff7">:<span class="_ _be"></span></span>rB<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>M</div><div class="t m5 x7a h33 y3b7b ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x1a5 h32 y631 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">PC<span class="_ _13"> </span><span class="ff12">+<span class="_ _13"> </span></span></span>1]</div><div class="t m5 x75 h32 y3b7c ff6 fs21 fc2 sc0 ls0 ws0">valP<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>PC<span class="_ _13"> </span><span class="ff12">+<span class="_ _13"> </span><span class="ff7">2</span></span></div><div class="t m5 x17 h32 y3b7d ff7 fs21 fc2 sc0 ls0 ws0">Decode<span class="_ _bd"> </span><span class="ff6">valA<span class="_ _25"> </span><span class="ff12">←<span class="_ _25"> </span></span>R</span>[<span class="ff6">rA<span class="_ _2"></span></span>]</div><div class="t m5 x17 h32 y3b7e ff7 fs21 fc2 sc0 ls0 ws0">Execute<span class="_ _f4"> </span><span class="ff6">valE<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span></span>0<span class="_"> </span><span class="ff12">+<span class="_ _13"> </span><span class="ff6">valA</span></span></div><div class="t m5 x17 h31 y3b7f ff7 fs21 fc2 sc0 ls0 ws0">Memory</div><div class="t m5 x17 h31 y3b80 ff7 fs21 fc2 sc0 ls0 ws0">Write<span class="_"> </span>back</div><div class="t m5 x75 h32 y3b81 ff6 fs21 fc2 sc0 ls0 ws0">R<span class="ff7">[</span>rB<span class="ff7">]<span class="_ _22"> </span><span class="ff12">←<span class="_ _25"> </span></span></span>valE</div><div class="t m5 x17 h32 y3b82 ff7 fs21 fc2 sc0 ls0 ws0">PC<span class="_"> </span>update<span class="_ _45"> </span><span class="ff6">PC<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>valP</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
