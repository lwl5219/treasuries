<div id="pf131" class="pf w2 h11" data-page-no="131"><div class="pc pc131 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg131.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">304<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>3<span class="_ _3d"> </span>Machine-Level<span class="_ _10"> </span>Representation<span class="_ _10"> </span>of<span class="_ _10"> </span>Programs</span></div><div class="t m5 x1d h47 yb1f ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>3.41<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>379)</span></div><div class="t m5 x1d h26 yb20 ff7 fs19 fc1 sc0 ls0 ws0">Consider<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>structure<span class="_"> </span>declaration:</div><div class="t m5 x1d h2d y2be5 ffd fs1e fc2 sc0 ls0 ws0">struct<span class="_ _e"> </span>test<span class="_ _1f"> </span>{</div><div class="t m5 x10c h2d y2be6 ffd fs1e fc2 sc0 ls0 ws0">short<span class="_ _e"> </span>*p;</div><div class="t m5 x10c h2d y2be7 ffd fs1e fc2 sc0 ls0 ws0">struct<span class="_ _e"> </span>{</div><div class="t m5 x22b h2d y2be8 ffd fs1e fc2 sc0 ls0 ws0">short<span class="_ _e"> </span>x;</div><div class="t m5 x22b h2d y2be9 ffd fs1e fc2 sc0 ls0 ws0">short<span class="_ _e"> </span>y;</div><div class="t m5 x10c h2d y2bea ffd fs1e fc2 sc0 ls33 ws0">}s<span class="_ _41"></span>;</div><div class="t m5 x10c h2d y2beb ffd fs1e fc2 sc0 ls0 ws0">struct<span class="_ _e"> </span>test<span class="_ _1f"> </span>*next;</div><div class="t m5 x1d h2d y2bec ffd fs1e fc2 sc0 ls0 ws0">};</div><div class="t m5 x1d h26 y2bed ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _16"> </span>declaration<span class="_ _16"> </span>illustrates<span class="_ _16"> </span>that<span class="_ _16"> </span>one<span class="_ _16"> </span>structure<span class="_ _16"> </span>can<span class="_ _16"> </span>be<span class="_ _14"> </span>embedded<span class="_ _16"> </span>within<span class="_ _16"> </span>another,</div><div class="t m5 x1d h26 y2bee ff7 fs19 fc2 sc0 ls0 ws0">just<span class="_ _14"> </span>as<span class="_ _14"> </span>arrays<span class="_ _14"> </span>can<span class="_ _14"> </span>be<span class="_ _14"> </span>embedded<span class="_ _14"> </span>within<span class="_ _14"> </span>structures<span class="_ _14"> </span>and<span class="_ _15"> </span>arrays<span class="_ _14"> </span>can<span class="_ _14"> </span>be<span class="_ _14"> </span>embedded</div><div class="t m5 x1d h26 y2bef ff7 fs19 fc2 sc0 ls0 ws0">within<span class="_"> </span>arrays<span class="_ _1"></span>.</div><div class="t m5 x29 h26 y2bf0 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _14"> </span>following<span class="_ _14"> </span>procedure<span class="_ _14"> </span>(with<span class="_ _14"> </span>some<span class="_ _14"> </span>expressions<span class="_ _14"> </span>omitted)<span class="_ _14"> </span>operates<span class="_ _14"> </span>on<span class="_ _14"> </span>this</div><div class="t m5 x1d h26 y2bf1 ff7 fs19 fc2 sc0 ls0 ws0">structure:</div><div class="t m5 x1d h2d y2bf2 ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>st_init(struct<span class="_ _1f"> </span>test<span class="_ _1f"> </span>*st)<span class="_ _e"> </span>{</div><div class="t m5 x10c h2d y2bf3 ffd fs1e fc2 sc0 ls0 ws0">st-&gt;s.y<span class="_ _1a"> </span>=</div><div class="t m5 x1d1 h2d y2bf4 ffd fs1e fc2 sc0 ls0 ws0">;</div><div class="t m5 x10c h2d y2bf5 ffd fs1e fc2 sc0 ls0 ws0">st-&gt;p<span class="_ _46"> </span>=</div><div class="t m5 x1d1 h2d y2bf6 ffd fs1e fc2 sc0 ls0 ws0">;</div><div class="t m5 x10c h2d y2bf7 ffd fs1e fc2 sc0 ls0 ws0">st-&gt;next<span class="_ _e"> </span>=</div><div class="t m5 x1d1 h2d y2bf8 ffd fs1e fc2 sc0 ls0 ws0">;</div><div class="t m5 x1d h2d y2bf9 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x124 h26 y2bfa ff7 fs19 fc2 sc0 ls0 ws0">A.<span class="_ _1f"> </span>What<span class="_"> </span>are<span class="_"> </span>the<span class="_"> </span>offsets<span class="_"> </span>(in<span class="_"> </span>bytes)<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>ﬁelds?</div><div class="t m5 x1c4 h31 y2bfb ffd fs1e fc2 sc0 ls0 ws0">p<span class="ff7 fs21">:</span></div><div class="t m5 xc2 h31 y2bfc ffd fs1e fc1 sc0 ls0 ws0">s.x<span class="ff7 fs21">:</span></div><div class="t m5 xc2 h31 y2bfd ffd fs1e fc1 sc0 ls0 ws0">s.y<span class="ff7 fs21">:</span></div><div class="t m5 x4f h31 y2bfe ffd fs1e fc1 sc0 ls0 ws0">next<span class="ff7 fs21">:</span></div><div class="t m5 x124 h26 y2bff ff7 fs19 fc1 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>How<span class="_"> </span>many<span class="_"> </span>total<span class="_"> </span>bytes<span class="_"> </span>does<span class="_"> </span>the<span class="_"> </span>structure<span class="_"> </span>require?</div><div class="t m5 x124 h26 y2c00 ff7 fs19 fc1 sc0 ls0 ws0">C.<span class="_ _25"> </span>T<span class="_ _1"></span>he<span class="_"> </span>compiler<span class="_"> </span>generates<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>assembly<span class="_"> </span>code<span class="_"> </span>for<span class="_"> </span><span class="ffd">st_init</span>:</div><div class="t m5 x1a8 h61 y2c01 ff13 fs35 fc6 sc0 ls0 ws0">void<span class="_ _f"> </span>st_init(struct<span class="_ _f"> </span>test<span class="_ _f"> </span>*st)</div><div class="t m5 x1a8 h61 y2c02 ff13 fs35 fc6 sc0 ls0 ws0">st<span class="_ _f"> </span>in<span class="_ _f"> </span>%rdi</div><div class="t m5 x207 h2d y2c03 ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">st_init:</span></div><div class="t m5 x207 h2d y2c04 ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _45"> </span><span class="ffd fs1e fc2">movl<span class="_ _46"> </span>8(%rdi),<span class="_ _e"> </span>%eax</span></div><div class="t m5 x207 h2e y2c05 ff6 fs20 fc6 sc0 ls0 ws0">3</div><div class="t m5 x112 h2d y2c06 ffd fs1e fc2 sc0 ls0 ws0">movl<span class="_ _46"> </span>%eax,<span class="_ _e"> </span>10(%rdi)</div><div class="t m5 x207 h2d y2c07 ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _45"> </span><span class="ffd fs1e fc2">leaq<span class="_ _46"> </span>10(%rdi),<span class="_ _e"> </span>%rax</span></div><div class="t m5 x207 h2d y2c08 ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _45"> </span><span class="ffd fs1e fc2">movq<span class="_ _46"> </span>%rax,<span class="_ _e"> </span>(%rdi)</span></div><div class="t m5 x207 h2d y2c09 ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _45"> </span><span class="ffd fs1e fc2">movq<span class="_ _46"> </span>%rdi,<span class="_ _e"> </span>12(%rdi)</span></div><div class="t m5 x207 h2d y2c0a ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _45"> </span><span class="ffd fs1e fc2">ret</span></div><div class="t m5 x4f h26 y28e1 ff7 fs19 fc2 sc0 ls0 ws0">On<span class="_ _11"> </span>the<span class="_ _16"> </span>basis<span class="_ _11"> </span>of<span class="_ _11"> </span>this<span class="_ _16"> </span>information,<span class="_ _16"> </span>ﬁll<span class="_ _11"> </span>in<span class="_ _11"> </span>the<span class="_ _16"> </span>missing<span class="_ _11"> </span>expressions<span class="_ _16"> </span>in<span class="_ _11"> </span>the<span class="_ _11"> </span>code</div><div class="t m5 x4f h26 y28e2 ff7 fs19 fc2 sc0 ls0 ws0">for<span class="_"> </span><span class="ffd">st_init</span>.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
