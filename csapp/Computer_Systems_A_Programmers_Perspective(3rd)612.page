<div id="pf264" class="pf w2 h11" data-page-no="264"><div class="pc pc264 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg264.png"/><div class="t m5 x107 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Solutions<span class="_ _10"> </span>to<span class="_ _10"> </span>Practice<span class="_ _10"> </span>Problems<span class="_ _1b"> </span><span class="ffe fs1e">611</span></div><div class="t m5 x2d h26 y9c ff7 fs19 fc2 sc0 ls0 ws0">at<span class="_ _16"> </span>the<span class="_ _14"> </span>end<span class="_ _14"> </span>of<span class="_ _14"> </span>the<span class="_ _14"> </span>previous<span class="_ _16"> </span>iteration.<span class="_ _14"> </span>Therefore<span class="_ _1"></span>,<span class="_ _14"> </span>the<span class="_ _14"> </span>combining<span class="_ _14"> </span>instruction</div><div class="t m5 x2d h26 y409 ff7 fs19 fc2 sc0 ls0 ws0">can<span class="_"> </span>simply<span class="_"> </span>use<span class="_"> </span>the<span class="_"> </span>value<span class="_"> </span>already<span class="_"> </span>in<span class="_"> </span><span class="ffd">%xmm0<span class="_ _10"> </span></span>at<span class="_"> </span>the<span class="_"> </span>beginning<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>loop<span class="_ _1"></span>.</div><div class="t m5 x17 h28 y51d3 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>5.5<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>566)</span></div><div class="t m5 x17 h26 y51d4 ff7 fs19 fc1 sc0 ls0 ws0">P<span class="_ _1"></span>olynomial<span class="_ _6"> </span>evaluation<span class="_ _6"> </span>is<span class="_ _6"> </span>a<span class="_ _6"> </span>core<span class="_ _6"> </span>technique<span class="_ _6"> </span>for<span class="_ _6"> </span>solving<span class="_ _6"> </span>many<span class="_ _6"> </span>problems<span class="_ _1"></span>.<span class="_ _6"> </span>F<span class="_ _1"></span>or<span class="_ _6"> </span>example<span class="_ _0"></span>,</div><div class="t m5 x17 h26 y51d5 ff7 fs19 fc1 sc0 ls0 ws0">polynomial<span class="_ _13"> </span>functions<span class="_ _13"> </span>are<span class="_ _13"> </span>commonly<span class="_ _13"> </span>used<span class="_ _13"> </span>to<span class="_ _13"> </span>approximate<span class="_ _13"> </span>trigonometric<span class="_ _13"> </span>functions</div><div class="t m5 x17 h26 y51d6 ff7 fs19 fc1 sc0 ls0 ws0">in<span class="_"> </span>math<span class="_"> </span>libraries<span class="_ _1"></span>.</div><div class="t m5 x34 h26 y51d7 ff7 fs19 fc1 sc0 ls0 ws0">A.<span class="_ _1f"> </span>T<span class="_ _1"></span>he<span class="_"> </span>function<span class="_"> </span>performs<span class="_"> </span>2<span class="ff11">n<span class="_ _11"> </span></span>multiplications<span class="_"> </span>and<span class="_"> </span><span class="ff11">n<span class="_ _10"> </span></span>additions<span class="_ _1"></span>.</div><div class="t m5 x34 h26 y51d8 ff7 fs19 fc1 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>W<span class="_ _1"></span>e<span class="_"> </span>can<span class="_"> </span>see<span class="_ _13"> </span>that<span class="_"> </span>the<span class="_"> </span>performance-limiting<span class="_"> </span>computation<span class="_"> </span>here<span class="_"> </span>is<span class="_ _13"> </span>the<span class="_"> </span>repeated</div><div class="t m5 x2d h26 y51d9 ff7 fs19 fc1 sc0 ls0 ws0">computation<span class="_ _21"> </span>of<span class="_ _21"> </span>the<span class="_ _21"> </span>expression<span class="_ _f"> </span><span class="ffd ls4b">x<span class="_ _49"></span>p<span class="_ _49"></span>w<span class="_ _42"></span>r=x*<span class="ls0">xpwr<span class="ff7">.<span class="_ _f"> </span>T<span class="_ _1"></span>his<span class="_ _f"> </span>requires<span class="_ _21"> </span>a<span class="_ _21"> </span>ﬂoating-</span></span></span></div><div class="t m5 x2d h26 y51da ff7 fs19 fc1 sc0 ls0 ws0">point<span class="_"> </span>multiplication<span class="_"> </span>(5<span class="_ _11"> </span>clock<span class="_"> </span>cycles),<span class="_"> </span>and<span class="_"> </span>the<span class="_ _11"> </span>computation<span class="_"> </span>for<span class="_"> </span>one<span class="_ _11"> </span>iteration</div><div class="t m5 x2d h26 y51db ff7 fs19 fc1 sc0 ls0 ws0">cannot<span class="_ _14"> </span>begin<span class="_ _15"> </span>until<span class="_ _15"> </span>the<span class="_ _14"> </span>one<span class="_ _15"> </span>for<span class="_ _15"> </span>the<span class="_ _14"> </span>previous<span class="_ _15"> </span>iteration<span class="_ _15"> </span>has<span class="_ _14"> </span>completed.<span class="_ _15"> </span>T<span class="_ _0"></span>he</div><div class="t m5 x2d h26 y51dc ff7 fs19 fc1 sc0 ls0 ws0">updating<span class="_ _11"> </span>of<span class="_ _16"> </span><span class="ffd">result<span class="_ _16"> </span></span>only<span class="_ _11"> </span>requires<span class="_ _16"> </span>a<span class="_ _11"> </span>ﬂoating-point<span class="_ _16"> </span>addition<span class="_ _11"> </span>(3<span class="_ _16"> </span>clock<span class="_ _11"> </span>cycles)</div><div class="t m5 x2d h26 y51dd ff7 fs19 fc1 sc0 ls0 ws0">between<span class="_"> </span>successive<span class="_"> </span>iterations<span class="_ _1"></span>.</div><div class="t m5 x17 h28 y51de ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>5.6<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>566)</span></div><div class="t m5 x17 h26 y51df ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _11"> </span>problem<span class="_ _16"> </span>demonstrates<span class="_ _11"> </span>that<span class="_ _11"> </span>minimizing<span class="_ _11"> </span>the<span class="_ _11"> </span>number<span class="_ _16"> </span>of<span class="_"> </span>operations<span class="_ _16"> </span>in<span class="_"> </span>a<span class="_ _16"> </span>com-</div><div class="t m5 x17 h26 y51e0 ff7 fs19 fc1 sc0 ls0 ws0">putation<span class="_"> </span>may<span class="_"> </span>not<span class="_"> </span>improve<span class="_"> </span>its<span class="_"> </span>performance<span class="_ _1"></span>.</div><div class="t m5 x34 h26 y51e1 ff7 fs19 fc1 sc0 ls0 ws0">A.<span class="_ _1f"> </span>T<span class="_ _1"></span>he<span class="_"> </span>function<span class="_ _13"> </span>performs<span class="_"> </span><span class="ff11">n<span class="_ _13"> </span></span>multiplications<span class="_"> </span>and<span class="_ _13"> </span><span class="ff11">n<span class="_ _10"> </span></span>additions<span class="_ _1"></span>,<span class="_"> </span>half<span class="_ _13"> </span>the<span class="_"> </span>number<span class="_ _13"> </span>of</div><div class="t m5 x2d h26 y51e2 ff7 fs19 fc1 sc0 ls0 ws0">multiplications<span class="_"> </span>as<span class="_"> </span>the<span class="_"> </span>original<span class="_"> </span>function<span class="_"> </span><span class="ffd">poly</span>.</div><div class="t m5 x34 h26 y51e3 ff7 fs19 fc1 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>W<span class="_ _1"></span>e<span class="_"> </span>can<span class="_"> </span>see<span class="_ _13"> </span>that<span class="_"> </span>the<span class="_"> </span>performance-limiting<span class="_"> </span>computation<span class="_"> </span>here<span class="_"> </span>is<span class="_ _13"> </span>the<span class="_"> </span>repeated</div><div class="t m5 x2d h26 y51e4 ff7 fs19 fc1 sc0 ls0 ws0">computation<span class="_ _6"> </span>of<span class="_ _6"> </span>the<span class="_ _6"> </span>expression<span class="_ _13"> </span><span class="ffd">result<span class="_ _11"> </span>=<span class="_ _16"> </span>a[i]<span class="_ _11"> </span>+<span class="_ _16"> </span>x*result</span>.<span class="_ _6"> </span>Starting<span class="_ _6"> </span>from<span class="_ _13"> </span>the</div><div class="t m5 x2d h26 y51e5 ff7 fs19 fc1 sc0 ls0 ws0">value<span class="_ _13"> </span>of<span class="_"> </span><span class="ffd">result<span class="_ _13"> </span></span>from<span class="_"> </span>the<span class="_ _13"> </span>previous<span class="_"> </span>iteration,<span class="_ _13"> </span>we<span class="_"> </span>must<span class="_ _13"> </span>ﬁrst<span class="_"> </span>multiply<span class="_ _13"> </span>it<span class="_"> </span>by<span class="_ _13"> </span><span class="ffd">x<span class="_ _10"> </span></span>(5</div><div class="t m5 x2d h26 y51e6 ff7 fs19 fc1 sc0 ls0 ws0">clock<span class="_"> </span>c<span class="_ _1"></span>ycles)<span class="_"> </span>and<span class="_"> </span>then<span class="_ _13"> </span>add<span class="_"> </span>it<span class="_"> </span>to<span class="_ _13"> </span><span class="ffd">a[i]<span class="_ _10"> </span></span>(3<span class="_"> </span>cycles)<span class="_ _13"> </span>before<span class="_"> </span>we<span class="_"> </span>have<span class="_ _13"> </span>the<span class="_"> </span>value<span class="_ _13"> </span>for</div><div class="t m5 x2d h26 y51e7 ff7 fs19 fc1 sc0 ls0 ws0">this<span class="_ _16"> </span>iteration.<span class="_ _16"> </span>T<span class="_ _1"></span>hus<span class="_ _1"></span>,<span class="_ _14"> </span>each<span class="_ _16"> </span>iteration<span class="_ _16"> </span>imposes<span class="_ _16"> </span>a<span class="_ _11"> </span>minimum<span class="_ _16"> </span>latency<span class="_ _16"> </span>of<span class="_ _16"> </span>8<span class="_ _16"> </span>cycles<span class="_ _3"></span>,</div><div class="t m5 x2d h26 y51e8 ff7 fs19 fc1 sc0 ls0 ws0">exactly<span class="_"> </span>our<span class="_"> </span>measured<span class="_"> </span>CPE.</div><div class="t m5 x34 h26 y51e9 ff7 fs19 fc1 sc0 ls0 ws0">C.<span class="_ _25"> </span>Although<span class="_ _13"> </span>each<span class="_ _6"> </span>iteration<span class="_ _13"> </span>in<span class="_ _13"> </span>function<span class="_ _13"> </span><span class="ffd">poly<span class="_ _6"> </span></span>requires<span class="_ _13"> </span>two<span class="_ _13"> </span>multiplications<span class="_ _6"> </span>rather</div><div class="t m5 x2d h26 y51ea ff7 fs19 fc1 sc0 ls0 ws0">than<span class="_ _f"> </span>one<span class="_ _0"></span>,<span class="_ _e"> </span>only<span class="_ _f"> </span>a<span class="_ _f"> </span>single<span class="_ _f"> </span>multiplication<span class="_ _f"> </span>occurs<span class="_ _e"> </span>along<span class="_ _21"> </span>the<span class="_ _f"> </span>critical<span class="_ _f"> </span>path<span class="_ _e"> </span>per</div><div class="t m5 x2d h26 y51eb ff7 fs19 fc1 sc0 ls0 ws0">iteration.</div><div class="t m5 x17 h28 y51ec ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>5.7<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>568)</span></div><div class="t m5 x17 h26 y51ed ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _11"> </span>following<span class="_ _11"> </span>code<span class="_ _11"> </span>directly<span class="_ _11"> </span>follows<span class="_ _11"> </span>the<span class="_"> </span>rules<span class="_ _11"> </span>we<span class="_ _11"> </span>have<span class="_ _11"> </span>stated<span class="_ _11"> </span>for<span class="_ _11"> </span>unrolling<span class="_ _11"> </span>a<span class="_ _11"> </span>loop</div><div class="t m5 x17 h26 y51ee ff7 fs19 fc1 sc0 ls0 ws0">by<span class="_"> </span>some<span class="_"> </span>factor<span class="_"> </span><span class="ff11">k<span class="_ _2"></span></span>:</div><div class="t m5 x2c h2d y211a ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">void<span class="_ _1f"> </span>unroll5(vec_ptr<span class="_ _e"> </span>v,<span class="_ _1f"> </span>data_t<span class="_ _1f"> </span>*dest)</span></div><div class="t m5 x2c h2d yc47 ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x2c h2d y2767 ff6 fs20 fc6 sc0 ls0 ws0">3<span class="_ _20"> </span><span class="ffd fs1e fc2">long<span class="_ _e"> </span>i;</span></div><div class="t m5 x2c h2d y24e1 ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _20"> </span><span class="ffd fs1e fc2">long<span class="_ _e"> </span>length<span class="_ _1f"> </span>=<span class="_ _1f"> </span>vec_length(v);</span></div><div class="t m5 x2c h2d y543 ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _20"> </span><span class="ffd fs1e fc2">long<span class="_ _e"> </span>limit<span class="_ _1f"> </span>=<span class="_ _1f"> </span>length-4;</span></div><div class="t m5 x2c h2d ye14 ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _20"> </span><span class="ffd fs1e fc2">data_t<span class="_ _e"> </span>*data<span class="_ _1f"> </span>=<span class="_ _1f"> </span>get_vec_start(v);</span></div><div class="t m5 x2c h2d yeef ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _20"> </span><span class="ffd fs1e fc2">data_t<span class="_ _e"> </span>acc<span class="_ _1f"> </span>=<span class="_ _1f"> </span>IDENT;</span></div><div class="t m5 x2c h2e yd7a ff6 fs20 fc6 sc0 ls0 ws0">8</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
