<div id="pf355" class="pf w2 h11" data-page-no="355"><div class="pc pc355 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg355.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">852<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>9<span class="_ _3d"> </span>Virtual<span class="_ _10"> </span>Memory</span></div><div class="t m5 x9b h3f y6e2b ffad fs27 fc1 sc0 ls0 ws0">5</div><div class="t m5 x1d h3f y6e2c ffad fs27 fc1 sc0 ls0 ws0">CPU chip </div><div class="t m5 xf6 h3f y6e2d ffad fs27 fc1 sc0 ls0 ws0">Processor</div><div class="t m5 xfa h3f y6e2e ffad fs27 fc1 sc0 ls0 ws0">MMU</div><div class="t m5 xb3 h3f y6e2f ffad fs27 fc1 sc0 ls56 ws0">VA</div><div class="t m5 x117 h3f y6e30 ffad fs27 fc1 sc0 ls0 ws0">Data</div><div class="t m5 x22 h3f y6e31 ffad fs27 fc1 sc0 ls0 ws0">(a) Page hit</div><div class="t m5 x215 h3f y6e32 ffad fs27 fc1 sc0 ls56 ws0">PA</div><div class="t m5 x139 h3f y6e33 ffad fs27 fc1 sc0 ls0 ws0">PTE</div><div class="t m5 xd2 h3f y6e34 ffad fs27 fc1 sc0 ls0 ws0">PTEA</div><div class="t m5 x118 h3f y6e35 ffad fs27 fc1 sc0 ls0 ws0">2</div><div class="t m5 x21d h3f y6e36 ffad fs27 fc1 sc0 ls0 ws0">1</div><div class="t m5 x118 h3f y6e37 ffad fs27 fc1 sc0 ls0 ws0">3</div><div class="t m5 x118 h3f y6e38 ffad fs27 fc1 sc0 ls0 ws0">4</div><div class="t m5 x51 h3f y6e39 ffad fs27 fc1 sc0 ls0 ws0">Cache/</div><div class="t m5 xfb h3f y6e3a ffad fs27 fc1 sc0 ls0 ws0">memory</div><div class="t m5 x1d h3f y6e3b ffad fs27 fc1 sc0 ls0 ws0">CPU chip </div><div class="t m5 xf6 h3f y6e3c ffad fs27 fc1 sc0 ls0 ws0">Processor</div><div class="t m5 xfa h3f y6e3d ffad fs27 fc1 sc0 ls0 ws0">MMU<span class="_ _214"> </span>Disk</div><div class="t m5 xb3 h3f y6e3e ffad fs27 fc1 sc0 ls56 ws0">VA</div><div class="t m5 x139 h3f y6e3f ffad fs27 fc1 sc0 ls0 ws0">PTE</div><div class="t m5 x2b h3f y6e40 ffad fs27 fc1 sc0 ls0 ws0">Victim page</div><div class="t m5 xde h3f y6e41 ffad fs27 fc1 sc0 ls0 ws0">New page</div><div class="t m5 xd2 h3f y6e42 ffad fs27 fc1 sc0 ls0 ws0">PTEA</div><div class="t m5 x118 h3f y6e43 ffad fs27 fc1 sc0 ls0 ws0">2</div><div class="t m5 x7b h3f y6e44 ffad fs27 fc1 sc0 ls0 ws0">Exception</div><div class="t m5 x187 h3f y6e45 ffad fs27 fc1 sc0 ls0 ws0">4</div><div class="t m5 x21d h3f y6e46 ffad fs27 fc1 sc0 ls0 ws0">1</div><div class="t m5 x21d h3f y6e47 ffad fs27 fc1 sc0 ls0 ws0">7</div><div class="t m5 x18c h3f y6e48 ffad fs27 fc1 sc0 ls0 ws0">5</div><div class="t m5 x1c3 h3f y6e49 ffad fs27 fc1 sc0 ls0 ws0">6</div><div class="t m5 x118 h3f y6e4a ffad fs27 fc1 sc0 ls0 ws0">3</div><div class="t m5 x51 h3f y6e4b ffad fs27 fc1 sc0 ls0 ws0">Cache/</div><div class="t m5 xfb h3f y6e4c ffad fs27 fc1 sc0 ls0 ws0">memory</div><div class="t m5 x12e h3f y6e4d ffad fs27 fc1 sc0 ls0 ws0">Page fault exception handler</div><div class="t m5 x69 h3f y6e4e ffad fs27 fc1 sc0 ls0 ws0">(b) Page fault</div><div class="t m5 x1d h34 y6e4f ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _13"> </span>9.13<span class="_ _c"> </span><span class="fc1">Operational<span class="_ _10"> </span>view<span class="_ _13"> </span>of<span class="_ _13"> </span>page<span class="_ _10"> </span>hits<span class="_ _13"> </span>and<span class="_ _13"> </span>page<span class="_ _10"> </span>faults.<span class="_ _13"> </span><span class="ff6">V<span class="_ _1"></span>A:<span class="_ _13"> </span>virtual<span class="_ _10"> </span>address.<span class="_ _13"> </span>PTEA:</span></span></div><div class="t m5 x1d h34 y6e50 ff6 fs16 fc1 sc0 ls0 ws0">page<span class="_ _10"> </span>table<span class="_ _11"> </span>entry<span class="_ _10"> </span>address.<span class="_ _11"> </span>PTE:<span class="_ _10"> </span>page<span class="_ _11"> </span>table<span class="_ _10"> </span>entry<span class="_ _1"></span>.<span class="_ _11"> </span>P<span class="_ _3"></span>A:<span class="_ _11"> </span>physical<span class="_ _10"> </span>address.</div><div class="t m5 x75 h26 y6e51 ffa fs19 fc1 sc0 ls0 ws0">Step<span class="_ _16"> </span>7.<span class="_ _f"> </span><span class="ff7">T<span class="_ _1"></span>he<span class="_ _14"> </span>fault<span class="_ _14"> </span>handler<span class="_ _16"> </span>returns<span class="_ _14"> </span>to<span class="_ _14"> </span>the<span class="_ _16"> </span>original<span class="_ _14"> </span>process<span class="_ _1"></span>,<span class="_ _14"> </span>causing<span class="_ _14"> </span>the<span class="_ _14"> </span>faulting</span></div><div class="t m5 xcd h26 y6e52 ff7 fs19 fc1 sc0 ls0 ws0">instruction<span class="_ _6"> </span>to<span class="_ _13"> </span>be<span class="_ _a"> </span>restarted.<span class="_ _13"> </span>T<span class="_ _1"></span>he<span class="_ _6"> </span>CPU<span class="_ _13"> </span>resends<span class="_ _a"> </span>the<span class="_ _13"> </span>offending<span class="_ _6"> </span>virtual<span class="_ _6"> </span>address</div><div class="t m5 xcd h26 y6e53 ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_ _13"> </span>the<span class="_ _13"> </span>MMU<span class="_ _3"></span>.<span class="_"> </span>Because<span class="_ _13"> </span>the<span class="_ _13"> </span>virtual<span class="_ _13"> </span>page<span class="_"> </span>is<span class="_ _13"> </span>now<span class="_ _13"> </span>cached<span class="_ _13"> </span>in<span class="_"> </span>physical<span class="_ _13"> </span>memory<span class="_ _7"></span>,</div><div class="t m5 xcd h26 y6e54 ff7 fs19 fc1 sc0 ls0 ws0">there<span class="_ _13"> </span>is<span class="_ _13"> </span>a<span class="_ _13"> </span>hit,<span class="_ _13"> </span>and<span class="_ _13"> </span>after<span class="_ _13"> </span>the<span class="_ _13"> </span>MMU<span class="_ _13"> </span>performs<span class="_ _6"> </span>the<span class="_ _13"> </span>steps<span class="_ _13"> </span>in<span class="_ _13"> </span>Figure<span class="_ _6"> </span>9.13(a),<span class="_"> </span>the</div><div class="t m5 xcd h26 y6e55 ff7 fs19 fc1 sc0 ls0 ws0">main<span class="_"> </span>memory<span class="_"> </span>returns<span class="_"> </span>the<span class="_"> </span>requested<span class="_"> </span>word<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>processor.</div><div class="t m5 x1d h47 y6e56 ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>9.3<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>917)</span></div><div class="t m5 x1d h26 y6e57 ff7 fs19 fc1 sc0 ls0 ws0">Given<span class="_"> </span>a<span class="_ _11"> </span>64-bit<span class="_"> </span>virtual<span class="_ _11"> </span>address<span class="_ _11"> </span>space<span class="_"> </span>and<span class="_ _11"> </span>a<span class="_ _11"> </span>32-bit<span class="_"> </span>physical<span class="_ _11"> </span>address<span class="_ _1"></span>,<span class="_ _11"> </span>determine<span class="_ _11"> </span>the</div><div class="t m5 x1d h26 y6e58 ff7 fs19 fc1 sc0 ls0 ws0">number<span class="_"> </span>of<span class="_"> </span>bits<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>VPN<span class="_ _3"></span>,<span class="_"> </span>VPO<span class="_ _1"></span>,<span class="_"> </span>PPN<span class="_ _3"></span>,<span class="_"> </span>and<span class="_"> </span>PPO<span class="_"> </span>for<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>page<span class="_"> </span>sizes<span class="_"> </span><span class="ff11">P<span class="_ _6"> </span></span>:</div><div class="t m5 x67 h31 y6e59 ff7 fs21 fc2 sc0 ls0 ws0">Number<span class="_"> </span>of</div><div class="t m5 x17e h31 y6e5a ff11 fs21 fc2 sc0 ls0 ws0">P<span class="_ _59"> </span><span class="ff7">VPN<span class="_"> </span>bits<span class="_ _26"> </span>VPO<span class="_"> </span>bits<span class="_ _f1"> </span>PPN<span class="_"> </span>bits<span class="_ _7b"> </span>PPO<span class="_"> </span>bits</span></div><div class="t m5 x5a h31 y6e5b ff7 fs21 fc2 sc0 ls128 ws0">1K<span class="_ _4a"></span>B</div><div class="t m5 x5a h31 y6e5c ff7 fs21 fc1 sc0 ls128 ws0">2K<span class="_ _4a"></span>B</div><div class="t m5 x5a h31 ybbb ff7 fs21 fc1 sc0 ls128 ws0">4K<span class="_ _4a"></span>B</div><div class="t m5 x1d h31 y6e5d ff7 fs21 fc1 sc0 ls0 ws0">16<span class="_"> </span>KB</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
