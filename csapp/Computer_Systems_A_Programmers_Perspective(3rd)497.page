<div id="pf1f1" class="pf w2 h11" data-page-no="1f1"><div class="pc pc1f1 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1f1.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">496<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>4<span class="_ _3d"> </span>Processor<span class="_ _10"> </span>Architecture</span></div><div class="t m5 x5e h31 y390 ff7 fs21 fc2 sc0 ls0 ws0">Pipeline<span class="_"> </span>register</div><div class="t m5 x1d h31 y391 ff7 fs21 fc2 sc0 ls0 ws0">Condition<span class="_ _17d"> </span>F<span class="_ _71"> </span>D<span class="_ _1b3"> </span>E<span class="_ _1b3"> </span>M<span class="_ _ba"> </span>W</div><div class="t m5 x1d h31 y392 ff7 fs21 fc2 sc0 ls0 ws0">Processing<span class="_"> </span><span class="ffd fs1e">ret<span class="_ _7d"> </span></span>stall<span class="_ _4f"> </span>bubble<span class="_ _26"> </span>normal<span class="_ _26"> </span>normal<span class="_ _26"> </span>normal</div><div class="t m5 x1d h31 y393 ff7 fs21 fc2 sc0 ls0 ws0">Load/use<span class="_"> </span>hazard<span class="_ _30"> </span>stall<span class="_ _5a"> </span>stall<span class="_ _14a"> </span>bubble<span class="_ _95"> </span>normal<span class="_ _26"> </span>normal</div><div class="t m5 x1d h31 y4549 ff7 fs21 fc2 sc0 ls0 ws0">Mispredicted<span class="_"> </span>branch<span class="_ _26"> </span>normal<span class="_ _26"> </span>bubble<span class="_ _5e"> </span>bubble<span class="_ _95"> </span>normal<span class="_ _26"> </span>normal</div><div class="t m5 x1d h34 y454a ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _6"> </span>4.66<span class="_ _c"> </span><span class="fc1">Actions<span class="_ _13"> </span>for<span class="_ _6"> </span>pipeline<span class="_ _13"> </span>control<span class="_ _6"> </span>logic.<span class="_ _13"> </span><span class="ff6">The<span class="_ _6"> </span>different<span class="_ _6"> </span>conditions<span class="_ _13"> </span>require<span class="_ _6"> </span>altering</span></span></div><div class="t m5 x1d h34 y454b ff6 fs16 fc1 sc0 ls0 ws0">the<span class="_ _6"> </span>pipeline<span class="_ _6"> </span>ﬂow<span class="_ _6"> </span>by<span class="_ _13"> </span>either<span class="_ _a"> </span>stalling<span class="_ _6"> </span>the<span class="_ _13"> </span>pipeline<span class="_ _a"> </span>or<span class="_ _6"> </span>canceling<span class="_ _13"> </span>partially<span class="_ _a"> </span>executed<span class="_ _13"> </span>instructions.</div><div class="t m5 x1d h26 y454c ff7 fs19 fc1 sc0 ls0 ws0">in<span class="_ _16"> </span>Section<span class="_ _16"> </span>4.2.5.<span class="_ _16"> </span>Suppose<span class="_ _16"> </span>that<span class="_ _16"> </span>each<span class="_ _16"> </span>pipeline<span class="_ _16"> </span>register<span class="_ _16"> </span>has<span class="_ _16"> </span>two<span class="_ _16"> </span>control<span class="_ _16"> </span>inputs<span class="_ _16"> </span><span class="ff6">stall</span></div><div class="t m5 x1d h26 y454d ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_ _16"> </span><span class="ff6">bubble</span>.<span class="_ _16"> </span>T<span class="_ _1"></span>he<span class="_ _16"> </span>settings<span class="_ _16"> </span>of<span class="_ _16"> </span>these<span class="_ _11"> </span>signals<span class="_ _16"> </span>determine<span class="_ _16"> </span>how<span class="_ _16"> </span>the<span class="_ _16"> </span>pipeline<span class="_ _16"> </span>register<span class="_ _11"> </span>is</div><div class="t m5 x1d h26 y454e ff7 fs19 fc1 sc0 ls0 ws0">updated<span class="_ _13"> </span>as<span class="_ _13"> </span>the<span class="_ _13"> </span>clock<span class="_ _13"> </span>rises<span class="_ _3"></span>.<span class="_ _13"> </span>Under<span class="_ _13"> </span>normal<span class="_ _13"> </span>operation<span class="_ _13"> </span>(F<span class="_ _1"></span>igure<span class="_ _13"> </span>4.65(a)),<span class="_ _13"> </span>both<span class="_ _13"> </span>of<span class="_ _13"> </span>these</div><div class="t m5 x1d h26 y454f ff7 fs19 fc1 sc0 ls0 ws0">inputs<span class="_"> </span>are<span class="_ _13"> </span>set<span class="_"> </span>to<span class="_"> </span>0,<span class="_"> </span>causing<span class="_ _13"> </span>the<span class="_"> </span>register<span class="_"> </span>to<span class="_"> </span>load<span class="_ _13"> </span>its<span class="_"> </span>input<span class="_"> </span>as<span class="_ _13"> </span>its<span class="_"> </span>new<span class="_"> </span>state<span class="_ _1"></span>.<span class="_"> </span>When<span class="_ _13"> </span>the</div><div class="t m5 x1d h26 y4550 ff6 fs19 fc1 sc0 ls0 ws0">stall<span class="_ _13"> </span><span class="ff7">signal<span class="_ _13"> </span>is<span class="_ _6"> </span>set<span class="_ _13"> </span>to<span class="_ _13"> </span>1<span class="_ _13"> </span>(F<span class="_ _1"></span>igure<span class="_ _13"> </span>4.65(b)),<span class="_ _13"> </span>the<span class="_ _13"> </span>updating<span class="_ _6"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>state<span class="_ _13"> </span>is<span class="_ _13"> </span>disabled.<span class="_ _6"> </span>Instead,</span></div><div class="t m5 x1d h26 y4551 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _11"> </span>register<span class="_ _16"> </span>will<span class="_ _11"> </span>remain<span class="_ _11"> </span>in<span class="_ _16"> </span>its<span class="_ _11"> </span>previous<span class="_ _11"> </span>state.<span class="_"> </span>This<span class="_"> </span>makes<span class="_ _16"> </span>it<span class="_ _11"> </span>possible<span class="_ _11"> </span>to<span class="_ _16"> </span>hold<span class="_ _11"> </span>back</div><div class="t m5 x1d h26 y4552 ff7 fs19 fc1 sc0 ls0 ws0">an<span class="_ _11"> </span>instruction<span class="_ _11"> </span>in<span class="_ _11"> </span>some<span class="_ _16"> </span>pipeline<span class="_ _11"> </span>stage<span class="_ _1"></span>.<span class="_ _16"> </span>W<span class="_ _0"></span>hen<span class="_ _11"> </span>the<span class="_ _11"> </span><span class="ff6">bubble<span class="_ _11"> </span></span>signal<span class="_ _16"> </span>is<span class="_ _11"> </span>set<span class="_ _11"> </span>to<span class="_ _11"> </span>1<span class="_ _11"> </span>(Figure</div><div class="t m5 x1d h26 y4553 ff7 fs19 fc1 sc0 ls0 ws0">4.65(c)),<span class="_ _13"> </span>the<span class="_ _6"> </span>state<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_ _6"> </span>register<span class="_ _13"> </span>will<span class="_ _6"> </span>be<span class="_ _13"> </span>set<span class="_ _13"> </span>to<span class="_ _6"> </span>some<span class="_ _13"> </span>ﬁxed<span class="_ _13"> </span><span class="ffa">reset<span class="_ _6"> </span>conﬁguration</span>,<span class="_ _13"> </span>giving</div><div class="t m5 x1d h26 y4554 ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_"> </span>state<span class="_"> </span>equivalent<span class="_ _11"> </span>to<span class="_"> </span>that<span class="_"> </span>of<span class="_ _11"> </span>a<span class="_"> </span><span class="ffd">nop<span class="_ _10"> </span></span>instruction.<span class="_ _11"> </span>T<span class="_ _1"></span>he<span class="_ _11"> </span>particular<span class="_"> </span>pattern<span class="_"> </span>of<span class="_ _11"> </span>ones<span class="_"> </span>and</div><div class="t m5 x1d h26 y4555 ff7 fs19 fc1 sc0 ls0 ws0">zeros<span class="_ _16"> </span>for<span class="_ _16"> </span>a<span class="_ _16"> </span>pipeline<span class="_ _16"> </span>register’s<span class="_ _11"> </span>reset<span class="_ _16"> </span>conﬁguration<span class="_ _16"> </span>depends<span class="_ _16"> </span>on<span class="_ _16"> </span>the<span class="_ _16"> </span>set<span class="_ _16"> </span>of<span class="_ _16"> </span>ﬁelds<span class="_ _16"> </span>in</div><div class="t m5 x1d h26 y4556 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>pipeline<span class="_ _11"> </span>register.<span class="_"> </span>F<span class="_ _1"></span>or<span class="_ _11"> </span>example<span class="_ _0"></span>,<span class="_"> </span>to<span class="_ _11"> </span>inject<span class="_ _11"> </span>a<span class="_ _11"> </span>bubble<span class="_"> </span>into<span class="_ _11"> </span>pipeline<span class="_ _11"> </span>register<span class="_"> </span>D<span class="_ _1"></span>,<span class="_ _11"> </span>we</div><div class="t m5 x1d h26 y4557 ff7 fs19 fc1 sc0 ls0 ws0">want<span class="_ _11"> </span>the<span class="_ _16"> </span><span class="ff6">icode<span class="_ _11"> </span></span>ﬁeld<span class="_ _11"> </span>to<span class="_ _16"> </span>be<span class="_ _11"> </span>set<span class="_ _16"> </span>to<span class="_ _11"> </span>the<span class="_ _11"> </span>constant<span class="_ _16"> </span>value<span class="_ _11"> </span><span class="ffd">INOP<span class="_ _16"> </span></span>(F<span class="_ _1"></span>igure<span class="_ _16"> </span>4.26).<span class="_ _11"> </span>T<span class="_ _3"></span>o<span class="_ _11"> </span>inject</div><div class="t m5 x1d h26 y4558 ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_ _16"> </span>bubble<span class="_ _16"> </span>into<span class="_ _16"> </span>pipeline<span class="_ _16"> </span>register<span class="_ _16"> </span>E,<span class="_ _16"> </span>we<span class="_ _16"> </span>want<span class="_ _16"> </span>the<span class="_ _16"> </span><span class="ff6">icode<span class="_ _16"> </span></span>ﬁeld<span class="_ _16"> </span>to<span class="_ _16"> </span>be<span class="_ _16"> </span>set<span class="_ _16"> </span>to<span class="_ _16"> </span><span class="ffd">INOP<span class="_ _16"> </span></span>and</div><div class="t m5 x1d h26 y4559 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span><span class="ff6">dstE</span>,<span class="_"> </span><span class="ff6">dstM</span>,<span class="_"> </span><span class="ff6">srcA</span>,<span class="_"> </span>and<span class="_"> </span><span class="ff6">srcB<span class="_ _10"> </span></span>ﬁelds<span class="_"> </span>to<span class="_"> </span>be<span class="_"> </span>set<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>constant<span class="_"> </span><span class="ffd">RNONE</span>.<span class="_ _11"> </span>Determining</div><div class="t m5 x1d h26 y455a ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>reset<span class="_"> </span>conﬁguration<span class="_ _11"> </span>is<span class="_"> </span>one<span class="_ _11"> </span>of<span class="_"> </span>the<span class="_ _11"> </span>tasks<span class="_"> </span>for<span class="_ _11"> </span>the<span class="_"> </span>hardware<span class="_ _11"> </span>designer<span class="_"> </span>in<span class="_"> </span>designing</div><div class="t m5 x1d h26 y455b ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_ _16"> </span>pipeline<span class="_ _16"> </span>register.<span class="_ _11"> </span>W<span class="_ _1"></span>e<span class="_ _16"> </span>will<span class="_ _16"> </span>not<span class="_ _16"> </span>concern<span class="_ _16"> </span>ourselves<span class="_ _16"> </span>with<span class="_ _16"> </span>the<span class="_ _16"> </span>details<span class="_ _16"> </span>here.<span class="_ _11"> </span>W<span class="_ _1"></span>e<span class="_ _16"> </span>will</div><div class="t m5 x1d h26 y455c ff7 fs19 fc1 sc0 ls0 ws0">consider<span class="_"> </span>it<span class="_"> </span>an<span class="_"> </span>error<span class="_"> </span>to<span class="_"> </span>set<span class="_"> </span>both<span class="_"> </span>the<span class="_"> </span>bubble<span class="_"> </span>and<span class="_"> </span>the<span class="_"> </span>stall<span class="_"> </span>signals<span class="_"> </span>to<span class="_"> </span>1.</div><div class="t m5 x29 h26 y455d ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>table<span class="_ _13"> </span>in<span class="_ _13"> </span>F<span class="_ _1"></span>igure<span class="_"> </span>4.66<span class="_ _13"> </span>shows<span class="_ _13"> </span>the<span class="_ _13"> </span>actions<span class="_"> </span>the<span class="_ _13"> </span>different<span class="_ _13"> </span>pipeline<span class="_ _13"> </span>stages<span class="_"> </span>should</div><div class="t m5 x1d h26 y455e ff7 fs19 fc1 sc0 ls0 ws0">take<span class="_"> </span>for<span class="_"> </span>each<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>three<span class="_"> </span>special<span class="_ _11"> </span>conditions<span class="_ _1"></span>.<span class="_"> </span>Each<span class="_"> </span>involves<span class="_"> </span>some<span class="_"> </span>combination<span class="_"> </span>of</div><div class="t m5 x1d h26 y455f ff7 fs19 fc1 sc0 ls0 ws0">normal,<span class="_"> </span>stall,<span class="_"> </span>and<span class="_ _13"> </span>bubble<span class="_"> </span>operations<span class="_"> </span>for<span class="_"> </span>the<span class="_ _13"> </span>pipeline<span class="_"> </span>registers<span class="_ _1"></span>.<span class="_"> </span>In<span class="_"> </span>terms<span class="_"> </span>of<span class="_ _13"> </span>timing,</div><div class="t m5 x1d h26 y4560 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _14"> </span>stall<span class="_ _15"> </span>and<span class="_ _15"> </span>bubble<span class="_ _15"> </span>control<span class="_ _14"> </span>signals<span class="_ _15"> </span>for<span class="_ _15"> </span>the<span class="_ _15"> </span>pipeline<span class="_ _14"> </span>registers<span class="_ _15"> </span>are<span class="_ _15"> </span>generated<span class="_ _15"> </span>by</div><div class="t m5 x1d h26 y4561 ff7 fs19 fc1 sc0 ls0 ws0">blocks<span class="_ _6"> </span>of<span class="_ _6"> </span>combinational<span class="_ _13"> </span>logic<span class="_ _1"></span>.<span class="_ _13"> </span>T<span class="_ _1"></span>hese<span class="_ _6"> </span>values<span class="_ _13"> </span>must<span class="_ _a"> </span>be<span class="_ _13"> </span>valid<span class="_ _a"> </span>as<span class="_ _13"> </span>the<span class="_ _a"> </span>clock<span class="_ _13"> </span>rises<span class="_ _3"></span>,<span class="_ _13"> </span>causing</div><div class="t m5 x1d h26 y4562 ff7 fs19 fc1 sc0 ls0 ws0">each<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_"> </span>pipeline<span class="_ _13"> </span>registers<span class="_ _13"> </span>to<span class="_ _13"> </span>either<span class="_"> </span>load,<span class="_ _13"> </span>stall,<span class="_ _13"> </span>or<span class="_"> </span>bubble<span class="_ _13"> </span>as<span class="_ _13"> </span>the<span class="_ _13"> </span>next<span class="_"> </span>clock<span class="_ _13"> </span>cycle</div><div class="t m5 x1d h26 y4563 ff7 fs19 fc1 sc0 ls0 ws0">begins<span class="_ _1"></span>.<span class="_ _6"> </span>W<span class="_ _0"></span>ith<span class="_ _6"> </span>this<span class="_ _6"> </span>small<span class="_ _6"> </span>extension<span class="_ _6"> </span>to<span class="_ _6"> </span>the<span class="_ _6"> </span>pipeline<span class="_ _13"> </span>register<span class="_ _a"> </span>designs<span class="_ _1"></span>,<span class="_ _13"> </span>we<span class="_ _a"> </span>can<span class="_ _6"> </span>implement</div><div class="t m5 x1d h26 y4564 ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_"> </span>complete<span class="_"> </span>pipeline<span class="_ _1"></span>,<span class="_"> </span>including<span class="_"> </span>all<span class="_"> </span>of<span class="_"> </span>its<span class="_"> </span>control,<span class="_"> </span>using<span class="_"> </span>the<span class="_"> </span>basic<span class="_"> </span>building<span class="_"> </span>blocks<span class="_"> </span>of</div><div class="t m5 x1d h26 y4565 ff7 fs19 fc1 sc0 ls0 ws0">combinational<span class="_"> </span>logic,<span class="_"> </span>clocked<span class="_"> </span>registers<span class="_ _3"></span>,<span class="_"> </span>and<span class="_"> </span>random<span class="_"> </span>access<span class="_"> </span>memories<span class="_ _1"></span>.</div><div class="t m5 x1d h42 y3de7 ff6 fs29 fc6 sc0 ls0 ws0">Combinations<span class="_ _11"> </span>of<span class="_ _16"> </span>Control<span class="_ _16"> </span>Conditions</div><div class="t m5 x1d h26 y278 ff7 fs19 fc1 sc0 ls0 ws0">In<span class="_ _13"> </span>our<span class="_ _13"> </span>discussion<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>special<span class="_ _13"> </span>pipeline<span class="_ _6"> </span>control<span class="_ _13"> </span>conditions<span class="_ _13"> </span>so<span class="_ _13"> </span>far,<span class="_ _13"> </span>we<span class="_ _13"> </span>assumed<span class="_ _13"> </span>that</div><div class="t m5 x1d h26 y279 ff7 fs19 fc1 sc0 ls0 ws0">at<span class="_ _6"> </span>most<span class="_ _6"> </span>one<span class="_ _13"> </span>special<span class="_ _a"> </span>case<span class="_ _13"> </span>could<span class="_ _a"> </span>arise<span class="_ _13"> </span>during<span class="_ _a"> </span>any<span class="_ _13"> </span>single<span class="_ _6"> </span>clock<span class="_ _6"> </span>cycle<span class="_ _1"></span>.<span class="_ _6"> </span>A<span class="_ _13"> </span>common<span class="_ _a"> </span>bug<span class="_ _13"> </span>in</div><div class="t m5 x1d h26 y27a ff7 fs19 fc1 sc0 ls0 ws0">designing<span class="_"> </span>a<span class="_ _13"> </span>system<span class="_"> </span>is<span class="_"> </span>to<span class="_ _13"> </span>fail<span class="_"> </span>to<span class="_"> </span>handle<span class="_ _13"> </span>instances<span class="_"> </span>where<span class="_"> </span>multiple<span class="_ _13"> </span>special<span class="_"> </span>conditions</div><div class="t m5 x1d h26 y27b ff7 fs19 fc1 sc0 ls0 ws0">arise<span class="_ _11"> </span>simultaneously<span class="_ _3"></span>.<span class="_ _11"> </span>Let<span class="_ _11"> </span>us<span class="_ _16"> </span>analyze<span class="_"> </span>such<span class="_ _16"> </span>possibilities<span class="_ _3"></span>.<span class="_ _16"> </span>W<span class="_ _3"></span>e<span class="_ _11"> </span>need<span class="_ _11"> </span>not<span class="_ _16"> </span>worry<span class="_"> </span>about</div><div class="t m5 x1d h26 y27c ff7 fs19 fc1 sc0 ls0 ws0">combinations<span class="_ _21"> </span>involving<span class="_ _f"> </span>program<span class="_ _f"> </span>exceptions<span class="_ _1"></span>,<span class="_ _e"> </span>since<span class="_ _21"> </span>we<span class="_ _21"> </span>have<span class="_ _f"> </span>carefully<span class="_ _f"> </span>designed</div><div class="t m5 x1d h26 y27d ff7 fs19 fc1 sc0 ls0 ws0">our<span class="_"> </span>exception-handling<span class="_"> </span>mechanism<span class="_"> </span>to<span class="_ _13"> </span>consider<span class="_"> </span>other<span class="_"> </span>instructions<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>pipeline<span class="_ _1"></span>.</div><div class="t m5 x1d h26 y27e ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_"> </span>4.67<span class="_"> </span>diagrams<span class="_ _13"> </span>the<span class="_"> </span>pipeline<span class="_"> </span>states<span class="_"> </span>that<span class="_ _13"> </span>cause<span class="_"> </span>the<span class="_"> </span>other<span class="_ _13"> </span>three<span class="_"> </span>special<span class="_"> </span>control</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
