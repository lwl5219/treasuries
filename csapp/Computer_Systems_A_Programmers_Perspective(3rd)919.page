<div id="pf397" class="pf w2 h11" data-page-no="397"><div class="pc pc397 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg397.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">918<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>9<span class="_ _3d"> </span>Virtual<span class="_ _10"> </span>Memory</span></div><div class="t m5 x124 h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">A.<span class="_ _1f"> </span><span class="ffd">00<span class="_ _11"> </span>0011<span class="_ _16"> </span>1101<span class="_ _16"> </span>0111</span></div><div class="t m5 x124 h26 y10aa ff7 fs19 fc2 sc0 ls2a ws0">B.</div><div class="t m5 x4f h31 y280 ff7 fs21 fc2 sc0 ls0 ws0">Parameter<span class="_ _7d"> </span>V<span class="_ _7"></span>alue</div><div class="t m5 x4f h31 y7682 ff7 fs21 fc2 sc0 ls0 ws0">VPN<span class="_ _1c2"> </span><span class="ffd fs1e">0xf</span></div><div class="t m5 x4f h31 y5fae ff7 fs21 fc2 sc0 ls0 ws0">TLB<span class="_"> </span>index<span class="_ _86"> </span><span class="ffd fs1e">0x3</span></div><div class="t m5 x4f h31 y2d54 ff7 fs21 fc2 sc0 ls0 ws0">TLB<span class="_"> </span>tag<span class="_ _44"> </span><span class="ffd fs1e">0x3</span></div><div class="t m5 x4f h31 y7683 ff7 fs21 fc2 sc0 ls0 ws0">TLB<span class="_"> </span>hit?<span class="_"> </span>(Y/N)<span class="_ _88"> </span>Y</div><div class="t m5 x4f h31 y7684 ff7 fs21 fc2 sc0 ls0 ws0">Page<span class="_"> </span>fault?<span class="_"> </span>(Y/N)<span class="_ _45"> </span>N</div><div class="t m5 x4f h31 y7685 ff7 fs21 fc2 sc0 ls0 ws0">PPN</div><div class="t m5 x228 h2d y7686 ffd fs1e fc2 sc0 ls0 ws0">0xd</div><div class="t m5 x124 h26 y7687 ff7 fs19 fc2 sc0 ls22 ws0">C.<span class="_ _24"> </span><span class="ffd ls0">0011<span class="_ _16"> </span>0101<span class="_ _11"> </span>0111</span></div><div class="t m5 x124 h26 y7688 ff7 fs19 fc2 sc0 ls2a ws0">D.</div><div class="t m5 x4f h31 y7689 ff7 fs21 fc2 sc0 ls0 ws0">Parameter<span class="_ _126"> </span>V<span class="_ _7"></span>alue</div><div class="t m5 x4f h31 y768a ff7 fs21 fc2 sc0 ls0 ws0">Byte<span class="_"> </span>offset<span class="_ _115"> </span><span class="ffd fs1e">0x3</span></div><div class="t m5 x4f h31 y768b ff7 fs21 fc2 sc0 ls0 ws0">Cache<span class="_"> </span>index<span class="_ _192"> </span><span class="ffd fs1e">0x5</span></div><div class="t m5 x4f h31 y768c ff7 fs21 fc2 sc0 ls0 ws0">Cache<span class="_"> </span>tag<span class="_ _ce"> </span><span class="ffd fs1e">0xd</span></div><div class="t m5 x4f h31 y768d ff7 fs21 fc2 sc0 ls0 ws0">Cache<span class="_"> </span>hit?<span class="_"> </span>(Y/N)<span class="_ _2a"> </span>Y</div><div class="t m5 x4f h31 y768e ff7 fs21 fc2 sc0 ls0 ws0">Cache<span class="_"> </span>byte<span class="_"> </span>returned</div><div class="t m5 xe3 h2d y768f ffd fs1e fc2 sc0 ls0 ws0">0x1d</div><div class="t m5 x1d h28 y7690 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>9.5</div><div class="t m5 x1ed h2f y7691 ffe fs16 fc6 sc0 ls0 ws0">(page<span class="_"> </span>875)</div><div class="t m5 x1d h26 y7692 ff7 fs19 fc1 sc0 ls0 ws0">Solving<span class="_ _11"> </span>this<span class="_ _16"> </span>problem<span class="_ _11"> </span>will<span class="_ _16"> </span>give<span class="_ _11"> </span>you<span class="_ _16"> </span>a<span class="_ _11"> </span>good<span class="_ _16"> </span>feel<span class="_ _11"> </span>for<span class="_ _11"> </span>the<span class="_ _16"> </span>idea<span class="_ _11"> </span>of<span class="_ _16"> </span>memory<span class="_ _11"> </span>mapping.</div><div class="t m5 x1d h26 y7693 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _7"></span>ry<span class="_ _13"> </span>it<span class="_ _13"> </span>yourself<span class="_ _1"></span>.<span class="_ _13"> </span>W<span class="_ _3"></span>e<span class="_ _13"> </span>haven’t<span class="_ _13"> </span>discussed<span class="_ _13"> </span>the<span class="_ _13"> </span><span class="ffd">open</span>,<span class="_ _13"> </span><span class="ffd">fstat</span><span class="ls2cd">,o<span class="_ _80"></span>r<span class="ffd ls0">write<span class="_ _13"> </span><span class="ff7">functions<span class="_ _1"></span>,<span class="_ _13"> </span>so<span class="_ _13"> </span>you’ll</span></span></span></div><div class="t m5 x1d h26 y7694 ff7 fs19 fc1 sc0 ls0 ws0">need<span class="_"> </span>to<span class="_"> </span>read<span class="_"> </span>their<span class="_"> </span><span class="ffd">man<span class="_ _10"> </span></span>pages<span class="_"> </span>to<span class="_"> </span>see<span class="_"> </span>how<span class="_"> </span>they<span class="_"> </span>work.</div><div class="t m5 x1f0 h2c y7695 ffa fs16 fc1 sc0 ls0 ws0">code/vm/mmapcopy<span class="_ _3"></span>.c</div><div class="t m5 x1f h2d y421c ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">#include<span class="_ _1f"> </span>&quot;csapp.h&quot;</span></div><div class="t m5 x1f h2e y2468 ff6 fs20 fc6 sc0 ls0 ws0">2</div><div class="t m5 x1f h2e y7696 ff6 fs20 fc6 sc0 ls0 ws0">3</div><div class="t m5 x4f h2d y2b69 ffd fs1e fc2 sc0 ls0 ws0">/*</div><div class="t m5 x1f h2d y7fe ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _73"> </span><span class="ffd fs1e fc2">*<span class="_ _1f"> </span>mmapcopy<span class="_ _e"> </span>-<span class="_ _1f"> </span>uses<span class="_ _1f"> </span>mmap<span class="_ _e"> </span>to<span class="_ _1f"> </span>copy<span class="_ _e"> </span>file<span class="_ _1f"> </span>fd<span class="_ _1f"> </span>to<span class="_ _e"> </span>stdout</span></div><div class="t m5 x1f h2d y21f4 ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _73"> </span><span class="ffd fs1e fc2">*/</span></div><div class="t m5 x1f h2d y465b ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _1c"> </span><span class="ffd fs1e fc2">void<span class="_ _1f"> </span>mmapcopy(int<span class="_ _e"> </span>fd,<span class="_ _1f"> </span>int<span class="_ _1f"> </span>size)</span></div><div class="t m5 x1f h2d y6fe ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x1f h2d y631 ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _20"> </span><span class="ffd fs1e fc2">char<span class="_ _e"> </span>*bufp;<span class="_ _1f"> </span>/*<span class="_ _1f"> </span>ptr<span class="_ _e"> </span>to<span class="_ _1f"> </span>memory-mapped<span class="_ _e"> </span>VM<span class="_ _1f"> </span>area<span class="_ _1f"> </span>*/</span></div><div class="t m5 x1f h2e y7c1 ff6 fs20 fc6 sc0 ls0 ws0">9</div><div class="t m5 x1b0 h2e y7697 ff6 fs20 fc6 sc0 ls0 ws0">10</div><div class="t m5 x33 h2d y107a ffd fs1e fc2 sc0 ls0 ws0">bufp<span class="_ _e"> </span>=<span class="_ _1f"> </span>Mmap(NULL,<span class="_ _1f"> </span>size,<span class="_ _e"> </span>PROT_READ,<span class="_ _1f"> </span>MAP_PRIVATE,<span class="_ _e"> </span>fd,<span class="_ _1f"> </span>0);</div><div class="t m5 x1b0 h2d yec2 ff6 fs20 fc6 sc0 ls0 ws0">11<span class="_ _20"> </span><span class="ffd fs1e fc2">Write(1,<span class="_ _e"> </span>bufp,<span class="_ _1f"> </span>size);</span></div><div class="t m5 x1b0 h2e y561 ff6 fs20 fc6 sc0 ls0 ws0">12</div><div class="t m5 x33 h2d y5b5 ffd fs1e fc2 sc0 ls0 ws0">return;</div><div class="t m5 x1b0 h2d y2578 ff6 fs20 fc6 sc0 ls0 ws0">13<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x1b0 h2e y1204 ff6 fs20 fc6 sc0 ls0 ws0">14</div><div class="t m5 x1b0 h2e y7698 ff6 fs20 fc6 sc0 ls0 ws0">15</div><div class="t m5 x4f h2d ye93 ffd fs1e fc2 sc0 ls0 ws0">/*<span class="_ _e"> </span>mmapcopy<span class="_ _1f"> </span>driver<span class="_ _1f"> </span>*/</div><div class="t m5 x1b0 h2e y832 ff6 fs20 fc6 sc0 ls0 ws0">16</div><div class="t m5 x4f h2d yd16 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>main(int<span class="_ _1f"> </span>argc,<span class="_ _1f"> </span>char<span class="_ _e"> </span>**argv)</div><div class="t m5 x1b0 h2d yb04 ff6 fs20 fc6 sc0 ls0 ws0">17<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x1b0 h2d y6e1 ff6 fs20 fc6 sc0 ls0 ws0">18<span class="_ _20"> </span><span class="ffd fs1e fc2">struct<span class="_ _e"> </span>stat<span class="_ _1f"> </span>stat;</span></div><div class="t m5 x1b0 h2d y271e ff6 fs20 fc6 sc0 ls0 ws0">19<span class="_ _20"> </span><span class="ffd fs1e fc2">int<span class="_ _e"> </span>fd;</span></div><div class="t m5 x1b0 h2e y7699 ff6 fs20 fc6 sc0 ls0 ws0">20</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
