<div id="pff8" class="pf w2 h11" data-page-no="f8"><div class="pc pcf8 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bgf8.png"/><div class="t m5 x1dc h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>3.6<span class="_ _60"> </span>Control<span class="_ _3e"> </span><span class="ffe fs1e">247</span></div><div class="t m5 x34 h2a y257 fff fs1c fc2 sc0 ls0 ws0">Aside<span class="_ _1b"> </span><span class="ff6 fs19">Describing<span class="_ _11"> </span>machine<span class="_ _11"> </span>code<span class="_ _11"> </span>with<span class="_ _16"> </span>C<span class="_ _11"> </span>code</span></div><div class="t m5 x34 h2b y2d0 ff7 fs1e fc2 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_ _21"> </span>3.16<span class="_ _21"> </span>shows<span class="_ _21"> </span>an<span class="_ _21"> </span>example<span class="_ _21"> </span>of<span class="_ _21"> </span>how<span class="_ _21"> </span>we<span class="_ _21"> </span>will<span class="_ _21"> </span>demonstrate<span class="_ _21"> </span>the<span class="_ _21"> </span>translation<span class="_ _21"> </span>of<span class="_ _15"> </span>C<span class="_ _21"> </span>language<span class="_ _21"> </span>control</div><div class="t m5 x34 h2b y2d1 ff7 fs1e fc2 sc0 ls0 ws0">constructs<span class="_"> </span>into<span class="_ _13"> </span>machine<span class="_ _13"> </span>code<span class="_ _0"></span>.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_ _13"> </span>ﬁgure<span class="_"> </span>contains<span class="_ _13"> </span>an<span class="_"> </span>example<span class="_ _13"> </span>C<span class="_ _13"> </span>function<span class="_"> </span>(a)<span class="_ _13"> </span>and<span class="_"> </span>an<span class="_ _13"> </span>annotated<span class="_ _13"> </span>version</div><div class="t m5 x34 h2b y2d2 ff7 fs1e fc2 sc0 ls0 ws0">of<span class="_ _16"> </span>the<span class="_ _16"> </span>assembly<span class="_ _14"> </span>code<span class="_ _16"> </span>generated<span class="_ _14"> </span>by<span class="_ _16"> </span><span class="ff9">gcc<span class="_ _14"> </span></span>(c).<span class="_ _16"> </span>It<span class="_ _16"> </span>also<span class="_ _14"> </span>contains<span class="_ _16"> </span>a<span class="_ _16"> </span>version<span class="_ _14"> </span>in<span class="_ _16"> </span>C<span class="_ _14"> </span>that<span class="_ _16"> </span>closely<span class="_ _16"> </span>matches<span class="_ _14"> </span>the</div><div class="t m5 x34 h2b y2d3 ff7 fs1e fc2 sc0 ls0 ws0">structure<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>assembly<span class="_ _11"> </span>code<span class="_ _11"> </span>(b).<span class="_ _11"> </span>Although<span class="_ _11"> </span>these<span class="_ _10"> </span>versions<span class="_ _11"> </span>were<span class="_ _11"> </span>generated<span class="_ _11"> </span>in<span class="_ _11"> </span>the<span class="_ _11"> </span>sequence<span class="_ _11"> </span>(a),<span class="_ _16"> </span>(c),</div><div class="t m5 x34 h2b y2d4 ff7 fs1e fc2 sc0 ls0 ws0">and<span class="_"> </span>(b),<span class="_"> </span>we<span class="_"> </span>recommend<span class="_"> </span>that<span class="_"> </span>you<span class="_"> </span>read<span class="_"> </span>them<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>order<span class="_"> </span>(a),<span class="_"> </span>(b),<span class="_"> </span>and<span class="_ _13"> </span>then<span class="_"> </span>(c).<span class="_"> </span>T<span class="_ _0"></span>hat<span class="_"> </span>is<span class="_ _1"></span>,<span class="_"> </span>the<span class="_"> </span>C<span class="_"> </span>rendition</div><div class="t m5 x34 h2b y2d5 ff7 fs1e fc2 sc0 ls0 ws0">of<span class="_"> </span>the<span class="_"> </span>machine<span class="_"> </span>code<span class="_"> </span>will<span class="_"> </span>help<span class="_"> </span>you<span class="_"> </span>understand<span class="_"> </span>the<span class="_ _10"> </span>key<span class="_"> </span>points<span class="_ _0"></span>,<span class="_"> </span>and<span class="_"> </span>this<span class="_"> </span>can<span class="_"> </span>guide<span class="_"> </span>you<span class="_"> </span>in<span class="_"> </span>understanding</div><div class="t m5 x34 h2b y2d6 ff7 fs1e fc2 sc0 ls0 ws0">the<span class="_"> </span>actual<span class="_"> </span>assembly<span class="_"> </span>code<span class="_ _1"></span>.</div><div class="t m5 x17 h26 y257e ff7 fs19 fc2 sc0 ls0 ws0">execution<span class="_ _14"> </span>from<span class="_ _16"> </span>this<span class="_ _14"> </span>point,<span class="_ _15"> </span>it<span class="_ _14"> </span>completes<span class="_ _14"> </span>the<span class="_ _14"> </span>computations<span class="_ _16"> </span>speciﬁed<span class="_ _14"> </span>by<span class="_ _14"> </span>the<span class="_ _14"> </span><span class="ffd">else</span></div><div class="t m5 x17 h26 y257f ff7 fs19 fc2 sc0 ls0 ws0">portion<span class="_"> </span>of<span class="_"> </span>function<span class="_ _13"> </span><span class="ffd">absdiff_se<span class="_ _10"> </span></span>and<span class="_"> </span>returns<span class="_ _1"></span>.<span class="_"> </span>On<span class="_"> </span>the<span class="_"> </span>other<span class="_ _13"> </span>hand,<span class="_"> </span>if<span class="_"> </span>the<span class="_"> </span>test<span class="_"> </span><span class="ffd ls4b">x&gt;<span class="_ _42"></span>=y</span></div><div class="t m5 x17 h26 y2580 ff7 fs19 fc2 sc0 ls0 ws0">fails<span class="_ _1"></span>,<span class="_"> </span>the<span class="_ _13"> </span>program<span class="_ _13"> </span>procedure<span class="_"> </span>will<span class="_ _13"> </span>carry<span class="_"> </span>out<span class="_ _13"> </span>the<span class="_"> </span>steps<span class="_ _13"> </span>speciﬁed<span class="_ _13"> </span>by<span class="_"> </span>the<span class="_ _13"> </span><span class="ffd">if<span class="_ _10"> </span></span>portion<span class="_ _13"> </span>of</div><div class="t m5 x17 h26 y2581 ffd fs19 fc2 sc0 ls0 ws0">absdiff_se<span class="_ _10"> </span><span class="ff7">and<span class="_"> </span>return.</span></div><div class="t m5 x26 h26 y2582 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _14"> </span>assembly-code<span class="_ _14"> </span>implementation<span class="_ _14"> </span>(F<span class="_ _1"></span>igure<span class="_ _14"> </span>3.16(c))<span class="_ _14"> </span>ﬁrst<span class="_ _14"> </span>compares<span class="_ _14"> </span>the<span class="_ _16"> </span>two</div><div class="t m5 x17 h26 y2583 ff7 fs19 fc2 sc0 ls0 ws0">operands<span class="_ _11"> </span>(line<span class="_ _11"> </span>2),<span class="_ _16"> </span>setting<span class="_ _11"> </span>the<span class="_ _16"> </span>condition<span class="_ _11"> </span>codes<span class="_ _1"></span>.<span class="_ _11"> </span>If<span class="_ _16"> </span>the<span class="_ _11"> </span>comparison<span class="_ _11"> </span>result<span class="_ _11"> </span>indicates</div><div class="t m5 x17 h26 y2584 ff7 fs19 fc2 sc0 ls0 ws0">that<span class="_ _16"> </span><span class="ff11">x<span class="_ _15"> </span></span>is<span class="_ _16"> </span>greater<span class="_ _16"> </span>than<span class="_ _16"> </span>or<span class="_ _16"> </span>equal<span class="_ _14"> </span>to<span class="_ _16"> </span><span class="ff11">y<span class="_ _2"></span></span>,<span class="_ _14"> </span>it<span class="_ _16"> </span>then<span class="_ _16"> </span>jumps<span class="_ _14"> </span>to<span class="_ _16"> </span>a<span class="_ _16"> </span>block<span class="_ _16"> </span>of<span class="_ _16"> </span>code<span class="_ _16"> </span>starting<span class="_ _16"> </span>at</div><div class="t m5 x17 h26 y2585 ff7 fs19 fc2 sc0 ls0 ws0">line<span class="_ _11"> </span>8<span class="_ _11"> </span>that<span class="_ _11"> </span>increments<span class="_ _11"> </span>global<span class="_ _11"> </span>variable<span class="_ _11"> </span><span class="ffd">ge_cnt</span>,<span class="_ _11"> </span>computes<span class="_ _11"> </span><span class="ffd">x-y<span class="_ _11"> </span></span>as<span class="_ _11"> </span>the<span class="_ _11"> </span>return<span class="_ _11"> </span>value,</div><div class="t m5 x17 h26 y2586 ff7 fs19 fc2 sc0 ls0 ws0">and<span class="_"> </span>returns<span class="_ _1"></span>.<span class="_ _11"> </span>Otherwise,<span class="_"> </span>it<span class="_"> </span>continues<span class="_ _11"> </span>with<span class="_ _11"> </span>the<span class="_"> </span>execution<span class="_ _11"> </span>of<span class="_ _11"> </span>code<span class="_"> </span>beginning<span class="_ _11"> </span>at<span class="_ _11"> </span>line</div><div class="t m5 x17 h26 y2587 ff7 fs19 fc2 sc0 ls0 ws0">4<span class="_ _11"> </span>that<span class="_ _11"> </span>increments<span class="_ _11"> </span>global<span class="_"> </span>variable<span class="_ _16"> </span><span class="ffd">lt_cnt</span>,<span class="_"> </span>computes<span class="_ _11"> </span><span class="ffd">y-x<span class="_ _11"> </span></span>as<span class="_ _11"> </span>the<span class="_ _11"> </span>return<span class="_ _11"> </span>value,<span class="_"> </span>and</div><div class="t m5 x17 h26 y2588 ff7 fs19 fc2 sc0 ls0 ws0">returns<span class="_ _1"></span>.<span class="_ _13"> </span>W<span class="_ _3"></span>e<span class="_ _13"> </span>can<span class="_ _13"> </span>see,<span class="_ _13"> </span>then,<span class="_ _13"> </span>that<span class="_ _13"> </span>the<span class="_ _13"> </span>control<span class="_ _13"> </span>ﬂow<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>assembly<span class="_ _13"> </span>code<span class="_ _13"> </span>generated<span class="_ _13"> </span>for</div><div class="t m5 x17 h26 y2589 ffd fs19 fc2 sc0 ls0 ws0">absdiff_se<span class="_ _10"> </span><span class="ff7">closely<span class="_"> </span>follows<span class="_"> </span>the<span class="_"> </span>goto<span class="_"> </span>code<span class="_"> </span>of<span class="_"> </span></span>gotodiff_se<span class="ff7">.</span></div><div class="t m5 x26 h26 y258a ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>general<span class="_"> </span>form<span class="_"> </span>of<span class="_"> </span>an<span class="_"> </span>if-else<span class="_"> </span>statement<span class="_"> </span>in<span class="_"> </span>C<span class="_"> </span>is<span class="_"> </span>given<span class="_"> </span>by<span class="_"> </span>the<span class="_"> </span>template</div><div class="t m5 x17 h53 y258b ffd fs1e fc2 sc0 ls0 ws0">if<span class="_ _e"> </span>(<span class="ffa">test-expr<span class="_ _2"></span></span>)</div><div class="t m5 x1b6 h53 y258c ffa fs1e fc2 sc0 ls0 ws0">then-statement</div><div class="t m5 x17 h2d y258d ffd fs1e fc2 sc0 ls0 ws0">else</div><div class="t m5 x1b6 h53 y258e ffa fs1e fc2 sc0 ls0 ws0">else-statement</div><div class="t m5 x17 h26 y258f ff7 fs19 fc2 sc0 ls0 ws0">where<span class="_"> </span><span class="ffa">test-expr<span class="_ _11"> </span></span>is<span class="_"> </span>an<span class="_"> </span>integer<span class="_"> </span>expression<span class="_"> </span>that<span class="_"> </span>evaluates<span class="_"> </span>either<span class="_"> </span>to<span class="_ _13"> </span>zero<span class="_"> </span>(interpreted</div><div class="t m5 x17 h26 y2590 ff7 fs19 fc2 sc0 ls0 ws0">as<span class="_"> </span>meaning<span class="_"> </span>“false”)<span class="_"> </span>or<span class="_ _11"> </span>to<span class="_"> </span>a<span class="_"> </span>nonzero<span class="_ _11"> </span>value<span class="_"> </span>(interpreted<span class="_"> </span>as<span class="_ _11"> </span>meaning<span class="_"> </span>“true”).<span class="_"> </span>Only</div><div class="t m5 x17 h26 y2591 ff7 fs19 fc2 sc0 ls0 ws0">one<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>two<span class="_"> </span>branch<span class="_"> </span>statements<span class="_"> </span>(<span class="ffa">then-statement<span class="_ _11"> </span></span>or<span class="_"> </span><span class="ffa">else-statement<span class="_ _5"></span></span>)<span class="_"> </span>is<span class="_"> </span>executed.</div><div class="t m5 x26 h26 y2592 ff7 fs19 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>or<span class="_ _11"> </span>this<span class="_ _11"> </span>general<span class="_ _11"> </span>form,<span class="_ _11"> </span>the<span class="_ _11"> </span>assembly<span class="_ _16"> </span>implementation<span class="_"> </span>typically<span class="_ _11"> </span>adheres<span class="_ _11"> </span>to<span class="_ _11"> </span>the</div><div class="t m5 x17 h26 y2593 ff7 fs19 fc2 sc0 ls0 ws0">following<span class="_"> </span>form,<span class="_"> </span>where<span class="_"> </span>we<span class="_"> </span>use<span class="_"> </span>C<span class="_"> </span>syntax<span class="_"> </span>to<span class="_"> </span>describe<span class="_"> </span>the<span class="_"> </span>control<span class="_"> </span>ﬂow:</div><div class="t m5 x1b6 h53 y2594 ffd fs1e fc2 sc0 ls33 ws0">t=<span class="ffa ls0">test-expr<span class="_ _2"></span><span class="ffd">;</span></span></div><div class="t m5 x1b6 h2d y2595 ffd fs1e fc2 sc0 ls0 ws0">if<span class="_ _e"> </span>(!t)</div><div class="t m5 x21e h2d y2596 ffd fs1e fc2 sc0 ls0 ws0">goto<span class="_ _e"> </span>false;</div><div class="t m5 x1b6 h53 y2597 ffa fs1e fc2 sc0 ls0 ws0">then-statement</div><div class="t m5 x1b6 h2d y2598 ffd fs1e fc2 sc0 ls0 ws0">goto<span class="_ _e"> </span>done;</div><div class="t m5 x17 h2d y2599 ffd fs1e fc2 sc0 ls0 ws0">false:</div><div class="t m5 x1b6 h53 y259a ffa fs1e fc2 sc0 ls0 ws0">else-statement</div><div class="t m5 x17 h2d y259b ffd fs1e fc2 sc0 ls0 ws0">done:</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
