<div id="pf1ea" class="pf w2 h11" data-page-no="1ea"><div class="pc pc1ea w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1ea.png"/><div class="t m5 x13d h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>4.5<span class="_ _60"> </span>Pipelined<span class="_ _10"> </span>Y86-64<span class="_ _10"> </span>Implementations<span class="_ _3e"> </span><span class="ffe fs1e">489</span></div><div class="t m5 x17 h47 yb1f ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>4.34<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>527)</span></div><div class="t m5 x17 h26 yb20 ff7 fs19 fc1 sc0 ls0 ws0">Write<span class="_ _11"> </span>HCL<span class="_ _16"> </span>code<span class="_ _11"> </span>for<span class="_ _16"> </span>the<span class="_ _11"> </span>signal<span class="_ _16"> </span><span class="ff6">d_valB</span>,<span class="_ _16"> </span>giving<span class="_ _11"> </span>the<span class="_ _11"> </span>value<span class="_ _16"> </span>for<span class="_ _11"> </span>source<span class="_ _16"> </span>operand<span class="_ _11"> </span><span class="ff6">valB</span></div><div class="t m5 x17 h26 yb21 ff7 fs19 fc1 sc0 ls0 ws0">supplied<span class="_"> </span>to<span class="_"> </span>pipeline<span class="_"> </span>register<span class="_"> </span>E.</div><div class="t m5 x26 h26 y4442 ff7 fs19 fc1 sc0 ls0 ws0">One<span class="_"> </span>small<span class="_"> </span>part<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>write-back<span class="_"> </span>stage<span class="_"> </span>remains<span class="_ _1"></span>.<span class="_"> </span>As<span class="_"> </span>shown<span class="_"> </span>in<span class="_"> </span>Figure<span class="_"> </span>4.52,<span class="_"> </span>the</div><div class="t m5 x17 h26 y4443 ff7 fs19 fc1 sc0 ls0 ws0">overall<span class="_"> </span>processor<span class="_ _11"> </span>status<span class="_ _11"> </span><span class="ff6">Stat<span class="_ _11"> </span></span>is<span class="_ _11"> </span>computed<span class="_ _11"> </span>by<span class="_"> </span>a<span class="_ _11"> </span>block<span class="_ _11"> </span>based<span class="_ _11"> </span>on<span class="_ _11"> </span>the<span class="_ _11"> </span>status<span class="_"> </span>value<span class="_ _11"> </span>in</div><div class="t m5 x17 h26 y4444 ff7 fs19 fc1 sc0 ls0 ws0">pipeline<span class="_"> </span>register<span class="_ _13"> </span>W<span class="_ _7"></span>.<span class="_"> </span>Recall<span class="_ _13"> </span>from<span class="_"> </span>Section<span class="_ _13"> </span>4.1.1<span class="_"> </span>that<span class="_ _13"> </span>the<span class="_"> </span>code<span class="_ _13"> </span>should<span class="_"> </span>indicate<span class="_ _13"> </span>either</div><div class="t m5 x17 h26 y4445 ff7 fs19 fc1 sc0 ls0 ws0">normal<span class="_ _11"> </span>operation<span class="_ _16"> </span>(<span class="ffd">AOK</span>)<span class="_ _11"> </span>or<span class="_ _16"> </span>one<span class="_ _11"> </span>of<span class="_ _16"> </span>the<span class="_ _11"> </span>three<span class="_ _16"> </span>exception<span class="_ _11"> </span>conditions<span class="_ _1"></span>.<span class="_ _16"> </span>Since<span class="_ _11"> </span>pipeline</div><div class="t m5 x17 h26 y4446 ff7 fs19 fc1 sc0 ls0 ws0">register<span class="_"> </span>W<span class="_ _13"> </span>holds<span class="_"> </span>the<span class="_ _13"> </span>state<span class="_"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>most<span class="_"> </span>recently<span class="_ _13"> </span>completed<span class="_"> </span>instruction,<span class="_"> </span>it<span class="_ _13"> </span>is<span class="_"> </span>natural</div><div class="t m5 x17 h26 y4447 ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_"> </span>use<span class="_"> </span>this<span class="_ _11"> </span>value<span class="_"> </span>as<span class="_"> </span>an<span class="_ _11"> </span>indication<span class="_"> </span>of<span class="_ _11"> </span>the<span class="_"> </span>overall<span class="_"> </span>processor<span class="_ _11"> </span>status<span class="_ _1"></span>.<span class="_"> </span>The<span class="_"> </span>only<span class="_"> </span>special</div><div class="t m5 x17 h26 y4448 ff7 fs19 fc1 sc0 ls0 ws0">case<span class="_ _11"> </span>to<span class="_ _11"> </span>consider<span class="_ _11"> </span>is<span class="_ _11"> </span>when<span class="_ _16"> </span>there<span class="_"> </span>is<span class="_ _16"> </span>a<span class="_"> </span>bubble<span class="_ _16"> </span>in<span class="_"> </span>the<span class="_ _16"> </span>write-back<span class="_"> </span>stage.<span class="_"> </span>T<span class="_ _0"></span>his<span class="_ _11"> </span>is<span class="_ _11"> </span>part<span class="_ _11"> </span>of</div><div class="t m5 x17 h26 y4449 ff7 fs19 fc1 sc0 ls0 ws0">normal<span class="_"> </span>operation,<span class="_"> </span>and<span class="_"> </span>so<span class="_"> </span>we<span class="_"> </span>want<span class="_"> </span>the<span class="_"> </span>status<span class="_"> </span>code<span class="_"> </span>to<span class="_"> </span>be<span class="_"> </span><span class="ffd">AOK<span class="_ _10"> </span></span>for<span class="_"> </span>this<span class="_"> </span>case<span class="_"> </span>as<span class="_"> </span>well:</div><div class="t m5 x17 h2d y444a ffd fs1e fc2 sc0 ls0 ws0">word<span class="_ _e"> </span>Stat<span class="_ _1f"> </span>=<span class="_ _1f"> </span>[</div><div class="t m5 x21e h2d y444b ffd fs1e fc2 sc0 ls0 ws0">W_stat<span class="_ _e"> </span>==<span class="_ _1f"> </span>SBUB<span class="_ _1f"> </span>:<span class="_ _e"> </span>SAOK;</div><div class="t m5 x21e h2d y444c ffd fs1e fc2 sc0 ls0 ws0">1<span class="_ _e"> </span>:<span class="_ _1f"> </span>W_stat;</div><div class="t m5 x17 h2d y444d ffd fs1e fc2 sc0 ls0 ws0">];</div><div class="t m5 x17 h42 y444e ff6 fs29 fc6 sc0 ls0 ws0">Execute<span class="_ _11"> </span>Stage</div><div class="t m5 x17 h26 y444f ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_ _16"> </span>4.60<span class="_ _16"> </span>shows<span class="_ _11"> </span>the<span class="_ _16"> </span>execute<span class="_ _11"> </span>stage<span class="_ _16"> </span>logic<span class="_ _11"> </span>for<span class="_ _16"> </span>PIPE.<span class="_ _11"> </span>The<span class="_ _11"> </span>hardware<span class="_ _16"> </span>units<span class="_ _11"> </span>and<span class="_ _16"> </span>the</div><div class="t m5 x17 h26 y4450 ff7 fs19 fc1 sc0 ls0 ws0">logic<span class="_ _6"> </span>blocks<span class="_ _13"> </span>are<span class="_ _6"> </span>identical<span class="_ _13"> </span>to<span class="_ _6"> </span>those<span class="_ _13"> </span>in<span class="_ _6"> </span>SEQ,<span class="_ _13"> </span>with<span class="_ _13"> </span>an<span class="_ _6"> </span>appropriate<span class="_ _13"> </span>renaming<span class="_ _6"> </span>of<span class="_ _13"> </span>signals<span class="_ _3"></span>.</div><div class="t m5 x17 h26 y4451 ff7 fs19 fc1 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_ _15"> </span>can<span class="_ _15"> </span>see<span class="_ _15"> </span>the<span class="_ _14"> </span>signals<span class="_ _15"> </span><span class="ff6">e_valE<span class="_ _15"> </span></span>and<span class="_ _15"> </span><span class="ff6">e_dstE<span class="_ _15"> </span></span>directed<span class="_ _15"> </span>toward<span class="_ _15"> </span>the<span class="_ _14"> </span>decode<span class="_ _15"> </span>stage<span class="_ _15"> </span>as</div><div class="t m5 x17 h26 y4452 ff7 fs19 fc1 sc0 ls0 ws0">one<span class="_"> </span>of<span class="_ _11"> </span>the<span class="_"> </span>forwarding<span class="_ _11"> </span>sources<span class="_ _1"></span>.<span class="_"> </span>One<span class="_ _11"> </span>difference<span class="_"> </span>is<span class="_ _11"> </span>that<span class="_"> </span>the<span class="_ _11"> </span>logic<span class="_ _11"> </span>labeled<span class="_"> </span>“Set<span class="_ _11"> </span>CC,<span class="_ _3"></span>”</div><div class="t m5 x17 h26 y4453 ff7 fs19 fc1 sc0 ls0 ws0">which<span class="_ _13"> </span>determines<span class="_ _6"> </span>whether<span class="_ _13"> </span>or<span class="_ _6"> </span>not<span class="_ _13"> </span>to<span class="_ _6"> </span>update<span class="_ _13"> </span>the<span class="_ _6"> </span>condition<span class="_ _13"> </span>codes<span class="_ _3"></span>,<span class="_ _13"> </span>has<span class="_ _13"> </span>signals<span class="_ _6"> </span><span class="ff6">m_stat</span></div><div class="t m5 x17 h26 y4454 ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_"> </span><span class="ff6">W_stat<span class="_ _11"> </span></span>as<span class="_"> </span>inputs<span class="_ _1"></span>.<span class="_"> </span>These<span class="_"> </span>signals<span class="_"> </span>are<span class="_"> </span>used<span class="_ _11"> </span>to<span class="_"> </span>detect<span class="_ _11"> </span>cases<span class="_"> </span>where<span class="_ _11"> </span>an<span class="_"> </span>instruction</div><div class="t m5 x1f7 hc2 y4455 ff4f fs78 fc1 sc0 ls0 ws0">e_Cnd </div><div class="t m5 x57 hc2 y4456 ff4f fs78 fc1 sc0 ls0 ws0">W_stat</div><div class="t m5 x168 hc2 y4457 ff4f fs78 fc1 sc0 ls0 ws0">m_stat</div><div class="t m5 x43 hc2 y4458 ff4f fs78 fc1 sc0 ls0 ws0">e_valE</div><div class="t m5 x43 hc2 y4459 ff4f fs78 fc1 sc0 ls0 ws0">e_dstE</div><div class="t m5 x2c ha2 y445a ff4f fs65 fc0 sc0 ls0 ws0">M<span class="_ _6c"> </span><span class="fc1">icode<span class="_ _1c0"></span>stat</span></div><div class="t m5 x23e ha2 y445b ff4f fs65 fc1 sc0 ls0 ws0">stat</div><div class="t m5 x1ac ha2 y445a ff4f fs65 fc1 sc0 ls0 ws0">Cnd<span class="_ _19"> </span>valE<span class="_ _5c"> </span>valA<span class="_ _20"> </span>dstE<span class="_ _e"> </span>dstM</div><div class="t m5 x52 ha2 y445b ff4f fs65 fc0 sc0 ls0 ws0">E<span class="_ _63"> </span><span class="fc1">icode<span class="_ _25"> </span>ifun<span class="_ _2e"> </span>valC<span class="_ _d3"> </span>valA<span class="_ _78"> </span>valB<span class="_ _c0"> </span>dstM<span class="_ _1f"> </span>srcA<span class="_ _1f"> </span>srcB<span class="_ _1d1"></span>dstE</span></div><div class="t m5 x7c hc3 y445c ff4f fs79 fc1 sc0 ls0 ws0">ALU</div><div class="t m5 x235 hc3 y445d ff4f fs79 fc1 sc0 ls0 ws0">A</div><div class="t m5 x134 hc3 y445c ff4f fs79 fc1 sc0 ls0 ws0">Set</div><div class="t m5 x134 hc3 y445d ff4f fs79 fc1 sc0 ls0 ws0">CC</div><div class="t m5 x24c hc3 y445c ff4f fs79 fc1 sc0 ls0 ws0">ALU</div><div class="t m5 xec hc3 y445d ff4f fs79 fc1 sc0 ls0 ws0">B</div><div class="t m5 x17c hc3 y445e ff4f fs79 fc1 sc0 ls0 ws0">ALU</div><div class="t m5 x151 hc3 y445f ff4f fs79 fc1 sc0 ls0 ws0">fun.</div><div class="t m5 x238 ha2 y4460 ff4f fs65 fc1 sc0 ls0 ws0">ALU</div><div class="t m5 x134 ha2 y4461 ff4f fs65 fc1 sc0 ls0 ws0">CC</div><div class="t m5 x4c ha2 y4462 ff4f fs65 fc1 sc0 ls0 ws0">cond</div><div class="t m5 x19d hc3 y4463 ff4f fs79 fc1 sc0 ls0 ws0">dstE</div><div class="t m5 x17 h34 y4464 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _13"> </span>4.60<span class="_ _c"> </span><span class="fc1">PIPE<span class="_ _13"> </span>execute<span class="_ _10"> </span>stage<span class="_ _13"> </span>logic.<span class="_ _13"> </span><span class="ff6">This<span class="_ _13"> </span>part<span class="_ _10"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>design<span class="_ _13"> </span>is<span class="_ _10"> </span>very<span class="_ _13"> </span>similar<span class="_ _13"> </span>to<span class="_ _10"> </span>the<span class="_ _13"> </span>logic</span></span></div><div class="t m5 x17 h34 y4465 ff6 fs16 fc1 sc0 ls0 ws0">in<span class="_ _10"> </span>the<span class="_ _11"> </span>SEQ<span class="_ _10"> </span>implementation.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
