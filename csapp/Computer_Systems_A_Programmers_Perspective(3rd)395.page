<div id="pf18b" class="pf w2 h11" data-page-no="18b"><div class="pc pc18b w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg18b.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">394<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>4<span class="_ _3d"> </span>Processor<span class="_ _10"> </span>Architecture</span></div><div class="t m5 x29 h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">this<span class="_ _16"> </span>instruction,<span class="_ _15"> </span>since<span class="_ _16"> </span>it<span class="_ _14"> </span>causes<span class="_ _14"> </span>the<span class="_ _14"> </span>entire<span class="_ _16"> </span>system<span class="_ _14"> </span>to<span class="_ _14"> </span>suspend<span class="_ _16"> </span>operation.<span class="_ _14"> </span>F<span class="_ _1"></span>or</div><div class="t m5 x29 h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">Y86-64,<span class="_"> </span>executing<span class="_"> </span>the<span class="_"> </span><span class="ffd">halt<span class="_ _10"> </span></span>instruction<span class="_"> </span>causes<span class="_"> </span>the<span class="_"> </span>processor<span class="_"> </span>to<span class="_"> </span>stop,<span class="_"> </span>with<span class="_"> </span>the</div><div class="t m5 x29 h26 y2a8 ff7 fs19 fc2 sc0 ls0 ws0">status<span class="_"> </span>code<span class="_"> </span>set<span class="_"> </span>to<span class="_"> </span><span class="ffd">HLT</span>.<span class="_"> </span>(See<span class="_"> </span>Section<span class="_"> </span>4.1.4.)</div><div class="t m5 x1d h41 y3702 ffe fs29 fc2 sc0 ls0 ws0">4.1.3</div><div class="t m5 x8c h43 y3703 ffe fs19 fc2 sc0 ls0 ws0">Instruction<span class="_"> </span>Encoding</div><div class="t m5 x1d h26 y3704 ff7 fs19 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_"> </span>4.2<span class="_ _13"> </span>also<span class="_ _13"> </span>shows<span class="_"> </span>the<span class="_ _13"> </span>byte-level<span class="_ _13"> </span>encoding<span class="_"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>instructions<span class="_ _0"></span>.<span class="_ _13"> </span>Each<span class="_"> </span>instruction</div><div class="t m5 x1d h26 y3705 ff7 fs19 fc2 sc0 ls0 ws0">requires<span class="_ _11"> </span>between<span class="_ _16"> </span>1<span class="_ _11"> </span>and<span class="_ _11"> </span>10<span class="_ _16"> </span>bytes<span class="_ _1"></span>,<span class="_ _16"> </span>depending<span class="_ _11"> </span>on<span class="_ _11"> </span>which<span class="_ _16"> </span>ﬁelds<span class="_ _11"> </span>are<span class="_ _16"> </span>required.<span class="_ _11"> </span>Every</div><div class="t m5 x1d h26 y3706 ff7 fs19 fc2 sc0 ls0 ws0">instruction<span class="_ _14"> </span>has<span class="_ _14"> </span>an<span class="_ _14"> </span>initial<span class="_ _14"> </span>byte<span class="_ _14"> </span>identifying<span class="_ _14"> </span>the<span class="_ _14"> </span>instruction<span class="_ _14"> </span>type.<span class="_ _16"> </span>This<span class="_ _16"> </span>byte<span class="_ _14"> </span>is<span class="_ _14"> </span>split</div><div class="t m5 x1d h26 y3707 ff7 fs19 fc2 sc0 ls0 ws0">into<span class="_"> </span>two<span class="_"> </span>4-bit<span class="_"> </span>parts:<span class="_"> </span>the<span class="_ _11"> </span>high-order,<span class="_"> </span>or<span class="_"> </span><span class="ffa">code</span>,<span class="_"> </span>part,<span class="_"> </span>and<span class="_"> </span>the<span class="_ _11"> </span>low-order,<span class="_"> </span>or<span class="_"> </span><span class="ffa">function</span>,</div><div class="t m5 x1d h26 y3708 ff7 fs19 fc2 sc0 ls0 ws0">part.<span class="_"> </span>As<span class="_"> </span>can<span class="_"> </span>be<span class="_"> </span>seen<span class="_"> </span>in<span class="_"> </span>Figure<span class="_"> </span>4.2,<span class="_"> </span>code<span class="_"> </span>values<span class="_"> </span>range<span class="_"> </span>from<span class="_"> </span><span class="ffd">0<span class="_ _10"> </span></span>to<span class="_"> </span><span class="ffd">0xB</span>.<span class="_"> </span>T<span class="_ _0"></span>he<span class="_"> </span>function</div><div class="t m5 x1d h26 y3709 ff7 fs19 fc2 sc0 ls0 ws0">values<span class="_ _13"> </span>are<span class="_ _13"> </span>signiﬁcant<span class="_ _6"> </span>only<span class="_ _13"> </span>for<span class="_ _13"> </span>the<span class="_ _13"> </span>cases<span class="_ _6"> </span>where<span class="_ _13"> </span>a<span class="_ _13"> </span>group<span class="_ _13"> </span>of<span class="_ _13"> </span>related<span class="_ _6"> </span>instructions<span class="_ _13"> </span>share</div><div class="t m5 x1d h26 y370a ff7 fs19 fc2 sc0 ls0 ws0">a<span class="_"> </span>common<span class="_ _11"> </span>code<span class="_ _0"></span>.<span class="_"> </span>These<span class="_"> </span>are<span class="_"> </span>given<span class="_ _11"> </span>in<span class="_ _11"> </span>F<span class="_ _1"></span>igure<span class="_ _11"> </span>4.3,<span class="_ _11"> </span>showing<span class="_ _11"> </span>the<span class="_"> </span>speciﬁc<span class="_ _11"> </span>encodings<span class="_ _11"> </span>of</div><div class="t m5 x1d h26 y370b ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _16"> </span>integer<span class="_ _14"> </span>operation,<span class="_ _15"> </span>branch,<span class="_ _14"> </span>and<span class="_ _14"> </span>conditional<span class="_ _14"> </span>move<span class="_ _14"> </span>instructions<span class="_ _1"></span>.<span class="_ _14"> </span>Observe<span class="_ _16"> </span>that</div><div class="t m5 x1d h26 y370c ffd fs19 fc2 sc0 ls0 ws0">rrmovq<span class="_ _10"> </span><span class="ff7">has<span class="_ _11"> </span>the<span class="_"> </span>same<span class="_"> </span>instruction<span class="_ _11"> </span>code<span class="_"> </span>as<span class="_ _11"> </span>the<span class="_"> </span>conditional<span class="_"> </span>moves<span class="_ _0"></span>.<span class="_"> </span>It<span class="_"> </span>can<span class="_ _11"> </span>be<span class="_"> </span>viewed</span></div><div class="t m5 x1d h26 y370d ff7 fs19 fc2 sc0 ls0 ws0">as<span class="_"> </span>an<span class="_ _11"> </span>“unconditional<span class="_ _11"> </span>move”<span class="_"> </span>just<span class="_ _11"> </span>as<span class="_ _11"> </span>the<span class="_ _11"> </span><span class="ffd">jmp<span class="_ _10"> </span></span>instruction<span class="_ _11"> </span>is<span class="_ _11"> </span>an<span class="_ _11"> </span>unconditional<span class="_"> </span>jump,</div><div class="t m5 x1d h26 y370e ff7 fs19 fc2 sc0 ls0 ws0">both<span class="_"> </span>having<span class="_"> </span>function<span class="_"> </span>code<span class="_"> </span><span class="ffd">0</span>.</div><div class="t m5 x29 h26 y370f ff7 fs19 fc2 sc0 ls0 ws0">As<span class="_ _16"> </span>shown<span class="_ _16"> </span>in<span class="_ _14"> </span>F<span class="_ _1"></span>igure<span class="_ _14"> </span>4.4,<span class="_ _14"> </span>each<span class="_ _16"> </span>of<span class="_ _16"> </span>the<span class="_ _14"> </span>15<span class="_ _16"> </span>program<span class="_ _16"> </span>registers<span class="_ _14"> </span>has<span class="_ _16"> </span>an<span class="_ _16"> </span>associated</div><div class="t m5 x1d h26 y3710 ffa fs19 fc2 sc0 ls0 ws0">register<span class="_"> </span>identiﬁer<span class="_ _11"> </span><span class="ff7">(ID)<span class="_ _11"> </span>ranging<span class="_"> </span>from<span class="_"> </span><span class="ffd">0<span class="_ _11"> </span></span>to<span class="_"> </span><span class="ffd">0xE</span>.<span class="_"> </span>T<span class="_ _0"></span>he<span class="_"> </span>numbering<span class="_"> </span>of<span class="_"> </span>registers<span class="_"> </span>in<span class="_ _11"> </span>Y86-</span></div><div class="t m5 x1d h26 y3711 ff7 fs19 fc2 sc0 ls0 ws0">64<span class="_ _16"> </span>matches<span class="_ _16"> </span>what<span class="_ _14"> </span>is<span class="_ _16"> </span>used<span class="_ _14"> </span>in<span class="_ _16"> </span>x86-64.<span class="_ _16"> </span>The<span class="_ _16"> </span>program<span class="_ _16"> </span>registers<span class="_ _16"> </span>are<span class="_ _14"> </span>stored<span class="_ _16"> </span>within<span class="_ _14"> </span>the</div><div class="t m5 x1d h26 y3712 ff7 fs19 fc2 sc0 ls0 ws0">CPU<span class="_ _13"> </span>in<span class="_"> </span>a<span class="_ _13"> </span><span class="ffa">register<span class="_ _13"> </span>ﬁle</span>,<span class="_"> </span>a<span class="_ _13"> </span>small<span class="_ _13"> </span>random<span class="_ _13"> </span>access<span class="_"> </span>memory<span class="_ _13"> </span>where<span class="_ _13"> </span>the<span class="_ _13"> </span>register<span class="_"> </span>IDs<span class="_ _13"> </span>serve</div><div class="t m5 x1d h26 y3713 ff7 fs19 fc2 sc0 ls0 ws0">as<span class="_ _14"> </span>addresses<span class="_ _1"></span>.<span class="_ _15"> </span>ID<span class="_ _14"> </span>value<span class="_ _15"> </span><span class="ffd">0xF<span class="_ _14"> </span></span>is<span class="_ _15"> </span>used<span class="_ _14"> </span>in<span class="_ _15"> </span>the<span class="_ _14"> </span>instruction<span class="_ _15"> </span>encodings<span class="_ _14"> </span>and<span class="_ _15"> </span>within<span class="_ _14"> </span>our</div><div class="t m5 x1d h26 y3714 ff7 fs19 fc2 sc0 ls0 ws0">hardware<span class="_"> </span>designs<span class="_"> </span>when<span class="_"> </span>we<span class="_"> </span>need<span class="_"> </span>to<span class="_"> </span>indicate<span class="_"> </span>that<span class="_"> </span>no<span class="_"> </span>register<span class="_"> </span>should<span class="_"> </span>be<span class="_"> </span>accessed.</div><div class="t m5 x29 h26 y3715 ff7 fs19 fc2 sc0 ls0 ws0">Some<span class="_ _11"> </span>instructions<span class="_ _11"> </span>are<span class="_ _11"> </span>just<span class="_"> </span>1<span class="_ _11"> </span>byte<span class="_ _11"> </span>long,<span class="_ _11"> </span>but<span class="_ _11"> </span>those<span class="_ _11"> </span>that<span class="_ _11"> </span>require<span class="_ _11"> </span>operands<span class="_ _11"> </span>have</div><div class="t m5 x1d h26 y3716 ff7 fs19 fc2 sc0 ls0 ws0">longer<span class="_ _13"> </span>encodings<span class="_ _3"></span>.<span class="_ _13"> </span>F<span class="_ _1"></span>irst,<span class="_ _13"> </span>there<span class="_ _13"> </span>can<span class="_ _13"> </span>be<span class="_ _6"> </span>an<span class="_ _13"> </span>additional<span class="_ _13"> </span><span class="ffa">register<span class="_ _6"> </span>speciﬁer<span class="_ _13"> </span>byte</span>,<span class="_ _13"> </span>specifying</div><div class="t m5 x1d h26 y3717 ff7 fs19 fc2 sc0 ls0 ws0">either<span class="_ _14"> </span>one<span class="_ _15"> </span>or<span class="_ _14"> </span>two<span class="_ _14"> </span>registers<span class="_ _0"></span>.<span class="_ _14"> </span>T<span class="_ _0"></span>hese<span class="_ _14"> </span>register<span class="_ _14"> </span>ﬁelds<span class="_ _15"> </span>are<span class="_ _14"> </span>called<span class="_ _15"> </span><span class="ff6">rA<span class="_ _14"> </span></span>and<span class="_ _15"> </span><span class="ff6">rB<span class="_ _14"> </span></span>in<span class="_ _15"> </span>F<span class="_ _1"></span>igure</div><div class="t m5 x1d h26 y3718 ff7 fs19 fc2 sc0 ls0 ws0">4.2.<span class="_"> </span>As<span class="_ _11"> </span>the<span class="_ _11"> </span>assembly-code<span class="_ _11"> </span>versions<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>instructions<span class="_ _11"> </span>show<span class="_ _3"></span>,<span class="_ _11"> </span>they<span class="_ _11"> </span>can<span class="_ _11"> </span>specify<span class="_ _11"> </span>the</div><div class="t m5 x1d h26 y3719 ff7 fs19 fc2 sc0 ls0 ws0">registers<span class="_ _13"> </span>used<span class="_ _13"> </span>for<span class="_ _13"> </span>data<span class="_ _6"> </span>sources<span class="_ _13"> </span>and<span class="_ _13"> </span>destinations<span class="_ _1"></span>,<span class="_ _13"> </span>as<span class="_ _13"> </span>well<span class="_ _13"> </span>as<span class="_ _13"> </span>the<span class="_ _13"> </span>base<span class="_ _13"> </span>register<span class="_ _6"> </span>used<span class="_ _13"> </span>in</div><div class="t m5 x1d h26 y371a ff7 fs19 fc2 sc0 ls0 ws0">an<span class="_ _13"> </span>address<span class="_ _13"> </span>computation,<span class="_ _13"> </span>depending<span class="_ _13"> </span>on<span class="_ _13"> </span>the<span class="_ _6"> </span>instruction<span class="_ _13"> </span>type<span class="_ _0"></span>.<span class="_ _13"> </span>Instructions<span class="_ _13"> </span>that<span class="_ _13"> </span>have</div><div class="t m5 x1d h26 y371b ff7 fs19 fc2 sc0 ls0 ws0">no<span class="_"> </span>register<span class="_ _11"> </span>operands<span class="_ _1"></span>,<span class="_ _11"> </span>such<span class="_ _11"> </span>as<span class="_ _11"> </span>branches<span class="_"> </span>and<span class="_ _11"> </span><span class="ffd">call</span>,<span class="_ _11"> </span>do<span class="_ _11"> </span>not<span class="_ _11"> </span>have<span class="_"> </span>a<span class="_ _11"> </span>register<span class="_ _11"> </span>speciﬁer</div><div class="t m5 x1d h26 y371c ff7 fs19 fc2 sc0 ls0 ws0">byte<span class="_ _1"></span>.<span class="_ _13"> </span>T<span class="_ _0"></span>hose<span class="_ _13"> </span>that<span class="_ _13"> </span>require<span class="_ _6"> </span>just<span class="_ _13"> </span>one<span class="_ _13"> </span>register<span class="_ _13"> </span>operand<span class="_ _13"> </span>(<span class="ffd">irmovq</span>,<span class="_ _13"> </span><span class="ffd">pushq</span>,<span class="_ _13"> </span>and<span class="_ _6"> </span><span class="ffd">popq</span>)<span class="_ _13"> </span>have</div><div class="t m5 x1f h3f y371d ff17 fs27 fc1 sc0 ls0 ws0">Operation<span class="ff38">s<span class="_ _da"> </span></span>Branc<span class="_ _0"></span>he<span class="ff38">s</span></div><div class="t m5 xc4 h40 y371e ff39 fs28 fc1 sc0 ls0 ws0">6<span class="_ _19f"></span>addq<span class="_ _76"> </span>0</div><div class="t m5 xc4 h40 y371f ff39 fs28 fc1 sc0 ls0 ws0">6<span class="_ _19f"></span>subq<span class="_ _76"> </span>1</div><div class="t m5 xc4 h40 y3720 ff39 fs28 fc1 sc0 ls0 ws0">6<span class="_ _19f"></span>andq<span class="_ _76"> </span>2</div><div class="t m5 xc4 h40 y3721 ff39 fs28 fc1 sc0 ls0 ws0">6<span class="_ _19f"></span>xorq<span class="_ _76"> </span>3</div><div class="t m5 x16c h40 y371e ff39 fs28 fc1 sc0 ls0 ws0">7</div><div class="t m5 x16c h40 y3722 ff39 fs28 fc1 sc0 ls0 ws0">7</div><div class="t m5 x79 h40 y371e ff39 fs28 fc1 sc0 ls0 ws0">jmp<span class="_ _75"> </span>0</div><div class="t m5 x79 h40 y371f ff39 fs28 fc1 sc0 ls0 ws0">jle<span class="_ _75"> </span>1</div><div class="t m5 x16c h40 y3720 ff39 fs28 fc1 sc0 ls0 ws0">7<span class="_ _f3"></span>jl<span class="_ _119"> </span>2</div><div class="t m5 x16c h40 y3721 ff39 fs28 fc1 sc0 ls0 ws0">7<span class="_ _f3"></span>je<span class="_ _119"> </span>3</div><div class="t m5 xfd h40 y371e ff39 fs28 fc1 sc0 ls0 ws0">7<span class="_ _1a0"></span>jne<span class="_ _ab"> </span>4</div><div class="t m5 xfd h40 y371f ff39 fs28 fc1 sc0 ls0 ws0">7<span class="_ _1a0"></span>jge<span class="_ _ab"> </span>5</div><div class="t m5 xfd h40 y3720 ff39 fs28 fc1 sc0 ls0 ws0">7<span class="_ _1a0"></span>jg<span class="_ _5c"> </span>6</div><div class="t m5 xb4 h3f y371d ff17 fs27 fc1 sc0 ls0 ws0">Move<span class="ff38">s</span></div><div class="t m5 x8d h40 y371e ff39 fs28 fc1 sc0 ls0 ws0">2</div><div class="t m5 x8d h40 y3722 ff39 fs28 fc1 sc0 ls0 ws0">2</div><div class="t m5 x6a h40 y371e ff39 fs28 fc1 sc0 ls0 ws0">rrmovq<span class="_ _76"> </span>0</div><div class="t m5 x6a h40 y371f ff39 fs28 fc1 sc0 ls0 ws0">cmovle<span class="_ _76"> </span>1</div><div class="t m5 x8d h40 y3720 ff39 fs28 fc1 sc0 ls0 ws0">2<span class="_ _1a1"></span>cmovl<span class="_ _45"> </span>2</div><div class="t m5 x8d h40 y3721 ff39 fs28 fc1 sc0 ls0 ws0">2<span class="_ _1a1"></span>cmove<span class="_ _45"> </span>3</div><div class="t m5 x174 h40 y371e ff39 fs28 fc1 sc0 ls0 ws0">2<span class="_ _125"></span>cmovne<span class="_ _3a"> </span>4</div><div class="t m5 x174 h40 y371f ff39 fs28 fc1 sc0 ls0 ws0">2<span class="_ _125"></span>cmovge<span class="_ _3a"> </span>5</div><div class="t m5 x174 h40 y3720 ff39 fs28 fc1 sc0 ls0 ws0">2<span class="_ _125"></span>cmovg<span class="_ _d3"> </span>6</div><div class="t m5 x1d h34 y3723 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>4.3<span class="_ _c"> </span><span class="fc1">Function<span class="_"> </span>codes<span class="_"> </span>for<span class="_"> </span>Y86-64<span class="_"> </span>instruction<span class="_"> </span>set.<span class="_"> </span><span class="ff6">The<span class="_ _11"> </span>code<span class="_ _10"> </span>speciﬁes<span class="_ _11"> </span>a<span class="_ _10"> </span>particular</span></span></div><div class="t m5 x1d h34 y3724 ff6 fs16 fc1 sc0 ls0 ws0">integer<span class="_ _11"> </span>operation,<span class="_ _16"> </span>branch<span class="_ _16"> </span>condition,<span class="_ _16"> </span>or<span class="_ _16"> </span>data<span class="_ _11"> </span>transfer<span class="_ _16"> </span>condition.<span class="_ _11"> </span>These<span class="_ _16"> </span>instructions<span class="_ _16"> </span>are</div><div class="t m5 x1d h34 y3725 ff6 fs16 fc1 sc0 ls0 ws0">shown<span class="_ _10"> </span>as</div><div class="t m5 x22b h3a y3726 ffd fs19 fc1 sc0 ls0 ws0">OPq<span class="ff6 fs16">,<span class="_ _10"> </span></span>jXX<span class="ff6 fs16">,<span class="_ _11"> </span>and<span class="_ _10"> </span></span>cmovXX<span class="_ _10"> </span><span class="ff6 fs16">in<span class="_ _11"> </span>Figure<span class="_ _10"> </span>4.2.</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
