<div id="pf22e" class="pf w2 h11" data-page-no="22e"><div class="pc pc22e w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg22e.png"/><div class="t m5 x23b h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>5.7<span class="_ _60"> </span>Understanding<span class="_ _10"> </span>Modern<span class="_ _10"> </span>Processors<span class="_ _3e"> </span><span class="ffe fs1e">557</span></div><div class="t m5 x17 h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">microprocessor<span class="_ _11"> </span>chip<span class="_ _11"> </span>has<span class="_ _16"> </span>grown<span class="_ _11"> </span>over<span class="_ _11"> </span>time<span class="_ _0"></span>,<span class="_ _11"> </span>successive<span class="_ _16"> </span>models<span class="_ _11"> </span>of<span class="_ _11"> </span>microprocessors</div><div class="t m5 x17 h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">have<span class="_ _11"> </span>increased<span class="_ _16"> </span>the<span class="_ _16"> </span>total<span class="_ _11"> </span>number<span class="_ _16"> </span>of<span class="_ _16"> </span>functional<span class="_ _11"> </span>units<span class="_ _1"></span>,<span class="_ _16"> </span>the<span class="_ _16"> </span>combinations<span class="_ _16"> </span>of<span class="_ _11"> </span>opera-</div><div class="t m5 x17 h26 y2a8 ff7 fs19 fc2 sc0 ls0 ws0">tions<span class="_ _13"> </span>each<span class="_ _13"> </span>unit<span class="_ _6"> </span>can<span class="_ _13"> </span>perform,<span class="_ _13"> </span>and<span class="_ _13"> </span>the<span class="_ _13"> </span>performance<span class="_ _13"> </span>of<span class="_ _6"> </span>each<span class="_ _13"> </span>of<span class="_ _13"> </span>these<span class="_ _13"> </span>units<span class="_ _3"></span>.<span class="_ _13"> </span>T<span class="_ _0"></span>he<span class="_ _13"> </span>arith-</div><div class="t m5 x17 h26 y2f7 ff7 fs19 fc2 sc0 ls0 ws0">metic<span class="_"> </span>units<span class="_"> </span>are<span class="_"> </span>intentionally<span class="_"> </span>designed<span class="_"> </span>to<span class="_ _13"> </span>be<span class="_"> </span>able<span class="_"> </span>to<span class="_"> </span>perform<span class="_"> </span>a<span class="_"> </span>variety<span class="_"> </span>of<span class="_"> </span>different</div><div class="t m5 x17 h26 y2f8 ff7 fs19 fc2 sc0 ls0 ws0">operations<span class="_ _1"></span>,<span class="_ _16"> </span>since<span class="_ _11"> </span>the<span class="_ _11"> </span>required<span class="_ _16"> </span>operations<span class="_ _11"> </span>vary<span class="_ _11"> </span>widely<span class="_ _16"> </span>across<span class="_ _11"> </span>different<span class="_ _11"> </span>programs<span class="_ _1"></span>.</div><div class="t m5 x17 h26 y2f9 ff7 fs19 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>or<span class="_ _13"> </span>example<span class="_ _0"></span>,<span class="_ _13"> </span>some<span class="_ _13"> </span>programs<span class="_ _13"> </span>might<span class="_ _13"> </span>involve<span class="_ _13"> </span>many<span class="_"> </span>integer<span class="_ _13"> </span>operations<span class="_ _3"></span>,<span class="_ _13"> </span>while<span class="_"> </span>others</div><div class="t m5 x17 h26 y2fa ff7 fs19 fc2 sc0 ls0 ws0">require<span class="_"> </span>many<span class="_ _13"> </span>ﬂoating-point<span class="_"> </span>operations<span class="_ _1"></span>.<span class="_"> </span>If<span class="_"> </span>one<span class="_"> </span>functional<span class="_ _13"> </span>unit<span class="_"> </span>were<span class="_"> </span>specialized<span class="_ _13"> </span>to</div><div class="t m5 x17 h26 y2fb ff7 fs19 fc2 sc0 ls0 ws0">perform<span class="_ _13"> </span>integer<span class="_ _13"> </span>operations<span class="_ _13"> </span>while<span class="_ _13"> </span>another<span class="_"> </span>could<span class="_ _13"> </span>only<span class="_ _13"> </span>perform<span class="_ _13"> </span>ﬂoating-point<span class="_ _13"> </span>oper<span class="_ _1"></span>-</div><div class="t m5 x17 h26 y2fc ff7 fs19 fc2 sc0 ls0 ws0">ations<span class="_ _1"></span>,<span class="_"> </span>then<span class="_"> </span>none<span class="_ _11"> </span>of<span class="_"> </span>these<span class="_"> </span>programs<span class="_ _11"> </span>would<span class="_"> </span>get<span class="_ _11"> </span>the<span class="_"> </span>full<span class="_"> </span>beneﬁt<span class="_ _11"> </span>of<span class="_"> </span>having<span class="_"> </span>multiple</div><div class="t m5 x17 h26 y2fd ff7 fs19 fc2 sc0 ls0 ws0">functional<span class="_"> </span>units<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y2fe ff7 fs19 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>or<span class="_ _6"> </span>example<span class="_ _1"></span>,<span class="_ _13"> </span>our<span class="_ _a"> </span>Intel<span class="_ _6"> </span>Core<span class="_ _6"> </span>i7<span class="_ _6"> </span>Haswell<span class="_ _6"> </span>reference<span class="_ _6"> </span>machine<span class="_ _16"> </span>has<span class="_ _6"> </span>eight<span class="_ _6"> </span>functional</div><div class="t m5 x17 h26 y2ff ff7 fs19 fc2 sc0 ls0 ws0">units<span class="_ _1"></span>,<span class="_"> </span>numbered<span class="_"> </span>0–7.<span class="_"> </span>Here<span class="_"> </span>is<span class="_"> </span>a<span class="_"> </span>partial<span class="_"> </span>list<span class="_"> </span>of<span class="_"> </span>each<span class="_"> </span>one’s<span class="_"> </span>capabilities:</div><div class="t m5 x1cd h26 y4c0a ffc fs19 fc2 sc0 ls0 ws0">0.<span class="_ _e"> </span><span class="ff7">Integer<span class="_ _21"> </span>arithmetic,<span class="_ _21"> </span>ﬂoating-point<span class="_ _21"> </span>multiplication,<span class="_ _f"> </span>integer<span class="_ _15"> </span>and<span class="_ _21"> </span>ﬂoating-point</span></div><div class="t m5 x26 h26 y4c0b ff7 fs19 fc2 sc0 ls0 ws0">division,<span class="_"> </span>branches</div><div class="t m5 x1cd h26 y4c0c ffc fs19 fc2 sc0 ls0 ws0">1.<span class="_ _e"> </span><span class="ff7">Integer<span class="_ _21"> </span>arithmetic,<span class="_ _21"> </span>ﬂoating-point<span class="_ _21"> </span>addition,<span class="_ _f"> </span>integer<span class="_ _15"> </span>multiplication,<span class="_ _f"> </span>ﬂoating-</span></div><div class="t m5 x26 h26 y4c0d ff7 fs19 fc2 sc0 ls0 ws0">point<span class="_"> </span>multiplication</div><div class="t m5 x1cd h26 y4c0e ffc fs19 fc2 sc0 ls0 ws0">2.<span class="_ _e"> </span><span class="ff7">Load,<span class="_"> </span>address<span class="_"> </span>computation</span></div><div class="t m5 x1cd h26 y4c0f ffc fs19 fc2 sc0 ls0 ws0">3.<span class="_ _e"> </span><span class="ff7">Load,<span class="_"> </span>address<span class="_"> </span>computation</span></div><div class="t m5 x1cd h26 y4c10 ffc fs19 fc2 sc0 ls0 ws0">4.<span class="_ _e"> </span><span class="ff7">Store</span></div><div class="t m5 x1cd h26 y4c11 ffc fs19 fc2 sc0 ls0 ws0">5.<span class="_ _e"> </span><span class="ff7">Integer<span class="_"> </span>arithmetic</span></div><div class="t m5 x1cd h26 y4c12 ffc fs19 fc2 sc0 ls0 ws0">6.<span class="_ _e"> </span><span class="ff7">Integer<span class="_"> </span>arithmetic,<span class="_"> </span>branches</span></div><div class="t m5 x1cd h26 y4c13 ffc fs19 fc2 sc0 ls0 ws0">7.<span class="_ _e"> </span><span class="ff7">Store<span class="_"> </span>address<span class="_"> </span>computation</span></div><div class="t m5 x17 h26 y45b ff7 fs19 fc2 sc0 ls0 ws0">In<span class="_"> </span>the<span class="_ _13"> </span>above<span class="_"> </span>list,<span class="_ _13"> </span>“integer<span class="_"> </span>arithmetic”<span class="_"> </span>refers<span class="_ _13"> </span>to<span class="_"> </span>basic<span class="_ _13"> </span>operations<span class="_ _0"></span>,<span class="_"> </span>such<span class="_ _13"> </span>as<span class="_"> </span>addition,</div><div class="t m5 x17 h26 y45c ff7 fs19 fc2 sc0 ls0 ws0">bitwise<span class="_ _13"> </span>operations<span class="_ _1"></span>,<span class="_"> </span>and<span class="_ _13"> </span>shifting.<span class="_ _13"> </span>Multiplication<span class="_"> </span>and<span class="_ _13"> </span>division<span class="_ _13"> </span>require<span class="_"> </span>more<span class="_ _13"> </span>special-</div><div class="t m5 x17 h26 y227 ff7 fs19 fc2 sc0 ls0 ws0">ized<span class="_"> </span>resources<span class="_ _0"></span>.<span class="_"> </span>W<span class="_ _1"></span>e<span class="_ _11"> </span>see<span class="_"> </span>that<span class="_ _11"> </span>a<span class="_ _11"> </span>store<span class="_ _11"> </span>operation<span class="_ _11"> </span>requires<span class="_ _11"> </span>two<span class="_ _11"> </span>functional<span class="_ _11"> </span>units—one</div><div class="t m5 x17 h26 y45d ff7 fs19 fc2 sc0 ls0 ws0">to<span class="_ _11"> </span>compute<span class="_ _16"> </span>the<span class="_ _11"> </span>store<span class="_ _16"> </span>address<span class="_ _11"> </span>and<span class="_ _16"> </span>one<span class="_ _11"> </span>to<span class="_ _16"> </span>actually<span class="_ _11"> </span>store<span class="_ _11"> </span>the<span class="_ _16"> </span>data.<span class="_ _11"> </span>W<span class="_ _1"></span>e<span class="_ _11"> </span>will<span class="_ _16"> </span>discuss</div><div class="t m5 x17 h26 y45e ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span>mechanics<span class="_"> </span>of<span class="_"> </span>store<span class="_"> </span>(and<span class="_"> </span>load)<span class="_"> </span>operations<span class="_"> </span>in<span class="_"> </span>Section<span class="_"> </span>5.12.</div><div class="t m5 x26 h26 y4ad ff7 fs19 fc2 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_ _f"> </span>can<span class="_ _21"> </span>see<span class="_ _f"> </span>that<span class="_ _21"> </span>this<span class="_ _f"> </span>combination<span class="_ _21"> </span>of<span class="_ _f"> </span>functional<span class="_ _21"> </span>units<span class="_ _f"> </span>has<span class="_ _21"> </span>the<span class="_ _f"> </span>potential<span class="_ _21"> </span>to</div><div class="t m5 x17 h26 y45f ff7 fs19 fc2 sc0 ls0 ws0">perform<span class="_ _14"> </span>multiple<span class="_ _14"> </span>operations<span class="_ _14"> </span>of<span class="_ _14"> </span>the<span class="_ _15"> </span>same<span class="_ _14"> </span>type<span class="_ _14"> </span>simultaneously<span class="_ _3"></span>.<span class="_ _14"> </span>It<span class="_ _14"> </span>has<span class="_ _15"> </span>four<span class="_ _14"> </span>units</div><div class="t m5 x17 h26 y460 ff7 fs19 fc2 sc0 ls0 ws0">capable<span class="_"> </span>of<span class="_ _11"> </span>performing<span class="_ _11"> </span>integer<span class="_ _11"> </span>operations<span class="_ _1"></span>,<span class="_ _11"> </span>two<span class="_ _11"> </span>that<span class="_ _11"> </span>can<span class="_ _11"> </span>perform<span class="_ _11"> </span>load<span class="_ _11"> </span>operations<span class="_ _1"></span>,</div><div class="t m5 x17 h26 y461 ff7 fs19 fc2 sc0 ls0 ws0">and<span class="_ _6"> </span>two<span class="_ _6"> </span>that<span class="_ _6"> </span>can<span class="_ _13"> </span>perform<span class="_ _a"> </span>ﬂoating-point<span class="_ _6"> </span>multiplication.<span class="_ _13"> </span>W<span class="_ _3"></span>e<span class="_ _6"> </span>will<span class="_ _6"> </span>later<span class="_ _6"> </span>see<span class="_ _6"> </span>the<span class="_ _13"> </span>impact</div><div class="t m5 x17 h26 y322 ff7 fs19 fc2 sc0 ls0 ws0">these<span class="_"> </span>resources<span class="_"> </span>have<span class="_"> </span>on<span class="_"> </span>the<span class="_"> </span>maximum<span class="_"> </span>performance<span class="_"> </span>our<span class="_"> </span>programs<span class="_"> </span>can<span class="_"> </span>achieve<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y323 ff7 fs19 fc2 sc0 ls0 ws0">W<span class="_ _1"></span>ithin<span class="_ _13"> </span>the<span class="_"> </span>ICU<span class="_ _7"></span>,<span class="_ _13"> </span>the<span class="_ _13"> </span><span class="ffa">retirement<span class="_ _13"> </span>unit<span class="_"> </span></span>keeps<span class="_ _13"> </span>track<span class="_"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>ongoing<span class="_ _13"> </span>processing<span class="_ _13"> </span>and</div><div class="t m5 x17 h26 y324 ff7 fs19 fc2 sc0 ls0 ws0">makes<span class="_"> </span>sure<span class="_ _11"> </span>that<span class="_ _11"> </span>it<span class="_ _11"> </span>obeys<span class="_ _11"> </span>the<span class="_ _11"> </span>sequential<span class="_"> </span>semantics<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>machine-level<span class="_ _11"> </span>program.</div><div class="t m5 x17 h26 y325 ff7 fs19 fc2 sc0 ls0 ws0">Our<span class="_ _16"> </span>ﬁgure<span class="_ _16"> </span>shows<span class="_ _16"> </span>a<span class="_ _16"> </span><span class="ffa">register<span class="_ _16"> </span>ﬁle<span class="_ _16"> </span></span>containing<span class="_ _16"> </span>the<span class="_ _16"> </span>integer,<span class="_ _16"> </span>ﬂoating-point,<span class="_ _16"> </span>and,<span class="_ _16"> </span>more</div><div class="t m5 x17 h26 y326 ff7 fs19 fc2 sc0 ls0 ws0">recently<span class="_ _3"></span>,<span class="_"> </span>SSE<span class="_ _11"> </span>and<span class="_ _11"> </span>A<span class="_ _7"></span>VX<span class="_"> </span>registers<span class="_ _11"> </span>as<span class="_ _11"> </span>part<span class="_"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>retirement<span class="_"> </span>unit,<span class="_ _11"> </span>because<span class="_ _11"> </span>this<span class="_ _11"> </span>unit</div><div class="t m5 x17 h26 y319 ff7 fs19 fc2 sc0 ls0 ws0">controls<span class="_ _13"> </span>the<span class="_ _13"> </span>updating<span class="_"> </span>of<span class="_ _13"> </span>these<span class="_ _13"> </span>registers<span class="_ _1"></span>.<span class="_"> </span>As<span class="_ _13"> </span>an<span class="_ _13"> </span>instruction<span class="_ _13"> </span>is<span class="_ _13"> </span>decoded,<span class="_"> </span>information</div><div class="t m5 x17 h26 y31a ff7 fs19 fc2 sc0 ls0 ws0">about<span class="_ _f"> </span>it<span class="_ _f"> </span>is<span class="_ _e"> </span>placed<span class="_ _21"> </span>into<span class="_ _f"> </span>a<span class="_ _e"> </span>ﬁrst-in,<span class="_ _e"> </span>ﬁrst-out<span class="_ _21"> </span>queue.<span class="_ _21"> </span>This<span class="_ _21"> </span>information<span class="_ _f"> </span>remains<span class="_ _e"> </span>in</div><div class="t m5 x17 h26 y31b ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _14"> </span>queue<span class="_ _14"> </span>until<span class="_ _14"> </span>one<span class="_ _14"> </span>of<span class="_ _14"> </span>two<span class="_ _14"> </span>outcomes<span class="_ _14"> </span>occurs<span class="_ _1"></span>.<span class="_ _15"> </span>F<span class="_ _1"></span>irst,<span class="_ _15"> </span>once<span class="_ _14"> </span>the<span class="_ _14"> </span>operations<span class="_ _15"> </span>for<span class="_ _14"> </span>the</div><div class="t m5 x17 h26 y31c ff7 fs19 fc2 sc0 ls0 ws0">instruction<span class="_"> </span>have<span class="_ _11"> </span>completed<span class="_ _11"> </span>and<span class="_ _11"> </span>any<span class="_ _11"> </span>branch<span class="_ _11"> </span>points<span class="_ _11"> </span>leading<span class="_ _11"> </span>to<span class="_ _11"> </span>this<span class="_ _11"> </span>instruction<span class="_ _11"> </span>are</div><div class="t m5 x17 h26 y31d ff7 fs19 fc2 sc0 ls0 ws0">conﬁrmed<span class="_"> </span>as<span class="_"> </span>having<span class="_"> </span>been<span class="_"> </span>correctly<span class="_"> </span>predicted,<span class="_"> </span>the<span class="_"> </span>instruction<span class="_"> </span>can<span class="_"> </span>be<span class="_"> </span><span class="ffa">retired<span class="_ _2"></span></span>,<span class="_"> </span>with</div><div class="t m5 x17 h26 y31e ff7 fs19 fc2 sc0 ls0 ws0">any<span class="_ _16"> </span>updates<span class="_ _16"> </span>to<span class="_ _16"> </span>the<span class="_ _16"> </span>program<span class="_ _11"> </span>registers<span class="_ _16"> </span>being<span class="_ _16"> </span>made.<span class="_ _11"> </span>If<span class="_ _16"> </span>some<span class="_ _16"> </span>branch<span class="_ _16"> </span>point<span class="_ _16"> </span>leading</div><div class="t m5 x17 h26 y31f ff7 fs19 fc2 sc0 ls0 ws0">to<span class="_ _14"> </span>this<span class="_ _14"> </span>instruction<span class="_ _14"> </span>was<span class="_ _15"> </span>mispredicted,<span class="_ _15"> </span>on<span class="_ _14"> </span>the<span class="_ _14"> </span>other<span class="_ _15"> </span>hand,<span class="_ _15"> </span>the<span class="_ _14"> </span>instruction<span class="_ _14"> </span>will<span class="_ _15"> </span>be</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
