<div id="pf3bf" class="pf w2 h11" data-page-no="3bf"><div class="pc pc3bf w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg3bf.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">958<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>11<span class="_ _3d"> </span>Network<span class="_ _10"> </span>Programming</span></div><div class="t m5 x17e hae y7a28 ffd7 fs69 fc1 sc0 ls0 ws0">Host<span class="_ _78"> </span>Host<span class="_ _d0"> </span>Host</div><div class="t m5 x89 hae y7a29 ffd7 fs69 fc1 sc0 ls0 ws0">. . .</div><div class="t m5 x1d hae y7a2a ffd7 fs69 fc1 sc0 ls0 ws0">LAN</div><div class="t m5 x1e3 hae y7a28 ffd7 fs69 fc1 sc0 ls0 ws0">Host<span class="_ _78"> </span>Host<span class="_ _d0"> </span>Host</div><div class="t m5 x95 hae y7a29 ffd7 fs69 fc1 sc0 ls0 ws0">. . .</div><div class="t m5 x260 hae y7a2a ffd7 fs69 fc1 sc0 ls0 ws0">LAN </div><div class="t m5 x1d1 hae y7a2b ffd7 fs69 fc1 sc0 ls2d9 ws0">WA<span class="_ _2"></span>N<span class="_ _157"> </span>WA<span class="_ _2"></span>N</div><div class="t m5 x147 hae y7a2c ffd7 fs69 fc1 sc0 ls0 ws0">Router<span class="_ _51"></span>Router<span class="_ _22c"></span>Router</div><div class="t m5 x1d h34 y7a2d ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _13"> </span>11.6<span class="_ _66"> </span><span class="fc1">A<span class="_ _13"> </span>small<span class="_ _13"> </span>internet.<span class="_ _13"> </span><span class="ff6">T<span class="_ _1"></span>wo<span class="_ _13"> </span>LANs<span class="_ _13"> </span>and<span class="_ _6"> </span>two<span class="_ _13"> </span>WANs<span class="_ _6"> </span>are<span class="_ _13"> </span>connected<span class="_ _13"> </span>by<span class="_ _13"> </span>three<span class="_ _6"> </span>routers.</span></span></div><div class="t m5 x29 h26 y7a2e ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _14"> </span>crucial<span class="_ _14"> </span>property<span class="_ _14"> </span>of<span class="_ _14"> </span>an<span class="_ _14"> </span>internet<span class="_ _14"> </span>is<span class="_ _14"> </span>that<span class="_ _14"> </span>it<span class="_ _14"> </span>can<span class="_ _14"> </span>consist<span class="_ _14"> </span>of<span class="_ _14"> </span>different<span class="_ _14"> </span>LANs</div><div class="t m5 x1d h26 y7a2f ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_ _16"> </span>W<span class="_ _3"></span>ANs<span class="_ _16"> </span>with<span class="_ _16"> </span>radically<span class="_ _14"> </span>different<span class="_ _16"> </span>and<span class="_ _16"> </span>incompatible<span class="_ _14"> </span>technologies<span class="_ _1"></span>.<span class="_ _16"> </span>Each<span class="_ _16"> </span>host<span class="_ _14"> </span>is</div><div class="t m5 x1d h26 y7a30 ff7 fs19 fc1 sc0 ls0 ws0">physically<span class="_ _16"> </span>connected<span class="_ _11"> </span>to<span class="_ _16"> </span>every<span class="_ _16"> </span>other<span class="_ _16"> </span>host,<span class="_ _16"> </span>but<span class="_ _16"> </span>how<span class="_ _11"> </span>is<span class="_ _16"> </span>it<span class="_ _16"> </span>possible<span class="_ _16"> </span>for<span class="_ _11"> </span>some<span class="_ _16"> </span><span class="ffa">source</span></div><div class="t m5 x1d h26 y7a31 ffa fs19 fc1 sc0 ls0 ws0">host<span class="_ _16"> </span><span class="ff7">to<span class="_"> </span>send<span class="_"> </span>data<span class="_"> </span>bits<span class="_"> </span>to<span class="_"> </span>another<span class="_"> </span></span>destination<span class="_"> </span>host<span class="_ _16"> </span><span class="ff7">across<span class="_"> </span>all<span class="_"> </span>of<span class="_"> </span>these<span class="_"> </span>incompatible</span></div><div class="t m5 x1d h26 y7a32 ff7 fs19 fc1 sc0 ls0 ws0">networks?</div><div class="t m5 x29 h26 y7a33 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _16"> </span>solution<span class="_"> </span>is<span class="_ _16"> </span>a<span class="_"> </span>layer<span class="_ _16"> </span>of<span class="_ _11"> </span><span class="ffa">protocol<span class="_ _11"> </span>software<span class="_ _11"> </span></span>running<span class="_ _16"> </span>on<span class="_"> </span>each<span class="_ _16"> </span>host<span class="_ _11"> </span>and<span class="_ _11"> </span>router</div><div class="t m5 x1d h26 y7a34 ff7 fs19 fc1 sc0 ls0 ws0">that<span class="_"> </span>smoothes<span class="_ _11"> </span>out<span class="_ _11"> </span>the<span class="_ _11"> </span>differences<span class="_ _11"> </span>between<span class="_ _11"> </span>the<span class="_ _11"> </span>different<span class="_ _11"> </span>networks<span class="_ _1"></span>.<span class="_ _11"> </span>This<span class="_"> </span>software</div><div class="t m5 x1d h26 y7a35 ff7 fs19 fc1 sc0 ls0 ws0">implements<span class="_"> </span>a<span class="_ _11"> </span><span class="ffa">protocol<span class="_ _16"> </span></span>that<span class="_ _11"> </span>governs<span class="_ _11"> </span>how<span class="_"> </span>hosts<span class="_ _11"> </span>and<span class="_ _11"> </span>routers<span class="_ _11"> </span>cooperate<span class="_ _11"> </span>in<span class="_"> </span>order<span class="_ _11"> </span>to</div><div class="t m5 x1d h26 y7a36 ff7 fs19 fc1 sc0 ls0 ws0">transfer<span class="_"> </span>data.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_"> </span>protocol<span class="_"> </span>must<span class="_"> </span>provide<span class="_"> </span>two<span class="_"> </span>basic<span class="_"> </span>capabilities:</div><div class="t m5 x75 h26 y7a37 ffa fs19 fc1 sc0 ls0 ws0">Naming<span class="_"> </span>sc<span class="_ _1"></span>heme<span class="_ _2"></span><span class="ff7">.<span class="_ _e"> </span>Different<span class="_"> </span>LAN<span class="_ _13"> </span>technologies<span class="_"> </span>have<span class="_"> </span>different<span class="_ _13"> </span>and<span class="_"> </span>incompatible</span></div><div class="t m5 xcd h26 y7a38 ff7 fs19 fc1 sc0 ls0 ws0">ways<span class="_ _6"> </span>of<span class="_ _6"> </span>assigning<span class="_ _6"> </span>addresses<span class="_ _13"> </span>to<span class="_ _a"> </span>hosts<span class="_ _1"></span>.<span class="_ _13"> </span>T<span class="_ _1"></span>he<span class="_ _6"> </span>internet<span class="_ _6"> </span>protocol<span class="_ _6"> </span>smoothes<span class="_ _13"> </span>these</div><div class="t m5 xcd h26 y7a39 ff7 fs19 fc1 sc0 ls0 ws0">differences<span class="_ _16"> </span>by<span class="_ _14"> </span>deﬁning<span class="_ _14"> </span>a<span class="_ _14"> </span>uniform<span class="_ _14"> </span>format<span class="_ _16"> </span>for<span class="_ _14"> </span>host<span class="_ _14"> </span>addresses<span class="_ _1"></span>.<span class="_ _14"> </span>Each<span class="_ _14"> </span>host</div><div class="t m5 xcd h26 y7a3a ff7 fs19 fc1 sc0 ls0 ws0">is<span class="_ _21"> </span>then<span class="_ _21"> </span>assigned<span class="_ _f"> </span>at<span class="_ _21"> </span>least<span class="_ _f"> </span>one<span class="_ _21"> </span>of<span class="_ _f"> </span>these<span class="_ _21"> </span><span class="ffa">internet<span class="_ _f"> </span>addresses<span class="_ _21"> </span></span>that<span class="_ _f"> </span>uniquely</div><div class="t m5 xcd h26 y7a3b ff7 fs19 fc1 sc0 ls0 ws0">identiﬁes<span class="_"> </span>it.</div><div class="t m5 x75 h26 y7a3c ffa fs19 fc1 sc0 ls0 ws0">Delivery<span class="_ _f"> </span>mechanism<span class="ff7">.<span class="_ _e"> </span>Different<span class="_ _e"> </span>networking<span class="_ _f"> </span>technologies<span class="_ _e"> </span>have<span class="_ _f"> </span>different<span class="_ _e"> </span>and</span></div><div class="t m5 xcd h26 y7a3d ff7 fs19 fc1 sc0 ls0 ws0">incompatible<span class="_"> </span>ways<span class="_ _11"> </span>of<span class="_"> </span>encoding<span class="_ _11"> </span>bits<span class="_"> </span>on<span class="_ _11"> </span>wires<span class="_ _11"> </span>and<span class="_"> </span>of<span class="_ _11"> </span>packaging<span class="_"> </span>these<span class="_ _11"> </span>bits</div><div class="t m5 xcd h26 y7a3e ff7 fs19 fc1 sc0 ls0 ws0">into<span class="_ _13"> </span>frames<span class="_ _1"></span>.<span class="_ _13"> </span>T<span class="_ _1"></span>he<span class="_"> </span>internet<span class="_ _13"> </span>protocol<span class="_ _13"> </span>smoothes<span class="_ _13"> </span>these<span class="_ _13"> </span>differences<span class="_ _13"> </span>by<span class="_ _13"> </span>deﬁning</div><div class="t m5 xcd h26 y7a3f ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_ _6"> </span>uniform<span class="_ _6"> </span>way<span class="_ _6"> </span>to<span class="_ _13"> </span>bundle<span class="_ _a"> </span>up<span class="_ _6"> </span>data<span class="_ _13"> </span>bits<span class="_ _a"> </span>into<span class="_ _6"> </span>discrete<span class="_ _13"> </span>chunks<span class="_ _a"> </span>called<span class="_ _13"> </span><span class="ffa">pac<span class="_ _1"></span>kets<span class="_ _2"></span><span class="ff7 ls2da">.A</span></span></div><div class="t m5 xcd h26 y7a40 ff7 fs19 fc1 sc0 ls0 ws0">packet<span class="_"> </span>consists<span class="_ _13"> </span>of<span class="_"> </span>a<span class="_"> </span><span class="ffa">header</span>,<span class="_"> </span>which<span class="_"> </span>contains<span class="_"> </span>the<span class="_ _13"> </span>packet<span class="_"> </span>size<span class="_"> </span>and<span class="_ _13"> </span>addresses</div><div class="t m5 xcd h26 y7a41 ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_ _16"> </span>the<span class="_ _11"> </span>source<span class="_ _16"> </span>and<span class="_ _16"> </span>destination<span class="_ _11"> </span>hosts<span class="_ _1"></span>,<span class="_ _16"> </span>and<span class="_ _16"> </span>a<span class="_ _16"> </span><span class="ffa">pa<span class="_ _0"></span>yload<span class="_ _2"></span><span class="ff7">,<span class="_ _16"> </span>which<span class="_ _11"> </span>contains<span class="_ _16"> </span>data</span></span></div><div class="t m5 xcd h26 y7a42 ff7 fs19 fc1 sc0 ls0 ws0">bits<span class="_"> </span>sent<span class="_"> </span>from<span class="_"> </span>the<span class="_"> </span>source<span class="_"> </span>host.</div><div class="t m5 x29 h26 y7a43 ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_ _e"> </span>11.7<span class="_ _21"> </span>shows<span class="_ _f"> </span>an<span class="_ _f"> </span>example<span class="_ _e"> </span>of<span class="_ _21"> </span>how<span class="_ _f"> </span>hosts<span class="_ _f"> </span>and<span class="_ _e"> </span>routers<span class="_ _21"> </span>use<span class="_ _f"> </span>the<span class="_ _f"> </span>internet</div><div class="t m5 x1d h26 y7a44 ff7 fs19 fc1 sc0 ls0 ws0">protocol<span class="_ _6"> </span>to<span class="_ _6"> </span>transfer<span class="_ _13"> </span>data<span class="_ _6"> </span>across<span class="_ _6"> </span>incompatible<span class="_ _6"> </span>LANs<span class="_ _0"></span>.<span class="_ _6"> </span>T<span class="_ _0"></span>he<span class="_ _6"> </span>example<span class="_ _6"> </span>internet<span class="_ _13"> </span>consists</div><div class="t m5 x1d h26 y7a45 ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_ _13"> </span>two<span class="_ _13"> </span>LANs<span class="_ _13"> </span>connected<span class="_ _13"> </span>by<span class="_ _13"> </span>a<span class="_ _13"> </span>router.<span class="_ _13"> </span>A<span class="_ _13"> </span>client<span class="_ _13"> </span>running<span class="_ _13"> </span>on<span class="_"> </span>host<span class="_ _13"> </span>A,<span class="_ _13"> </span>which<span class="_ _13"> </span>is<span class="_ _13"> </span>attached</div><div class="t m5 x1d h26 y7a46 ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_"> </span>LAN1,<span class="_ _16"> </span>sends<span class="_"> </span>a<span class="_ _11"> </span>sequence<span class="_ _11"> </span>of<span class="_ _11"> </span>data<span class="_ _11"> </span>bytes<span class="_ _11"> </span>to<span class="_ _11"> </span>a<span class="_ _11"> </span>server<span class="_ _11"> </span>running<span class="_ _11"> </span>on<span class="_ _11"> </span>host<span class="_ _11"> </span>B<span class="_ _3"></span>,<span class="_ _11"> </span>which<span class="_ _11"> </span>is</div><div class="t m5 x1d h26 y7a47 ff7 fs19 fc1 sc0 ls0 ws0">attached<span class="_"> </span>to<span class="_"> </span>LAN2.<span class="_"> </span>T<span class="_ _1"></span>here<span class="_"> </span>are<span class="_"> </span>eight<span class="_"> </span>basic<span class="_"> </span>steps:</div><div class="t m5 xc5 h26 y7a48 ffc fs19 fc1 sc0 ls0 ws0">1.<span class="_ _e"> </span><span class="ff7">The<span class="_ _6"> </span>client<span class="_ _13"> </span>on<span class="_ _6"> </span>host<span class="_ _13"> </span>A<span class="_ _6"> </span>invokes<span class="_ _13"> </span>a<span class="_ _6"> </span>system<span class="_ _6"> </span>call<span class="_ _13"> </span>that<span class="_ _6"> </span>copies<span class="_ _13"> </span>the<span class="_ _6"> </span>data<span class="_ _13"> </span>from<span class="_ _6"> </span>the<span class="_ _13"> </span>client’<span class="_ _0"></span>s</span></div><div class="t m5 x29 h26 y7a49 ff7 fs19 fc1 sc0 ls0 ws0">virtual<span class="_"> </span>address<span class="_"> </span>space<span class="_"> </span>into<span class="_"> </span>a<span class="_"> </span>kernel<span class="_"> </span>buffer.</div><div class="t m5 xc5 h26 y7a4a ffc fs19 fc1 sc0 ls0 ws0">2.<span class="_ _e"> </span><span class="ff7">The<span class="_ _14"> </span>protocol<span class="_ _21"> </span>software<span class="_ _15"> </span>on<span class="_ _15"> </span>host<span class="_ _21"> </span>A<span class="_ _15"> </span>creates<span class="_ _15"> </span>a<span class="_ _15"> </span>LAN1<span class="_ _21"> </span>frame<span class="_ _15"> </span>by<span class="_ _15"> </span>appending<span class="_ _21"> </span>an</span></div><div class="t m5 x29 h26 y7a4b ff7 fs19 fc1 sc0 ls0 ws0">internet<span class="_ _11"> </span>header<span class="_ _16"> </span>and<span class="_ _11"> </span>a<span class="_ _16"> </span>LAN1<span class="_ _11"> </span>frame<span class="_ _16"> </span>header<span class="_ _11"> </span>to<span class="_ _16"> </span>the<span class="_ _11"> </span>data.<span class="_ _16"> </span>T<span class="_ _1"></span>he<span class="_ _16"> </span>internet<span class="_ _11"> </span>header</div><div class="t m5 x29 h26 y7a4c ff7 fs19 fc1 sc0 ls0 ws0">is<span class="_ _11"> </span>addressed<span class="_ _11"> </span>to<span class="_ _11"> </span>internet<span class="_ _11"> </span>host<span class="_ _11"> </span>B<span class="_ _1"></span>.<span class="_ _11"> </span>T<span class="_ _1"></span>he<span class="_ _11"> </span>LAN1<span class="_ _11"> </span>frame<span class="_ _16"> </span>header<span class="_"> </span>is<span class="_ _11"> </span>addressed<span class="_ _11"> </span>to<span class="_ _11"> </span>the</div><div class="t m5 x29 h26 y7a4d ff7 fs19 fc1 sc0 ls0 ws0">router.<span class="_ _13"> </span>It<span class="_"> </span>then<span class="_ _13"> </span>passes<span class="_"> </span>the<span class="_ _13"> </span>frame<span class="_"> </span>to<span class="_ _13"> </span>the<span class="_ _13"> </span>adapter.<span class="_"> </span>Notice<span class="_ _13"> </span>that<span class="_"> </span>the<span class="_ _13"> </span>payload<span class="_"> </span>of<span class="_ _13"> </span>the</div><div class="t m5 x29 h26 y7a4e ff7 fs19 fc1 sc0 ls0 ws0">LAN1<span class="_ _13"> </span>frame<span class="_ _13"> </span>is<span class="_ _13"> </span>an<span class="_"> </span>internet<span class="_ _13"> </span>packet,<span class="_ _13"> </span>whose<span class="_ _13"> </span>payload<span class="_ _13"> </span>is<span class="_ _13"> </span>the<span class="_"> </span>actual<span class="_ _13"> </span>user<span class="_ _13"> </span>data.<span class="_ _13"> </span>T<span class="_ _1"></span>his</div><div class="t m5 x29 h26 y7a4f ff7 fs19 fc1 sc0 ls0 ws0">kind<span class="_"> </span>of<span class="_"> </span><span class="ffa">encapsulation<span class="_"> </span></span>is<span class="_"> </span>one<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>fundamental<span class="_"> </span>insights<span class="_"> </span>of<span class="_"> </span>internetworking<span class="_ _0"></span>.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
