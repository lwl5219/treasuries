<div id="pf1b1" class="pf w2 h11" data-page-no="1b1"><div class="pc pc1b1 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1b1.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">432<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>4<span class="_ _3d"> </span>Processor<span class="_ _10"> </span>Architecture</span></div><div class="t m5 x1d h41 ye7 ffe fs29 fc2 sc0 ls0 ws0">4.3.2<span class="_ _48"> </span><span class="fs19">SEQ<span class="_"> </span>Hardware<span class="_"> </span>Structure</span></div><div class="t m5 x1d h26 ybbe ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>computations<span class="_ _13"> </span>required<span class="_"> </span>to<span class="_ _13"> </span>implement<span class="_"> </span>all<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_"> </span>Y86-64<span class="_ _13"> </span>instructions<span class="_"> </span>can<span class="_ _13"> </span>be<span class="_"> </span>or<span class="_ _3"></span>-</div><div class="t m5 x1d h26 ybbf ff7 fs19 fc2 sc0 ls0 ws0">ganized<span class="_"> </span>as<span class="_ _13"> </span>a<span class="_"> </span>series<span class="_ _13"> </span>of<span class="_"> </span>six<span class="_ _13"> </span>basic<span class="_"> </span>stages:<span class="_ _13"> </span>fetch,<span class="_"> </span>decode<span class="_ _1"></span>,<span class="_"> </span>execute<span class="_ _1"></span>,<span class="_"> </span>memory<span class="_ _3"></span>,<span class="_"> </span>write<span class="_ _13"> </span>back,</div><div class="t m5 x1d h26 ybc0 ff7 fs19 fc2 sc0 ls0 ws0">and<span class="_ _6"> </span>PC<span class="_ _13"> </span>update<span class="_ _1"></span>.<span class="_ _13"> </span>F<span class="_ _1"></span>igure<span class="_ _6"> </span>4.22<span class="_ _13"> </span>shows<span class="_ _6"> </span>an<span class="_ _6"> </span>abstract<span class="_ _13"> </span>view<span class="_ _6"> </span>of<span class="_ _13"> </span>a<span class="_ _a"> </span>hardware<span class="_ _13"> </span>structure<span class="_ _6"> </span>that<span class="_ _13"> </span>can</div><div class="t m5 x1d h26 ybc1 ff7 fs19 fc2 sc0 ls0 ws0">perform<span class="_ _11"> </span>these<span class="_ _11"> </span>computations<span class="_ _1"></span>.<span class="_ _16"> </span>T<span class="_ _1"></span>he<span class="_ _11"> </span>program<span class="_ _11"> </span>counter<span class="_ _16"> </span>is<span class="_"> </span>stored<span class="_ _16"> </span>in<span class="_ _11"> </span>a<span class="_ _11"> </span>register,<span class="_ _11"> </span>shown</div><div class="t m5 x1d h26 ybc2 ff7 fs19 fc2 sc0 ls0 ws0">in<span class="_"> </span>the<span class="_"> </span>lower<span class="_"> </span>left-hand<span class="_"> </span>corner<span class="_"> </span>(labeled<span class="_"> </span>“PC”).<span class="_ _13"> </span>Information<span class="_"> </span>then<span class="_"> </span>ﬂows<span class="_"> </span>along<span class="_"> </span>wires</div><div class="t m5 x1d h26 y119b ff7 fs19 fc2 sc0 ls0 ws0">(shown<span class="_ _11"> </span>grouped<span class="_ _16"> </span>together<span class="_ _11"> </span>as<span class="_ _11"> </span>a<span class="_ _11"> </span>heavy<span class="_ _16"> </span>gray<span class="_ _11"> </span>line),<span class="_ _16"> </span>ﬁrst<span class="_ _11"> </span>upward<span class="_ _11"> </span>and<span class="_ _16"> </span>then<span class="_ _11"> </span>around<span class="_ _11"> </span>to</div><div class="t m5 x1d h26 y119c ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span>right.<span class="_ _13"> </span>Processing<span class="_"> </span>is<span class="_"> </span>performed<span class="_ _13"> </span>by<span class="_"> </span><span class="ffa">hardware<span class="_ _13"> </span>units<span class="_"> </span></span>associated<span class="_"> </span>with<span class="_ _13"> </span>the<span class="_"> </span>different</div><div class="t m5 x1d h26 y216 ff7 fs19 fc2 sc0 ls0 ws0">stages<span class="_ _1"></span>.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_"> </span>feedback<span class="_ _11"> </span>paths<span class="_"> </span>coming<span class="_"> </span>back<span class="_"> </span>down<span class="_"> </span>on<span class="_"> </span>the<span class="_"> </span>right-hand<span class="_"> </span>side<span class="_"> </span>contain<span class="_"> </span>the</div><div class="t m5 x1d h26 y2364 ff7 fs19 fc2 sc0 ls0 ws0">updated<span class="_ _11"> </span>values<span class="_ _11"> </span>to<span class="_ _16"> </span>write<span class="_ _11"> </span>to<span class="_ _11"> </span>the<span class="_ _16"> </span>register<span class="_"> </span>ﬁle<span class="_ _16"> </span>and<span class="_ _11"> </span>the<span class="_ _11"> </span>updated<span class="_ _16"> </span>program<span class="_ _11"> </span>counter.<span class="_"> </span>In</div><div class="t m5 x1d h26 y2365 ff7 fs19 fc2 sc0 ls0 ws0">SEQ,<span class="_ _13"> </span>all<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>processing<span class="_ _13"> </span>by<span class="_ _13"> </span>the<span class="_ _13"> </span>hardware<span class="_ _6"> </span>units<span class="_ _13"> </span>occurs<span class="_ _13"> </span>within<span class="_ _13"> </span>a<span class="_ _13"> </span>single<span class="_ _13"> </span>clock<span class="_ _13"> </span>c<span class="_ _0"></span>ycle<span class="_ _1"></span>,</div><div class="t m5 x1d h26 y320 ff7 fs19 fc2 sc0 ls0 ws0">as<span class="_ _11"> </span>is<span class="_ _16"> </span>discussed<span class="_ _11"> </span>in<span class="_ _16"> </span>Section<span class="_ _16"> </span>4.3.3.<span class="_ _11"> </span>T<span class="_ _0"></span>his<span class="_ _11"> </span>diagram<span class="_ _16"> </span>omits<span class="_ _11"> </span>some<span class="_ _16"> </span>small<span class="_ _11"> </span>blocks<span class="_ _16"> </span>of<span class="_ _16"> </span>combi-</div><div class="t m5 x1d h26 y321 ff7 fs19 fc2 sc0 ls0 ws0">national<span class="_ _16"> </span>logic<span class="_ _16"> </span>as<span class="_ _14"> </span>well<span class="_ _16"> </span>as<span class="_ _16"> </span>all<span class="_ _14"> </span>of<span class="_ _16"> </span>the<span class="_ _14"> </span>control<span class="_ _16"> </span>logic<span class="_ _16"> </span>needed<span class="_ _14"> </span>to<span class="_ _16"> </span>operate<span class="_ _16"> </span>the<span class="_ _14"> </span>different</div><div class="t m5 x1d h26 y301 ff7 fs19 fc2 sc0 ls0 ws0">hardware<span class="_"> </span>units<span class="_ _11"> </span>and<span class="_ _11"> </span>to<span class="_ _11"> </span>route<span class="_"> </span>the<span class="_ _11"> </span>appropriate<span class="_ _11"> </span>values<span class="_ _11"> </span>to<span class="_"> </span>the<span class="_ _11"> </span>units<span class="_ _1"></span>.<span class="_ _11"> </span>W<span class="_ _3"></span>e<span class="_ _11"> </span>will<span class="_ _11"> </span>add<span class="_ _11"> </span>this</div><div class="t m5 x1d h26 y302 ff7 fs19 fc2 sc0 ls0 ws0">detail<span class="_"> </span>later.<span class="_ _11"> </span>Our<span class="_ _11"> </span>method<span class="_ _11"> </span>of<span class="_"> </span>drawing<span class="_ _11"> </span>processors<span class="_ _11"> </span>with<span class="_ _11"> </span>the<span class="_ _11"> </span>ﬂow<span class="_ _11"> </span>going<span class="_ _11"> </span>from<span class="_ _11"> </span>bottom</div><div class="t m5 x1d h26 y303 ff7 fs19 fc2 sc0 ls0 ws0">to<span class="_"> </span>top<span class="_"> </span>is<span class="_"> </span>unconventional.<span class="_"> </span>W<span class="_ _7"></span>e<span class="_"> </span>will<span class="_"> </span>explain<span class="_"> </span>the<span class="_"> </span>reason<span class="_"> </span>for<span class="_"> </span>this<span class="_"> </span>convention<span class="_ _13"> </span>when<span class="_"> </span>we</div><div class="t m5 x1d h26 y304 ff7 fs19 fc2 sc0 ls0 ws0">start<span class="_"> </span>designing<span class="_"> </span>pipelined<span class="_"> </span>processors<span class="_ _1"></span>.</div><div class="t m5 x29 h26 y305 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>hardware<span class="_"> </span>units<span class="_"> </span>are<span class="_"> </span>associated<span class="_"> </span>with<span class="_"> </span>the<span class="_"> </span>different<span class="_"> </span>processing<span class="_"> </span>stages:</div><div class="t m5 x75 h26 y3bc5 ffa fs19 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>etch.<span class="_ _15"> </span><span class="ff7">Using<span class="_ _11"> </span>the<span class="_"> </span>program<span class="_ _11"> </span>counter<span class="_"> </span>register<span class="_ _11"> </span>as<span class="_"> </span>an<span class="_ _11"> </span>address<span class="_ _1"></span>,<span class="_"> </span>the<span class="_ _11"> </span>instruction<span class="_"> </span>mem-</span></div><div class="t m5 xcd h26 y3bc6 ff7 fs19 fc2 sc0 ls0 ws0">ory<span class="_ _13"> </span>reads<span class="_"> </span>the<span class="_ _13"> </span>bytes<span class="_"> </span>of<span class="_ _13"> </span>an<span class="_ _13"> </span>instruction.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_"> </span>PC<span class="_ _13"> </span>incrementer<span class="_ _13"> </span>computes<span class="_"> </span><span class="ff6">valP</span>,</div><div class="t m5 xcd h26 y309 ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span>incremented<span class="_"> </span>program<span class="_"> </span>counter.</div><div class="t m5 x75 h26 y224 ffa fs19 fc2 sc0 ls0 ws0">Decode.<span class="_ _15"> </span><span class="ff7">T<span class="_ _0"></span>he<span class="_"> </span>register<span class="_ _13"> </span>ﬁle<span class="_"> </span>has<span class="_ _13"> </span>two<span class="_"> </span>read<span class="_"> </span>ports<span class="_ _3"></span>,<span class="_"> </span>A<span class="_ _13"> </span>and<span class="_"> </span>B<span class="_ _3"></span>,<span class="_"> </span>via<span class="_"> </span>which<span class="_ _13"> </span>register<span class="_"> </span>values</span></div><div class="t m5 xcd h26 y3bc7 ff6 fs19 fc2 sc0 ls0 ws0">valA<span class="_ _10"> </span><span class="ff7">and<span class="_"> </span></span>valB<span class="_ _10"> </span><span class="ff7">are<span class="_"> </span>read<span class="_"> </span>simultaneously<span class="_ _3"></span>.</span></div><div class="t m5 x75 h26 y3bc8 ffa fs19 fc2 sc0 ls0 ws0">Execute<span class="_ _1"></span>.<span class="_ _21"> </span><span class="ff7">The<span class="_ _11"> </span>execute<span class="_ _11"> </span>stage<span class="_ _16"> </span>uses<span class="_ _11"> </span>the<span class="_ _16"> </span>arithmetic/logic<span class="_ _11"> </span>(ALU)<span class="_ _16"> </span>unit<span class="_ _11"> </span>for<span class="_ _16"> </span>different</span></div><div class="t m5 xcd h26 y3bc9 ff7 fs19 fc2 sc0 ls0 ws0">purposes<span class="_"> </span>according<span class="_ _13"> </span>to<span class="_"> </span>the<span class="_"> </span>instruction<span class="_ _13"> </span>type.<span class="_ _13"> </span>F<span class="_ _1"></span>or<span class="_"> </span>integer<span class="_"> </span>operations<span class="_ _3"></span>,<span class="_"> </span>it<span class="_"> </span>per<span class="_ _3"></span>-</div><div class="t m5 xcd h26 y3bca ff7 fs19 fc2 sc0 ls0 ws0">forms<span class="_ _13"> </span>the<span class="_ _13"> </span>speciﬁed<span class="_ _13"> </span>operation.<span class="_ _13"> </span>F<span class="_ _1"></span>or<span class="_ _13"> </span>other<span class="_ _13"> </span>instructions<span class="_ _1"></span>,<span class="_"> </span>it<span class="_ _13"> </span>serves<span class="_ _13"> </span>as<span class="_ _13"> </span>an<span class="_ _13"> </span>adder</div><div class="t m5 xcd h26 y229 ff7 fs19 fc2 sc0 ls0 ws0">to<span class="_ _14"> </span>compute<span class="_ _14"> </span>an<span class="_ _14"> </span>incremented<span class="_ _14"> </span>or<span class="_ _14"> </span>decremented<span class="_ _14"> </span>stack<span class="_ _14"> </span>pointer,<span class="_ _14"> </span>to<span class="_ _14"> </span>compute</div><div class="t m5 xcd h26 y3bcb ff7 fs19 fc2 sc0 ls0 ws0">an<span class="_ _11"> </span>effective<span class="_ _16"> </span>address<span class="_ _3"></span>,<span class="_ _16"> </span>or<span class="_ _11"> </span>simply<span class="_ _16"> </span>to<span class="_ _11"> </span>pass<span class="_ _11"> </span>one<span class="_ _16"> </span>of<span class="_ _11"> </span>its<span class="_ _11"> </span>inputs<span class="_ _16"> </span>to<span class="_ _11"> </span>its<span class="_ _11"> </span>outputs<span class="_ _16"> </span>by</div><div class="t m5 xcd h26 y3bcc ff7 fs19 fc2 sc0 ls0 ws0">adding<span class="_"> </span>zero<span class="_ _1"></span>.</div><div class="t m5 x1c6 h26 y3bcd ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>condition<span class="_ _13"> </span>code<span class="_ _13"> </span>register<span class="_ _13"> </span>(CC)<span class="_"> </span>holds<span class="_ _13"> </span>the<span class="_ _13"> </span>three<span class="_ _13"> </span>condition<span class="_"> </span>code<span class="_ _13"> </span>bits<span class="_ _1"></span>.</div><div class="t m5 xcd h26 y3bce ff7 fs19 fc2 sc0 ls0 ws0">New<span class="_ _14"> </span>values<span class="_ _15"> </span>for<span class="_ _14"> </span>the<span class="_ _15"> </span>condition<span class="_ _15"> </span>codes<span class="_ _14"> </span>are<span class="_ _15"> </span>computed<span class="_ _15"> </span>by<span class="_ _14"> </span>the<span class="_ _15"> </span>ALU<span class="_ _3"></span>.<span class="_ _14"> </span>When</div><div class="t m5 xcd h26 y3bcf ff7 fs19 fc2 sc0 ls0 ws0">executing<span class="_ _16"> </span>a<span class="_ _16"> </span>conditional<span class="_ _11"> </span>move<span class="_ _16"> </span>instruction,<span class="_ _16"> </span>the<span class="_ _16"> </span>decision<span class="_ _16"> </span>as<span class="_ _16"> </span>to<span class="_ _16"> </span>whether<span class="_ _16"> </span>or</div><div class="t m5 xcd h26 y3bd0 ff7 fs19 fc2 sc0 ls0 ws0">not<span class="_ _13"> </span>to<span class="_ _13"> </span>update<span class="_ _13"> </span>the<span class="_ _13"> </span>destination<span class="_ _13"> </span>register<span class="_ _13"> </span>is<span class="_"> </span>computed<span class="_ _13"> </span>based<span class="_ _13"> </span>on<span class="_ _13"> </span>the<span class="_ _13"> </span>condition</div><div class="t m5 xcd h26 y3bd1 ff7 fs19 fc2 sc0 ls0 ws0">codes<span class="_"> </span>and<span class="_"> </span>move<span class="_"> </span>condition.<span class="_"> </span>Similarly<span class="_ _7"></span>,<span class="_"> </span>when<span class="_"> </span>executing<span class="_"> </span>a<span class="_"> </span>jump<span class="_"> </span>instruction,</div><div class="t m5 xcd h26 y3bd2 ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span>branch<span class="_"> </span>signal<span class="_ _13"> </span><span class="ff6">Cnd<span class="_ _10"> </span></span>is<span class="_"> </span>computed<span class="_"> </span>based<span class="_"> </span>on<span class="_"> </span>the<span class="_ _13"> </span>condition<span class="_"> </span>codes<span class="_"> </span>and<span class="_"> </span>the</div><div class="t m5 xcd h26 y3bd3 ff7 fs19 fc2 sc0 ls0 ws0">jump<span class="_"> </span>type<span class="_ _1"></span>.</div><div class="t m5 x75 h26 y3bd4 ffa fs19 fc2 sc0 ls0 ws0">Memory<span class="_ _1"></span>.<span class="_ _21"> </span><span class="ff7">T<span class="_ _0"></span>he<span class="_ _13"> </span>data<span class="_ _6"> </span>memory<span class="_ _13"> </span>reads<span class="_ _13"> </span>or<span class="_ _13"> </span>writes<span class="_ _6"> </span>a<span class="_ _13"> </span>word<span class="_ _13"> </span>of<span class="_ _6"> </span>memory<span class="_ _13"> </span>when<span class="_ _13"> </span>executing<span class="_ _13"> </span>a</span></div><div class="t m5 xcd h26 y3bd5 ff7 fs19 fc2 sc0 ls0 ws0">memory<span class="_"> </span>instruction.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_"> </span>instruction<span class="_ _11"> </span>and<span class="_"> </span>data<span class="_"> </span>memories<span class="_"> </span>access<span class="_"> </span>the<span class="_"> </span>same</div><div class="t m5 xcd h26 y3bd6 ff7 fs19 fc2 sc0 ls0 ws0">memory<span class="_"> </span>locations<span class="_ _1"></span>,<span class="_"> </span>but<span class="_"> </span>for<span class="_"> </span>different<span class="_"> </span>purposes<span class="_ _1"></span>.</div><div class="t m5 x75 h26 y31d ffa fs19 fc2 sc0 ls0 ws0">Write<span class="_"> </span>back.<span class="_ _21"> </span><span class="ff7">T<span class="_ _0"></span>he<span class="_"> </span>register<span class="_ _11"> </span>ﬁle<span class="_"> </span>has<span class="_ _11"> </span>two<span class="_"> </span>write<span class="_ _11"> </span>ports<span class="_ _1"></span>.<span class="_ _11"> </span>P<span class="_ _1"></span>ort<span class="_ _11"> </span>E<span class="_"> </span>is<span class="_ _11"> </span>used<span class="_"> </span>to<span class="_ _11"> </span>write<span class="_"> </span>values</span></div><div class="t m5 xcd h26 y31e ff7 fs19 fc2 sc0 ls0 ws0">computed<span class="_ _13"> </span>by<span class="_ _13"> </span>the<span class="_ _13"> </span>ALU<span class="_ _3"></span>,<span class="_ _13"> </span>while<span class="_ _13"> </span>port<span class="_"> </span>M<span class="_ _13"> </span>is<span class="_ _13"> </span>used<span class="_ _13"> </span>to<span class="_ _13"> </span>write<span class="_ _13"> </span>values<span class="_ _13"> </span>read<span class="_ _13"> </span>from<span class="_ _13"> </span>the</div><div class="t m5 xcd h26 y31f ff7 fs19 fc2 sc0 ls0 ws0">data<span class="_"> </span>memory<span class="_ _3"></span>.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
