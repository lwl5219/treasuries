<div id="pf20e" class="pf w2 h11" data-page-no="20e"><div class="pc pc20e w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg20e.png"/><div class="t m5 x107 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Solutions<span class="_ _10"> </span>to<span class="_ _10"> </span>Practice<span class="_ _10"> </span>Problems<span class="_ _1b"> </span><span class="ffe fs1e">525</span></div><div class="t m5 x17 h2d y140c ffd fs1e fc2 sc0 ls0 ws0">word<span class="_ _e"> </span>mem_data<span class="_ _1f"> </span>=<span class="_ _1f"> </span>[</div><div class="t m5 x21e h2d y140d ffd fs1e fc2 sc0 ls0 ws0">#<span class="_ _e"> </span>Value<span class="_ _1f"> </span>from<span class="_ _1f"> </span>register</div><div class="t m5 x21e h2d y1b95 ffd fs1e fc2 sc0 ls0 ws0">icode<span class="_ _e"> </span>in<span class="_ _1f"> </span>{<span class="_ _1f"> </span>IRMMOVQ,<span class="_ _e"> </span>IPUSHQ<span class="_ _1f"> </span>}<span class="_ _e"> </span>:<span class="_ _1f"> </span>valA;</div><div class="t m5 x21e h2d y2122 ffd fs1e fc2 sc0 ls0 ws0">#<span class="_ _e"> </span>Return<span class="_ _1f"> </span>PC</div><div class="t m5 x21e h2d y1b96 ffd fs1e fc2 sc0 ls0 ws0">icode<span class="_ _e"> </span>==<span class="_ _1f"> </span>ICALL<span class="_ _1f"> </span>:<span class="_ _e"> </span>valP;</div><div class="t m5 x21e h2d y1b97 ffd fs1e fc2 sc0 ls0 ws0">#<span class="_ _e"> </span>Default:<span class="_ _1f"> </span>Don’t<span class="_ _1f"> </span>write<span class="_ _e"> </span>anything</div><div class="t m5 x17 h2d y1b98 ffd fs1e fc2 sc0 ls0 ws0">];</div><div class="t m5 x17 h28 y48d2 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>4.26</div><div class="t m5 x112 h2f y48d3 ffe fs16 fc6 sc0 ls0 ws0">(page<span class="_"> </span>446)</div><div class="t m5 x17 h26 y48d4 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_"> </span>code<span class="_"> </span>is<span class="_"> </span>similar<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>code<span class="_"> </span>for<span class="_"> </span><span class="ff6">mem_read</span>.</div><div class="t m5 x17 h2d y48d5 ffd fs1e fc2 sc0 ls0 ws0">bool<span class="_ _e"> </span>mem_write<span class="_ _1f"> </span>=<span class="_ _1f"> </span>icode<span class="_ _e"> </span>in<span class="_ _1f"> </span>{<span class="_ _e"> </span>IRMMOVQ,<span class="_ _1f"> </span>IPUSHQ,<span class="_ _1f"> </span>ICALL<span class="_ _e"> </span>};</div><div class="t m5 x17 h28 y48d6 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>4.27</div><div class="t m5 x112 h2f y48d7 ffe fs16 fc6 sc0 ls0 ws0">(page<span class="_"> </span>447)</div><div class="t m5 x17 h26 y48d8 ff7 fs19 fc1 sc0 ls0 ws0">Computing<span class="_ _6"> </span>the<span class="_ _6"> </span><span class="ff6">Stat<span class="_ _6"> </span></span>ﬁeld<span class="_ _a"> </span>requires<span class="_ _6"> </span>collecting<span class="_ _6"> </span>status<span class="_ _6"> </span>information<span class="_ _6"> </span>from<span class="_ _6"> </span>several<span class="_ _6"> </span>stages:</div><div class="t m5 x17 h2d y48d9 ffd fs1e fc2 sc0 ls0 ws0">##<span class="_ _e"> </span>Determine<span class="_ _1f"> </span>instruction<span class="_ _1f"> </span>status</div><div class="t m5 x17 h2d y48da ffd fs1e fc2 sc0 ls0 ws0">word<span class="_ _e"> </span>Stat<span class="_ _1f"> </span>=<span class="_ _1f"> </span>[</div><div class="t m5 x21e h2d y48db ffd fs1e fc2 sc0 ls0 ws0">imem_error<span class="_ _e"> </span>||<span class="_ _1f"> </span>dmem_error<span class="_ _1f"> </span>:<span class="_ _e"> </span>SADR;</div><div class="t m5 x21e h2d y48dc ffd fs1e fc2 sc0 ls0 ws0">!instr_valid:<span class="_ _e"> </span>SINS;</div><div class="t m5 x21e h2d y48dd ffd fs1e fc2 sc0 ls0 ws0">icode<span class="_ _e"> </span>==<span class="_ _1f"> </span>IHALT<span class="_ _1f"> </span>:<span class="_ _e"> </span>SHLT;</div><div class="t m5 x21e h2d y48de ffd fs1e fc2 sc0 ls0 ws0">1<span class="_ _e"> </span>:<span class="_ _1f"> </span>SAOK;</div><div class="t m5 x17 h2d y48df ffd fs1e fc2 sc0 ls0 ws0">];</div><div class="t m5 x17 h28 y48e0 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>4.28</div><div class="t m5 x112 h2f y48e1 ffe fs16 fc6 sc0 ls0 ws0">(page<span class="_"> </span>453)</div><div class="t m5 x17 h26 y47f6 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _13"> </span>problem<span class="_ _13"> </span>is<span class="_ _13"> </span>an<span class="_ _13"> </span>interesting<span class="_ _13"> </span>exercise<span class="_ _6"> </span>in<span class="_ _13"> </span>trying<span class="_ _13"> </span>to<span class="_ _13"> </span>ﬁnd<span class="_ _13"> </span>the<span class="_ _13"> </span>optimal<span class="_ _6"> </span>balance<span class="_ _13"> </span>among</div><div class="t m5 x17 h26 y48e2 ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_"> </span>set<span class="_ _13"> </span>of<span class="_"> </span>partitions<span class="_ _1"></span>.<span class="_"> </span>It<span class="_"> </span>provides<span class="_ _13"> </span>a<span class="_"> </span>number<span class="_"> </span>of<span class="_ _13"> </span>opportunities<span class="_"> </span>to<span class="_"> </span>compute<span class="_ _13"> </span>throughputs</div><div class="t m5 x17 h26 y48e3 ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_"> </span>latencies<span class="_"> </span>in<span class="_"> </span>pipelines<span class="_ _1"></span>.</div><div class="t m5 x34 h26 y2469 ff7 fs19 fc1 sc0 ls0 ws0">A.<span class="_ _1f"> </span>F<span class="_ _1"></span>or<span class="_ _16"> </span>a<span class="_ _16"> </span>two-stage<span class="_ _16"> </span>pipeline<span class="_ _1"></span>,<span class="_ _14"> </span>the<span class="_ _16"> </span>best<span class="_ _16"> </span>partition<span class="_ _16"> </span>would<span class="_ _16"> </span>be<span class="_ _16"> </span>to<span class="_ _16"> </span>have<span class="_ _16"> </span>blocks<span class="_ _16"> </span>A,<span class="_ _14"> </span>B<span class="_ _3"></span>,</div><div class="t m5 x2d h26 y246a ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_ _11"> </span>C<span class="_ _11"> </span>in<span class="_ _16"> </span>the<span class="_"> </span>ﬁrst<span class="_ _16"> </span>stage<span class="_ _11"> </span>and<span class="_ _11"> </span>D<span class="_ _3"></span>,<span class="_ _16"> </span>E,<span class="_ _11"> </span>and<span class="_ _16"> </span>F<span class="_"> </span>in<span class="_ _16"> </span>the<span class="_ _11"> </span>second.<span class="_ _11"> </span>T<span class="_ _0"></span>he<span class="_ _11"> </span>ﬁrst<span class="_ _11"> </span>stage<span class="_ _16"> </span>has<span class="_"> </span>a</div><div class="t m5 x2d h46 y246b ff7 fs19 fc1 sc0 ls0 ws0">delay<span class="_"> </span>of<span class="_"> </span>170<span class="_"> </span>ps,<span class="_"> </span>giving<span class="_"> </span>a<span class="_"> </span>total<span class="_"> </span>cycle<span class="_"> </span>time<span class="_"> </span>of<span class="_"> </span>170<span class="_"> </span><span class="ff12">+<span class="_ _13"></span></span>20<span class="_"> </span><span class="ff12">=<span class="_ _13"></span></span>190<span class="_"> </span>ps.<span class="_"> </span>W<span class="_ _3"></span>e<span class="_"> </span>therefore</div><div class="t m5 x2d h26 y246c ff7 fs19 fc1 sc0 ls0 ws0">have<span class="_"> </span>a<span class="_"> </span>throughput<span class="_"> </span>of<span class="_"> </span>5<span class="ff11">.</span>26<span class="_ _13"> </span>GIPS<span class="_"> </span>and<span class="_"> </span>a<span class="_"> </span>latency<span class="_"> </span>of<span class="_"> </span>380<span class="_ _13"> </span>ps.</div><div class="t m5 x34 h26 y48e4 ff7 fs19 fc1 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>F<span class="_ _1"></span>or<span class="_"> </span>a<span class="_"> </span>three-stage<span class="_"> </span>pipeline<span class="_ _1"></span>,<span class="_"> </span>we<span class="_"> </span>should<span class="_"> </span>have<span class="_"> </span>blocks<span class="_"> </span>A<span class="_"> </span>and<span class="_ _13"> </span>B<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>ﬁrst<span class="_"> </span>stage<span class="_ _1"></span>,</div><div class="t m5 x2d h26 y48e5 ff7 fs19 fc1 sc0 ls0 ws0">blocks<span class="_ _14"> </span>C<span class="_ _14"> </span>and<span class="_ _15"> </span>D<span class="_ _14"> </span>in<span class="_ _14"> </span>the<span class="_ _15"> </span>second,<span class="_ _15"> </span>and<span class="_ _14"> </span>blocks<span class="_ _15"> </span>E<span class="_ _14"> </span>and<span class="_ _14"> </span>F<span class="_ _15"> </span>in<span class="_ _14"> </span>the<span class="_ _14"> </span>third.<span class="_ _15"> </span>T<span class="_ _1"></span>he<span class="_ _15"> </span>ﬁrst</div><div class="t m5 x2d h26 y48e6 ff7 fs19 fc1 sc0 ls0 ws0">two<span class="_ _16"> </span>stages<span class="_ _16"> </span>have<span class="_ _16"> </span>a<span class="_ _16"> </span>delay<span class="_ _16"> </span>of<span class="_ _16"> </span>110<span class="_ _13"> </span>ps<span class="_ _3"></span>,<span class="_ _14"> </span>giving<span class="_ _16"> </span>a<span class="_ _16"> </span>total<span class="_ _16"> </span>cycle<span class="_ _11"> </span>time<span class="_ _16"> </span>of<span class="_ _16"> </span>130<span class="_ _13"> </span>ps<span class="_ _16"> </span>and<span class="_ _16"> </span>a</div><div class="t m5 x2d h26 y48e7 ff7 fs19 fc1 sc0 ls0 ws0">throughput<span class="_"> </span>of<span class="_"> </span>7<span class="ff11">.</span>69<span class="_ _13"> </span>GIPS.<span class="_"> </span>T<span class="_ _0"></span>he<span class="_"> </span>latency<span class="_"> </span>is<span class="_"> </span>390<span class="_ _13"> </span>ps<span class="_ _3"></span>.</div><div class="t m5 x34 h26 y48e8 ff7 fs19 fc1 sc0 ls0 ws0">C.<span class="_ _25"> </span>F<span class="_ _1"></span>or<span class="_ _13"> </span>a<span class="_"> </span>four<span class="_ _1"></span>-stage<span class="_ _13"> </span>pipeline,<span class="_ _13"> </span>we<span class="_"> </span>should<span class="_ _13"> </span>have<span class="_"> </span>block<span class="_ _13"> </span>A<span class="_"> </span>in<span class="_ _13"> </span>the<span class="_ _13"> </span>ﬁrst<span class="_"> </span>stage<span class="_ _1"></span>,<span class="_"> </span>blocks<span class="_ _13"> </span>B</div><div class="t m5 x2d h26 y48e9 ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_"> </span>C<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>second,<span class="_"> </span>block<span class="_"> </span>D<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>third,<span class="_"> </span>and<span class="_"> </span>blocks<span class="_"> </span>E<span class="_"> </span>and<span class="_"> </span>F<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>fourth.</div><div class="t m5 x2d h26 y48ea ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _15"> </span>second<span class="_ _14"> </span>stage<span class="_ _15"> </span>requires<span class="_ _15"> </span>90<span class="_ _13"> </span>ps<span class="_ _1"></span>,<span class="_ _15"> </span>giving<span class="_ _15"> </span>a<span class="_ _15"> </span>total<span class="_ _14"> </span>cycle<span class="_ _14"> </span>time<span class="_ _15"> </span>of<span class="_ _14"> </span>110<span class="_ _13"> </span>ps<span class="_ _15"> </span>and<span class="_ _15"> </span>a</div><div class="t m5 x2d h26 y48eb ff7 fs19 fc1 sc0 ls0 ws0">throughput<span class="_"> </span>of<span class="_"> </span>9<span class="ff11">.</span>09<span class="_ _13"> </span>GIPS.<span class="_"> </span>T<span class="_ _0"></span>he<span class="_"> </span>latency<span class="_"> </span>is<span class="_"> </span>440<span class="_ _13"> </span>ps<span class="_ _3"></span>.</div><div class="t m5 x34 h26 y2476 ff7 fs19 fc1 sc0 ls0 ws0">D<span class="_ _3"></span>.<span class="_ _23"> </span>The<span class="_ _14"> </span>optimal<span class="_ _14"> </span>design<span class="_ _15"> </span>would<span class="_ _15"> </span>be<span class="_ _15"> </span>a<span class="_ _15"> </span>ﬁve-stage<span class="_ _14"> </span>pipeline,<span class="_ _15"> </span>with<span class="_ _15"> </span>each<span class="_ _14"> </span>block<span class="_ _15"> </span>in<span class="_ _15"> </span>its</div><div class="t m5 x2d h26 y2477 ff7 fs19 fc1 sc0 ls0 ws0">own<span class="_ _11"> </span>stage,<span class="_ _11"> </span>except<span class="_ _16"> </span>that<span class="_ _11"> </span>the<span class="_ _16"> </span>ﬁfth<span class="_ _11"> </span>stage<span class="_ _16"> </span>has<span class="_ _11"> </span>blocks<span class="_ _16"> </span>E<span class="_ _11"> </span>and<span class="_ _11"> </span>F<span class="_ _3"></span>.<span class="_ _11"> </span>The<span class="_"> </span>cycle<span class="_ _11"> </span>time<span class="_ _16"> </span>is</div><div class="t m5 x2d h46 y2478 ff7 fs19 fc1 sc0 ls0 ws0">80<span class="_"> </span><span class="ff12">+<span class="_ _13"></span></span>20<span class="_"> </span><span class="ff12">=<span class="_ _10"> </span></span>100<span class="_ _13"> </span>ps,<span class="_ _14"> </span>for<span class="_ _14"> </span>a<span class="_ _16"> </span>throughput<span class="_ _14"> </span>of<span class="_ _16"> </span>around<span class="_ _14"> </span>10<span class="ff11">.</span>00<span class="_"> </span>GIPS<span class="_ _16"> </span>and<span class="_ _16"> </span>a<span class="_ _14"> </span>latency<span class="_ _16"> </span>of</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
