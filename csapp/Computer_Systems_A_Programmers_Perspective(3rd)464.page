<div id="pf1d0" class="pf w2 h11" data-page-no="1d0"><div class="pc pc1d0 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1d0.png"/><div class="t m5 x13d h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>4.5<span class="_ _60"> </span>Pipelined<span class="_ _10"> </span>Y86-64<span class="_ _10"> </span>Implementations<span class="_ _3e"> </span><span class="ffe fs1e">463</span></div><div class="t m5 x34 h2a y257 fff fs1c fc2 sc0 ls0 ws0">Aside<span class="_ _1b"> </span><span class="ff6 fs19">What<span class="_ _11"> </span>is<span class="_ _11"> </span>the<span class="_ _11"> </span>difference<span class="_ _16"> </span>between<span class="_ _11"> </span>signals<span class="_ _11"> </span>M_stat<span class="_ _11"> </span>and<span class="_ _16"> </span>m_stat?</span></div><div class="t m5 x34 h2b y2d0 ff7 fs1e fc2 sc0 ls0 ws0">W<span class="_ _1"></span>ith<span class="_"> </span>our<span class="_"> </span>naming<span class="_"> </span>system,<span class="_"> </span>the<span class="_"> </span>uppercase<span class="_ _13"> </span>preﬁxes<span class="_"> </span>‘<span class="ff6">D</span>’,<span class="_"> </span>‘<span class="ff6">E</span>’,<span class="_"> </span>‘<span class="ff6">M</span>’,<span class="_ _13"> </span>and<span class="_"> </span>‘<span class="ff6">W</span>’<span class="_"> </span>refer<span class="_"> </span>to<span class="_ _13"> </span>pipeline<span class="_"> </span><span class="ffa">registers</span>,<span class="_"> </span>and<span class="_"> </span>so</div><div class="t m5 x34 h2b y2d1 ff6 fs1e fc2 sc0 ls0 ws0">M_stat<span class="_ _13"> </span><span class="ff7">refers<span class="_"> </span>to<span class="_"> </span>the<span class="_ _13"> </span>status<span class="_"> </span>code<span class="_"> </span>ﬁeld<span class="_ _13"> </span>of<span class="_"> </span>pipeline<span class="_ _13"> </span>register<span class="_"> </span>M.<span class="_ _13"> </span>T<span class="_ _0"></span>he<span class="_"> </span>lowercase<span class="_ _13"> </span>preﬁxes<span class="_"> </span>‘<span class="ff6">f</span>’,<span class="_"> </span>‘<span class="ff6">d</span>’,<span class="_ _13"> </span>‘<span class="ff6">e</span>’,<span class="_"> </span>‘<span class="ff6">m</span>’,<span class="_"> </span>and</span></div><div class="t m5 x34 h2b y2d2 ff7 fs1e fc2 sc0 ls0 ws0">‘<span class="ff6">w</span>’<span class="_"> </span>refer<span class="_ _13"> </span>to<span class="_ _13"> </span>the<span class="_"> </span>pipeline<span class="_ _13"> </span><span class="ffa">stages</span>,<span class="_"> </span>and<span class="_ _13"> </span>so<span class="_"> </span><span class="ff6">m_stat<span class="_ _13"> </span></span>refers<span class="_"> </span>to<span class="_ _13"> </span>the<span class="_"> </span>status<span class="_ _13"> </span>signal<span class="_"> </span>generated<span class="_ _13"> </span>in<span class="_ _13"> </span>the<span class="_"> </span>memory<span class="_ _13"> </span>stage</div><div class="t m5 x34 h2b y2d3 ff7 fs1e fc2 sc0 ls0 ws0">by<span class="_"> </span>a<span class="_"> </span>control<span class="_"> </span>logic<span class="_"> </span>block.</div><div class="t m5 x35 h2b y2d4 ff7 fs1e fc2 sc0 ls0 ws0">Understanding<span class="_"> </span>this<span class="_"> </span>naming<span class="_"> </span>convention<span class="_"> </span>is<span class="_"> </span>critical<span class="_"> </span>to<span class="_"> </span>understanding<span class="_"> </span>the<span class="_"> </span>operation<span class="_"> </span>of<span class="_"> </span>our<span class="_"> </span>pipelined</div><div class="t m5 x34 h2b y2d5 ff7 fs1e fc2 sc0 ls0 ws0">processors<span class="_ _1"></span>.</div><div class="t m5 x17 h26 y403e ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _15"> </span>write-back<span class="_ _15"> </span>stage<span class="_ _15"> </span>(shown<span class="_ _21"> </span>in<span class="_ _15"> </span>the<span class="_ _15"> </span>more<span class="_ _15"> </span>detailed<span class="_ _21"> </span>views<span class="_ _15"> </span>of<span class="_ _15"> </span>the<span class="_ _15"> </span>stages).<span class="_ _21"> </span>W<span class="_ _3"></span>e<span class="_ _15"> </span>do</div><div class="t m5 x17 h26 y403f ff7 fs19 fc2 sc0 ls0 ws0">this<span class="_ _14"> </span>to<span class="_ _15"> </span>make<span class="_ _14"> </span>sure<span class="_ _15"> </span>the<span class="_ _15"> </span>write<span class="_ _14"> </span>port<span class="_ _15"> </span>address<span class="_ _14"> </span>and<span class="_ _15"> </span>data<span class="_ _14"> </span>inputs<span class="_ _15"> </span>hold<span class="_ _15"> </span>values<span class="_ _14"> </span>from<span class="_ _15"> </span>the</div><div class="t m5 x17 h26 y4040 ff7 fs19 fc2 sc0 ls0 ws0">same<span class="_ _16"> </span>instruction.<span class="_ _16"> </span>Otherwise<span class="_ _1"></span>,<span class="_ _16"> </span>the<span class="_ _16"> </span>write<span class="_ _16"> </span>back<span class="_ _16"> </span>would<span class="_ _16"> </span>be<span class="_ _16"> </span>writing<span class="_ _11"> </span>the<span class="_ _16"> </span>values<span class="_ _16"> </span>for<span class="_ _16"> </span>the</div><div class="t m5 x17 h26 y4041 ff7 fs19 fc2 sc0 ls0 ws0">instruction<span class="_ _16"> </span>in<span class="_ _11"> </span>the<span class="_ _16"> </span>write-back<span class="_ _16"> </span>stage<span class="_ _1"></span>,<span class="_ _16"> </span>but<span class="_ _16"> </span>with<span class="_ _11"> </span>register<span class="_ _16"> </span>IDs<span class="_ _16"> </span>from<span class="_ _11"> </span>the<span class="_ _16"> </span>instruction<span class="_ _16"> </span>in</div><div class="t m5 x17 h26 y4042 ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _11"> </span>decode<span class="_ _11"> </span>stage.<span class="_"> </span>As<span class="_ _16"> </span>a<span class="_ _11"> </span>general<span class="_ _11"> </span>principle,<span class="_"> </span>we<span class="_ _16"> </span>want<span class="_ _11"> </span>to<span class="_ _11"> </span>keep<span class="_ _16"> </span>all<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>information</div><div class="t m5 x17 h26 y4043 ff7 fs19 fc2 sc0 ls0 ws0">about<span class="_"> </span>a<span class="_"> </span>particular<span class="_"> </span>instruction<span class="_"> </span>contained<span class="_"> </span>within<span class="_"> </span>a<span class="_"> </span>single<span class="_"> </span>pipeline<span class="_"> </span>stage<span class="_ _1"></span>.</div><div class="t m5 x26 h46 y4044 ff7 fs19 fc2 sc0 ls0 ws0">One<span class="_ _13"> </span>block<span class="_ _13"> </span>of<span class="_ _13"> </span>PIPE<span class="ff12">−<span class="_ _13"></span></span>that<span class="_ _13"> </span>is<span class="_ _13"> </span>not<span class="_ _13"> </span>present<span class="_ _13"> </span>in<span class="_ _13"> </span>SEQ+<span class="_ _13"> </span>in<span class="_ _13"> </span>the<span class="_ _13"> </span>exact<span class="_"> </span>same<span class="_ _13"> </span>form<span class="_ _13"> </span>is<span class="_ _13"> </span>the</div><div class="t m5 x17 h26 y4045 ff7 fs19 fc2 sc0 ls0 ws0">block<span class="_ _13"> </span>labeled<span class="_"> </span>“Select<span class="_ _13"> </span>A<span class="_ _7"></span>”<span class="_ _13"> </span>in<span class="_ _13"> </span>the<span class="_"> </span>decode<span class="_ _13"> </span>stage<span class="_ _1"></span>.<span class="_"> </span>W<span class="_ _3"></span>e<span class="_ _13"> </span>can<span class="_ _13"> </span>see<span class="_"> </span>that<span class="_ _13"> </span>this<span class="_ _13"> </span>block<span class="_"> </span>generates</div><div class="t m5 x17 h26 y4046 ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _16"> </span>value<span class="_ _16"> </span><span class="ff6">valA<span class="_ _14"> </span></span>for<span class="_ _16"> </span>the<span class="_ _14"> </span>pipeline<span class="_ _16"> </span>register<span class="_ _16"> </span>E<span class="_ _14"> </span>by<span class="_ _16"> </span>choosing<span class="_ _16"> </span>either<span class="_ _14"> </span><span class="ff6">valP<span class="_ _16"> </span></span>from<span class="_ _14"> </span>pipeline</div><div class="t m5 x17 h26 y4047 ff7 fs19 fc2 sc0 ls0 ws0">register<span class="_ _14"> </span>D<span class="_ _15"> </span>or<span class="_ _15"> </span>the<span class="_ _15"> </span>value<span class="_ _15"> </span>read<span class="_ _14"> </span>from<span class="_ _15"> </span>the<span class="_ _15"> </span>A<span class="_ _15"> </span>port<span class="_ _14"> </span>of<span class="_ _15"> </span>the<span class="_ _15"> </span>register<span class="_ _15"> </span>ﬁle<span class="_ _0"></span>.<span class="_ _14"> </span>This<span class="_ _14"> </span>block<span class="_ _15"> </span>is</div><div class="t m5 x17 h26 y4048 ff7 fs19 fc2 sc0 ls0 ws0">included<span class="_ _11"> </span>to<span class="_ _16"> </span>reduce<span class="_ _11"> </span>the<span class="_ _11"> </span>amount<span class="_ _16"> </span>of<span class="_ _11"> </span>state<span class="_ _16"> </span>that<span class="_ _11"> </span>must<span class="_ _11"> </span>be<span class="_ _16"> </span>carried<span class="_ _11"> </span>forward<span class="_ _16"> </span>to<span class="_ _11"> </span>pipeline</div><div class="t m5 x17 h26 y4049 ff7 fs19 fc2 sc0 ls0 ws0">registers<span class="_ _16"> </span>E<span class="_ _16"> </span>and<span class="_ _14"> </span>M.<span class="_ _16"> </span>Of<span class="_ _16"> </span>all<span class="_ _14"> </span>the<span class="_ _16"> </span>different<span class="_ _14"> </span>instructions<span class="_ _1"></span>,<span class="_ _14"> </span>only<span class="_ _16"> </span>the<span class="_ _14"> </span><span class="ffd">call<span class="_ _16"> </span></span>requires<span class="_ _16"> </span><span class="ff6">valP</span></div><div class="t m5 x17 h26 y404a ff7 fs19 fc2 sc0 ls0 ws0">in<span class="_ _11"> </span>the<span class="_ _11"> </span>memory<span class="_ _11"> </span>stage<span class="_ _0"></span>.<span class="_ _11"> </span>Only<span class="_ _11"> </span>the<span class="_ _11"> </span>jump<span class="_ _11"> </span>instructions<span class="_ _11"> </span>require<span class="_ _11"> </span>the<span class="_ _16"> </span>value<span class="_"> </span>of<span class="_ _16"> </span><span class="ff6">valP<span class="_ _11"> </span></span>in<span class="_ _11"> </span>the</div><div class="t m5 x17 h26 y404b ff7 fs19 fc2 sc0 ls0 ws0">execute<span class="_ _15"> </span>stage<span class="_ _14"> </span>(in<span class="_ _15"> </span>the<span class="_ _15"> </span>event<span class="_ _15"> </span>the<span class="_ _15"> </span>jump<span class="_ _15"> </span>is<span class="_ _15"> </span>not<span class="_ _15"> </span>taken).<span class="_ _14"> </span>None<span class="_ _15"> </span>of<span class="_ _15"> </span>these<span class="_ _15"> </span>instructions</div><div class="t m5 x17 h26 y404c ff7 fs19 fc2 sc0 ls0 ws0">requires<span class="_"> </span>a<span class="_"> </span>value<span class="_"> </span>read<span class="_"> </span>from<span class="_"> </span>the<span class="_ _13"> </span>register<span class="_"> </span>ﬁle.<span class="_ _13"> </span>Therefore<span class="_ _1"></span>,<span class="_"> </span>we<span class="_"> </span>can<span class="_"> </span>reduce<span class="_"> </span>the<span class="_"> </span>amount</div><div class="t m5 x17 h26 y404d ff7 fs19 fc2 sc0 ls0 ws0">of<span class="_"> </span>pipeline<span class="_ _13"> </span>register<span class="_"> </span>state<span class="_"> </span>by<span class="_"> </span>merging<span class="_ _13"> </span>these<span class="_"> </span>two<span class="_"> </span>signals<span class="_"> </span>and<span class="_ _13"> </span>carrying<span class="_"> </span>them<span class="_"> </span>through</div><div class="t m5 x17 h26 y404e ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span>pipeline<span class="_"> </span>as<span class="_"> </span>a<span class="_ _13"> </span>single<span class="_"> </span>signal<span class="_"> </span><span class="ff6">valA</span>.<span class="_"> </span>T<span class="_ _1"></span>his<span class="_"> </span>eliminates<span class="_"> </span>the<span class="_"> </span>need<span class="_"> </span>for<span class="_"> </span>the<span class="_"> </span>block<span class="_ _13"> </span>labeled</div><div class="t m5 x17 h26 y404f ff7 fs19 fc2 sc0 ls0 ws0">“Data”<span class="_ _15"> </span>in<span class="_ _15"> </span>SEQ<span class="_ _21"> </span>(F<span class="_ _1"></span>igure<span class="_ _21"> </span>4.23)<span class="_ _15"> </span>and<span class="_ _15"> </span>SEQ+<span class="_ _21"> </span>(F<span class="_ _0"></span>igure<span class="_ _15"> </span>4.40),<span class="_ _21"> </span>which<span class="_ _21"> </span>served<span class="_ _15"> </span>a<span class="_ _15"> </span>similar</div><div class="t m5 x17 h26 y4050 ff7 fs19 fc2 sc0 ls0 ws0">purpose<span class="_ _1"></span>.<span class="_ _14"> </span>In<span class="_ _16"> </span>hardware<span class="_ _16"> </span>design,<span class="_ _14"> </span>it<span class="_ _16"> </span>is<span class="_ _16"> </span>common<span class="_ _14"> </span>to<span class="_ _16"> </span>carefully<span class="_ _16"> </span>identify<span class="_ _16"> </span>how<span class="_ _14"> </span>signals<span class="_ _16"> </span>get</div><div class="t m5 x17 h26 y4051 ff7 fs19 fc2 sc0 ls0 ws0">used<span class="_"> </span>and<span class="_ _11"> </span>then<span class="_ _11"> </span>reduce<span class="_ _11"> </span>the<span class="_"> </span>amount<span class="_ _11"> </span>of<span class="_ _11"> </span>register<span class="_ _11"> </span>state<span class="_"> </span>and<span class="_ _11"> </span>wiring<span class="_ _11"> </span>by<span class="_ _11"> </span>merging<span class="_"> </span>signals</div><div class="t m5 x17 h26 y4052 ff7 fs19 fc2 sc0 ls0 ws0">such<span class="_"> </span>as<span class="_"> </span>these<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y4053 ff7 fs19 fc2 sc0 ls0 ws0">As<span class="_ _16"> </span>shown<span class="_ _11"> </span>in<span class="_ _16"> </span>F<span class="_ _0"></span>igure<span class="_ _16"> </span>4.41,<span class="_ _16"> </span>our<span class="_ _11"> </span>pipeline<span class="_ _16"> </span>registers<span class="_ _16"> </span>include<span class="_ _11"> </span>a<span class="_ _16"> </span>ﬁeld<span class="_ _16"> </span>for<span class="_ _16"> </span>the<span class="_ _11"> </span>status</div><div class="t m5 x17 h26 y4054 ff7 fs19 fc2 sc0 ls0 ws0">code<span class="_"> </span><span class="ff6">stat</span>,<span class="_ _11"> </span>initially<span class="_"> </span>computed<span class="_ _11"> </span>during<span class="_"> </span>the<span class="_ _11"> </span>fetch<span class="_"> </span>stage<span class="_ _11"> </span>and<span class="_"> </span>possibly<span class="_ _11"> </span>modiﬁed<span class="_ _11"> </span>during</div><div class="t m5 x17 h26 y4055 ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _13"> </span>memory<span class="_ _6"> </span>stage<span class="_ _0"></span>.<span class="_ _13"> </span>W<span class="_ _3"></span>e<span class="_ _6"> </span>will<span class="_ _13"> </span>discuss<span class="_ _13"> </span>how<span class="_ _6"> </span>to<span class="_ _13"> </span>implement<span class="_ _6"> </span>the<span class="_ _13"> </span>processing<span class="_ _13"> </span>of<span class="_ _6"> </span>exceptional</div><div class="t m5 x17 h26 y4056 ff7 fs19 fc2 sc0 ls0 ws0">events<span class="_ _11"> </span>in<span class="_ _16"> </span>Section<span class="_ _11"> </span>4.5.6,<span class="_ _16"> </span>after<span class="_ _11"> </span>we<span class="_ _11"> </span>have<span class="_ _16"> </span>covered<span class="_ _11"> </span>the<span class="_ _11"> </span>implementation<span class="_ _16"> </span>of<span class="_ _11"> </span>normal<span class="_ _11"> </span>in-</div><div class="t m5 x17 h26 y4057 ff7 fs19 fc2 sc0 ls0 ws0">struction<span class="_ _6"> </span>execution.<span class="_ _13"> </span>Sufﬁce<span class="_ _6"> </span>it<span class="_ _13"> </span>to<span class="_ _6"> </span>say<span class="_ _6"> </span>at<span class="_ _13"> </span>this<span class="_ _6"> </span>point<span class="_ _13"> </span>that<span class="_ _a"> </span>the<span class="_ _13"> </span>most<span class="_ _6"> </span>systematic<span class="_ _13"> </span>approach</div><div class="t m5 x17 h26 y4058 ff7 fs19 fc2 sc0 ls0 ws0">is<span class="_ _13"> </span>to<span class="_ _13"> </span>associate<span class="_"> </span>a<span class="_ _13"> </span>status<span class="_ _13"> </span>code<span class="_ _13"> </span>with<span class="_"> </span>each<span class="_ _13"> </span>instruction<span class="_ _13"> </span>as<span class="_ _13"> </span>it<span class="_"> </span>passes<span class="_ _13"> </span>through<span class="_ _13"> </span>the<span class="_ _13"> </span>pipeline,</div><div class="t m5 x17 h26 y4059 ff7 fs19 fc2 sc0 ls0 ws0">as<span class="_"> </span>we<span class="_"> </span>have<span class="_"> </span>indicated<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>ﬁgure<span class="_ _1"></span>.</div><div class="t m5 x17 h41 y1051 ffe fs29 fc2 sc0 ls0 ws0">4.5.4</div><div class="t m5 x182 h43 y23d9 ffe fs19 fc2 sc0 ls0 ws0">Next<span class="_"> </span>PC<span class="_"> </span>Prediction</div><div class="t m5 x17 h46 yd16 ff7 fs19 fc2 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_"> </span>have<span class="_ _13"> </span>taken<span class="_ _13"> </span>some<span class="_"> </span>measures<span class="_ _13"> </span>in<span class="_"> </span>the<span class="_ _13"> </span>design<span class="_ _13"> </span>of<span class="_"> </span>PIPE<span class="ff12">−<span class="_ _13"></span></span>to<span class="_"> </span>properly<span class="_ _13"> </span>handle<span class="_"> </span>control</div><div class="t m5 x17 h26 yd17 ff7 fs19 fc2 sc0 ls0 ws0">dependencies<span class="_ _1"></span>.<span class="_ _16"> </span>Our<span class="_ _14"> </span>goal<span class="_ _14"> </span>in<span class="_ _14"> </span>the<span class="_ _16"> </span>pipelined<span class="_ _14"> </span>design<span class="_ _14"> </span>is<span class="_ _16"> </span>to<span class="_ _14"> </span><span class="ffa">issue<span class="_ _14"> </span></span>a<span class="_ _14"> </span>new<span class="_ _16"> </span>instruction<span class="_ _14"> </span>on</div><div class="t m5 x17 h26 y223b ff7 fs19 fc2 sc0 ls0 ws0">every<span class="_ _16"> </span>clock<span class="_ _16"> </span>c<span class="_ _0"></span>ycle<span class="_ _1"></span>,<span class="_ _14"> </span>meaning<span class="_ _16"> </span>that<span class="_ _16"> </span>on<span class="_ _11"> </span>each<span class="_ _16"> </span>clock<span class="_ _16"> </span>cycle<span class="_ _1"></span>,<span class="_ _16"> </span>a<span class="_ _16"> </span>new<span class="_ _16"> </span>instruction<span class="_ _16"> </span>proceeds</div><div class="t m5 x17 h26 y223c ff7 fs19 fc2 sc0 ls0 ws0">into<span class="_ _13"> </span>the<span class="_ _6"> </span>execute<span class="_ _13"> </span>stage<span class="_ _13"> </span>and<span class="_ _6"> </span>will<span class="_ _13"> </span>ultimately<span class="_ _13"> </span>be<span class="_ _6"> </span>completed.<span class="_ _13"> </span>Achieving<span class="_ _13"> </span>this<span class="_ _6"> </span>goal<span class="_ _13"> </span>would</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
