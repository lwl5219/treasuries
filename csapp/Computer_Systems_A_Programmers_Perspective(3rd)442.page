<div id="pf1ba" class="pf w2 h11" data-page-no="1ba"><div class="pc pc1ba w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1ba.png"/><div class="t m5 x99 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>4.3<span class="_ _60"> </span>Sequential<span class="_ _10"> </span>Y86-64<span class="_ _10"> </span>Implementations<span class="_ _3e"> </span><span class="ffe fs1e">441</span></div><div class="t m5 x17 h2f y9c ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>4.27</div><div class="t m5 x17 h34 y676 ffe fs16 fc1 sc0 ls0 ws0">SEQ<span class="_ _14"> </span>fetch<span class="_ _15"> </span>stage.<span class="_ _14"> </span><span class="ff6">Six</span></div><div class="t m5 x17 h34 y7cb ff6 fs16 fc1 sc0 ls0 ws0">bytes<span class="_ _16"> </span>are<span class="_ _16"> </span>read<span class="_ _16"> </span>from<span class="_ _16"> </span>the</div><div class="t m5 x17 h34 yd19 ff6 fs16 fc1 sc0 ls0 ws0">instruction<span class="_ _11"> </span>memory<span class="_ _11"> </span>using</div><div class="t m5 x17 h34 yd1a ff6 fs16 fc1 sc0 ls0 ws0">the<span class="_ _14"> </span>PC<span class="_ _14"> </span>as<span class="_ _14"> </span>the<span class="_ _14"> </span>starting</div><div class="t m5 x17 h34 yd1b ff6 fs16 fc1 sc0 ls0 ws0">address.<span class="_ _10"> </span>From<span class="_ _11"> </span>these<span class="_ _11"> </span>bytes,</div><div class="t m5 x17 h34 yf75 ff6 fs16 fc1 sc0 ls0 ws0">we<span class="_ _11"> </span>generate<span class="_ _11"> </span>the<span class="_ _16"> </span>different</div><div class="t m5 x17 h34 yf76 ff6 fs16 fc1 sc0 ls0 ws0">instruction<span class="_ _11"> </span>ﬁelds.<span class="_ _16"> </span>The<span class="_ _11"> </span>PC</div><div class="t m5 x17 h34 yf77 ff6 fs16 fc1 sc0 ls0 ws0">increment<span class="_ _10"> </span>block<span class="_ _11"> </span>computes</div><div class="t m5 x17 h34 y3cf3 ff6 fs16 fc1 sc0 ls0 ws0">signal<span class="_ _10"> </span>valP.</div><div class="t m5 x9e h44 y3cf4 ff3f fs2a fc1 sc0 ls0 ws0">icode<span class="_ _23"> </span>ifun<span class="_ _c"> </span>rA<span class="_ _48"> </span>rB<span class="_ _25"> </span>valC<span class="_ _6b"> </span>valP</div><div class="t m5 x1f8 h44 y3cf5 ff3f fs2a fc1 sc0 ls0 ws0">Need</div><div class="t m5 xdf h44 y3cf6 ff3f fs2a fc1 sc0 ls0 ws0">valC</div><div class="t m5 x1f8 h44 y3cf7 ff3f fs2a fc1 sc0 ls0 ws0">Need</div><div class="t m5 x6c h44 y3cf8 ff3f fs2a fc1 sc0 ls0 ws0">regids</div><div class="t m5 x1f0 h3f y3cf9 ff3f fs27 fc1 sc0 ls0 ws0">PC</div><div class="t m5 xb5 h3f y3cfa ff3f fs27 fc1 sc0 ls0 ws0">increment</div><div class="t m5 x250 h3f y3cfb ff3f fs27 fc1 sc0 ls0 ws0">Align</div><div class="t m5 x7d h44 y3cfc ff3f fs2a fc1 sc0 ls0 ws0">Bytes 1–9</div><div class="t m5 x180 h44 y3cfd ff3f fs2a fc1 sc0 ls0 ws0">Byte 0</div><div class="t m5 x8f h44 y3cfe ff3f fs2a fc1 sc0 ls0 ws0">imem_error</div><div class="t m5 x121 h3f y3cff ff3f fs27 fc1 sc0 ls0 ws0">Instruction</div><div class="t m5 x122 h3f y3d00 ff3f fs27 fc1 sc0 ls0 ws0">memory</div><div class="t m5 x99 h3f y3d01 ff3f fs27 fc1 sc0 ls0 ws0">PC</div><div class="t m5 x15 h3f y3d02 ff3f fs27 fc1 sc0 ls0 ws0">Split</div><div class="t m5 x1d7 h44 y3d03 ff3f fs2a fc1 sc0 ls0 ws0">Instr</div><div class="t m5 x1d7 h44 y3d04 ff3f fs2a fc1 sc0 ls0 ws0">valid</div><div class="t m5 x1d1 h3f y3d05 ff3f fs27 fc1 sc0 ls0 ws0">icode<span class="_ _14"> </span>ifun</div><div class="t m5 x17 h26 y3d06 ff7 fs19 fc1 sc0 ls0 ws0">referenced<span class="_"> </span>in<span class="_"> </span>the<span class="_ _11"> </span>control<span class="_"> </span>logic<span class="_ _11"> </span>are<span class="_"> </span>shown.<span class="_ _11"> </span>T<span class="_ _1"></span>he<span class="_ _11"> </span>constants<span class="_"> </span>we<span class="_ _11"> </span>use<span class="_"> </span>are<span class="_ _11"> </span>documented</div><div class="t m5 x17 h26 y3d07 ff7 fs19 fc1 sc0 ls0 ws0">in<span class="_"> </span>F<span class="_ _1"></span>igure<span class="_"> </span>4.26.<span class="_"> </span>By<span class="_"> </span>convention,<span class="_"> </span>we<span class="_"> </span>use<span class="_"> </span>uppercase<span class="_"> </span>names<span class="_"> </span>for<span class="_"> </span>constant<span class="_"> </span>values<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y3d08 ff7 fs19 fc1 sc0 ls0 ws0">In<span class="_ _11"> </span>addition<span class="_ _16"> </span>to<span class="_ _16"> </span>the<span class="_ _11"> </span>instructions<span class="_ _16"> </span>shown<span class="_ _11"> </span>in<span class="_ _16"> </span>F<span class="_ _1"></span>igures<span class="_ _16"> </span>4.18<span class="_ _11"> </span>to<span class="_ _16"> </span>4.21,<span class="_ _16"> </span>we<span class="_ _11"> </span>include<span class="_ _16"> </span>the</div><div class="t m5 x17 h26 y3d09 ff7 fs19 fc1 sc0 ls0 ws0">processing<span class="_ _14"> </span>for<span class="_ _15"> </span>the<span class="_ _15"> </span><span class="ffd">nop<span class="_ _15"> </span></span>and<span class="_ _15"> </span><span class="ffd">halt<span class="_ _15"> </span></span>instructions<span class="_ _1"></span>.<span class="_ _14"> </span>The<span class="_ _14"> </span><span class="ffd">nop<span class="_ _15"> </span></span>instruction<span class="_ _14"> </span>simply<span class="_ _15"> </span>ﬂows</div><div class="t m5 x17 h26 y3d0a ff7 fs19 fc1 sc0 ls0 ws0">through<span class="_ _16"> </span>stages<span class="_ _16"> </span>without<span class="_ _14"> </span>much<span class="_ _16"> </span>processing,<span class="_ _16"> </span>except<span class="_ _16"> </span>to<span class="_ _14"> </span>increment<span class="_ _16"> </span>the<span class="_ _16"> </span>PC<span class="_ _14"> </span>by<span class="_ _16"> </span>1.<span class="_ _16"> </span>The</div><div class="t m5 x17 h26 y3d0b ffd fs19 fc1 sc0 ls0 ws0">halt<span class="_ _14"> </span><span class="ff7">instruction<span class="_ _14"> </span>causes<span class="_ _14"> </span>the<span class="_ _14"> </span>processor<span class="_ _15"> </span>status<span class="_ _14"> </span>to<span class="_ _14"> </span>be<span class="_ _14"> </span>set<span class="_ _14"> </span>to<span class="_ _14"> </span></span>HLT<span class="ff7">,<span class="_ _15"> </span>causing<span class="_ _15"> </span>it<span class="_ _14"> </span>to<span class="_ _14"> </span>halt</span></div><div class="t m5 x17 h26 y3d0c ff7 fs19 fc1 sc0 ls0 ws0">operation.</div><div class="t m5 x17 h42 y3d0d ff6 fs29 fc6 sc0 ls0 ws0">Fetch<span class="_ _11"> </span>Stage</div><div class="t m5 x17 h26 y3d0e ff7 fs19 fc1 sc0 ls0 ws0">As<span class="_ _6"> </span>shown<span class="_ _13"> </span>in<span class="_ _6"> </span>F<span class="_ _0"></span>igure<span class="_ _6"> </span>4.27,<span class="_ _13"> </span>the<span class="_ _6"> </span>fetch<span class="_ _13"> </span>stage<span class="_ _6"> </span>includes<span class="_ _6"> </span>the<span class="_ _13"> </span>instruction<span class="_ _6"> </span>memory<span class="_ _13"> </span>hardware</div><div class="t m5 x17 h26 y3d0f ff7 fs19 fc1 sc0 ls0 ws0">unit.<span class="_ _6"> </span>This<span class="_ _6"> </span>unit<span class="_ _13"> </span>reads<span class="_ _6"> </span>10<span class="_ _13"> </span>bytes<span class="_ _6"> </span>from<span class="_ _13"> </span>memory<span class="_ _6"> </span>at<span class="_ _13"> </span>a<span class="_ _6"> </span>time<span class="_ _0"></span>,<span class="_ _13"> </span>using<span class="_ _6"> </span>the<span class="_ _13"> </span>PC<span class="_ _6"> </span>as<span class="_ _13"> </span>the<span class="_ _6"> </span>address<span class="_ _13"> </span>of</div><div class="t m5 x17 h26 y3d10 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _6"> </span>ﬁrst<span class="_ _13"> </span>byte<span class="_ _6"> </span>(byte<span class="_ _13"> </span>0).<span class="_ _6"> </span>T<span class="_ _0"></span>his<span class="_ _6"> </span>byte<span class="_ _13"> </span>is<span class="_ _6"> </span>interpreted<span class="_ _13"> </span>as<span class="_ _6"> </span>the<span class="_ _13"> </span>instruction<span class="_ _6"> </span>byte<span class="_ _6"> </span>and<span class="_ _13"> </span>is<span class="_ _6"> </span>split<span class="_ _13"> </span>(by</div><div class="t m5 x17 h26 y3d11 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _13"> </span>unit<span class="_ _13"> </span>labeled<span class="_"> </span>“Split”)<span class="_ _13"> </span>into<span class="_ _13"> </span>two<span class="_ _13"> </span>4-bit<span class="_ _13"> </span>quantities<span class="_ _1"></span>.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_ _13"> </span>control<span class="_ _13"> </span>logic<span class="_"> </span>blocks<span class="_ _13"> </span>labeled</div><div class="t m5 x17 h26 y3d12 ff7 fs19 fc1 sc0 ls0 ws0">“icode”<span class="_ _11"> </span>and<span class="_ _11"> </span>“ifun”<span class="_ _11"> </span>then<span class="_ _11"> </span>compute<span class="_ _11"> </span>the<span class="_ _11"> </span>instruction<span class="_ _11"> </span>and<span class="_ _11"> </span>function<span class="_ _11"> </span>codes<span class="_ _16"> </span>as<span class="_"> </span>equaling</div><div class="t m5 x17 h26 y3d13 ff7 fs19 fc1 sc0 ls0 ws0">either<span class="_ _11"> </span>the<span class="_ _11"> </span>values<span class="_ _11"> </span>read<span class="_ _11"> </span>from<span class="_ _11"> </span>memory<span class="_ _11"> </span>or,<span class="_ _11"> </span>in<span class="_ _11"> </span>the<span class="_ _11"> </span>event<span class="_ _11"> </span>that<span class="_ _11"> </span>the<span class="_ _11"> </span>instruction<span class="_ _11"> </span>address</div><div class="t m5 x17 h26 y3d14 ff7 fs19 fc1 sc0 ls0 ws0">is<span class="_ _11"> </span>not<span class="_ _11"> </span>valid<span class="_ _11"> </span>(as<span class="_ _11"> </span>indicated<span class="_ _11"> </span>by<span class="_ _11"> </span>the<span class="_ _11"> </span>signal<span class="_ _11"> </span><span class="ff6">imem_error</span>),<span class="_ _11"> </span>the<span class="_ _11"> </span>values<span class="_ _11"> </span>corresponding<span class="_ _11"> </span>to</div><div class="t m5 x17 h26 y3d15 ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_ _13"> </span><span class="ffd">nop<span class="_ _10"> </span></span>instruction.<span class="_ _13"> </span>Based<span class="_"> </span>on<span class="_ _13"> </span>the<span class="_"> </span>value<span class="_ _13"> </span>of<span class="_"> </span><span class="ff6">icode</span>,<span class="_ _13"> </span>we<span class="_ _13"> </span>can<span class="_"> </span>compute<span class="_ _13"> </span>three<span class="_"> </span>1-bit<span class="_ _13"> </span>signals</div><div class="t m5 x17 h26 y3d16 ff7 fs19 fc1 sc0 ls0 ws0">(shown<span class="_"> </span>as<span class="_"> </span>dashed<span class="_"> </span>lines):</div><div class="t m5 x72 h26 y3d17 ff6 fs19 fc1 sc0 ls0 ws0">instr_valid<span class="ff7">.<span class="_ _e"> </span>Does<span class="_ _13"> </span>this<span class="_ _13"> </span>byte<span class="_ _13"> </span>correspond<span class="_ _13"> </span>to<span class="_ _6"> </span>a<span class="_ _13"> </span>legal<span class="_ _13"> </span>Y86-64<span class="_ _13"> </span>instruction?<span class="_ _6"> </span>This<span class="_ _6"> </span>signal</span></div><div class="t m5 x30 h26 y3d18 ff7 fs19 fc1 sc0 ls0 ws0">is<span class="_"> </span>used<span class="_"> </span>to<span class="_"> </span>detect<span class="_"> </span>an<span class="_"> </span>illegal<span class="_"> </span>instruction.</div><div class="t m5 x72 h26 y3d19 ff6 fs19 fc1 sc0 ls0 ws0">need_regids<span class="ff7">.<span class="_ _e"> </span>Does<span class="_"> </span>this<span class="_"> </span>instruction<span class="_"> </span>include<span class="_"> </span>a<span class="_"> </span>register<span class="_"> </span>speciﬁer<span class="_"> </span>byte?</span></div><div class="t m5 x72 h26 y3d1a ff6 fs19 fc1 sc0 ls0 ws0">need_valC<span class="ff7">.<span class="_ _e"> </span>Does<span class="_"> </span>this<span class="_"> </span>instruction<span class="_"> </span>include<span class="_"> </span>a<span class="_"> </span>constant<span class="_"> </span>word?</span></div><div class="t m5 x17 h26 y3d1b ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _16"> </span>signals<span class="_ _11"> </span><span class="ff6">instr_valid<span class="_ _11"> </span></span>and<span class="_ _16"> </span><span class="ff6">imem_error<span class="_ _11"> </span></span>(generated<span class="_ _11"> </span>when<span class="_ _16"> </span>the<span class="_ _11"> </span>instruction<span class="_ _11"> </span>address</div><div class="t m5 x17 h26 y3d1c ff7 fs19 fc1 sc0 ls0 ws0">is<span class="_"> </span>out<span class="_"> </span>of<span class="_"> </span>bounds)<span class="_"> </span>are<span class="_"> </span>used<span class="_"> </span>to<span class="_"> </span>generate<span class="_"> </span>the<span class="_"> </span>status<span class="_"> </span>code<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>memory<span class="_"> </span>stage<span class="_ _1"></span>.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
