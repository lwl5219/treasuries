<div id="pf30" class="pf w2 h11" data-page-no="30"><div class="pc pc30 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg30.png"/><div class="t m5 x8d h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>1.5<span class="_ _3d"> </span>Caches<span class="_ _13"> </span>Matter<span class="_ _3e"> </span><span class="ffe fs1e">47</span></div><div class="t m5 x17 h2f ye7 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>1.5</div><div class="t m5 x17 h2f y58a ffe fs16 fc1 sc0 ls0 ws0">Reading<span class="_ _15"> </span>the</div><div class="t m5 x8e h3a y608 ffd fs19 fc1 sc0 ls0 ws0">hello</div><div class="t m5 x17 h2f y609 ffe fs16 fc1 sc0 ls0 ws0">command<span class="_ _14"> </span>from<span class="_ _15"> </span>the</div><div class="t m5 x17 h2f y60a ffe fs16 fc1 sc0 ls0 ws0">keyboard.</div><div class="t m5 x8f h3f y60b ff15 fs27 fc1 sc0 ls0 ws0">CPU</div><div class="t m5 x90 h3f y60c ff15 fs27 fc1 sc0 ls0 ws0">Register file</div><div class="t m5 x91 h3f y60d ff15 fs27 fc1 sc0 ls0 ws0">PC</div><div class="t m5 x92 h3f y60e ff15 fs27 fc1 sc0 ls0 ws0">ALU</div><div class="t m5 x91 h3f y60f ff17 fs27 fc1 sc0 ls0 ws0">Bus interface</div><div class="t m5 x93 h3f y610 ff17 fs27 fc1 sc0 ls0 ws0">I/O</div><div class="t m5 x94 h3f y611 ff17 fs27 fc1 sc0 ls0 ws0">bridge</div><div class="t m5 x7d h3f y612 ff15 fs27 fc1 sc0 ls0 ws0">System bus</div><div class="t m5 x9 h3f y613 ff15 fs27 fc1 sc0 ls0 ws0">Memory bus</div><div class="t m5 x95 h3f y614 ff17 fs27 fc1 sc0 ls0 ws0">Main</div><div class="t m5 x96 h3f y615 ff17 fs27 fc1 sc0 ls0 ws0">memory</div><div class="t m5 x94 h3f y616 ff15 fs27 fc1 sc0 ls0 ws0">I/O bus</div><div class="t m5 x97 h3f y617 ff15 fs27 fc1 sc0 ls0 ws0">Expansion slots for</div><div class="t m5 x97 h3f y618 ff15 fs27 fc1 sc0 ls0 ws0">other devices such</div><div class="t m5 x97 h3f y619 ff15 fs27 fc1 sc0 ls0 ws0">as network adapters</div><div class="t m5 x8a h3f y61a ff15 fs27 fc1 sc0 ls0 ws0">Disk</div><div class="t m5 x98 h3f y61b ff15 fs27 fc1 sc0 ls0 ws0">controller</div><div class="t m5 x99 h3f y61c ff15 fs27 fc1 sc0 ls0 ws0">Graphics</div><div class="t m5 x7f h3f y61d ff15 fs27 fc1 sc0 ls0 ws0">adapter</div><div class="t m5 x9a h3f y61e ff15 fs27 fc1 sc0 ls0 ws0">Display<span class="_ _4b"></span>Mouse  Keyboard</div><div class="t m5 x9b h3f y61f ff17 fs27 fc1 sc0 ls0 ws0">USB</div><div class="t m5 x9c h3f y620 ff17 fs27 fc1 sc0 ls0 ws0">controller</div><div class="t m5 x8a h3f y621 ff15 fs27 fc1 sc0 ls0 ws0">Disk</div><div class="t m5 x9d h44 y622 ff15 fs2a fc1 sc0 ls0 ws0">“hello”</div><div class="t m5 x9e h44 y623 ff15 fs2a fc1 sc0 ls0 ws0">User</div><div class="t m5 x9f h44 y624 ff15 fs2a fc1 sc0 ls0 ws0">types</div><div class="t m5 xa0 h44 y625 ff15 fs2a fc1 sc0 ls0 ws0">“hello”</div><div class="t m5 x17 h26 y626 ff7 fs19 fc1 sc0 ls0 ws0">object<span class="_ _11"> </span>ﬁle<span class="_ _16"> </span>from<span class="_ _11"> </span>disk<span class="_ _11"> </span>to<span class="_ _16"> </span>main<span class="_ _11"> </span>memory<span class="_ _3"></span>.<span class="_ _11"> </span>The<span class="_"> </span>data<span class="_ _16"> </span>includes<span class="_ _11"> </span>the<span class="_ _16"> </span>string<span class="_ _11"> </span>of<span class="_ _11"> </span>characters</div><div class="t m5 x17 h26 y627 ffd fs19 fc1 sc0 ls0 ws0">hello,<span class="_ _11"> </span>world\n<span class="_ _11"> </span><span class="ff7">that<span class="_"> </span>will<span class="_"> </span>eventually<span class="_"> </span>be<span class="_"> </span>printed<span class="_"> </span>out.</span></div><div class="t m5 x26 h26 y628 ff7 fs19 fc1 sc0 ls0 ws0">Using<span class="_ _13"> </span>a<span class="_"> </span>technique<span class="_ _13"> </span>known<span class="_"> </span>as<span class="_ _13"> </span><span class="ffa">direct<span class="_"> </span>memory<span class="_ _13"> </span>access<span class="_"> </span></span>(DMA,<span class="_ _13"> </span>discussed<span class="_"> </span>in<span class="_ _13"> </span>Chap-</div><div class="t m5 x17 h26 y629 ff7 fs19 fc1 sc0 ls0 ws0">ter<span class="_ _13"> </span>6),<span class="_ _13"> </span>the<span class="_"> </span>data<span class="_ _13"> </span>travel<span class="_ _13"> </span>directly<span class="_ _13"> </span>from<span class="_ _13"> </span>disk<span class="_ _13"> </span>to<span class="_"> </span>main<span class="_ _13"> </span>memory<span class="_ _7"></span>,<span class="_"> </span>without<span class="_ _13"> </span>passing<span class="_ _13"> </span>through</div><div class="t m5 x17 h26 y62a ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>processor.<span class="_"> </span>T<span class="_ _1"></span>his<span class="_"> </span>step<span class="_"> </span>is<span class="_"> </span>shown<span class="_"> </span>in<span class="_"> </span>F<span class="_ _1"></span>igure<span class="_"> </span>1.6.</div><div class="t m5 x26 h26 y62b ff7 fs19 fc1 sc0 ls0 ws0">Once<span class="_ _15"> </span>the<span class="_ _21"> </span>code<span class="_ _15"> </span>and<span class="_ _21"> </span>data<span class="_ _15"> </span>in<span class="_ _21"> </span>the<span class="_ _15"> </span><span class="ffd">hello<span class="_ _21"> </span></span>object<span class="_ _15"> </span>ﬁle<span class="_ _21"> </span>are<span class="_ _15"> </span>loaded<span class="_ _21"> </span>into<span class="_ _15"> </span>memory<span class="_ _3"></span>,</div><div class="t m5 x17 h26 y62c ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _14"> </span>processor<span class="_ _14"> </span>begins<span class="_ _14"> </span>executing<span class="_ _14"> </span>the<span class="_ _14"> </span>machine-language<span class="_ _14"> </span>instructions<span class="_ _14"> </span>in<span class="_ _14"> </span>the<span class="_ _14"> </span><span class="ffd">hello</span></div><div class="t m5 x17 h26 y62d ff7 fs19 fc1 sc0 ls0 ws0">program’s<span class="_ _13"> </span><span class="ffd">main<span class="_ _10"> </span></span>routine<span class="_ _1"></span>.<span class="_"> </span>T<span class="_ _1"></span>hese<span class="_"> </span>instructions<span class="_ _13"> </span>copy<span class="_"> </span>the<span class="_ _13"> </span>bytes<span class="_"> </span>in<span class="_ _13"> </span>the<span class="_ _13"> </span><span class="ffd">hello,<span class="_ _16"> </span>world\n</span></div><div class="t m5 x17 h26 y62e ff7 fs19 fc1 sc0 ls0 ws0">string<span class="_ _13"> </span>from<span class="_ _6"> </span>memory<span class="_ _13"> </span>to<span class="_ _6"> </span>the<span class="_ _13"> </span>register<span class="_ _6"> </span>ﬁle,<span class="_ _13"> </span>and<span class="_ _6"> </span>from<span class="_ _13"> </span>there<span class="_ _6"> </span>to<span class="_ _13"> </span>the<span class="_ _6"> </span>display<span class="_ _13"> </span>device<span class="_ _1"></span>,<span class="_ _13"> </span>where</div><div class="t m5 x17 h26 y62f ff7 fs19 fc1 sc0 ls0 ws0">they<span class="_"> </span>are<span class="_"> </span>displayed<span class="_"> </span>on<span class="_"> </span>the<span class="_"> </span>screen.<span class="_"> </span>T<span class="_ _1"></span>his<span class="_"> </span>step<span class="_"> </span>is<span class="_"> </span>shown<span class="_"> </span>in<span class="_"> </span>Figure<span class="_"> </span>1.7.</div><div class="t m5 x17 h3b y630 fff fs24 fc6 sc0 ls0 ws0">1.5<span class="_ _17"> </span><span class="ffe fs18">Caches<span class="_"> </span>Matter</span></div><div class="t m5 x17 h26 y631 ff7 fs19 fc1 sc0 ls0 ws0">An<span class="_ _14"> </span>important<span class="_ _14"> </span>lesson<span class="_ _14"> </span>from<span class="_ _14"> </span>this<span class="_ _15"> </span>simple<span class="_ _14"> </span>example<span class="_ _14"> </span>is<span class="_ _14"> </span>that<span class="_ _14"> </span>a<span class="_ _14"> </span>system<span class="_ _15"> </span>spends<span class="_ _14"> </span>a<span class="_ _14"> </span>lot<span class="_ _14"> </span>of</div><div class="t m5 x17 h26 y632 ff7 fs19 fc1 sc0 ls0 ws0">time<span class="_"> </span>moving<span class="_"> </span>information<span class="_"> </span>from<span class="_"> </span>one<span class="_"> </span>place<span class="_"> </span>to<span class="_"> </span>another<span class="_ _1"></span>.<span class="_"> </span>The<span class="_ _13"> </span>machine<span class="_"> </span>instructions<span class="_"> </span>in</div><div class="t m5 x17 h26 y633 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _14"> </span><span class="ffd">hello<span class="_ _14"> </span></span>program<span class="_ _14"> </span>are<span class="_ _14"> </span>originally<span class="_ _16"> </span>stored<span class="_ _14"> </span>on<span class="_ _14"> </span>disk.<span class="_ _14"> </span>When<span class="_ _14"> </span>the<span class="_ _14"> </span>program<span class="_ _14"> </span>is<span class="_ _14"> </span>loaded,</div><div class="t m5 x17 h26 y634 ff7 fs19 fc1 sc0 ls0 ws0">they<span class="_ _15"> </span>are<span class="_ _14"> </span>copied<span class="_ _15"> </span>to<span class="_ _15"> </span>main<span class="_ _15"> </span>memory<span class="_ _3"></span>.<span class="_ _15"> </span>As<span class="_ _15"> </span>the<span class="_ _15"> </span>processor<span class="_ _15"> </span>runs<span class="_ _15"> </span>the<span class="_ _15"> </span>program,<span class="_ _21"> </span>instruc-</div><div class="t m5 x17 h26 y635 ff7 fs19 fc1 sc0 ls0 ws0">tions<span class="_"> </span>are<span class="_ _11"> </span>copied<span class="_ _11"> </span>from<span class="_"> </span>main<span class="_ _11"> </span>memory<span class="_ _11"> </span>into<span class="_ _11"> </span>the<span class="_"> </span>processor.<span class="_"> </span>Similarly<span class="_ _3"></span>,<span class="_ _11"> </span>the<span class="_ _11"> </span>data<span class="_ _11"> </span>string</div><div class="t m5 x17 h26 y636 ffd fs19 fc1 sc0 ls0 ws0">hello,world\n<span class="ff7">,<span class="_ _14"> </span>originally<span class="_ _14"> </span>on<span class="_ _14"> </span>disk,<span class="_ _15"> </span>is<span class="_ _14"> </span>copied<span class="_ _16"> </span>to<span class="_ _14"> </span>main<span class="_ _14"> </span>memory<span class="_ _14"> </span>and<span class="_ _14"> </span>then<span class="_ _14"> </span>copied</span></div><div class="t m5 x17 h26 y637 ff7 fs19 fc1 sc0 ls0 ws0">from<span class="_ _13"> </span>main<span class="_ _13"> </span>memory<span class="_ _6"> </span>to<span class="_ _13"> </span>the<span class="_ _13"> </span>display<span class="_ _13"> </span>device<span class="_ _1"></span>.<span class="_ _13"> </span>F<span class="_ _1"></span>rom<span class="_ _13"> </span>a<span class="_ _13"> </span>programmer’<span class="_ _0"></span>s<span class="_ _13"> </span>perspective<span class="_ _1"></span>,<span class="_ _13"> </span>much</div><div class="t m5 x17 h26 y638 ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_ _13"> </span>this<span class="_ _13"> </span>copying<span class="_"> </span>is<span class="_ _13"> </span>overhead<span class="_ _13"> </span>that<span class="_ _13"> </span>slows<span class="_ _13"> </span>down<span class="_"> </span>the<span class="_ _13"> </span>“real<span class="_ _13"> </span>work”<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_"> </span>program.<span class="_ _13"> </span>T<span class="_ _1"></span>hus<span class="_ _1"></span>,</div><div class="t m5 x17 h26 y639 ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_"> </span>major<span class="_"> </span>goal<span class="_ _11"> </span>for<span class="_"> </span>system<span class="_"> </span>designers<span class="_ _11"> </span>is<span class="_"> </span>to<span class="_ _11"> </span>make<span class="_"> </span>these<span class="_"> </span>copy<span class="_ _11"> </span>operations<span class="_"> </span>run<span class="_"> </span>as<span class="_ _11"> </span>fast<span class="_"> </span>as</div><div class="t m5 x17 h26 y63a ff7 fs19 fc1 sc0 ls0 ws0">possible<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y63b ff7 fs19 fc1 sc0 ls0 ws0">Because<span class="_"> </span>of<span class="_"> </span>physical<span class="_"> </span>laws<span class="_ _1"></span>,<span class="_"> </span>larger<span class="_"> </span>storage<span class="_"> </span>devices<span class="_"> </span>are<span class="_"> </span>slower<span class="_"> </span>than<span class="_"> </span>smaller<span class="_"> </span>stor<span class="_ _3"></span>-</div><div class="t m5 x17 h26 y63c ff7 fs19 fc1 sc0 ls0 ws0">age<span class="_ _15"> </span>devices<span class="_ _1"></span>.<span class="_ _15"> </span>And<span class="_ _15"> </span>faster<span class="_ _15"> </span>devices<span class="_ _15"> </span>are<span class="_ _15"> </span>more<span class="_ _15"> </span>expensive<span class="_ _15"> </span>to<span class="_ _15"> </span>build<span class="_ _15"> </span>than<span class="_ _15"> </span>their<span class="_ _15"> </span>slower</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
