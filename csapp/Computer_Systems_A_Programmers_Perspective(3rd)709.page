<div id="pf2c5" class="pf w2 h11" data-page-no="2c5"><div class="pc pc2c5 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg2c5.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">708<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>7<span class="_ _3d"> </span>Linking</span></div><div class="t m5 x14 h2f ye7 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>7.2</div><div class="t m5 x14 h34 y58a ffe fs16 fc1 sc0 ls0 ws0">Static<span class="_ _11"> </span>linking.<span class="_ _16"> </span><span class="ff6">The<span class="_ _11"> </span>linker</span></div><div class="t m5 x14 h34 y58b ff6 fs16 fc1 sc0 ls0 ws0">combines<span class="_ _14"> </span>relocatable</div><div class="t m5 x14 h34 y58c ff6 fs16 fc1 sc0 ls0 ws0">object<span class="_ _14"> </span>ﬁles<span class="_ _16"> </span>to<span class="_ _14"> </span>form<span class="_ _14"> </span>an</div><div class="t m5 x14 h34 y58d ff6 fs16 fc1 sc0 ls0 ws0">executable<span class="_ _14"> </span>object<span class="_ _15"> </span>ﬁle</div><div class="t m5 x14 h3a ydc7 ffd fs19 fc1 sc0 ls0 ws0">prog<span class="ff6 fs16">.</span></div><div class="t m5 x235 h40 y5e16 ff89 fs28 fc1 sc0 ls0 ws0">main.c</div><div class="t m5 x235 h40 y5e17 ff89 fs28 fc1 sc0 ls0 ws0">main.o</div><div class="t m5 x1d0 h3f y5e18 ff8a fs27 fc1 sc0 ls0 ws0">T<span class="_ _0"></span>ranslators</div><div class="t m5 x18e h40 y5e19 ff8a fs27 fc1 sc0 ls0 ws0">(<span class="ff89 fs28">cpp, cc1, as</span>)</div><div class="t m5 x116 h3f y5e1a ff8a fs27 fc1 sc0 ls0 ws0">Linker (</div><div class="t m5 x197 h40 y5e1b ff89 fs28 fc1 sc0 ls0 ws0">ld<span class="ff8a fs27">)</span></div><div class="t m5 xbe h40 y5e1c ff89 fs28 fc1 sc0 ls0 ws0">prog</div><div class="t m5 x7b h3f y5e1d ff80 fs27 fc1 sc0 ls0 ws0">Fully linked</div><div class="t m5 x7b h3f y5e1e ff80 fs27 fc1 sc0 ls0 ws0">ex<span class="_ _1"></span>ecutable object file</div><div class="t m5 x1e7 h3f y5e1f ff80 fs27 fc1 sc0 ls0 ws0">Relocatabl</div><div class="c xe0 y5e20 w23 hee"><div class="t m5 x1d5 h3f y5e21 ff80 fs27 fc1 sc0 ls0 ws0">e</div></div><div class="t m5 x1e7 h3f y5e22 ff80 fs27 fc1 sc0 ls0 ws0">object files</div><div class="t m5 xf4 h3f y5e23 ff80 fs27 fc1 sc0 ls0 ws0">Source files</div><div class="t m5 x119 h40 y5e16 ff89 fs28 fc1 sc0 ls0 ws0">sum.c</div><div class="t m5 x119 h40 y5e17 ff89 fs28 fc1 sc0 ls0 ws0">sum.o</div><div class="t m5 x87 h3f y5e18 ff8a fs27 fc1 sc0 ls0 ws0">T<span class="_ _0"></span>ranslators</div><div class="t m5 x197 h40 y5e19 ff8a fs27 fc1 sc0 ls0 ws0">(<span class="ff89 fs28">cpp, cc1, as</span>)</div><div class="t m5 x1d h53 y5e24 ffd fs1e fc2 sc0 ls0 ws0">cpp<span class="_ _e"> </span>[<span class="ffa">other<span class="_"> </span>arguments<span class="_ _2"></span></span>]<span class="_ _e"> </span>main.c<span class="_ _1f"> </span>/tmp/main.i</div><div class="t m5 x1d h26 y5e25 ff7 fs19 fc2 sc0 ls0 ws0">Next,<span class="_ _13"> </span>the<span class="_ _13"> </span>driver<span class="_ _6"> </span>runs<span class="_ _13"> </span>the<span class="_ _13"> </span>C<span class="_ _13"> </span>compiler<span class="_ _6"> </span>(<span class="ffd">cc1</span>),<span class="_ _13"> </span>which<span class="_ _13"> </span>translates<span class="_ _13"> </span><span class="ffd">main.i<span class="_ _13"> </span></span>into<span class="_ _6"> </span>an<span class="_ _13"> </span>ASCII</div><div class="t m5 x1d h26 y5e26 ff7 fs19 fc2 sc0 ls0 ws0">assembly-language<span class="_"> </span>ﬁle<span class="_"> </span><span class="ffd">main.s</span>:</div><div class="t m5 x1d h53 y5e27 ffd fs1e fc2 sc0 ls0 ws0">cc1<span class="_ _e"> </span>/tmp/main.i<span class="_ _1f"> </span>-Og<span class="_ _1f"> </span>[<span class="ffa">other<span class="_"> </span>arguments</span>]<span class="_ _e"> </span>-o<span class="_ _1f"> </span>/tmp/main.s</div><div class="t m5 x1d h26 y5e28 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>hen,<span class="_ _14"> </span>the<span class="_ _16"> </span>driver<span class="_ _11"> </span>runs<span class="_ _16"> </span>the<span class="_ _16"> </span>assembler<span class="_ _16"> </span>(<span class="ffd">as</span>),<span class="_ _16"> </span>which<span class="_ _16"> </span>translates<span class="_ _16"> </span><span class="ffd">main.s<span class="_ _16"> </span></span>into<span class="_ _16"> </span>a<span class="_ _16"> </span>binary</div><div class="t m5 x1d h26 y5e29 ffa fs19 fc2 sc0 ls0 ws0">relocatable<span class="_"> </span>object<span class="_"> </span>ﬁle<span class="_"> </span><span class="ffd">main.o<span class="ff7">:</span></span></div><div class="t m5 x1d h53 y5e2a ffd fs1e fc2 sc0 ls0 ws0">as<span class="_ _e"> </span>[<span class="ffa">other<span class="_"> </span>arguments<span class="_ _2"></span></span>]<span class="_ _e"> </span>-o<span class="_ _1f"> </span>/tmp/main.o<span class="_ _e"> </span>/tmp/main.s</div><div class="t m5 x1d h26 y5e2b ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _16"> </span>driver<span class="_"> </span>goes<span class="_ _16"> </span>through<span class="_ _11"> </span>the<span class="_ _11"> </span>same<span class="_ _11"> </span>process<span class="_ _16"> </span>to<span class="_ _11"> </span>generate<span class="_ _11"> </span><span class="ffd">sum.o</span>.<span class="_ _11"> </span>Finally<span class="_ _7"></span>,<span class="_ _16"> </span>it<span class="_ _11"> </span>runs<span class="_ _11"> </span>the</div><div class="t m5 x1d h26 y5e2c ff7 fs19 fc2 sc0 ls0 ws0">linker<span class="_ _11"> </span>program<span class="_ _11"> </span><span class="ffd">ld</span>,<span class="_ _11"> </span>which<span class="_ _11"> </span>combines<span class="_ _11"> </span><span class="ffd">main.o<span class="_ _11"> </span></span>and<span class="_ _11"> </span><span class="ffd">sum.o</span>,<span class="_ _16"> </span>along<span class="_"> </span>with<span class="_ _16"> </span>the<span class="_"> </span>necessary</div><div class="t m5 x1d h26 y5e2d ff7 fs19 fc2 sc0 ls0 ws0">system<span class="_"> </span>object<span class="_"> </span>ﬁles<span class="_ _1"></span>,<span class="_"> </span>to<span class="_"> </span>create<span class="_"> </span>the<span class="_"> </span>binary<span class="_"> </span><span class="ffa">executable<span class="_"> </span>object<span class="_"> </span>ﬁle<span class="_"> </span><span class="ffd">prog</span></span>:</div><div class="t m5 x1d h53 y5e2e ffd fs1e fc2 sc0 ls0 ws0">ld<span class="_ _e"> </span>-o<span class="_ _1f"> </span>prog<span class="_ _1f"> </span>[<span class="ffa">system<span class="_"> </span>object<span class="_"> </span>ﬁles<span class="_"> </span>and<span class="_"> </span>args</span>]<span class="_ _e"> </span>/tmp/main.o<span class="_ _1f"> </span>/tmp/sum.o</div><div class="t m5 x29 h26 y5e2f ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _7"></span>o<span class="_ _11"> </span>run<span class="_ _11"> </span>the<span class="_"> </span>executable<span class="_ _11"> </span><span class="ffd">prog</span>,<span class="_ _11"> </span>we<span class="_ _11"> </span>type<span class="_"> </span>its<span class="_ _11"> </span>name<span class="_ _11"> </span>on<span class="_"> </span>the<span class="_ _11"> </span>Linux<span class="_ _11"> </span>shell’s<span class="_"> </span>command</div><div class="t m5 x1d h26 y5e30 ff7 fs19 fc2 sc0 ls0 ws0">line:</div><div class="t m5 x1d h2d y5e31 ffd fs1e fc2 sc0 ls0 ws0">linux&gt;<span class="_ _e"> </span><span class="ff13">./prog</span></div><div class="t m5 x1d h26 y5e32 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _13"> </span>shell<span class="_ _a"> </span>invokes<span class="_ _6"> </span>a<span class="_ _13"> </span>function<span class="_ _a"> </span>in<span class="_ _13"> </span>the<span class="_ _a"> </span>operating<span class="_ _13"> </span>system<span class="_ _a"> </span>called<span class="_ _6"> </span>the<span class="_ _13"> </span><span class="ffa">loader</span>,<span class="_ _13"> </span>which<span class="_ _6"> </span>copies</div><div class="t m5 x1d h26 y5e33 ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _14"> </span>code<span class="_ _15"> </span>and<span class="_ _14"> </span>data<span class="_ _15"> </span>in<span class="_ _14"> </span>the<span class="_ _15"> </span>executable<span class="_ _14"> </span>ﬁle<span class="_ _15"> </span><span class="ffd">prog<span class="_ _14"> </span></span>into<span class="_ _15"> </span>memory<span class="_ _3"></span>,<span class="_ _15"> </span>and<span class="_ _14"> </span>then<span class="_ _15"> </span>transfers</div><div class="t m5 x1d h26 y5e34 ff7 fs19 fc2 sc0 ls0 ws0">control<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>beginning<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>program.</div><div class="t m5 x1d h3b y5e35 fff fs24 fc6 sc0 ls0 ws0">7.2</div><div class="t m5 x58 h3e y2269 ffe fs18 fc6 sc0 ls0 ws0">Static<span class="_"> </span>Linking</div><div class="t m5 x1d h26 y107b ffa fs19 fc1 sc0 ls0 ws0">Static<span class="_ _6"> </span>linkers<span class="_ _13"> </span><span class="ff7">such<span class="_ _13"> </span>as<span class="_ _6"> </span>the<span class="_ _13"> </span>Linux<span class="_ _6"> </span><span class="ff9">ld<span class="_ _13"> </span></span>program<span class="_ _6"> </span>take<span class="_ _13"> </span>as<span class="_ _6"> </span>input<span class="_ _13"> </span>a<span class="_ _6"> </span>collection<span class="_ _6"> </span>of<span class="_ _13"> </span>relocatable</span></div><div class="t m5 x1d h26 y21fc ff7 fs19 fc1 sc0 ls0 ws0">object<span class="_ _16"> </span>ﬁles<span class="_ _14"> </span>and<span class="_ _14"> </span>command-line<span class="_ _16"> </span>arguments<span class="_ _14"> </span>and<span class="_ _14"> </span>generate<span class="_ _16"> </span>as<span class="_ _14"> </span>output<span class="_ _14"> </span>a<span class="_ _16"> </span>fully<span class="_ _14"> </span>linked</div><div class="t m5 x1d h26 y3366 ff7 fs19 fc1 sc0 ls0 ws0">executable<span class="_ _16"> </span>object<span class="_ _14"> </span>ﬁle<span class="_ _14"> </span>that<span class="_ _14"> </span>can<span class="_ _14"> </span>be<span class="_ _14"> </span>loaded<span class="_ _14"> </span>and<span class="_ _16"> </span>run.<span class="_ _14"> </span>The<span class="_ _16"> </span>input<span class="_ _14"> </span>relocatable<span class="_ _16"> </span>object</div><div class="t m5 x1d h26 y3367 ff7 fs19 fc1 sc0 ls0 ws0">ﬁles<span class="_"> </span>consist<span class="_"> </span>of<span class="_"> </span>various<span class="_"> </span>code<span class="_"> </span>and<span class="_"> </span>data<span class="_"> </span>sections<span class="_ _1"></span>,<span class="_"> </span>where<span class="_"> </span>each<span class="_"> </span>section<span class="_"> </span>is<span class="_"> </span>a<span class="_"> </span>contiguous</div><div class="t m5 x1d h26 yc03 ff7 fs19 fc1 sc0 ls0 ws0">sequence<span class="_"> </span>of<span class="_ _11"> </span>bytes<span class="_ _1"></span>.<span class="_"> </span>Instructions<span class="_ _11"> </span>are<span class="_"> </span>in<span class="_ _11"> </span>one<span class="_"> </span>section,<span class="_ _11"> </span>initialized<span class="_"> </span>global<span class="_ _11"> </span>variables<span class="_"> </span>are</div><div class="t m5 x1d h26 yc04 ff7 fs19 fc1 sc0 ls0 ws0">in<span class="_"> </span>another<span class="_"> </span>section,<span class="_"> </span>and<span class="_"> </span>uninitialized<span class="_"> </span>variables<span class="_"> </span>are<span class="_"> </span>in<span class="_"> </span>yet<span class="_"> </span>another<span class="_"> </span>section.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
