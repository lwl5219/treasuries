<div id="pf291" class="pf w2 h11" data-page-no="291"><div class="pc pc291 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg291.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">656<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>6<span class="_ _3d"> </span>The<span class="_ _10"> </span>Memory<span class="_ _10"> </span>Hierarchy</span></div><div class="t m5 x9b h31 y390 ff7 fs21 fc2 sc0 ls0 ws0">Address<span class="_"> </span>bits</div><div class="t m5 x5a h31 y391 ff7 fs21 fc2 sc0 ls0 ws0">Address<span class="_ _61"> </span>T<span class="_ _3"></span>ag<span class="_"> </span>bits<span class="_ _26"> </span>Index<span class="_"> </span>bits<span class="_ _26"> </span>Offset<span class="_"> </span>bits<span class="_ _26"> </span>Block<span class="_"> </span>number</div><div class="t m5 x1d h32 y576a ff7 fs21 fc2 sc0 ls0 ws0">(decimal)<span class="_ _61"> </span>(<span class="ff11">t<span class="_"> </span><span class="ff12">=<span class="_ _13"></span></span></span><span class="ls243">1)<span class="_ _d3"> </span>(<span class="_ _2"></span></span><span class="ff11">s<span class="_"> </span><span class="ff12">=<span class="_ _13"></span></span></span><span class="ls244">2)<span class="_ _128"> </span>(</span><span class="ff11">b<span class="_ _13"> </span><span class="ff12">=<span class="_ _13"> </span></span></span>1<span class="_ _0"></span>)<span class="_ _118"> </span>(decimal)</div><div class="t m5 x177 h31 yc9b ff7 fs21 fc2 sc0 ls245 ws0">00<span class="_ _be"></span>0<span class="_ _18e"></span>0<span class="_ _25"> </span>0<span class="_ _19"> </span>0</div><div class="t m5 x177 h31 yc9c ff7 fs21 fc2 sc0 ls245 ws0">10<span class="_ _be"></span>0<span class="_ _18e"></span>0<span class="_ _25"> </span>1<span class="_ _19"> </span>0</div><div class="t m5 x177 h31 y576b ff7 fs21 fc2 sc0 ls245 ws0">20<span class="_ _be"></span>0<span class="_ _18e"></span>1<span class="_ _25"> </span>0<span class="_ _19"> </span>1</div><div class="t m5 x177 h31 y576c ff7 fs21 fc2 sc0 ls245 ws0">30<span class="_ _be"></span>0<span class="_ _18e"></span>1<span class="_ _25"> </span>1<span class="_ _19"> </span>1</div><div class="t m5 x177 h31 y576d ff7 fs21 fc2 sc0 ls245 ws0">40<span class="_ _be"></span>1<span class="_ _18e"></span>0<span class="_ _25"> </span>0<span class="_ _19"> </span>2</div><div class="t m5 x177 h31 y576e ff7 fs21 fc2 sc0 ls245 ws0">50<span class="_ _be"></span>1<span class="_ _18e"></span>0<span class="_ _25"> </span>1<span class="_ _19"> </span>2</div><div class="t m5 x177 h31 y576f ff7 fs21 fc2 sc0 ls245 ws0">60<span class="_ _be"></span>1<span class="_ _18e"></span>1<span class="_ _25"> </span>0<span class="_ _19"> </span>3</div><div class="t m5 x177 h31 y5770 ff7 fs21 fc2 sc0 ls245 ws0">70<span class="_ _be"></span>1<span class="_ _18e"></span>1<span class="_ _25"> </span>1<span class="_ _19"> </span>3</div><div class="t m5 x177 h31 y5771 ff7 fs21 fc2 sc0 ls245 ws0">81<span class="_ _be"></span>0<span class="_ _18e"></span>0<span class="_ _25"> </span>0<span class="_ _19"> </span>4</div><div class="t m5 x177 h31 y5772 ff7 fs21 fc2 sc0 ls245 ws0">91<span class="_ _be"></span>0<span class="_ _18e"></span>0<span class="_ _25"> </span>1<span class="_ _19"> </span>4</div><div class="t m5 xa4 h31 y5773 ff7 fs21 fc2 sc0 ls0 ws0">10<span class="_ _156"> </span>1<span class="_ _54"> </span>01<span class="_ _1ea"> </span>0<span class="_ _7a"> </span>5</div><div class="t m5 xa4 h31 y5774 ff7 fs21 fc2 sc0 ls0 ws0">11<span class="_ _156"> </span>1<span class="_ _54"> </span>01<span class="_ _1ea"> </span>1<span class="_ _7a"> </span>5</div><div class="t m5 xa4 h31 y5775 ff7 fs21 fc2 sc0 ls0 ws0">12<span class="_ _156"> </span>1<span class="_ _54"> </span>10<span class="_ _1ea"> </span>0<span class="_ _7a"> </span>6</div><div class="t m5 xa4 h31 y5776 ff7 fs21 fc2 sc0 ls0 ws0">13<span class="_ _156"> </span>1<span class="_ _54"> </span>10<span class="_ _1ea"> </span>1<span class="_ _7a"> </span>6</div><div class="t m5 xa4 h31 y5777 ff7 fs21 fc2 sc0 ls0 ws0">14<span class="_ _156"> </span>1<span class="_ _54"> </span>11<span class="_ _1ea"> </span>0<span class="_ _7a"> </span>7</div><div class="t m5 xa4 h31 y5778 ff7 fs21 fc2 sc0 ls0 ws0">15<span class="_ _156"> </span>1<span class="_ _54"> </span>11<span class="_ _1ea"> </span>1<span class="_ _7a"> </span>7</div><div class="t m5 x1d h2f y1dcd ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>6.30<span class="_ _66"> </span><span class="fc1">4-bit<span class="_"> </span>address<span class="_"> </span>space<span class="_"> </span>for<span class="_"> </span>example<span class="_"> </span>direct-mapped<span class="_"> </span>cache.</span></div><div class="t m5 x29 h26 y5779 ff7 fs19 fc1 sc0 ls0 ws0">Let<span class="_"> </span>us<span class="_ _13"> </span>simulate<span class="_"> </span>the<span class="_"> </span>cache<span class="_ _13"> </span>in<span class="_"> </span>action<span class="_ _13"> </span>as<span class="_"> </span>the<span class="_"> </span>CPU<span class="_ _13"> </span>performs<span class="_"> </span>a<span class="_"> </span>sequence<span class="_ _13"> </span>of<span class="_"> </span>reads<span class="_ _1"></span>.</div><div class="t m5 x1d h26 y577a ff7 fs19 fc1 sc0 ls0 ws0">Remember<span class="_ _15"> </span>that<span class="_ _21"> </span>for<span class="_ _21"> </span>this<span class="_ _21"> </span>example<span class="_ _21"> </span>we<span class="_ _15"> </span>are<span class="_ _21"> </span>assuming<span class="_ _21"> </span>that<span class="_ _21"> </span>the<span class="_ _21"> </span>CPU<span class="_ _15"> </span>reads<span class="_ _21"> </span>1-byte</div><div class="t m5 x1d h26 y577b ff7 fs19 fc1 sc0 ls0 ws0">words<span class="_ _1"></span>.<span class="_ _11"> </span>While<span class="_"> </span>this<span class="_ _16"> </span>kind<span class="_"> </span>of<span class="_ _16"> </span>manual<span class="_"> </span>simulation<span class="_ _16"> </span>is<span class="_"> </span>tedious<span class="_ _16"> </span>and<span class="_"> </span>you<span class="_ _11"> </span>may<span class="_ _16"> </span>be<span class="_"> </span>tempted</div><div class="t m5 x1d h26 y577c ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_ _11"> </span>skip<span class="_ _16"> </span>it,<span class="_ _11"> </span>in<span class="_ _16"> </span>our<span class="_ _11"> </span>experience<span class="_ _16"> </span>students<span class="_ _11"> </span>do<span class="_ _16"> </span>not<span class="_ _11"> </span>really<span class="_ _11"> </span>understand<span class="_ _16"> </span>how<span class="_ _11"> </span>caches<span class="_ _16"> </span>work</div><div class="t m5 x1d h26 y577d ff7 fs19 fc1 sc0 ls0 ws0">until<span class="_"> </span>they<span class="_"> </span>work<span class="_"> </span>their<span class="_"> </span>way<span class="_"> </span>through<span class="_"> </span>a<span class="_"> </span>few<span class="_"> </span>of<span class="_"> </span>them.</div><div class="t m5 x29 h26 y577e ff7 fs19 fc1 sc0 ls0 ws0">Initially<span class="_ _3"></span>,<span class="_"> </span>the<span class="_"> </span>cache<span class="_"> </span>is<span class="_"> </span>empty<span class="_"> </span>(i.e<span class="_ _1"></span>.,<span class="_"> </span>each<span class="_"> </span>valid<span class="_"> </span>bit<span class="_"> </span>is<span class="_"> </span>0):</div><div class="t m5 x1d h31 y577f ff7 fs21 fc2 sc0 ls0 ws0">Set<span class="_ _26"> </span>V<span class="_ _7"></span>alid<span class="_ _26"> </span>T<span class="_ _3"></span>ag<span class="_ _26"> </span>block[0]<span class="_ _26"> </span>block[1]</div><div class="t m5 x1f6 h31 y5780 ff7 fs21 fc2 sc0 ls246 ws0">00</div><div class="t m5 x1f6 h31 y5781 ff7 fs21 fc2 sc0 ls246 ws0">10</div><div class="t m5 x1f6 h31 y5782 ff7 fs21 fc2 sc0 ls246 ws0">20</div><div class="t m5 x1f6 h31 y5783 ff7 fs21 fc2 sc0 ls246 ws0">30</div><div class="t m5 x1d h26 y5784 ff7 fs19 fc2 sc0 ls0 ws0">Each<span class="_ _16"> </span>row<span class="_ _11"> </span>in<span class="_ _16"> </span>the<span class="_ _16"> </span>table<span class="_ _11"> </span>represents<span class="_ _16"> </span>a<span class="_ _11"> </span>cache<span class="_ _16"> </span>line<span class="_ _0"></span>.<span class="_ _16"> </span>T<span class="_ _1"></span>he<span class="_ _16"> </span>ﬁrst<span class="_ _11"> </span>column<span class="_ _16"> </span>indicates<span class="_ _16"> </span>the<span class="_ _11"> </span>set</div><div class="t m5 x1d h26 y5785 ff7 fs19 fc2 sc0 ls0 ws0">that<span class="_ _13"> </span>the<span class="_ _13"> </span>line<span class="_ _13"> </span>belongs<span class="_ _6"> </span>to,<span class="_ _13"> </span>but<span class="_ _13"> </span>keep<span class="_ _6"> </span>in<span class="_ _13"> </span>mind<span class="_ _13"> </span>that<span class="_ _13"> </span>this<span class="_ _13"> </span>is<span class="_ _13"> </span>provided<span class="_ _13"> </span>for<span class="_ _6"> </span>convenience<span class="_ _13"> </span>and</div><div class="t m5 x1d h26 y5786 ff7 fs19 fc2 sc0 ls0 ws0">is<span class="_"> </span>not<span class="_ _11"> </span>really<span class="_"> </span>part<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_"> </span>cache.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_ _11"> </span>next<span class="_ _11"> </span>four<span class="_"> </span>columns<span class="_ _11"> </span>represent<span class="_ _11"> </span>the<span class="_"> </span>actual<span class="_ _11"> </span>bits<span class="_"> </span>in</div><div class="t m5 x1d h26 y5787 ff7 fs19 fc2 sc0 ls0 ws0">each<span class="_"> </span>cache<span class="_"> </span>line<span class="_ _1"></span>.<span class="_"> </span>Now<span class="_ _7"></span>,<span class="_"> </span>let’s<span class="_"> </span>see<span class="_ _13"> </span>what<span class="_"> </span>happens<span class="_"> </span>when<span class="_"> </span>the<span class="_ _13"> </span>CPU<span class="_"> </span>performs<span class="_"> </span>a<span class="_"> </span>sequence</div><div class="t m5 x1d h26 y5788 ff7 fs19 fc2 sc0 ls0 ws0">of<span class="_"> </span>reads:</div><div class="t m5 xc5 h26 y5789 ffc fs19 fc2 sc0 ls0 ws0">1.<span class="_ _e"> </span>Read<span class="_ _11"> </span>word<span class="_ _11"> </span>at<span class="_ _11"> </span>address<span class="_ _10"> </span>0.<span class="_ _11"> </span><span class="ff7">Since<span class="_ _11"> </span>the<span class="_ _11"> </span>valid<span class="_ _11"> </span>bit<span class="_ _11"> </span>for<span class="_ _11"> </span>set<span class="_ _11"> </span>0<span class="_ _11"> </span>is<span class="_"> </span>0,<span class="_ _16"> </span>this<span class="_"> </span>is<span class="_ _11"> </span>a<span class="_ _11"> </span>cache<span class="_ _11"> </span>miss<span class="_ _1"></span>.</span></div><div class="t m5 x29 h26 y578a ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _13"> </span>cache<span class="_ _6"> </span>fetches<span class="_ _6"> </span>block<span class="_ _13"> </span>0<span class="_ _6"> </span>from<span class="_ _13"> </span>memory<span class="_ _6"> </span>(or<span class="_ _6"> </span>a<span class="_ _13"> </span>lower<span class="_ _3"></span>-level<span class="_ _13"> </span>cache)<span class="_ _6"> </span>and<span class="_ _6"> </span>stores<span class="_ _13"> </span>the</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
