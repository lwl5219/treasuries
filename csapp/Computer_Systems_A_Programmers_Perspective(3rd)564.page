<div id="pf234" class="pf w2 h11" data-page-no="234"><div class="pc pc234 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg234.png"/><div class="t m5 x23b h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>5.7<span class="_ _60"> </span>Understanding<span class="_ _10"> </span>Modern<span class="_ _10"> </span>Processors<span class="_ _3e"> </span><span class="ffe fs1e">563</span></div><div class="t m5 x17 h2f ye7 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>5.14</div><div class="t m5 x17 h2f y58a ffe fs16 fc1 sc0 ls0 ws0">Abstracting</div><div class="t m5 x74 h3a y608 ffd fs19 fc1 sc0 ls0 ws0">combine4</div><div class="t m5 x17 h2f y609 ffe fs16 fc1 sc0 ls0 ws0">operations<span class="_"> </span>as<span class="_"> </span>a<span class="_"> </span>data-ﬂow</div><div class="t m5 x17 h34 y60a ffe fs16 fc1 sc0 ls0 ws0">graph.<span class="_ _11"> </span><span class="ff6">We<span class="_ _11"> </span>rearrange<span class="_ _11"> </span>the</span></div><div class="t m5 x17 h34 y2a12 ff6 fs16 fc1 sc0 ls0 ws0">operators<span class="_ _16"> </span>of<span class="_ _11"> </span>Figure<span class="_ _16"> </span>5.13</div><div class="t m5 x17 h34 y2a13 ff6 fs16 fc1 sc0 ls0 ws0">to<span class="_ _11"> </span>more<span class="_ _16"> </span>clearly<span class="_ _11"> </span>show<span class="_ _16"> </span>the</div><div class="t m5 x17 h34 y2a14 ff6 fs16 fc1 sc0 ls0 ws0">data<span class="_ _10"> </span>dependencies<span class="_ _10"> </span>(a),<span class="_ _10"> </span>and</div><div class="t m5 x17 h34 y4c88 ff6 fs16 fc1 sc0 ls0 ws0">then<span class="_ _16"> </span>further<span class="_ _14"> </span>show<span class="_ _16"> </span>only</div><div class="t m5 x17 h34 y4c89 ff6 fs16 fc1 sc0 ls0 ws0">those<span class="_ _11"> </span>operations<span class="_ _11"> </span>that<span class="_ _16"> </span>use</div><div class="t m5 x17 h34 y4c8a ff6 fs16 fc1 sc0 ls0 ws0">values<span class="_ _11"> </span>from<span class="_ _16"> </span>one<span class="_ _11"> </span>iteration</div><div class="t m5 x17 h34 y4c8b ff6 fs16 fc1 sc0 ls0 ws0">to<span class="_ _11"> </span>produce<span class="_ _11"> </span>new<span class="_ _11"> </span>values<span class="_ _11"> </span>for</div><div class="t m5 x17 h34 y4c8c ff6 fs16 fc1 sc0 ls0 ws0">the<span class="_ _10"> </span>next<span class="_ _11"> </span>(b).</div><div class="t m5 xb8 h40 y4c8d ff59 fs28 fc1 sc0 ls0 ws0">%rax<span class="_ _ea"> </span>%rdx<span class="_ _1de"></span>%xmm0</div><div class="t m5 x39 h40 y4c8e ff59 fs28 fc1 sc0 ls0 ws0">%rdx<span class="_ _1de"></span>%xmm0</div><div class="t m5 x12f h40 y4c8f ff59 fs28 fc1 sc0 ls0 ws0">data[</div><div class="t m5 x8d h40 y4c90 ff5a fs27 fc1 sc0 ls0 ws0">i<span class="_ _be"> </span><span class="ff59 fs28">]</span></div><div class="t m5 x16d h3f y4c91 ff58 fs27 fc1 sc0 ls214 ws0">load</div><div class="t m5 x69 h3f y4c92 ff58 fs27 fc1 sc0 ls214 ws0">(a)<span class="_ _1df"> </span>(b)</div><div class="t m5 x1b2 h3f y4c93 ff58 fs27 fc1 sc0 ls214 ws0">mul<span class="_ _169"> </span>add</div><div class="t m5 xb8 h3f y4c94 ff58 fs27 fc1 sc0 ls214 ws0">cmp</div><div class="t m5 x1b1 h3f y4c95 ff58 fs27 fc1 sc0 ls214 ws0">jne</div><div class="t m5 x71 h40 y4c96 ff59 fs28 fc1 sc0 ls0 ws0">%rdx<span class="_ _1e0"></span>%xmm0</div><div class="t m5 x71 h40 y4c97 ff59 fs28 fc1 sc0 ls0 ws0">%rdx<span class="_ _1e0"></span>%xmm0</div><div class="t m5 x1c0 h3f y4c98 ff58 fs27 fc1 sc0 ls214 ws0">load</div><div class="t m5 x1f0 h3f y4c99 ff58 fs27 fc1 sc0 ls214 ws0">mul<span class="_ _63"> </span>add</div><div class="t m5 x72 h26 y4c9a ffa fs19 fc1 sc0 ls0 ws0">Read-only<span class="_ _1"></span>.<span class="_ _21"> </span><span class="ff7">T<span class="_ _0"></span>hese<span class="_"> </span>are<span class="_ _13"> </span>used<span class="_"> </span>as<span class="_ _13"> </span>source<span class="_"> </span>values<span class="_ _3"></span>,<span class="_"> </span>either<span class="_ _13"> </span>as<span class="_"> </span>data<span class="_ _13"> </span>or<span class="_"> </span>to<span class="_ _13"> </span>compute<span class="_"> </span>mem-</span></div><div class="t m5 x30 h26 y4c9b ff7 fs19 fc1 sc0 ls0 ws0">ory<span class="_"> </span>addresses<span class="_ _1"></span>,<span class="_ _16"> </span>but<span class="_"> </span>they<span class="_ _11"> </span>are<span class="_ _11"> </span>not<span class="_"> </span>modiﬁed<span class="_ _11"> </span>within<span class="_ _11"> </span>the<span class="_ _11"> </span>loop<span class="_ _0"></span>.<span class="_"> </span>The<span class="_"> </span>only<span class="_ _11"> </span>read-</div><div class="t m5 x30 h26 y4c9c ff7 fs19 fc1 sc0 ls0 ws0">only<span class="_"> </span>register<span class="_"> </span>for<span class="_"> </span>the<span class="_"> </span>loop<span class="_"> </span>in<span class="_"> </span><span class="ffd">combine4<span class="_ _10"> </span></span>is<span class="_"> </span><span class="ffd">%rax</span>.</div><div class="t m5 x72 h26 y4c9d ffa fs19 fc1 sc0 ls0 ws0">Write-only<span class="_ _1"></span>.<span class="_ _21"> </span><span class="ff7">T<span class="_ _0"></span>hese<span class="_ _16"> </span>are<span class="_ _14"> </span>used<span class="_ _16"> </span>as<span class="_ _14"> </span>the<span class="_ _16"> </span>destinations<span class="_ _14"> </span>of<span class="_ _16"> </span>data-movement<span class="_ _14"> </span>operations<span class="_ _1"></span>.</span></div><div class="t m5 x30 h26 y4c9e ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>here<span class="_"> </span>are<span class="_"> </span>no<span class="_"> </span>such<span class="_"> </span>registers<span class="_"> </span>in<span class="_"> </span>this<span class="_"> </span>loop.</div><div class="t m5 x72 h26 y4c9f ffa fs19 fc1 sc0 ls0 ws0">Local.<span class="_ _21"> </span><span class="ff7">T<span class="_ _0"></span>hese<span class="_ _13"> </span>are<span class="_ _13"> </span>updated<span class="_"> </span>and<span class="_ _13"> </span>used<span class="_ _13"> </span>within<span class="_ _13"> </span>the<span class="_ _13"> </span>loop,<span class="_ _13"> </span>but<span class="_ _13"> </span>there<span class="_ _13"> </span>is<span class="_"> </span>no<span class="_ _13"> </span>dependency</span></div><div class="t m5 x30 h26 y4ca0 ff7 fs19 fc1 sc0 ls0 ws0">from<span class="_"> </span>one<span class="_ _13"> </span>iteration<span class="_"> </span>to<span class="_ _13"> </span>another.<span class="_ _13"> </span>The<span class="_ _13"> </span>condition<span class="_"> </span>code<span class="_ _13"> </span>registers<span class="_"> </span>are<span class="_ _13"> </span>examples</div><div class="t m5 x30 h26 y4ca1 ff7 fs19 fc1 sc0 ls0 ws0">for<span class="_"> </span>this<span class="_ _13"> </span>loop:<span class="_"> </span>they<span class="_"> </span>are<span class="_"> </span>updated<span class="_ _13"> </span>by<span class="_"> </span>the<span class="_"> </span><span class="ff6">cmp<span class="_ _13"> </span></span>operation<span class="_"> </span>and<span class="_"> </span>used<span class="_"> </span>by<span class="_ _13"> </span>the<span class="_"> </span><span class="ff6">jne</span></div><div class="t m5 x30 h26 y4ca2 ff7 fs19 fc1 sc0 ls0 ws0">operation,<span class="_"> </span>but<span class="_"> </span>this<span class="_"> </span>dependenc<span class="_ _0"></span>y<span class="_"> </span>is<span class="_"> </span>contained<span class="_"> </span>within<span class="_"> </span>individual<span class="_ _13"> </span>iterations<span class="_ _1"></span>.</div><div class="t m5 x72 h26 y4ca3 ffa fs19 fc1 sc0 ls0 ws0">Loop<span class="_ _1"></span>.<span class="_ _21"> </span><span class="ff7">T<span class="_ _0"></span>hese<span class="_ _16"> </span>are<span class="_ _16"> </span>used<span class="_ _16"> </span>both<span class="_ _16"> </span>as<span class="_ _14"> </span>source<span class="_ _16"> </span>values<span class="_ _16"> </span>and<span class="_ _16"> </span>as<span class="_ _16"> </span>destinations<span class="_ _14"> </span>for<span class="_ _16"> </span>the<span class="_ _16"> </span>loop<span class="_ _0"></span>,</span></div><div class="t m5 x30 h26 y4ca4 ff7 fs19 fc1 sc0 ls0 ws0">with<span class="_ _11"> </span>the<span class="_ _11"> </span>value<span class="_ _11"> </span>generated<span class="_"> </span>in<span class="_ _11"> </span>one<span class="_ _11"> </span>iteration<span class="_ _11"> </span>being<span class="_ _11"> </span>used<span class="_ _11"> </span>in<span class="_ _11"> </span>another.<span class="_ _11"> </span>W<span class="_ _3"></span>e<span class="_ _11"> </span>can</div><div class="t m5 x30 h26 y4ca5 ff7 fs19 fc1 sc0 ls0 ws0">see<span class="_ _11"> </span>that<span class="_ _11"> </span><span class="ffd">%rdx<span class="_ _11"> </span></span>and<span class="_ _11"> </span><span class="ffd">%xmm0<span class="_ _11"> </span></span>are<span class="_ _11"> </span>loop<span class="_ _11"> </span>registers<span class="_ _11"> </span>for<span class="_ _11"> </span><span class="ffd">combine4</span>,<span class="_ _16"> </span>corresponding</div><div class="t m5 x30 h26 y4ca6 ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_"> </span>program<span class="_"> </span>values<span class="_"> </span><span class="ffd">data+i<span class="_ _10"> </span></span>and<span class="_"> </span><span class="ffd">acc</span>.</div><div class="t m5 x17 h26 y4ca7 ff7 fs19 fc1 sc0 ls0 ws0">As<span class="_ _14"> </span>we<span class="_ _15"> </span>will<span class="_ _15"> </span>see,<span class="_ _15"> </span>the<span class="_ _15"> </span>chains<span class="_ _14"> </span>of<span class="_ _15"> </span>operations<span class="_ _15"> </span>between<span class="_ _15"> </span>loop<span class="_ _15"> </span>registers<span class="_ _15"> </span>determine<span class="_ _15"> </span>the</div><div class="t m5 x17 h26 y4ca8 ff7 fs19 fc1 sc0 ls0 ws0">performance-limiting<span class="_"> </span>data<span class="_"> </span>dependencies<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y4ca9 ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_"> </span>5.14<span class="_"> </span>shows<span class="_"> </span>further<span class="_"> </span>reﬁnements<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>graphical<span class="_"> </span>representation<span class="_"> </span>of<span class="_"> </span>F<span class="_ _1"></span>ig-</div><div class="t m5 x17 h26 y4caa ff7 fs19 fc1 sc0 ls0 ws0">ure<span class="_ _13"> </span>5.13,<span class="_"> </span>with<span class="_ _13"> </span>a<span class="_ _13"> </span>goal<span class="_ _13"> </span>of<span class="_ _13"> </span>showing<span class="_"> </span>only<span class="_ _13"> </span>those<span class="_ _13"> </span>operations<span class="_ _13"> </span>and<span class="_ _13"> </span>data<span class="_"> </span>dependencies<span class="_ _13"> </span>that</div><div class="t m5 x17 h26 y4cab ff7 fs19 fc1 sc0 ls0 ws0">affect<span class="_ _16"> </span>the<span class="_ _11"> </span>program<span class="_ _16"> </span>execution<span class="_ _16"> </span>time<span class="_ _1"></span>.<span class="_ _16"> </span>W<span class="_ _1"></span>e<span class="_ _16"> </span>see<span class="_ _11"> </span>in<span class="_ _16"> </span>F<span class="_ _0"></span>igure<span class="_ _16"> </span>5.14(a)<span class="_ _11"> </span>that<span class="_ _16"> </span>we<span class="_ _16"> </span>rearranged</div><div class="t m5 x17 h26 y4cac ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _11"> </span>operators<span class="_ _16"> </span>to<span class="_ _11"> </span>show<span class="_ _16"> </span>more<span class="_ _11"> </span>clearly<span class="_ _16"> </span>the<span class="_ _11"> </span>ﬂow<span class="_ _16"> </span>of<span class="_ _11"> </span>data<span class="_ _16"> </span>from<span class="_ _11"> </span>the<span class="_ _16"> </span>source<span class="_ _11"> </span>registers<span class="_ _16"> </span>at</div><div class="t m5 x17 h26 y4cad ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>top<span class="_"> </span>(both<span class="_"> </span>read-only<span class="_"> </span>and<span class="_"> </span>loop<span class="_ _13"> </span>registers)<span class="_"> </span>and<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>destination<span class="_"> </span>registers<span class="_"> </span>at<span class="_"> </span>the</div><div class="t m5 x17 h26 y4cae ff7 fs19 fc1 sc0 ls0 ws0">bottom<span class="_"> </span>(both<span class="_"> </span>write-only<span class="_"> </span>and<span class="_"> </span>loop<span class="_"> </span>registers).</div><div class="t m5 x26 h26 y4caf ff7 fs19 fc1 sc0 ls0 ws0">In<span class="_ _11"> </span>F<span class="_ _0"></span>igure<span class="_ _11"> </span>5.14(a),<span class="_ _11"> </span>we<span class="_ _16"> </span>also<span class="_"> </span>color<span class="_ _16"> </span>operators<span class="_"> </span>white<span class="_ _16"> </span>if<span class="_"> </span>they<span class="_ _16"> </span>are<span class="_"> </span>not<span class="_ _16"> </span>part<span class="_ _11"> </span>of<span class="_ _11"> </span>some</div><div class="t m5 x17 h26 y4cb0 ff7 fs19 fc1 sc0 ls0 ws0">chain<span class="_ _11"> </span>of<span class="_ _11"> </span>dependencies<span class="_ _11"> </span>between<span class="_ _11"> </span>loop<span class="_ _16"> </span>registers<span class="_ _3"></span>.<span class="_ _16"> </span>F<span class="_ _3"></span>or<span class="_ _16"> </span>this<span class="_"> </span>example,<span class="_"> </span>the<span class="_ _16"> </span>comparison</div><div class="t m5 x17 h26 y4cb1 ff7 fs19 fc1 sc0 ls0 ws0">(<span class="ff6">cmp</span>)<span class="_ _11"> </span>and<span class="_ _16"> </span>branch<span class="_ _16"> </span>(<span class="ff6">jne</span>)<span class="_ _11"> </span>operations<span class="_ _16"> </span>do<span class="_ _16"> </span>not<span class="_ _11"> </span>directly<span class="_ _16"> </span>affect<span class="_ _16"> </span>the<span class="_ _11"> </span>ﬂow<span class="_ _16"> </span>of<span class="_ _16"> </span>data<span class="_ _11"> </span>in<span class="_ _16"> </span>the</div><div class="t m5 x17 h26 y4cb2 ff7 fs19 fc1 sc0 ls0 ws0">program.<span class="_"> </span>W<span class="_ _3"></span>e<span class="_"> </span>assume<span class="_ _13"> </span>that<span class="_"> </span>the<span class="_"> </span>instruction<span class="_"> </span>control<span class="_ _13"> </span>unit<span class="_"> </span>predicts<span class="_"> </span>that<span class="_"> </span>branch<span class="_ _13"> </span>will<span class="_"> </span>be</div><div class="t m5 x17 h26 y4cb3 ff7 fs19 fc1 sc0 ls0 ws0">taken,<span class="_"> </span>and<span class="_ _13"> </span>hence<span class="_"> </span>the<span class="_ _13"> </span>program<span class="_"> </span>will<span class="_ _13"> </span>continue<span class="_"> </span>looping.<span class="_ _13"> </span>T<span class="_ _0"></span>he<span class="_"> </span>purpose<span class="_ _13"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>compare</div><div class="t m5 x17 h26 y4cb4 ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_ _16"> </span>branch<span class="_ _11"> </span>operations<span class="_ _16"> </span>is<span class="_ _16"> </span>to<span class="_ _16"> </span>test<span class="_ _11"> </span>the<span class="_ _16"> </span>branch<span class="_ _16"> </span>condition<span class="_ _16"> </span>and<span class="_ _11"> </span>notify<span class="_ _16"> </span>the<span class="_ _16"> </span>ICU<span class="_ _11"> </span>if<span class="_ _16"> </span>it<span class="_ _16"> </span>is</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
