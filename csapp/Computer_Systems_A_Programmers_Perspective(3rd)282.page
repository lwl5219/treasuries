<div id="pf11a" class="pf w2 h11" data-page-no="11a"><div class="pc pc11a w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg11a.png"/><div class="t m5 xb5 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>3.7<span class="_ _60"> </span>Procedures<span class="_ _3e"> </span><span class="ffe fs1e">281</span></div><div class="t m5 x1d4 h31 y298a ff7 fs21 fc2 sc0 ls0 ws0">Instruction<span class="_ _142"> </span>State<span class="_"> </span>values<span class="_"> </span>(at<span class="_"> </span>beginning)</div><div class="t m5 x17 h31 y22bf ff7 fs21 fc2 sc0 ls0 ws0">Label<span class="_ _1a"> </span>PC<span class="_ _d0"> </span>Instruction<span class="_ _b2"> </span><span class="ffd fs1e">%rdi<span class="_ _26"> </span>%rsi<span class="_ _19"> </span>%rax<span class="_ _2a"> </span>%rsp<span class="_ _6f"> </span>*%rsp<span class="_ _3e"> </span></span>Description</div><div class="t m5 x17 h31 y9bc ff7 fs21 fc2 sc0 ls0 ws0">M1<span class="_ _7b"> </span><span class="ffd fs1e">0x400560<span class="_ _1a"> </span>callq<span class="_ _2a"> </span></span><span class="ls16e">1<span class="_ _ef"></span>0——<span class="_ _7c"></span><span class="ffd fs1e ls0">0x7fffffffe820<span class="_ _79"> </span><span class="ff7 fs21">—<span class="_ _79"> </span>Call<span class="_"> </span></span>first(10)</span></span></div><div class="t m5 x17 h31 y395 ff7 fs21 fc2 sc0 ls0 ws0">F1</div><div class="t m5 x17 h31 y298b ff7 fs21 fc1 sc0 ls0 ws0">F2</div><div class="t m5 x17 h31 y298c ff7 fs21 fc1 sc0 ls0 ws0">F3</div><div class="t m5 x17 h31 y298d ff7 fs21 fc1 sc0 ls0 ws0">L1</div><div class="t m5 x17 h31 y298e ff7 fs21 fc1 sc0 ls0 ws0">L2</div><div class="t m5 x17 h31 y1037 ff7 fs21 fc1 sc0 ls0 ws0">L3</div><div class="t m5 x17 h31 y298f ff7 fs21 fc1 sc0 ls0 ws0">F4</div><div class="t m5 x17 h31 y228d ff7 fs21 fc1 sc0 ls0 ws0">M2</div><div class="t m5 x17 h41 y2990 ffe fs29 fc1 sc0 ls0 ws0">3.7.3<span class="_ _48"> </span><span class="fs19">Data<span class="_"> </span>T<span class="_ _3"></span>ransfer</span></div><div class="t m5 x17 h26 y2991 ff7 fs19 fc1 sc0 ls0 ws0">In<span class="_ _16"> </span>addition<span class="_ _16"> </span>to<span class="_ _16"> </span>passing<span class="_ _16"> </span>control<span class="_ _16"> </span>to<span class="_ _16"> </span>a<span class="_ _16"> </span>procedure<span class="_ _16"> </span>when<span class="_ _14"> </span>called,<span class="_ _16"> </span>and<span class="_ _16"> </span>then<span class="_ _16"> </span>back<span class="_ _14"> </span>again</div><div class="t m5 x17 h26 y2992 ff7 fs19 fc1 sc0 ls0 ws0">when<span class="_ _16"> </span>the<span class="_ _14"> </span>procedure<span class="_ _14"> </span>returns<span class="_ _1"></span>,<span class="_ _15"> </span>procedure<span class="_ _14"> </span>calls<span class="_ _14"> </span>may<span class="_ _16"> </span>involve<span class="_ _14"> </span>passing<span class="_ _14"> </span>data<span class="_ _14"> </span>as<span class="_ _14"> </span>argu-</div><div class="t m5 x17 h26 y2993 ff7 fs19 fc1 sc0 ls0 ws0">ments<span class="_ _1"></span>,<span class="_ _11"> </span>and<span class="_ _11"> </span>returning<span class="_ _11"> </span>from<span class="_ _11"> </span>a<span class="_ _11"> </span>procedure<span class="_ _11"> </span>may<span class="_ _11"> </span>also<span class="_ _11"> </span>involve<span class="_"> </span>returning<span class="_ _11"> </span>a<span class="_ _11"> </span>value.<span class="_"> </span>W<span class="_ _0"></span>ith</div><div class="t m5 x17 h26 y2994 ff7 fs19 fc1 sc0 ls0 ws0">x86-64,<span class="_ _16"> </span>most<span class="_ _16"> </span>of<span class="_ _16"> </span>these<span class="_ _16"> </span>data<span class="_ _16"> </span>passing<span class="_ _16"> </span>to<span class="_ _16"> </span>and<span class="_ _16"> </span>from<span class="_ _16"> </span>procedures<span class="_ _16"> </span>take<span class="_ _16"> </span>place<span class="_ _16"> </span>via<span class="_ _16"> </span>regis-</div><div class="t m5 x17 h26 y2995 ff7 fs19 fc1 sc0 ls0 ws0">ters<span class="_ _1"></span>.<span class="_ _11"> </span>F<span class="_ _1"></span>or<span class="_ _16"> </span>example<span class="_ _1"></span>,<span class="_ _16"> </span>we<span class="_ _11"> </span>have<span class="_ _16"> </span>already<span class="_ _11"> </span>seen<span class="_ _16"> </span>numerous<span class="_ _11"> </span>examples<span class="_ _11"> </span>of<span class="_ _16"> </span>functions<span class="_ _11"> </span>where</div><div class="t m5 x17 h26 y2996 ff7 fs19 fc1 sc0 ls0 ws0">arguments<span class="_ _13"> </span>are<span class="_ _13"> </span>passed<span class="_ _13"> </span>in<span class="_ _13"> </span>registers<span class="_ _13"> </span><span class="ffd">%rdi</span>,<span class="_ _13"> </span><span class="ffd">%rsi</span>,<span class="_ _13"> </span>and<span class="_ _13"> </span>others<span class="_ _1"></span>,<span class="_"> </span>and<span class="_ _6"> </span>where<span class="_ _13"> </span>values<span class="_ _13"> </span>are<span class="_ _13"> </span>re-</div><div class="t m5 x17 h26 y2997 ff7 fs19 fc1 sc0 ls0 ws0">turned<span class="_"> </span>in<span class="_"> </span>register<span class="_"> </span><span class="ffd">%rax</span>.<span class="_"> </span>W<span class="_ _1"></span>hen<span class="_"> </span>procedure<span class="_"> </span><span class="ffd">P<span class="_ _10"> </span></span>calls<span class="_"> </span>procedure<span class="_"> </span><span class="ffd">Q</span>,<span class="_"> </span>the<span class="_"> </span>code<span class="_ _13"> </span>for<span class="_"> </span><span class="ffd">P<span class="_ _10"> </span></span>must</div><div class="t m5 x17 h26 y2998 ff7 fs19 fc1 sc0 ls0 ws0">ﬁrst<span class="_"> </span>copy<span class="_"> </span>the<span class="_ _11"> </span>arguments<span class="_"> </span>into<span class="_ _11"> </span>the<span class="_"> </span>proper<span class="_"> </span>registers<span class="_ _0"></span>.<span class="_"> </span>Similarly<span class="_ _3"></span>,<span class="_"> </span>when<span class="_ _11"> </span><span class="ffd">Q<span class="_ _10"> </span></span>returns<span class="_ _11"> </span>back</div><div class="t m5 x17 h26 y2999 ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_"> </span><span class="ffd">P</span>,<span class="_"> </span>the<span class="_"> </span>code<span class="_"> </span>for<span class="_"> </span><span class="ffd">P<span class="_ _10"> </span></span>can<span class="_"> </span>access<span class="_"> </span>the<span class="_"> </span>returned<span class="_"> </span>value<span class="_ _13"> </span>in<span class="_"> </span>register<span class="_"> </span><span class="ffd">%rax</span>.<span class="_"> </span>In<span class="_"> </span>this<span class="_"> </span>section,</div><div class="t m5 x17 h26 y299a ff7 fs19 fc1 sc0 ls0 ws0">we<span class="_"> </span>explore<span class="_"> </span>these<span class="_"> </span>conventions<span class="_"> </span>in<span class="_"> </span>greater<span class="_"> </span>detail.</div><div class="t m5 x26 h26 y299b ff7 fs19 fc1 sc0 ls0 ws0">W<span class="_ _1"></span>ith<span class="_ _14"> </span>x86-64,<span class="_ _14"> </span>up<span class="_ _14"> </span>to<span class="_ _14"> </span>six<span class="_ _16"> </span>integral<span class="_ _14"> </span>(i.e.,<span class="_ _16"> </span>integer<span class="_ _14"> </span>and<span class="_ _14"> </span>pointer)<span class="_ _16"> </span>arguments<span class="_ _14"> </span>can<span class="_ _14"> </span>be</div><div class="t m5 x17 h26 y299c ff7 fs19 fc1 sc0 ls0 ws0">passed<span class="_ _14"> </span>via<span class="_ _14"> </span>registers<span class="_ _1"></span>.<span class="_ _15"> </span>T<span class="_ _1"></span>he<span class="_ _15"> </span>registers<span class="_ _14"> </span>are<span class="_ _14"> </span>used<span class="_ _15"> </span>in<span class="_ _14"> </span>a<span class="_ _14"> </span>speciﬁed<span class="_ _14"> </span>order,<span class="_ _15"> </span>with<span class="_ _14"> </span>the<span class="_ _15"> </span>name</div><div class="t m5 x17 h26 y299d ff7 fs19 fc1 sc0 ls0 ws0">used<span class="_"> </span>for<span class="_ _13"> </span>a<span class="_"> </span>register<span class="_"> </span>depending<span class="_"> </span>on<span class="_ _13"> </span>the<span class="_"> </span>size<span class="_"> </span>of<span class="_ _13"> </span>the<span class="_"> </span>data<span class="_"> </span>type<span class="_ _13"> </span>being<span class="_"> </span>passed.<span class="_"> </span>T<span class="_ _1"></span>hese<span class="_"> </span>are</div><div class="t m5 x17 h26 y299e ff7 fs19 fc1 sc0 ls0 ws0">shown<span class="_ _13"> </span>in<span class="_ _6"> </span>F<span class="_ _0"></span>igure<span class="_ _13"> </span>3.28.<span class="_ _6"> </span>Arguments<span class="_ _13"> </span>are<span class="_ _6"> </span>allocated<span class="_ _13"> </span>to<span class="_ _13"> </span>these<span class="_ _6"> </span>registers<span class="_ _13"> </span>according<span class="_ _6"> </span>to<span class="_ _13"> </span>their</div><div class="t m5 x7c h31 y299f ff7 fs21 fc2 sc0 ls0 ws0">Argument<span class="_"> </span>number</div><div class="t m5 x168 h31 y29a0 ff7 fs21 fc2 sc0 ls0 ws0">Operand</div><div class="t m5 x17 h31 y2606 ff7 fs21 fc2 sc0 ls0 ws0">size<span class="_"> </span>(bits)<span class="_ _94"> </span><span class="ls16f">123456</span></div><div class="t m5 x245 h31 y29a1 ff7 fs21 fc2 sc0 ls0 ws0">64<span class="_ _68"> </span><span class="ffd fs1e">%rdi<span class="_ _26"> </span>%rsi<span class="_ _26"> </span>%rdx<span class="_ _26"> </span>%rcx<span class="_ _61"> </span>%r8<span class="_ _75"> </span>%r9</span></div><div class="t m5 x245 h31 y29a2 ff7 fs21 fc2 sc0 ls0 ws0">32<span class="_ _68"> </span><span class="ffd fs1e">%edi<span class="_ _26"> </span>%esi<span class="_ _26"> </span>%edx<span class="_ _26"> </span>%ecx<span class="_ _26"> </span>%r8d<span class="_ _26"> </span>%r9d</span></div><div class="t m5 x245 h31 y29a3 ff7 fs21 fc2 sc0 ls0 ws0">16<span class="_ _6f"> </span><span class="ffd fs1e">%di<span class="_ _75"> </span>%si<span class="_ _75"> </span>%dx<span class="_ _75"> </span>%cx<span class="_ _61"> </span>%r8w<span class="_ _26"> </span>%r9w</span></div><div class="t m5 x1b6 h31 y29a4 ff7 fs21 fc2 sc0 ls0 ws0">8</div><div class="t m5 x5c h2d y29a5 ffd fs1e fc2 sc0 ls0 ws0">%dil<span class="_ _26"> </span>%sil<span class="_ _61"> </span>%dl<span class="_ _75"> </span>%cl<span class="_ _61"> </span>%r8b<span class="_ _26"> </span>%r9b</div><div class="t m5 x17 h34 y29a6 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _16"> </span>3.28<span class="_ _c"> </span><span class="fc1">Registers<span class="_ _16"> </span>for<span class="_ _16"> </span>passing<span class="_ _16"> </span>function<span class="_ _16"> </span>arguments.<span class="_ _16"> </span><span class="ff6">The<span class="_ _16"> </span>registers<span class="_ _16"> </span>are<span class="_ _16"> </span>used<span class="_ _16"> </span>in<span class="_ _14"> </span>a</span></span></div><div class="t m5 x17 h34 y29a7 ff6 fs16 fc1 sc0 ls0 ws0">speciﬁed<span class="_ _10"> </span>order<span class="_ _11"> </span>and<span class="_ _10"> </span>named<span class="_ _10"> </span>according<span class="_ _11"> </span>to<span class="_ _10"> </span>the<span class="_ _11"> </span>argument<span class="_ _10"> </span>sizes.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
