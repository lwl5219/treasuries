<div id="pf245" class="pf w2 h11" data-page-no="245"><div class="pc pc245 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg245.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">580<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>5<span class="_ _3d"> </span>Optimizing<span class="_ _10"> </span>Program<span class="_ _10"> </span>Performance</span></div><div class="t m5 x14 h2f ye7 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>5.29</div><div class="t m5 x14 h2f y58a ffe fs16 fc1 sc0 ls0 ws0">Data-ﬂow<span class="_"> </span>representation</div><div class="t m5 x14 h2f y58b ffe fs16 fc1 sc0 ls0 ws0">of</div><div class="t m5 x20d h3a y609 ffd fs19 fc1 sc0 ls0 ws0">combine7<span class="_ _16"> </span><span class="ffe fs16">operating</span></div><div class="t m5 x14 h2f y60a ffe fs16 fc1 sc0 ls0 ws0">on<span class="_ _11"> </span>a<span class="_ _16"> </span>vector<span class="_ _11"> </span>of<span class="_ _16"> </span>length<span class="_"> </span><span class="ff11">n</span>.</div><div class="t m5 x14 h34 y2a12 ff6 fs16 fc1 sc0 ls0 ws0">W<span class="_ _1"></span>e<span class="_ _16"> </span>have<span class="_ _16"> </span>a<span class="_ _16"> </span>single<span class="_ _16"> </span>critical</div><div class="t m5 x14 h34 y2a13 ff6 fs16 fc1 sc0 ls0 ws0">path,<span class="_ _11"> </span>but<span class="_ _16"> </span>it<span class="_ _11"> </span>contains<span class="_ _11"> </span>only</div><div class="t m5 x14 h1c y2a14 ff11 fs16 fc1 sc0 ls0 ws0">n/<span class="ff7">2<span class="_ _10"> </span><span class="ff6">operations.</span></span></div><div class="t m5 x1ec h40 y4e7f ff6b fs28 fc1 sc0 ls0 ws0">data[0]</div><div class="t m5 x1ec h40 y4e80 ff6b fs28 fc1 sc0 ls0 ws0">data[1]</div><div class="t m5 x1d1 h3f y4e81 ff6c fs27 fc1 sc0 ls214 ws0">load</div><div class="t m5 x16 h3f y4e82 ff6c fs27 fc1 sc0 ls214 ws0">load</div><div class="t m5 x9e h3f y4e83 ff6c fs27 fc1 sc0 ls214 ws0">mul</div><div class="t m5 x115 h3f y4e84 ff6c fs27 fc1 sc0 ls214 ws0">mul<span class="_ _115"> </span>add</div><div class="t m5 x1ec h40 y4e85 ff6b fs28 fc1 sc0 ls0 ws0">data[2]</div><div class="t m5 x1ec h40 y4e86 ff6b fs28 fc1 sc0 ls0 ws0">data[3]</div><div class="t m5 x1d1 h3f y4e87 ff6c fs27 fc1 sc0 ls214 ws0">load</div><div class="t m5 x16 h3f y4e88 ff6c fs27 fc1 sc0 ls214 ws0">load</div><div class="t m5 x9e h3f y4e89 ff6c fs27 fc1 sc0 ls214 ws0">mul</div><div class="t m5 x115 h3f y4e8a ff6c fs27 fc1 sc0 ls214 ws0">mul<span class="_ _115"> </span>add</div><div class="t m5 x1ec h40 y4e8b ff6b fs28 fc1 sc0 ls0 ws0">data[<span class="ff6d fs27">n</span>-2]</div><div class="t m5 x1ec h40 y4e8c ff6b fs28 fc1 sc0 ls0 ws0">data[</div><div class="t m5 x8f h40 y4e8d ff6d fs27 fc1 sc0 ls0 ws0">n<span class="ff6b fs28">-1]</span></div><div class="t m5 x1d1 h3f y4e8e ff6c fs27 fc1 sc0 ls214 ws0">load</div><div class="t m5 x16 h3f y4e8f ff6c fs27 fc1 sc0 ls214 ws0">load</div><div class="t m5 x9e h3f y4e90 ff6c fs27 fc1 sc0 ls214 ws0">mul</div><div class="t m5 x115 h3f y4e91 ff6c fs27 fc1 sc0 ls214 ws0">mul<span class="_ _115"> </span>add</div><div class="t m5 x18e h3f y4e92 ff6c fs27 fc1 sc0 ls214 wsa">Critical path</div><div class="t m5 x29 h26 y447 ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_"> </span>5.30<span class="_ _13"> </span>demonstrates<span class="_"> </span>the<span class="_ _13"> </span>effect<span class="_"> </span>of<span class="_ _13"> </span>applying<span class="_"> </span>the<span class="_ _13"> </span>reassociation<span class="_"> </span>transforma-</div><div class="t m5 x1d h46 y448 ff7 fs19 fc1 sc0 ls0 ws0">tion<span class="_"> </span>to<span class="_"> </span>achieve<span class="_"> </span>what<span class="_"> </span>we<span class="_"> </span>refer<span class="_"> </span>to<span class="_"> </span>as<span class="_"> </span><span class="ff11">k<span class="_ _11"> </span><span class="ff12">×<span class="_ _10"> </span></span></span>1<span class="_ _1"></span><span class="ff11">a<span class="_ _11"> </span><span class="ffa">loop<span class="_"> </span>unrolling<span class="_ _22"> </span><span class="ff7">for<span class="_"> </span>values<span class="_"> </span>up<span class="_"> </span>to<span class="_"> </span></span></span>k<span class="_ _11"> </span><span class="ff12">=<span class="_ _10"> </span><span class="ff7 ls24">10.</span></span></span></div><div class="t m5 x1d h26 y449 ff7 fs19 fc1 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_ _11"> </span>can<span class="_"> </span>see<span class="_ _11"> </span>that<span class="_ _11"> </span>this<span class="_"> </span>transformation<span class="_ _11"> </span>yields<span class="_ _11"> </span>performance<span class="_"> </span>results<span class="_ _11"> </span>similar<span class="_"> </span>to<span class="_ _11"> </span>what<span class="_ _11"> </span>is</div><div class="t m5 x1d h46 y44a ff7 fs19 fc1 sc0 ls0 ws0">achieved<span class="_ _13"> </span>by<span class="_ _13"> </span>maintaining<span class="_ _6"> </span><span class="ff11">k<span class="_ _10"> </span></span>separate<span class="_ _13"> </span>accumulators<span class="_ _13"> </span>with<span class="_ _13"> </span><span class="ff11">k<span class="_ _10"> </span><span class="ff12">×<span class="_ _13"></span></span>k<span class="_ _13"> </span></span>unrolling.<span class="_ _13"> </span>In<span class="_ _13"> </span>all<span class="_ _13"> </span>cases<span class="_ _3"></span>,</div><div class="t m5 x1d h26 y44b ff7 fs19 fc1 sc0 ls0 ws0">we<span class="_"> </span>come<span class="_"> </span>close<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>throughput<span class="_"> </span>bounds<span class="_"> </span>imposed<span class="_"> </span>by<span class="_"> </span>the<span class="_"> </span>functional<span class="_"> </span>units<span class="_ _1"></span>.</div><div class="t m5 x29 h26 y44c ff7 fs19 fc1 sc0 ls0 ws0">In<span class="_ _14"> </span>performing<span class="_ _15"> </span>the<span class="_ _14"> </span>reassociation<span class="_ _15"> </span>transformation,<span class="_ _21"> </span>we<span class="_ _14"> </span>once<span class="_ _15"> </span>again<span class="_ _15"> </span>change<span class="_ _14"> </span>the</div><div class="t m5 x1d h26 y44d ff7 fs19 fc1 sc0 ls0 ws0">order<span class="_ _6"> </span>in<span class="_ _13"> </span>which<span class="_ _6"> </span>the<span class="_ _13"> </span>vector<span class="_ _6"> </span>elements<span class="_ _13"> </span>will<span class="_ _6"> </span>be<span class="_ _6"> </span>combined<span class="_ _13"> </span>together.<span class="_ _a"> </span>F<span class="_ _0"></span>or<span class="_ _6"> </span>integer<span class="_ _13"> </span>addition</div><div class="t m5 x1d h26 y44e ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_ _f"> </span>multiplication,<span class="_ _e"> </span>the<span class="_ _f"> </span>fact<span class="_ _e"> </span>that<span class="_ _21"> </span>these<span class="_ _f"> </span>operations<span class="_ _e"> </span>are<span class="_ _21"> </span>associative<span class="_ _f"> </span>implies<span class="_ _e"> </span>that</div><div class="t m5 x1d h26 y44f ff7 fs19 fc1 sc0 ls0 ws0">this<span class="_ _11"> </span>reordering<span class="_ _16"> </span>will<span class="_ _11"> </span>have<span class="_ _16"> </span>no<span class="_ _11"> </span>effect<span class="_ _16"> </span>on<span class="_ _11"> </span>the<span class="_ _16"> </span>result.<span class="_ _11"> </span>F<span class="_ _1"></span>or<span class="_ _16"> </span>the<span class="_ _11"> </span>ﬂoating-point<span class="_ _16"> </span>cases<span class="_ _1"></span>,<span class="_ _16"> </span>we</div><div class="t m5 x1d h26 y3c1a ff7 fs19 fc1 sc0 ls0 ws0">must<span class="_ _16"> </span>once<span class="_ _16"> </span>again<span class="_ _11"> </span>assess<span class="_ _16"> </span>whether<span class="_ _16"> </span>this<span class="_ _16"> </span>reassociation<span class="_ _16"> </span>is<span class="_ _16"> </span>likely<span class="_ _16"> </span>to<span class="_ _16"> </span>signiﬁcantly<span class="_ _11"> </span>affect</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
