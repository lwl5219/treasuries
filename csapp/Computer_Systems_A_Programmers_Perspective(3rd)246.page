<div id="pff6" class="pf w2 h11" data-page-no="f6"><div class="pc pcf6 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bgf6.png"/><div class="t m5 x1dc h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>3.6<span class="_ _60"> </span>Control<span class="_ _3e"> </span><span class="ffe fs1e">245</span></div><div class="t m5 x17 h47 yb1f ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>3.15<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>366)</span></div><div class="t m5 x17 h26 yb20 ff7 fs19 fc1 sc0 ls0 ws0">In<span class="_ _13"> </span>the<span class="_ _13"> </span>following<span class="_ _13"> </span>excerpts<span class="_ _13"> </span>from<span class="_ _6"> </span>a<span class="_ _13"> </span>disassembled<span class="_ _13"> </span>binary<span class="_ _3"></span>,<span class="_ _13"> </span>some<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>information<span class="_ _13"> </span>has</div><div class="t m5 x17 h26 yb21 ff7 fs19 fc1 sc0 ls0 ws0">been<span class="_"> </span>replaced<span class="_"> </span>by<span class="_"> </span><span class="ffd">X</span>’s<span class="_ _3"></span>.<span class="_"> </span>Answer<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>questions<span class="_"> </span>about<span class="_"> </span>these<span class="_"> </span>instructions<span class="_ _1"></span>.</div><div class="t m5 x34 h26 y2536 ff7 fs19 fc1 sc0 ls0 ws0">A.<span class="_ _1f"> </span>What<span class="_ _11"> </span>is<span class="_ _11"> </span>the<span class="_ _16"> </span>target<span class="_ _16"> </span>of<span class="_ _11"> </span>the<span class="_ _16"> </span><span class="ffd">je<span class="_ _11"> </span></span>instruction<span class="_ _16"> </span>below?<span class="_ _11"> </span>(Y<span class="_ _3"></span>ou<span class="_ _16"> </span>do<span class="_ _11"> </span>not<span class="_ _16"> </span>need<span class="_ _11"> </span>to<span class="_ _16"> </span>know</div><div class="t m5 x2d h26 yb23 ff7 fs19 fc1 sc0 ls0 ws0">anything<span class="_"> </span>about<span class="_"> </span>the<span class="_"> </span><span class="ffd">callq<span class="_ _10"> </span></span>instruction<span class="_"> </span>here<span class="_ _0"></span>.)</div><div class="t m5 xd1 h2d y2537 ffd fs1e fc2 sc0 ls0 ws0">4003fa:<span class="_ _e"> </span>74<span class="_ _1f"> </span>02<span class="_ _15a"> </span>je<span class="_ _8c"> </span>XXXXXX</div><div class="t m5 xd1 h2d y2538 ffd fs1e fc2 sc0 ls0 ws0">4003fc:<span class="_ _e"> </span>ff<span class="_ _1f"> </span>d0<span class="_ _15a"> </span>callq<span class="_ _1a"> </span>*%rax</div><div class="t m5 x34 h26 y2539 ff7 fs19 fc2 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>What<span class="_"> </span>is<span class="_"> </span>the<span class="_"> </span>target<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span><span class="ffd">je<span class="_ _10"> </span></span>instruction<span class="_"> </span>below?</div><div class="t m5 xd1 h2d y253a ffd fs1e fc2 sc0 ls0 ws0">40042f:<span class="_ _e"> </span>74<span class="_ _1f"> </span>f4<span class="_ _15a"> </span>je<span class="_ _8c"> </span>XXXXXX</div><div class="t m5 xd1 h2d y253b ffd fs1e fc2 sc0 ls0 ws0">400431:<span class="_ _e"> </span>5d<span class="_ _15b"> </span>pop<span class="_ _46"> </span>%rbp</div><div class="t m5 x34 h26 y253c ff7 fs19 fc2 sc0 ls0 ws0">C.<span class="_ _25"> </span>What<span class="_"> </span>is<span class="_"> </span>the<span class="_"> </span>address<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span><span class="ffd">ja<span class="_ _10"> </span></span>and<span class="_"> </span><span class="ffd">pop<span class="_ _10"> </span></span>instructions?</div><div class="t m5 xd1 h2d y253d ffd fs1e fc2 sc0 ls0 ws0">XXXXXX:<span class="_ _e"> </span>77<span class="_ _1f"> </span>02<span class="_ _15a"> </span>ja<span class="_ _8c"> </span>400547</div><div class="t m5 xd1 h2d y253e ffd fs1e fc2 sc0 ls0 ws0">XXXXXX:<span class="_ _e"> </span>5d<span class="_ _15b"> </span>pop<span class="_ _46"> </span>%rbp</div><div class="t m5 x34 h26 y253f ff7 fs19 fc2 sc0 ls0 ws0">D<span class="_ _3"></span>.<span class="_ _23"> </span>In<span class="_ _6"> </span>the<span class="_ _13"> </span>code<span class="_ _a"> </span>that<span class="_ _6"> </span>follows<span class="_ _1"></span>,<span class="_ _13"> </span>the<span class="_ _6"> </span>jump<span class="_ _6"> </span>target<span class="_ _6"> </span>is<span class="_ _6"> </span>encoded<span class="_ _13"> </span>in<span class="_ _a"> </span>PC-relative<span class="_ _6"> </span>form<span class="_ _13"> </span>as<span class="_ _a"> </span>a<span class="_ _6"> </span>4-</div><div class="t m5 x2d h26 y2540 ff7 fs19 fc2 sc0 ls0 ws0">byte<span class="_ _13"> </span>two’<span class="_ _1"></span>s-complement<span class="_ _13"> </span>number.<span class="_ _6"> </span>The<span class="_ _6"> </span>bytes<span class="_ _13"> </span>are<span class="_ _13"> </span>listed<span class="_ _6"> </span>from<span class="_ _13"> </span>least<span class="_ _13"> </span>signiﬁcant<span class="_ _6"> </span>to</div><div class="t m5 x2d h26 y2541 ff7 fs19 fc2 sc0 ls0 ws0">most,<span class="_ _13"> </span>reﬂecting<span class="_ _13"> </span>the<span class="_ _6"> </span>little-endian<span class="_ _13"> </span>byte<span class="_ _13"> </span>ordering<span class="_ _6"> </span>of<span class="_ _13"> </span>x86-64.<span class="_ _6"> </span>What<span class="_ _13"> </span>is<span class="_ _6"> </span>the<span class="_ _13"> </span>address</div><div class="t m5 x2d h26 y2542 ff7 fs19 fc2 sc0 ls0 ws0">of<span class="_"> </span>the<span class="_"> </span>jump<span class="_"> </span>target?</div><div class="t m5 xd1 h2d y2543 ffd fs1e fc2 sc0 ls0 ws0">4005e8:<span class="_ _e"> </span>e9<span class="_ _1f"> </span>73<span class="_ _1f"> </span>ff<span class="_ _e"> </span>ff<span class="_ _1f"> </span>ff<span class="_ _71"> </span>jmpq<span class="_ _3f"> </span>XXXXXXX</div><div class="t m5 xd1 h2d y2544 ffd fs1e fc2 sc0 ls0 ws0">4005ed:<span class="_ _e"> </span>90<span class="_ _15b"> </span>nop</div><div class="t m5 x26 h26 y2545 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _16"> </span>jump<span class="_ _16"> </span>instructions<span class="_ _16"> </span>provide<span class="_ _11"> </span>a<span class="_ _16"> </span>means<span class="_ _16"> </span>to<span class="_ _16"> </span>implement<span class="_ _11"> </span>conditional<span class="_ _16"> </span>execution</div><div class="t m5 x17 h26 y2546 ff7 fs19 fc1 sc0 ls0 ws0">(<span class="ffd">if</span>),<span class="_"> </span>as<span class="_"> </span>well<span class="_"> </span>as<span class="_"> </span>several<span class="_"> </span>different<span class="_"> </span>loop<span class="_"> </span>constructs<span class="_ _1"></span>.</div><div class="t m5 x17 h41 y2547 ffe fs29 fc1 sc0 ls0 ws0">3.6.5<span class="_ _48"> </span><span class="fs19">Implementing<span class="_"> </span>Conditional<span class="_"> </span>Branches<span class="_"> </span>with<span class="_"> </span>Conditional<span class="_"> </span>Control</span></div><div class="t m5 x17 h26 y2548 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _16"> </span>most<span class="_ _16"> </span>general<span class="_ _16"> </span>way<span class="_ _16"> </span>to<span class="_ _16"> </span>translate<span class="_ _16"> </span>conditional<span class="_ _16"> </span>expressions<span class="_ _11"> </span>and<span class="_ _16"> </span>statements<span class="_ _16"> </span>from</div><div class="t m5 x17 h26 y2549 ff7 fs19 fc1 sc0 ls0 ws0">C<span class="_ _21"> </span>into<span class="_ _21"> </span>machine<span class="_ _21"> </span>code<span class="_ _21"> </span>is<span class="_ _21"> </span>to<span class="_ _21"> </span>use<span class="_ _21"> </span>combinations<span class="_ _21"> </span>of<span class="_ _21"> </span>conditional<span class="_ _21"> </span>and<span class="_ _21"> </span>unconditional</div><div class="t m5 x17 h26 y254a ff7 fs19 fc1 sc0 ls0 ws0">jumps<span class="_ _1"></span>.<span class="_ _21"> </span>(As<span class="_ _21"> </span>an<span class="_ _f"> </span>alternative<span class="_ _1"></span>,<span class="_ _e"> </span>we<span class="_ _21"> </span>will<span class="_ _21"> </span>see<span class="_ _21"> </span>in<span class="_ _f"> </span>Section<span class="_ _21"> </span>3.6.6<span class="_ _21"> </span>that<span class="_ _f"> </span>some<span class="_ _21"> </span>conditionals</div><div class="t m5 x17 h26 y254b ff7 fs19 fc1 sc0 ls0 ws0">can<span class="_ _15"> </span>be<span class="_ _15"> </span>implemented<span class="_ _15"> </span>by<span class="_ _15"> </span>conditional<span class="_ _15"> </span>transfers<span class="_ _15"> </span>of<span class="_ _15"> </span>data<span class="_ _21"> </span>rather<span class="_ _15"> </span>than<span class="_ _15"> </span>control.)<span class="_ _15"> </span>F<span class="_ _1"></span>or</div><div class="t m5 x17 h26 y254c ff7 fs19 fc1 sc0 ls0 ws0">example<span class="_ _1"></span>,<span class="_ _13"> </span>F<span class="_ _1"></span>igure<span class="_ _6"> </span>3.16(a)<span class="_ _6"> </span>shows<span class="_ _6"> </span>the<span class="_ _6"> </span>C<span class="_ _6"> </span>code<span class="_ _6"> </span>for<span class="_ _6"> </span>a<span class="_ _6"> </span>function<span class="_ _6"> </span>that<span class="_ _6"> </span>computes<span class="_ _6"> </span>the<span class="_ _6"> </span>absolute</div><div class="t m5 x17 h26 y254d ff7 fs19 fc1 sc0 ls0 ws0">value<span class="_ _14"> </span>of<span class="_ _14"> </span>the<span class="_ _15"> </span>difference<span class="_ _14"> </span>of<span class="_ _14"> </span>two<span class="_ _14"> </span>numbers<span class="_ _0"></span>.</div><div class="t m5 xdd h3c y254e ff7 fs25 fc1 sc0 ls0 ws0">3</div><div class="t m5 x68 h26 y254f ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _15"> </span>function<span class="_ _14"> </span>also<span class="_ _14"> </span>has<span class="_ _14"> </span>a<span class="_ _15"> </span>side<span class="_ _14"> </span>effect<span class="_ _14"> </span>of</div><div class="t m5 x17 h26 y2550 ff7 fs19 fc1 sc0 ls0 ws0">incrementing<span class="_ _16"> </span>one<span class="_ _16"> </span>of<span class="_ _14"> </span>two<span class="_ _16"> </span>counters<span class="_ _1"></span>,<span class="_ _14"> </span>encoded<span class="_ _16"> </span>as<span class="_ _14"> </span>global<span class="_ _16"> </span>variables<span class="_ _16"> </span><span class="ffd">lt_cnt<span class="_ _14"> </span></span>and<span class="_ _16"> </span><span class="ffd">ge_</span></div><div class="t m5 x17 h26 y2551 ffd fs19 fc1 sc0 ls0 ws0">cnt<span class="ff7">.<span class="_"> </span><span class="ff9">Gcc<span class="_ _11"> </span></span>generates<span class="_ _11"> </span>the<span class="_"> </span>assembly<span class="_ _11"> </span>code<span class="_ _11"> </span>shown<span class="_ _11"> </span>as<span class="_"> </span>Figure<span class="_"> </span>3.16(c).<span class="_"> </span>Our<span class="_ _11"> </span>rendition<span class="_ _11"> </span>of</span></div><div class="t m5 x17 h26 y2552 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>machine<span class="_ _11"> </span>code<span class="_ _11"> </span>into<span class="_"> </span>C<span class="_ _11"> </span>is<span class="_ _11"> </span>shown<span class="_ _11"> </span>as<span class="_"> </span>the<span class="_ _11"> </span>function<span class="_ _11"> </span><span class="ffd">gotodiff_se<span class="_ _11"> </span></span>(F<span class="_ _1"></span>igure<span class="_ _11"> </span>3.16(b)).</div><div class="t m5 x17 h26 y2553 ff7 fs19 fc1 sc0 ls0 ws0">It<span class="_ _14"> </span>uses<span class="_ _15"> </span>the<span class="_ _15"> </span><span class="ffd">goto<span class="_ _14"> </span></span>statement<span class="_ _15"> </span>in<span class="_ _15"> </span>C,<span class="_ _15"> </span>which<span class="_ _14"> </span>is<span class="_ _15"> </span>similar<span class="_ _15"> </span>to<span class="_ _14"> </span>the<span class="_ _15"> </span>unconditional<span class="_ _15"> </span>jump<span class="_ _14"> </span>of</div><div class="t m5 x17 h1d y2423 ff7 fs17 fc2 sc0 ls0 ws0">3.<span class="_"> </span>Actually<span class="_ _1"></span>,<span class="_"> </span>it<span class="_ _10"> </span>can<span class="_"> </span>return<span class="_"> </span>a<span class="_ _10"> </span>negative<span class="_"> </span>value<span class="_"> </span>if<span class="_ _10"> </span>one<span class="_"> </span>of<span class="_"> </span>the<span class="_ _10"> </span>subtractions<span class="_"> </span>overﬂows<span class="_ _1"></span>.<span class="_"> </span>Our<span class="_ _10"> </span>interest<span class="_"> </span>here<span class="_"> </span>is<span class="_ _10"> </span>to</div><div class="t m5 x17 h1d y2424 ff7 fs17 fc2 sc0 ls0 ws0">demonstrate<span class="_"> </span>machine<span class="_"> </span>code<span class="_ _0"></span>,<span class="_"> </span>not<span class="_"> </span>to<span class="_"> </span>implement<span class="_"> </span>robust<span class="_"> </span>code<span class="_ _0"></span>.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
