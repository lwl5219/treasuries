<div id="pf189" class="pf w2 h11" data-page-no="189"><div class="pc pc189 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg189.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">392<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>4<span class="_ _3d"> </span>Processor<span class="_ _10"> </span>Architecture</span></div><div class="t m5 x1d h26 y9c ff7 fs19 fc2 sc0 ls0 ws0">about<span class="_"> </span>the<span class="_ _13"> </span>effect<span class="_"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>most<span class="_"> </span>recent<span class="_"> </span>arithmetic<span class="_ _13"> </span>or<span class="_"> </span>logical<span class="_"> </span>instruction.<span class="_ _13"> </span>The<span class="_ _13"> </span>program</div><div class="t m5 x1d h26 y409 ff7 fs19 fc2 sc0 ls0 ws0">counter<span class="_"> </span>(<span class="ff6">PC</span>)<span class="_"> </span>holds<span class="_"> </span>the<span class="_"> </span>address<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>instruction<span class="_"> </span>currently<span class="_"> </span>being<span class="_"> </span>executed.</div><div class="t m5 x29 h26 y40a ff7 fs19 fc2 sc0 lsd ws0">Th<span class="_ _2"></span>e<span class="_ _f"> </span><span class="ffa ls0">memory<span class="_ _15"> </span><span class="ff7">is<span class="_ _15"> </span>conceptually<span class="_ _21"> </span>a<span class="_ _15"> </span>large<span class="_ _21"> </span>array<span class="_ _15"> </span>of<span class="_ _21"> </span>bytes<span class="_ _1"></span>,<span class="_ _f"> </span>holding<span class="_ _15"> </span>both<span class="_ _21"> </span>program</span></span></div><div class="t m5 x1d h26 y40b ff7 fs19 fc2 sc0 ls0 ws0">and<span class="_ _16"> </span>data.<span class="_ _16"> </span>Y86-64<span class="_ _16"> </span>programs<span class="_ _16"> </span>reference<span class="_ _16"> </span>memory<span class="_ _16"> </span>locations<span class="_ _16"> </span>using<span class="_ _16"> </span><span class="ffa">virtual<span class="_ _16"> </span>addresses</span>.</div><div class="t m5 x1d h26 y40c ff7 fs19 fc2 sc0 ls0 ws0">A<span class="_ _11"> </span>combination<span class="_ _16"> </span>of<span class="_ _11"> </span>hardware<span class="_ _11"> </span>and<span class="_ _16"> </span>operating<span class="_ _11"> </span>system<span class="_ _11"> </span>software<span class="_ _16"> </span>translates<span class="_ _11"> </span>these<span class="_ _11"> </span>into</div><div class="t m5 x1d h26 y40d ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _11"> </span>actual,<span class="_ _11"> </span>or<span class="_ _11"> </span><span class="ffa">physical<span class="_ _2"></span></span>,<span class="_ _16"> </span>addresses<span class="_"> </span>indicating<span class="_ _11"> </span>where<span class="_ _16"> </span>the<span class="_"> </span>values<span class="_ _11"> </span>are<span class="_ _11"> </span>actually<span class="_ _11"> </span>stored</div><div class="t m5 x1d h26 y40e ff7 fs19 fc2 sc0 ls0 ws0">in<span class="_ _16"> </span>memory<span class="_ _7"></span>.<span class="_ _16"> </span>W<span class="_ _3"></span>e<span class="_ _16"> </span>will<span class="_ _16"> </span>study<span class="_ _11"> </span>virtual<span class="_ _16"> </span>memory<span class="_ _16"> </span>in<span class="_ _11"> </span>more<span class="_ _16"> </span>detail<span class="_ _16"> </span>in<span class="_ _16"> </span>Chapter<span class="_ _11"> </span>9.<span class="_ _16"> </span>F<span class="_ _1"></span>or<span class="_ _16"> </span>now<span class="_ _7"></span>,</div><div class="t m5 x1d h26 y40f ff7 fs19 fc2 sc0 ls0 ws0">we<span class="_ _13"> </span>can<span class="_"> </span>think<span class="_ _13"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>virtual<span class="_"> </span>memory<span class="_ _13"> </span>system<span class="_"> </span>as<span class="_ _13"> </span>providing<span class="_"> </span>Y86-64<span class="_ _13"> </span>programs<span class="_"> </span>with<span class="_ _13"> </span>an</div><div class="t m5 x1d h26 y410 ff7 fs19 fc2 sc0 ls0 ws0">image<span class="_"> </span>of<span class="_"> </span>a<span class="_"> </span>monolithic<span class="_"> </span>byte<span class="_"> </span>array<span class="_ _3"></span>.</div><div class="t m5 x29 h26 y411 ff7 fs19 fc2 sc0 ls0 ws0">A<span class="_ _11"> </span>ﬁnal<span class="_ _16"> </span>part<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _16"> </span>program<span class="_ _11"> </span>state<span class="_ _16"> </span>is<span class="_ _11"> </span>a<span class="_ _11"> </span>status<span class="_ _16"> </span>code<span class="_ _11"> </span><span class="ff6">Stat</span>,<span class="_ _16"> </span>indicating<span class="_ _11"> </span>the<span class="_ _11"> </span>overall</div><div class="t m5 x1d h26 y412 ff7 fs19 fc2 sc0 ls0 ws0">state<span class="_"> </span>of<span class="_"> </span>program<span class="_"> </span>execution.<span class="_ _11"> </span>It<span class="_"> </span>will<span class="_"> </span>indicate<span class="_ _11"> </span>either<span class="_"> </span>normal<span class="_"> </span>operation<span class="_ _11"> </span>or<span class="_"> </span>that<span class="_"> </span>some</div><div class="t m5 x1d h26 y413 ff7 fs19 fc2 sc0 ls0 ws0">sort<span class="_ _f"> </span>of<span class="_ _f"> </span><span class="ffa">exception<span class="_ _21"> </span></span>has<span class="_ _f"> </span>occurred,<span class="_ _e"> </span>such<span class="_ _f"> </span>as<span class="_ _f"> </span>when<span class="_ _e"> </span>an<span class="_ _21"> </span>instruction<span class="_ _f"> </span>attempts<span class="_ _f"> </span>to<span class="_ _f"> </span>read</div><div class="t m5 x1d h26 y414 ff7 fs19 fc2 sc0 ls0 ws0">from<span class="_ _16"> </span>an<span class="_ _16"> </span>invalid<span class="_ _16"> </span>memory<span class="_ _16"> </span>address<span class="_ _1"></span>.<span class="_ _16"> </span>T<span class="_ _0"></span>he<span class="_ _16"> </span>possible<span class="_ _16"> </span>status<span class="_ _16"> </span>codes<span class="_ _16"> </span>and<span class="_ _16"> </span>the<span class="_ _16"> </span>handling<span class="_ _16"> </span>of</div><div class="t m5 x1d h26 y415 ff7 fs19 fc2 sc0 ls0 ws0">exceptions<span class="_"> </span>is<span class="_"> </span>described<span class="_"> </span>in<span class="_"> </span>Section<span class="_"> </span>4.1.4.</div><div class="t m5 x1d h41 y36a4 ffe fs29 fc2 sc0 ls0 ws0">4.1.2<span class="_ _48"> </span><span class="fs19">Y86-64<span class="_"> </span>Instructions</span></div><div class="t m5 x1d h26 y36a5 ff7 fs19 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_ _11"> </span>4.2<span class="_"> </span>gives<span class="_"> </span>a<span class="_"> </span>concise<span class="_ _11"> </span>description<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>individual<span class="_ _11"> </span>instructions<span class="_"> </span>in<span class="_"> </span>the<span class="_ _11"> </span>Y86-64</div><div class="t m5 x1d h26 y36a6 ff7 fs19 fc2 sc0 ls0 ws0">ISA.<span class="_ _13"> </span>W<span class="_ _3"></span>e<span class="_ _13"> </span>use<span class="_ _6"> </span>this<span class="_ _13"> </span>instruction<span class="_ _13"> </span>set<span class="_ _6"> </span>as<span class="_ _13"> </span>a<span class="_ _13"> </span>target<span class="_ _13"> </span>for<span class="_ _6"> </span>our<span class="_ _13"> </span>processor<span class="_ _13"> </span>implementations<span class="_ _3"></span>.<span class="_ _13"> </span>T<span class="_ _1"></span>he</div><div class="t m5 x1d h26 y36a7 ff7 fs19 fc2 sc0 ls0 ws0">set<span class="_ _6"> </span>of<span class="_ _6"> </span>Y86-64<span class="_ _6"> </span>instructions<span class="_ _6"> </span>is<span class="_ _6"> </span>largely<span class="_ _6"> </span>a<span class="_ _6"> </span>subset<span class="_ _13"> </span>of<span class="_ _a"> </span>the<span class="_ _6"> </span>x86-64<span class="_ _6"> </span>instruction<span class="_ _6"> </span>set.<span class="_ _6"> </span>It<span class="_ _6"> </span>includes</div><div class="t m5 x1d h26 y36a8 ff7 fs19 fc2 sc0 ls0 ws0">only<span class="_ _6"> </span>8-byte<span class="_ _13"> </span>integer<span class="_ _6"> </span>operations<span class="_ _0"></span>,<span class="_ _13"> </span>has<span class="_ _6"> </span>fewer<span class="_ _13"> </span>addressing<span class="_ _6"> </span>modes<span class="_ _1"></span>,<span class="_ _13"> </span>and<span class="_ _13"> </span>includes<span class="_ _6"> </span>a<span class="_ _13"> </span>smaller</div><div class="t m5 x1d h26 y36a9 ff7 fs19 fc2 sc0 ls0 ws0">set<span class="_"> </span>of<span class="_"> </span>operations<span class="_ _3"></span>.<span class="_"> </span>Since<span class="_"> </span>we<span class="_"> </span>only<span class="_"> </span>use<span class="_"> </span>8-byte<span class="_ _13"> </span>data,<span class="_"> </span>we<span class="_"> </span>can<span class="_"> </span>refer<span class="_"> </span>to<span class="_"> </span>these<span class="_ _13"> </span>as<span class="_"> </span>“words”</div><div class="t m5 x1d h26 y36aa ff7 fs19 fc2 sc0 ls0 ws0">without<span class="_"> </span>any<span class="_ _11"> </span>ambiguity<span class="_ _3"></span>.<span class="_ _11"> </span>In<span class="_"> </span>this<span class="_ _11"> </span>ﬁgure<span class="_ _0"></span>,<span class="_ _11"> </span>we<span class="_"> </span>show<span class="_ _11"> </span>the<span class="_ _11"> </span>assembly-code<span class="_"> </span>representation</div><div class="t m5 x1d h26 y36ab ff7 fs19 fc2 sc0 ls0 ws0">of<span class="_ _13"> </span>the<span class="_ _13"> </span>instructions<span class="_ _6"> </span>on<span class="_ _13"> </span>the<span class="_ _13"> </span>left<span class="_ _13"> </span>and<span class="_ _6"> </span>the<span class="_ _13"> </span>byte<span class="_ _13"> </span>encodings<span class="_ _13"> </span>on<span class="_ _13"> </span>the<span class="_ _6"> </span>right.<span class="_ _13"> </span>F<span class="_ _0"></span>igure<span class="_ _13"> </span>4.3<span class="_ _6"> </span>shows</div><div class="t m5 x1d h26 y36ac ff7 fs19 fc2 sc0 ls0 ws0">further<span class="_"> </span>details<span class="_ _13"> </span>of<span class="_"> </span>some<span class="_ _13"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>instructions<span class="_ _0"></span>.<span class="_"> </span>T<span class="_ _3"></span>he<span class="_"> </span>assembly-code<span class="_"> </span>format<span class="_ _13"> </span>is<span class="_"> </span>similar<span class="_ _13"> </span>to</div><div class="t m5 x1d h26 y36ad ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span>A<span class="_ _3"></span>TT<span class="_"> </span>format<span class="_"> </span>for<span class="_"> </span>x86-64.</div><div class="t m5 x29 h26 y36ae ff7 fs19 fc2 sc0 ls0 ws0">Here<span class="_"> </span>are<span class="_"> </span>some<span class="_"> </span>details<span class="_"> </span>about<span class="_"> </span>the<span class="_"> </span>Y86-64<span class="_"> </span>instructions<span class="_ _1"></span>.</div><div class="t m5 x75 h3d y36af ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x29 h26 y24b4 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _16"> </span>x86-64<span class="_ _16"> </span><span class="ffd">movq<span class="_ _16"> </span></span>instruction<span class="_ _14"> </span>is<span class="_ _16"> </span>split<span class="_ _16"> </span>into<span class="_ _16"> </span>four<span class="_ _16"> </span>different<span class="_ _16"> </span>instructions:<span class="_ _16"> </span><span class="ffd">irmovq</span>,</div><div class="t m5 x29 h26 y36b0 ffd fs19 fc1 sc0 ls0 ws0">rrmovq<span class="ff7">,<span class="_"> </span></span>mrmovq<span class="ff7">,<span class="_"> </span>and<span class="_"> </span></span>rmmovq<span class="ff7">,<span class="_"> </span>explicitly<span class="_"> </span>indicating<span class="_"> </span>the<span class="_"> </span>form<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>source<span class="_"> </span>and</span></div><div class="t m5 x29 h26 y36b1 ff7 fs19 fc1 sc0 ls0 ws0">destination.<span class="_ _11"> </span>T<span class="_ _1"></span>he<span class="_ _11"> </span>source<span class="_ _11"> </span>is<span class="_ _11"> </span>either<span class="_ _16"> </span>immediate<span class="_"> </span>(<span class="ffd">i</span>),<span class="_ _11"> </span>register<span class="_ _16"> </span>(<span class="ffd">r</span>),<span class="_"> </span>or<span class="_ _11"> </span>memory<span class="_ _16"> </span>(<span class="ffd">m</span>).</div><div class="t m5 x29 h26 y36b2 ff7 fs19 fc1 sc0 ls0 ws0">It<span class="_"> </span>is<span class="_ _13"> </span>designated<span class="_"> </span>by<span class="_ _13"> </span>the<span class="_"> </span>ﬁrst<span class="_"> </span>character<span class="_ _13"> </span>in<span class="_"> </span>the<span class="_ _13"> </span>instruction<span class="_"> </span>name<span class="_ _1"></span>.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_"> </span>destination</div><div class="t m5 x29 h26 y36b3 ff7 fs19 fc1 sc0 ls0 ws0">is<span class="_"> </span>either<span class="_ _11"> </span>register<span class="_ _11"> </span>(<span class="ffd">r</span>)<span class="_ _11"> </span>or<span class="_ _11"> </span>memory<span class="_"> </span>(<span class="ffd">m</span>).<span class="_ _11"> </span>It<span class="_ _11"> </span>is<span class="_ _11"> </span>designated<span class="_ _11"> </span>by<span class="_"> </span>the<span class="_ _11"> </span>second<span class="_ _11"> </span>character</div><div class="t m5 x29 h26 y36b4 ff7 fs19 fc1 sc0 ls0 ws0">in<span class="_"> </span>the<span class="_ _11"> </span>instruction<span class="_ _11"> </span>name.<span class="_"> </span>Explicitly<span class="_ _11"> </span>identifying<span class="_"> </span>the<span class="_ _11"> </span>four<span class="_ _11"> </span>types<span class="_ _11"> </span>of<span class="_ _11"> </span>data<span class="_ _11"> </span>transfer</div><div class="t m5 x29 h26 y36b5 ff7 fs19 fc1 sc0 ls0 ws0">will<span class="_"> </span>prove<span class="_"> </span>helpful<span class="_"> </span>when<span class="_"> </span>we<span class="_"> </span>decide<span class="_"> </span>how<span class="_"> </span>to<span class="_"> </span>implement<span class="_"> </span>them.</div><div class="t m5 xcd h26 y36b6 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _13"> </span>memory<span class="_ _13"> </span>references<span class="_ _13"> </span>for<span class="_ _13"> </span>the<span class="_ _13"> </span>two<span class="_ _13"> </span>memory<span class="_ _13"> </span>movement<span class="_ _13"> </span>instructions<span class="_ _13"> </span>have</div><div class="t m5 x29 h26 y36b7 ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_"> </span>simple<span class="_"> </span>base<span class="_"> </span>and<span class="_ _11"> </span>displacement<span class="_"> </span>format.<span class="_"> </span>W<span class="_ _1"></span>e<span class="_"> </span>do<span class="_"> </span>not<span class="_ _11"> </span>support<span class="_"> </span>the<span class="_"> </span>second<span class="_ _11"> </span>index</div><div class="t m5 x29 h26 y36b8 ff7 fs19 fc1 sc0 ls0 ws0">register<span class="_"> </span>or<span class="_"> </span>any<span class="_"> </span>scaling<span class="_"> </span>of<span class="_"> </span>a<span class="_"> </span>register’s<span class="_"> </span>value<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>address<span class="_"> </span>computation.</div><div class="t m5 xcd h26 y36b9 ff7 fs19 fc1 sc0 ls0 ws0">As<span class="_"> </span>with<span class="_ _11"> </span>x86-64,<span class="_"> </span>we<span class="_ _11"> </span>do<span class="_"> </span>not<span class="_ _11"> </span>allow<span class="_"> </span>direct<span class="_ _11"> </span>transfers<span class="_"> </span>from<span class="_ _11"> </span>one<span class="_"> </span>memory<span class="_ _11"> </span>loca-</div><div class="t m5 x29 h26 y36ba ff7 fs19 fc1 sc0 ls0 ws0">tion<span class="_"> </span>to<span class="_"> </span>another.<span class="_"> </span>In<span class="_ _11"> </span>addition,<span class="_"> </span>we<span class="_ _11"> </span>do<span class="_"> </span>not<span class="_ _11"> </span>allow<span class="_"> </span>a<span class="_ _11"> </span>transfer<span class="_"> </span>of<span class="_"> </span>immediate<span class="_ _11"> </span>data<span class="_"> </span>to</div><div class="t m5 x29 h26 y36bb ff7 fs19 fc1 sc0 ls0 ws0">memory<span class="_ _3"></span>.</div><div class="t m5 x75 h3d y36bc ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x29 h26 y13c0 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>here<span class="_ _21"> </span>are<span class="_ _15"> </span>four<span class="_ _21"> </span>integer<span class="_ _15"> </span>operation<span class="_ _21"> </span>instructions<span class="_ _1"></span>,<span class="_ _f"> </span>shown<span class="_ _15"> </span>in<span class="_ _21"> </span>F<span class="_ _0"></span>igure<span class="_ _15"> </span>4.2<span class="_ _21"> </span>as<span class="_ _15"> </span><span class="ffd">OPq</span>.</div><div class="t m5 x29 h26 y13c1 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>hese<span class="_ _14"> </span>are<span class="_ _14"> </span><span class="ffd">addq</span>,<span class="_ _14"> </span><span class="ffd">subq</span>,<span class="_ _14"> </span><span class="ffd">andq</span>,<span class="_ _15"> </span>and<span class="_ _14"> </span><span class="ffd">xorq</span>.<span class="_ _16"> </span>They<span class="_ _16"> </span>operate<span class="_ _16"> </span>only<span class="_ _14"> </span>on<span class="_ _14"> </span>register<span class="_ _16"> </span>data,</div><div class="t m5 x29 h26 y13c2 ff7 fs19 fc1 sc0 ls0 ws0">whereas<span class="_ _16"> </span>x86-64<span class="_ _14"> </span>also<span class="_ _14"> </span>allows<span class="_ _14"> </span>operations<span class="_ _14"> </span>on<span class="_ _14"> </span>memory<span class="_ _14"> </span>data.<span class="_ _16"> </span>These<span class="_ _16"> </span>instructions</div><div class="t m5 x29 h26 y13c3 ff7 fs19 fc1 sc0 ls0 ws0">set<span class="_"> </span>the<span class="_"> </span>three<span class="_"> </span>condition<span class="_"> </span>codes<span class="_"> </span><span class="ffd">ZF</span>,<span class="_"> </span><span class="ffd">SF</span>,<span class="_"> </span>and<span class="_"> </span><span class="ffd">OF<span class="_ _10"> </span></span>(zero<span class="_ _1"></span>,<span class="_"> </span>sign,<span class="_"> </span>and<span class="_"> </span>overﬂow).</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
