<div id="pf1b7" class="pf w2 h11" data-page-no="1b7"><div class="pc pc1b7 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1b7.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">438<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>4<span class="_ _3d"> </span>Processor<span class="_ _10"> </span>Architecture</span></div><div class="t m5 x1f h2d ye7 ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _45"> </span><span class="ffd fs1e fc2">0x000:<span class="_ _3f"> </span>irmovq<span class="_ _e"> </span>$0x100,%rbx<span class="_ _3f"> </span>#<span class="_ _1f"> </span>%rbx<span class="_ _1f"> </span>&lt;--<span class="_ _e"> </span>0x100</span></div><div class="t m5 x1f h2d yc4d ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _45"> </span><span class="ffd fs1e fc2">0x00a:<span class="_ _3f"> </span>irmovq<span class="_ _e"> </span>$0x200,%rdx<span class="_ _3f"> </span>#<span class="_ _1f"> </span>%rdx<span class="_ _1f"> </span>&lt;--<span class="_ _e"> </span>0x200</span></div><div class="t m5 x1f h2d yecb ff6 fs20 fc6 sc0 ls0 ws0">3<span class="_ _45"> </span><span class="ffd fs1e fc2">0x014:<span class="_ _3f"> </span>addq<span class="_ _e"> </span>%rdx,%rbx<span class="_ _2b"> </span>#<span class="_ _e"> </span>%rbx<span class="_ _1f"> </span>&lt;--<span class="_ _1f"> </span>0x300<span class="_ _e"> </span>CC<span class="_ _1f"> </span>&lt;--<span class="_ _e"> </span>000</span></div><div class="t m5 x1f h2d yecc ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _45"> </span><span class="ffd fs1e fc2">0x016:<span class="_ _3f"> </span>je<span class="_ _e"> </span>dest<span class="_ _16f"> </span>#<span class="_ _e"> </span>Not<span class="_ _1f"> </span>taken</span></div><div class="t m5 x1f h2d yecd ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _45"> </span><span class="ffd fs1e fc2">0x01f:<span class="_ _3f"> </span>rmmovq<span class="_ _e"> </span>%rbx,0(%rdx)<span class="_ _1a"> </span>#<span class="_ _1f"> </span>M[0x200]<span class="_ _1f"> </span>&lt;--<span class="_ _e"> </span>0x300</span></div><div class="t m5 x1f h2d yece ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _45"> </span><span class="ffd fs1e fc2">0x029:<span class="_ _e"> </span>dest:<span class="_ _1f"> </span>halt</span></div><div class="t m5 x29 h26 y20fe ff7 fs19 fc2 sc0 ls0 ws0">Each<span class="_"> </span>of<span class="_"> </span>the<span class="_ _11"> </span>diagrams<span class="_"> </span>labeled<span class="_"> </span>1<span class="_ _11"> </span>through<span class="_"> </span>4<span class="_ _11"> </span>shows<span class="_"> </span>the<span class="_"> </span>four<span class="_ _11"> </span>state<span class="_"> </span>elements<span class="_"> </span>plus</div><div class="t m5 x1d h26 y3c5c ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span>combinational<span class="_"> </span>logic<span class="_"> </span>and<span class="_ _11"> </span>the<span class="_"> </span>connections<span class="_"> </span>among<span class="_ _11"> </span>the<span class="_"> </span>state<span class="_"> </span>elements<span class="_ _1"></span>.<span class="_ _11"> </span>W<span class="_ _3"></span>e<span class="_"> </span>show</div><div class="t m5 x1d h26 y3c5d ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _15"> </span>combinational<span class="_ _21"> </span>logic<span class="_ _15"> </span>as<span class="_ _21"> </span>being<span class="_ _15"> </span>wrapped<span class="_ _21"> </span>around<span class="_ _21"> </span>the<span class="_ _15"> </span>condition<span class="_ _21"> </span>code<span class="_ _15"> </span>register,</div><div class="t m5 x1d h26 y3c5e ff7 fs19 fc2 sc0 ls0 ws0">because<span class="_ _11"> </span>some<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>combinational<span class="_ _11"> </span>logic<span class="_ _11"> </span>(such<span class="_ _11"> </span>as<span class="_ _11"> </span>the<span class="_ _11"> </span>ALU)<span class="_ _16"> </span>generates<span class="_"> </span>the<span class="_ _11"> </span>input</div><div class="t m5 x1d h26 y3c5f ff7 fs19 fc2 sc0 ls0 ws0">to<span class="_"> </span>the<span class="_"> </span>condition<span class="_ _13"> </span>code<span class="_"> </span>register,<span class="_"> </span>while<span class="_"> </span>other<span class="_ _13"> </span>parts<span class="_"> </span>(such<span class="_"> </span>as<span class="_"> </span>the<span class="_"> </span>branch<span class="_"> </span>computation</div><div class="t m5 x1d h26 y3c60 ff7 fs19 fc2 sc0 ls0 ws0">and<span class="_ _13"> </span>the<span class="_ _13"> </span>PC<span class="_ _13"> </span>selection<span class="_ _13"> </span>logic)<span class="_ _13"> </span>have<span class="_ _13"> </span>the<span class="_ _13"> </span>condition<span class="_ _13"> </span>code<span class="_"> </span>register<span class="_ _13"> </span>as<span class="_ _13"> </span>input.<span class="_ _13"> </span>W<span class="_ _3"></span>e<span class="_ _13"> </span>show<span class="_ _13"> </span>the</div><div class="t m5 x1d h26 y3c61 ff7 fs19 fc2 sc0 ls0 ws0">register<span class="_"> </span>ﬁle<span class="_"> </span>and<span class="_"> </span>the<span class="_ _13"> </span>data<span class="_"> </span>memory<span class="_"> </span>as<span class="_"> </span>having<span class="_"> </span>separate<span class="_"> </span>connections<span class="_ _13"> </span>for<span class="_"> </span>reading<span class="_"> </span>and</div><div class="t m5 x1d h26 y3c62 ff7 fs19 fc2 sc0 ls0 ws0">writing,<span class="_ _11"> </span>since<span class="_ _16"> </span>the<span class="_ _16"> </span>read<span class="_ _16"> </span>operations<span class="_ _11"> </span>propagate<span class="_ _16"> </span>through<span class="_ _16"> </span>these<span class="_ _16"> </span>units<span class="_ _11"> </span>as<span class="_ _16"> </span>if<span class="_ _16"> </span>they<span class="_ _16"> </span>were</div><div class="t m5 x1d h26 y3c63 ff7 fs19 fc2 sc0 ls0 ws0">combinational<span class="_"> </span>logic,<span class="_"> </span>while<span class="_"> </span>the<span class="_"> </span>write<span class="_"> </span>operations<span class="_"> </span>are<span class="_"> </span>controlled<span class="_"> </span>by<span class="_"> </span>the<span class="_"> </span>clock.</div><div class="t m5 x29 h26 y3c64 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _11"> </span>color<span class="_"> </span>coding<span class="_"> </span>in<span class="_ _11"> </span>F<span class="_ _0"></span>igure<span class="_"> </span>4.25<span class="_"> </span>indicates<span class="_ _11"> </span>how<span class="_"> </span>the<span class="_"> </span>circuit<span class="_ _11"> </span>signals<span class="_"> </span>relate<span class="_"> </span>to<span class="_ _11"> </span>the</div><div class="t m5 x1d h26 y3c65 ff7 fs19 fc2 sc0 ls0 ws0">different<span class="_ _16"> </span>instructions<span class="_ _14"> </span>being<span class="_ _16"> </span>executed.<span class="_ _14"> </span>W<span class="_ _3"></span>e<span class="_ _16"> </span>assume<span class="_ _14"> </span>the<span class="_ _16"> </span>processing<span class="_ _14"> </span>starts<span class="_ _16"> </span>with<span class="_ _14"> </span>the</div><div class="t m5 x1d h26 y3c66 ff7 fs19 fc2 sc0 ls0 ws0">condition<span class="_"> </span>codes<span class="_ _1"></span>,<span class="_"> </span>listed<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>order<span class="_ _13"> </span><span class="ffd">ZF</span>,<span class="_"> </span><span class="ffd">SF</span>,<span class="_"> </span>and<span class="_"> </span><span class="ffd">OF</span>,<span class="_"> </span>set<span class="_"> </span>to<span class="_"> </span><span class="ffd">100</span>.<span class="_"> </span>At<span class="_"> </span>the<span class="_"> </span>beginning<span class="_"> </span>of</div><div class="t m5 x1d h26 y3c67 ff7 fs19 fc2 sc0 ls0 ws0">clock<span class="_"> </span>c<span class="_ _1"></span>ycle<span class="_"> </span>3<span class="_"> </span>(point<span class="_ _13"> </span>1),<span class="_"> </span>the<span class="_ _13"> </span>state<span class="_"> </span>elements<span class="_"> </span>hold<span class="_ _13"> </span>the<span class="_"> </span>state<span class="_ _13"> </span>as<span class="_"> </span>updated<span class="_"> </span>by<span class="_ _13"> </span>the<span class="_"> </span>second</div><div class="t m5 x1d h26 y3c68 ffd fs19 fc2 sc0 ls0 ws0">irmovq<span class="_ _11"> </span><span class="ff7">instruction<span class="_ _11"> </span>(line<span class="_ _16"> </span>2<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>listing),<span class="_ _16"> </span>shown<span class="_ _11"> </span>in<span class="_ _11"> </span>light<span class="_ _16"> </span>gray<span class="_ _7"></span>.<span class="_ _16"> </span>T<span class="_ _1"></span>he<span class="_ _11"> </span>combinational</span></div><div class="t m5 x1d h26 y3c69 ff7 fs19 fc2 sc0 ls0 ws0">logic<span class="_ _15"> </span>is<span class="_ _15"> </span>shown<span class="_ _15"> </span>in<span class="_ _21"> </span>white<span class="_ _0"></span>,<span class="_ _21"> </span>indicating<span class="_ _15"> </span>that<span class="_ _21"> </span>it<span class="_ _15"> </span>has<span class="_ _15"> </span>not<span class="_ _15"> </span>yet<span class="_ _21"> </span>had<span class="_ _15"> </span>time<span class="_ _15"> </span>to<span class="_ _21"> </span>react<span class="_ _15"> </span>to<span class="_ _15"> </span>the</div><div class="t m5 x1d h26 y3c6a ff7 fs19 fc2 sc0 ls0 ws0">changed<span class="_ _13"> </span>state<span class="_ _0"></span>.<span class="_ _13"> </span>T<span class="_ _1"></span>he<span class="_"> </span>clock<span class="_ _13"> </span>c<span class="_ _1"></span>ycle<span class="_"> </span>begins<span class="_ _13"> </span>with<span class="_ _13"> </span>address<span class="_ _13"> </span><span class="ffd">0x014<span class="_ _13"> </span></span>loaded<span class="_ _13"> </span>into<span class="_ _13"> </span>the<span class="_ _13"> </span>program</div><div class="t m5 x1d h26 y3c6b ff7 fs19 fc2 sc0 ls0 ws0">counter.<span class="_"> </span>T<span class="_ _1"></span>his<span class="_ _11"> </span>causes<span class="_ _11"> </span>the<span class="_ _11"> </span><span class="ffd">addq<span class="_ _11"> </span></span>instruction<span class="_ _11"> </span>(line<span class="_"> </span>3<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>listing),<span class="_ _11"> </span>shown<span class="_ _11"> </span>in<span class="_ _11"> </span>blue<span class="_ _1"></span>,<span class="_ _11"> </span>to</div><div class="t m5 x1d h26 y3c6c ff7 fs19 fc2 sc0 ls0 ws0">be<span class="_"> </span>fetched<span class="_ _13"> </span>and<span class="_"> </span>processed.<span class="_ _13"> </span>V<span class="_ _3"></span>alues<span class="_"> </span>ﬂow<span class="_ _13"> </span>through<span class="_"> </span>the<span class="_ _13"> </span>combinational<span class="_"> </span>logic,<span class="_ _13"> </span>including</div><div class="t m5 x1d h26 y3c6d ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _14"> </span>reading<span class="_ _14"> </span>of<span class="_ _14"> </span>the<span class="_ _14"> </span>random<span class="_ _14"> </span>access<span class="_ _14"> </span>memories<span class="_ _1"></span>.<span class="_ _14"> </span>By<span class="_ _15"> </span>the<span class="_ _14"> </span>end<span class="_ _14"> </span>of<span class="_ _14"> </span>the<span class="_ _14"> </span>cycle<span class="_ _16"> </span>(point<span class="_ _15"> </span>2),</div><div class="t m5 x1d h26 y3c6e ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _11"> </span>combinational<span class="_ _11"> </span>logic<span class="_ _11"> </span>has<span class="_ _11"> </span>generated<span class="_ _11"> </span>new<span class="_ _11"> </span>values<span class="_ _16"> </span>(<span class="ffd">000</span>)<span class="_"> </span>for<span class="_ _11"> </span>the<span class="_ _11"> </span>condition<span class="_ _16"> </span>codes<span class="_ _3"></span>,</div><div class="t m5 x1d h26 y3c6f ff7 fs19 fc2 sc0 ls0 ws0">an<span class="_ _16"> </span>update<span class="_ _16"> </span>for<span class="_ _16"> </span>program<span class="_ _16"> </span>register<span class="_ _16"> </span><span class="ffd">%rbx</span>,<span class="_ _16"> </span>and<span class="_ _16"> </span>a<span class="_ _16"> </span>new<span class="_ _16"> </span>value<span class="_ _16"> </span>(<span class="ffd">0x016</span>)<span class="_ _16"> </span>for<span class="_ _16"> </span>the<span class="_ _16"> </span>program</div><div class="t m5 x1d h26 y3c70 ff7 fs19 fc2 sc0 ls0 ws0">counter.<span class="_ _13"> </span>At<span class="_"> </span>this<span class="_ _13"> </span>point,<span class="_"> </span>the<span class="_ _13"> </span>combinational<span class="_"> </span>logic<span class="_ _13"> </span>has<span class="_"> </span>been<span class="_ _13"> </span>updated<span class="_"> </span>according<span class="_ _13"> </span>to<span class="_"> </span>the</div><div class="t m5 x1d h26 y3c71 ffd fs19 fc2 sc0 ls0 ws0">addq<span class="_ _14"> </span><span class="ff7">instruction<span class="_ _14"> </span>(shown<span class="_ _14"> </span>in<span class="_ _14"> </span>blue),<span class="_ _21"> </span>but<span class="_ _14"> </span>the<span class="_ _14"> </span>state<span class="_ _14"> </span>still<span class="_ _14"> </span>holds<span class="_ _15"> </span>the<span class="_ _14"> </span>values<span class="_ _14"> </span>set<span class="_ _14"> </span>by<span class="_ _14"> </span>the</span></div><div class="t m5 x1d h26 y3c72 ff7 fs19 fc2 sc0 ls0 ws0">second<span class="_"> </span><span class="ffd">irmovq<span class="_ _10"> </span></span>instruction<span class="_"> </span>(shown<span class="_"> </span>in<span class="_"> </span>light<span class="_"> </span>gray).</div><div class="t m5 x29 h26 y3c73 ff7 fs19 fc2 sc0 ls0 ws0">As<span class="_ _21"> </span>the<span class="_ _21"> </span>clock<span class="_ _21"> </span>rises<span class="_ _21"> </span>to<span class="_ _21"> </span>begin<span class="_ _21"> </span>cycle<span class="_ _15"> </span>4<span class="_ _21"> </span>(point<span class="_ _21"> </span>3),<span class="_ _e"> </span>the<span class="_ _15"> </span>updates<span class="_ _21"> </span>to<span class="_ _21"> </span>the<span class="_ _21"> </span>program</div><div class="t m5 x1d h26 y3c74 ff7 fs19 fc2 sc0 ls0 ws0">counter,<span class="_ _11"> </span>the<span class="_ _16"> </span>register<span class="_ _16"> </span>ﬁle<span class="_ _1"></span>,<span class="_ _16"> </span>and<span class="_ _16"> </span>the<span class="_ _11"> </span>condition<span class="_ _16"> </span>code<span class="_ _16"> </span>register<span class="_ _11"> </span>occur,<span class="_ _16"> </span>and<span class="_ _11"> </span>so<span class="_ _16"> </span>we<span class="_ _16"> </span>show</div><div class="t m5 x1d h26 y3c75 ff7 fs19 fc2 sc0 ls0 ws0">these<span class="_ _13"> </span>in<span class="_ _6"> </span>blue,<span class="_ _13"> </span>but<span class="_ _6"> </span>the<span class="_ _13"> </span>combinational<span class="_ _13"> </span>logic<span class="_ _6"> </span>has<span class="_ _13"> </span>not<span class="_ _13"> </span>yet<span class="_ _6"> </span>reacted<span class="_ _13"> </span>to<span class="_ _13"> </span>these<span class="_ _6"> </span>changes<span class="_ _1"></span>,<span class="_ _13"> </span>and</div><div class="t m5 x1d h26 y3c76 ff7 fs19 fc2 sc0 ls0 ws0">so<span class="_ _6"> </span>we<span class="_ _6"> </span>show<span class="_ _6"> </span>this<span class="_ _6"> </span>in<span class="_ _13"> </span>white<span class="_ _1"></span>.<span class="_ _6"> </span>In<span class="_ _6"> </span>this<span class="_ _6"> </span>cycle<span class="_ _1"></span>,<span class="_ _13"> </span>the<span class="_ _6"> </span><span class="ffd">je<span class="_ _6"> </span></span>instruction<span class="_ _6"> </span>(line<span class="_ _6"> </span>4<span class="_ _6"> </span>in<span class="_ _13"> </span>the<span class="_ _a"> </span>listing),<span class="_ _13"> </span>shown</div><div class="t m5 x1d h26 y3c77 ff7 fs19 fc2 sc0 ls0 ws0">in<span class="_ _6"> </span>dark<span class="_ _13"> </span>gray<span class="_ _7"></span>,<span class="_ _13"> </span>is<span class="_ _13"> </span>fetched<span class="_ _6"> </span>and<span class="_ _13"> </span>executed.<span class="_ _6"> </span>Since<span class="_ _13"> </span>condition<span class="_ _6"> </span>code<span class="_ _6"> </span><span class="ffd">ZF<span class="_ _13"> </span></span>is<span class="_ _6"> </span>0,<span class="_ _13"> </span>the<span class="_ _13"> </span>branch<span class="_ _6"> </span>is<span class="_ _13"> </span>not</div><div class="t m5 x1d h26 y3c78 ff7 fs19 fc2 sc0 ls0 ws0">taken.<span class="_"> </span>By<span class="_ _13"> </span>the<span class="_"> </span>end<span class="_ _13"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>cycle<span class="_ _13"> </span>(point<span class="_"> </span>4),<span class="_"> </span>a<span class="_ _13"> </span>new<span class="_"> </span>value<span class="_ _13"> </span>of<span class="_"> </span><span class="ffd">0x01f<span class="_ _13"> </span></span>has<span class="_"> </span>been<span class="_ _13"> </span>generated</div><div class="t m5 x1d h26 y3c79 ff7 fs19 fc2 sc0 ls0 ws0">for<span class="_"> </span>the<span class="_"> </span>program<span class="_ _13"> </span>counter.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_"> </span>combinational<span class="_"> </span>logic<span class="_"> </span>has<span class="_"> </span>been<span class="_ _13"> </span>updated<span class="_"> </span>according<span class="_"> </span>to</div><div class="t m5 x1d h26 y3c7a ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span><span class="ffd">je<span class="_ _11"> </span></span>instruction<span class="_"> </span>(shown<span class="_ _11"> </span>in<span class="_ _11"> </span>dark<span class="_"> </span>gray),<span class="_ _11"> </span>but<span class="_ _11"> </span>the<span class="_"> </span>state<span class="_ _11"> </span>still<span class="_"> </span>holds<span class="_ _11"> </span>the<span class="_ _11"> </span>values<span class="_"> </span>set<span class="_ _11"> </span>by</div><div class="t m5 x1d h26 y3c7b ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span><span class="ffd">addq<span class="_ _10"> </span></span>instruction<span class="_"> </span>(shown<span class="_"> </span>in<span class="_"> </span>blue)<span class="_"> </span>until<span class="_"> </span>the<span class="_"> </span>next<span class="_"> </span>cycle<span class="_"> </span>begins<span class="_ _3"></span>.</div><div class="t m5 x29 h26 y3c7c ff7 fs19 fc2 sc0 ls0 ws0">As<span class="_ _11"> </span>this<span class="_ _16"> </span>example<span class="_ _11"> </span>illustrates<span class="_ _1"></span>,<span class="_ _16"> </span>the<span class="_ _11"> </span>use<span class="_ _16"> </span>of<span class="_ _11"> </span>a<span class="_ _16"> </span>clock<span class="_ _11"> </span>to<span class="_ _16"> </span>control<span class="_ _11"> </span>the<span class="_ _16"> </span>updating<span class="_ _11"> </span>of<span class="_ _16"> </span>the</div><div class="t m5 x1d h26 y3c7d ff7 fs19 fc2 sc0 ls0 ws0">state<span class="_ _11"> </span>elements<span class="_ _1"></span>,<span class="_ _11"> </span>combined<span class="_ _16"> </span>with<span class="_"> </span>the<span class="_ _16"> </span>propagation<span class="_"> </span>of<span class="_ _11"> </span>values<span class="_ _16"> </span>through<span class="_"> </span>combinational</div><div class="t m5 x1d h26 y3c7e ff7 fs19 fc2 sc0 ls0 ws0">logic,<span class="_ _11"> </span>sufﬁces<span class="_ _11"> </span>to<span class="_ _11"> </span>control<span class="_ _16"> </span>the<span class="_ _11"> </span>computations<span class="_ _11"> </span>performed<span class="_ _16"> </span>for<span class="_ _11"> </span>each<span class="_ _11"> </span>instruction<span class="_ _11"> </span>in<span class="_ _16"> </span>our</div><div class="t m5 x1d h26 y3c7f ff7 fs19 fc2 sc0 ls0 ws0">implementation<span class="_ _16"> </span>of<span class="_ _16"> </span>SEQ.<span class="_ _16"> </span>Every<span class="_ _16"> </span>time<span class="_ _16"> </span>the<span class="_ _16"> </span>clock<span class="_ _16"> </span>transitions<span class="_ _16"> </span>from<span class="_ _16"> </span>low<span class="_ _16"> </span>to<span class="_ _16"> </span>high,<span class="_ _16"> </span>the</div><div class="t m5 x1d h26 y3c80 ff7 fs19 fc2 sc0 ls0 ws0">processor<span class="_"> </span>begins<span class="_"> </span>executing<span class="_"> </span>a<span class="_"> </span>new<span class="_"> </span>instruction.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
