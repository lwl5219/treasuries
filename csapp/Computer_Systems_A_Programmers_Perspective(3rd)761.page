<div id="pf2f9" class="pf w2 h11" data-page-no="2f9"><div class="pc pc2f9 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg2f9.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">760<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>8<span class="_ _3d"> </span>Exceptional<span class="_ _10"> </span>Control<span class="_ _10"> </span>Flow</span></div><div class="t m5 x28 h2a y257 fff fs1c fc2 sc0 ls0 ws0">Aside<span class="_ _1b"> </span><span class="ff6 fs19">Hardware<span class="_ _11"> </span>versus<span class="_ _11"> </span>software<span class="_ _11"> </span>exceptions</span></div><div class="t m5 x28 h2b y2d0 ff7 fs1e fc2 sc0 ls0 ws0">C++<span class="_ _11"> </span>and<span class="_ _16"> </span>J<span class="_ _3"></span>ava<span class="_ _16"> </span>programmers<span class="_ _16"> </span>will<span class="_ _11"> </span>have<span class="_ _16"> </span>noticed<span class="_ _11"> </span>that<span class="_ _16"> </span>the<span class="_ _16"> </span>term<span class="_ _11"> </span>“exception”<span class="_ _16"> </span>is<span class="_ _11"> </span>also<span class="_ _16"> </span>used<span class="_ _16"> </span>to<span class="_ _11"> </span>describe<span class="_ _16"> </span>the</div><div class="t m5 x28 h2b y2d1 ff7 fs1e fc2 sc0 ls0 ws0">application-level<span class="_ _16"> </span>ECF<span class="_ _16"> </span>mechanism<span class="_ _16"> </span>provided<span class="_ _16"> </span>by<span class="_ _14"> </span>C++<span class="_ _16"> </span>and<span class="_ _16"> </span>J<span class="_ _1"></span>ava<span class="_ _16"> </span>in<span class="_ _16"> </span>the<span class="_ _16"> </span>form<span class="_ _16"> </span>of<span class="_ _14"> </span><span class="ffd">catch</span>,<span class="_ _14"> </span><span class="ffd">throw</span>,<span class="_ _16"> </span>and<span class="_ _14"> </span><span class="ffd">try</span></div><div class="t m5 x28 h2b y2d2 ff7 fs1e fc2 sc0 ls0 ws0">statements<span class="_ _1"></span>.<span class="_ _6"> </span>If<span class="_ _6"> </span>we<span class="_ _a"> </span>wanted<span class="_ _6"> </span>to<span class="_ _6"> </span>be<span class="_ _6"> </span>perfectly<span class="_ _6"> </span>clear,<span class="_ _6"> </span>we<span class="_ _6"> </span>might<span class="_ _6"> </span>distinguish<span class="_ _a"> </span>between<span class="_ _6"> </span>“hardware”<span class="_ _6"> </span>and<span class="_ _6"> </span>“software”</div><div class="t m5 x28 h2b y2d3 ff7 fs1e fc2 sc0 ls0 ws0">exceptions<span class="_ _1"></span>,<span class="_"> </span>but<span class="_"> </span>this<span class="_"> </span>is<span class="_"> </span>usually<span class="_"> </span>unnecessary<span class="_"> </span>because<span class="_"> </span>the<span class="_"> </span>meaning<span class="_"> </span>is<span class="_"> </span>clear<span class="_"> </span>from<span class="_"> </span>the<span class="_"> </span>context.</div><div class="t m5 x14 h2f y63b7 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>8.1</div><div class="t m5 x14 h2f y63b8 ffe fs16 fc1 sc0 ls0 ws0">Anatomy<span class="_ _13"> </span>of<span class="_"> </span>an<span class="_ _13"> </span>exception.</div><div class="t m5 x14 h34 y63b9 ff6 fs16 fc1 sc0 ls0 ws0">A<span class="_ _10"> </span>change<span class="_ _10"> </span>in<span class="_ _13"> </span>the<span class="_ _10"> </span>processor’<span class="_ _1"></span>s</div><div class="t m5 x14 h34 y63ba ff6 fs16 fc1 sc0 ls0 ws0">state<span class="_ _16"> </span>(an<span class="_ _16"> </span>event)<span class="_ _16"> </span>triggers</div><div class="t m5 x14 h34 y63bb ff6 fs16 fc1 sc0 ls0 ws0">an<span class="_ _11"> </span>abrupt<span class="_ _11"> </span>control<span class="_ _11"> </span>transfer</div><div class="t m5 x14 h34 y63bc ff6 fs16 fc1 sc0 ls0 ws0">(an<span class="_ _16"> </span>exception)<span class="_ _16"> </span>from<span class="_ _16"> </span>the</div><div class="t m5 x14 h34 y63bd ff6 fs16 fc1 sc0 ls0 ws0">application<span class="_ _11"> </span>program<span class="_ _10"> </span>to<span class="_ _11"> </span>an</div><div class="t m5 x14 h34 y63be ff6 fs16 fc1 sc0 ls0 ws0">exception<span class="_ _16"> </span>handler<span class="_ _3"></span>.<span class="_ _16"> </span>After</div><div class="t m5 x14 h34 y63bf ff6 fs16 fc1 sc0 ls0 ws0">it<span class="_ _11"> </span>ﬁnishes<span class="_ _16"> </span>processing,<span class="_ _11"> </span>the</div><div class="t m5 x14 h34 y63c0 ff6 fs16 fc1 sc0 ls0 ws0">handler<span class="_ _14"> </span>either<span class="_ _14"> </span>returns</div><div class="t m5 x14 h34 y63c1 ff6 fs16 fc1 sc0 ls0 ws0">control<span class="_ _11"> </span>to<span class="_ _11"> </span>the<span class="_ _11"> </span>interrupted</div><div class="t m5 x14 h34 y63c2 ff6 fs16 fc1 sc0 ls0 ws0">program<span class="_ _10"> </span>or<span class="_ _11"> </span>aborts.</div><div class="t m5 x206 h3f y63c3 ff80 fs27 fc1 sc0 ls0 ws0">Application</div><div class="t m5 x16d h3f y63c4 ff80 fs27 fc1 sc0 ls0 ws0">program</div><div class="t m5 x107 h3f y63c3 ff80 fs27 fc1 sc0 ls0 ws0">Exception</div><div class="t m5 x100 h3f y63c4 ff80 fs27 fc1 sc0 ls0 ws0">handler</div><div class="t m5 xd8 h3f y63c5 ff80 fs27 fc1 sc0 ls0 ws0">Exception</div><div class="t m5 x1bd h3f y63c6 ff80 fs27 fc1 sc0 ls0 ws0">Exception</div><div class="t m5 x1bd h3f y63c7 ff80 fs27 fc1 sc0 ls0 ws0">processin</div><div class="c xe0 y63c8 w26 hf8"><div class="t m5 x1f2 h3f y63c9 ff80 fs27 fc1 sc0 ls0 ws0">g</div></div><div class="t m5 xd8 h3f y63ca ff80 fs27 fc1 sc0 ls0 ws0">Exception</div><div class="t m5 x120 h3f y63cb ff80 fs27 fc1 sc0 ls0 ws0">return</div><div class="t m5 x1db h3f y63cc ff80 fs27 fc1 sc0 ls0 ws0">(optional)</div><div class="t m5 xcc h3f y63cd ff8e fs27 fc1 sc0 ls0 ws0">Event</div><div class="t m5 xe0 h3f y63ce ff8e fs27 fc1 sc0 ls0 ws0">occurs</div><div class="t m5 x15e h3f y63cf ff8e fs27 fc1 sc0 ls0 ws0">here</div><div class="t m5 x16d h3f y63d0 ff80 fs27 fc1 sc0 ls0 ws0">I</div><div class="t m5 x49 h65 y63d1 ff8e fs38 fc1 sc0 ls0 ws0">curr</div><div class="t m5 x1ed h3f y63d2 ff80 fs27 fc1 sc0 ls0 ws0">I</div><div class="t m5 xa8 h65 y63d3 ff8e fs38 fc1 sc0 ls0 ws0">next</div><div class="t m5 x1d h26 y63d4 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _14"> </span>event<span class="_ _16"> </span>might<span class="_ _14"> </span>be<span class="_ _16"> </span>directly<span class="_ _14"> </span>related<span class="_ _16"> </span>to<span class="_ _14"> </span>the<span class="_ _14"> </span>execution<span class="_ _16"> </span>of<span class="_ _14"> </span>the<span class="_ _16"> </span>current<span class="_ _14"> </span>instruction.</div><div class="t m5 x1d h26 y63d5 ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>or<span class="_ _11"> </span>example,<span class="_ _11"> </span>a<span class="_ _11"> </span>virtual<span class="_ _11"> </span>memory<span class="_ _16"> </span>page<span class="_ _11"> </span>fault<span class="_ _11"> </span>occurs<span class="_ _1"></span>,<span class="_ _16"> </span>an<span class="_ _11"> </span>arithmetic<span class="_ _16"> </span>overﬂow<span class="_ _11"> </span>occurs<span class="_ _1"></span>,</div><div class="t m5 x1d h26 y63d6 ff7 fs19 fc1 sc0 ls0 ws0">or<span class="_ _13"> </span>an<span class="_ _13"> </span>instruction<span class="_"> </span>attempts<span class="_ _13"> </span>a<span class="_ _13"> </span>divide<span class="_ _13"> </span>by<span class="_"> </span>zero<span class="_ _3"></span>.<span class="_"> </span>On<span class="_ _13"> </span>the<span class="_ _13"> </span>other<span class="_ _13"> </span>hand,<span class="_"> </span>the<span class="_ _13"> </span>event<span class="_ _13"> </span>might<span class="_ _13"> </span>be</div><div class="t m5 x1d h26 y63d7 ff7 fs19 fc1 sc0 ls0 ws0">unrelated<span class="_ _13"> </span>to<span class="_"> </span>the<span class="_ _13"> </span>execution<span class="_ _13"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>current<span class="_ _13"> </span>instruction.<span class="_"> </span>F<span class="_ _3"></span>or<span class="_"> </span>example<span class="_ _1"></span>,<span class="_"> </span>a<span class="_ _13"> </span>system<span class="_ _13"> </span>timer</div><div class="t m5 x1d h26 y63d8 ff7 fs19 fc1 sc0 ls0 ws0">goes<span class="_"> </span>off<span class="_"> </span>or<span class="_"> </span>an<span class="_"> </span>I/O<span class="_"> </span>request<span class="_"> </span>completes<span class="_ _1"></span>.</div><div class="t m5 x29 h26 y63d9 ff7 fs19 fc1 sc0 ls0 ws0">In<span class="_"> </span>any<span class="_ _13"> </span>case,<span class="_"> </span>when<span class="_ _13"> </span>the<span class="_"> </span>processor<span class="_"> </span>detects<span class="_"> </span>that<span class="_ _13"> </span>the<span class="_"> </span>event<span class="_"> </span>has<span class="_ _13"> </span>occurred,<span class="_"> </span>it<span class="_"> </span>makes</div><div class="t m5 x1d h26 y63da ff7 fs19 fc1 sc0 ls0 ws0">an<span class="_ _6"> </span>indirect<span class="_ _6"> </span>procedure<span class="_ _6"> </span>call<span class="_ _a"> </span>(the<span class="_ _6"> </span>exception),<span class="_ _13"> </span>through<span class="_ _a"> </span>a<span class="_ _6"> </span>jump<span class="_ _6"> </span>table<span class="_ _6"> </span>called<span class="_ _6"> </span>an<span class="_ _6"> </span><span class="ffa">exception</span></div><div class="t m5 x1d h26 y63db ffa fs19 fc1 sc0 ls0 ws0">table<span class="ff7">,<span class="_ _13"> </span>to<span class="_ _13"> </span>an<span class="_ _13"> </span>operating<span class="_ _13"> </span>system<span class="_ _6"> </span>subroutine<span class="_ _13"> </span>(the<span class="_ _13"> </span></span>exception<span class="_ _13"> </span>handler<span class="_ _2"></span><span class="ff7">)<span class="_ _13"> </span>that<span class="_ _6"> </span>is<span class="_ _13"> </span>speciﬁcally</span></div><div class="t m5 x1d h26 y63dc ff7 fs19 fc1 sc0 ls0 ws0">designed<span class="_ _14"> </span>to<span class="_ _15"> </span>process<span class="_ _15"> </span>this<span class="_ _15"> </span>particular<span class="_ _15"> </span>kind<span class="_ _15"> </span>of<span class="_ _14"> </span>event.<span class="_ _15"> </span>When<span class="_ _14"> </span>the<span class="_ _15"> </span>exception<span class="_ _15"> </span>handler</div><div class="t m5 x1d h26 y63dd ff7 fs19 fc1 sc0 ls0 ws0">ﬁnishes<span class="_ _11"> </span>processing,<span class="_"> </span>one<span class="_ _11"> </span>of<span class="_ _16"> </span>three<span class="_"> </span>things<span class="_ _11"> </span>happens<span class="_ _1"></span>,<span class="_ _16"> </span>depending<span class="_"> </span>on<span class="_ _11"> </span>the<span class="_ _16"> </span>type<span class="_"> </span>of<span class="_ _11"> </span>event</div><div class="t m5 x1d h26 y63de ff7 fs19 fc1 sc0 ls0 ws0">that<span class="_"> </span>caused<span class="_"> </span>the<span class="_"> </span>exception:</div><div class="t m5 xc5 h26 y63df ffc fs19 fc1 sc0 ls0 ws0">1.<span class="_ _e"> </span><span class="ff7">The<span class="_ _16"> </span>handler<span class="_ _15"> </span>returns<span class="_ _14"> </span>control<span class="_ _14"> </span>to<span class="_ _15"> </span>the<span class="_ _14"> </span>current<span class="_ _14"> </span>instruction<span class="_ _14"> </span><span class="ff11">I</span></span></div><div class="t m5 x1f0 h3c y63e0 ff7 fs25 fc1 sc0 ls0 ws0">curr</div><div class="t m5 x1c0 h26 y63e1 ff7 fs19 fc1 sc0 ls0 ws0">,<span class="_ _15"> </span>the<span class="_ _14"> </span>instruction</div><div class="t m5 x29 h26 y63e2 ff7 fs19 fc1 sc0 ls0 ws0">that<span class="_"> </span>was<span class="_"> </span>executing<span class="_"> </span>when<span class="_"> </span>the<span class="_"> </span>event<span class="_"> </span>occurred.</div><div class="t m5 xc5 h26 y63e3 ffc fs19 fc1 sc0 ls0 ws0">2.<span class="_ _e"> </span><span class="ff7">The<span class="_ _13"> </span>handler<span class="_ _13"> </span>returns<span class="_"> </span>control<span class="_ _13"> </span>to<span class="_ _13"> </span><span class="ff11">I</span></span></div><div class="t m5 x130 h3c y63e4 ff7 fs25 fc1 sc0 ls0 ws0">next</div><div class="t m5 x17a h26 y63e5 ff7 fs19 fc1 sc0 ls0 ws0">,<span class="_ _13"> </span>the<span class="_"> </span>instruction<span class="_ _13"> </span>that<span class="_ _13"> </span>would<span class="_"> </span>have<span class="_ _13"> </span>executed</div><div class="t m5 x29 h26 y63e6 ff7 fs19 fc1 sc0 ls0 ws0">next<span class="_"> </span>had<span class="_"> </span>the<span class="_"> </span>exception<span class="_"> </span>not<span class="_"> </span>occurred.</div><div class="t m5 xc5 h26 y63e7 ffc fs19 fc1 sc0 ls0 ws0">3.<span class="_ _e"> </span><span class="ff7">The<span class="_"> </span>handler<span class="_"> </span>aborts<span class="_"> </span>the<span class="_"> </span>interrupted<span class="_"> </span>program.</span></div><div class="t m5 x1d h26 y63e8 ff7 fs19 fc1 sc0 ls0 ws0">Section<span class="_"> </span>8.1.2<span class="_"> </span>says<span class="_"> </span>more<span class="_"> </span>about<span class="_"> </span>these<span class="_"> </span>possibilities<span class="_ _1"></span>.</div><div class="t m5 x1d h41 y1672 ffe fs29 fc1 sc0 ls0 ws0">8.1.1<span class="_ _48"> </span><span class="fs19">Exception<span class="_"> </span>Handling</span></div><div class="t m5 x1d h26 y6e1 ff7 fs19 fc1 sc0 ls0 ws0">Exceptions<span class="_ _16"> </span>can<span class="_ _16"> </span>be<span class="_ _16"> </span>difﬁcult<span class="_ _16"> </span>to<span class="_ _11"> </span>understand<span class="_ _16"> </span>because<span class="_ _16"> </span>handling<span class="_ _16"> </span>them<span class="_ _16"> </span>involves<span class="_ _16"> </span>close</div><div class="t m5 x1d h26 y6e2 ff7 fs19 fc1 sc0 ls0 ws0">cooperation<span class="_ _15"> </span>between<span class="_ _21"> </span>hardware<span class="_ _21"> </span>and<span class="_ _21"> </span>software<span class="_ _0"></span>.<span class="_ _15"> </span>It<span class="_ _21"> </span>is<span class="_ _21"> </span>easy<span class="_ _21"> </span>to<span class="_ _21"> </span>get<span class="_ _21"> </span>confused<span class="_ _21"> </span>about</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
