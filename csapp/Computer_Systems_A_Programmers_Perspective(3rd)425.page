<div id="pf1a9" class="pf w2 h11" data-page-no="1a9"><div class="pc pc1a9 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1a9.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">424<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>4<span class="_ _3d"> </span>Processor<span class="_ _10"> </span>Architecture</span></div><div class="t m5 x28 h2a y257 fff fs1c fc2 sc0 ls0 ws0">Aside<span class="_ _1b"> </span><span class="ff6 fs19">T<span class="_ _3"></span>racing<span class="_ _11"> </span>the<span class="_ _11"> </span>execution<span class="_ _16"> </span>of<span class="_ _11"> </span>a<span class="_ _11"> </span><span class="ffd fs2b">subq<span class="_ _11"> </span></span>instruction</span></div><div class="t m5 x28 h2b y2d0 ff7 fs1e fc2 sc0 ls0 ws0">As<span class="_"> </span>an<span class="_"> </span>example<span class="_ _0"></span>,<span class="_"> </span>let<span class="_"> </span>us<span class="_"> </span>follow<span class="_"> </span>the<span class="_ _10"> </span>processing<span class="_ _10"> </span>of<span class="_"> </span>the<span class="_ _10"> </span><span class="ffd">subq<span class="_ _10"> </span></span>instruction<span class="_ _10"> </span>on<span class="_"> </span>line<span class="_ _10"> </span>3<span class="_"> </span>of<span class="_ _10"> </span>the<span class="_ _10"> </span>object<span class="_"> </span>code<span class="_ _10"> </span>shown</div><div class="t m5 x28 h2b y2d1 ff7 fs1e fc2 sc0 ls0 ws0">in<span class="_"> </span>F<span class="_ _1"></span>igure<span class="_"> </span>4.17.<span class="_ _13"> </span>W<span class="_ _3"></span>e<span class="_"> </span>can<span class="_"> </span>see<span class="_ _13"> </span>that<span class="_"> </span>the<span class="_ _13"> </span>previous<span class="_"> </span>two<span class="_ _13"> </span>instructions<span class="_"> </span>initialize<span class="_ _13"> </span>registers<span class="_"> </span><span class="ffd">%rdx<span class="_ _13"> </span></span>and<span class="_"> </span><span class="ffd">%rbx<span class="_ _13"> </span></span>to<span class="_"> </span>9<span class="_ _13"> </span>and</div><div class="t m5 x28 h2b y2d2 ff7 fs1e fc2 sc0 ls0 ws0">21,<span class="_"> </span>respectively<span class="_ _7"></span>.<span class="_"> </span>W<span class="_ _3"></span>e<span class="_"> </span>can<span class="_ _13"> </span>also<span class="_ _13"> </span>see<span class="_"> </span>that<span class="_ _13"> </span>the<span class="_ _13"> </span>instruction<span class="_ _13"> </span>is<span class="_"> </span>located<span class="_ _13"> </span>at<span class="_ _13"> </span>address<span class="_"> </span><span class="ffd">0x014<span class="_ _13"> </span></span>and<span class="_ _13"> </span>consists<span class="_"> </span>of<span class="_ _13"> </span>2<span class="_ _13"> </span>bytes<span class="_ _1"></span>,</div><div class="t m5 x28 h2b y2d3 ff7 fs1e fc2 sc0 ls0 ws0">having<span class="_ _13"> </span>values<span class="_"> </span><span class="ffd">0x61<span class="_ _13"> </span></span>and<span class="_ _13"> </span><span class="ffd">0x23</span>.<span class="_ _13"> </span>T<span class="_ _1"></span>he<span class="_"> </span>stages<span class="_ _13"> </span>would<span class="_ _13"> </span>proceed<span class="_ _13"> </span>as<span class="_"> </span>shown<span class="_ _13"> </span>in<span class="_ _13"> </span>the<span class="_ _13"> </span>following<span class="_ _13"> </span>table<span class="_ _0"></span>,<span class="_"> </span>which<span class="_ _13"> </span>lists<span class="_ _13"> </span>the</div><div class="t m5 x28 h2b y2d4 ff7 fs1e fc2 sc0 ls0 ws0">generic<span class="_ _10"> </span>rule<span class="_ _11"> </span>for<span class="_ _11"> </span>processing<span class="_ _11"> </span>an<span class="_ _10"> </span><span class="ffd">OPq<span class="_ _11"> </span></span>instruction<span class="_ _11"> </span>(F<span class="_ _0"></span>igure<span class="_ _10"> </span>4.18)<span class="_ _11"> </span>on<span class="_ _11"> </span>the<span class="_ _11"> </span>left,<span class="_ _11"> </span>and<span class="_"> </span>the<span class="_ _11"> </span>computations<span class="_ _11"> </span>for<span class="_ _11"> </span>this</div><div class="t m5 x28 h2b y2d5 ff7 fs1e fc2 sc0 ls0 ws0">speciﬁc<span class="_"> </span>instruction<span class="_"> </span>on<span class="_"> </span>the<span class="_"> </span>right.</div><div class="t m5 x28 h31 y4e6 ff7 fs21 fc2 sc0 ls0 ws0">Stage<span class="_ _55"> </span><span class="ffd fs1e">OPq<span class="_ _11"> </span></span><span class="ff6">rA<span class="ffd fs1e">,<span class="_ _11"> </span></span>rB<span class="_ _91"> </span><span class="ffd fs1e">subq<span class="_ _11"> </span>%rdx,<span class="_ _11"> </span>%rbx</span></span></div><div class="t m5 x28 h32 y3ad5 ff7 fs21 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>etch<span class="_ _55"> </span><span class="ff6">icode<span class="_ _a"> </span></span>:<span class="_ _be"></span><span class="ff6">ifun<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>M</span></div><div class="t m5 x7c h33 y3ad6 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x235 h32 y3ad5 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">PC</span>]<span class="_ _74"> </span><span class="ff6">icode<span class="_ _a"> </span></span>:<span class="_ _be"></span><span class="ff6">ifun<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>M</span></div><div class="t m5 x1e7 h33 y3ad6 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x1c9 h32 y3ad5 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ffd fs1e">0x014</span>]<span class="_ _6"> </span><span class="ff12">=<span class="_ _13"> </span><span class="ffd fs1e">6:1</span></span></div><div class="t m5 x5b h32 y3ad7 ff6 fs21 fc2 sc0 ls0 ws0">rA<span class="_ _6"> </span><span class="ff7">:<span class="_ _be"></span></span>rB<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>M</div><div class="t m5 x1cc h33 y3ad8 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x4d h32 y3ad7 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">PC<span class="_ _13"> </span><span class="ff12">+<span class="_ _13"> </span></span></span>1]<span class="_ _5c"> </span><span class="ff6">rA<span class="_ _6"> </span></span>:<span class="_ _a"> </span><span class="ff6">rB<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>M</span></div><div class="t m5 x1ab h33 y3ad8 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x1ae h32 y3ad7 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ffd fs1e">0x015</span>]<span class="_ _6"> </span><span class="ff12">=<span class="_ _13"> </span><span class="ffd fs1e">2:3</span></span></div><div class="t m5 x5b h32 y3ad9 ff6 fs21 fc2 sc0 ls0 ws0">valP<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>PC<span class="_ _13"> </span><span class="ff12">+<span class="_ _13"> </span><span class="ff7">2<span class="_ _69"> </span></span></span>valP<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span><span class="ffd fs1e">0x014<span class="_ _13"> </span></span>+<span class="_ _10"> </span><span class="ff7">2<span class="_ _13"> </span></span>=<span class="_ _13"></span><span class="ffd fs1e">0x016</span></span></div><div class="t m5 x28 h32 y3ada ff7 fs21 fc2 sc0 ls0 ws0">Decode<span class="_ _bd"> </span><span class="ff6">valA<span class="_ _25"> </span><span class="ff12">←<span class="_ _25"> </span></span>R</span>[<span class="ff6">rA<span class="_ _2"></span></span>]<span class="_ _2f"> </span><span class="ff6">valA<span class="_ _24"> </span><span class="ff12">←<span class="_ _23"> </span></span>R<span class="_ _2"></span></span>[<span class="ffd fs1e">%rdx</span>]<span class="_ _a"> </span><span class="ff12">=<span class="_ _10"> </span><span class="ffd fs1e">9</span></span></div><div class="t m5 x5b h32 y3adb ff6 fs21 fc2 sc0 ls0 ws0">valB<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>R<span class="ff7">[</span>rB<span class="ff7">]<span class="_ _12b"> </span></span>valB<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>R<span class="ff7">[<span class="ffd fs1e">%rbx</span>]<span class="_ _6"> </span><span class="ff12">=<span class="_ _13"> </span><span class="ffd fs1e">21</span></span></span></div><div class="t m5 x28 h32 y3adc ff7 fs21 fc2 sc0 ls0 ws0">Execute<span class="_ _f4"> </span><span class="ff6">valE<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>valB<span class="_ _13"> </span>OP<span class="_ _13"> </span>valA<span class="_ _11a"> </span>valE<span class="_ _25"> </span><span class="ff12">←</span></span></div><div class="t m5 x187 h32 y3add ffd fs1e fc2 sc0 ls0 ws0">21<span class="_ _13"> </span><span class="ff12 fs21">−<span class="_ _13"> </span></span>9<span class="_ _13"> </span><span class="ff12 fs21">=<span class="_ _13"> </span></span>12</div><div class="t m5 x5b h32 y3ade ff7 fs21 fc2 sc0 ls0 ws0">Set<span class="_"> </span>CC<span class="_ _1ac"> </span><span class="ffd fs1e">ZF<span class="_ _23"> </span></span><span class="ff12">←<span class="_ _25"> </span><span class="ffd fs1e">0</span></span></div><div class="t m5 x181 h32 y3adf ff7 fs21 fc2 sc0 ls0 ws0">,<span class="_"> </span><span class="ffd fs1e">SF<span class="_ _23"> </span></span><span class="ff12">←<span class="_ _25"> </span><span class="ffd fs1e">0</span></span></div><div class="t m5 xfb h32 y3ae0 ff7 fs21 fc2 sc0 ls0 ws0">,<span class="_"> </span><span class="ffd fs1e">OF<span class="_ _23"> </span></span><span class="ff12">←<span class="_ _25"> </span><span class="ffd fs1e">0</span></span></div><div class="t m5 x28 h31 y3ae1 ff7 fs21 fc2 sc0 ls0 ws0">Memory</div><div class="t m5 x28 h32 y3ae2 ff7 fs21 fc2 sc0 ls0 ws0">Write<span class="_"> </span>back<span class="_ _4f"> </span><span class="ff6">R</span>[<span class="ff6">rB</span>]<span class="_ _22"> </span><span class="ff12">←<span class="_ _25"> </span><span class="ff6">valE<span class="_ _169"> </span>R</span></span>[</div><div class="t m5 x136 h32 y3ae3 ffd fs1e fc2 sc0 ls0 ws0">%rbx<span class="ff7 fs21">]<span class="_ _22"> </span><span class="ff12">←<span class="_ _25"> </span><span class="ff6">valE<span class="_ _13"> </span></span>=<span class="_ _13"> </span></span></span>12</div><div class="t m5 x28 h32 y3ae4 ff7 fs21 fc2 sc0 ls0 ws0">PC<span class="_"> </span>update<span class="_ _45"> </span><span class="ff6">PC<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>valP<span class="_ _158"> </span>PC<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>valP<span class="_ _13"> </span><span class="ff12">=<span class="_ _13"></span><span class="ffd fs1e">0x016</span></span></span></div><div class="t m5 x57 h2b y3ae5 ff7 fs1e fc2 sc0 ls0 ws0">As<span class="_ _11"> </span>this<span class="_ _11"> </span>trace<span class="_ _16"> </span>shows<span class="_ _3"></span>,<span class="_ _16"> </span>we<span class="_ _11"> </span>achieve<span class="_ _11"> </span>the<span class="_ _16"> </span>desired<span class="_ _11"> </span>effect<span class="_ _11"> </span>of<span class="_ _11"> </span>setting<span class="_ _11"> </span>register<span class="_ _16"> </span><span class="ffd">%rbx<span class="_ _11"> </span></span>to<span class="_ _11"> </span>12,<span class="_ _16"> </span>setting<span class="_ _11"> </span>all<span class="_ _11"> </span>three</div><div class="t m5 x28 h2b y3ae6 ff7 fs1e fc2 sc0 ls0 ws0">condition<span class="_"> </span>codes<span class="_"> </span>to<span class="_"> </span>zero<span class="_ _1"></span>,<span class="_"> </span>and<span class="_"> </span>incrementing<span class="_"> </span>the<span class="_"> </span>PC<span class="_"> </span>by<span class="_"> </span>2.</div><div class="t m5 x50 h31 y3ae7 ff7 fs21 fc2 sc0 ls0 ws0">Generic<span class="_ _15a"> </span>Speciﬁc</div><div class="t m5 x1d h31 y3ae8 ff7 fs21 fc2 sc0 ls0 ws0">Stage</div><div class="t m5 x50 h93 y3ae9 ffd fs1e fc2 sc0 ls0 ws0">irmovq<span class="_ _11"> </span><span class="ff6 fs21">V</span>,<span class="_ _11"> </span><span class="ff6 fs21">rB<span class="_ _7a"> </span></span>irmovq<span class="_ _11"> </span>$128,<span class="_ _16"> </span>%rsp</div><div class="t m5 x1d h31 y3aea ff7 fs21 fc2 sc0 ls0 ws0">Memory</div><div class="t m5 x1d h32 y3aeb ff7 fs21 fc2 sc0 ls0 ws0">Write<span class="_"> </span>back<span class="_ _4f"> </span><span class="ff6">R</span>[<span class="ff6">rB</span>]<span class="_ _22"> </span><span class="ff12">←<span class="_ _25"> </span><span class="ff6">valE</span></span></div><div class="t m5 x1d h32 y3aec ff7 fs21 fc2 sc0 ls0 ws0">PC<span class="_"> </span>update<span class="_ _45"> </span><span class="ff6">PC<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>valP</span></div><div class="t m5 x29 h26 y3aed ff7 fs19 fc2 sc0 ls0 ws0">How<span class="_"> </span>does<span class="_"> </span>this<span class="_"> </span>instruction<span class="_"> </span>execution<span class="_"> </span>modify<span class="_"> </span>the<span class="_"> </span>registers<span class="_"> </span>and<span class="_"> </span>the<span class="_"> </span>PC?</div><div class="t m5 x29 h26 y832 ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_"> </span>4.19<span class="_"> </span>shows<span class="_"> </span>the<span class="_"> </span>processing<span class="_"> </span>required<span class="_"> </span>for<span class="_"> </span>the<span class="_"> </span>memory<span class="_"> </span>write<span class="_"> </span>and<span class="_"> </span>read<span class="_ _13"> </span>in-</div><div class="t m5 x1d h26 y833 ff7 fs19 fc1 sc0 ls0 ws0">structions<span class="_ _13"> </span><span class="ffd">rmmovq<span class="_ _13"> </span></span>and<span class="_"> </span><span class="ffd">mrmovq</span>.<span class="_ _13"> </span>W<span class="_ _3"></span>e<span class="_ _13"> </span>see<span class="_ _13"> </span>the<span class="_"> </span>same<span class="_ _13"> </span>basic<span class="_ _13"> </span>ﬂow<span class="_ _13"> </span>as<span class="_ _13"> </span>before,<span class="_ _13"> </span>but<span class="_ _13"> </span>using<span class="_ _13"> </span>the</div><div class="t m5 x1d h26 y834 ff7 fs19 fc1 sc0 ls0 ws0">ALU<span class="_ _13"> </span>to<span class="_ _6"> </span>add<span class="_ _13"> </span><span class="ff6">valC<span class="_ _6"> </span></span>to<span class="_ _13"> </span><span class="ff6">valB</span>,<span class="_ _13"> </span>giving<span class="_ _13"> </span>the<span class="_ _6"> </span>effective<span class="_ _13"> </span>address<span class="_ _6"> </span>(the<span class="_ _13"> </span>sum<span class="_ _13"> </span>of<span class="_ _6"> </span>the<span class="_ _13"> </span>displacement</div><div class="t m5 x1d h26 y835 ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_"> </span>the<span class="_ _11"> </span>base<span class="_ _11"> </span>register<span class="_"> </span>value)<span class="_ _11"> </span>for<span class="_ _11"> </span>the<span class="_ _11"> </span>memory<span class="_"> </span>operation.<span class="_ _11"> </span>In<span class="_ _11"> </span>the<span class="_"> </span>memory<span class="_ _11"> </span>stage,<span class="_"> </span>we</div><div class="t m5 x1d h26 y17b6 ff7 fs19 fc1 sc0 ls0 ws0">either<span class="_"> </span>write<span class="_"> </span>the<span class="_"> </span>register<span class="_"> </span>value<span class="_"> </span><span class="ff6">valA<span class="_ _10"> </span></span>to<span class="_"> </span>memory<span class="_"> </span>or<span class="_"> </span>read<span class="_"> </span><span class="ff6">valM<span class="_ _10"> </span></span>from<span class="_"> </span>memory<span class="_ _3"></span>.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
