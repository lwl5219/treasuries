<div id="pf79" class="pf w2 h11" data-page-no="79"><div class="pc pc79 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg79.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">120<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>2<span class="_ _3d"> </span>Representing<span class="_ _10"> </span>and<span class="_ _10"> </span>Manipulating<span class="_ _10"> </span>Information</span></div><div class="t m5 x1d h26 y9c ff7 fs19 fc2 sc0 ls0 ws0">program,<span class="_"> </span>data<span class="_ _11"> </span>type<span class="_ _11"> </span><span class="ffd">size_t<span class="_ _11"> </span></span>is<span class="_"> </span>deﬁned<span class="_ _11"> </span>(via<span class="_ _11"> </span><span class="ffd">typedef</span>)<span class="_"> </span>in<span class="_ _11"> </span>header<span class="_ _11"> </span>ﬁle<span class="_"> </span><span class="ffd">stdio.h<span class="_ _11"> </span></span>to<span class="_ _11"> </span>be</div><div class="t m5 x1d h26 y409 ffd fs19 fc2 sc0 ls0 ws0">unsigned<span class="ff7">.</span></div><div class="t m5 x124 h26 y11b9 ff7 fs19 fc2 sc0 ls0 ws0">A.<span class="_ _1f"> </span>F<span class="_ _1"></span>or<span class="_"> </span>what<span class="_"> </span>cases<span class="_"> </span>will<span class="_"> </span>this<span class="_"> </span>function<span class="_"> </span>produce<span class="_"> </span>an<span class="_"> </span>incorrect<span class="_"> </span>result?</div><div class="t m5 x124 h26 y11ba ff7 fs19 fc2 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>Explain<span class="_"> </span>how<span class="_"> </span>this<span class="_"> </span>incorrect<span class="_"> </span>result<span class="_"> </span>comes<span class="_"> </span>about.</div><div class="t m5 x124 h26 y11bb ff7 fs19 fc2 sc0 ls0 ws0">C.<span class="_ _25"> </span>Show<span class="_"> </span>how<span class="_"> </span>to<span class="_"> </span>ﬁx<span class="_"> </span>the<span class="_"> </span>code<span class="_"> </span>so<span class="_"> </span>that<span class="_"> </span>it<span class="_"> </span>will<span class="_"> </span>work<span class="_"> </span>reliably<span class="_ _3"></span>.</div><div class="t m5 x29 h26 y11bc ff7 fs19 fc1 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_ _16"> </span>have<span class="_ _16"> </span>seen<span class="_ _16"> </span>multiple<span class="_ _16"> </span>ways<span class="_ _16"> </span>in<span class="_ _16"> </span>which<span class="_ _16"> </span>the<span class="_ _16"> </span>subtle<span class="_ _16"> </span>features<span class="_ _16"> </span>of<span class="_ _16"> </span>unsigned<span class="_ _16"> </span>arith-</div><div class="t m5 x1d h26 y11bd ff7 fs19 fc1 sc0 ls0 ws0">metic,<span class="_ _16"> </span>and<span class="_ _14"> </span>especially<span class="_ _14"> </span>the<span class="_ _16"> </span>implicit<span class="_ _14"> </span>conversion<span class="_ _16"> </span>of<span class="_ _14"> </span>signed<span class="_ _14"> </span>to<span class="_ _16"> </span>unsigned,<span class="_ _14"> </span>can<span class="_ _14"> </span>lead<span class="_ _14"> </span>to</div><div class="t m5 x1d h26 y11be ff7 fs19 fc1 sc0 ls0 ws0">errors<span class="_ _14"> </span>or<span class="_ _15"> </span>vulnerabilities<span class="_ _1"></span>.<span class="_ _14"> </span>One<span class="_ _15"> </span>way<span class="_ _15"> </span>to<span class="_ _14"> </span>avoid<span class="_ _15"> </span>such<span class="_ _14"> </span>bugs<span class="_ _15"> </span>is<span class="_ _15"> </span>to<span class="_ _14"> </span>never<span class="_ _15"> </span>use<span class="_ _14"> </span>unsigned</div><div class="t m5 x1d h26 y11bf ff7 fs19 fc1 sc0 ls0 ws0">numbers<span class="_ _1"></span>.<span class="_ _11"> </span>In<span class="_ _16"> </span>fact,<span class="_ _11"> </span>few<span class="_ _16"> </span>languages<span class="_ _11"> </span>other<span class="_ _11"> </span>than<span class="_ _16"> </span>C<span class="_ _11"> </span>support<span class="_ _11"> </span>unsigned<span class="_ _16"> </span>integers<span class="_ _1"></span>.<span class="_ _11"> </span>Appar<span class="_ _1"></span>-</div><div class="t m5 x1d h26 y11c0 ff7 fs19 fc1 sc0 ls0 ws0">ently<span class="_ _3"></span>,<span class="_"> </span>these<span class="_"> </span>other<span class="_"> </span>language<span class="_"> </span>designers<span class="_ _11"> </span>viewed<span class="_"> </span>them<span class="_"> </span>as<span class="_"> </span>more<span class="_"> </span>trouble<span class="_ _11"> </span>than<span class="_"> </span>they<span class="_"> </span>are</div><div class="t m5 x1d h26 y11c1 ff7 fs19 fc1 sc0 ls0 ws0">worth.<span class="_"> </span>F<span class="_ _0"></span>or<span class="_"> </span>example,<span class="_"> </span>J<span class="_ _1"></span>ava<span class="_ _11"> </span>supports<span class="_ _11"> </span>only<span class="_ _11"> </span>signed<span class="_"> </span>integers<span class="_ _0"></span>,<span class="_ _11"> </span>and<span class="_ _11"> </span>it<span class="_ _11"> </span>requires<span class="_ _11"> </span>that<span class="_"> </span>they</div><div class="t m5 x1d h26 y11c2 ff7 fs19 fc1 sc0 ls0 ws0">be<span class="_"> </span>implemented<span class="_ _11"> </span>with<span class="_ _11"> </span>two’s-complement<span class="_"> </span>arithmetic.<span class="_ _11"> </span>T<span class="_ _1"></span>he<span class="_ _11"> </span>normal<span class="_ _11"> </span>right<span class="_ _11"> </span>shift<span class="_ _11"> </span>oper<span class="_ _1"></span>-</div><div class="t m5 x1d h26 y11c3 ff7 fs19 fc1 sc0 ls0 ws0">ator<span class="_ _11"> </span><span class="ffd">&gt;&gt;<span class="_ _11"> </span></span>is<span class="_ _11"> </span>guaranteed<span class="_ _16"> </span>to<span class="_"> </span>perform<span class="_ _16"> </span>an<span class="_"> </span>arithmetic<span class="_ _16"> </span>shift.<span class="_"> </span>The<span class="_"> </span>special<span class="_ _11"> </span>operator<span class="_ _16"> </span><span class="ffd">&gt;&gt;&gt;<span class="_ _11"> </span></span>is</div><div class="t m5 x1d h26 y11c4 ff7 fs19 fc1 sc0 ls0 ws0">deﬁned<span class="_"> </span>to<span class="_"> </span>perform<span class="_"> </span>a<span class="_"> </span>logical<span class="_"> </span>right<span class="_"> </span>shift.</div><div class="t m5 x29 h26 y11c5 ff7 fs19 fc1 sc0 ls0 ws0">Unsigned<span class="_"> </span>values<span class="_ _11"> </span>are<span class="_ _11"> </span>very<span class="_ _11"> </span>useful<span class="_ _11"> </span>when<span class="_ _11"> </span>we<span class="_ _11"> </span>want<span class="_ _11"> </span>to<span class="_"> </span>think<span class="_ _11"> </span>of<span class="_ _11"> </span>words<span class="_ _11"> </span>as<span class="_ _11"> </span>just<span class="_ _11"> </span>col-</div><div class="t m5 x1d h26 y11c6 ff7 fs19 fc1 sc0 ls0 ws0">lections<span class="_ _14"> </span>of<span class="_ _14"> </span>bits<span class="_ _14"> </span>with<span class="_ _14"> </span>no<span class="_ _14"> </span>numeric<span class="_ _14"> </span>interpretation.<span class="_ _14"> </span>T<span class="_ _1"></span>his<span class="_ _14"> </span>occurs<span class="_ _1"></span>,<span class="_ _15"> </span>for<span class="_ _14"> </span>example,<span class="_ _14"> </span>when</div><div class="t m5 x1d h26 y11c7 ff7 fs19 fc1 sc0 ls0 ws0">packing<span class="_ _11"> </span>a<span class="_ _16"> </span>word<span class="_ _16"> </span>with<span class="_ _11"> </span><span class="ffa">ﬂags<span class="_ _16"> </span></span>describing<span class="_ _11"> </span>various<span class="_ _16"> </span>Boolean<span class="_ _11"> </span>conditions<span class="_ _1"></span>.<span class="_ _16"> </span>Addresses<span class="_ _16"> </span>are</div><div class="t m5 x1d h26 y11c8 ff7 fs19 fc1 sc0 ls0 ws0">naturally<span class="_ _14"> </span>unsigned,<span class="_ _15"> </span>so<span class="_ _14"> </span>systems<span class="_ _15"> </span>programmers<span class="_ _14"> </span>ﬁnd<span class="_ _14"> </span>unsigned<span class="_ _15"> </span>types<span class="_ _14"> </span>to<span class="_ _14"> </span>be<span class="_ _15"> </span>helpful.</div><div class="t m5 x1d h26 y11c9 ff7 fs19 fc1 sc0 ls0 ws0">Unsigned<span class="_ _16"> </span>values<span class="_ _11"> </span>are<span class="_ _16"> </span>also<span class="_ _16"> </span>useful<span class="_ _11"> </span>when<span class="_ _16"> </span>implementing<span class="_ _16"> </span>mathematical<span class="_ _16"> </span>packages<span class="_ _11"> </span>for</div><div class="t m5 x1d h26 y11ca ff7 fs19 fc1 sc0 ls0 ws0">modular<span class="_"> </span>arithmetic<span class="_"> </span>and<span class="_"> </span>for<span class="_"> </span>multiprecision<span class="_ _11"> </span>arithmetic,<span class="_"> </span>in<span class="_"> </span>which<span class="_"> </span>numbers<span class="_"> </span>are<span class="_"> </span>rep-</div><div class="t m5 x1d h26 y11cb ff7 fs19 fc1 sc0 ls0 ws0">resented<span class="_"> </span>by<span class="_"> </span>arrays<span class="_"> </span>of<span class="_"> </span>words<span class="_ _1"></span>.</div><div class="t m5 x1d h3b y11cc fff fs24 fc6 sc0 ls0 ws0">2.3<span class="_ _17"> </span><span class="ffe fs18">Integer<span class="_"> </span>Arithmetic</span></div><div class="t m5 x1d h26 y11cd ff7 fs19 fc1 sc0 ls0 ws0">Many<span class="_ _13"> </span>beginning<span class="_ _13"> </span>programmers<span class="_ _13"> </span>are<span class="_"> </span>surprised<span class="_ _13"> </span>to<span class="_ _13"> </span>ﬁnd<span class="_ _13"> </span>that<span class="_ _13"> </span>adding<span class="_ _13"> </span>two<span class="_"> </span>positive<span class="_ _13"> </span>num-</div><div class="t m5 x1d h26 y11ce ff7 fs19 fc1 sc0 ls0 ws0">bers<span class="_ _13"> </span>can<span class="_ _13"> </span>yield<span class="_ _13"> </span>a<span class="_ _13"> </span>negative<span class="_ _13"> </span>result,<span class="_ _13"> </span>and<span class="_ _13"> </span>that<span class="_"> </span>the<span class="_ _13"> </span>comparison<span class="_ _13"> </span><span class="ffd ls94">x&lt;y</span>can<span class="_ _13"> </span>yield<span class="_ _13"> </span>a<span class="_ _13"> </span>different</div><div class="t m5 x1d h26 y11cf ff7 fs19 fc1 sc0 ls0 ws0">result<span class="_"> </span>than<span class="_ _13"> </span>the<span class="_"> </span>comparison<span class="_"> </span><span class="ffd ls95">x<span class="_ _4a"></span>-<span class="_ _4a"></span>y&lt;0<span class="_ _80"></span><span class="ff7 ls0">.<span class="_"> </span>T<span class="_ _1"></span>hese<span class="_"> </span>properties<span class="_"> </span>are<span class="_ _13"> </span>artifacts<span class="_"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>ﬁnite<span class="_"> </span>na-</span></span></div><div class="t m5 x1d h26 y11d0 ff7 fs19 fc1 sc0 ls0 ws0">ture<span class="_"> </span>of<span class="_ _11"> </span>computer<span class="_"> </span>arithmetic.<span class="_"> </span>Understanding<span class="_ _11"> </span>the<span class="_ _11"> </span>nuances<span class="_"> </span>of<span class="_ _11"> </span>computer<span class="_"> </span>arithmetic</div><div class="t m5 x1d h26 y11d1 ff7 fs19 fc1 sc0 ls0 ws0">can<span class="_"> </span>help<span class="_"> </span>programmers<span class="_"> </span>write<span class="_"> </span>more<span class="_"> </span>reliable<span class="_"> </span>code<span class="_ _1"></span>.</div><div class="t m5 x1d h41 y11d2 ffe fs29 fc1 sc0 ls0 ws0">2.3.1<span class="_ _48"> </span><span class="fs19">Unsigned<span class="_"> </span>Addition</span></div><div class="t m5 x1d h46 y11d3 ff7 fs19 fc1 sc0 ls0 ws0">Consider<span class="_ _21"> </span>two<span class="_ _f"> </span>nonnegative<span class="_ _f"> </span>integers<span class="_ _f"> </span><span class="ff11">x<span class="_ _e"> </span></span>and<span class="_ _21"> </span><span class="ff11">y<span class="_ _5"></span></span>,<span class="_ _e"> </span>such<span class="_ _21"> </span>that<span class="_ _f"> </span>0<span class="_"> </span><span class="ff12">≤<span class="_ _10"> </span><span class="ff11 ls57">x,<span class="_ _13"> </span>y<span class="_ _10"> </span>&lt;<span class="_ _6"> </span></span></span>2</div><div class="t m5 xea h50 y11d4 ff11 fs25 fc1 sc0 ls0 ws0">w</div><div class="t m5 x13f h26 y11d3 ff7 fs19 fc1 sc0 ls0 ws0">.<span class="_ _21"> </span>Each<span class="_ _f"> </span>of</div><div class="t m5 x1d h26 y11d5 ff7 fs19 fc1 sc0 ls0 ws0">these<span class="_"> </span>values<span class="_ _13"> </span>can<span class="_"> </span>be<span class="_ _13"> </span>represented<span class="_"> </span>by<span class="_ _13"> </span>a<span class="_"> </span><span class="ff11">w<span class="_ _2"></span></span>-bit<span class="_ _13"> </span>unsigned<span class="_"> </span>number.<span class="_ _13"> </span>If<span class="_"> </span>we<span class="_ _13"> </span>compute<span class="_"> </span>their</div><div class="t m5 x1d h46 y11d6 ff7 fs19 fc1 sc0 ls0 ws0">sum,<span class="_"> </span>however,<span class="_ _11"> </span>we<span class="_"> </span>have<span class="_ _11"> </span>a<span class="_ _11"> </span>possible<span class="_"> </span>range<span class="_ _11"> </span>0<span class="_"> </span><span class="ff12">≤<span class="_ _13"> </span><span class="ff11">x<span class="_ _16"> </span></span>+<span class="_ _13"></span><span class="ff11">y<span class="_ _11"> </span></span>≤<span class="_ _10"> </span></span>2</div><div class="t m5 x18a h4b y11d7 ff11 fs25 fc1 sc0 ls0 ws0">w<span class="ff12">+<span class="ff7">1</span></span></div><div class="t m5 x16a h46 y74e ff12 fs19 fc1 sc0 ls0 ws0">−<span class="_ _13"> </span><span class="ff7">2<span class="_ _2"></span>.<span class="_"> </span>Representing<span class="_ _11"> </span>this</span></div><div class="t m5 x1d h46 y74f ff7 fs19 fc1 sc0 ls0 ws0">sum<span class="_ _11"> </span>could<span class="_ _11"> </span>require<span class="_ _16"> </span><span class="ff11">w<span class="_ _10"> </span><span class="ff12">+<span class="_ _10"> </span></span></span>1<span class="_ _13"> </span>bits<span class="_ _1"></span>.<span class="_ _16"> </span>F<span class="_ _3"></span>or<span class="_ _16"> </span>example<span class="_ _1"></span>,<span class="_ _16"> </span>F<span class="_ _1"></span>igure<span class="_ _11"> </span>2.21<span class="_ _16"> </span>shows<span class="_ _11"> </span>a<span class="_ _11"> </span>plot<span class="_ _11"> </span>of<span class="_ _16"> </span>the<span class="_"> </span>func-</div><div class="t m5 x1d h46 y750 ff7 fs19 fc1 sc0 ls0 ws0">tion<span class="_ _14"> </span><span class="ff11">x<span class="_ _11"> </span><span class="ff12">+<span class="_ _10"> </span></span>y<span class="_ _21"> </span></span>when<span class="_ _14"> </span><span class="ff11">x<span class="_ _21"> </span></span>and<span class="_ _14"> </span><span class="ff11">y<span class="_ _f"> </span></span>have<span class="_ _14"> </span>4-bit<span class="_ _14"> </span>representations<span class="_ _1"></span>.<span class="_ _14"> </span>T<span class="_ _1"></span>he<span class="_ _15"> </span>arguments<span class="_ _14"> </span>(shown<span class="_ _14"> </span>on</div><div class="t m5 x1d h26 y751 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _14"> </span>horizontal<span class="_ _14"> </span>axes)<span class="_ _14"> </span>range<span class="_ _14"> </span>from<span class="_ _14"> </span>0<span class="_ _14"> </span>to<span class="_ _15"> </span>15,<span class="_ _15"> </span>but<span class="_ _14"> </span>the<span class="_ _14"> </span>sum<span class="_ _14"> </span>ranges<span class="_ _14"> </span>from<span class="_ _14"> </span>0<span class="_ _14"> </span>to<span class="_ _15"> </span>30.<span class="_ _14"> </span>T<span class="_ _1"></span>he</div><div class="t m5 x1d h26 y752 ff7 fs19 fc1 sc0 ls0 ws0">shape<span class="_ _15"> </span>of<span class="_ _15"> </span>the<span class="_ _15"> </span>function<span class="_ _15"> </span>is<span class="_ _15"> </span>a<span class="_ _15"> </span>sloping<span class="_ _15"> </span>plane<span class="_ _21"> </span>(the<span class="_ _15"> </span>function<span class="_ _15"> </span>is<span class="_ _15"> </span>linear<span class="_ _15"> </span>in<span class="_ _15"> </span>both<span class="_ _15"> </span>dimen-</div><div class="t m5 x1d h46 y753 ff7 fs19 fc1 sc0 ls0 ws0">sions).<span class="_ _15"> </span>If<span class="_ _15"> </span>we<span class="_ _21"> </span>were<span class="_ _15"> </span>to<span class="_ _21"> </span>maintain<span class="_ _15"> </span>the<span class="_ _21"> </span>sum<span class="_ _15"> </span>as<span class="_ _21"> </span>a<span class="_ _15"> </span>(<span class="ff11">w<span class="_ _11"> </span><span class="ff12">+<span class="_ _10"> </span></span></span>1<span class="_ _1"></span>)-bit<span class="_ _15"> </span>number<span class="_ _21"> </span>and<span class="_ _15"> </span>add<span class="_ _21"> </span>it<span class="_ _15"> </span>to</div><div class="t m5 x1d h46 y754 ff7 fs19 fc1 sc0 ls0 ws0">another<span class="_ _11"> </span>value,<span class="_ _16"> </span>we<span class="_ _11"> </span>may<span class="_ _16"> </span>require<span class="_ _11"> </span><span class="ff11">w<span class="_ _11"> </span><span class="ff12">+<span class="_ _10"> </span></span></span>2<span class="_ _11"> </span>bits<span class="_ _1"></span>,<span class="_ _16"> </span>and<span class="_ _16"> </span>so<span class="_ _16"> </span>on.<span class="_ _11"> </span>This<span class="_ _11"> </span>continued<span class="_ _16"> </span>“word<span class="_ _11"> </span>size</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
