<div id="pf166" class="pf w2 h11" data-page-no="166"><div class="pc pc166 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg166.png"/><div class="t m5 x5f h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Homework<span class="_ _10"> </span>Problems<span class="_ _1b"> </span><span class="ffe fs1e">357</span></div><div class="t m5 x2c h2d y9c ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _45"> </span><span class="ffd fs1e fc2">movq<span class="_ _46"> </span>%rax,<span class="_ _e"> </span>184(%rdi)</span></div><div class="t m5 x2c h2d y2825 ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _45"> </span><span class="ffd fs1e fc2">ret</span></div><div class="t m5 x26 h26 y3246 ff7 fs19 fc2 sc0 ls0 ws0">What<span class="_"> </span>are<span class="_"> </span>the<span class="_"> </span>values<span class="_"> </span>of<span class="_"> </span><span class="ff11">A<span class="_ _10"> </span></span>and<span class="_"> </span><span class="ff11">B<span class="_ _2"></span></span>?<span class="_"> </span>(The<span class="_"> </span>solution<span class="_"> </span>is<span class="_"> </span>unique<span class="_ _1"></span>.)</div><div class="t m5 x17 h73 y3247 ffe fs1e fc6 sc0 ls0 ws0">3.69<span class="_ _23"> </span><span class="ff10 fs19">◆◆◆</span></div><div class="t m5 x17 h26 y3248 ff7 fs19 fc1 sc0 ls0 ws0">Y<span class="_ _3"></span>ou<span class="_ _16"> </span>are<span class="_ _16"> </span>charged<span class="_ _16"> </span>with<span class="_ _16"> </span>maintaining<span class="_ _16"> </span>a<span class="_ _16"> </span>large<span class="_ _16"> </span>C<span class="_ _16"> </span>program,<span class="_ _14"> </span>and<span class="_ _16"> </span>you<span class="_ _16"> </span>come<span class="_ _16"> </span>across<span class="_ _16"> </span>the</div><div class="t m5 x17 h26 y3249 ff7 fs19 fc1 sc0 ls0 ws0">following<span class="_"> </span>code:</div><div class="t m5 x2c h2d y324a ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">typedef<span class="_ _1f"> </span>struct<span class="_ _e"> </span>{</span></div><div class="t m5 x2c h2e y324b ff6 fs20 fc6 sc0 ls0 ws0">2</div><div class="t m5 x142 h2d y324c ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>first;</div><div class="t m5 x2c h2d y324d ff6 fs20 fc6 sc0 ls0 ws0">3<span class="_ _20"> </span><span class="ffd fs1e fc2">a_struct<span class="_ _e"> </span>a[CNT];</span></div><div class="t m5 x2c h2e y324e ff6 fs20 fc6 sc0 ls0 ws0">4</div><div class="t m5 x142 h2d y324f ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>last;</div><div class="t m5 x2c h2d y3250 ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _1c"> </span><span class="ffd fs1e fc2">}<span class="_ _1f"> </span>b_struct;</span></div><div class="t m5 x2c h2e y3251 ff6 fs20 fc6 sc0 ls0 ws0">6</div><div class="t m5 x2c h2e y3252 ff6 fs20 fc6 sc0 ls0 ws0">7</div><div class="t m5 x2d h2d y3253 ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>test(long<span class="_ _1f"> </span>i,<span class="_ _1f"> </span>b_struct<span class="_ _e"> </span>*bp)</div><div class="t m5 x2c h2d y3254 ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x2c h2d y3255 ff6 fs20 fc6 sc0 ls0 ws0">9<span class="_ _20"> </span><span class="ffd fs1e fc2">int<span class="_ _e"> </span>n<span class="_ _1f"> </span>=<span class="_ _1f"> </span>bp-&gt;first<span class="_ _e"> </span>+<span class="_ _1f"> </span>bp-&gt;last;</span></div><div class="t m5 x17 h2d y3256 ff6 fs20 fc6 sc0 ls0 ws0">10<span class="_ _20"> </span><span class="ffd fs1e fc2">a_struct<span class="_ _e"> </span>*ap<span class="_ _1f"> </span>=<span class="_ _1f"> </span>&amp;bp-&gt;a[i];</span></div><div class="t m5 x17 h2e y3257 ff6 fs20 fc6 sc0 ls0 ws0">11</div><div class="t m5 x142 h2d y3258 ffd fs1e fc2 sc0 ls0 ws0">ap-&gt;x[ap-&gt;idx]<span class="_ _e"> </span>=<span class="_ _1f"> </span>n;</div><div class="t m5 x17 h2d y3259 ff6 fs20 fc6 sc0 ls0 ws0">12<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x26 h26 y325a ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _13"> </span>declarations<span class="_ _6"> </span>of<span class="_ _13"> </span>the<span class="_ _6"> </span>compile-time<span class="_ _6"> </span>constant<span class="_ _13"> </span><span class="ffd">CNT<span class="_ _6"> </span></span>and<span class="_ _13"> </span>the<span class="_ _6"> </span>structure<span class="_ _6"> </span><span class="ffd">a_struct</span></div><div class="t m5 x17 h26 y325b ff7 fs19 fc2 sc0 ls0 ws0">are<span class="_"> </span>in<span class="_ _13"> </span>a<span class="_"> </span>ﬁle<span class="_"> </span>for<span class="_ _13"> </span>which<span class="_"> </span>you<span class="_ _13"> </span>do<span class="_"> </span>not<span class="_"> </span>have<span class="_ _13"> </span>the<span class="_"> </span>necessary<span class="_"> </span>access<span class="_ _13"> </span>privilege.<span class="_ _13"> </span>F<span class="_ _1"></span>ortunately<span class="_ _3"></span>,</div><div class="t m5 x17 h26 y325c ff7 fs19 fc2 sc0 ls0 ws0">you<span class="_ _13"> </span>have<span class="_"> </span>a<span class="_ _13"> </span>copy<span class="_"> </span>of<span class="_ _13"> </span>the<span class="_"> </span><span class="ffd">.o<span class="_ _13"> </span></span>version<span class="_"> </span>of<span class="_ _13"> </span>code,<span class="_ _13"> </span>which<span class="_"> </span>you<span class="_ _13"> </span>are<span class="_"> </span>able<span class="_ _13"> </span>to<span class="_"> </span>disassemble<span class="_ _13"> </span>with</div><div class="t m5 x17 h26 y325d ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span><span class="ff9">objd<span class="_ _1"></span>ump<span class="_ _11"> </span><span class="ff7">program,<span class="_"> </span>yielding<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>disassembly:</span></span></div><div class="t m5 x239 h61 y325e ff13 fs35 fc6 sc0 ls0 ws0">void<span class="_ _f"> </span>test(long<span class="_ _f"> </span>i,<span class="_ _f"> </span>b_struct<span class="_ _e"> </span>*bp)</div><div class="t m5 x239 h61 y325f ff13 fs35 fc6 sc0 ls0 ws0">i<span class="_ _f"> </span>in<span class="_ _f"> </span>%rdi,<span class="_ _f"> </span>bp<span class="_ _e"> </span>in<span class="_ _21"> </span>%rsi</div><div class="t m5 x2c h2d y3260 ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">0000000000000000<span class="_ _1f"> </span>&lt;test&gt;:</span></div><div class="t m5 x2c h2d y3261 ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _5b"> </span><span class="ffd fs1e fc2">0:<span class="_ _3f"> </span>8b<span class="_ _1f"> </span>8e<span class="_ _e"> </span>20<span class="_ _1f"> </span>01<span class="_ _e"> </span>00<span class="_ _1f"> </span>00<span class="_ _6f"> </span>mov<span class="_ _46"> </span>0x120(%rsi),%ecx</span></div><div class="t m5 x2c h2d y3262 ff6 fs20 fc6 sc0 ls0 ws0">3<span class="_ _5b"> </span><span class="ffd fs1e fc2">6:<span class="_ _3f"> </span>03<span class="_ _1f"> </span>0e<span class="_ _159"> </span>add<span class="_ _46"> </span>(%rsi),%ecx</span></div><div class="t m5 x2c h2d y3263 ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _5b"> </span><span class="ffd fs1e fc2">8:<span class="_ _3f"> </span>48<span class="_ _1f"> </span>8d<span class="_ _e"> </span>04<span class="_ _1f"> </span>bf<span class="_ _35"> </span>lea<span class="_ _46"> </span>(%rdi,%rdi,4),%rax</span></div><div class="t m5 x2c h2d y3264 ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _5b"> </span><span class="ffd fs1e fc2">c:<span class="_ _3f"> </span>48<span class="_ _1f"> </span>8d<span class="_ _e"> </span>04<span class="_ _1f"> </span>c6<span class="_ _35"> </span>lea<span class="_ _46"> </span>(%rsi,%rax,8),%rax</span></div><div class="t m5 x2c h2d y3265 ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _45"> </span><span class="ffd fs1e fc2">10:<span class="_ _3f"> </span>48<span class="_ _e"> </span>8b<span class="_ _1f"> </span>50<span class="_ _1f"> </span>08<span class="_ _35"> </span>mov<span class="_ _46"> </span>0x8(%rax),%rdx</span></div><div class="t m5 x2c h2d y3266 ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _45"> </span><span class="ffd fs1e fc2">14:<span class="_ _3f"> </span>48<span class="_ _e"> </span>63<span class="_ _1f"> </span>c9<span class="_ _12a"> </span>movslq<span class="_ _e"> </span>%ecx,%rcx</span></div><div class="t m5 x2c h2d y3267 ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _45"> </span><span class="ffd fs1e fc2">17:<span class="_ _3f"> </span>48<span class="_ _e"> </span>89<span class="_ _1f"> </span>4c<span class="_ _1f"> </span>d0<span class="_ _e"> </span>10<span class="_ _86"> </span>mov<span class="_ _46"> </span>%rcx,0x10(%rax,%rdx,8)</span></div><div class="t m5 x2c h2d y3268 ff6 fs20 fc6 sc0 ls0 ws0">9<span class="_ _45"> </span><span class="ffd fs1e fc2">1c:<span class="_ _3f"> </span>c3<span class="_ _129"> </span>retq</span></div><div class="t m5 x26 h26 y3269 ff7 fs19 fc2 sc0 ls0 ws0">Using<span class="_"> </span>your<span class="_"> </span>reverse<span class="_"> </span>engineering<span class="_"> </span>skills<span class="_ _1"></span>,<span class="_"> </span>deduce<span class="_"> </span>the<span class="_"> </span>following:</div><div class="t m5 x34 h26 y326a ff7 fs19 fc2 sc0 ls0 ws0">A.<span class="_ _1f"> </span>T<span class="_ _1"></span>he<span class="_"> </span>value<span class="_"> </span>of<span class="_"> </span><span class="ffd">CNT</span>.</div><div class="t m5 x34 h26 y326b ff7 fs19 fc2 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>A<span class="_ _11"> </span>complete<span class="_"> </span>declaration<span class="_ _11"> </span>of<span class="_ _11"> </span>structure<span class="_"> </span><span class="ffd">a_struct</span>.<span class="_ _11"> </span>Assume<span class="_"> </span>that<span class="_ _11"> </span>the<span class="_ _11"> </span>only<span class="_"> </span>ﬁelds</div><div class="t m5 x2d h26 y326c ff7 fs19 fc2 sc0 ls0 ws0">in<span class="_"> </span>this<span class="_"> </span>structure<span class="_ _13"> </span>are<span class="_"> </span><span class="ffd">idx<span class="_ _10"> </span></span>and<span class="_"> </span><span class="ffd">x</span>,<span class="_"> </span>and<span class="_ _13"> </span>that<span class="_"> </span>both<span class="_"> </span>of<span class="_"> </span>these<span class="_"> </span>contain<span class="_ _13"> </span>signed<span class="_"> </span>values<span class="_ _1"></span>.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
