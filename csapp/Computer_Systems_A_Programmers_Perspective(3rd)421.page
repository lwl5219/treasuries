<div id="pf1a5" class="pf w2 h11" data-page-no="1a5"><div class="pc pc1a5 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1a5.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">420<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>4<span class="_ _3d"> </span>Processor<span class="_ _10"> </span>Architecture</span></div><div class="t m5 x28 h2a y257 fff fs1c fc2 sc0 ls0 ws0">Aside<span class="_ _1b"> </span><span class="ff6 fs19">Real-life<span class="_ _11"> </span>memory<span class="_ _11"> </span>design</span></div><div class="t m5 x28 h2b y2d0 ff7 fs1e fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>memory<span class="_"> </span>system<span class="_ _13"> </span>in<span class="_"> </span>a<span class="_ _13"> </span>full-scale<span class="_"> </span>microprocessor<span class="_ _13"> </span>is<span class="_ _13"> </span>far<span class="_"> </span>more<span class="_ _13"> </span>complex<span class="_"> </span>than<span class="_ _13"> </span>the<span class="_"> </span>simple<span class="_ _13"> </span>one<span class="_"> </span>we<span class="_ _13"> </span>assume</div><div class="t m5 x28 h2b y2d1 ff7 fs1e fc2 sc0 ls0 ws0">in<span class="_ _14"> </span>our<span class="_ _15"> </span>design.<span class="_ _14"> </span>It<span class="_ _15"> </span>consists<span class="_ _14"> </span>of<span class="_ _15"> </span>several<span class="_ _14"> </span>forms<span class="_ _15"> </span>of<span class="_ _14"> </span>hardware<span class="_ _15"> </span>memories<span class="_ _1"></span>,<span class="_ _21"> </span>including<span class="_ _14"> </span>several<span class="_ _15"> </span>random<span class="_ _14"> </span>access</div><div class="t m5 x28 h2b y2d2 ff7 fs1e fc2 sc0 ls0 ws0">memories<span class="_ _1"></span>,<span class="_ _16"> </span>plus<span class="_ _11"> </span>nonvolatile<span class="_ _16"> </span>memory<span class="_ _16"> </span>or<span class="_ _11"> </span>magnetic<span class="_ _16"> </span>disk,<span class="_ _16"> </span>as<span class="_ _11"> </span>well<span class="_ _16"> </span>as<span class="_ _11"> </span>a<span class="_ _16"> </span>variety<span class="_ _11"> </span>of<span class="_ _16"> </span>hardware<span class="_ _11"> </span>and<span class="_ _16"> </span>software</div><div class="t m5 x28 h2b y2d3 ff7 fs1e fc2 sc0 ls0 ws0">mechanisms<span class="_ _14"> </span>for<span class="_ _15"> </span>managing<span class="_ _14"> </span>these<span class="_ _15"> </span>devices<span class="_ _1"></span>.<span class="_ _14"> </span>The<span class="_ _16"> </span>design<span class="_ _15"> </span>and<span class="_ _14"> </span>characteristics<span class="_ _15"> </span>of<span class="_ _14"> </span>the<span class="_ _15"> </span>memory<span class="_ _14"> </span>system<span class="_ _15"> </span>are</div><div class="t m5 x28 h2b y2d4 ff7 fs1e fc2 sc0 ls0 ws0">described<span class="_"> </span>in<span class="_"> </span>Chapter<span class="_"> </span>6.</div><div class="t m5 x57 h2b y2d5 ff7 fs1e fc2 sc0 ls0 ws0">Nonetheless<span class="_ _1"></span>,<span class="_ _11"> </span>our<span class="_ _11"> </span>simple<span class="_ _11"> </span>memory<span class="_ _11"> </span>design<span class="_ _11"> </span>can<span class="_ _10"> </span>be<span class="_ _11"> </span>used<span class="_ _11"> </span>for<span class="_ _11"> </span>smaller<span class="_ _11"> </span>systems<span class="_ _1"></span>,<span class="_ _11"> </span>and<span class="_ _11"> </span>it<span class="_ _11"> </span>provides<span class="_ _11"> </span>us<span class="_ _11"> </span>with</div><div class="t m5 x28 h2b y2d6 ff7 fs1e fc2 sc0 ls0 ws0">an<span class="_"> </span>abstraction<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>interface<span class="_"> </span>between<span class="_"> </span>the<span class="_"> </span>processor<span class="_"> </span>and<span class="_"> </span>memory<span class="_"> </span>for<span class="_"> </span>more<span class="_"> </span>complex<span class="_"> </span>systems<span class="_ _1"></span>.</div><div class="t m5 x29 h26 y3a7b ff7 fs19 fc2 sc0 ls0 ws0">Our<span class="_"> </span>processor<span class="_ _11"> </span>includes<span class="_ _11"> </span>an<span class="_ _11"> </span>additional<span class="_ _11"> </span>read-only<span class="_"> </span>memory<span class="_ _11"> </span>for<span class="_ _11"> </span>reading<span class="_ _11"> </span>instruc-</div><div class="t m5 x1d h26 y3a7c ff7 fs19 fc2 sc0 ls0 ws0">tions<span class="_ _1"></span>.<span class="_ _16"> </span>In<span class="_ _16"> </span>most<span class="_ _16"> </span>actual<span class="_ _11"> </span>systems<span class="_ _1"></span>,<span class="_ _14"> </span>these<span class="_ _16"> </span>memories<span class="_ _16"> </span>are<span class="_ _16"> </span>merged<span class="_ _11"> </span>into<span class="_ _16"> </span>a<span class="_ _16"> </span>single<span class="_ _16"> </span>memory</div><div class="t m5 x1d h26 y3a7d ff7 fs19 fc2 sc0 ls0 ws0">with<span class="_ _14"> </span>two<span class="_ _14"> </span>ports:<span class="_ _14"> </span>one<span class="_ _14"> </span>for<span class="_ _14"> </span>reading<span class="_ _14"> </span>instructions<span class="_ _1"></span>,<span class="_ _15"> </span>and<span class="_ _14"> </span>the<span class="_ _14"> </span>other<span class="_ _14"> </span>for<span class="_ _14"> </span>reading<span class="_ _14"> </span>or<span class="_ _14"> </span>writ-</div><div class="t m5 x1d h26 y3a7e ff7 fs19 fc2 sc0 ls0 ws0">ing<span class="_"> </span>data.</div><div class="t m5 x1d h3b y3a7f fff fs24 fc6 sc0 ls0 ws0">4.3<span class="_ _17"> </span><span class="ffe fs18">Sequential<span class="_"> </span>Y86-64<span class="_"> </span>Implementations</span></div><div class="t m5 x1d h26 y3a80 ff7 fs19 fc1 sc0 ls0 ws0">Now<span class="_ _6"> </span>we<span class="_ _6"> </span>have<span class="_ _13"> </span>the<span class="_ _a"> </span>components<span class="_ _13"> </span>required<span class="_ _a"> </span>to<span class="_ _13"> </span>implement<span class="_ _a"> </span>a<span class="_ _13"> </span>Y86-64<span class="_ _6"> </span>processor.<span class="_ _a"> </span>As<span class="_ _13"> </span>a<span class="_ _a"> </span>ﬁrst</div><div class="t m5 x1d h26 y3a81 ff7 fs19 fc1 sc0 ls0 ws0">step<span class="_ _1"></span>,<span class="_ _16"> </span>we<span class="_ _16"> </span>describe<span class="_ _16"> </span>a<span class="_ _11"> </span>processor<span class="_ _16"> </span>called<span class="_ _16"> </span>SEQ<span class="_ _11"> </span>(for<span class="_ _16"> </span>“sequential”<span class="_ _16"> </span>processor).<span class="_ _11"> </span>On<span class="_ _16"> </span>each</div><div class="t m5 x1d h26 y3a82 ff7 fs19 fc1 sc0 ls0 ws0">clock<span class="_ _13"> </span>c<span class="_ _1"></span>ycle,<span class="_ _13"> </span>SEQ<span class="_ _6"> </span>performs<span class="_ _13"> </span>all<span class="_ _13"> </span>the<span class="_ _6"> </span>steps<span class="_ _13"> </span>required<span class="_ _13"> </span>to<span class="_ _13"> </span>process<span class="_ _6"> </span>a<span class="_ _13"> </span>complete<span class="_ _13"> </span>instruction.</div><div class="t m5 x1d h26 y3a83 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _13"> </span>would<span class="_ _13"> </span>require<span class="_ _13"> </span>a<span class="_ _13"> </span>very<span class="_ _13"> </span>long<span class="_ _6"> </span>cycle<span class="_ _13"> </span>time<span class="_ _1"></span>,<span class="_ _13"> </span>however,<span class="_ _13"> </span>and<span class="_ _13"> </span>so<span class="_ _13"> </span>the<span class="_ _13"> </span>clock<span class="_ _6"> </span>rate<span class="_ _13"> </span>would<span class="_ _13"> </span>be</div><div class="t m5 x1d h26 y3a84 ff7 fs19 fc1 sc0 ls0 ws0">unacceptably<span class="_ _13"> </span>low<span class="_ _3"></span>.<span class="_ _13"> </span>Our<span class="_ _13"> </span>purpose<span class="_ _6"> </span>in<span class="_ _13"> </span>developing<span class="_ _13"> </span>SEQ<span class="_ _13"> </span>is<span class="_ _6"> </span>to<span class="_ _13"> </span>provide<span class="_ _13"> </span>a<span class="_ _13"> </span>ﬁrst<span class="_ _6"> </span>step<span class="_ _13"> </span>toward</div><div class="t m5 x1d h26 y3a85 ff7 fs19 fc1 sc0 ls0 ws0">our<span class="_"> </span>ultimate<span class="_"> </span>goal<span class="_"> </span>of<span class="_"> </span>implementing<span class="_"> </span>an<span class="_"> </span>efﬁcient<span class="_"> </span>pipelined<span class="_"> </span>processor.</div><div class="t m5 x1d h41 y3a86 ffe fs29 fc1 sc0 ls0 ws0">4.3.1<span class="_ _48"> </span><span class="fs19">Organizing<span class="_"> </span>Processing<span class="_"> </span>into<span class="_"> </span>Stages</span></div><div class="t m5 x1d h26 y3a87 ff7 fs19 fc1 sc0 ls0 ws0">In<span class="_ _6"> </span>general,<span class="_ _13"> </span>processing<span class="_ _6"> </span>an<span class="_ _6"> </span>instruction<span class="_ _13"> </span>involves<span class="_ _a"> </span>a<span class="_ _13"> </span>number<span class="_ _a"> </span>of<span class="_ _13"> </span>operations<span class="_ _3"></span>.<span class="_ _13"> </span>W<span class="_ _3"></span>e<span class="_ _6"> </span>organize</div><div class="t m5 x1d h26 y3a88 ff7 fs19 fc1 sc0 ls0 ws0">them<span class="_ _13"> </span>in<span class="_ _13"> </span>a<span class="_ _13"> </span>particular<span class="_"> </span>sequence<span class="_ _13"> </span>of<span class="_ _13"> </span>stages<span class="_ _3"></span>,<span class="_"> </span>attempting<span class="_ _13"> </span>to<span class="_ _13"> </span>make<span class="_ _13"> </span>all<span class="_ _13"> </span>instructions<span class="_ _13"> </span>follow</div><div class="t m5 x1d h26 y3a89 ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_ _16"> </span>uniform<span class="_ _16"> </span>sequence<span class="_ _1"></span>,<span class="_ _14"> </span>even<span class="_ _16"> </span>though<span class="_ _16"> </span>the<span class="_ _16"> </span>instructions<span class="_ _16"> </span>differ<span class="_ _16"> </span>greatly<span class="_ _16"> </span>in<span class="_ _16"> </span>their<span class="_ _16"> </span>actions<span class="_ _1"></span>.</div><div class="t m5 x1d h26 y3a8a ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _11"> </span>detailed<span class="_ _11"> </span>processing<span class="_ _11"> </span>at<span class="_ _11"> </span>each<span class="_ _16"> </span>step<span class="_"> </span>depends<span class="_ _11"> </span>on<span class="_ _11"> </span>the<span class="_ _11"> </span>particular<span class="_ _11"> </span>instruction<span class="_ _11"> </span>being</div><div class="t m5 x1d h26 y3a8b ff7 fs19 fc1 sc0 ls0 ws0">executed.<span class="_"> </span>Creating<span class="_"> </span>this<span class="_ _13"> </span>framework<span class="_"> </span>will<span class="_"> </span>allow<span class="_"> </span>us<span class="_"> </span>to<span class="_ _13"> </span>design<span class="_"> </span>a<span class="_"> </span>processor<span class="_"> </span>that<span class="_"> </span>makes</div><div class="t m5 x1d h26 y3a8c ff7 fs19 fc1 sc0 ls0 ws0">best<span class="_ _16"> </span>use<span class="_ _16"> </span>of<span class="_ _16"> </span>the<span class="_ _16"> </span>hardware<span class="_ _1"></span>.<span class="_ _16"> </span>T<span class="_ _0"></span>he<span class="_ _16"> </span>following<span class="_ _16"> </span>is<span class="_ _16"> </span>an<span class="_ _16"> </span>informal<span class="_ _16"> </span>description<span class="_ _16"> </span>of<span class="_ _11"> </span>the<span class="_ _16"> </span>stages</div><div class="t m5 x1d h26 y3a8d ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_"> </span>the<span class="_"> </span>operations<span class="_"> </span>performed<span class="_"> </span>within<span class="_"> </span>them:</div><div class="t m5 x75 h26 y3a8e ffa fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>etch.<span class="_ _15"> </span><span class="ff7">The<span class="_ _14"> </span>fetch<span class="_ _14"> </span>stage<span class="_ _15"> </span>reads<span class="_ _15"> </span>the<span class="_ _14"> </span>bytes<span class="_ _15"> </span>of<span class="_ _15"> </span>an<span class="_ _14"> </span>instruction<span class="_ _15"> </span>from<span class="_ _15"> </span>memory<span class="_ _3"></span>,<span class="_ _15"> </span>using</span></div><div class="t m5 xcd h26 y3a8f ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _11"> </span>program<span class="_ _11"> </span>counter<span class="_ _16"> </span>(PC)<span class="_ _11"> </span>as<span class="_ _11"> </span>the<span class="_ _16"> </span>memory<span class="_"> </span>address<span class="_ _0"></span>.<span class="_ _11"> </span>F<span class="_ _0"></span>rom<span class="_ _11"> </span>the<span class="_ _11"> </span>instruction</div><div class="t m5 xcd h26 y3a90 ff7 fs19 fc1 sc0 ls0 ws0">it<span class="_ _13"> </span>extracts<span class="_"> </span>the<span class="_ _13"> </span>two<span class="_ _13"> </span>4-bit<span class="_"> </span>portions<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>instruction<span class="_"> </span>speciﬁer<span class="_ _13"> </span>byte<span class="_ _1"></span>,<span class="_"> </span>referred</div><div class="t m5 xcd h26 y3a91 ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_ _16"> </span>as<span class="_ _16"> </span><span class="ff6">icode<span class="_ _16"> </span></span>(the<span class="_ _11"> </span>instruction<span class="_ _16"> </span>code)<span class="_ _16"> </span>and<span class="_ _16"> </span><span class="ff6">ifun<span class="_ _16"> </span></span>(the<span class="_ _16"> </span>instruction<span class="_ _16"> </span>function).<span class="_ _16"> </span>It</div><div class="t m5 xcd h26 y3a92 ff7 fs19 fc1 sc0 ls0 ws0">possibly<span class="_ _13"> </span>fetches<span class="_ _13"> </span>a<span class="_ _13"> </span>register<span class="_ _13"> </span>speciﬁer<span class="_ _13"> </span>byte<span class="_ _0"></span>,<span class="_ _13"> </span>giving<span class="_ _13"> </span>one<span class="_ _13"> </span>or<span class="_ _13"> </span>both<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>register</div><div class="t m5 xcd h26 y3a93 ff7 fs19 fc1 sc0 ls0 ws0">operand<span class="_ _16"> </span>speciﬁers<span class="_ _16"> </span><span class="ff6">rA<span class="_ _11"> </span></span>and<span class="_ _16"> </span><span class="ff6">rB</span>.<span class="_ _16"> </span>It<span class="_ _16"> </span>also<span class="_ _16"> </span>possibly<span class="_ _16"> </span>fetches<span class="_ _11"> </span>an<span class="_ _16"> </span>8-byte<span class="_ _16"> </span>constant</div><div class="t m5 xcd h26 y3a94 ff7 fs19 fc1 sc0 ls0 ws0">word<span class="_ _13"> </span><span class="ff6">valC</span>.<span class="_ _13"> </span>It<span class="_"> </span>computes<span class="_ _13"> </span><span class="ff6">valP<span class="_ _13"> </span></span>to<span class="_ _13"> </span>be<span class="_"> </span>the<span class="_ _13"> </span>address<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_"> </span>instruction<span class="_ _13"> </span>following</div><div class="t m5 xcd h26 y3a95 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _11"> </span>current<span class="_ _11"> </span>one<span class="_ _11"> </span>in<span class="_ _16"> </span>sequential<span class="_ _11"> </span>order.<span class="_"> </span>That<span class="_"> </span>is<span class="_ _1"></span>,<span class="_ _16"> </span><span class="ff6">valP<span class="_ _11"> </span></span>equals<span class="_ _11"> </span>the<span class="_ _11"> </span>value<span class="_ _16"> </span>of<span class="_"> </span>the</div><div class="t m5 xcd h26 y3a96 ff7 fs19 fc1 sc0 ls0 ws0">PC<span class="_"> </span>plus<span class="_"> </span>the<span class="_"> </span>length<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>fetched<span class="_"> </span>instruction.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
