<div id="pf1ff" class="pf w2 h11" data-page-no="1ff"><div class="pc pc1ff w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1ff.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">510<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>4<span class="_ _3d"> </span>Processor<span class="_ _10"> </span>Architecture</span></div><div class="t m5 x75 h2d ye7 ffd fs1e fc2 sc0 ls0 ws0">movq<span class="_ _e"> </span>(%rsp),<span class="_ _1f"> </span><span class="ff13">REG<span class="_ _6f"> </span><span class="fs35 fc6">Read<span class="_ _f"> </span>REG<span class="_ _e"> </span>from<span class="_ _21"> </span>stack</span></span></div><div class="t m5 x75 h2d yc4d ffd fs1e fc2 sc0 ls0 ws0">addq<span class="_ _e"> </span>$8,%rsp<span class="_ _6b"> </span><span class="ff13 fs35 fc6">Increment<span class="_ _f"> </span>stack<span class="_ _e"> </span>pointer</span></div><div class="t m5 x124 h26 y46a7 ff7 fs19 fc2 sc0 ls0 ws0">A.<span class="_ _1f"> </span>In<span class="_ _16"> </span>light<span class="_ _16"> </span>of<span class="_ _16"> </span>analysis<span class="_ _14"> </span>done<span class="_ _16"> </span>in<span class="_ _16"> </span>Practice<span class="_ _16"> </span>Problem<span class="_ _14"> </span>4.8,<span class="_ _14"> </span>does<span class="_ _16"> </span>this<span class="_ _16"> </span>code<span class="_ _16"> </span>sequence</div><div class="t m5 x4f h26 y46a8 ff7 fs19 fc2 sc0 ls0 ws0">correctly<span class="_"> </span>describe<span class="_"> </span>the<span class="_"> </span>behavior<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>instruction<span class="_"> </span><span class="ffd">popq<span class="_ _11"> </span>%rsp</span>?<span class="_"> </span>Explain.</div><div class="t m5 x124 h26 y46a9 ff7 fs19 fc2 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>How<span class="_"> </span>could<span class="_ _13"> </span>you<span class="_ _13"> </span>rewrite<span class="_"> </span>the<span class="_ _13"> </span>code<span class="_ _13"> </span>sequence<span class="_"> </span>so<span class="_ _13"> </span>that<span class="_"> </span>it<span class="_ _13"> </span>correctly<span class="_ _13"> </span>describes<span class="_"> </span>both</div><div class="t m5 x4f h26 y46aa ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span>cases<span class="_"> </span>where<span class="_"> </span><span class="ff13">REG<span class="_ _10"> </span></span>is<span class="_"> </span><span class="ffd">%rsp<span class="_ _10"> </span></span>as<span class="_"> </span>well<span class="_"> </span>as<span class="_"> </span>any<span class="_"> </span>other<span class="_"> </span>register?</div><div class="t m5 x1d h73 y46ab ffe fs1e fc6 sc0 ls0 ws0">4.47<span class="_ _23"> </span><span class="ff10 fs19">◆◆◆</span></div><div class="t m5 x1d h26 y46ac ff7 fs19 fc1 sc0 ls0 ws0">Y<span class="_ _3"></span>our<span class="_ _16"> </span>assignment<span class="_ _16"> </span>will<span class="_ _16"> </span>be<span class="_ _16"> </span>to<span class="_ _16"> </span>write<span class="_ _14"> </span>a<span class="_ _16"> </span>Y86-64<span class="_ _16"> </span>program<span class="_ _16"> </span>to<span class="_ _16"> </span>perform<span class="_ _14"> </span>bubblesort.<span class="_ _16"> </span>F<span class="_ _1"></span>or</div><div class="t m5 x1d h26 y46ad ff7 fs19 fc1 sc0 ls0 ws0">reference<span class="_ _1"></span>,<span class="_ _1f"> </span>the<span class="_ _21"> </span>following<span class="_ _e"> </span>C<span class="_ _21"> </span>function<span class="_ _e"> </span>implements<span class="_ _21"> </span>bubblesort<span class="_ _e"> </span>using<span class="_ _21"> </span>array<span class="_ _e"> </span>refer-</div><div class="t m5 x1d h26 y46ae ff7 fs19 fc1 sc0 ls0 ws0">encing:</div><div class="t m5 x1f h2d y46af ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">/*<span class="_ _1f"> </span>Bubble<span class="_ _e"> </span>sort:<span class="_ _1f"> </span>Array<span class="_ _1f"> </span>version<span class="_ _e"> </span>*/</span></div><div class="t m5 x1f h2d y46b0 ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _1c"> </span><span class="ffd fs1e fc2">void<span class="_ _1f"> </span>bubble_a(long<span class="_ _e"> </span>*data,<span class="_ _1f"> </span>long<span class="_ _1f"> </span>count)<span class="_ _e"> </span>{</span></div><div class="t m5 x1f h2d y46b1 ff6 fs20 fc6 sc0 ls0 ws0">3<span class="_ _20"> </span><span class="ffd fs1e fc2">long<span class="_ _e"> </span>i,<span class="_ _1f"> </span>last;</span></div><div class="t m5 x1f h2d y46b2 ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _20"> </span><span class="ffd fs1e fc2">for<span class="_ _e"> </span>(last<span class="_ _1f"> </span>=<span class="_ _1f"> </span>count-1;<span class="_ _e"> </span>last<span class="_ _1f"> </span>&gt;<span class="_ _e"> </span>0;<span class="_ _1f"> </span>last--)<span class="_ _1f"> </span>{</span></div><div class="t m5 x1f h2d y46b3 ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _70"> </span><span class="ffd fs1e fc2">for<span class="_ _e"> </span>(i<span class="_ _1f"> </span>=<span class="_ _1f"> </span>0;<span class="_ _e"> </span>i<span class="_ _1f"> </span>&lt;<span class="_ _e"> </span>last;<span class="_ _1f"> </span>i++)</span></div><div class="t m5 x1f h2d y46b4 ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _d1"> </span><span class="ffd fs1e fc2">if<span class="_ _1f"> </span>(data[i+1]<span class="_ _e"> </span>&lt;<span class="_ _1f"> </span>data[i])<span class="_ _e"> </span>{</span></div><div class="t m5 x1f h2d y46b5 ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _143"> </span><span class="ffd fs1e fc2">/*<span class="_ _e"> </span>Swap<span class="_ _1f"> </span>adjacent<span class="_ _1f"> </span>elements<span class="_ _e"> </span>*/</span></div><div class="t m5 x1f h2e y46b6 ff6 fs20 fc6 sc0 ls0 ws0">8</div><div class="t m5 xe2 h2d y46b7 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>t<span class="_ _1f"> </span>=<span class="_ _1f"> </span>data[i+1];</div><div class="t m5 x1f h2d y220e ff6 fs20 fc6 sc0 ls0 ws0">9<span class="_ _143"> </span><span class="ffd fs1e fc2">data[i+1]<span class="_ _e"> </span>=<span class="_ _1f"> </span>data[i];</span></div><div class="t m5 x1b0 h2d y46b8 ff6 fs20 fc6 sc0 ls0 ws0">10<span class="_ _143"> </span><span class="ffd fs1e fc2">data[i]<span class="_ _e"> </span>=<span class="_ _1f"> </span>t;</span></div><div class="t m5 x1b0 h2d y46b9 ff6 fs20 fc6 sc0 ls0 ws0">11<span class="_ _d1"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x1b0 h2d y46ba ff6 fs20 fc6 sc0 ls0 ws0">12<span class="_ _20"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x1b0 h2d y46bb ff6 fs20 fc6 sc0 ls0 ws0">13<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x124 h26 y46bc ff7 fs19 fc2 sc0 ls0 ws0">A.<span class="_ _1f"> </span>Write<span class="_"> </span>and<span class="_"> </span>test<span class="_"> </span>a<span class="_ _13"> </span>C<span class="_"> </span>version<span class="_"> </span>that<span class="_"> </span>references<span class="_"> </span>the<span class="_"> </span>array<span class="_"> </span>elements<span class="_"> </span>with<span class="_"> </span>pointers<span class="_ _3"></span>,</div><div class="t m5 x4f h26 y46bd ff7 fs19 fc2 sc0 ls0 ws0">rather<span class="_"> </span>than<span class="_"> </span>using<span class="_"> </span>array<span class="_"> </span>indexing.</div><div class="t m5 x124 h26 y46be ff7 fs19 fc2 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>Write<span class="_ _16"> </span>and<span class="_ _16"> </span>test<span class="_ _16"> </span>a<span class="_ _16"> </span>Y86-64<span class="_ _16"> </span>program<span class="_ _16"> </span>consisting<span class="_ _16"> </span>of<span class="_ _16"> </span>the<span class="_ _16"> </span>function<span class="_ _16"> </span>and<span class="_ _14"> </span>test<span class="_ _16"> </span>code<span class="_ _1"></span>.</div><div class="t m5 x4f h26 y46bf ff7 fs19 fc2 sc0 ls0 ws0">Y<span class="_ _3"></span>ou<span class="_ _14"> </span>may<span class="_ _15"> </span>ﬁnd<span class="_ _14"> </span>it<span class="_ _15"> </span>useful<span class="_ _14"> </span>to<span class="_ _15"> </span>pattern<span class="_ _15"> </span>your<span class="_ _14"> </span>implementation<span class="_ _15"> </span>after<span class="_ _14"> </span>x86-64<span class="_ _15"> </span>code</div><div class="t m5 x4f h26 y46c0 ff7 fs19 fc2 sc0 ls0 ws0">generated<span class="_ _15"> </span>by<span class="_ _21"> </span>compiling<span class="_ _21"> </span>your<span class="_ _21"> </span>C<span class="_ _21"> </span>code<span class="_ _0"></span>.<span class="_ _15"> </span>Although<span class="_ _21"> </span>pointer<span class="_ _21"> </span>comparisons<span class="_ _21"> </span>are</div><div class="t m5 x4f h26 y46c1 ff7 fs19 fc2 sc0 ls0 ws0">normally<span class="_"> </span>done<span class="_"> </span>using<span class="_"> </span>unsigned<span class="_"> </span>arithmetic<span class="_ _1"></span>,<span class="_"> </span>you<span class="_"> </span>can<span class="_"> </span>use<span class="_"> </span>signed<span class="_"> </span>arithmetic<span class="_"> </span>for</div><div class="t m5 x4f h26 y46c2 ff7 fs19 fc2 sc0 ls0 ws0">this<span class="_"> </span>exercise<span class="_ _1"></span>.</div><div class="t m5 x1d h73 y46c3 ffe fs1e fc6 sc0 ls0 ws0">4.48<span class="_ _23"> </span><span class="ff10 fs19">◆◆</span></div><div class="t m5 x1d h26 y46c4 ff7 fs19 fc1 sc0 ls0 ws0">Modify<span class="_ _11"> </span>the<span class="_ _16"> </span>code<span class="_ _16"> </span>you<span class="_ _11"> </span>wrote<span class="_ _16"> </span>for<span class="_ _16"> </span>Problem<span class="_ _11"> </span>4.47<span class="_ _16"> </span>to<span class="_ _16"> </span>implement<span class="_ _11"> </span>the<span class="_ _16"> </span>test<span class="_ _16"> </span>and<span class="_ _11"> </span>swap<span class="_ _16"> </span>in</div><div class="t m5 x1d h26 y46c5 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _13"> </span>bubblesort<span class="_"> </span>function<span class="_ _13"> </span>(lines<span class="_"> </span>6–11)<span class="_ _13"> </span>using<span class="_ _13"> </span>no<span class="_"> </span>jumps<span class="_ _13"> </span>and<span class="_ _13"> </span>at<span class="_"> </span>most<span class="_ _13"> </span>three<span class="_"> </span>conditional</div><div class="t m5 x1d h26 y46c6 ff7 fs19 fc1 sc0 ls0 ws0">moves<span class="_ _1"></span>.</div><div class="t m5 x1d h73 y46c7 ffe fs1e fc6 sc0 ls0 ws0">4.49<span class="_ _23"> </span><span class="ff10 fs19">◆◆◆</span></div><div class="t m5 x1d h26 y46c8 ff7 fs19 fc1 sc0 ls0 ws0">Modify<span class="_ _13"> </span>the<span class="_ _13"> </span>code<span class="_ _6"> </span>you<span class="_ _13"> </span>wrote<span class="_ _13"> </span>for<span class="_ _13"> </span>Problem<span class="_ _6"> </span>4.47<span class="_ _13"> </span>to<span class="_ _13"> </span>implement<span class="_ _13"> </span>the<span class="_ _6"> </span>test<span class="_ _13"> </span>and<span class="_ _13"> </span>swap<span class="_ _13"> </span>in<span class="_ _6"> </span>the</div><div class="t m5 x1d h26 y46c9 ff7 fs19 fc1 sc0 ls0 ws0">bubblesort<span class="_"> </span>function<span class="_"> </span>(lines<span class="_"> </span>6–11)<span class="_"> </span>using<span class="_"> </span>no<span class="_"> </span>jumps<span class="_"> </span>and<span class="_"> </span>just<span class="_"> </span>one<span class="_"> </span>conditional<span class="_"> </span>move<span class="_ _1"></span>.</div><div class="t m5 x1d h73 y7a6 ffe fs1e fc6 sc0 ls0 ws0">4.50<span class="_ _23"> </span><span class="ff10 fs19">◆◆◆</span></div><div class="t m5 x1d h26 y7a7 ff7 fs19 fc1 sc0 ls0 ws0">In<span class="_ _13"> </span>Section<span class="_ _13"> </span>3.6.8,<span class="_"> </span>we<span class="_ _13"> </span>saw<span class="_ _13"> </span>that<span class="_ _13"> </span>a<span class="_ _13"> </span>common<span class="_ _13"> </span>way<span class="_ _13"> </span>to<span class="_ _13"> </span>implement<span class="_"> </span><span class="ffd">switch<span class="_ _13"> </span></span>statements<span class="_ _13"> </span>is<span class="_ _13"> </span>to</div><div class="t m5 x1d h26 y7a8 ff7 fs19 fc1 sc0 ls0 ws0">create<span class="_ _6"> </span>a<span class="_ _6"> </span>set<span class="_ _6"> </span>of<span class="_ _6"> </span>code<span class="_ _6"> </span>blocks<span class="_ _6"> </span>and<span class="_ _6"> </span>then<span class="_ _6"> </span>index<span class="_ _6"> </span>those<span class="_ _6"> </span>blocks<span class="_ _6"> </span>using<span class="_ _13"> </span>a<span class="_ _a"> </span>jump<span class="_ _6"> </span>table<span class="_ _0"></span>.<span class="_ _6"> </span>Consider</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
