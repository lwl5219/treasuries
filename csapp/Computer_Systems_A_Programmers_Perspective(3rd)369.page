<div id="pf171" class="pf w2 h11" data-page-no="171"><div class="pc pc171 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg171.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">368<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>3<span class="_ _3d"> </span>Machine-Level<span class="_ _10"> </span>Representation<span class="_ _10"> </span>of<span class="_ _10"> </span>Programs</span></div><div class="t m5 x4f h2d ye7 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>gotodiff_se_alt(long<span class="_ _1f"> </span>x,<span class="_ _1f"> </span>long<span class="_ _e"> </span>y)<span class="_ _1f"> </span>{</div><div class="t m5 x33 h2d y2682 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>result;</div><div class="t m5 x33 h2d y2683 ffd fs1e fc2 sc0 ls0 ws0">if<span class="_ _e"> </span>(x<span class="_ _1f"> </span>&lt;<span class="_ _1f"> </span>y)</div><div class="t m5 xf7 h2d y2684 ffd fs1e fc2 sc0 ls0 ws0">goto<span class="_ _e"> </span>x_lt_y;</div><div class="t m5 x33 h2d y2685 ffd fs1e fc2 sc0 ls0 ws0">ge_cnt++;</div><div class="t m5 x33 h2d y2686 ffd fs1e fc2 sc0 ls0 ws0">resul<span class="ls33">t=x-y<span class="_ _41"></span>;</span></div><div class="t m5 x33 h2d y2687 ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>result;</div><div class="t m5 xc2 h2d y2688 ffd fs1e fc2 sc0 ls0 ws0">x_lt_y:</div><div class="t m5 x33 h2d y2689 ffd fs1e fc2 sc0 ls0 ws0">lt_cnt++;</div><div class="t m5 x33 h2d y268a ffd fs1e fc2 sc0 ls0 ws0">result<span class="_ _e"> </span>=<span class="_ _1a"> </span>y<span class="_ _1f"> </span>-<span class="_ _1f"> </span>x;</div><div class="t m5 x33 h2d y268b ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>result;</div><div class="t m5 x4f h2d y268c ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x124 h26 y33c1 ff7 fs19 fc2 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>In<span class="_ _16"> </span>most<span class="_ _11"> </span>respects<span class="_ _1"></span>,<span class="_ _16"> </span>the<span class="_ _11"> </span>choice<span class="_ _16"> </span>is<span class="_ _11"> </span>arbitrary<span class="_ _3"></span>.<span class="_ _16"> </span>But<span class="_ _11"> </span>the<span class="_ _16"> </span>original<span class="_ _11"> </span>rule<span class="_ _11"> </span>works<span class="_ _16"> </span>better</div><div class="t m5 x4f h26 y33c2 ff7 fs19 fc2 sc0 ls0 ws0">for<span class="_ _13"> </span>the<span class="_ _13"> </span>common<span class="_"> </span>case<span class="_ _13"> </span>where<span class="_ _13"> </span>there<span class="_ _13"> </span>is<span class="_ _13"> </span>no<span class="_"> </span><span class="ffd">else<span class="_ _13"> </span></span>statement.<span class="_ _13"> </span>F<span class="_ _1"></span>or<span class="_ _13"> </span>this<span class="_ _13"> </span>case,<span class="_ _13"> </span>we<span class="_ _13"> </span>can</div><div class="t m5 x4f h26 y33c3 ff7 fs19 fc2 sc0 ls0 ws0">simply<span class="_"> </span>modify<span class="_"> </span>the<span class="_"> </span>translation<span class="_"> </span>rule<span class="_"> </span>to<span class="_"> </span>be<span class="_"> </span>as<span class="_"> </span>follows:</div><div class="t m5 x33 h53 y33c4 ffd fs1e fc2 sc0 ls33 ws0">t=<span class="ffa ls0">test-expr<span class="_ _2"></span><span class="ffd">;</span></span></div><div class="t m5 x33 h2d y33c5 ffd fs1e fc2 sc0 ls0 ws0">if<span class="_ _e"> </span>(!t)</div><div class="t m5 xf7 h2d y33c6 ffd fs1e fc2 sc0 ls0 ws0">goto<span class="_ _e"> </span>done;</div><div class="t m5 x33 h53 y33c7 ffa fs1e fc2 sc0 ls0 ws0">then-statement</div><div class="t m5 x4f h2d y33c8 ffd fs1e fc2 sc0 ls0 ws0">done:</div><div class="t m5 x4f h26 y33c9 ff7 fs19 fc2 sc0 ls0 ws0">A<span class="_"> </span>translation<span class="_"> </span>based<span class="_"> </span>on<span class="_"> </span>the<span class="_"> </span>alternate<span class="_"> </span>rule<span class="_"> </span>is<span class="_"> </span>more<span class="_"> </span>cumbersome<span class="_ _1"></span>.</div><div class="t m5 x1d h28 y33ca ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>3.18<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>249)</span></div><div class="t m5 x1d h26 y33cb ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _14"> </span>problem<span class="_ _16"> </span>requires<span class="_ _16"> </span>that<span class="_ _14"> </span>you<span class="_ _16"> </span>work<span class="_ _14"> </span>through<span class="_ _16"> </span>a<span class="_ _16"> </span>nested<span class="_ _14"> </span>branch<span class="_ _16"> </span>structure,<span class="_ _16"> </span>where</div><div class="t m5 x1d h26 y33cc ff7 fs19 fc1 sc0 ls0 ws0">you<span class="_"> </span>will<span class="_ _11"> </span>see<span class="_ _11"> </span>how<span class="_"> </span>our<span class="_ _11"> </span>rule<span class="_ _11"> </span>for<span class="_ _11"> </span>translating<span class="_"> </span><span class="ffd">if<span class="_ _11"> </span></span>statements<span class="_ _11"> </span>has<span class="_ _11"> </span>been<span class="_"> </span>applied.<span class="_ _11"> </span>On<span class="_ _11"> </span>the</div><div class="t m5 x1d h26 y33cd ff7 fs19 fc1 sc0 ls0 ws0">whole<span class="_ _1"></span>,<span class="_"> </span>the<span class="_"> </span>machine<span class="_"> </span>code<span class="_"> </span>is<span class="_"> </span>a<span class="_"> </span>straightforward<span class="_"> </span>translation<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>C<span class="_"> </span>code.</div><div class="t m5 x1d h2d y33ce ffd fs1e fc2 sc0 ls0 ws0">short<span class="_ _e"> </span>test(short<span class="_ _1f"> </span>x,<span class="_ _1f"> </span>short<span class="_ _e"> </span>y,<span class="_ _1f"> </span>short<span class="_ _e"> </span>z)<span class="_ _1f"> </span>{</div><div class="t m5 x10c h2d y33cf ffd fs1e fc2 sc0 ls0 ws0">short<span class="_ _e"> </span>val<span class="_ _1f"> </span>=<span class="_ _1f"> </span>z+y-x;</div><div class="t m5 x10c h2d y33d0 ffd fs1e fc2 sc0 ls33 ws0">i<span class="_ _41"></span>f(<span class="_ _41"></span>z&gt;5<span class="_ _41"></span>){</div><div class="t m5 x22b h2d y33d1 ffd fs1e fc2 sc0 ls0 ws0">if<span class="_ _e"> </span>(y<span class="_ _1f"> </span>&gt;<span class="_ _1f"> </span>2)</div><div class="t m5 x218 h2d y33d2 ffd fs1e fc2 sc0 ls0 ws0">val<span class="_ _e"> </span>=<span class="_ _1f"> </span>x/z;</div><div class="t m5 x22b h2d y33d3 ffd fs1e fc2 sc0 ls0 ws0">else</div><div class="t m5 x218 h2d y33d4 ffd fs1e fc2 sc0 ls0 ws0">val<span class="_ _e"> </span>=<span class="_ _1f"> </span>x/y;</div><div class="t m5 x10c h2d y33d5 ffd fs1e fc2 sc0 ls0 ws0">}<span class="_ _e"> </span>else<span class="_ _1f"> </span>if<span class="_ _1f"> </span>(z<span class="_ _e"> </span>&lt;<span class="_ _1f"> </span>3)</div><div class="t m5 x22b h2d y33d6 ffd fs1e fc2 sc0 ls0 ws0">val<span class="_ _e"> </span>=<span class="_ _1f"> </span>z/y;</div><div class="t m5 x10c h2d y33d7 ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>val;</div><div class="t m5 x1d h2d y33d8 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x1d h28 y33d9 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>3.19</div><div class="t m5 xe1 h2f y33da ffe fs16 fc6 sc0 ls0 ws0">(page<span class="_"> </span>252)</div><div class="t m5 x1d h26 y131f ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_"> </span>problem<span class="_"> </span>reinforces<span class="_"> </span>our<span class="_"> </span>method<span class="_"> </span>of<span class="_"> </span>computing<span class="_"> </span>the<span class="_"> </span>misprediction<span class="_"> </span>penalty<span class="_ _3"></span>.</div><div class="t m5 x124 h26 y547 ff7 fs19 fc1 sc0 ls0 ws0">A.<span class="_ _1f"> </span>W<span class="_ _3"></span>e<span class="_"> </span>can<span class="_"> </span>apply<span class="_"> </span>our<span class="_"> </span>formula<span class="_"> </span>directly<span class="_"> </span>to<span class="_"> </span>get<span class="_"> </span><span class="ff11">T</span></div><div class="t m5 xe8 h3c y1574 ff7 fs25 fc1 sc0 ls0 ws0">MP</div><div class="t m5 x6b h46 ye95 ff12 fs19 fc1 sc0 ls0 ws0">=<span class="_ _13"> </span><span class="ff7">2<span class="_ _2"></span><span class="ff11">(</span>45<span class="_ _13"> </span></span>âˆ’<span class="_ _13"></span><span class="ff7">25<span class="ff11">)<span class="_ _13"> </span></span></span>=<span class="_ _10"> </span><span class="ff7 ls24">40.</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
