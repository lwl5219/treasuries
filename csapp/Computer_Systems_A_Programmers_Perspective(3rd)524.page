<div id="pf20c" class="pf w2 h11" data-page-no="20c"><div class="pc pc20c w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg20c.png"/><div class="t m5 x107 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Solutions<span class="_ _10"> </span>to<span class="_ _10"> </span>Practice<span class="_ _10"> </span>Problems<span class="_ _1b"> </span><span class="ffe fs1e">523</span></div><div class="t m5 x17 h31 y4885 ff7 fs21 fc2 sc0 ls0 ws0">Stage<span class="_ _55"> </span><span class="ffd fs1e">cmovXX<span class="_ _11"> </span></span><span class="ff6">rA<span class="ffd fs1e">,<span class="_ _11"> </span></span>rB</span></div><div class="t m5 x17 h32 y4886 ff7 fs21 fc2 sc0 ls0 ws0">Execute<span class="_ _f4"> </span><span class="ff6">valE<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span></span>0<span class="_"> </span><span class="ff12">+<span class="_ _13"> </span><span class="ff6">valA</span></span></div><div class="t m5 x75 h32 y4887 ff6 fs21 fc2 sc0 ls0 ws0">Cnd<span class="_ _23"> </span><span class="ff12">←<span class="_ _23"> </span></span>Cond<span class="ff11">(</span>CC<span class="ff11">,<span class="_ _13"> </span></span>ifun<span class="_ _1"></span><span class="ff11">)</span></div><div class="t m5 x17 h31 y4888 ff7 fs21 fc2 sc0 ls0 ws0">Memory</div><div class="t m5 x17 h31 y4889 ff7 fs21 fc2 sc0 ls0 ws0">Write<span class="_"> </span>back</div><div class="t m5 x75 h32 y488a ffd fs1e fc2 sc0 ls0 ws0">if<span class="_ _11"> </span>(<span class="ff6 fs21">Cnd</span>)<span class="_ _10"> </span><span class="ff6 fs21">R<span class="ff7">[</span>rB<span class="ff7">]<span class="_ _22"> </span><span class="ff12">←<span class="_ _25"> </span></span></span>valE</span></div><div class="t m5 x17 h32 y488b ff7 fs21 fc2 sc0 ls0 ws0">PC<span class="_"> </span>update<span class="_ _45"> </span><span class="ff6">PC<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>valP</span></div><div class="t m5 x17 h28 y488c ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>4.18<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>430)</span></div><div class="t m5 x17 h26 y488d ff7 fs19 fc1 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_ _16"> </span>can<span class="_ _16"> </span>see<span class="_ _16"> </span>that<span class="_ _14"> </span>this<span class="_ _16"> </span>instruction<span class="_ _16"> </span>is<span class="_ _16"> </span>located<span class="_ _16"> </span>at<span class="_ _16"> </span>address<span class="_ _14"> </span><span class="ffd">0x037<span class="_ _16"> </span></span>and<span class="_ _16"> </span>is<span class="_ _16"> </span>9<span class="_ _16"> </span>bytes<span class="_ _16"> </span>long.</div><div class="t m5 x17 h26 y488e ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>ﬁrst<span class="_"> </span>byte<span class="_"> </span>has<span class="_ _13"> </span>value<span class="_"> </span><span class="ffd">0x80</span>,<span class="_"> </span>while<span class="_ _13"> </span>the<span class="_"> </span>last<span class="_"> </span>8<span class="_"> </span>bytes<span class="_ _13"> </span>are<span class="_"> </span>a<span class="_"> </span>byte-reversed<span class="_ _13"> </span>version<span class="_"> </span>of</div><div class="t m5 x17 h26 y488f ffd fs19 fc1 sc0 ls0 ws0">0x0000000000000041<span class="ff7">,<span class="_ _13"> </span>the<span class="_ _13"> </span>call<span class="_ _13"> </span>target.<span class="_ _13"> </span>T<span class="_ _1"></span>he<span class="_ _13"> </span>stack<span class="_ _13"> </span>pointer<span class="_ _13"> </span>was<span class="_ _13"> </span>set<span class="_ _13"> </span>to<span class="_ _13"> </span>128<span class="_ _13"> </span>by<span class="_ _13"> </span>the<span class="_ _13"> </span><span class="ffd">popq</span></span></div><div class="t m5 x17 h26 y4890 ff7 fs19 fc1 sc0 ls0 ws0">instruction<span class="_"> </span>(line<span class="_"> </span>7).</div><div class="t m5 x75 h31 y4891 ff7 fs21 fc2 sc0 ls0 ws0">Generic<span class="_ _15a"> </span>Speciﬁc</div><div class="t m5 x17 h31 y4892 ff7 fs21 fc2 sc0 ls0 ws0">Stage</div><div class="t m5 x75 h93 y4893 ffd fs1e fc2 sc0 ls0 ws0">call<span class="_ _11"> </span><span class="ff6 fs21">Dest<span class="_ _175"> </span></span>call<span class="_ _11"> </span>0x041</div><div class="t m5 x17 h32 y4894 ff7 fs21 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>etch<span class="_ _55"> </span><span class="ff6">icode<span class="_ _a"> </span></span>:<span class="_ _be"></span><span class="ff6">ifun<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>M</span></div><div class="t m5 x183 h33 y4895 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x10e h32 y4894 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">PC</span>]<span class="_ _74"> </span><span class="ff6">icode<span class="_ _a"> </span></span>:<span class="_ _be"></span><span class="ff6">ifun<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>M</span></div><div class="t m5 x1ad h33 y4895 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 xb0 h32 y4894 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ffd fs1e">0x037</span>]<span class="_ _6"> </span><span class="ff12">=<span class="_ _13"> </span><span class="ffd fs1e">8:0</span></span></div><div class="t m5 x75 h32 y4896 ff6 fs21 fc2 sc0 ls0 ws0">valC<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>M</div><div class="t m5 xc1 h33 y4897 ff7 fs20 fc2 sc0 ls0 ws0">8</div><div class="t m5 x20 h32 y4896 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">PC<span class="_ _13"> </span><span class="ff12">+<span class="_ _13"> </span></span></span>1]<span class="_ _2c"> </span><span class="ff6">valC<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>M</span></div><div class="t m5 x5e h33 y4897 ff7 fs20 fc2 sc0 ls0 ws0">8</div><div class="t m5 x1e2 h32 y4896 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ffd fs1e">0x038</span>]<span class="_ _6"> </span><span class="ff12">=<span class="_ _13"> </span><span class="ffd fs1e">0x041</span></span></div><div class="t m5 x75 h32 y4898 ff6 fs21 fc2 sc0 ls0 ws0">valP<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>PC<span class="_ _13"> </span><span class="ff12">+<span class="_ _13"> </span><span class="ff7">9<span class="_ _69"> </span></span></span>valP<span class="_ _25"> </span><span class="ff12">←</span></div><div class="t m5 x39 h32 y4899 ffd fs1e fc2 sc0 ls0 ws0">0x037<span class="_ _13"> </span><span class="ff12 fs21">+<span class="_ _13"> </span><span class="ff7">9<span class="_"> </span></span>=<span class="_ _13"></span></span>0x040</div><div class="t m5 x17 h31 y489a ff7 fs21 fc2 sc0 ls0 ws0">Decode</div><div class="t m5 x75 h32 y489b ff6 fs21 fc2 sc0 ls0 ws0">valB<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>R<span class="ff7">[</span></div><div class="t m5 x112 h2d y489c ffd fs1e fc2 sc0 ls0 ws0">%rsp</div><div class="t m5 xf0 h32 y489d ff7 fs21 fc2 sc0 ls0 ws0">]<span class="_ _54"> </span><span class="ff6">valB<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>R</span>[<span class="ffd fs1e">%rsp</span>]<span class="_ _6"> </span><span class="ff12">=<span class="_ _10"> </span><span class="ffd fs1e">128</span></span></div><div class="t m5 x17 h32 y489e ff7 fs21 fc2 sc0 ls0 ws0">Execute<span class="_ _f4"> </span><span class="ff6">valE<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>valB<span class="_ _13"> </span><span class="ff12 ls69">+−<span class="_ _80"></span><span class="ff7 ls0">8<span class="_ _148"> </span><span class="ff6">valE<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span><span class="ffd fs1e">128<span class="_ _10"> </span></span><span class="ls69">+−<span class="_ _4a"></span><span class="ff7 ls0">8<span class="_"> </span><span class="ff12">=<span class="_ _13"></span><span class="ffd fs1e">120</span></span></span></span></span></span></span></span></span></div><div class="t m5 x17 h31 y489f ff7 fs21 fc2 sc0 ls0 ws0">Memory<span class="_ _88"> </span><span class="ff6">M</span></div><div class="t m5 x178 h33 y48a0 ff7 fs20 fc2 sc0 ls0 ws0">8</div><div class="t m5 x13 h32 y489f ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">valE</span>]<span class="_ _22"> </span><span class="ff12">←<span class="_ _25"> </span><span class="ff6">valP<span class="_ _82"> </span>M</span></span></div><div class="t m5 x87 h33 y48a0 ff7 fs20 fc2 sc0 ls0 ws0">8</div><div class="t m5 xb8 h32 y489f ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ffd fs1e">120</span>]<span class="_ _22"> </span><span class="ff12">←<span class="_ _25"> </span><span class="ffd fs1e">0x040</span></span></div><div class="t m5 x17 h32 y48a1 ff7 fs21 fc2 sc0 ls0 ws0">Write<span class="_"> </span>back<span class="_ _4f"> </span><span class="ff6">R</span>[<span class="ffd fs1e">%rsp</span>]<span class="_ _23"> </span><span class="ff12">←<span class="_ _23"> </span><span class="ff6">valE<span class="_ _14c"> </span>R</span></span>[<span class="ffd fs1e">%rsp</span>]<span class="_ _23"> </span><span class="ff12">←<span class="_ _23"> </span><span class="ffd fs1e">120</span></span></div><div class="t m5 x17 h32 y48a2 ff7 fs21 fc2 sc0 ls0 ws0">PC<span class="_"> </span>update<span class="_ _45"> </span><span class="ff6">PC<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>valC<span class="_ _90"> </span>PC<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span><span class="ffd fs1e">0x041</span></span></span></div><div class="t m5 x26 h26 y48a3 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _11"> </span>effect<span class="_ _11"> </span>of<span class="_ _11"> </span>this<span class="_"> </span>instruction<span class="_ _11"> </span>is<span class="_ _11"> </span>to<span class="_ _11"> </span>set<span class="_"> </span><span class="ffd">%rsp<span class="_ _11"> </span></span>to<span class="_ _11"> </span>120,<span class="_ _11"> </span>to<span class="_ _11"> </span>store<span class="_ _11"> </span><span class="ffd">0x040<span class="_ _10"> </span></span>(the<span class="_ _11"> </span>return</div><div class="t m5 x17 h26 y48a4 ff7 fs19 fc2 sc0 ls0 ws0">address)<span class="_"> </span>at<span class="_"> </span>this<span class="_"> </span>memory<span class="_"> </span>address<span class="_ _1"></span>,<span class="_"> </span>and<span class="_"> </span>to<span class="_"> </span>set<span class="_"> </span>the<span class="_"> </span>PC<span class="_"> </span>to<span class="_"> </span><span class="ffd">0x041<span class="_ _10"> </span></span>(the<span class="_"> </span>call<span class="_"> </span>target).</div><div class="t m5 x17 h28 y48a5 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>4.19<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>442)</span></div><div class="t m5 x17 h26 y48a6 ff7 fs19 fc1 sc0 ls0 ws0">All<span class="_ _11"> </span>of<span class="_ _16"> </span>the<span class="_ _16"> </span>HCL<span class="_ _11"> </span>code<span class="_ _16"> </span>in<span class="_ _16"> </span>this<span class="_ _11"> </span>and<span class="_ _16"> </span>other<span class="_ _16"> </span>practice<span class="_ _11"> </span>problems<span class="_ _16"> </span>is<span class="_ _16"> </span>straightforward,<span class="_ _11"> </span>but</div><div class="t m5 x17 h26 y48a7 ff7 fs19 fc1 sc0 ls0 ws0">trying<span class="_ _11"> </span>to<span class="_ _11"> </span>generate<span class="_ _11"> </span>it<span class="_ _16"> </span>yourself<span class="_ _11"> </span>will<span class="_ _11"> </span>help<span class="_ _11"> </span>you<span class="_ _11"> </span>think<span class="_ _16"> </span>about<span class="_ _11"> </span>the<span class="_ _11"> </span>different<span class="_ _11"> </span>instructions</div><div class="t m5 x17 h26 y48a8 ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_ _16"> </span>how<span class="_ _16"> </span>they<span class="_ _16"> </span>are<span class="_ _16"> </span>processed.<span class="_ _16"> </span>F<span class="_ _1"></span>or<span class="_ _16"> </span>this<span class="_ _16"> </span>problem,<span class="_ _16"> </span>we<span class="_ _16"> </span>can<span class="_ _16"> </span>simply<span class="_ _16"> </span>look<span class="_ _16"> </span>at<span class="_ _16"> </span>the<span class="_ _16"> </span>set<span class="_ _16"> </span>of</div><div class="t m5 x17 h26 y48a9 ff7 fs19 fc1 sc0 ls0 ws0">Y86-64<span class="_"> </span>instructions<span class="_"> </span>(F<span class="_ _1"></span>igure<span class="_"> </span>4.2)<span class="_"> </span>and<span class="_"> </span>determine<span class="_"> </span>which<span class="_"> </span>have<span class="_"> </span>a<span class="_"> </span>constant<span class="_"> </span>ﬁeld.</div><div class="t m5 x17 h2d y48aa ffd fs1e fc2 sc0 ls0 ws0">bool<span class="_ _e"> </span>need_valC<span class="_ _1f"> </span>=</div><div class="t m5 x21e h2d y48ab ffd fs1e fc2 sc0 ls0 ws0">icode<span class="_ _e"> </span>in<span class="_ _1f"> </span>{<span class="_ _1f"> </span>IIRMOVQ,<span class="_ _e"> </span>IRMMOVQ,<span class="_ _1f"> </span>IMRMOVQ,<span class="_ _e"> </span>IJXX,<span class="_ _1f"> </span>ICALL<span class="_ _1f"> </span>};</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
