<div id="pf432" class="pf w2 h11" data-page-no="432"><div class="pc pc432 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg432.png"/><div class="t m5 x1a1 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Solutions<span class="_ _10"> </span>to<span class="_ _10"> </span>Practice<span class="_ _10"> </span>Problems<span class="_ _1b"> </span><span class="ffe fs1e">1073</span></div><div class="t m5 x34 h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">A.<span class="_ _1f"> </span>Here<span class="_"> </span>is<span class="_"> </span>the<span class="_"> </span>table:</div><div class="t m5 x18d h31 y855c ff7 fs21 fc2 sc0 ls0 ws0">Referenced<span class="_"> </span>by</div><div class="t m5 x2d h31 y855d ff7 fs21 fc2 sc0 ls0 ws0">V<span class="_ _7"></span>ariable</div><div class="t m5 x2d h31 y855e ff7 fs21 fc2 sc0 ls0 ws0">instance<span class="_ _46"> </span>main<span class="_"> </span>thread?<span class="_ _26"> </span>peer<span class="_"> </span>thread<span class="_"> </span>0?<span class="_ _26"> </span>peer<span class="_"> </span>thread<span class="_"> </span>1?</div><div class="t m5 x2d h31 y855f ffd fs1e fc2 sc0 ls0 ws0">ptr<span class="_ _126"> </span><span class="ff7 fs21">yes<span class="_ _1e1"> </span>yes<span class="_ _ec"> </span>yes</span></div><div class="t m5 x2d h31 y8560 ffd fs1e fc2 sc0 ls0 ws0">cnt<span class="_ _1b1"> </span><span class="ff7 fs21">no<span class="_ _10e"> </span>yes<span class="_ _ec"> </span>yes</span></div><div class="t m5 x2d h31 y8561 ffd fs1e fc2 sc0 ls0 ws0">i.m<span class="_ _126"> </span><span class="ff7 fs21">yes<span class="_ _10e"> </span>no<span class="_ _9d"> </span>no</span></div><div class="t m5 x2d h31 y74ac ffd fs1e fc2 sc0 ls0 ws0">msgs.m<span class="_ _77"> </span><span class="ff7 fs21">yes<span class="_ _1e1"> </span>yes<span class="_ _ec"> </span>yes</span></div><div class="t m5 x2d h31 y8562 ffd fs1e fc2 sc0 ls0 ws0">myid.p0<span class="_ _148"> </span><span class="ff7 fs21">no<span class="_ _10e"> </span>yes<span class="_ _ce"> </span>no</span></div><div class="t m5 x2d h31 y8563 ffd fs1e fc2 sc0 ls0 ws0">myid.p1<span class="_ _148"> </span><span class="ff7 fs21">no<span class="_ _ec"> </span>no<span class="_ _35"> </span>yes</span></div><div class="t m5 x2d h26 y8564 ff7 fs19 fc2 sc0 ls0 ws0">Notes:</div><div class="t m5 xd1 h26 y8565 ffd fs19 fc2 sc0 ls0 ws0">ptr<span class="_ _e"> </span><span class="ff7">A<span class="_ _11"> </span>global<span class="_"> </span>variable<span class="_ _11"> </span>that<span class="_"> </span>is<span class="_"> </span>written<span class="_ _11"> </span>by<span class="_"> </span>the<span class="_"> </span>main<span class="_ _11"> </span>thread<span class="_"> </span>and<span class="_"> </span>read<span class="_ _11"> </span>by<span class="_"> </span>the</span></div><div class="t m5 x155 h26 y8566 ff7 fs19 fc2 sc0 ls0 ws0">peer<span class="_"> </span>threads<span class="_ _1"></span>.</div><div class="t m5 xd1 h26 y8567 ffd fs19 fc2 sc0 ls0 ws0">cnt<span class="_ _e"> </span><span class="ff7">A<span class="_ _16"> </span>static<span class="_"> </span>variable<span class="_ _16"> </span>with<span class="_"> </span>only<span class="_ _11"> </span>one<span class="_ _16"> </span>instance<span class="_"> </span>in<span class="_ _16"> </span>memory<span class="_"> </span>that<span class="_ _11"> </span>is<span class="_ _16"> </span>read<span class="_"> </span>and</span></div><div class="t m5 x155 h26 y8568 ff7 fs19 fc2 sc0 ls0 ws0">written<span class="_"> </span>by<span class="_"> </span>the<span class="_"> </span>two<span class="_"> </span>peer<span class="_"> </span>threads<span class="_ _1"></span>.</div><div class="t m5 xd1 h26 y8569 ffd fs19 fc2 sc0 ls0 ws0">i.m<span class="_ _e"> </span><span class="ff7">A<span class="_ _14"> </span>local<span class="_ _16"> </span>automatic<span class="_ _14"> </span>variable<span class="_ _16"> </span>stored<span class="_ _14"> </span>on<span class="_ _16"> </span>the<span class="_ _14"> </span>stack<span class="_ _16"> </span>of<span class="_ _14"> </span>the<span class="_ _16"> </span>main<span class="_ _14"> </span>thread.</span></div><div class="t m5 x155 h26 y856a ff7 fs19 fc2 sc0 ls0 ws0">Even<span class="_ _13"> </span>though<span class="_ _13"> </span>its<span class="_ _13"> </span>value<span class="_ _13"> </span>is<span class="_ _13"> </span>passed<span class="_ _13"> </span>to<span class="_ _13"> </span>the<span class="_ _13"> </span>peer<span class="_ _6"> </span>threads<span class="_ _0"></span>,<span class="_ _13"> </span>the<span class="_ _13"> </span>peer<span class="_ _13"> </span>threads</div><div class="t m5 x155 h26 y856b ff7 fs19 fc2 sc0 ls0 ws0">never<span class="_"> </span>reference<span class="_"> </span>it<span class="_"> </span>on<span class="_"> </span>the<span class="_"> </span>stack,<span class="_"> </span>and<span class="_"> </span>thus<span class="_"> </span>it<span class="_"> </span>is<span class="_"> </span>not<span class="_"> </span>shared.</div><div class="t m5 xd1 h26 y856c ffd fs19 fc2 sc0 ls0 ws0">msgs.m<span class="_ _e"> </span><span class="ff7">A<span class="_"> </span>local<span class="_"> </span>automatic<span class="_ _13"> </span>variable<span class="_"> </span>stored<span class="_"> </span>on<span class="_ _13"> </span>the<span class="_"> </span>main<span class="_ _13"> </span>thread’s<span class="_"> </span>stack<span class="_ _13"> </span>and</span></div><div class="t m5 x155 h26 y856d ff7 fs19 fc2 sc0 ls0 ws0">referenced<span class="_"> </span>indirectly<span class="_"> </span>through<span class="_"> </span><span class="ffd">ptr<span class="_ _10"> </span></span>by<span class="_"> </span>both<span class="_"> </span>peer<span class="_"> </span>threads<span class="_ _1"></span>.</div><div class="t m5 xd1 h26 y856e ffd fs19 fc2 sc0 ls0 ws0">myid.p0<span class="_ _10"> </span><span class="ff7">and<span class="_ _13"> </span></span>myid.p1<span class="_ _1f"> </span><span class="ff7">Instances<span class="_ _13"> </span>of<span class="_"> </span>a<span class="_"> </span>local<span class="_ _13"> </span>automatic<span class="_"> </span>variable<span class="_ _13"> </span>residing<span class="_"> </span>on</span></div><div class="t m5 x155 h26 y856f ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span>stacks<span class="_"> </span>of<span class="_"> </span>peer<span class="_"> </span>threads<span class="_"> </span>0<span class="_"> </span>and<span class="_"> </span>1,<span class="_"> </span>respectively<span class="_ _3"></span>.</div><div class="t m5 x34 h26 y8570 ff7 fs19 fc2 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>V<span class="_ _7"></span>ariables<span class="_ _16"> </span><span class="ffd">ptr</span>,<span class="_ _16"> </span><span class="ffd">cnt</span>,<span class="_ _16"> </span>and<span class="_ _11"> </span><span class="ffd">msgs<span class="_ _16"> </span></span>are<span class="_ _11"> </span>referenced<span class="_ _16"> </span>by<span class="_ _11"> </span>more<span class="_ _16"> </span>than<span class="_ _11"> </span>one<span class="_ _16"> </span>thread<span class="_ _16"> </span>and</div><div class="t m5 x2d h26 y8571 ff7 fs19 fc2 sc0 ls0 ws0">thus<span class="_"> </span>are<span class="_"> </span>shared.</div><div class="t m5 x17 h28 y5665 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>12.7<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>1034)</span></div><div class="t m5 x17 h26 y8572 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _f"> </span>important<span class="_ _21"> </span>idea<span class="_ _21"> </span>here<span class="_ _21"> </span>is<span class="_ _f"> </span>that<span class="_ _21"> </span>you<span class="_ _21"> </span>cannot<span class="_ _21"> </span>make<span class="_ _f"> </span>any<span class="_ _21"> </span>assumptions<span class="_ _21"> </span>about<span class="_ _f"> </span>the</div><div class="t m5 x17 h26 y8573 ff7 fs19 fc1 sc0 ls0 ws0">ordering<span class="_"> </span>that<span class="_"> </span>the<span class="_"> </span>kernel<span class="_"> </span>chooses<span class="_"> </span>when<span class="_"> </span>it<span class="_"> </span>schedules<span class="_"> </span>your<span class="_"> </span>threads<span class="_ _1"></span>.</div><div class="t m5 x17 h31 y8574 ff7 fs21 fc2 sc0 ls0 ws0">Step<span class="_ _26"> </span>T<span class="_ _1"></span>hread<span class="_ _26"> </span>Instr.<span class="_ _26"> </span><span class="ffd fs1e">%rdx</span></div><div class="t m5 x48 h33 y8575 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x90 h2d y8576 ffd fs1e fc2 sc0 ls0 ws0">%rdx</div><div class="t m5 x68 h33 y8577 ff7 fs20 fc2 sc0 ls0 ws0">2</div><div class="t m5 x1b3 h2d y8576 ffd fs1e fc2 sc0 ls0 ws0">cnt</div><div class="t m5 xee h31 y2b83 ff7 fs21 fc2 sc0 ls2ef ws0">11<span class="_ _a"> </span><span class="ff11 ls0">H</span></div><div class="t m5 x64 h33 y8578 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x1a6 h31 y8579 ff7 fs21 fc2 sc0 ls304 ws0">——<span class="_ _8"></span>0</div><div class="t m5 xee h31 y857a ff7 fs21 fc2 sc0 ls2ef ws0">21<span class="_ _6"> </span><span class="ff11 ls0">L</span></div><div class="t m5 x209 h33 y857b ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x27a h31 y857c ff7 fs21 fc2 sc0 ls305 ws0">0—<span class="_ _8a"></span>0</div><div class="t m5 xee h31 y857d ff7 fs21 fc2 sc0 ls2ef ws0">32<span class="_ _be"></span><span class="ff11 ls0">H</span></div><div class="t m5 x209 h33 y857e ff7 fs20 fc2 sc0 ls0 ws0">2</div><div class="t m5 x1a6 h31 y857f ff7 fs21 fc2 sc0 ls304 ws0">——<span class="_ _8"></span>0</div><div class="t m5 xee h31 y8580 ff7 fs21 fc2 sc0 ls2ef ws0">42<span class="_ _6"> </span><span class="ff11 ls0">L</span></div><div class="t m5 x209 h33 y8581 ff7 fs20 fc2 sc0 ls0 ws0">2</div><div class="t m5 x1a6 h31 y4fa3 ff7 fs21 fc2 sc0 ls305 ws0">—0<span class="_ _8"></span>0</div><div class="t m5 xee h31 y8582 ff7 fs21 fc2 sc0 ls2ef ws0">52<span class="_ _a"> </span><span class="ff11 ls0">U</span></div><div class="t m5 x209 h33 y8583 ff7 fs20 fc2 sc0 ls0 ws0">2</div><div class="t m5 x1a6 h31 y8584 ff7 fs21 fc2 sc0 ls305 ws0">—1<span class="_ _8"></span>0</div><div class="t m5 xee h31 y8585 ff7 fs21 fc2 sc0 ls2ef ws0">62<span class="_ _13"> </span><span class="ff11 ls0">S</span></div><div class="t m5 xcd h33 y8586 ff7 fs20 fc2 sc0 ls0 ws0">2</div><div class="t m5 x1a6 h31 y8587 ff7 fs21 fc2 sc0 ls305 ws0">—1<span class="_ _8"></span>1</div><div class="t m5 xee h31 y8588 ff7 fs21 fc2 sc0 ls2ef ws0">71<span class="_ _6"> </span><span class="ff11 ls0">U</span></div><div class="t m5 x209 h33 y8589 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x27a h31 y7fd7 ff7 fs21 fc2 sc0 ls305 ws0">1—<span class="_ _8a"></span>1</div><div class="t m5 xee h31 y858a ff7 fs21 fc2 sc0 ls2ef ws0">81<span class="_ _10"> </span><span class="ff11 ls0">S</span></div><div class="t m5 xcd h33 y858b ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x27a h31 y858c ff7 fs21 fc2 sc0 ls305 ws0">1—<span class="_ _8a"></span>1</div><div class="t m5 xee h31 y858d ff7 fs21 fc2 sc0 ls2ef ws0">91<span class="_ _10"> </span><span class="ff11 ls0">T</span></div><div class="t m5 xcd h33 y858e ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x27a h31 y858f ff7 fs21 fc2 sc0 ls305 ws0">1—<span class="_ _8a"></span>1</div><div class="t m5 x52 h31 y8590 ff7 fs21 fc2 sc0 ls0 ws0">10<span class="_ _88"> </span>2<span class="_ _7f"> </span><span class="ff11">T</span></div><div class="t m5 xcd h33 y8591 ff7 fs20 fc2 sc0 ls0 ws0">2</div><div class="t m5 x1a6 h31 y8592 ff7 fs21 fc2 sc0 ls305 ws0">—1<span class="_ _8"></span>1</div><div class="t m5 x17 h26 y1db4 ff7 fs19 fc2 sc0 ls0 ws0">V<span class="_ _7"></span>ariable<span class="_"> </span><span class="ffd">cnt<span class="_ _10"> </span></span>has<span class="_"> </span>a<span class="_"> </span>ﬁnal<span class="_"> </span>incorrect<span class="_"> </span>value<span class="_"> </span>of<span class="_"> </span>1<span class="_ _1"></span>.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
