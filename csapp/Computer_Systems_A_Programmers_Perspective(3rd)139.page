<div id="pf8b" class="pf w2 h11" data-page-no="8b"><div class="pc pc8b w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg8b.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">138<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>2<span class="_ _3d"> </span>Representing<span class="_ _10"> </span>and<span class="_ _10"> </span>Manipulating<span class="_ _10"> </span>Information</span></div><div class="t m5 x1d h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">but<span class="_ _11"> </span>this<span class="_ _16"> </span>is<span class="_ _11"> </span>also<span class="_ _11"> </span>the<span class="_ _16"> </span>case<span class="_ _11"> </span>when<span class="_ _16"> </span>performing<span class="_ _11"> </span>multiplication<span class="_ _11"> </span>on<span class="_ _16"> </span>ﬁxed-size<span class="_ _11"> </span>words<span class="_ _1"></span>.<span class="_ _16"> </span>W<span class="_ _3"></span>e</div><div class="t m5 x1d h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">can<span class="_ _16"> </span>therefore<span class="_ _16"> </span>see<span class="_ _16"> </span>that<span class="_ _11"> </span>shifting<span class="_ _16"> </span>a<span class="_ _16"> </span>value<span class="_ _16"> </span>left<span class="_ _16"> </span>is<span class="_ _16"> </span>equivalent<span class="_ _16"> </span>to<span class="_ _16"> </span>performing<span class="_ _16"> </span>unsigned</div><div class="t m5 x1d h26 y2a8 ff7 fs19 fc2 sc0 ls0 ws0">multiplication<span class="_"> </span>by<span class="_"> </span>a<span class="_"> </span>power<span class="_"> </span>of<span class="_"> </span>2:</div><div class="t m5 x1d h5b y1575 ff1b fs14 fc6 sc0 ls0 ws0">principle:<span class="_ _e"> </span><span class="ff7 fs19 fc1">Unsigned<span class="_"> </span>multiplication<span class="_"> </span>by<span class="_"> </span>a<span class="_"> </span>power<span class="_"> </span>of<span class="_"> </span>2</span></div><div class="t m5 x1d h46 y1576 ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>or<span class="_"> </span>C<span class="_ _11"> </span>variables<span class="_ _11"> </span><span class="ffd">x<span class="_ _11"> </span></span>and<span class="_ _11"> </span><span class="ffd">k<span class="_ _11"> </span></span>with<span class="_ _11"> </span>unsigned<span class="_"> </span>values<span class="_ _11"> </span><span class="ff11">x<span class="_"> </span></span>and<span class="_ _11"> </span><span class="ff11">k<span class="_ _2"></span></span>,<span class="_ _11"> </span>such<span class="_ _11"> </span>that<span class="_ _11"> </span>0<span class="_"> </span><span class="ff12">≤<span class="_ _13"></span><span class="ff11 lsc9">k&lt;<span class="_ _0"></span>w<span class="_ _4a"></span><span class="ff7 ls0">,<span class="_ _11"> </span>the<span class="_ _11"> </span>C</span></span></span></div><div class="t m5 x1d h26 y1577 ff7 fs19 fc1 sc0 ls0 ws0">expression<span class="_"> </span><span class="ffd ls4b">x&lt;<span class="_ _49"></span>&lt;k<span class="_ _3"></span><span class="ff7 ls0">yields<span class="_"> </span>the<span class="_"> </span>value<span class="_"> </span><span class="ff11">x<span class="_ _16"> </span><span class="ffd">*</span></span></span></span></div><div class="t m5 x9a h69 y1578 ff7 fs39 fc1 sc0 ls0 ws0">u</div><div class="t m5 x9a h50 y1579 ff11 fs25 fc1 sc0 ls0 ws0">w</div><div class="t m5 x114 h26 y157a ff7 fs19 fc1 sc0 ls0 ws0">2</div><div class="t m5 x3f h50 y1578 ff11 fs25 fc1 sc0 ls0 ws0">k</div><div class="t m5 x19d h26 y157a ff7 fs19 fc1 sc0 ls0 ws0">.</div><div class="t m5 x29 h26 y157b ff7 fs19 fc1 sc0 ls0 ws0">Since<span class="_ _f"> </span>the<span class="_ _f"> </span>bit-level<span class="_ _f"> </span>operation<span class="_ _e"> </span>of<span class="_ _21"> </span>ﬁxed-size<span class="_ _f"> </span>two’s-complement<span class="_ _f"> </span>arithmetic<span class="_ _f"> </span>is</div><div class="t m5 x1d h26 y157c ff7 fs19 fc1 sc0 ls0 ws0">equivalent<span class="_ _13"> </span>to<span class="_ _13"> </span>that<span class="_ _13"> </span>for<span class="_ _13"> </span>unsigned<span class="_ _13"> </span>arithmetic,<span class="_ _13"> </span>we<span class="_ _13"> </span>can<span class="_ _13"> </span>make<span class="_"> </span>a<span class="_ _13"> </span>similar<span class="_ _13"> </span>statement<span class="_ _13"> </span>about</div><div class="t m5 x1d h26 y157d ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _11"> </span>relationship<span class="_ _11"> </span>between<span class="_ _11"> </span>left<span class="_ _11"> </span>shifts<span class="_ _11"> </span>and<span class="_ _11"> </span>multiplication<span class="_ _16"> </span>by<span class="_"> </span>a<span class="_ _11"> </span>power<span class="_ _11"> </span>of<span class="_ _16"> </span>2<span class="_"> </span>for<span class="_ _11"> </span>two’s-</div><div class="t m5 x1d h26 y157e ff7 fs19 fc1 sc0 ls0 ws0">complement<span class="_"> </span>arithmetic:</div><div class="t m5 x1d h5b y157f ff1b fs14 fc6 sc0 ls0 ws0">principle:<span class="_ _e"> </span><span class="ff7 fs19 fc1">T<span class="_ _3"></span>wo’s-complement<span class="_"> </span>multiplication<span class="_"> </span>by<span class="_"> </span>a<span class="_"> </span>power<span class="_"> </span>of<span class="_"> </span>2</span></div><div class="t m5 x1d h26 y1580 ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>or<span class="_ _13"> </span>C<span class="_ _13"> </span>variables<span class="_ _13"> </span><span class="ffd">x<span class="_ _13"> </span></span>and<span class="_ _6"> </span><span class="ffd">k<span class="_ _13"> </span></span>with<span class="_ _13"> </span>two’s-complement<span class="_ _13"> </span>value<span class="_ _13"> </span><span class="ff11">x<span class="_ _10"> </span></span>and<span class="_ _13"> </span>unsigned<span class="_ _13"> </span>value<span class="_ _6"> </span><span class="ff11">k<span class="_ _2"></span></span>,<span class="_ _13"> </span>such</div><div class="t m5 x1d h46 y1581 ff7 fs19 fc1 sc0 ls0 ws0">that<span class="_"> </span>0<span class="_"> </span><span class="ff12">≤<span class="_ _13"></span><span class="ff11 lsca">k&lt;<span class="_ _1"></span>w<span class="_ _80"></span><span class="ff7 ls0">,<span class="_"> </span>the<span class="_"> </span>C<span class="_"> </span>expression<span class="_"> </span><span class="ffd ls4b">x&lt;<span class="_ _49"></span>&lt;k<span class="_ _1"></span><span class="ff7 ls0">yields<span class="_"> </span>the<span class="_"> </span>value<span class="_"> </span><span class="ff11">x<span class="_ _11"> </span><span class="ffd">*</span></span></span></span></span></span></span></div><div class="t m5 x147 h69 y1582 ff7 fs39 fc1 sc0 ls0 ws0">t</div><div class="t m5 x147 h50 y1583 ff11 fs25 fc1 sc0 ls0 ws0">w</div><div class="t m5 x13e h26 y1584 ff7 fs19 fc1 sc0 ls0 ws0">2</div><div class="t m5 x19e h50 y1582 ff11 fs25 fc1 sc0 ls0 ws0">k</div><div class="t m5 x133 h26 y1584 ff7 fs19 fc1 sc0 ls0 ws0">.</div><div class="t m5 x29 h26 y1585 ff7 fs19 fc1 sc0 ls0 ws0">Note<span class="_ _13"> </span>that<span class="_ _13"> </span>multiplying<span class="_ _13"> </span>by<span class="_ _6"> </span>a<span class="_ _13"> </span>power<span class="_ _13"> </span>of<span class="_ _13"> </span>2<span class="_ _13"> </span>can<span class="_ _13"> </span>cause<span class="_ _6"> </span>overﬂow<span class="_ _13"> </span>with<span class="_ _13"> </span>either<span class="_ _13"> </span>unsigned</div><div class="t m5 x1d h26 y1586 ff7 fs19 fc1 sc0 ls0 ws0">or<span class="_"> </span>two’s-complement<span class="_"> </span>arithmetic.<span class="_"> </span>Our<span class="_"> </span>result<span class="_"> </span>shows<span class="_ _11"> </span>that<span class="_"> </span>even<span class="_ _11"> </span>then<span class="_"> </span>we<span class="_ _11"> </span>will<span class="_"> </span>get<span class="_ _11"> </span>the</div><div class="t m5 x1d h26 y1587 ff7 fs19 fc1 sc0 ls0 ws0">same<span class="_ _15"> </span>effect<span class="_ _15"> </span>by<span class="_ _15"> </span>shifting.<span class="_ _14"> </span>Returning<span class="_ _15"> </span>to<span class="_ _15"> </span>our<span class="_ _15"> </span>earlier<span class="_ _15"> </span>example<span class="_ _0"></span>,<span class="_ _21"> </span>we<span class="_ _15"> </span>shifted<span class="_ _15"> </span>the<span class="_ _15"> </span>4-bit</div><div class="t m5 x1d h26 y1588 ff7 fs19 fc1 sc0 ls0 ws0">pattern<span class="_ _11"> </span>[1011]<span class="_"> </span>(numeric<span class="_ _16"> </span>value<span class="_ _11"> </span>11)<span class="_ _16"> </span>left<span class="_ _11"> </span>by<span class="_ _16"> </span>two<span class="_ _16"> </span>positions<span class="_ _11"> </span>to<span class="_ _16"> </span>get<span class="_ _11"> </span>[101100]<span class="_"> </span>(numeric</div><div class="t m5 x1d h46 y1589 ff7 fs19 fc1 sc0 ls0 ws0">value<span class="_"> </span>44).<span class="_"> </span>T<span class="_ _7"></span>runcating<span class="_"> </span>this<span class="_"> </span>to<span class="_"> </span>4<span class="_"> </span>bits<span class="_"> </span>gives<span class="_"> </span>[1100]<span class="_ _13"> </span>(numeric<span class="_"> </span>value<span class="_"> </span>12<span class="_"> </span><span class="ff12">=<span class="_ _13"></span></span><span class="ls13">44<span class="_"> </span>mod<span class="_ _13"> </span>16).</span></div><div class="t m5 x29 h26 y158a ff7 fs19 fc1 sc0 ls0 ws0">Given<span class="_ _6"> </span>that<span class="_ _6"> </span>integer<span class="_ _6"> </span>multiplication<span class="_ _6"> </span>is<span class="_ _6"> </span>more<span class="_ _6"> </span>costly<span class="_ _6"> </span>than<span class="_ _6"> </span>shifting<span class="_ _6"> </span>and<span class="_ _6"> </span>adding,<span class="_ _13"> </span>many</div><div class="t m5 x1d h26 y158b ff7 fs19 fc1 sc0 ls0 ws0">C<span class="_ _11"> </span>compilers<span class="_ _11"> </span>try<span class="_ _16"> </span>to<span class="_ _11"> </span>remove<span class="_ _11"> </span>many<span class="_ _16"> </span>cases<span class="_"> </span>where<span class="_ _16"> </span>an<span class="_ _11"> </span>integer<span class="_ _11"> </span>is<span class="_ _16"> </span>being<span class="_ _11"> </span>multiplied<span class="_ _11"> </span>by<span class="_ _11"> </span>a</div><div class="t m5 x1d h26 y158c ff7 fs19 fc1 sc0 ls0 ws0">constant<span class="_ _13"> </span>with<span class="_ _13"> </span>combinations<span class="_ _13"> </span>of<span class="_ _13"> </span>shifting<span class="_ _1"></span>,<span class="_"> </span>adding<span class="_ _1"></span>,<span class="_"> </span>and<span class="_ _6"> </span>subtracting.<span class="_ _13"> </span>F<span class="_ _1"></span>or<span class="_ _13"> </span>example<span class="_ _1"></span>,<span class="_"> </span>sup-</div><div class="t m5 x1d h46 y158d ff7 fs19 fc1 sc0 ls0 ws0">pose<span class="_ _13"> </span>a<span class="_"> </span>program<span class="_ _13"> </span>contains<span class="_ _13"> </span>the<span class="_"> </span>expression<span class="_ _13"> </span><span class="ffd">x*14</span>.<span class="_ _13"> </span>Recognizing<span class="_"> </span>that<span class="_ _13"> </span>14<span class="_ _13"> </span><span class="ff12">=<span class="_ _10"> </span></span>2</div><div class="t m5 x220 h3c y158e ff7 fs25 fc1 sc0 ls0 ws0">3</div><div class="t m5 x217 h46 y158f ff12 fs19 fc1 sc0 ls0 ws0">+<span class="_ _13"></span><span class="ff7">2</span></div><div class="t m5 x1e h3c y158e ff7 fs25 fc1 sc0 ls0 ws0">2</div><div class="t m5 xdb h46 y158f ff12 fs19 fc1 sc0 ls0 ws0">+<span class="_ _13"></span><span class="ff7">2</span></div><div class="t m5 x18f h3c y158e ff7 fs25 fc1 sc0 ls0 ws0">1</div><div class="t m5 x12c h26 y158f ff7 fs19 fc1 sc0 ls0 ws0">,</div><div class="t m5 x1d h26 y1590 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _13"> </span>compiler<span class="_ _13"> </span>can<span class="_"> </span>rewrite<span class="_ _13"> </span>the<span class="_ _13"> </span>multiplication<span class="_ _13"> </span>as<span class="_ _13"> </span><span class="ffd">(x&lt;&lt;3)<span class="_ _16"> </span>+<span class="_ _11"> </span>(x&lt;&lt;2)<span class="_ _16"> </span>+<span class="_ _16"> </span>(x&lt;&lt;1)</span>,<span class="_ _13"> </span>replac-</div><div class="t m5 x1d h26 y1591 ff7 fs19 fc1 sc0 ls0 ws0">ing<span class="_"> </span>one<span class="_"> </span>multiplication<span class="_"> </span>with<span class="_"> </span>three<span class="_"> </span>shifts<span class="_"> </span>and<span class="_"> </span>two<span class="_"> </span>additions<span class="_ _1"></span>.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_"> </span>two<span class="_"> </span>computations</div><div class="t m5 x1d h26 y1592 ff7 fs19 fc1 sc0 ls0 ws0">will<span class="_ _16"> </span>yield<span class="_ _16"> </span>the<span class="_ _16"> </span>same<span class="_ _14"> </span>result,<span class="_ _16"> </span>regardless<span class="_ _14"> </span>of<span class="_ _16"> </span>whether<span class="_ _16"> </span><span class="ffd">x<span class="_ _16"> </span></span>is<span class="_ _14"> </span>unsigned<span class="_ _16"> </span>or<span class="_ _16"> </span>two’s<span class="_ _16"> </span>comple-</div><div class="t m5 x1d h26 y1593 ff7 fs19 fc1 sc0 ls0 ws0">ment,<span class="_ _14"> </span>and<span class="_ _16"> </span>even<span class="_ _14"> </span>if<span class="_ _14"> </span>the<span class="_ _16"> </span>multiplication<span class="_ _14"> </span>would<span class="_ _16"> </span>cause<span class="_ _14"> </span>an<span class="_ _16"> </span>overﬂow<span class="_ _1"></span>.<span class="_ _16"> </span>Even<span class="_ _14"> </span>better,<span class="_ _14"> </span>the</div><div class="t m5 x1d h46 y1594 ff7 fs19 fc1 sc0 ls0 ws0">compiler<span class="_ _16"> </span>can<span class="_ _16"> </span>also<span class="_ _16"> </span>use<span class="_ _16"> </span>the<span class="_ _14"> </span>property<span class="_ _16"> </span>14<span class="_"> </span><span class="ff12">=<span class="_ _13"> </span></span>2</div><div class="t m5 x1b4 h3c y1595 ff7 fs25 fc1 sc0 ls0 ws0">4</div><div class="t m5 x1c2 h46 y1596 ff12 fs19 fc1 sc0 ls0 ws0">−<span class="_ _10"> </span><span class="ff7">2</span></div><div class="t m5 x94 h3c y1595 ff7 fs25 fc1 sc0 ls0 ws0">1</div><div class="t m5 x93 h26 y1596 ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_ _16"> </span>rewrite<span class="_ _16"> </span>the<span class="_ _16"> </span>multiplication<span class="_ _16"> </span>as</div><div class="t m5 x1d h26 y1597 ffd fs19 fc1 sc0 ls0 ws0">(x&lt;&lt;4)<span class="_ _11"> </span>-<span class="_ _16"> </span>(x&lt;&lt;1)<span class="ff7">,<span class="_"> </span>requiring<span class="_"> </span>only<span class="_"> </span>two<span class="_"> </span>shifts<span class="_"> </span>and<span class="_"> </span>a<span class="_"> </span>subtraction.</span></div><div class="t m5 x1d h47 y1598 ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>2.38<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>191)</span></div><div class="t m5 x1d h26 y1599 ff7 fs19 fc1 sc0 ls0 ws0">As<span class="_ _14"> </span>we<span class="_ _15"> </span>will<span class="_ _15"> </span>see<span class="_ _15"> </span>in<span class="_ _15"> </span>Chapter<span class="_ _14"> </span>3,<span class="_ _21"> </span>the<span class="_ _15"> </span><span class="ff9">lea<span class="_ _15"> </span></span>instruction<span class="_ _15"> </span>can<span class="_ _15"> </span>perform<span class="_ _14"> </span>computations<span class="_ _15"> </span>of</div><div class="t m5 x1d h26 y159a ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _14"> </span>form<span class="_ _15"> </span><span class="ffd">(a&lt;&lt;k)<span class="_ _16"> </span>+<span class="_ _16"> </span>b</span>,<span class="_ _15"> </span>where<span class="_ _15"> </span><span class="ffd">k<span class="_ _15"> </span></span>is<span class="_ _15"> </span>either<span class="_ _15"> </span>0,<span class="_ _15"> </span>1,<span class="_ _21"> </span>2,<span class="_ _21"> </span>or<span class="_ _15"> </span>3,<span class="_ _21"> </span>and<span class="_ _15"> </span><span class="ffd">b<span class="_ _15"> </span></span>is<span class="_ _15"> </span>either<span class="_ _15"> </span>0<span class="_ _15"> </span>or<span class="_ _14"> </span>some</div><div class="t m5 x1d h26 y159b ff7 fs19 fc1 sc0 ls0 ws0">program<span class="_ _13"> </span>value<span class="_ _1"></span>.<span class="_ _13"> </span>T<span class="_ _1"></span>he<span class="_ _13"> </span>compiler<span class="_ _6"> </span>often<span class="_ _13"> </span>uses<span class="_ _6"> </span>this<span class="_ _13"> </span>instruction<span class="_ _6"> </span>to<span class="_ _13"> </span>perform<span class="_ _13"> </span>multiplications</div><div class="t m5 x1d h26 y159c ff7 fs19 fc1 sc0 ls0 ws0">by<span class="_"> </span>constant<span class="_"> </span>factors<span class="_ _1"></span>.<span class="_"> </span>F<span class="_ _1"></span>or<span class="_"> </span>example<span class="_ _0"></span>,<span class="_"> </span>we<span class="_"> </span>can<span class="_"> </span>compute<span class="_"> </span><span class="ffd">3*a<span class="_ _10"> </span></span>as<span class="_"> </span><span class="ffd">(a&lt;&lt;1)<span class="_ _16"> </span>+<span class="_ _11"> </span>a</span>.</div><div class="t m5 x29 h26 y159d ff7 fs19 fc1 sc0 ls0 ws0">Considering<span class="_ _13"> </span>cases<span class="_ _13"> </span>where<span class="_ _6"> </span><span class="ffd">b<span class="_ _13"> </span></span>is<span class="_ _13"> </span>either<span class="_ _13"> </span>0<span class="_ _6"> </span>or<span class="_ _13"> </span>equal<span class="_ _13"> </span>to<span class="_ _13"> </span><span class="ffd">a</span>,<span class="_ _13"> </span>and<span class="_ _6"> </span>all<span class="_ _13"> </span>possible<span class="_ _13"> </span>values<span class="_ _13"> </span>of<span class="_ _6"> </span><span class="ffd">k</span>,</div><div class="t m5 x1d h26 y159e ff7 fs19 fc1 sc0 ls0 ws0">what<span class="_"> </span>multiples<span class="_"> </span>of<span class="_"> </span><span class="ffd">a<span class="_ _10"> </span></span>can<span class="_"> </span>be<span class="_"> </span>computed<span class="_"> </span>with<span class="_"> </span>a<span class="_"> </span>single<span class="_"> </span><span class="ff9">lea<span class="_ _10"> </span></span>instruction?</div><div class="t m5 x29 h26 y8d6 ff7 fs19 fc1 sc0 ls0 ws0">Generalizing<span class="_ _21"> </span>from<span class="_ _f"> </span>our<span class="_ _f"> </span>example<span class="_ _0"></span>,<span class="_ _e"> </span>consider<span class="_ _15"> </span>the<span class="_ _f"> </span>task<span class="_ _f"> </span>of<span class="_ _f"> </span>generating<span class="_ _21"> </span>code<span class="_ _f"> </span>for</div><div class="t m5 x1d h26 y8d7 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>expression<span class="_ _11"> </span><span class="ffd ls4b">x*</span><span class="ff11">K<span class="_ _be"></span></span>,<span class="_ _11"> </span>for<span class="_ _11"> </span>some<span class="_ _11"> </span>constant<span class="_ _11"> </span><span class="ff11">K<span class="_ _5"></span></span>.<span class="_ _11"> </span>T<span class="_ _0"></span>he<span class="_"> </span>compiler<span class="_ _11"> </span>can<span class="_ _11"> </span>express<span class="_ _11"> </span>the<span class="_ _11"> </span>binary</div><div class="t m5 x1d h26 y8d8 ff7 fs19 fc1 sc0 ls0 ws0">representation<span class="_"> </span>of<span class="_"> </span><span class="ff11">K<span class="_"> </span></span>as<span class="_"> </span>an<span class="_"> </span>alternating<span class="_"> </span>sequence<span class="_"> </span>of<span class="_"> </span>zeros<span class="_"> </span>and<span class="_"> </span>ones:</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
