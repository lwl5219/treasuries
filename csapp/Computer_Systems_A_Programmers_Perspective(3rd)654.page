<div id="pf28e" class="pf w2 h11" data-page-no="28e"><div class="pc pc28e w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg28e.png"/><div class="t m5 xf2 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>6.4<span class="_ _60"> </span>Cache<span class="_ _10"> </span>Memories<span class="_ _3e"> </span><span class="ffe fs1e">653</span></div><div class="t m5 x17 h31 y390 ff7 fs21 fc2 sc0 ls0 ws0">Parameter<span class="_ _7e"> </span>Description</div><div class="t m5 x17 h31 y56f4 ff7 fs21 fc2 sc0 ls0 ws0">Fundamental<span class="_"> </span>parameters</div><div class="t m5 x17 h32 y56f5 ff11 fs21 fc2 sc0 ls0 ws0">S<span class="_ _10"> </span><span class="ff12">=<span class="_ _13"> </span><span class="ff7">2</span></span></div><div class="t m5 x1ce h51 y56f6 ff11 fs20 fc2 sc0 ls0 ws0">s</div><div class="t m5 x10c h31 y2d53 ff7 fs21 fc2 sc0 ls0 ws0">Number<span class="_"> </span>of<span class="_"> </span>sets</div><div class="t m5 x17 h31 y56f7 ff11 fs21 fc2 sc0 ls0 ws0">E<span class="_ _17d"> </span><span class="ff7">Number<span class="_"> </span>of<span class="_"> </span>lines<span class="_"> </span>per<span class="_"> </span>set</span></div><div class="t m5 x17 h32 y56f8 ff11 fs21 fc2 sc0 ls0 ws0">B<span class="_ _10"> </span><span class="ff12">=<span class="_ _10"> </span><span class="ff7">2</span></span></div><div class="t m5 x1a2 h51 y56f9 ff11 fs20 fc2 sc0 ls0 ws0">b</div><div class="t m5 x10c h31 y56fa ff7 fs21 fc2 sc0 ls0 ws0">Block<span class="_"> </span>size<span class="_"> </span>(bytes)</div><div class="t m5 x17 h32 y56fb ff11 fs21 fc2 sc0 ls0 ws0">m<span class="_ _13"> </span><span class="ff12">=<span class="_ _13"> </span><span class="ff7">log</span></span></div><div class="t m5 x1d2 h33 y56fc ff7 fs20 fc2 sc0 ls0 ws0">2</div><div class="t m5 x182 h31 y56fd ff11 fs21 fc2 sc0 ls0 ws0">(M<span class="_ _5"></span>)<span class="_ _2e"> </span><span class="ff7">Number<span class="_"> </span>of<span class="_"> </span>physical<span class="_"> </span>(main<span class="_"> </span>memory)<span class="_"> </span>address<span class="_"> </span>bits</span></div><div class="t m5 x17 h31 y56fe ff7 fs21 fc2 sc0 ls0 ws0">Derived<span class="_"> </span>quantities</div><div class="t m5 x17 h32 y56ff ff11 fs21 fc2 sc0 ls0 ws0">M<span class="_ _11"> </span><span class="ff12">=<span class="_ _13"> </span><span class="ff7">2</span></span></div><div class="t m5 x153 h51 y5700 ff11 fs20 fc2 sc0 ls0 ws0">m</div><div class="t m5 x10c h31 y298d ff7 fs21 fc2 sc0 ls0 ws0">Maximum<span class="_"> </span>number<span class="_"> </span>of<span class="_"> </span>unique<span class="_"> </span>memory<span class="_"> </span>addresses</div><div class="t m5 x17 h32 y5701 ff11 fs21 fc2 sc0 ls0 ws0">s<span class="_ _10"> </span><span class="ff12">=<span class="_ _13"> </span><span class="ff7">log</span></span></div><div class="t m5 x146 h33 y5702 ff7 fs20 fc2 sc0 ls0 ws0">2</div><div class="t m5 x77 h31 y298e ff11 fs21 fc2 sc0 ls0 ws0">(S<span class="_ _2"></span>)<span class="_ _118"> </span><span class="ff7">Number<span class="_"> </span>of<span class="_"> </span><span class="ffa">set<span class="_"> </span>index<span class="_"> </span>bits</span></span></div><div class="t m5 x17 h32 y5703 ff11 fs21 fc2 sc0 ls0 ws0">b<span class="_ _13"> </span><span class="ff12">=<span class="_ _10"> </span><span class="ff7">log</span></span></div><div class="t m5 x239 h33 y5704 ff7 fs20 fc2 sc0 ls0 ws0">2</div><div class="t m5 x19f h31 y1037 ff11 fs21 fc2 sc0 ls0 ws0">(B<span class="_ _5"></span>)<span class="_ _68"> </span><span class="ff7">Number<span class="_"> </span>of<span class="_"> </span><span class="ffa">block<span class="_"> </span>offset<span class="_"> </span>bits</span></span></div><div class="t m5 x17 h32 y5705 ff11 fs21 fc2 sc0 ls0 ws0">t<span class="_"> </span><span class="ff12">=<span class="_ _13"></span></span>m<span class="_ _13"> </span><span class="ff12">−<span class="_ _13"></span></span>(s<span class="_ _10"> </span><span class="ff12">+<span class="_ _13"> </span></span><span class="ls125">b)<span class="_ _26"> </span></span><span class="ff7">Number<span class="_"> </span>of<span class="_"> </span><span class="ffa">tag<span class="_"> </span>bits</span></span></div><div class="t m5 x17 h32 y5706 ff11 fs21 fc2 sc0 ls0 ws0">C<span class="_ _10"> </span><span class="ff12">=<span class="_ _13"> </span></span>B<span class="_"> </span><span class="ff12">×<span class="_ _13"></span></span>E<span class="_ _10"> </span><span class="ff12">×<span class="_ _13"></span></span>S<span class="_ _95"> </span><span class="ff7">Cache<span class="_"> </span>size<span class="_"> </span>(bytes),<span class="_"> </span>not<span class="_"> </span>including<span class="_"> </span>overhead<span class="_"> </span>such<span class="_"> </span>as<span class="_"> </span>the<span class="_"> </span>valid<span class="_"> </span>and<span class="_"> </span>tag<span class="_"> </span>bits</span></div><div class="t m5 x17 h2f ycb4 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>6.26<span class="_ _66"> </span><span class="fc1">Summar<span class="_ _2"></span>y<span class="_"> </span>of<span class="_"> </span>cache<span class="_"> </span>parameters.</span></div><div class="t m5 x17 h2f y5707 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>6.27</div><div class="t m5 x17 h2f y5708 ffe fs16 fc1 sc0 ls0 ws0">Direct-mapped<span class="_ _16"> </span>cache</div><div class="t m5 x17 h35 y5709 ffe fs16 fc1 sc0 ls0 ws0">(<span class="ff11">E<span class="_ _10"> </span><span class="ff12">=<span class="_ _13"> </span><span class="ff7">1<span class="_ _0"></span><span class="ffe">).<span class="_ _16"> </span><span class="ff6">There<span class="_ _11"> </span>is<span class="_ _16"> </span>exactly</span></span></span></span></span></div><div class="t m5 x17 h34 y570a ff6 fs16 fc1 sc0 ls0 ws0">one<span class="_ _10"> </span>line<span class="_ _11"> </span>per<span class="_ _10"> </span>set.</div><div class="t m5 x49 h3f y570b ff82 fs27 fc1 sc0 ls0 ws0">V<span class="_ _1"></span>alid<span class="_ _7b"> </span>T<span class="_ _7"></span>ag<span class="_ _2c"> </span>Cache block</div><div class="t m5 x48 h3f y570c ff82 fs27 fc1 sc0 ls0 ws0">Set 0:</div><div class="t m5 x49 h3f y570d ff82 fs27 fc1 sc0 ls0 ws0">V<span class="_ _1"></span>alid<span class="_ _7b"> </span>T<span class="_ _7"></span>ag<span class="_ _2c"> </span>Cache block</div><div class="t m5 x48 h3f y570e ff82 fs27 fc1 sc0 ls0 ws0">Set 1:</div><div class="t m5 x49 h3f y570f ff82 fs27 fc1 sc0 ls0 ws0">V<span class="_ _1"></span>alid<span class="_ _7b"> </span>T<span class="_ _7"></span>ag<span class="_ _2c"> </span>Cache block</div><div class="t m5 xb3 h3f y5710 ff82 fs27 fc1 sc0 ls0 ws0">Set <span class="ff80">S</span>–1:</div><div class="t m7 x1c9 h3f y5711 ff82 fs27 fc1 sc0 ls0 ws0">. . .</div><div class="t m5 x1e9 h3f y5712 ff80 fs27 fc1 sc0 ls0 ws0">E<span class="ff82"> = 1 line per set</span></div><div class="t m5 x17 h41 y5713 ffe fs29 fc1 sc0 ls0 ws0">6.4.2<span class="_ _48"> </span><span class="fs19">Direct-Mapped<span class="_"> </span>Caches</span></div><div class="t m5 x17 h26 y2e92 ff7 fs19 fc1 sc0 ls0 ws0">Caches<span class="_"> </span>are<span class="_ _11"> </span>grouped<span class="_ _11"> </span>into<span class="_ _11"> </span>different<span class="_ _11"> </span>classes<span class="_ _11"> </span>based<span class="_ _11"> </span>on<span class="_"> </span><span class="ff11">E<span class="_ _5"></span></span>,<span class="_ _11"> </span>the<span class="_ _11"> </span>number<span class="_ _11"> </span>of<span class="_ _11"> </span>cache<span class="_"> </span>lines</div><div class="t m5 x17 h46 y2e93 ff7 fs19 fc1 sc0 ls0 ws0">per<span class="_"> </span>set.<span class="_ _13"> </span>A<span class="_"> </span>cache<span class="_ _13"> </span>with<span class="_"> </span>exactly<span class="_ _13"> </span>one<span class="_"> </span>line<span class="_ _13"> </span>per<span class="_"> </span>set<span class="_ _13"> </span>(<span class="ff11">E<span class="_ _11"> </span><span class="ff12">=<span class="_ _13"></span></span></span>1<span class="_ _1"></span>)<span class="_"> </span>is<span class="_ _13"> </span>known<span class="_"> </span>as<span class="_"> </span>a<span class="_ _13"> </span><span class="ffa">direct-mapped</span></div><div class="t m5 x17 h26 y2e94 ff7 fs19 fc1 sc0 ls0 ws0">cache<span class="_ _13"> </span>(see<span class="_ _6"> </span>Figure<span class="_ _6"> </span>6.27).<span class="_ _13"> </span>Direct-mapped<span class="_ _13"> </span>caches<span class="_ _13"> </span>are<span class="_ _6"> </span>the<span class="_ _13"> </span>simplest<span class="_ _13"> </span>both<span class="_ _13"> </span>to<span class="_ _6"> </span>implement</div><div class="t m5 x17 h26 y2e95 ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_"> </span>to<span class="_"> </span>understand,<span class="_"> </span>so<span class="_"> </span>we<span class="_"> </span>will<span class="_"> </span>use<span class="_"> </span>them<span class="_"> </span>to<span class="_"> </span>illustrate<span class="_"> </span>some<span class="_"> </span>general<span class="_"> </span>concepts<span class="_"> </span>about</div><div class="t m5 x17 h26 y2e96 ff7 fs19 fc1 sc0 ls0 ws0">how<span class="_"> </span>caches<span class="_"> </span>work.</div><div class="t m5 x26 h26 y2e97 ff7 fs19 fc1 sc0 ls0 ws0">Suppose<span class="_ _13"> </span>we<span class="_ _13"> </span>have<span class="_"> </span>a<span class="_ _13"> </span>system<span class="_ _13"> </span>with<span class="_ _13"> </span>a<span class="_"> </span>CPU<span class="_ _7"></span>,<span class="_"> </span>a<span class="_ _13"> </span>register<span class="_ _13"> </span>ﬁle<span class="_ _0"></span>,<span class="_ _13"> </span>an<span class="_"> </span>L1<span class="_ _13"> </span>cache<span class="_ _1"></span>,<span class="_"> </span>and<span class="_ _13"> </span>a<span class="_ _13"> </span>main</div><div class="t m5 x17 h26 y2e98 ff7 fs19 fc1 sc0 ls0 ws0">memory<span class="_ _3"></span>.<span class="_ _16"> </span>When<span class="_ _16"> </span>the<span class="_ _14"> </span>CPU<span class="_ _14"> </span>executes<span class="_ _16"> </span>an<span class="_ _14"> </span>instruction<span class="_ _14"> </span>that<span class="_ _16"> </span>reads<span class="_ _14"> </span>a<span class="_ _14"> </span>memory<span class="_ _14"> </span>word<span class="_ _16"> </span><span class="ff11">w<span class="_ _2"></span></span>,</div><div class="t m5 x17 h26 y2e99 ff7 fs19 fc1 sc0 ls0 ws0">it<span class="_ _11"> </span>requests<span class="_ _16"> </span>the<span class="_ _11"> </span>word<span class="_ _16"> </span>from<span class="_ _11"> </span>the<span class="_ _16"> </span>L1<span class="_ _11"> </span>cache.<span class="_"> </span>If<span class="_ _16"> </span>the<span class="_ _11"> </span>L1<span class="_ _16"> </span>cache<span class="_ _11"> </span>has<span class="_ _16"> </span>a<span class="_ _11"> </span>cached<span class="_ _16"> </span>copy<span class="_ _11"> </span>of<span class="_ _16"> </span><span class="ff11">w<span class="_ _2"></span></span>,</div><div class="t m5 x17 h26 y2e9a ff7 fs19 fc1 sc0 ls0 ws0">then<span class="_ _11"> </span>we<span class="_ _11"> </span>have<span class="_ _11"> </span>an<span class="_ _11"> </span>L1<span class="_ _11"> </span>cache<span class="_ _16"> </span>hit,<span class="_ _11"> </span>and<span class="_ _11"> </span>the<span class="_ _11"> </span>cache<span class="_ _11"> </span>quickly<span class="_ _11"> </span>extracts<span class="_ _11"> </span><span class="ff11">w<span class="_"> </span></span>and<span class="_ _11"> </span>returns<span class="_ _11"> </span>it<span class="_ _11"> </span>to</div><div class="t m5 x17 h26 y2e9b ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>CPU<span class="_ _3"></span>.<span class="_ _11"> </span>Otherwise<span class="_ _0"></span>,<span class="_ _11"> </span>we<span class="_"> </span>have<span class="_ _11"> </span>a<span class="_ _11"> </span>cache<span class="_ _11"> </span>miss<span class="_ _1"></span>,<span class="_ _11"> </span>and<span class="_"> </span>the<span class="_ _11"> </span>CPU<span class="_ _11"> </span>must<span class="_ _11"> </span>wait<span class="_"> </span>while<span class="_ _11"> </span>the<span class="_ _11"> </span>L1</div><div class="t m5 x17 h26 y2e9c ff7 fs19 fc1 sc0 ls0 ws0">cache<span class="_ _16"> </span>requests<span class="_ _16"> </span>a<span class="_ _16"> </span>copy<span class="_ _16"> </span>of<span class="_ _16"> </span>the<span class="_ _14"> </span>block<span class="_ _16"> </span>containing<span class="_ _16"> </span><span class="ff11">w<span class="_ _14"> </span></span>from<span class="_ _14"> </span>the<span class="_ _16"> </span>main<span class="_ _16"> </span>memory<span class="_ _3"></span>.<span class="_ _16"> </span>When</div><div class="t m5 x17 h26 y2e9d ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>requested<span class="_ _13"> </span>block<span class="_"> </span>ﬁnally<span class="_"> </span>arrives<span class="_"> </span>from<span class="_ _13"> </span>memory<span class="_ _3"></span>,<span class="_"> </span>the<span class="_"> </span>L1<span class="_"> </span>cache<span class="_ _13"> </span>stores<span class="_"> </span>the<span class="_"> </span>block<span class="_"> </span>in</div><div class="t m5 x17 h26 y2e9e ff7 fs19 fc1 sc0 ls0 ws0">one<span class="_"> </span>of<span class="_"> </span>its<span class="_ _13"> </span>cache<span class="_"> </span>lines<span class="_ _1"></span>,<span class="_"> </span>extracts<span class="_"> </span>word<span class="_ _13"> </span><span class="ff11">w<span class="_ _11"> </span></span>from<span class="_"> </span>the<span class="_"> </span>stored<span class="_"> </span>block,<span class="_ _13"> </span>and<span class="_"> </span>returns<span class="_"> </span>it<span class="_"> </span>to<span class="_ _13"> </span>the</div><div class="t m5 x17 h26 y2e9f ff7 fs19 fc1 sc0 ls0 ws0">CPU<span class="_ _3"></span>.<span class="_ _13"> </span>T<span class="_ _1"></span>he<span class="_"> </span>process<span class="_ _13"> </span>that<span class="_ _13"> </span>a<span class="_ _13"> </span>cache<span class="_ _13"> </span>goes<span class="_ _13"> </span>through<span class="_ _13"> </span>of<span class="_"> </span>determining<span class="_ _13"> </span>whether<span class="_ _13"> </span>a<span class="_ _13"> </span>request<span class="_ _13"> </span>is<span class="_ _13"> </span>a</div><div class="t m5 x17 h26 y2ea0 ff7 fs19 fc1 sc0 ls0 ws0">hit<span class="_ _13"> </span>or<span class="_"> </span>a<span class="_ _13"> </span>miss<span class="_ _13"> </span>and<span class="_ _13"> </span>then<span class="_"> </span>extracting<span class="_ _13"> </span>the<span class="_ _13"> </span>requested<span class="_"> </span>word<span class="_ _13"> </span>consists<span class="_ _13"> </span>of<span class="_ _13"> </span>three<span class="_"> </span>steps:<span class="_ _13"> </span>(1)<span class="_ _13"> </span><span class="ffa">set</span></div><div class="t m5 x17 h26 y2ea1 ffa fs19 fc1 sc0 ls0 ws0">selection<span class="ff7">,<span class="_"> </span>(2)<span class="_"> </span></span>line<span class="_"> </span>matching<span class="ff7">,<span class="_"> </span>and<span class="_"> </span>(3)<span class="_"> </span></span>word<span class="_"> </span>extraction<span class="ff7">.</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
