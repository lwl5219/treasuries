<div id="pf16c" class="pf w2 h11" data-page-no="16c"><div class="pc pc16c w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg16c.png"/><div class="t m5 x107 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Solutions<span class="_ _10"> </span>to<span class="_ _10"> </span>Practice<span class="_ _10"> </span>Problems<span class="_ _1b"> </span><span class="ffe fs1e">363</span></div><div class="t m5 x17 h2d y140c ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _7a"> </span>char<span class="_ _6f"> </span>movl<span class="_ _11"> </span>(%rdi),<span class="_ _11"> </span>%eax</div><div class="t m5 x82 h31 y9c ff7 fs21 fc2 sc0 ls0 ws0">Read<span class="_"> </span>4<span class="_"> </span>bytes</div><div class="t m5 x8f h31 y1d16 ffd fs1e fc2 sc0 ls0 ws0">movb<span class="_ _11"> </span>%al,<span class="_ _11"> </span>(%rsi)<span class="_ _5a"> </span><span class="ff7 fs21">Store<span class="_"> </span>low-order<span class="_"> </span>byte</span></div><div class="t m5 x17 h31 y3329 ffd fs1e fc2 sc0 ls0 ws0">unsigned<span class="_ _d0"> </span>unsigned<span class="_ _3f"> </span>movl<span class="_ _11"> </span>(%rdi),<span class="_ _11"> </span>%eax<span class="_ _8c"> </span><span class="ff7 fs21">Read<span class="_"> </span>4<span class="_"> </span>bytes</span></div><div class="t m5 x178 h31 y332a ffd fs1e fc2 sc0 ls0 ws0">char<span class="_ _6f"> </span>movb<span class="_ _11"> </span>%al,<span class="_ _11"> </span>(%rsi)<span class="_ _5a"> </span><span class="ff7 fs21">Store<span class="_"> </span>low-order<span class="_"> </span>byte</span></div><div class="t m5 x17 h31 y332b ffd fs1e fc2 sc0 ls0 ws0">char<span class="_ _16d"> </span>short<span class="_ _5a"> </span>movsbw<span class="_ _11"> </span>(%rdi),<span class="_ _11"> </span>%ax<span class="_ _46"> </span><span class="ff7 fs21">Read<span class="_"> </span>byte<span class="_"> </span>and<span class="_"> </span>sign-extend</span></div><div class="t m5 x8f h31 y332c ffd fs1e fc2 sc0 ls0 ws0">movw<span class="_ _11"> </span>%ax,<span class="_ _11"> </span>(%rsi)<span class="_ _5a"> </span><span class="ff7 fs21">Store<span class="_"> </span>2<span class="_"> </span>bytes</span></div><div class="t m5 x17 h28 y332d ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>3.5<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>225)</span></div><div class="t m5 x17 h26 y332e ff7 fs19 fc1 sc0 ls0 ws0">Reverse<span class="_ _11"> </span>engineering<span class="_ _16"> </span>is<span class="_ _16"> </span>a<span class="_ _11"> </span>good<span class="_ _16"> </span>way<span class="_ _11"> </span>to<span class="_ _16"> </span>understand<span class="_ _11"> </span>systems<span class="_ _1"></span>.<span class="_ _16"> </span>In<span class="_ _16"> </span>this<span class="_ _11"> </span>case<span class="_ _0"></span>,<span class="_ _16"> </span>we<span class="_ _11"> </span>want</div><div class="t m5 x17 h26 y332f ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_"> </span>reverse<span class="_"> </span>the<span class="_ _13"> </span>effect<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>C<span class="_"> </span>compiler<span class="_"> </span>to<span class="_ _13"> </span>determine<span class="_"> </span>what<span class="_"> </span>C<span class="_"> </span>code<span class="_"> </span>gave<span class="_ _13"> </span>rise<span class="_"> </span>to<span class="_"> </span>this</div><div class="t m5 x17 h26 y3330 ff7 fs19 fc1 sc0 ls0 ws0">assembly<span class="_ _13"> </span>code<span class="_ _1"></span>.<span class="_ _13"> </span>The<span class="_ _13"> </span>best<span class="_ _13"> </span>way<span class="_ _13"> </span>is<span class="_ _13"> </span>to<span class="_ _13"> </span>run<span class="_ _13"> </span>a<span class="_ _13"> </span>“simulation,<span class="_ _3"></span>”<span class="_"> </span>starting<span class="_ _13"> </span>with<span class="_ _13"> </span>values<span class="_ _13"> </span><span class="ffd">x</span>,<span class="_ _13"> </span><span class="ffd">y</span>,<span class="_ _13"> </span>and</div><div class="t m5 x17 h26 y3331 ffd fs19 fc1 sc0 ls0 ws0">z<span class="_ _11"> </span><span class="ff7">at<span class="_ _16"> </span>the<span class="_ _16"> </span>locations<span class="_ _11"> </span>designated<span class="_ _16"> </span>by<span class="_ _16"> </span>pointers<span class="_ _11"> </span></span>xp<span class="ff7">,<span class="_ _16"> </span></span>yp<span class="ff7">,<span class="_ _16"> </span>and<span class="_ _16"> </span></span>zp<span class="ff7">,<span class="_ _16"> </span>respectively<span class="_ _3"></span>.<span class="_ _11"> </span>W<span class="_ _1"></span>e<span class="_ _16"> </span>would</span></div><div class="t m5 x17 h26 y3332 ff7 fs19 fc1 sc0 ls0 ws0">then<span class="_"> </span>get<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>behavior:</div><div class="t m5 xee h61 y3333 ff13 fs35 fc6 sc0 ls0 ws0">void<span class="_ _f"> </span>decode1(long<span class="_ _f"> </span>*xp,<span class="_ _f"> </span>long<span class="_ _e"> </span>*yp,<span class="_ _21"> </span>long<span class="_ _f"> </span>*zp)</div><div class="t m5 xee h61 y3334 ff13 fs35 fc6 sc0 ls0 ws0">xp<span class="_ _f"> </span>in<span class="_ _f"> </span>%rdi,<span class="_ _f"> </span>yp<span class="_ _e"> </span>in<span class="_ _21"> </span>%rsi,<span class="_ _f"> </span>zp<span class="_ _e"> </span>in<span class="_ _21"> </span>%rdx</div><div class="t m5 x17 h2d y3335 ffd fs1e fc2 sc0 ls0 ws0">decode1:</div><div class="t m5 x72 h2d y3336 ffd fs1e fc2 sc0 ls0 ws0">movq<span class="_ _46"> </span>(%rdi),<span class="_ _e"> </span>%r8</div><div class="t m5 x235 h61 y3337 ff13 fs35 fc6 sc0 ls0 ws0">Get<span class="_ _f"> </span>x<span class="_ _f"> </span>=<span class="_ _f"> </span>*xp</div><div class="t m5 x72 h2d y3338 ffd fs1e fc2 sc0 ls0 ws0">movq<span class="_ _46"> </span>(%rsi),<span class="_ _e"> </span>%rcx<span class="_ _f1"> </span><span class="ff13 fs35 fc6">Get<span class="_ _f"> </span>y<span class="_ _f"> </span>=<span class="_ _f"> </span>*yp</span></div><div class="t m5 x72 h2d y3339 ffd fs1e fc2 sc0 ls0 ws0">movq<span class="_ _46"> </span>(%rdx),<span class="_ _e"> </span>%rax<span class="_ _f1"> </span><span class="ff13 fs35 fc6">Get<span class="_ _f"> </span>z<span class="_ _f"> </span>=<span class="_ _f"> </span>*zp</span></div><div class="t m5 x72 h2d y333a ffd fs1e fc2 sc0 ls0 ws0">movq<span class="_ _46"> </span>%r8,<span class="_ _e"> </span>(%rsi)<span class="_ _93"> </span><span class="ff13 fs35 fc6">Store<span class="_ _e"> </span>x<span class="_ _21"> </span>at<span class="_ _f"> </span>yp</span></div><div class="t m5 x72 h2d y333b ffd fs1e fc2 sc0 ls0 ws0">movq<span class="_ _46"> </span>%rcx,<span class="_ _e"> </span>(%rdx)<span class="_ _f1"> </span><span class="ff13 fs35 fc6">Store<span class="_ _f"> </span>y<span class="_ _f"> </span>at<span class="_ _f"> </span>zp</span></div><div class="t m5 x72 h2d y333c ffd fs1e fc2 sc0 ls0 ws0">movq<span class="_ _46"> </span>%rax,<span class="_ _e"> </span>(%rdi)<span class="_ _f1"> </span><span class="ff13 fs35 fc6">Store<span class="_ _f"> </span>z<span class="_ _f"> </span>at<span class="_ _f"> </span>xp</span></div><div class="t m5 x72 h2d y333d ffd fs1e fc2 sc0 ls0 ws0">ret</div><div class="t m5 x17 h26 y333e ff7 fs19 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>rom<span class="_"> </span>this<span class="_ _1"></span>,<span class="_"> </span>we<span class="_"> </span>can<span class="_"> </span>generate<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>C<span class="_"> </span>code:</div><div class="t m5 x17 h2d y333f ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>decode1(long<span class="_ _1f"> </span>*xp,<span class="_ _1f"> </span>long<span class="_ _e"> </span>*yp,<span class="_ _1f"> </span>long<span class="_ _e"> </span>*zp)</div><div class="t m5 x17 h2d y3340 ffd fs1e fc2 sc0 ls0 ws0">{</div><div class="t m5 x1b6 h2d y3341 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>x<span class="_ _1f"> </span>=<span class="_ _1f"> </span>*xp;</div><div class="t m5 x1b6 h2d y3342 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>y<span class="_ _1f"> </span>=<span class="_ _1f"> </span>*yp;</div><div class="t m5 x1b6 h2d y3343 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>z<span class="_ _1f"> </span>=<span class="_ _1f"> </span>*zp;</div><div class="t m5 x1b6 h2d y3344 ffd fs1e fc2 sc0 ls33 ws0">*<span class="_ _41"></span>y<span class="_ _41"></span>p=x<span class="_ _41"></span>;</div><div class="t m5 x1b6 h2d y3345 ffd fs1e fc2 sc0 ls33 ws0">*<span class="_ _41"></span>z<span class="_ _41"></span>p=y<span class="_ _41"></span>;</div><div class="t m5 x1b6 h2d y3346 ffd fs1e fc2 sc0 ls33 ws0">*<span class="_ _41"></span>x<span class="_ _41"></span>p=z<span class="_ _41"></span>;</div><div class="t m5 x17 h2d y3347 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x17 h28 y3348 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>3.6</div><div class="t m5 xc3 h2f y3349 ffe fs16 fc6 sc0 ls0 ws0">(page<span class="_"> </span>228)</div><div class="t m5 x17 h26 ye14 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _16"> </span>exercise<span class="_ _14"> </span>demonstrates<span class="_ _16"> </span>the<span class="_ _16"> </span>versatility<span class="_ _16"> </span>of<span class="_ _16"> </span>the<span class="_ _16"> </span><span class="ffd">leaq<span class="_ _16"> </span></span>instruction<span class="_ _14"> </span>and<span class="_ _16"> </span>gives<span class="_ _16"> </span>you</div><div class="t m5 x17 h26 ye15 ff7 fs19 fc1 sc0 ls0 ws0">more<span class="_"> </span>practice<span class="_"> </span>in<span class="_"> </span>deciphering<span class="_"> </span>the<span class="_"> </span>different<span class="_"> </span>operand<span class="_"> </span>forms<span class="_ _3"></span>.<span class="_"> </span>Although<span class="_"> </span>the<span class="_"> </span>operand</div><div class="t m5 x17 h26 ye16 ff7 fs19 fc1 sc0 ls0 ws0">forms<span class="_"> </span>are<span class="_"> </span>classiﬁed<span class="_"> </span>as<span class="_"> </span>type<span class="_"> </span>“Memory”<span class="_"> </span>in<span class="_"> </span>F<span class="_ _1"></span>igure<span class="_"> </span>3.3,<span class="_"> </span>no<span class="_"> </span>memory<span class="_"> </span>access<span class="_"> </span>occurs<span class="_ _1"></span>.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
