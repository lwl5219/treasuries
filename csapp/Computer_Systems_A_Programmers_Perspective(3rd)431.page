<div id="pf1af" class="pf w2 h11" data-page-no="1af"><div class="pc pc1af w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1af.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">430<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>4<span class="_ _3d"> </span>Processor<span class="_ _10"> </span>Architecture</span></div><div class="t m5 x28 h2a y257 fff fs1c fc2 sc0 ls0 ws0">Aside<span class="_ _1b"> </span><span class="ff6 fs19">T<span class="_ _3"></span>racing<span class="_ _11"> </span>the<span class="_ _11"> </span>execution<span class="_ _16"> </span>of<span class="_ _11"> </span>a<span class="_ _11"> </span><span class="ffd fs2b">je<span class="_ _11"> </span></span>instruction</span></div><div class="t m5 x28 h2b y2d0 ff7 fs1e fc2 sc0 ls0 ws0">Let<span class="_"> </span>us<span class="_"> </span>trace<span class="_"> </span>the<span class="_"> </span>processing<span class="_"> </span>of<span class="_"> </span>the<span class="_ _13"> </span><span class="ffd">je<span class="_ _10"> </span></span>instruction<span class="_"> </span>on<span class="_"> </span>line<span class="_"> </span>8<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>object<span class="_ _13"> </span>code<span class="_"> </span>shown<span class="_"> </span>in<span class="_"> </span>F<span class="_ _1"></span>igure<span class="_"> </span>4.17.<span class="_"> </span>The</div><div class="t m5 x28 h2b y2d1 ff7 fs1e fc2 sc0 ls0 ws0">condition<span class="_ _13"> </span>codes<span class="_ _13"> </span>were<span class="_ _6"> </span>all<span class="_ _13"> </span>set<span class="_ _13"> </span>to<span class="_ _13"> </span>zero<span class="_ _13"> </span>by<span class="_ _6"> </span>the<span class="_ _13"> </span><span class="ffd">subq<span class="_ _13"> </span></span>instruction<span class="_ _13"> </span>(line<span class="_ _13"> </span>3),<span class="_ _13"> </span>and<span class="_ _6"> </span>so<span class="_ _13"> </span>the<span class="_ _13"> </span>branch<span class="_ _13"> </span>will<span class="_ _13"> </span>not<span class="_ _6"> </span>be<span class="_ _13"> </span>taken.</div><div class="t m5 x28 h2b y2d2 ff7 fs1e fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _11"> </span>instruction<span class="_"> </span>is<span class="_ _11"> </span>located<span class="_"> </span>at<span class="_ _11"> </span>address<span class="_"> </span><span class="ffd">0x02e<span class="_ _11"> </span></span>and<span class="_"> </span>consists<span class="_ _11"> </span>of<span class="_"> </span>9<span class="_ _11"> </span>bytes<span class="_ _1"></span>.<span class="_"> </span>The<span class="_"> </span>ﬁrst<span class="_"> </span>has<span class="_ _11"> </span>value<span class="_"> </span><span class="ffd">0x73</span>,<span class="_ _11"> </span>while<span class="_"> </span>the</div><div class="t m5 x28 h2b y2d3 ff7 fs1e fc2 sc0 ls0 ws0">remaining<span class="_ _11"> </span>8<span class="_ _11"> </span>bytes<span class="_ _11"> </span>are<span class="_ _11"> </span>a<span class="_ _11"> </span>byte-reversed<span class="_ _11"> </span>version<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _16"> </span>number<span class="_ _10"> </span><span class="ffd">0x0000000000000040</span>,<span class="_ _16"> </span>the<span class="_ _11"> </span>jump<span class="_ _11"> </span>target.</div><div class="t m5 x28 h2b y2d4 ff7 fs1e fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>stages<span class="_"> </span>would<span class="_"> </span>proceed<span class="_"> </span>as<span class="_"> </span>follows:</div><div class="t m5 x5b h31 y3b83 ff7 fs21 fc2 sc0 ls0 ws0">Generic<span class="_ _15d"> </span>Speciﬁc</div><div class="t m5 x28 h31 y3b84 ff7 fs21 fc2 sc0 ls0 ws0">Stage</div><div class="t m5 x5b h93 y3b85 ffd fs1e fc2 sc0 ls0 ws0">jXX<span class="_ _11"> </span><span class="ff6 fs21">Dest<span class="_ _1b0"> </span></span>je<span class="_ _11"> </span>0x040</div><div class="t m5 x28 h32 y3b86 ff7 fs21 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>etch<span class="_ _55"> </span><span class="ff6">icode<span class="_ _a"> </span></span>:<span class="_ _be"></span><span class="ff6">ifun<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>M</span></div><div class="t m5 x7c h33 y3b87 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x235 h32 y3b88 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">PC</span>]<span class="_ _2c"> </span><span class="ff6">icode<span class="_ _a"> </span></span>:<span class="_ _be"></span><span class="ff6">ifun<span class="_ _23"> </span><span class="ff12">←<span class="_ _23"> </span></span>M</span></div><div class="t m5 xc0 h33 y3b87 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x1fc h32 y3b88 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ffd fs1e">0x02e</span>]<span class="_ _6"> </span><span class="ff12">=<span class="_ _13"> </span><span class="ffd fs1e">7:3</span></span></div><div class="t m5 x5b h32 y3b11 ff6 fs21 fc2 sc0 ls0 ws0">valC<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>M</div><div class="t m5 x21f h33 y3b89 ff7 fs20 fc2 sc0 ls0 ws0">8</div><div class="t m5 x145 h32 y3b11 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">PC<span class="_ _13"> </span><span class="ff12">+<span class="_ _13"> </span></span></span>1]<span class="_ _148"> </span><span class="ff6">valC<span class="_ _25"> </span><span class="ff12">←<span class="_ _25"> </span></span>M</span></div><div class="t m5 x1ae h33 y3b89 ff7 fs20 fc2 sc0 ls0 ws0">8</div><div class="t m5 xd8 h32 y3b11 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ffd fs1e">0x02f</span>]<span class="_ _6"> </span><span class="ff12">=<span class="_ _13"> </span><span class="ffd fs1e">0x040</span></span></div><div class="t m5 x5b h32 y3b8a ff6 fs21 fc2 sc0 ls0 ws0">valP<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>PC<span class="_ _13"> </span><span class="ff12">+<span class="_ _13"> </span><span class="ff7">9<span class="_ _169"> </span></span></span>valP<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span><span class="ffd fs1e">0x02e<span class="_ _13"> </span></span>+<span class="_ _10"> </span><span class="ff7">9<span class="_ _13"> </span></span>=<span class="_ _13"></span><span class="ffd fs1e">0x037</span></span></div><div class="t m5 x28 h31 y3b8b ff7 fs21 fc2 sc0 ls0 ws0">Decode</div><div class="t m5 x28 h31 y3b8c ff7 fs21 fc2 sc0 ls0 ws0">Execute</div><div class="t m5 x5b h32 y3b8d ff6 fs21 fc2 sc0 ls0 ws0">Cnd<span class="_ _23"> </span><span class="ff12">←<span class="_ _23"> </span></span>Cond<span class="ff11">(</span>CC<span class="ff11">,<span class="_ _13"> </span></span>ifun<span class="_ _1"></span><span class="ff11">)<span class="_ _4f"> </span><span class="ff6">Cnd<span class="_ _23"> </span><span class="ff12">←<span class="_ _23"> </span></span>Cond</span>(<span class="ff12"><span class="ff7">0</span></span>,<span class="_ _13"> </span><span class="ff7">0</span>,<span class="_ _13"> </span><span class="ff7">0<span class="ff12"></span></span>,</span></div><div class="t m5 x237 h32 y3b8e ffd fs1e fc2 sc0 ls0 ws0">3<span class="ff11 fs21">)<span class="_ _13"> </span><span class="ff12">=<span class="_ _13"> </span><span class="ff7">0</span></span></span></div><div class="t m5 x28 h31 y3b8f ff7 fs21 fc2 sc0 ls0 ws0">Memory</div><div class="t m5 x28 h31 y3b90 ff7 fs21 fc2 sc0 ls0 ws0">Write<span class="_"> </span>back</div><div class="t m5 x28 h32 y3b91 ff7 fs21 fc2 sc0 ls0 ws0">PC<span class="_"> </span>update<span class="_ _45"> </span><span class="ff6">PC<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>Cnd<span class="_ _13"> </span></span>?<span class="_ _6"> </span><span class="ff6">valC<span class="_ _13"> </span></span>:<span class="_ _13"> </span><span class="ff6">valP<span class="_ _45"> </span>PC<span class="_ _25"> </span><span class="ff12">←<span class="_ _25"> </span></span></span><span class="ls1b9">0?</span></div><div class="t m5 x23b h32 y3b92 ffd fs1e fc2 sc0 ls0 ws0">0x040<span class="_ _13"> </span><span class="ff7 fs21">:<span class="_ _13"> </span></span>0x037<span class="_ _13"> </span><span class="ff12 fs21">=<span class="_ _13"></span></span>0x037</div><div class="t m5 x57 h2b y3b93 ff7 fs1e fc2 sc0 ls0 ws0">As<span class="_"> </span>this<span class="_"> </span>trace<span class="_"> </span>shows<span class="_ _1"></span>,<span class="_"> </span>the<span class="_"> </span>instruction<span class="_"> </span>has<span class="_"> </span>the<span class="_"> </span>effect<span class="_"> </span>of<span class="_"> </span>incrementing<span class="_"> </span>the<span class="_"> </span>PC<span class="_"> </span>by<span class="_"> </span>9.</div><div class="t m5 x29 h26 y3b94 ff7 fs19 fc2 sc0 ls0 ws0">Instructions<span class="_ _6"> </span><span class="ffd">call<span class="_ _6"> </span></span>and<span class="_ _6"> </span><span class="ffd">ret<span class="_ _13"> </span></span>bear<span class="_ _a"> </span>some<span class="_ _6"> </span>similarity<span class="_ _13"> </span>to<span class="_ _a"> </span>instructions<span class="_ _6"> </span><span class="ffd">pushq<span class="_ _13"> </span></span>and<span class="_ _a"> </span><span class="ffd">popq</span>,</div><div class="t m5 x1d h26 y3b95 ff7 fs19 fc2 sc0 ls0 ws0">except<span class="_ _11"> </span>that<span class="_ _11"> </span>we<span class="_ _11"> </span>push<span class="_ _11"> </span>and<span class="_ _11"> </span>pop<span class="_ _11"> </span>program<span class="_ _11"> </span>counter<span class="_ _11"> </span>values<span class="_ _1"></span>.<span class="_ _11"> </span>With<span class="_"> </span>instruction<span class="_ _11"> </span><span class="ffd">call</span><span class="ls118">,w<span class="_ _49"></span>e</span></div><div class="t m5 x1d h26 y3b96 ff7 fs19 fc2 sc0 ls0 ws0">push<span class="_"> </span><span class="ff6">valP</span>,<span class="_ _13"> </span>the<span class="_"> </span>address<span class="_ _13"> </span>of<span class="_"> </span>the<span class="_"> </span>instruction<span class="_ _13"> </span>that<span class="_"> </span>follows<span class="_ _13"> </span>the<span class="_"> </span><span class="ffd">call<span class="_ _10"> </span></span>instruction.<span class="_ _13"> </span>During</div><div class="t m5 x1d h26 y3b97 ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span>PC<span class="_"> </span>update<span class="_ _11"> </span>stage<span class="_ _0"></span>,<span class="_"> </span>we<span class="_"> </span>set<span class="_ _11"> </span>the<span class="_"> </span>PC<span class="_ _11"> </span>to<span class="_"> </span><span class="ff6">valC</span>,<span class="_"> </span>the<span class="_ _11"> </span>call<span class="_"> </span>destination.<span class="_ _11"> </span>W<span class="_ _0"></span>ith<span class="_"> </span>instruction</div><div class="t m5 x1d h26 y3b98 ffd fs19 fc2 sc0 ls0 ws0">ret<span class="ff7">,<span class="_"> </span>we<span class="_ _13"> </span>assign<span class="_"> </span><span class="ff6">valM</span>,<span class="_ _13"> </span>the<span class="_"> </span>value<span class="_ _13"> </span>popped<span class="_ _13"> </span>from<span class="_"> </span>the<span class="_ _13"> </span>stack,<span class="_"> </span>to<span class="_ _13"> </span>the<span class="_"> </span>PC<span class="_ _13"> </span>in<span class="_"> </span>the<span class="_ _13"> </span>PC<span class="_"> </span>update</span></div><div class="t m5 x1d h26 y3b99 ff7 fs19 fc2 sc0 ls0 ws0">stage<span class="_ _1"></span>.</div><div class="t m5 x1d h47 y3b9a ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>4.18<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>523)</span></div><div class="t m5 x1d h26 y3b9b ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>ill<span class="_ _11"> </span>in<span class="_ _11"> </span>the<span class="_ _11"> </span>right-hand<span class="_ _11"> </span>column<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_"> </span>following<span class="_ _11"> </span>table<span class="_ _11"> </span>to<span class="_ _11"> </span>describe<span class="_ _11"> </span>the<span class="_ _11"> </span>processing<span class="_ _11"> </span>of</div><div class="t m5 x1d h26 y3b9c ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span><span class="ffd">call<span class="_ _10"> </span></span>instruction<span class="_"> </span>on<span class="_"> </span>line<span class="_"> </span>9<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>object<span class="_"> </span>code<span class="_"> </span>in<span class="_"> </span>F<span class="_ _0"></span>igure<span class="_"> </span>4.17:</div><div class="t m5 x50 h31 y3b9d ff7 fs21 fc2 sc0 ls0 ws0">Generic<span class="_ _15a"> </span>Speciﬁc</div><div class="t m5 x1d h31 y3b9e ff7 fs21 fc2 sc0 ls0 ws0">Stage</div><div class="t m5 x50 h93 y3b9f ffd fs1e fc2 sc0 ls0 ws0">call<span class="_ _11"> </span><span class="ff6 fs21">Dest<span class="_ _175"> </span></span>call<span class="_ _11"> </span>0x041</div><div class="t m5 x1d h32 y3ba0 ff7 fs21 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>etch<span class="_ _55"> </span><span class="ff6">icode<span class="_ _a"> </span></span>:<span class="_ _be"></span><span class="ff6">ifun<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>M</span></div><div class="t m5 x1b1 h33 y3ba1 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x119 h31 y3ba0 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">PC</span>]</div><div class="t m5 x50 h32 y3ba2 ff6 fs21 fc2 sc0 ls0 ws0">valC<span class="_ _25"> </span><span class="ff12">←<span class="_ _23"> </span></span>M</div><div class="t m5 xdd h33 y3ba3 ff7 fs20 fc2 sc0 ls0 ws0">8</div><div class="t m5 x9f h32 y3ba4 ff7 fs21 fc2 sc0 ls0 ws0">[<span class="ff6">PC<span class="_ _13"> </span><span class="ff12">+<span class="_ _13"> </span></span></span>1]</div><div class="t m5 x50 h32 y3ba5 ff6 fs21 fc2 sc0 ls0 ws0">valP<span class="_ _23"> </span><span class="ff12">←<span class="_ _25"> </span></span>PC<span class="_ _13"> </span><span class="ff12">+<span class="_ _13"> </span><span class="ff7">9</span></span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
