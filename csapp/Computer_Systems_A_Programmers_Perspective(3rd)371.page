<div id="pf173" class="pf w2 h11" data-page-no="173"><div class="pc pc173 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg173.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">370<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>3<span class="_ _3d"> </span>Machine-Level<span class="_ _10"> </span>Representation<span class="_ _10"> </span>of<span class="_ _10"> </span>Programs</span></div><div class="t m5 x4f h46 y9c ff7 fs19 fc2 sc0 ls0 ws0">(assuming<span class="_ _14"> </span>that<span class="_ _15"> </span>we<span class="_ _14"> </span>have<span class="_ _15"> </span>already<span class="_ _14"> </span>ensured<span class="_ _15"> </span>that<span class="_ _14"> </span>the<span class="_ _14"> </span>computation<span class="_ _15"> </span>of<span class="_ _15"> </span><span class="ff11">(n<span class="_ _10"> </span><span class="ff12">−<span class="_ _13"> </span></span></span>1<span class="_ _0"></span><span class="ff11">)<span class="ff7">!</span></span></div><div class="t m5 x4f h46 y409 ff7 fs19 fc2 sc0 ls0 ws0">did<span class="_"> </span>not<span class="_ _11"> </span>overﬂow).<span class="_"> </span>In<span class="_ _11"> </span>this<span class="_"> </span>case<span class="_ _11"> </span>we<span class="_ _11"> </span>get<span class="_"> </span>1<span class="_ _1"></span><span class="ff11">,<span class="ff7">278</span>,<span class="ff7">945</span>,<span class="ff7">280</span>/<span class="ff7">14<span class="_"> </span><span class="ff12">=<span class="_ _13"></span></span>91353234</span>.<span class="ff7 ls1a">286.<span class="_"> </span>As</span></span></div><div class="t m5 x4f h26 y40a ff7 fs19 fc2 sc0 ls0 ws0">a<span class="_"> </span>second<span class="_ _13"> </span>test,<span class="_"> </span>we<span class="_ _13"> </span>can<span class="_"> </span>see<span class="_"> </span>that<span class="_ _13"> </span>any<span class="_"> </span>factorial<span class="_ _13"> </span>beyond<span class="_"> </span>10!<span class="_ _a"> </span>must<span class="_"> </span>be<span class="_"> </span>a<span class="_ _13"> </span>multiple<span class="_"> </span>of</div><div class="t m5 x4f h26 y40b ff7 fs19 fc2 sc0 ls0 ws0">100<span class="_"> </span>and<span class="_"> </span>therefore<span class="_"> </span>have<span class="_ _13"> </span>zeros<span class="_"> </span>for<span class="_"> </span>the<span class="_"> </span>last<span class="_"> </span>two<span class="_ _13"> </span>digits<span class="_ _0"></span>.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_"> </span>correct<span class="_"> </span>value<span class="_"> </span>of<span class="_ _13"> </span>14!</div><div class="t m5 x4f h26 y40c ff7 fs19 fc2 sc0 ls0 ws0">is<span class="_"> </span>87,178,291,200.</div><div class="t m5 x1b7 h26 y40d ff7 fs19 fc2 sc0 ls0 ws0">Further,<span class="_ _13"> </span>we<span class="_ _13"> </span>can<span class="_ _13"> </span>build<span class="_ _13"> </span>up<span class="_"> </span>a<span class="_ _13"> </span>table<span class="_ _13"> </span>of<span class="_ _13"> </span>factorials<span class="_ _13"> </span>computed<span class="_ _13"> </span>through<span class="_ _13"> </span>14!<span class="_ _a"> </span>with</div><div class="t m5 x4f h26 y40e ff7 fs19 fc2 sc0 ls0 ws0">data<span class="_"> </span>type<span class="_"> </span><span class="ffd">int</span>,<span class="_"> </span>as<span class="_"> </span>shown<span class="_"> </span>below:</div><div class="t m5 x32 h31 y3402 ff11 fs21 fc2 sc0 ls19a ws0">nn<span class="_ _18e"></span><span class="ff7 ls0">!<span class="_ _10d"> </span>OK?</span></div><div class="t m5 xc2 h31 y3403 ff7 fs21 fc2 sc0 ls19b ws0">11<span class="_ _18f"></span>Y</div><div class="t m5 xc2 h31 y3404 ff7 fs21 fc2 sc0 ls19b ws0">22<span class="_ _18f"></span>Y</div><div class="t m5 xc2 h31 y3405 ff7 fs21 fc2 sc0 ls19b ws0">36<span class="_ _18f"></span>Y</div><div class="t m5 xc2 h31 y3406 ff7 fs21 fc2 sc0 ls19c ws0">42<span class="_ _190"></span>4<span class="_ _191"></span>Y</div><div class="t m5 xc2 h31 y3407 ff7 fs21 fc2 sc0 ls0 ws0">5<span class="_ _6a"> </span>120<span class="_ _14a"> </span>Y</div><div class="t m5 xc2 h31 y3408 ff7 fs21 fc2 sc0 ls0 ws0">6<span class="_ _6a"> </span>720<span class="_ _14a"> </span>Y</div><div class="t m5 xc2 h31 y3409 ff7 fs21 fc2 sc0 ls0 ws0">7<span class="_ _192"> </span>5,040<span class="_ _4f"> </span>Y</div><div class="t m5 xc2 h31 y340a ff7 fs21 fc2 sc0 ls0 ws0">8<span class="_ _86"> </span>40,320<span class="_ _14a"> </span>Y</div><div class="t m5 xc2 h31 y340b ff7 fs21 fc2 sc0 ls0 ws0">9<span class="_ _156"> </span>362,880<span class="_ _4f"> </span>Y</div><div class="t m5 xc4 h31 y340c ff7 fs21 fc2 sc0 ls0 ws0">10<span class="_ _64"> </span>3,628,800<span class="_ _14a"> </span>Y</div><div class="t m5 xc4 h31 y340d ff7 fs21 fc2 sc0 ls0 ws0">11<span class="_ _18c"> </span>39,916,800<span class="_ _14a"> </span>Y</div><div class="t m5 xc4 h31 y340e ff7 fs21 fc2 sc0 ls0 ws0">12<span class="_ _11a"> </span>479,001,600<span class="_ _14a"> </span>Y</div><div class="t m5 xc4 h31 y340f ff7 fs21 fc2 sc0 ls0 ws0">13<span class="_ _4c"> </span>1,932,053,504<span class="_ _14a"> </span>N</div><div class="t m5 xc4 h31 y3410 ff7 fs21 fc2 sc0 ls0 ws0">14<span class="_ _4c"> </span>1,278,945,280<span class="_ _14a"> </span>N</div><div class="t m5 x124 h26 y3411 ff7 fs19 fc2 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>Doing<span class="_"> </span>the<span class="_"> </span>computation<span class="_ _13"> </span>with<span class="_"> </span>data<span class="_"> </span>type<span class="_"> </span><span class="ffd">long<span class="_ _13"> </span></span>lets<span class="_"> </span>us<span class="_"> </span>go<span class="_ _13"> </span>up<span class="_"> </span>to<span class="_"> </span>20!<span class="_ _3"></span>,<span class="_"> </span>thus<span class="_ _13"> </span>the<span class="_"> </span>14!</div><div class="t m5 x4f h26 y3412 ff7 fs19 fc2 sc0 ls0 ws0">computation<span class="_"> </span>does<span class="_"> </span>not<span class="_"> </span>overﬂow<span class="_ _3"></span>.</div><div class="t m5 x1d h28 y3413 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>3.23<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>258)</span></div><div class="t m5 x1d h26 y3414 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _16"> </span>code<span class="_ _11"> </span>generated<span class="_ _16"> </span>when<span class="_ _11"> </span>compiling<span class="_ _11"> </span>loops<span class="_ _16"> </span>can<span class="_ _11"> </span>be<span class="_ _16"> </span>tricky<span class="_ _11"> </span>to<span class="_ _11"> </span>analyze,<span class="_ _11"> </span>because<span class="_ _11"> </span>the</div><div class="t m5 x1d h26 y3415 ff7 fs19 fc1 sc0 ls0 ws0">compiler<span class="_"> </span>can<span class="_"> </span>perform<span class="_ _11"> </span>many<span class="_"> </span>different<span class="_"> </span>optimizations<span class="_ _11"> </span>on<span class="_"> </span>loop<span class="_ _11"> </span>code<span class="_ _1"></span>,<span class="_ _11"> </span>and<span class="_"> </span>because<span class="_ _11"> </span>it</div><div class="t m5 x1d h26 y3416 ff7 fs19 fc1 sc0 ls0 ws0">can<span class="_ _13"> </span>be<span class="_ _13"> </span>difﬁcult<span class="_ _13"> </span>to<span class="_ _13"> </span>match<span class="_"> </span>program<span class="_ _13"> </span>variables<span class="_ _13"> </span>with<span class="_ _13"> </span>registers<span class="_ _3"></span>.<span class="_"> </span>T<span class="_ _3"></span>his<span class="_"> </span>particular<span class="_ _13"> </span>example</div><div class="t m5 x1d h26 y3417 ff7 fs19 fc1 sc0 ls0 ws0">demonstrates<span class="_ _6"> </span>several<span class="_ _6"> </span>places<span class="_ _6"> </span>where<span class="_ _6"> </span>the<span class="_ _6"> </span>assembly<span class="_ _6"> </span>code<span class="_ _6"> </span>is<span class="_ _13"> </span>not<span class="_ _a"> </span>just<span class="_ _6"> </span>a<span class="_ _6"> </span>direct<span class="_ _6"> </span>translation</div><div class="t m5 x1d h26 y3418 ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_"> </span>the<span class="_"> </span>C<span class="_"> </span>code<span class="_ _1"></span>.</div><div class="t m5 x124 h26 y3419 ff7 fs19 fc1 sc0 ls0 ws0">A.<span class="_ _1f"> </span>Although<span class="_"> </span>parameter<span class="_"> </span><span class="ffd">x<span class="_ _10"> </span></span>is<span class="_"> </span>passed<span class="_"> </span>to<span class="_ _13"> </span>the<span class="_"> </span>function<span class="_"> </span>in<span class="_"> </span>register<span class="_"> </span><span class="ffd">%rdi</span>,<span class="_"> </span>we<span class="_"> </span>can<span class="_"> </span>see</div><div class="t m5 x4f h26 y341a ff7 fs19 fc1 sc0 ls0 ws0">that<span class="_ _16"> </span>the<span class="_ _16"> </span>register<span class="_ _16"> </span>is<span class="_ _14"> </span>never<span class="_ _16"> </span>referenced<span class="_ _16"> </span>once<span class="_ _14"> </span>the<span class="_ _16"> </span>loop<span class="_ _16"> </span>is<span class="_ _16"> </span>entered.<span class="_ _14"> </span>Instead,<span class="_ _16"> </span>we</div><div class="t m5 x4f h26 y341b ff7 fs19 fc1 sc0 ls0 ws0">can<span class="_ _11"> </span>see<span class="_ _11"> </span>that<span class="_ _16"> </span>registers<span class="_ _11"> </span><span class="ffd">%rbx</span>,<span class="_ _16"> </span><span class="ffd">%rcx</span>,<span class="_ _11"> </span>and<span class="_ _11"> </span><span class="ffd">%rdx<span class="_ _16"> </span></span>are<span class="_ _11"> </span>initialized<span class="_ _11"> </span>in<span class="_ _11"> </span>lines<span class="_ _16"> </span>2–5<span class="_ _11"> </span>to<span class="_ _11"> </span><span class="ffd">x</span>,</div><div class="t m5 x4f h26 y341c ffd fs19 fc1 sc0 ls0 ws0">x/9<span class="ff7">,<span class="_ _16"> </span>and<span class="_ _16"> </span></span>4*x<span class="ff7">.<span class="_ _14"> </span>W<span class="_ _3"></span>e<span class="_ _16"> </span>can<span class="_ _16"> </span>conclude,<span class="_ _16"> </span>therefore<span class="_ _1"></span>,<span class="_ _14"> </span>that<span class="_ _16"> </span>these<span class="_ _16"> </span>registers<span class="_ _14"> </span>contain<span class="_ _16"> </span>the</span></div><div class="t m5 x4f h26 y341d ff7 fs19 fc1 sc0 ls0 ws0">program<span class="_"> </span>variables<span class="_ _1"></span>.</div><div class="t m5 x124 h26 y341e ff7 fs19 fc1 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>The<span class="_ _11"> </span>compiler<span class="_ _16"> </span>determines<span class="_ _14"> </span>that<span class="_ _16"> </span>pointer<span class="_ _16"> </span><span class="ffd">p<span class="_ _16"> </span></span>always<span class="_ _16"> </span>points<span class="_ _16"> </span>to<span class="_ _14"> </span><span class="ffd">x</span>,<span class="_ _16"> </span>and<span class="_ _14"> </span>hence<span class="_ _16"> </span>the</div><div class="t m5 x4f h26 y341f ff7 fs19 fc1 sc0 ls0 ws0">expression<span class="_ _11"> </span><span class="ffd">(*p)+=5<span class="_ _11"> </span></span>simply<span class="_ _11"> </span>increments<span class="_ _16"> </span><span class="ffd">x</span>.<span class="_ _11"> </span>It<span class="_ _11"> </span>combines<span class="_ _11"> </span>this<span class="_ _11"> </span>incrementing<span class="_ _16"> </span>by</div><div class="t m5 x4f h26 y3420 ff7 fs19 fc1 sc0 ls0 ws0">5<span class="_"> </span>with<span class="_"> </span>the<span class="_"> </span>increment<span class="_"> </span>of<span class="_"> </span><span class="ffd">y</span>,<span class="_"> </span>via<span class="_"> </span>the<span class="_"> </span><span class="ffd">leaq<span class="_ _10"> </span></span>instruction<span class="_"> </span>of<span class="_"> </span>line<span class="_"> </span>7.</div><div class="t m5 x124 h26 ye58 ff7 fs19 fc1 sc0 ls0 ws0">C.<span class="_ _25"> </span>T<span class="_ _1"></span>he<span class="_"> </span>annotated<span class="_"> </span>code<span class="_"> </span>is<span class="_"> </span>as<span class="_"> </span>follows:</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
