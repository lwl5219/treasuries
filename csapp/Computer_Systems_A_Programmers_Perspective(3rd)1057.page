<div id="pf421" class="pf w2 h11" data-page-no="421"><div class="pc pc421 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg421.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">1056<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>12<span class="_ _3d"> </span>Concurrent<span class="_ _10"> </span>Programming</span></div><div class="t m5 x29 h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">W<span class="_ _3"></span>eak<span class="_ _15"> </span>scaling<span class="_ _14"> </span>is<span class="_ _15"> </span>often<span class="_ _14"> </span>a<span class="_ _15"> </span>truer<span class="_ _15"> </span>measure<span class="_ _14"> </span>than<span class="_ _15"> </span>strong<span class="_ _14"> </span>scaling<span class="_ _15"> </span>because<span class="_ _14"> </span>it<span class="_ _15"> </span>more</div><div class="t m5 x1d h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">accurately<span class="_ _14"> </span>reﬂects<span class="_ _15"> </span>our<span class="_ _15"> </span>desire<span class="_ _14"> </span>to<span class="_ _15"> </span>use<span class="_ _15"> </span>bigger<span class="_ _14"> </span>machines<span class="_ _15"> </span>to<span class="_ _15"> </span>do<span class="_ _14"> </span>more<span class="_ _15"> </span>work.<span class="_ _15"> </span>T<span class="_ _1"></span>his<span class="_ _15"> </span>is</div><div class="t m5 x1d h26 y2a8 ff7 fs19 fc2 sc0 ls0 ws0">particularly<span class="_ _6"> </span>true<span class="_ _6"> </span>for<span class="_ _6"> </span>scientiﬁc<span class="_ _6"> </span>codes<span class="_ _1"></span>,<span class="_ _13"> </span>where<span class="_ _6"> </span>the<span class="_ _6"> </span>problem<span class="_ _6"> </span>size<span class="_ _6"> </span>can<span class="_ _6"> </span>be<span class="_ _6"> </span>easily<span class="_ _6"> </span>increased</div><div class="t m5 x1d h26 y2f7 ff7 fs19 fc2 sc0 ls0 ws0">and<span class="_"> </span>where<span class="_"> </span>bigger<span class="_"> </span>problem<span class="_"> </span>sizes<span class="_"> </span>translate<span class="_ _11"> </span>directly<span class="_"> </span>to<span class="_"> </span>better<span class="_"> </span>predictions<span class="_"> </span>of<span class="_ _11"> </span>nature<span class="_ _1"></span>.</div><div class="t m5 x1d h26 y2f8 ff7 fs19 fc2 sc0 ls0 ws0">However,<span class="_ _13"> </span>there<span class="_"> </span>exist<span class="_"> </span>applications<span class="_"> </span>whose<span class="_"> </span>sizes<span class="_ _13"> </span>are<span class="_"> </span>not<span class="_"> </span>so<span class="_"> </span>easily<span class="_ _13"> </span>increased,<span class="_"> </span>and<span class="_"> </span>for</div><div class="t m5 x1d h26 y2f9 ff7 fs19 fc2 sc0 ls0 ws0">these<span class="_ _13"> </span>applications<span class="_"> </span>strong<span class="_ _13"> </span>scaling<span class="_ _13"> </span>is<span class="_ _13"> </span>more<span class="_"> </span>appropriate<span class="_ _1"></span>.<span class="_ _13"> </span>F<span class="_ _1"></span>or<span class="_"> </span>example<span class="_ _1"></span>,<span class="_"> </span>the<span class="_ _13"> </span>amount<span class="_ _13"> </span>of</div><div class="t m5 x1d h26 y2fa ff7 fs19 fc2 sc0 ls0 ws0">work<span class="_ _11"> </span>performed<span class="_ _16"> </span>by<span class="_ _16"> </span>real-time<span class="_ _11"> </span>signal-processing<span class="_ _16"> </span>applications<span class="_ _16"> </span>is<span class="_ _11"> </span>often<span class="_ _16"> </span>determined</div><div class="t m5 x1d h26 y2fb ff7 fs19 fc2 sc0 ls0 ws0">by<span class="_ _13"> </span>the<span class="_"> </span>properties<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_"> </span>physical<span class="_ _13"> </span>sensors<span class="_ _13"> </span>that<span class="_"> </span>are<span class="_ _13"> </span>generating<span class="_ _13"> </span>the<span class="_"> </span>signals<span class="_ _3"></span>.<span class="_ _13"> </span>Changing</div><div class="t m5 x1d h26 y2fc ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _6"> </span>total<span class="_ _13"> </span>amount<span class="_ _a"> </span>of<span class="_ _13"> </span>work<span class="_ _a"> </span>requires<span class="_ _13"> </span>using<span class="_ _6"> </span>different<span class="_ _6"> </span>physical<span class="_ _13"> </span>sensors<span class="_ _3"></span>,<span class="_ _13"> </span>which<span class="_ _6"> </span>might<span class="_ _6"> </span>not</div><div class="t m5 x1d h26 y2fd ff7 fs19 fc2 sc0 ls0 ws0">be<span class="_ _6"> </span>feasible<span class="_ _6"> </span>or<span class="_ _6"> </span>necessary<span class="_ _3"></span>.<span class="_ _a"> </span>F<span class="_ _0"></span>or<span class="_ _6"> </span>these<span class="_ _6"> </span>applications<span class="_ _1"></span>,<span class="_ _6"> </span>we<span class="_ _6"> </span>typically<span class="_ _6"> </span>want<span class="_ _6"> </span>to<span class="_ _6"> </span>use<span class="_ _6"> </span>parallelism</div><div class="t m5 x1d h26 y2fe ff7 fs19 fc2 sc0 ls0 ws0">to<span class="_"> </span>accomplish<span class="_"> </span>a<span class="_"> </span>ﬁxed<span class="_"> </span>amount<span class="_"> </span>of<span class="_"> </span>work<span class="_"> </span>as<span class="_"> </span>quickly<span class="_"> </span>as<span class="_"> </span>possible<span class="_ _1"></span>.</div><div class="t m5 x1d h47 y838e ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>12.11<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>1074)</span></div><div class="t m5 x1d h26 y28a ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>ill<span class="_ _16"> </span>in<span class="_ _11"> </span>the<span class="_ _11"> </span>blanks<span class="_ _16"> </span>for<span class="_ _11"> </span>the<span class="_ _16"> </span>parallel<span class="_ _11"> </span>program<span class="_ _11"> </span>in<span class="_ _16"> </span>the<span class="_ _11"> </span>following<span class="_ _11"> </span>table.<span class="_"> </span>Assume<span class="_ _16"> </span>strong</div><div class="t m5 x1d h26 y28b ff7 fs19 fc1 sc0 ls0 ws0">scaling.</div><div class="t m5 x1d h31 y228e ff7 fs21 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>hreads<span class="_"> </span>(<span class="ff11">t<span class="_ _be"> </span></span><span class="ls2ff">)1<span class="_ _11f"></span>4<span class="_ _10f"></span>8</span></div><div class="t m5 x1d h31 y838f ff7 fs21 fc2 sc0 ls0 ws0">Cores<span class="_"> </span>(<span class="ff11">p<span class="_ _2"></span></span><span class="ls300">)1<span class="_ _c8"></span>4<span class="_ _dd"></span>8</span></div><div class="t m5 x1d h31 y8390 ff7 fs21 fc2 sc0 ls0 ws0">Running<span class="_"> </span>time<span class="_"> </span>(<span class="ff11">T</span></div><div class="t m5 x15c h51 y8391 ff11 fs20 fc2 sc0 ls0 ws0">p</div><div class="t m5 x1a6 h31 y8390 ff7 fs21 fc2 sc0 ls301 ws0">)1<span class="_ _124"></span>6<span class="_ _1c"> </span>8<span class="_ _72"> </span>4</div><div class="t m5 x1d h31 y8392 ff7 fs21 fc2 sc0 ls0 ws0">Speedup<span class="_"> </span>(<span class="ff11">S</span></div><div class="t m5 x1cc h51 y8393 ff11 fs20 fc2 sc0 ls0 ws0">p</div><div class="t m5 xcc h31 y2c19 ff7 fs21 fc2 sc0 ls302 ws0">)1</div><div class="t m5 x1d h31 y8394 ff7 fs21 fc1 sc0 ls0 ws0">Efﬁciency<span class="_"> </span>(<span class="ff11">E</span></div><div class="t m5 x141 h51 y8395 ff11 fs20 fc1 sc0 ls0 ws0">p</div><div class="t m5 x135 h31 y3aba ff7 fs21 fc1 sc0 ls0 ws0">)<span class="_ _2c"> </span>100%</div><div class="t m5 x1d h3b y8396 fff fs24 fc6 sc0 ls0 ws0">12.7<span class="_ _17"> </span><span class="ffe fs18">Other<span class="_"> </span>Concurrency<span class="_"> </span>Issues</span></div><div class="t m5 x1d h26 y8397 ff7 fs19 fc1 sc0 ls0 ws0">Y<span class="_ _3"></span>ou<span class="_ _11"> </span>probably<span class="_ _16"> </span>noticed<span class="_ _11"> </span>that<span class="_ _16"> </span>life<span class="_ _11"> </span>got<span class="_ _16"> </span>much<span class="_ _11"> </span>more<span class="_ _16"> </span>complicated<span class="_ _11"> </span>once<span class="_ _16"> </span>we<span class="_ _11"> </span>were<span class="_ _16"> </span>asked</div><div class="t m5 x1d h26 y8398 ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_ _11"> </span>synchronize<span class="_ _11"> </span>accesses<span class="_ _11"> </span>to<span class="_ _11"> </span>shared<span class="_ _11"> </span>data.<span class="_ _11"> </span>So<span class="_ _16"> </span>far<span class="_ _0"></span>,<span class="_ _11"> </span>we<span class="_ _11"> </span>have<span class="_ _11"> </span>looked<span class="_ _11"> </span>at<span class="_ _11"> </span>techniques<span class="_ _16"> </span>for</div><div class="t m5 x1d h26 y8399 ff7 fs19 fc1 sc0 ls0 ws0">mutual<span class="_"> </span>exclusion<span class="_ _13"> </span>and<span class="_"> </span>producer<span class="_ _1"></span>-consumer<span class="_"> </span>synchronization,<span class="_"> </span>but<span class="_"> </span>this<span class="_ _13"> </span>is<span class="_"> </span>only<span class="_"> </span>the<span class="_"> </span>tip</div><div class="t m5 x1d h26 y839a ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_ _14"> </span>the<span class="_ _14"> </span>iceberg.<span class="_ _16"> </span>Synchronization<span class="_ _14"> </span>is<span class="_ _14"> </span>a<span class="_ _14"> </span>fundamentally<span class="_ _14"> </span>difﬁcult<span class="_ _14"> </span>problem<span class="_ _14"> </span>that<span class="_ _14"> </span>raises</div><div class="t m5 x1d h26 y839b ff7 fs19 fc1 sc0 ls0 ws0">issues<span class="_ _11"> </span>that<span class="_ _11"> </span>simply<span class="_ _16"> </span>do<span class="_ _11"> </span>not<span class="_ _11"> </span>arise<span class="_ _16"> </span>in<span class="_ _11"> </span>ordinary<span class="_ _11"> </span>sequential<span class="_ _16"> </span>programs<span class="_ _3"></span>.<span class="_ _16"> </span>T<span class="_ _1"></span>his<span class="_ _11"> </span>section<span class="_ _16"> </span>is<span class="_ _11"> </span>a</div><div class="t m5 x1d h26 y839c ff7 fs19 fc1 sc0 ls0 ws0">survey<span class="_ _14"> </span>(by<span class="_ _16"> </span>no<span class="_ _14"> </span>means<span class="_ _14"> </span>complete)<span class="_ _14"> </span>of<span class="_ _14"> </span>some<span class="_ _14"> </span>of<span class="_ _14"> </span>the<span class="_ _14"> </span>issues<span class="_ _14"> </span>you<span class="_ _14"> </span>need<span class="_ _16"> </span>to<span class="_ _14"> </span>be<span class="_ _14"> </span>aware<span class="_ _14"> </span>of</div><div class="t m5 x1d h26 y839d ff7 fs19 fc1 sc0 ls0 ws0">when<span class="_"> </span>you<span class="_"> </span>write<span class="_"> </span>concurrent<span class="_"> </span>programs<span class="_ _1"></span>.<span class="_"> </span>T<span class="_ _7"></span>o<span class="_"> </span>keep<span class="_"> </span>things<span class="_"> </span>concrete,<span class="_"> </span>we<span class="_"> </span>will<span class="_"> </span>couch<span class="_ _13"> </span>our</div><div class="t m5 x1d h26 y839e ff7 fs19 fc1 sc0 ls0 ws0">discussion<span class="_ _13"> </span>in<span class="_ _13"> </span>terms<span class="_ _6"> </span>of<span class="_ _13"> </span>threads<span class="_ _1"></span>.<span class="_ _13"> </span>Keep<span class="_ _13"> </span>in<span class="_ _6"> </span>mind,<span class="_ _13"> </span>however,<span class="_ _13"> </span>that<span class="_ _13"> </span>these<span class="_ _13"> </span>are<span class="_ _13"> </span>typical<span class="_ _6"> </span>of<span class="_ _13"> </span>the</div><div class="t m5 x1d h26 y839f ff7 fs19 fc1 sc0 ls0 ws0">issues<span class="_"> </span>that<span class="_"> </span>arise<span class="_"> </span>when<span class="_"> </span>concurrent<span class="_"> </span>ﬂows<span class="_"> </span>of<span class="_"> </span>any<span class="_"> </span>kind<span class="_"> </span>manipulate<span class="_"> </span>shared<span class="_"> </span>resources<span class="_ _1"></span>.</div><div class="t m5 x1d h41 y83a0 ffe fs29 fc1 sc0 ls0 ws0">12.7.1<span class="_ _48"> </span><span class="fs19">Thread<span class="_"> </span>Safety</span></div><div class="t m5 x1d h26 y83a1 ff7 fs19 fc1 sc0 ls0 ws0">When<span class="_ _13"> </span>we<span class="_"> </span>program<span class="_ _13"> </span>with<span class="_"> </span>threads<span class="_ _3"></span>,<span class="_"> </span>we<span class="_"> </span>must<span class="_ _13"> </span>be<span class="_"> </span>careful<span class="_ _13"> </span>to<span class="_"> </span>write<span class="_ _13"> </span>functions<span class="_"> </span>that<span class="_ _13"> </span>have<span class="_"> </span>a</div><div class="t m5 x1d h26 y83a2 ff7 fs19 fc1 sc0 ls0 ws0">property<span class="_ _6"> </span>called<span class="_ _6"> </span>thread<span class="_ _6"> </span>safety<span class="_ _3"></span>.<span class="_ _6"> </span>A<span class="_ _13"> </span>function<span class="_ _a"> </span>is<span class="_ _6"> </span>said<span class="_ _6"> </span>to<span class="_ _13"> </span>be<span class="_ _a"> </span><span class="ffa">thread-safe<span class="_ _13"> </span></span>if<span class="_ _a"> </span>and<span class="_ _6"> </span>only<span class="_ _6"> </span>if<span class="_ _13"> </span>it<span class="_ _a"> </span>will</div><div class="t m5 x1d h26 y83a3 ff7 fs19 fc1 sc0 ls0 ws0">always<span class="_ _11"> </span>produce<span class="_ _11"> </span>correct<span class="_ _11"> </span>results<span class="_ _11"> </span>when<span class="_ _11"> </span>called<span class="_ _11"> </span>repeatedly<span class="_ _16"> </span>from<span class="_"> </span>multiple<span class="_ _11"> </span>concurrent</div><div class="t m5 x1d h26 y83a4 ff7 fs19 fc1 sc0 ls0 ws0">threads<span class="_ _1"></span>.<span class="_"> </span>If<span class="_"> </span>a<span class="_"> </span>function<span class="_"> </span>is<span class="_"> </span>not<span class="_"> </span>thread-safe<span class="_ _1"></span>,<span class="_"> </span>then<span class="_"> </span>we<span class="_"> </span>say<span class="_"> </span>it<span class="_"> </span>is<span class="_"> </span><span class="ffa">thread-unsafe<span class="_ _2"></span></span>.</div><div class="t m5 x29 h26 y83a5 ff7 fs19 fc1 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_"> </span>can<span class="_"> </span>identify<span class="_"> </span>four<span class="_"> </span>(nondisjoint)<span class="_"> </span>classes<span class="_"> </span>of<span class="_"> </span>thread-unsafe<span class="_"> </span>functions:</div><div class="t m5 x75 h26 y83a6 ff7 fs19 fc1 sc0 ls0 ws0">Class<span class="_ _15"> </span>1:<span class="_ _1f"> </span><span class="ffa">Functions<span class="_ _14"> </span>that<span class="_ _15"> </span>do<span class="_ _15"> </span>not<span class="_ _15"> </span>protect<span class="_ _15"> </span>shared<span class="_ _15"> </span>variables<span class="_ _1"></span>.<span class="_ _16"> </span><span class="ff7">W<span class="_ _3"></span>e<span class="_ _15"> </span>have<span class="_ _15"> </span>already<span class="_ _15"> </span>en-</span></span></div><div class="t m5 xcd h26 y83a7 ff7 fs19 fc1 sc0 ls0 ws0">countered<span class="_ _11"> </span>this<span class="_ _11"> </span>problem<span class="_ _16"> </span>with<span class="_"> </span>the<span class="_ _16"> </span><span class="ffd">thread<span class="_ _11"> </span></span>function<span class="_ _11"> </span>in<span class="_ _11"> </span>Figure<span class="_"> </span>12.16,<span class="_ _16"> </span>which</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
