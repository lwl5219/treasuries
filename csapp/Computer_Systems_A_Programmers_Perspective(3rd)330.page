<div id="pf14a" class="pf w2 h11" data-page-no="14a"><div class="pc pc14a w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg14a.png"/><div class="t m5 x195 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>3.11<span class="_ _60"> </span>Floating-Point<span class="_ _10"> </span>Code<span class="_ _3e"> </span><span class="ffe fs1e">329</span></div><div class="t m5 x26 h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">In<span class="_ _13"> </span>earlier<span class="_ _6"> </span>versions<span class="_ _13"> </span>of<span class="_ _13"> </span>x86<span class="_ _6"> </span>code,<span class="_ _6"> </span>the<span class="_ _13"> </span>frame<span class="_ _13"> </span>pointer<span class="_ _6"> </span>was<span class="_ _13"> </span>used<span class="_ _13"> </span>with<span class="_ _6"> </span>every<span class="_ _13"> </span>function</div><div class="t m5 x17 h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">call.<span class="_ _16"> </span>W<span class="_ _1"></span>ith<span class="_ _16"> </span>x86-64<span class="_ _16"> </span>code<span class="_ _0"></span>,<span class="_ _16"> </span>it<span class="_ _16"> </span>is<span class="_ _16"> </span>used<span class="_ _16"> </span>only<span class="_ _16"> </span>in<span class="_ _11"> </span>cases<span class="_ _16"> </span>where<span class="_ _16"> </span>the<span class="_ _16"> </span>stack<span class="_ _16"> </span>frame<span class="_ _16"> </span>may<span class="_ _16"> </span>be<span class="_ _16"> </span>of</div><div class="t m5 x17 h26 y2a8 ff7 fs19 fc2 sc0 ls0 ws0">variable<span class="_"> </span>size<span class="_ _1"></span>,<span class="_"> </span>as<span class="_"> </span>is<span class="_"> </span>the<span class="_ _13"> </span>case<span class="_"> </span>for<span class="_"> </span>function<span class="_"> </span><span class="ffd">vframe</span>.<span class="_ _13"> </span>Historically<span class="_ _3"></span>,<span class="_"> </span>most<span class="_"> </span>compilers<span class="_"> </span>used</div><div class="t m5 x17 h26 y2f7 ff7 fs19 fc2 sc0 ls0 ws0">frame<span class="_ _13"> </span>pointers<span class="_"> </span>when<span class="_ _13"> </span>generating<span class="_"> </span>IA32<span class="_ _13"> </span>code<span class="_ _1"></span>.<span class="_"> </span>Recent<span class="_ _13"> </span>versions<span class="_ _13"> </span>of<span class="_"> </span><span class="ff9">gcc<span class="_ _13"> </span></span>have<span class="_"> </span>dropped</div><div class="t m5 x17 h26 y2f8 ff7 fs19 fc2 sc0 ls0 ws0">this<span class="_ _13"> </span>convention.<span class="_ _13"> </span>Observe<span class="_ _13"> </span>that<span class="_ _13"> </span>it<span class="_ _13"> </span>is<span class="_ _13"> </span>acceptable<span class="_"> </span>to<span class="_ _13"> </span>mix<span class="_ _13"> </span>code<span class="_ _13"> </span>that<span class="_ _13"> </span>uses<span class="_ _13"> </span>frame<span class="_ _13"> </span>pointers</div><div class="t m5 x17 h26 y2f9 ff7 fs19 fc2 sc0 ls0 ws0">with<span class="_ _6"> </span>code<span class="_ _6"> </span>that<span class="_ _6"> </span>does<span class="_ _6"> </span>not,<span class="_ _13"> </span>as<span class="_ _6"> </span>long<span class="_ _6"> </span>as<span class="_ _6"> </span>all<span class="_ _13"> </span>functions<span class="_ _a"> </span>treat<span class="_ _6"> </span><span class="ffd">%rbp<span class="_ _13"> </span></span>as<span class="_ _a"> </span>a<span class="_ _6"> </span>callee-saved<span class="_ _6"> </span>register.</div><div class="t m5 x17 h47 y2f02 ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>3.49<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>383)</span></div><div class="t m5 x17 h26 y2f03 ff7 fs19 fc1 sc0 ls0 ws0">In<span class="_ _16"> </span>this<span class="_ _14"> </span>problem,<span class="_ _14"> </span>we<span class="_ _14"> </span>will<span class="_ _16"> </span>explore<span class="_ _14"> </span>the<span class="_ _14"> </span>logic<span class="_ _16"> </span>behind<span class="_ _14"> </span>the<span class="_ _16"> </span>code<span class="_ _14"> </span>in<span class="_ _14"> </span>lines<span class="_ _16"> </span>5–11<span class="_ _14"> </span>of<span class="_ _16"> </span>Fig-</div><div class="t m5 x17 h26 y2f04 ff7 fs19 fc1 sc0 ls0 ws0">ure<span class="_"> </span>3.43(b),<span class="_"> </span>where<span class="_ _13"> </span>space<span class="_"> </span>is<span class="_"> </span>allocated<span class="_"> </span>for<span class="_ _13"> </span>variable-size<span class="_"> </span>array<span class="_"> </span><span class="ffd">p</span>.<span class="_ _13"> </span>As<span class="_"> </span>the<span class="_"> </span>annotations</div><div class="t m5 x17 h26 y2f05 ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_"> </span>the<span class="_ _13"> </span>code<span class="_"> </span>indicate<span class="_ _1"></span>,<span class="_"> </span>let<span class="_ _13"> </span>us<span class="_"> </span>let<span class="_"> </span><span class="ff11">s</span></div><div class="t m5 xb3 h3c y2f06 ff7 fs25 fc1 sc0 ls0 ws0">1</div><div class="t m5 x79 h26 y2f07 ff7 fs19 fc1 sc0 ls0 ws0">denote<span class="_"> </span>the<span class="_ _13"> </span>address<span class="_"> </span>of<span class="_ _13"> </span>the<span class="_"> </span>stack<span class="_ _13"> </span>pointer<span class="_"> </span>after<span class="_"> </span>exe-</div><div class="t m5 x17 h26 y2f08 ff7 fs19 fc1 sc0 ls0 ws0">cuting<span class="_"> </span>the<span class="_"> </span><span class="ffd">subq<span class="_ _10"> </span></span>instruction<span class="_"> </span>of<span class="_ _11"> </span>line<span class="_"> </span>4.<span class="_"> </span>T<span class="_ _0"></span>his<span class="_"> </span>instruction<span class="_"> </span>allocates<span class="_"> </span>the<span class="_"> </span>space<span class="_ _11"> </span>for<span class="_"> </span>local</div><div class="t m5 x17 h26 y2f09 ff7 fs19 fc1 sc0 ls0 ws0">variable<span class="_ _11"> </span><span class="ffd">i</span>.<span class="_ _16"> </span>Let<span class="_ _11"> </span><span class="ff11">s</span></div><div class="t m5 x140 h3c y2f0a ff7 fs25 fc1 sc0 ls0 ws0">2</div><div class="t m5 x178 h26 y2f0b ff7 fs19 fc1 sc0 ls0 ws0">denote<span class="_ _11"> </span>the<span class="_ _16"> </span>value<span class="_ _11"> </span>of<span class="_ _16"> </span>the<span class="_ _11"> </span>stack<span class="_ _16"> </span>pointer<span class="_ _11"> </span>after<span class="_ _16"> </span>executing<span class="_ _11"> </span>the<span class="_ _16"> </span><span class="ffd">subq</span></div><div class="t m5 x17 h26 y2f0c ff7 fs19 fc1 sc0 ls0 ws0">instruction<span class="_ _13"> </span>of<span class="_ _13"> </span>line<span class="_ _13"> </span>7.<span class="_ _13"> </span>T<span class="_ _3"></span>his<span class="_ _13"> </span>instruction<span class="_ _13"> </span>allocates<span class="_ _13"> </span>the<span class="_ _13"> </span>storage<span class="_ _13"> </span>for<span class="_ _13"> </span>local<span class="_ _13"> </span>array<span class="_ _6"> </span><span class="ffd">p</span>.<span class="_ _13"> </span>Finally<span class="_ _7"></span>,</div><div class="t m5 x17 h26 y2f0d ff7 fs19 fc1 sc0 ls0 ws0">let<span class="_ _13"> </span><span class="ff11">p<span class="_ _13"> </span></span>denote<span class="_ _6"> </span>the<span class="_ _13"> </span>value<span class="_ _6"> </span>assigned<span class="_ _13"> </span>to<span class="_ _6"> </span>registers<span class="_ _13"> </span><span class="ffd">%r8<span class="_ _6"> </span></span>and<span class="_ _13"> </span><span class="ffd">%rcx<span class="_ _6"> </span></span>in<span class="_ _13"> </span>the<span class="_ _6"> </span>instructions<span class="_ _13"> </span>of<span class="_ _6"> </span>lines</div><div class="t m5 x17 h26 y2f0e ff7 fs19 fc1 sc0 ls0 ws0">10–11.<span class="_"> </span>Both<span class="_"> </span>of<span class="_"> </span>these<span class="_"> </span>registers<span class="_"> </span>are<span class="_"> </span>used<span class="_"> </span>to<span class="_"> </span>reference<span class="_"> </span>array<span class="_"> </span><span class="ffd">p</span>.</div><div class="t m5 x26 h26 y2f0f ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _21"> </span>right-hand<span class="_ _15"> </span>side<span class="_ _15"> </span>of<span class="_ _21"> </span>F<span class="_ _1"></span>igure<span class="_ _21"> </span>3.44<span class="_ _15"> </span>diagrams<span class="_ _15"> </span>the<span class="_ _21"> </span>positions<span class="_ _15"> </span>of<span class="_ _15"> </span>the<span class="_ _21"> </span>locations</div><div class="t m5 x17 h26 y2f10 ff7 fs19 fc1 sc0 ls0 ws0">indicated<span class="_ _16"> </span>by<span class="_ _14"> </span><span class="ff11">s</span></div><div class="t m5 x5a h3c y2f11 ff7 fs25 fc1 sc0 ls0 ws0">1</div><div class="t m5 x10b h26 y2f12 ff7 fs19 fc1 sc0 ls0 ws0">,<span class="_ _14"> </span><span class="ff11">s</span></div><div class="t m5 xf6 h3c y2f11 ff7 fs25 fc1 sc0 ls0 ws0">2</div><div class="t m5 x10c h26 y2f12 ff7 fs19 fc1 sc0 ls0 ws0">,<span class="_ _14"> </span>and<span class="_ _14"> </span><span class="ff11">p<span class="_ _2"></span></span>.<span class="_ _16"> </span>It<span class="_ _14"> </span>also<span class="_ _16"> </span>shows<span class="_ _14"> </span>that<span class="_ _14"> </span>there<span class="_ _16"> </span>may<span class="_ _14"> </span>be<span class="_ _16"> </span>an<span class="_ _14"> </span>offset<span class="_ _14"> </span>of<span class="_ _16"> </span><span class="ff11">e</span></div><div class="t m5 x1f3 h3c y2f13 ff7 fs25 fc1 sc0 ls0 ws0">2</div><div class="t m5 x5f h26 y2f12 ff7 fs19 fc1 sc0 ls0 ws0">bytes</div><div class="t m5 x17 h26 y2f14 ff7 fs19 fc1 sc0 ls0 ws0">between<span class="_"> </span>the<span class="_"> </span>values<span class="_ _13"> </span>of<span class="_"> </span><span class="ff11">s</span></div><div class="t m5 x21f h3c y2f15 ff7 fs25 fc1 sc0 ls0 ws0">1</div><div class="t m5 x1a8 h26 y2f16 ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_"> </span><span class="ff11">p</span>.<span class="_"> </span>T<span class="_ _0"></span>his<span class="_"> </span>space<span class="_"> </span>will<span class="_ _13"> </span>not<span class="_"> </span>be<span class="_"> </span>used.<span class="_"> </span>T<span class="_ _1"></span>here<span class="_"> </span>may<span class="_"> </span>also<span class="_"> </span>be<span class="_ _13"> </span>an</div><div class="t m5 x17 h26 y2f17 ff7 fs19 fc1 sc0 ls0 ws0">offset<span class="_"> </span>of<span class="_"> </span><span class="ff11">e</span></div><div class="t m5 x1a0 h3c y2f18 ff7 fs25 fc1 sc0 ls0 ws0">1</div><div class="t m5 x1d6 h26 y2f19 ff7 fs19 fc1 sc0 ls0 ws0">bytes<span class="_"> </span>between<span class="_"> </span>the<span class="_"> </span>end<span class="_"> </span>of<span class="_"> </span>array<span class="_"> </span><span class="ffd">p<span class="_ _10"> </span></span>and<span class="_"> </span>the<span class="_"> </span>position<span class="_"> </span>indicated<span class="_"> </span>by<span class="_"> </span><span class="ff11">s</span></div><div class="t m5 x5f h3c y2f18 ff7 fs25 fc1 sc0 ls0 ws0">1</div><div class="t m5 x43 h26 y2f19 ff7 fs19 fc1 sc0 ls0 ws0">.</div><div class="t m5 x34 h26 y2f1a ff7 fs19 fc1 sc0 ls0 ws0">A.<span class="_ _1f"> </span>Explain,<span class="_ _11"> </span>in<span class="_ _11"> </span>mathematical<span class="_ _16"> </span>terms<span class="_ _3"></span>,<span class="_ _16"> </span>the<span class="_ _11"> </span>logic<span class="_ _11"> </span>in<span class="_ _16"> </span>the<span class="_"> </span>computation<span class="_ _16"> </span>of<span class="_ _11"> </span><span class="ff11">s</span></div><div class="t m5 x1fd h3c y2f1b ff7 fs25 fc1 sc0 ls0 ws0">2</div><div class="t m5 xae h26 y2f1c ff7 fs19 fc1 sc0 ls0 ws0">on<span class="_ _11"> </span>lines</div><div class="t m5 x2d h46 y2f1d ff7 fs19 fc1 sc0 ls0 ws0">5–7.<span class="_ _11"> </span><span class="ffa">Hint:<span class="_ _16"> </span></span>T<span class="_ _1"></span>hink<span class="_ _16"> </span>about<span class="_ _11"> </span>the<span class="_ _16"> </span>bit-level<span class="_ _11"> </span>representation<span class="_ _16"> </span>of<span class="_ _11"> </span><span class="ff12">−</span>16<span class="_ _16"> </span>and<span class="_ _11"> </span>its<span class="_ _16"> </span>effect<span class="_ _11"> </span>in</div><div class="t m5 x2d h26 y2f1e ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span><span class="ffd">andq<span class="_ _10"> </span></span>instruction<span class="_"> </span>of<span class="_"> </span>line<span class="_"> </span>6.</div><div class="t m5 x34 h26 y2f1f ff7 fs19 fc1 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>Explain,<span class="_ _16"> </span>in<span class="_ _16"> </span>mathematical<span class="_ _11"> </span>terms<span class="_ _1"></span>,<span class="_ _16"> </span>the<span class="_ _11"> </span>logic<span class="_ _16"> </span>in<span class="_ _11"> </span>the<span class="_ _16"> </span>computation<span class="_ _16"> </span>of<span class="_ _11"> </span><span class="ff11">p<span class="_"> </span></span>on<span class="_ _11"> </span>lines</div><div class="t m5 x2d h26 y2f20 ff7 fs19 fc1 sc0 ls0 ws0">8–10.<span class="_ _11"> </span><span class="ffa">Hint:<span class="_ _16"> </span></span>Y<span class="_ _3"></span>ou<span class="_ _16"> </span>may<span class="_ _11"> </span>want<span class="_ _16"> </span>to<span class="_ _11"> </span>refer<span class="_ _16"> </span>to<span class="_ _11"> </span>the<span class="_ _16"> </span>discussion<span class="_ _11"> </span>on<span class="_ _16"> </span>division<span class="_ _11"> </span>by<span class="_ _16"> </span>powers</div><div class="t m5 x2d h26 y2f21 ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_"> </span>2<span class="_"> </span>in<span class="_"> </span>Section<span class="_"> </span>2.3.7.</div><div class="t m5 x34 h26 y2f22 ff7 fs19 fc1 sc0 ls0 ws0">C.<span class="_ _25"> </span>F<span class="_ _1"></span>or<span class="_ _21"> </span>the<span class="_ _21"> </span>following<span class="_ _21"> </span>values<span class="_ _21"> </span>of<span class="_ _21"> </span><span class="ff11">n<span class="_ _21"> </span></span>and<span class="_ _21"> </span><span class="ff11">s</span></div><div class="t m5 x68 h3c y2f23 ff7 fs25 fc1 sc0 ls0 ws0">1</div><div class="t m5 x176 h26 y2f24 ff7 fs19 fc1 sc0 ls0 ws0">,<span class="_ _f"> </span>trace<span class="_ _21"> </span>the<span class="_ _21"> </span>execution<span class="_ _f"> </span>of<span class="_ _21"> </span>the<span class="_ _21"> </span>code<span class="_ _21"> </span>to</div><div class="t m5 x2d h26 y2f25 ff7 fs19 fc1 sc0 ls0 ws0">determine<span class="_"> </span>what<span class="_"> </span>the<span class="_"> </span>resulting<span class="_"> </span>values<span class="_"> </span>would<span class="_"> </span>be<span class="_"> </span>for<span class="_"> </span><span class="ff11">s</span></div><div class="t m5 x36 h3c y2f26 ff7 fs25 fc1 sc0 ls0 ws0">2</div><div class="t m5 x1c7 h26 y2f27 ff7 fs19 fc1 sc0 ls0 ws0">,<span class="_"> </span><span class="ff11">p<span class="_ _2"></span></span>,<span class="_"> </span><span class="ff11">e</span></div><div class="t m5 x1df h3c y2f26 ff7 fs25 fc1 sc0 ls0 ws0">1</div><div class="t m5 x3a h26 y2f27 ff7 fs19 fc1 sc0 ls0 ws0">,<span class="_"> </span>and<span class="_"> </span><span class="ff11">e</span></div><div class="t m5 x3b h3c y2f26 ff7 fs25 fc1 sc0 ls0 ws0">2</div><div class="t m5 x8d h26 y2f27 ff7 fs19 fc1 sc0 ls0 ws0">.</div><div class="t m5 x2d h55 y2f28 ff11 fs21 fc2 sc0 ls186 ws0">ns</div><div class="t m5 x5c h33 y2f29 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 x1b7 h55 y2f2a ff11 fs21 fc2 sc0 ls0 ws0">s</div><div class="t m5 x1cc h33 y2f29 ff7 fs20 fc2 sc0 ls0 ws0">2</div><div class="t m5 x1eb h55 y2f2a ff11 fs21 fc2 sc0 ls187 ws0">pe</div><div class="t m5 xfd h33 y2f29 ff7 fs20 fc2 sc0 ls0 ws0">1</div><div class="t m5 xe8 h55 y2f2a ff11 fs21 fc2 sc0 ls0 ws0">e</div><div class="t m5 x6a h33 y2f29 ff7 fs20 fc2 sc0 ls0 ws0">2</div><div class="t m5 x2d h31 y2f2b ff7 fs21 fc2 sc0 ls0 ws0">5<span class="_ _26"> </span>2,065</div><div class="t m5 x2d h31 y2f2c ff7 fs21 fc1 sc0 ls0 ws0">6<span class="_ _26"> </span>2,064</div><div class="t m5 x34 h26 y2f2d ff7 fs19 fc1 sc0 ls0 ws0">D<span class="_ _3"></span>.<span class="_ _23"> </span>What<span class="_ _15"> </span>alignment<span class="_ _15"> </span>properties<span class="_ _21"> </span>does<span class="_ _15"> </span>this<span class="_ _15"> </span>code<span class="_ _21"> </span>guarantee<span class="_ _15"> </span>for<span class="_ _15"> </span>the<span class="_ _21"> </span>values<span class="_ _15"> </span>of<span class="_ _21"> </span><span class="ff11">s</span></div><div class="t m5 xd6 h3c y2f2e ff7 fs25 fc1 sc0 ls0 ws0">2</div><div class="t m5 x2d h26 y2f2f ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_"> </span><span class="ff11">p<span class="_ _2"></span></span>?</div><div class="t m5 x17 h3b y2f30 fff fs24 fc6 sc0 ls0 ws0">3.11<span class="_ _17"> </span><span class="ffe fs18">Floating-Point<span class="_"> </span>Code</span></div><div class="t m5 x17 h26 y2f31 ff7 fs19 fc1 sc0 lsd ws0">Th<span class="_ _2"></span>e<span class="_ _f"> </span><span class="ffa ls0">ﬂoating-point<span class="_ _15"> </span>architecture<span class="_ _21"> </span><span class="ff7">for<span class="_ _15"> </span>a<span class="_ _21"> </span>processor<span class="_ _21"> </span>consists<span class="_ _15"> </span>of<span class="_ _21"> </span>the<span class="_ _15"> </span>different<span class="_ _21"> </span>aspects</span></span></div><div class="t m5 x17 h26 y2f32 ff7 fs19 fc1 sc0 ls0 ws0">that<span class="_ _16"> </span>affect<span class="_ _11"> </span>how<span class="_ _16"> </span>programs<span class="_ _16"> </span>operating<span class="_ _11"> </span>on<span class="_ _16"> </span>ﬂoating-point<span class="_ _16"> </span>data<span class="_ _16"> </span>are<span class="_ _11"> </span>mapped<span class="_ _16"> </span>onto<span class="_ _16"> </span>the</div><div class="t m5 x17 h26 y2f33 ff7 fs19 fc1 sc0 ls0 ws0">machine<span class="_ _1"></span>,<span class="_"> </span>including</div><div class="t m5 x72 h3d y77d ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y77e ff7 fs19 fc1 sc0 ls0 ws0">How<span class="_"> </span>ﬂoating-point<span class="_"> </span>values<span class="_"> </span>are<span class="_ _11"> </span>stored<span class="_"> </span>and<span class="_"> </span>accessed.<span class="_ _11"> </span>T<span class="_ _1"></span>his<span class="_ _11"> </span>is<span class="_"> </span>typically<span class="_"> </span>via<span class="_ _11"> </span>some</div><div class="t m5 x26 h26 y77f ff7 fs19 fc1 sc0 ls0 ws0">form<span class="_"> </span>of<span class="_"> </span>registers<span class="_ _1"></span>.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
