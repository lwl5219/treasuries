<div id="pf42a" class="pf w2 h11" data-page-no="42a"><div class="pc pc42a w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg42a.png"/><div class="t m5 x13a h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>12.7<span class="_ _60"> </span>Other<span class="_ _10"> </span>Concurrency<span class="_ _10"> </span>Issues<span class="_ _3e"> </span><span class="ffe fs1e">1065</span></div><div class="t m8 x12 h3f y844c fff1 fs27 fc1 sc0 ls0 ws0">. . .</div><div class="t m5 x126 h3f y844d fff1 fs27 fc1 sc0 ls0 ws0">. . .<span class="_ _54"> </span>. . .<span class="_ _55"> </span>. . .<span class="_ _54"> </span>. . .</div><div class="t m8 x12 h3f y844f fff1 fs27 fc1 sc0 ls0 ws0">. . .<span class="_ _23d"></span>. . .<span class="_ _23d"></span>. . .</div><div class="t m5 x1da h3f y8450 fff1 fs27 fc1 sc0 ls0 ws0">Thread 2</div><div class="t m5 x1dd h3f y8451 fff1 fs27 fc1 sc0 ls0 ws0">Thread 1</div><div class="t m5 x123 h3f y847d ffee fs27 fc1 sc0 ls0 ws0">P<span class="_ _2"></span><span class="fff1">(</span>t<span class="_ _5"></span><span class="fff1">)</span></div><div class="t m5 x10a h3f y847e ffee fs27 fc1 sc0 ls0 ws0">P<span class="_ _2"></span><span class="fff1">(</span>s<span class="fff1">)</span></div><div class="t m5 x8c h3f y847f ffee fs27 fc1 sc0 ls0 ws0">P<span class="_ _2"></span><span class="fff1">(</span>s<span class="fff1">)<span class="_ _10d"> </span></span>P<span class="_ _2"></span><span class="fff1">(</span>t<span class="_ _5"></span><span class="fff1">)<span class="_ _82"> </span></span>V<span class="_ _2"></span><span class="fff1">(</span>s<span class="fff1">)<span class="_ _10d"> </span></span>V<span class="_ _2"></span><span class="fff1">(</span>t<span class="_ _5"></span><span class="fff1">)</span></div><div class="t m5 x21e h3f y8480 ffee fs27 fc1 sc0 ls0 ws0">V<span class="_ _2"></span><span class="fff1">(</span>t<span class="_ _5"></span><span class="fff1">)</span></div><div class="t m5 x249 h3f y8481 ffee fs27 fc1 sc0 ls0 ws0">V<span class="_ _2"></span><span class="fff1">(</span>s<span class="fff1">)</span></div><div class="t m5 x2c h3f y8482 fff1 fs27 fc1 sc0 ls0 ws0">Initially</div><div class="t m5 xee h3f y8483 ffee fs27 fc1 sc0 ls0 ws0">s<span class="ff24"><span class="fff1">1</span></span></div><div class="t m5 xee h3f y8484 ffee fs27 fc1 sc0 ls0 ws0">t<span class="_ _5"></span><span class="ff24"><span class="fff1">1</span></span></div><div class="t m5 x22 h3f y8485 fff1 fs27 fc1 sc0 ls0 ws0">Forbidden</div><div class="t m5 xed h3f y8486 fff1 fs27 fc1 sc0 ls0 ws0">region</div><div class="t m5 x116 h3f y8487 fff1 fs27 fc1 sc0 ls0 ws0">for <span class="ffee">s</span></div><div class="t m5 x185 h3f y8488 fff1 fs27 fc1 sc0 ls0 ws0">Forbidden</div><div class="t m5 xd4 h3f y8489 fff1 fs27 fc1 sc0 ls0 ws0">region for <span class="ffee">t</span></div><div class="t m5 x17 h2f y8467 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>12.45<span class="_ _66"> </span><span class="fc1">Progress<span class="_"> </span>graph<span class="_"> </span>for<span class="_"> </span>a<span class="_"> </span>deadlock-free<span class="_"> </span>program.</span></div><div class="t m5 x26 h2b y848a ffa fs1e fc2 sc0 ls0 ws0">Mutex<span class="_ _14"> </span>lock<span class="_ _15"> </span>ordering<span class="_ _14"> </span>rule:<span class="_ _15"> </span><span class="ff7">Given<span class="_ _15"> </span>a<span class="_ _15"> </span>total<span class="_ _15"> </span>ordering<span class="_ _14"> </span>of<span class="_ _15"> </span>all<span class="_ _15"> </span>mutexes<span class="_ _1"></span>,<span class="_ _21"> </span>a<span class="_ _15"> </span>program<span class="_ _15"> </span>is</span></div><div class="t m5 x26 h2b y848b ff7 fs1e fc2 sc0 ls0 ws0">deadlock-free<span class="_ _11"> </span>if<span class="_ _16"> </span>each<span class="_ _11"> </span>thread<span class="_ _16"> </span>acquires<span class="_ _11"> </span>its<span class="_ _16"> </span>mutexes<span class="_ _11"> </span>in<span class="_ _16"> </span>order<span class="_ _11"> </span>and<span class="_ _16"> </span>releases<span class="_ _11"> </span>them<span class="_ _16"> </span>in</div><div class="t m5 x26 h2b y848c ff7 fs1e fc2 sc0 ls0 ws0">reverse<span class="_"> </span>order.</div><div class="t m5 x26 h26 y848d ff7 fs19 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>or<span class="_"> </span>example<span class="_ _1"></span>,<span class="_"> </span>we<span class="_ _13"> </span>can<span class="_"> </span>ﬁx<span class="_"> </span>the<span class="_ _13"> </span>deadlock<span class="_"> </span>in<span class="_"> </span>F<span class="_ _1"></span>igure<span class="_"> </span>12.44<span class="_ _13"> </span>by<span class="_"> </span>locking<span class="_ _13"> </span><span class="ff11">s<span class="_"> </span></span>ﬁrst,<span class="_ _13"> </span>then<span class="_"> </span><span class="ff11">t<span class="_ _5"></span></span>,</div><div class="t m5 x17 h26 y848e ff7 fs19 fc2 sc0 ls0 ws0">in<span class="_"> </span>each<span class="_"> </span>thread.<span class="_"> </span>F<span class="_ _1"></span>igure<span class="_"> </span>12.45<span class="_"> </span>shows<span class="_"> </span>the<span class="_"> </span>resulting<span class="_"> </span>progress<span class="_"> </span>graph.</div><div class="t m5 x17 h47 y848f ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>12.15<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>1075)</span></div><div class="t m5 x17 h26 y8490 ff7 fs19 fc1 sc0 ls0 ws0">Consider<span class="_"> </span>the<span class="_ _11"> </span>following<span class="_"> </span>program,<span class="_ _11"> </span>which<span class="_ _11"> </span>attempts<span class="_ _11"> </span>to<span class="_"> </span>use<span class="_ _11"> </span>a<span class="_ _11"> </span>pair<span class="_"> </span>of<span class="_ _11"> </span>semaphores<span class="_"> </span>for</div><div class="t m5 x17 h26 y8491 ff7 fs19 fc1 sc0 ls0 ws0">mutual<span class="_"> </span>exclusion.</div><div class="t m5 x17 h2d y8492 ffd fs1e fc2 sc0 ls0 ws0">Initially<span class="ls33">:s=1<span class="_ _41"></span>,t=0<span class="_ _41"></span>.</span></div><div class="t m5 x17 h2d y8493 ffd fs1e fc2 sc0 ls0 ws0">Thread<span class="_ _e"> </span>1:<span class="_ _2b"> </span>Thread<span class="_ _e"> </span>2:</div><div class="t m5 x245 h2d y8494 ffd fs1e fc2 sc0 ls0 ws0">P(s);<span class="_ _192"> </span>P(s);</div><div class="t m5 x245 h2d y8495 ffd fs1e fc2 sc0 ls0 ws0">V(s);<span class="_ _192"> </span>V(s);</div><div class="t m5 x245 h2d y8496 ffd fs1e fc2 sc0 ls0 ws0">P(t);<span class="_ _192"> </span>P(t);</div><div class="t m5 x245 h2d y8497 ffd fs1e fc2 sc0 ls0 ws0">V(t);<span class="_ _192"> </span>V(t);</div><div class="t m5 x34 h26 y8498 ff7 fs19 fc2 sc0 ls0 ws0">A.<span class="_ _1f"> </span>Draw<span class="_"> </span>the<span class="_"> </span>progress<span class="_"> </span>graph<span class="_"> </span>for<span class="_"> </span>this<span class="_"> </span>program.</div><div class="t m5 x34 h26 y835 ff7 fs19 fc2 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>Does<span class="_"> </span>it<span class="_"> </span>always<span class="_"> </span>deadlock?</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
