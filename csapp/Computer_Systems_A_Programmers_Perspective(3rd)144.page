<div id="pf90" class="pf w2 h11" data-page-no="90"><div class="pc pc90 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg90.png"/><div class="t m5 xa9 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>2.3<span class="_ _60"> </span>Integer<span class="_ _10"> </span>Arithmetic<span class="_ _3e"> </span><span class="ffe fs1e">143</span></div><div class="t m5 x17 h47 yb1f ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>2.42<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>192)</span></div><div class="t m5 x17 h26 yb20 ff7 fs19 fc1 sc0 ls0 ws0">Write<span class="_"> </span>a<span class="_ _11"> </span>function<span class="_"> </span><span class="ffd">div16<span class="_ _11"> </span></span>that<span class="_"> </span>returns<span class="_ _11"> </span>the<span class="_ _11"> </span>value<span class="_"> </span><span class="ffd">x/16<span class="_ _11"> </span></span>for<span class="_"> </span>integer<span class="_ _11"> </span>argument<span class="_"> </span><span class="ffd">x</span>.<span class="_ _11"> </span>Y<span class="_ _3"></span>our</div><div class="t m5 x17 h26 yb21 ff7 fs19 fc1 sc0 ls0 ws0">function<span class="_"> </span>should<span class="_ _13"> </span>not<span class="_"> </span>use<span class="_ _13"> </span>division,<span class="_"> </span>modulus<span class="_ _1"></span>,<span class="_"> </span>multiplication,<span class="_"> </span>any<span class="_ _13"> </span>conditionals<span class="_"> </span>(<span class="ffd">if<span class="_ _13"> </span></span>or</div><div class="t m5 x17 h26 yb22 ffd fs19 fc1 sc0 ls0 ws0">?:<span class="ff7">),<span class="_ _16"> </span>any<span class="_ _11"> </span>comparison<span class="_ _16"> </span>operators<span class="_ _11"> </span>(e.g<span class="_ _1"></span>.,<span class="_ _16"> </span><span class="ffd">&lt;</span>,<span class="_ _16"> </span><span class="ffd">&gt;</span><span class="lseb">,o<span class="_ _49"></span>r<span class="ffd ls0">==<span class="ff7">),<span class="_ _11"> </span>or<span class="_ _16"> </span>any<span class="_ _11"> </span>loops<span class="_ _1"></span>.<span class="_ _16"> </span>Y<span class="_ _3"></span>ou<span class="_ _11"> </span>may<span class="_ _16"> </span>assume</span></span></span></span></div><div class="t m5 x17 h26 yba3 ff7 fs19 fc1 sc0 ls0 ws0">that<span class="_ _13"> </span>data<span class="_ _13"> </span>type<span class="_ _6"> </span><span class="ffd">int<span class="_ _13"> </span></span>is<span class="_ _13"> </span>32<span class="_ _13"> </span>bits<span class="_ _13"> </span>long<span class="_ _6"> </span>and<span class="_ _13"> </span>uses<span class="_ _13"> </span>a<span class="_ _13"> </span>two’<span class="_ _0"></span>s-complement<span class="_ _13"> </span>representation,<span class="_ _13"> </span>and</div><div class="t m5 x17 h26 y1656 ff7 fs19 fc1 sc0 ls0 ws0">that<span class="_"> </span>right<span class="_"> </span>shifts<span class="_"> </span>are<span class="_"> </span>performed<span class="_"> </span>arithmetically<span class="_ _3"></span>.</div><div class="t m5 x26 h26 y1657 ff7 fs19 fc1 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_"> </span>now<span class="_ _13"> </span>see<span class="_ _13"> </span>that<span class="_ _13"> </span>division<span class="_"> </span>by<span class="_ _13"> </span>a<span class="_ _13"> </span>power<span class="_"> </span>of<span class="_ _13"> </span>2<span class="_ _13"> </span>can<span class="_"> </span>be<span class="_ _13"> </span>implemented<span class="_ _13"> </span>using<span class="_ _13"> </span>logical<span class="_"> </span>or</div><div class="t m5 x17 h26 y1658 ff7 fs19 fc1 sc0 ls0 ws0">arithmetic<span class="_"> </span>right<span class="_ _13"> </span>shifts<span class="_ _1"></span>.<span class="_"> </span>T<span class="_ _0"></span>his<span class="_"> </span>is<span class="_ _13"> </span>precisely<span class="_"> </span>the<span class="_"> </span>reason<span class="_"> </span>the<span class="_ _13"> </span>two<span class="_"> </span>types<span class="_"> </span>of<span class="_ _13"> </span>right<span class="_"> </span>shifts<span class="_"> </span>are</div><div class="t m5 x17 h26 y1659 ff7 fs19 fc1 sc0 ls0 ws0">available<span class="_"> </span>on<span class="_ _11"> </span>most<span class="_"> </span>machines<span class="_ _1"></span>.<span class="_ _11"> </span>Unfortunately<span class="_ _3"></span>,<span class="_ _11"> </span>this<span class="_"> </span>approach<span class="_ _11"> </span>does<span class="_"> </span>not<span class="_ _11"> </span>generalize<span class="_ _11"> </span>to</div><div class="t m5 x17 h26 y165a ff7 fs19 fc1 sc0 ls0 ws0">division<span class="_"> </span>by<span class="_"> </span>arbitrary<span class="_"> </span>constants<span class="_ _3"></span>.<span class="_"> </span>Unlike<span class="_"> </span>multiplication,<span class="_"> </span>we<span class="_"> </span>cannot<span class="_ _13"> </span>express<span class="_"> </span>division</div><div class="t m5 x17 h26 y165b ff7 fs19 fc1 sc0 ls0 ws0">by<span class="_"> </span>arbitrary<span class="_"> </span>constants<span class="_"> </span><span class="ff11">K<span class="_"> </span></span>in<span class="_"> </span>terms<span class="_"> </span>of<span class="_"> </span>division<span class="_"> </span>by<span class="_"> </span>powers<span class="_"> </span>of<span class="_"> </span>2.</div><div class="t m5 x17 h47 y165c ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>2.43<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>193)</span></div><div class="t m5 x17 h26 y165d ff7 fs19 fc1 sc0 ls0 ws0">In<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>code<span class="_ _1"></span>,<span class="_"> </span>we<span class="_"> </span>have<span class="_"> </span>omitted<span class="_"> </span>the<span class="_"> </span>deﬁnitions<span class="_"> </span>of<span class="_"> </span>constants<span class="_"> </span><span class="ffd">M<span class="_ _11"> </span></span>and<span class="_"> </span><span class="ffd">N</span>:</div><div class="t m5 x17 h2d y165e ffd fs1e fc2 sc0 ls0 ws0">#define<span class="_ _e"> </span>M<span class="_ _b9"> </span>/*<span class="_ _e"> </span>Mystery<span class="_ _1f"> </span>number<span class="_ _e"> </span>1<span class="_ _1f"> </span>*/</div><div class="t m5 x17 h2d y165f ffd fs1e fc2 sc0 ls0 ws0">#define<span class="_ _e"> </span>N<span class="_ _b9"> </span>/*<span class="_ _e"> </span>Mystery<span class="_ _1f"> </span>number<span class="_ _e"> </span>2<span class="_ _1f"> </span>*/</div><div class="t m5 x17 h2d y1660 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>arith(int<span class="_ _1f"> </span>x,<span class="_ _1f"> </span>int<span class="_ _e"> </span>y)<span class="_ _1f"> </span>{</div><div class="t m5 x1b6 h2d y1661 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>result<span class="_ _1f"> </span>=<span class="_ _1f"> </span>0;</div><div class="t m5 x1b6 h2d y1662 ffd fs1e fc2 sc0 ls0 ws0">result<span class="_ _e"> </span>=<span class="_ _1f"> </span>x*M<span class="_ _1f"> </span>+<span class="_ _e"> </span>y/N;<span class="_ _1f"> </span>/*<span class="_ _e"> </span>M<span class="_ _1f"> </span>and<span class="_ _1f"> </span>N<span class="_ _e"> </span>are<span class="_ _1f"> </span>mystery<span class="_ _e"> </span>numbers.<span class="_ _1f"> </span>*/</div><div class="t m5 x1b6 h2d y1663 ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>result;</div><div class="t m5 x17 h2d y1664 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x26 h26 y1665 ff7 fs19 fc2 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_ _14"> </span>compiled<span class="_ _16"> </span>this<span class="_ _14"> </span>code<span class="_ _14"> </span>for<span class="_ _14"> </span>particular<span class="_ _16"> </span>values<span class="_ _14"> </span>of<span class="_ _14"> </span><span class="ffd">M<span class="_ _16"> </span></span>and<span class="_ _14"> </span><span class="ffd">N</span>.<span class="_ _14"> </span>T<span class="_ _1"></span>he<span class="_ _14"> </span>compiler<span class="_ _14"> </span>opti-</div><div class="t m5 x17 h26 y1666 ff7 fs19 fc2 sc0 ls0 ws0">mized<span class="_ _11"> </span>the<span class="_ _11"> </span>multiplication<span class="_ _11"> </span>and<span class="_ _11"> </span>division<span class="_ _11"> </span>using<span class="_ _11"> </span>the<span class="_ _16"> </span>methods<span class="_"> </span>we<span class="_ _11"> </span>have<span class="_ _11"> </span>discussed.<span class="_ _16"> </span>T<span class="_ _1"></span>he</div><div class="t m5 x17 h26 y1667 ff7 fs19 fc2 sc0 ls0 ws0">following<span class="_"> </span>is<span class="_"> </span>a<span class="_"> </span>translation<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>generated<span class="_"> </span>machine<span class="_"> </span>code<span class="_"> </span>back<span class="_"> </span>into<span class="_"> </span>C:</div><div class="t m5 x17 h2d y1668 ffd fs1e fc2 sc0 ls0 ws0">/*<span class="_ _e"> </span>Translation<span class="_ _1f"> </span>of<span class="_ _1f"> </span>assembly<span class="_ _e"> </span>code<span class="_ _1f"> </span>for<span class="_ _e"> </span>arith<span class="_ _1f"> </span>*/</div><div class="t m5 x17 h2d y1669 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>optarith(int<span class="_ _1f"> </span>x,<span class="_ _1f"> </span>int<span class="_ _e"> </span>y)<span class="_ _1f"> </span>{</div><div class="t m5 x1b6 h2d y166a ffd fs1e fc2 sc0 ls33 ws0">i<span class="_ _41"></span>n<span class="_ _41"></span>tt=x<span class="_ _41"></span>;</div><div class="t m5 x1b6 h2d y166b ffd fs1e fc2 sc0 ls0 ws0">x<span class="_ _e"> </span>&lt;&lt;=<span class="_ _1f"> </span>5;</div><div class="t m5 x1b6 h2d y166c ffd fs1e fc2 sc0 ls33 ws0">x-<span class="_ _41"></span>=t<span class="_ _41"></span>;</div><div class="t m5 x1b6 h2d y166d ffd fs1e fc2 sc0 ls33 ws0">i<span class="_ _41"></span>f(<span class="_ _41"></span>y&lt;0<span class="_ _41"></span>)y+<span class="_ _41"></span>=7<span class="_ _41"></span>;</div><div class="t m5 x1b6 h2d y166e ffd fs1e fc2 sc0 ls0 ws0">y<span class="_ _e"> </span>&gt;&gt;=<span class="_ _1f"> </span>3;<span class="_ _1a"> </span>/*<span class="_ _1f"> </span>Arithmetic<span class="_ _e"> </span>shift<span class="_ _1f"> </span>*/</div><div class="t m5 x1b6 h2d y166f ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>x+y;</div><div class="t m5 x17 h2d y1670 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x26 h26 y1671 ff7 fs19 fc2 sc0 ls0 ws0">What<span class="_"> </span>are<span class="_"> </span>the<span class="_"> </span>values<span class="_"> </span>of<span class="_"> </span><span class="ffd">M<span class="_ _10"> </span></span>and<span class="_"> </span><span class="ffd">N</span>?</div><div class="t m5 x17 h41 y1672 ffe fs29 fc1 sc0 ls0 ws0">2.3.8<span class="_ _48"> </span><span class="fs19">Final<span class="_"> </span>Thoughts<span class="_"> </span>on<span class="_"> </span>Integer<span class="_"> </span>Arithmetic</span></div><div class="t m5 x17 h26 y6e1 ff7 fs19 fc1 sc0 ls0 ws0">As<span class="_ _f"> </span>we<span class="_ _e"> </span>have<span class="_ _21"> </span>seen,<span class="_ _1f"> </span>the<span class="_ _f"> </span>“integer”<span class="_ _f"> </span>arithmetic<span class="_ _e"> </span>performed<span class="_ _21"> </span>by<span class="_ _e"> </span>computers<span class="_ _21"> </span>is<span class="_ _e"> </span>really</div><div class="t m5 x17 h26 y6e2 ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_ _14"> </span>form<span class="_ _15"> </span>of<span class="_ _15"> </span>modular<span class="_ _15"> </span>arithmetic.<span class="_ _14"> </span>The<span class="_ _14"> </span>ﬁnite<span class="_ _15"> </span>word<span class="_ _14"> </span>size<span class="_ _15"> </span>used<span class="_ _15"> </span>to<span class="_ _15"> </span>represent<span class="_ _15"> </span>numbers</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
