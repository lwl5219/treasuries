<div id="pf266" class="pf w2 h11" data-page-no="266"><div class="pc pc266 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg266.png"/><div class="t m5 x107 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Solutions<span class="_ _10"> </span>to<span class="_ _10"> </span>Practice<span class="_ _10"> </span>Problems<span class="_ _1b"> </span><span class="ffe fs1e">613</span></div><div class="t m5 x21e h2d y140c ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>v2<span class="_ _1f"> </span>=<span class="_ _1f"> </span>src2[i2];</div><div class="t m5 x21e h2d y140d ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>take1<span class="_ _1f"> </span>=<span class="_ _1f"> </span>v1<span class="_ _e"> </span>&lt;<span class="_ _1f"> </span>v2;</div><div class="t m5 x21e h2d y1b95 ffd fs1e fc2 sc0 ls0 ws0">dest[id++]<span class="_ _e"> </span>=<span class="_ _1f"> </span>take1<span class="_ _1f"> </span>?<span class="_ _e"> </span>v1<span class="_ _1f"> </span>:<span class="_ _e"> </span>v2;</div><div class="t m5 x21e h2d y2122 ffd fs1e fc2 sc0 ls0 ws0">i1<span class="_ _e"> </span>+=<span class="_ _1f"> </span>take1;</div><div class="t m5 x21e h2d y1b96 ffd fs1e fc2 sc0 ls0 ws0">i2<span class="_ _e"> </span>+=<span class="_ _1f"> </span>(1-take1);</div><div class="t m5 x1b6 h2d y1b97 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x17 h26 y345e ff7 fs19 fc2 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_ _13"> </span>measured<span class="_ _6"> </span>a<span class="_ _13"> </span>CPE<span class="_ _6"> </span>of<span class="_ _13"> </span>around<span class="_ _13"> </span>12.0<span class="_ _6"> </span>for<span class="_ _13"> </span>this<span class="_ _6"> </span>version<span class="_ _13"> </span>of<span class="_ _6"> </span>the<span class="_ _13"> </span>code<span class="_ _1"></span>,<span class="_ _13"> </span>a<span class="_ _13"> </span>modest<span class="_ _6"> </span>improve-</div><div class="t m5 x17 h26 y345f ff7 fs19 fc2 sc0 ls0 ws0">ment<span class="_"> </span>over<span class="_"> </span>the<span class="_"> </span>original<span class="_"> </span>CPE<span class="_"> </span>of<span class="_"> </span>15.0.</div><div class="t m5 x17 h28 y5209 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>5.10<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>595)</span></div><div class="t m5 x17 h26 y520a ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _14"> </span>problem<span class="_ _14"> </span>requires<span class="_ _15"> </span>you<span class="_ _14"> </span>to<span class="_ _14"> </span>analyze<span class="_ _14"> </span>the<span class="_ _14"> </span>potential<span class="_ _14"> </span>load-store<span class="_ _14"> </span>interactions<span class="_ _14"> </span>in<span class="_ _14"> </span>a</div><div class="t m5 x17 h26 y520b ff7 fs19 fc1 sc0 ls0 ws0">program.</div><div class="t m5 x34 h46 y520c ff7 fs19 fc1 sc0 ls0 ws0">A.<span class="_ _1f"> </span>It<span class="_"> </span>will<span class="_"> </span>set<span class="_"> </span>each<span class="_"> </span>element<span class="_"> </span><span class="ffd">a[<span class="ff11">i<span class="_ _2"></span></span>]<span class="_ _10"> </span></span>to<span class="_"> </span><span class="ff11">i<span class="_ _16"> </span><span class="ff12">+<span class="_ _13"></span></span></span>1<span class="_ _1"></span>,<span class="_"> </span>for<span class="_"> </span>0<span class="_"> </span><span class="ff12">≤<span class="_ _13"> </span><span class="ff11">i<span class="_ _16"> </span></span>≤<span class="_ _13"></span></span><span class="lsb2">998.</span></div><div class="t m5 x34 h46 y520d ff7 fs19 fc1 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>It<span class="_"> </span>will<span class="_"> </span>set<span class="_"> </span>each<span class="_"> </span>element<span class="_"> </span><span class="ffd">a[<span class="ff11">i<span class="_ _5"></span></span>]<span class="_ _10"> </span></span>to<span class="_"> </span>0,<span class="_"> </span>for<span class="_"> </span>1<span class="_ _13"> </span><span class="ff12">≤<span class="_ _13"></span><span class="ff11">i<span class="_ _11"> </span></span>≤<span class="_ _10"> </span></span><span class="lsb2">999.</span></div><div class="t m5 x34 h26 y520e ff7 fs19 fc1 sc0 ls0 ws0">C.<span class="_ _25"> </span>In<span class="_ _6"> </span>the<span class="_ _13"> </span>second<span class="_ _a"> </span>case,<span class="_ _6"> </span>the<span class="_ _13"> </span>load<span class="_ _a"> </span>of<span class="_ _13"> </span>one<span class="_ _6"> </span>iteration<span class="_ _6"> </span>depends<span class="_ _13"> </span>on<span class="_ _6"> </span>the<span class="_ _6"> </span>result<span class="_ _13"> </span>of<span class="_ _6"> </span>the<span class="_ _6"> </span>store</div><div class="t m5 x2d h26 y520f ff7 fs19 fc1 sc0 ls0 ws0">from<span class="_ _13"> </span>the<span class="_ _13"> </span>previous<span class="_"> </span>iteration.<span class="_ _13"> </span>T<span class="_ _1"></span>hus<span class="_ _1"></span>,<span class="_"> </span>there<span class="_ _13"> </span>is<span class="_ _13"> </span>a<span class="_ _13"> </span>write/read<span class="_"> </span>dependenc<span class="_ _1"></span>y<span class="_"> </span>between</div><div class="t m5 x2d h26 y5210 ff7 fs19 fc1 sc0 ls0 ws0">successive<span class="_"> </span>iterations<span class="_ _1"></span>.</div><div class="t m5 x34 h26 y5211 ff7 fs19 fc1 sc0 ls0 ws0">D<span class="_ _3"></span>.<span class="_ _23"> </span>It<span class="_ _14"> </span>will<span class="_ _15"> </span>give<span class="_ _14"> </span>a<span class="_ _14"> </span>CPE<span class="_ _15"> </span>of<span class="_ _14"> </span>1.2,<span class="_ _15"> </span>the<span class="_ _14"> </span>same<span class="_ _15"> </span>as<span class="_ _14"> </span>for<span class="_ _14"> </span>Example<span class="_ _14"> </span>A,<span class="_ _15"> </span>since<span class="_ _15"> </span>there<span class="_ _14"> </span>are<span class="_ _14"> </span>no</div><div class="t m5 x2d h26 y5212 ff7 fs19 fc1 sc0 ls0 ws0">dependencies<span class="_"> </span>between<span class="_"> </span>stores<span class="_"> </span>and<span class="_"> </span>subsequent<span class="_"> </span>loads<span class="_ _1"></span>.</div><div class="t m5 x17 h28 y5213 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>5.11<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>597)</span></div><div class="t m5 x17 h26 y5214 ff7 fs19 fc1 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_ _15"> </span>can<span class="_ _14"> </span>see<span class="_ _14"> </span>that<span class="_ _15"> </span>this<span class="_ _14"> </span>function<span class="_ _15"> </span>has<span class="_ _14"> </span>a<span class="_ _15"> </span>write/read<span class="_ _14"> </span>dependency<span class="_ _14"> </span>between<span class="_ _14"> </span>successive</div><div class="t m5 x17 h26 y5215 ff7 fs19 fc1 sc0 ls0 ws0">iterations—the<span class="_"> </span>destination<span class="_"> </span>value<span class="_"> </span><span class="ffd">p[i]<span class="_ _10"> </span></span>on<span class="_"> </span>one<span class="_"> </span>iteration<span class="_"> </span>matches<span class="_"> </span>the<span class="_"> </span>source<span class="_"> </span>value</div><div class="t m5 x17 h26 y5216 ffd fs19 fc1 sc0 ls0 ws0">p[i-1]<span class="_ _6"> </span><span class="ff7">on<span class="_ _6"> </span>the<span class="_ _13"> </span>next.<span class="_ _a"> </span>A<span class="_ _13"> </span>critical<span class="_ _6"> </span>path<span class="_ _6"> </span>is<span class="_ _6"> </span>therefore<span class="_ _13"> </span>formed<span class="_ _a"> </span>for<span class="_ _13"> </span>each<span class="_ _a"> </span>iteration<span class="_ _13"> </span>consisting</span></div><div class="t m5 x17 h26 y5217 ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_ _15"> </span>a<span class="_ _21"> </span>store<span class="_ _15"> </span>(from<span class="_ _21"> </span>the<span class="_ _21"> </span>previous<span class="_ _15"> </span>iteration),<span class="_ _f"> </span>a<span class="_ _21"> </span>load,<span class="_ _f"> </span>and<span class="_ _21"> </span>a<span class="_ _15"> </span>ﬂoating-point<span class="_ _21"> </span>addition.</div><div class="t m5 x17 h26 y5218 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _16"> </span>CPE<span class="_ _16"> </span>measurement<span class="_ _11"> </span>of<span class="_ _16"> </span>9.0<span class="_ _16"> </span>is<span class="_ _16"> </span>consistent<span class="_ _11"> </span>with<span class="_ _16"> </span>our<span class="_ _16"> </span>measurement<span class="_ _11"> </span>of<span class="_ _16"> </span>7.3<span class="_ _16"> </span>for<span class="_ _16"> </span>the</div><div class="t m5 x17 h26 y5219 ff7 fs19 fc1 sc0 ls0 ws0">CPE<span class="_"> </span>of<span class="_ _13"> </span><span class="ffd">write_read<span class="_ _10"> </span></span>when<span class="_"> </span>there<span class="_"> </span>is<span class="_ _13"> </span>a<span class="_"> </span>data<span class="_"> </span>dependency<span class="_ _7"></span>,<span class="_"> </span>since<span class="_"> </span><span class="ffd">write_read<span class="_ _13"> </span></span>involves</div><div class="t m5 x17 h26 y521a ff7 fs19 fc1 sc0 ls0 ws0">an<span class="_ _11"> </span>integer<span class="_ _11"> </span>addition<span class="_ _11"> </span>(1<span class="_ _11"> </span>clock-cycle<span class="_"> </span>latency),<span class="_ _11"> </span>while<span class="_ _11"> </span><span class="ffd">psum1<span class="_ _11"> </span></span>involves<span class="_ _11"> </span>a<span class="_ _11"> </span>ﬂoating-point</div><div class="t m5 x17 h26 y521b ff7 fs19 fc1 sc0 ls0 ws0">addition<span class="_"> </span>(3<span class="_"> </span>clock-cycle<span class="_"> </span>latenc<span class="_ _1"></span>y).</div><div class="t m5 x17 h28 y521c ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>5.12<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>597)</span></div><div class="t m5 x17 h26 y521d ff7 fs19 fc1 sc0 ls0 ws0">Here<span class="_"> </span>is<span class="_"> </span>a<span class="_"> </span>revised<span class="_"> </span>version<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>function:</div><div class="t m5 x2c h2d y24b ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">void<span class="_ _1f"> </span>psum1a(float<span class="_ _e"> </span>a[],<span class="_ _1f"> </span>float<span class="_ _1f"> </span>p[],<span class="_ _e"> </span>long<span class="_ _1f"> </span>n)</span></div><div class="t m5 x2c h2d y8fa ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x2c h2d y5fe ff6 fs20 fc6 sc0 ls0 ws0">3<span class="_ _20"> </span><span class="ffd fs1e fc2">long<span class="_ _e"> </span>i;</span></div><div class="t m5 x2c h2d y2594 ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _20"> </span><span class="ffd fs1e fc2">/*<span class="_ _e"> </span>last_val<span class="_ _1f"> </span>holds<span class="_ _1f"> </span>p[i-1];<span class="_ _e"> </span>val<span class="_ _1f"> </span>holds<span class="_ _e"> </span>p[i]<span class="_ _1f"> </span>*/</span></div><div class="t m5 x2c h2d y74e ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _20"> </span><span class="ffd fs1e fc2">float<span class="_ _e"> </span>last_val,<span class="_ _1f"> </span>val;</span></div><div class="t m5 x2c h2d yc21 ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _20"> </span><span class="ffd fs1e fc2">last_val<span class="_ _e"> </span>=<span class="_ _1f"> </span>p[0]<span class="_ _1f"> </span>=<span class="_ _e"> </span>a[0];</span></div><div class="t m5 x2c h2d y107b ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _20"> </span><span class="ffd fs1e fc2 ls33">f<span class="_ _41"></span>o<span class="_ _41"></span>r(<span class="_ _41"></span>i=1<span class="_ _41"></span>;i&lt;n<span class="_ _41"></span>;<span class="ls0">i++)<span class="_ _e"> </span>{</span></span></div><div class="t m5 x2c h2d y13c0 ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _70"> </span><span class="ffd fs1e fc2">val<span class="_ _1a"> </span>=<span class="_ _e"> </span>last_val<span class="_ _1f"> </span>+<span class="_ _1f"> </span>a[i];</span></div><div class="t m5 x2c h2e y587 ff6 fs20 fc6 sc0 ls0 ws0">9</div><div class="t m5 xc5 h2d y832 ffd fs1e fc2 sc0 ls0 ws0">p[i]<span class="_ _e"> </span>=<span class="_ _1f"> </span>val;</div><div class="t m5 x17 h2d y8d6 ff6 fs20 fc6 sc0 ls0 ws0">10<span class="_ _70"> </span><span class="ffd fs1e fc2">last_val<span class="_ _e"> </span>=<span class="_ _1f"> </span>val;</span></div><div class="t m5 x17 h2d y77e ff6 fs20 fc6 sc0 ls0 ws0">11<span class="_ _20"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x17 h2d ye95 ff6 fs20 fc6 sc0 ls0 ws0">12<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
