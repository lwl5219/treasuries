<div id="pf2cb" class="pf w2 h11" data-page-no="2cb"><div class="pc pc2cb w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg2cb.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">714<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>7<span class="_ _3d"> </span>Linking</span></div><div class="t m5 x1d h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>reason<span class="_ _11"> </span>for<span class="_"> </span>this<span class="_"> </span>seemingly<span class="_"> </span>arbitrary<span class="_"> </span>distinction<span class="_ _11"> </span>stems<span class="_"> </span>from<span class="_"> </span>the<span class="_"> </span>way<span class="_"> </span>the<span class="_ _11"> </span>linker</div><div class="t m5 x1d h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">performs<span class="_"> </span>symbol<span class="_"> </span>resolution,<span class="_"> </span>which<span class="_"> </span>we<span class="_"> </span>will<span class="_"> </span>explain<span class="_"> </span>in<span class="_"> </span>Section<span class="_"> </span>7.6.</div><div class="t m5 x29 h26 y2a8 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>GNU<span class="_ _13"> </span><span class="ff9">readelf<span class="_ _13"> </span></span>program<span class="_ _13"> </span>is<span class="_"> </span>a<span class="_ _13"> </span>handy<span class="_ _13"> </span>tool<span class="_ _13"> </span>for<span class="_"> </span>viewing<span class="_ _13"> </span>the<span class="_ _13"> </span>contents<span class="_ _13"> </span>of<span class="_ _13"> </span>object</div><div class="t m5 x1d h26 y2f7 ff7 fs19 fc2 sc0 ls0 ws0">ﬁles<span class="_ _1"></span>.<span class="_"> </span>F<span class="_ _1"></span>or<span class="_"> </span>example<span class="_ _0"></span>,<span class="_"> </span>here<span class="_"> </span>are<span class="_"> </span>the<span class="_"> </span>last<span class="_"> </span>three<span class="_"> </span>symbol<span class="_"> </span>table<span class="_"> </span>entries<span class="_"> </span>for<span class="_"> </span>the<span class="_"> </span>relocatable</div><div class="t m5 x1d h26 y2f8 ff7 fs19 fc2 sc0 ls0 ws0">object<span class="_ _13"> </span>ﬁle<span class="_ _13"> </span><span class="ffd">main.o</span>,<span class="_"> </span>from<span class="_ _13"> </span>the<span class="_ _13"> </span>example<span class="_ _13"> </span>program<span class="_ _13"> </span>in<span class="_"> </span>F<span class="_ _1"></span>igure<span class="_ _13"> </span>7.1.<span class="_ _13"> </span>The<span class="_ _13"> </span>ﬁrst<span class="_ _13"> </span>eight<span class="_ _13"> </span>entries<span class="_ _1"></span>,</div><div class="t m5 x1d h26 y2f9 ff7 fs19 fc2 sc0 ls0 ws0">which<span class="_"> </span>are<span class="_"> </span>not<span class="_"> </span>shown,<span class="_"> </span>are<span class="_"> </span>local<span class="_"> </span>symbols<span class="_"> </span>that<span class="_"> </span>the<span class="_"> </span>linker<span class="_"> </span>uses<span class="_"> </span>internally<span class="_ _3"></span>.</div><div class="t m5 xa4 h2d y5ed7 ffd fs1e fc2 sc0 ls0 ws0">Num:<span class="_ _46"> </span>Value<span class="_ _86"> </span>Size<span class="_ _e"> </span>Type<span class="_ _46"> </span>Bind<span class="_ _3f"> </span>Vis<span class="_ _b9"> </span>Ndx<span class="_ _e"> </span>Name</div><div class="t m5 xc4 h2d y5ed8 ffd fs1e fc2 sc0 ls0 ws0">8:<span class="_ _e"> </span>0000000000000000<span class="_ _46"> </span>24<span class="_ _1f"> </span>FUNC<span class="_ _46"> </span>GLOBAL<span class="_ _1f"> </span>DEFAULT<span class="_ _7b"> </span>1<span class="_ _1f"> </span>main</div><div class="t m5 xc4 h2d y5ed9 ffd fs1e fc2 sc0 ls0 ws0">9:<span class="_ _e"> </span>0000000000000000<span class="_ _8c"> </span>8<span class="_ _1f"> </span>OBJECT<span class="_ _1a"> </span>GLOBAL<span class="_ _1f"> </span>DEFAULT<span class="_ _7b"> </span>3<span class="_ _1f"> </span>array</div><div class="t m5 x10c h2d y5eda ffd fs1e fc2 sc0 ls0 ws0">10:<span class="_ _e"> </span>0000000000000000<span class="_ _8c"> </span>0<span class="_ _1f"> </span>NOTYPE<span class="_ _1a"> </span>GLOBAL<span class="_ _1f"> </span>DEFAULT<span class="_ _3b"> </span>UND<span class="_ _1f"> </span>sum</div><div class="t m5 x29 h26 y5edb ff7 fs19 fc2 sc0 ls0 ws0">In<span class="_ _13"> </span>this<span class="_ _13"> </span>example<span class="_ _1"></span>,<span class="_"> </span>we<span class="_ _6"> </span>see<span class="_ _13"> </span>an<span class="_ _13"> </span>entry<span class="_ _13"> </span>for<span class="_ _13"> </span>the<span class="_ _13"> </span>deﬁnition<span class="_ _13"> </span>of<span class="_ _13"> </span>global<span class="_ _13"> </span>symbol<span class="_ _13"> </span><span class="ffd">main</span>,<span class="_ _13"> </span>a<span class="_ _13"> </span>24-</div><div class="t m5 x1d h26 y5edc ff7 fs19 fc2 sc0 ls0 ws0">byte<span class="_ _11"> </span>function<span class="_ _16"> </span>located<span class="_ _11"> </span>at<span class="_ _16"> </span>an<span class="_ _11"> </span>offset<span class="_ _16"> </span>(i.e<span class="_ _1"></span>.,<span class="_ _16"> </span><span class="ffd">value</span>)<span class="_ _11"> </span>of<span class="_ _16"> </span>zero<span class="_ _11"> </span>in<span class="_ _16"> </span>the<span class="_ _11"> </span><span class="ffd">.text<span class="_ _16"> </span></span>section.<span class="_ _11"> </span>T<span class="_ _1"></span>his</div><div class="t m5 x1d h26 y5edd ff7 fs19 fc2 sc0 ls0 ws0">is<span class="_"> </span>followed<span class="_"> </span>by<span class="_"> </span>the<span class="_"> </span>deﬁnition<span class="_"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>global<span class="_"> </span>symbol<span class="_"> </span><span class="ffd">array</span>,<span class="_"> </span>an<span class="_"> </span>8-byte<span class="_"> </span>object<span class="_"> </span>located</div><div class="t m5 x1d h26 y5ede ff7 fs19 fc2 sc0 ls0 ws0">at<span class="_"> </span>an<span class="_"> </span>offset<span class="_"> </span>of<span class="_"> </span>zero<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span><span class="ffd">.data<span class="_ _10"> </span></span>section.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_"> </span>last<span class="_"> </span>entry<span class="_"> </span>comes<span class="_"> </span>from<span class="_"> </span>the<span class="_"> </span>reference</div><div class="t m5 x1d h26 y5edf ff7 fs19 fc2 sc0 ls0 ws0">to<span class="_ _11"> </span>the<span class="_ _16"> </span>external<span class="_ _16"> </span>symbol<span class="_ _11"> </span><span class="ffd">sum</span>.<span class="_ _16"> </span><span class="ff9">readelf<span class="_ _16"> </span></span>identiﬁes<span class="_ _11"> </span>each<span class="_ _16"> </span>section<span class="_ _16"> </span>by<span class="_ _11"> </span>an<span class="_ _16"> </span>integer<span class="_ _11"> </span>index.</div><div class="t m5 x1d h26 y5ee0 ffd fs19 fc2 sc0 ls0 ws0">Ndx=1<span class="_ _10"> </span><span class="ff7">denotes<span class="_"> </span>the<span class="_"> </span></span>.text<span class="_ _10"> </span><span class="ff7">section,<span class="_"> </span>and<span class="_"> </span></span>Ndx=3<span class="_ _10"> </span><span class="ff7">denotes<span class="_"> </span>the<span class="_"> </span></span>.data<span class="_ _10"> </span><span class="ff7">section.</span></div><div class="t m5 x1d h47 y5ee1 ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>7.1<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>753)</span></div><div class="t m5 x1d h26 y5ee2 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _14"> </span>problem<span class="_ _14"> </span>concerns<span class="_ _14"> </span>the<span class="_ _14"> </span><span class="ffd">m.o<span class="_ _14"> </span></span>and<span class="_ _14"> </span><span class="ffd">swap.o<span class="_ _14"> </span></span>modules<span class="_ _14"> </span>from<span class="_ _14"> </span>Figure<span class="_ _16"> </span>7.5.<span class="_ _14"> </span>F<span class="_ _1"></span>or<span class="_ _14"> </span>each</div><div class="t m5 x1d h26 y5ee3 ff7 fs19 fc1 sc0 ls0 ws0">symbol<span class="_ _14"> </span>that<span class="_ _14"> </span>is<span class="_ _15"> </span>deﬁned<span class="_ _14"> </span>or<span class="_ _15"> </span>referenced<span class="_ _14"> </span>in<span class="_ _15"> </span><span class="ffd">swap.o</span>,<span class="_ _15"> </span>indicate<span class="_ _14"> </span>whether<span class="_ _15"> </span>or<span class="_ _14"> </span>not<span class="_ _15"> </span>it<span class="_ _14"> </span>will</div><div class="t m5 x1d h26 y5ee4 ff7 fs19 fc1 sc0 ls0 ws0">have<span class="_ _13"> </span>a<span class="_ _13"> </span>symbol<span class="_ _13"> </span>table<span class="_ _13"> </span>entry<span class="_"> </span>in<span class="_ _13"> </span>the<span class="_ _13"> </span><span class="ffd">.symtab<span class="_ _13"> </span></span>section<span class="_ _13"> </span>in<span class="_ _13"> </span>module<span class="_ _13"> </span><span class="ffd">swap.o</span>.<span class="_"> </span>If<span class="_ _13"> </span>so<span class="_ _1"></span>,<span class="_ _13"> </span>indicate</div><div class="t m5 x1d h26 y5ee5 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _6"> </span>module<span class="_ _6"> </span>that<span class="_ _13"> </span>deﬁnes<span class="_ _6"> </span>the<span class="_ _6"> </span>symbol<span class="_ _6"> </span>(<span class="ffd">swap.o<span class="_ _13"> </span></span>or<span class="_ _6"> </span><span class="ffd">m.o</span>),<span class="_ _13"> </span>the<span class="_ _a"> </span>symbol<span class="_ _13"> </span>type<span class="_ _a"> </span>(local,<span class="_ _13"> </span>global,</div><div class="t m5 x1d h26 y5ee6 ff7 fs19 fc1 sc0 ls0 ws0">or<span class="_ _11"> </span>extern),<span class="_ _11"> </span>and<span class="_ _11"> </span>the<span class="_ _11"> </span>section<span class="_ _16"> </span>(<span class="ffd">.text</span>,<span class="_"> </span><span class="ffd">.data</span>,<span class="_ _16"> </span><span class="ffd">.bss</span>,<span class="_ _11"> </span>or<span class="_ _11"> </span>COMMON)<span class="_ _11"> </span>it<span class="_ _11"> </span>is<span class="_ _11"> </span>assigned<span class="_ _16"> </span>to</div><div class="t m5 x1d h26 y5ee7 ff7 fs19 fc1 sc0 ls0 ws0">in<span class="_"> </span>the<span class="_"> </span>module<span class="_ _1"></span>.</div><div class="t m5 x14 h3a y37c5 ff6 fs16 fc1 sc0 ls0 ws0">(a)<span class="_ _10"> </span><span class="ffd fs19">m.c</span></div><div class="t m5 x1ba h2c y5ee8 ffa fs16 fc1 sc0 ls0 ws0">code/link/m.c</div><div class="t m5 xb h2d y5ee9 ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">void<span class="_ _1f"> </span>swap();</span></div><div class="t m5 xb h2e y5eea ff6 fs20 fc6 sc0 ls0 ws0">2</div><div class="t m5 xb h2e y5eeb ff6 fs20 fc6 sc0 ls0 ws0">3</div><div class="t m5 x244 h2d yaea ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>buf[2]<span class="_ _1f"> </span>=<span class="_ _1f"> </span>{1,<span class="_ _e"> </span>2};</div><div class="t m5 xb h2e y5eec ff6 fs20 fc6 sc0 ls0 ws0">4</div><div class="t m5 xb h2e y5eed ff6 fs20 fc6 sc0 ls0 ws0">5</div><div class="t m5 x244 h2d y5eee ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>main()</div><div class="t m5 xb h2d y5eef ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 xb h2d y5ef0 ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _20"> </span><span class="ffd fs1e fc2">swap();</span></div><div class="t m5 xb h2d y18cd ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _20"> </span><span class="ffd fs1e fc2">return<span class="_ _e"> </span>0;</span></div><div class="t m5 xb h2d y5ef1 ff6 fs20 fc6 sc0 ls0 ws0">9<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x1ba h2c y5ef2 ffa fs16 fc2 sc0 ls0 ws0">code/link/m.c</div><div class="t m5 x15 h34 y5ef3 ff6 fs16 fc2 sc0 ls0 ws0">(b)</div><div class="t m5 x151 h3a y5ef4 ffd fs19 fc2 sc0 ls0 ws0">swap.c</div><div class="t m5 x1d8 h2c y5ef5 ffa fs16 fc2 sc0 ls0 ws0">code/link/swap<span class="_ _1"></span>.c</div><div class="t m5 x87 h2d y5ef6 ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">extern<span class="_ _1f"> </span>int<span class="_ _e"> </span>buf[];</span></div><div class="t m5 x87 h2e y5ef7 ff6 fs20 fc6 sc0 ls0 ws0">2</div><div class="t m5 x87 h2e y5ef8 ff6 fs20 fc6 sc0 ls0 ws0">3</div><div class="t m5 xfd h2d y5ef9 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>*bufp0<span class="_ _1f"> </span>=<span class="_ _1f"> </span>&amp;buf[0];</div><div class="t m5 x87 h2d y5efa ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _1c"> </span><span class="ffd fs1e fc2">int<span class="_ _1f"> </span>*bufp1;</span></div><div class="t m5 x87 h2e y5efb ff6 fs20 fc6 sc0 ls0 ws0">5</div><div class="t m5 x87 h2e y5efc ff6 fs20 fc6 sc0 ls0 ws0">6</div><div class="t m5 xfd h2d y5efd ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>swap()</div><div class="t m5 x87 h2d y5efe ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x87 h2d y5eff ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _20"> </span><span class="ffd fs1e fc2">int<span class="_ _e"> </span>temp;</span></div><div class="t m5 x87 h2e y5f00 ff6 fs20 fc6 sc0 ls0 ws0">9</div><div class="t m5 x15 h2e y5f01 ff6 fs20 fc6 sc0 ls0 ws0">10</div><div class="t m5 x5e h2d y4fc9 ffd fs1e fc2 sc0 ls0 ws0">bufp1<span class="_ _e"> </span>=<span class="_ _1f"> </span>&amp;buf[1];</div><div class="t m5 x15 h2d y4fca ff6 fs20 fc6 sc0 ls0 ws0">11<span class="_ _20"> </span><span class="ffd fs1e fc2">temp<span class="_ _e"> </span>=<span class="_ _1f"> </span>*bufp0;</span></div><div class="t m5 x15 h2d y4fcb ff6 fs20 fc6 sc0 ls0 ws0">12<span class="_ _20"> </span><span class="ffd fs1e fc2">*bufp0<span class="_ _e"> </span>=<span class="_ _1f"> </span>*bufp1;</span></div><div class="t m5 x15 h2e y4fcc ff6 fs20 fc6 sc0 ls0 ws0">13</div><div class="t m5 x5e h2d y4fcd ffd fs1e fc2 sc0 ls0 ws0">*bufp1<span class="_ _e"> </span>=<span class="_ _1f"> </span>temp;</div><div class="t m5 x15 h2d y4fce ff6 fs20 fc6 sc0 ls0 ws0">14<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x1d8 h2c y5f02 ffa fs16 fc2 sc0 ls0 ws0">code/link/swap<span class="_ _1"></span>.c</div><div class="t m5 x14 h2f y5f03 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>7.5<span class="_ _66"> </span><span class="fc1">Example<span class="_"> </span>program<span class="_"> </span>for<span class="_"> </span>Practice<span class="_"> </span>Problem<span class="_"> </span>7.1.</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
