<div id="pf225" class="pf w2 h11" data-page-no="225"><div class="pc pc225 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg225.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">548<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>5<span class="_ _3d"> </span>Optimizing<span class="_ _10"> </span>Program<span class="_ _10"> </span>Performance</span></div><div class="t m5 x1d h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">deployed,<span class="_ _11"> </span>however,<span class="_ _11"> </span>it<span class="_ _11"> </span>is<span class="_ _11"> </span>entirely<span class="_ _11"> </span>possible<span class="_ _11"> </span>that<span class="_ _11"> </span>the<span class="_ _11"> </span>procedure<span class="_ _11"> </span>could<span class="_ _11"> </span>be<span class="_ _11"> </span>applied<span class="_ _16"> </span>to</div><div class="t m5 x1d h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">strings<span class="_ _11"> </span>of<span class="_ _16"> </span>over<span class="_ _16"> </span>one<span class="_ _11"> </span>million<span class="_ _16"> </span>characters<span class="_ _1"></span>.<span class="_ _16"> </span>All<span class="_ _11"> </span>of<span class="_ _16"> </span>a<span class="_ _11"> </span>sudden<span class="_ _16"> </span>this<span class="_ _16"> </span>benign<span class="_ _11"> </span>piece<span class="_ _16"> </span>of<span class="_ _11"> </span>code</div><div class="t m5 x1d h26 y2a8 ff7 fs19 fc2 sc0 ls0 ws0">has<span class="_ _14"> </span>become<span class="_ _15"> </span>a<span class="_ _15"> </span>major<span class="_ _15"> </span>performance<span class="_ _14"> </span>bottleneck.<span class="_ _15"> </span>By<span class="_ _15"> </span>contrast,<span class="_ _15"> </span>the<span class="_ _15"> </span>performance<span class="_ _15"> </span>of</div><div class="t m5 x1d h26 y2f7 ffd fs19 fc2 sc0 ls0 ws0">lower2<span class="_ _11"> </span><span class="ff7">will<span class="_ _16"> </span>be<span class="_ _11"> </span>adequate<span class="_ _11"> </span>for<span class="_ _16"> </span>strings<span class="_ _11"> </span>of<span class="_ _16"> </span>arbitrary<span class="_ _11"> </span>length.<span class="_ _11"> </span>Stories<span class="_ _16"> </span>abound<span class="_ _11"> </span>of<span class="_ _16"> </span>major</span></div><div class="t m5 x1d h26 y2f8 ff7 fs19 fc2 sc0 ls0 ws0">programming<span class="_ _16"> </span>projects<span class="_ _16"> </span>in<span class="_ _16"> </span>which<span class="_ _16"> </span>problems<span class="_ _16"> </span>of<span class="_ _16"> </span>this<span class="_ _16"> </span>sort<span class="_ _16"> </span>occur<span class="_ _0"></span>.<span class="_ _16"> </span>Part<span class="_ _16"> </span>of<span class="_ _16"> </span>the<span class="_ _16"> </span>job<span class="_ _16"> </span>of<span class="_ _16"> </span>a</div><div class="t m5 x1d h26 y2f9 ff7 fs19 fc2 sc0 ls0 ws0">competent<span class="_"> </span>programmer<span class="_"> </span>is<span class="_ _13"> </span>to<span class="_"> </span>avoid<span class="_"> </span>ever<span class="_"> </span>introducing<span class="_ _13"> </span>such<span class="_"> </span>asymptotic<span class="_"> </span>inefﬁciency<span class="_ _7"></span>.</div><div class="t m5 x1d h47 y4b23 ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>5.3<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>609)</span></div><div class="t m5 x1d h26 y4b24 ff7 fs19 fc1 sc0 ls0 ws0">Consider<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>functions:</div><div class="t m5 x1d h2d y4b25 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>min(long<span class="_ _1f"> </span>x,<span class="_ _1f"> </span>long<span class="_ _e"> </span>y)<span class="_ _1f"> </span>{<span class="_ _e"> </span>retur<span class="ls33">nx&lt;y?x:y<span class="_ _41"></span>;}</span></div><div class="t m5 x1d h2d y4b26 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>max(long<span class="_ _1f"> </span>x,<span class="_ _1f"> </span>long<span class="_ _e"> </span>y)<span class="_ _1f"> </span>{<span class="_ _e"> </span>retur<span class="ls33">nx&lt;y?y:x<span class="_ _41"></span>;}</span></div><div class="t m5 x1d h2d y4b27 ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>incr(long<span class="_ _1f"> </span>*xp,<span class="_ _1f"> </span>long<span class="_ _e"> </span>v)<span class="_ _1f"> </span>{<span class="_ _e"> </span>*xp<span class="_ _1f"> </span>+=<span class="_ _1f"> </span>v;<span class="_ _e"> </span>}</div><div class="t m5 x1d h2d y4b28 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>square(long<span class="_ _1f"> </span>x)<span class="_ _1f"> </span>{<span class="_ _e"> </span>return<span class="_ _1f"> </span>x*x;<span class="_ _e"> </span>}</div><div class="t m5 x29 h26 y4b29 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>following<span class="_"> </span>three<span class="_"> </span>code<span class="_"> </span>fragments<span class="_"> </span>call<span class="_"> </span>these<span class="_"> </span>functions:</div><div class="t m5 x124 h26 y4b2a ff7 fs19 fc2 sc0 ls0 ws0">A.</div><div class="t m5 x33 h2d y4b2b ffd fs1e fc2 sc0 ls0 ws0">for<span class="_ _e"> </span>(i<span class="_ _1f"> </span>=<span class="_ _1f"> </span>min(x,<span class="_ _e"> </span>y);<span class="_ _1f"> </span>i<span class="_ _e"> </span>&lt;<span class="_ _1f"> </span>max(x,<span class="_ _1f"> </span>y);<span class="_ _e"> </span>incr(&amp;i,<span class="_ _1f"> </span>1))</div><div class="t m5 xf7 h2d y4b2c ffd fs1e fc2 sc0 ls0 ws0">t<span class="_ _e"> </span>+=<span class="_ _1f"> </span>square(i);</div><div class="t m5 x124 h26 y4b2d ff7 fs19 fc2 sc0 ls2a ws0">B.</div><div class="t m5 x33 h2d y4b2e ffd fs1e fc2 sc0 ls0 ws0">for<span class="_ _e"> </span>(i<span class="_ _1f"> </span>=<span class="_ _1f"> </span>max(x,<span class="_ _e"> </span>y)<span class="_ _1f"> </span>-<span class="_ _e"> </span>1;<span class="_ _1f"> </span>i<span class="_ _1f"> </span>&gt;=<span class="_ _e"> </span>min(x,<span class="_ _1f"> </span>y);<span class="_ _e"> </span>incr(&amp;i,<span class="_ _1f"> </span>-1))</div><div class="t m5 xf7 h2d y4b2f ffd fs1e fc2 sc0 ls0 ws0">t<span class="_ _e"> </span>+=<span class="_ _1f"> </span>square(i);</div><div class="t m5 x124 h26 y4b30 ff7 fs19 fc2 sc0 ls22 ws0">C.</div><div class="t m5 x33 h2d y4b31 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>low<span class="_ _1f"> </span>=<span class="_ _1f"> </span>min(x,<span class="_ _e"> </span>y);</div><div class="t m5 x33 h2d y4b32 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>high<span class="_ _1f"> </span>=<span class="_ _1f"> </span>max(x,<span class="_ _e"> </span>y);</div><div class="t m5 x33 h2d y4b33 ffd fs1e fc2 sc0 ls0 ws0">for<span class="_ _e"> </span>(i<span class="_ _1f"> </span>=<span class="_ _1f"> </span>low;<span class="_ _e"> </span>i<span class="_ _1f"> </span>&lt;<span class="_ _e"> </span>high;<span class="_ _1f"> </span>incr(&amp;i,<span class="_ _1f"> </span>1))</div><div class="t m5 xf7 h2d y4b34 ffd fs1e fc2 sc0 ls0 ws0">t<span class="_ _e"> </span>+=<span class="_ _1f"> </span>square(i);</div><div class="t m5 x1d h26 y4b35 ff7 fs19 fc2 sc0 ls0 ws0">Assume<span class="_ _14"> </span><span class="ffd">x<span class="_ _14"> </span></span>equals<span class="_ _16"> </span>10<span class="_ _14"> </span>and<span class="_ _14"> </span><span class="ffd">y<span class="_ _14"> </span></span>equals<span class="_ _14"> </span>100.<span class="_ _14"> </span>Fill<span class="_ _16"> </span>in<span class="_ _14"> </span>the<span class="_ _14"> </span>following<span class="_ _14"> </span>table<span class="_ _14"> </span>indicating<span class="_ _14"> </span>the</div><div class="t m5 x1d h26 y4b36 ff7 fs19 fc2 sc0 ls0 ws0">number<span class="_"> </span>of<span class="_"> </span>times<span class="_"> </span>each<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>four<span class="_"> </span>functions<span class="_"> </span>is<span class="_"> </span>called<span class="_"> </span>in<span class="_"> </span>code<span class="_"> </span>fragments<span class="_"> </span>A–C:</div><div class="t m5 x1d h31 y4b37 ff7 fs21 fc2 sc0 ls0 ws0">Code<span class="_ _11a"> </span><span class="ffd fs1e">min<span class="_ _1dc"> </span>max<span class="_ _d0"> </span>incr<span class="_ _5a"> </span>square</span></div><div class="t m5 xcf h31 y4b38 ff7 fs21 fc2 sc0 ls0 ws0">A.</div><div class="t m5 x10b h31 y4b39 ff7 fs21 fc1 sc0 ls210 ws0">B.</div><div class="t m5 x10b h31 y4b3a ff7 fs21 fc1 sc0 ls153 ws0">C.</div><div class="t m5 x1d h3b y277 fff fs24 fc6 sc0 ls0 ws0">5.5<span class="_ _17"> </span><span class="ffe fs18">Reducing<span class="_"> </span>Procedure<span class="_"> </span>Calls</span></div><div class="t m5 x1d h26 yc21 ff7 fs19 fc1 sc0 ls0 ws0">As<span class="_ _13"> </span>we<span class="_ _13"> </span>have<span class="_ _13"> </span>seen,<span class="_ _13"> </span>procedure<span class="_ _13"> </span>calls<span class="_ _13"> </span>can<span class="_ _13"> </span>incur<span class="_ _13"> </span>overhead<span class="_ _6"> </span>and<span class="_ _13"> </span>also<span class="_ _13"> </span>block<span class="_ _13"> </span>most<span class="_ _13"> </span>forms<span class="_ _13"> </span>of</div><div class="t m5 x1d h26 yc22 ff7 fs19 fc1 sc0 ls0 ws0">program<span class="_ _13"> </span>optimization.<span class="_ _13"> </span>W<span class="_ _3"></span>e<span class="_ _13"> </span>can<span class="_ _13"> </span>see<span class="_ _13"> </span>in<span class="_ _13"> </span>the<span class="_ _13"> </span>code<span class="_ _13"> </span>for<span class="_ _13"> </span><span class="ffd">combine2<span class="_ _13"> </span></span>(Figure<span class="_ _13"> </span>5.6)<span class="_ _13"> </span>that<span class="_ _13"> </span><span class="ffd">get_</span></div><div class="t m5 x1d h26 yc23 ffd fs19 fc1 sc0 ls0 ws0">vec_element<span class="_ _13"> </span><span class="ff7">is<span class="_"> </span>called<span class="_ _13"> </span>on<span class="_ _13"> </span>every<span class="_"> </span>loop<span class="_ _13"> </span>iteration<span class="_ _13"> </span>to<span class="_"> </span>retrieve<span class="_ _13"> </span>the<span class="_ _13"> </span>next<span class="_"> </span>vector<span class="_ _13"> </span>element.</span></div><div class="t m5 x1d h26 yc24 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_"> </span>function<span class="_ _13"> </span>checks<span class="_"> </span>the<span class="_ _13"> </span>vector<span class="_ _13"> </span>index<span class="_"> </span><span class="ffd">i<span class="_ _13"> </span></span>against<span class="_"> </span>the<span class="_ _13"> </span>loop<span class="_ _13"> </span>bounds<span class="_"> </span>with<span class="_ _13"> </span>every<span class="_"> </span>vector</div><div class="t m5 x1d h26 yc25 ff7 fs19 fc1 sc0 ls0 ws0">reference<span class="_ _1"></span>,<span class="_ _13"> </span>a<span class="_ _13"> </span>clear<span class="_ _6"> </span>source<span class="_ _13"> </span>of<span class="_ _6"> </span>inefﬁciency<span class="_ _7"></span>.<span class="_ _13"> </span>Bounds<span class="_ _6"> </span>checking<span class="_ _13"> </span>might<span class="_ _6"> </span>be<span class="_ _13"> </span>a<span class="_ _6"> </span>useful<span class="_ _13"> </span>feature</div><div class="t m5 x1d h26 yc26 ff7 fs19 fc1 sc0 ls0 ws0">when<span class="_ _11"> </span>dealing<span class="_ _16"> </span>with<span class="_ _11"> </span>arbitrary<span class="_ _11"> </span>array<span class="_ _11"> </span>accesses<span class="_ _0"></span>,<span class="_ _11"> </span>but<span class="_ _16"> </span>a<span class="_ _11"> </span>simple<span class="_ _11"> </span>analysis<span class="_ _16"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>code<span class="_ _16"> </span>for</div><div class="t m5 x1d h26 y14b5 ffd fs19 fc1 sc0 ls0 ws0">combine2<span class="_ _10"> </span><span class="ff7">shows<span class="_"> </span>that<span class="_"> </span>all<span class="_"> </span>references<span class="_"> </span>will<span class="_"> </span>be<span class="_"> </span>valid.</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
