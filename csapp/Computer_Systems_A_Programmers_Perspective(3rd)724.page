<div id="pf2d4" class="pf w2 h11" data-page-no="2d4"><div class="pc pc2d4 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg2d4.png"/><div class="t m5 x84 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>7.6<span class="_ _60"> </span>Symbol<span class="_ _10"> </span>Resolution<span class="_ _3e"> </span><span class="ffe fs1e">723</span></div><div class="t m5 x6b h2c y27f ffa fs16 fc2 sc0 ls0 ws0">code/link/main2.c</div><div class="t m5 x2c h2d y280 ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">#include<span class="_ _1f"> </span>&lt;stdio.h&gt;</span></div><div class="t m5 x2c h2d y281 ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _1c"> </span><span class="ffd fs1e fc2">#include<span class="_ _1f"> </span>&quot;vector.h&quot;</span></div><div class="t m5 x2c h2e y283 ff6 fs20 fc6 sc0 ls0 ws0">3</div><div class="t m5 x2c h2e y5fd0 ff6 fs20 fc6 sc0 ls0 ws0">4</div><div class="t m5 x2d h2d y284 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>x[2]<span class="_ _1f"> </span>=<span class="_ _1f"> </span>{1,<span class="_ _e"> </span>2};</div><div class="t m5 x2c h2d y285 ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _1c"> </span><span class="ffd fs1e fc2">int<span class="_ _1f"> </span>y[2]<span class="_ _e"> </span>=<span class="_ _1f"> </span>{3,<span class="_ _1f"> </span>4};</span></div><div class="t m5 x2c h2d y286 ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _1c"> </span><span class="ffd fs1e fc2">int<span class="_ _1f"> </span>z[2];</span></div><div class="t m5 x2c h2e y287 ff6 fs20 fc6 sc0 ls0 ws0">7</div><div class="t m5 x2c h2e y5fd1 ff6 fs20 fc6 sc0 ls0 ws0">8</div><div class="t m5 x2d h2d y4493 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>main()</div><div class="t m5 x2c h2d y4a9a ff6 fs20 fc6 sc0 ls0 ws0">9<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x17 h2d y4a9b ff6 fs20 fc6 sc0 ls0 ws0">10<span class="_ _20"> </span><span class="ffd fs1e fc2">addvec(x,<span class="_ _e"> </span>y,<span class="_ _1f"> </span>z,<span class="_ _1f"> </span>2);</span></div><div class="t m5 x17 h2d y4a9c ff6 fs20 fc6 sc0 ls0 ws0">11<span class="_ _20"> </span><span class="ffd fs1e fc2">printf(&quot;z<span class="_ _e"> </span>=<span class="_ _1f"> </span>[%d<span class="_ _1f"> </span>%d]\n&quot;,<span class="_ _e"> </span>z[0],<span class="_ _1f"> </span>z[1]);</span></div><div class="t m5 x17 h2d y906 ff6 fs20 fc6 sc0 ls0 ws0">12<span class="_ _20"> </span><span class="ffd fs1e fc2">return<span class="_ _e"> </span>0;</span></div><div class="t m5 x17 h2d y4a9d ff6 fs20 fc6 sc0 ls0 ws0">13<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x6b h2c y5fd2 ffa fs16 fc2 sc0 ls0 ws0">code/link/main2.c</div><div class="t m5 x17 h34 y5fd3 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _11"> </span>7.7<span class="_ _c"> </span><span class="fc1">Example<span class="_ _16"> </span>program<span class="_ _11"> </span>2.<span class="_ _16"> </span><span class="ff6">This<span class="_ _11"> </span>program<span class="_ _11"> </span>invokes<span class="_ _16"> </span>a<span class="_ _11"> </span>function<span class="_ _16"> </span>in<span class="_ _11"> </span>the</span></span></div><div class="t m5 x9 h3a yeaf ffd fs19 fc1 sc0 ls0 ws0">libvector</div><div class="t m5 x17 h34 y5fd4 ff6 fs16 fc1 sc0 ls0 ws0">library<span class="_ _1"></span>.</div><div class="t m5 x1c5 h40 y5fd5 ff8d fs28 fc1 sc0 ls0 ws0">main2.c vector.h</div><div class="t m5 x15c h40 y5fd6 ff8d fs28 fc1 sc0 ls0 ws0">libvector.a<span class="_ _f4"> </span>libc.a</div><div class="t m5 x1d7 h40 y5fd7 ff8d fs28 fc1 sc0 ls0 ws0">addvec.o<span class="_ _57"> </span>printf.o</div><div class="t m5 xfe h3f y5fd8 ff8d fs2a fc1 sc0 ls0 ws0"> <span class="ff80 fs27">and any other</span></div><div class="t m5 x7f h40 y5fd9 ff80 fs27 fc1 sc0 ls0 ws0">modules called by<span class="ff8d fs2a"> <span class="fs28">printf.o</span></span></div><div class="t m5 x75 h40 y5fda ff8d fs28 fc1 sc0 ls0 ws0">main2.o</div><div class="t m5 xc5 h3f y5fdb ff8e fs27 fc1 sc0 ls0 ws0">T<span class="_ _0"></span>ranslators</div><div class="t m5 x20a h40 y5fdc ff8e fs27 fc1 sc0 ls0 ws0">(<span class="ff8d fs28">cpp, cc1, as</span>)</div><div class="t m5 x1af h3f y5fdd ff8e fs27 fc1 sc0 ls0 ws0">Linker (</div><div class="t m5 x115 h40 y5fde ff8d fs28 fc1 sc0 ls0 ws0">ld<span class="ff8e fs27">)</span></div><div class="t m5 x1f2 h40 y5fdf ff8d fs28 fc1 sc0 ls0 ws0">prog2c</div><div class="t m5 xa8 h3f y5fe0 ff80 fs27 fc1 sc0 ls0 ws0">Fully linked</div><div class="t m5 xa8 h3f y5fe1 ff80 fs27 fc1 sc0 ls0 ws0">ex<span class="_ _1"></span>ecutable object file</div><div class="t m5 x17 h3f y5fe2 ff80 fs27 fc1 sc0 ls0 ws0">Relocatable</div><div class="t m5 x17 h3f y5fe3 ff80 fs27 fc1 sc0 ls0 ws0">object files</div><div class="t m5 x17 h3f y5fe4 ff80 fs27 fc1 sc0 ls0 ws0">Source files</div><div class="t m5 x1c9 h3f y5fe5 ff80 fs27 fc1 sc0 ls0 ws0">Static libraries</div><div class="t m5 x17 h2f y5fe6 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>7.8<span class="_ _66"> </span><span class="fc1">Linking<span class="_"> </span>with<span class="_"> </span>static<span class="_"> </span>libraries.</span></div><div class="t m5 x17 h26 y5fe7 ff7 fs19 fc1 sc0 ls0 ws0">or<span class="_"> </span>equivalently<span class="_ _3"></span>,</div><div class="t m5 x17 h2d y5fe8 ffd fs1e fc2 sc0 ls0 ws0">linux&gt;<span class="_ _e"> </span><span class="ff13">gcc<span class="_ _1f"> </span>-c<span class="_ _1f"> </span>main2.c</span></div><div class="t m5 x17 h2d y5fe9 ffd fs1e fc2 sc0 ls0 ws0">linux&gt;<span class="_ _e"> </span><span class="ff13">gcc<span class="_ _1f"> </span>-static<span class="_ _1f"> </span>-o<span class="_ _e"> </span>prog2c<span class="_ _1f"> </span>main2.o<span class="_ _e"> </span>-L.<span class="_ _1f"> </span>-lvector</span></div><div class="t m5 x17 h26 y2578 ff7 fs19 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_ _11"> </span>7.8<span class="_ _11"> </span>summarizes<span class="_ _11"> </span>the<span class="_ _11"> </span>activity<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _16"> </span>linker<span class="_ _0"></span>.<span class="_"> </span>The<span class="_"> </span><span class="ffd">-static<span class="_ _11"> </span></span>argument<span class="_ _11"> </span>tells<span class="_ _11"> </span>the</div><div class="t m5 x17 h26 y2579 ff7 fs19 fc2 sc0 ls0 ws0">compiler<span class="_ _16"> </span>driver<span class="_ _16"> </span>that<span class="_ _16"> </span>the<span class="_ _11"> </span>linker<span class="_ _16"> </span>should<span class="_ _16"> </span>build<span class="_ _16"> </span>a<span class="_ _16"> </span>fully<span class="_ _16"> </span>linked<span class="_ _16"> </span>executable<span class="_ _16"> </span>object<span class="_ _16"> </span>ﬁle</div><div class="t m5 x17 h26 y257a ff7 fs19 fc2 sc0 ls0 ws0">that<span class="_"> </span>can<span class="_ _13"> </span>be<span class="_"> </span>loaded<span class="_"> </span>into<span class="_"> </span>memory<span class="_ _13"> </span>and<span class="_"> </span>run<span class="_"> </span>without<span class="_ _13"> </span>any<span class="_"> </span>further<span class="_"> </span>linking<span class="_"> </span>at<span class="_ _13"> </span>load<span class="_"> </span>time<span class="_ _1"></span>.</div><div class="t m5 x17 h26 y257b ff7 fs19 fc2 sc0 lsd ws0">Th<span class="_ _2"></span>e<span class="_ _16"> </span><span class="ffd ls0">-lvector<span class="_ _11"> </span><span class="ff7">argument<span class="_ _16"> </span>is<span class="_"> </span>a<span class="_ _16"> </span>shorthand<span class="_ _11"> </span>for<span class="_ _11"> </span></span>libvector.a<span class="ff7">,<span class="_ _16"> </span>and<span class="_ _11"> </span>the<span class="_ _11"> </span></span>-L.<span class="_ _11"> </span><span class="ff7">argument</span></span></div><div class="t m5 x17 h26 y257c ff7 fs19 fc2 sc0 ls0 ws0">tells<span class="_"> </span>the<span class="_"> </span>linker<span class="_"> </span>to<span class="_"> </span>look<span class="_"> </span>for<span class="_"> </span><span class="ffd">libvector.a<span class="_ _10"> </span></span>in<span class="_"> </span>the<span class="_"> </span>current<span class="_"> </span>directory<span class="_ _3"></span>.</div><div class="t m5 x26 h26 y257d ff7 fs19 fc2 sc0 ls0 ws0">When<span class="_ _e"> </span>the<span class="_ _e"> </span>linker<span class="_ _e"> </span>runs<span class="_ _3"></span>,<span class="_ _22"> </span>it<span class="_ _e"> </span>determines<span class="_ _e"> </span>that<span class="_ _e"> </span>the<span class="_ _e"> </span><span class="ffd">addvec<span class="_ _e"> </span></span>symbol<span class="_ _e"> </span>deﬁned<span class="_ _e"> </span>by</div><div class="t m5 x17 h26 y3e00 ffd fs19 fc2 sc0 ls0 ws0">addvec.o<span class="_ _14"> </span><span class="ff7">is<span class="_ _14"> </span>referenced<span class="_ _14"> </span>by<span class="_ _14"> </span></span>main2.o<span class="ff7">,<span class="_ _14"> </span>so<span class="_ _14"> </span>it<span class="_ _14"> </span>copies<span class="_ _14"> </span></span>addvec.o<span class="_ _14"> </span><span class="ff7">into<span class="_ _14"> </span>the<span class="_ _14"> </span>executable.</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
