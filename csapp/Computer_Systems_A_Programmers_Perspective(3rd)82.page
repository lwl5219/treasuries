<div id="pf52" class="pf w2 h11" data-page-no="52"><div class="pc pc52 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg52.png"/><div class="t m5 x2b h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>2.1<span class="_ _60"> </span>Information<span class="_ _10"> </span>Storage<span class="_ _3e"> </span><span class="ffe fs1e">81</span></div><div class="t m5 x2c h2d yaa0 ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">#include<span class="_ _1f"> </span>&lt;stdio.h&gt;</span></div><div class="t m5 x2c h2e yaa1 ff6 fs20 fc6 sc0 ls0 ws0">2</div><div class="t m5 x2c h2e yaa2 ff6 fs20 fc6 sc0 ls0 ws0">3</div><div class="t m5 x2d h2d yaa3 ffd fs1e fc2 sc0 ls0 ws0">typedef<span class="_ _e"> </span>unsigned<span class="_ _1f"> </span>char<span class="_ _1f"> </span>*byte_pointer;</div><div class="t m5 x2c h2e yaa4 ff6 fs20 fc6 sc0 ls0 ws0">4</div><div class="t m5 x2c h2e yaa5 ff6 fs20 fc6 sc0 ls0 ws0">5</div><div class="t m5 x2d h2d yaa6 ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>show_bytes(byte_pointer<span class="_ _1f"> </span>start,<span class="_ _1f"> </span>size_t<span class="_ _e"> </span>len)<span class="_ _1f"> </span>{</div><div class="t m5 x2c h2d yaa7 ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _20"> </span><span class="ffd fs1e fc2">int<span class="_ _e"> </span>i;</span></div><div class="t m5 x2c h2d yaa8 ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _20"> </span><span class="ffd fs1e fc2">for<span class="_ _e"> </span>(i<span class="_ _1f"> </span>=<span class="_ _1f"> </span>0;<span class="_ _e"> </span>i<span class="_ _1f"> </span>&lt;<span class="_ _e"> </span>len;<span class="_ _1f"> </span>i++)</span></div><div class="t m5 x2c h2d yaa9 ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _70"> </span><span class="ffd fs1e fc2">printf(&quot;<span class="_ _e"> </span>%.2x&quot;,<span class="_ _1f"> </span>start[i]);</span></div><div class="t m5 x2c h2d yaaa ff6 fs20 fc6 sc0 ls0 ws0">9<span class="_ _20"> </span><span class="ffd fs1e fc2">printf(&quot;\n&quot;);</span></div><div class="t m5 x17 h2d yaab ff6 fs20 fc6 sc0 ls0 ws0">10<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x17 h2e yaac ff6 fs20 fc6 sc0 ls0 ws0">11</div><div class="t m5 x17 h2e yaad ff6 fs20 fc6 sc0 ls0 ws0">12</div><div class="t m5 x2d h2d yaae ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>show_int(int<span class="_ _1f"> </span>x)<span class="_ _1f"> </span>{</div><div class="t m5 x17 h2d yaaf ff6 fs20 fc6 sc0 ls0 ws0">13<span class="_ _20"> </span><span class="ffd fs1e fc2">show_bytes((byte_pointer)<span class="_ _e"> </span>&amp;x,<span class="_ _1f"> </span>sizeof(int));</span></div><div class="t m5 x17 h2d yab0 ff6 fs20 fc6 sc0 ls0 ws0">14<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x17 h2e yab1 ff6 fs20 fc6 sc0 ls0 ws0">15</div><div class="t m5 x17 h2e yab2 ff6 fs20 fc6 sc0 ls0 ws0">16</div><div class="t m5 x2d h2d yab3 ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>show_float(float<span class="_ _1f"> </span>x)<span class="_ _1f"> </span>{</div><div class="t m5 x17 h2d yab4 ff6 fs20 fc6 sc0 ls0 ws0">17<span class="_ _20"> </span><span class="ffd fs1e fc2">show_bytes((byte_pointer)<span class="_ _e"> </span>&amp;x,<span class="_ _1f"> </span>sizeof(float));</span></div><div class="t m5 x17 h2d yab5 ff6 fs20 fc6 sc0 ls0 ws0">18<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x17 h2e yab6 ff6 fs20 fc6 sc0 ls0 ws0">19</div><div class="t m5 x17 h2e yab7 ff6 fs20 fc6 sc0 ls0 ws0">20</div><div class="t m5 x2d h2d yab8 ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>show_pointer(void<span class="_ _1f"> </span>*x)<span class="_ _1f"> </span>{</div><div class="t m5 x17 h2d yab9 ff6 fs20 fc6 sc0 ls0 ws0">21<span class="_ _20"> </span><span class="ffd fs1e fc2">show_bytes((byte_pointer)<span class="_ _e"> </span>&amp;x,<span class="_ _1f"> </span>sizeof(void<span class="_ _1f"> </span>*));</span></div><div class="t m5 x17 h2e yaba ff6 fs20 fc6 sc0 ls0 ws0">22</div><div class="t m5 x2d h2d yabb ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x17 h34 yabc ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _16"> </span>2.4<span class="_ _c"> </span><span class="fc1">Code<span class="_ _16"> </span>to<span class="_ _16"> </span>print<span class="_ _14"> </span>the<span class="_ _16"> </span>byte<span class="_ _16"> </span>representation<span class="_ _16"> </span>of<span class="_ _16"> </span>program<span class="_ _14"> </span>objects.<span class="_ _16"> </span><span class="ff6">This<span class="_ _16"> </span>code</span></span></div><div class="t m5 x17 h34 yabd ff6 fs16 fc1 sc0 ls0 ws0">uses<span class="_ _10"> </span>casting<span class="_ _10"> </span>to<span class="_ _10"> </span>cir<span class="_ _0"></span>cumvent<span class="_ _10"> </span>the<span class="_ _10"> </span>type<span class="_ _10"> </span>system.<span class="_ _10"> </span>Similar<span class="_ _10"> </span>functions<span class="_ _13"> </span>are<span class="_ _10"> </span>easily<span class="_ _10"> </span>deﬁned<span class="_ _10"> </span>for<span class="_ _10"> </span>other</div><div class="t m5 x17 h34 yabe ff6 fs16 fc1 sc0 ls0 ws0">data<span class="_ _10"> </span>types.</div><div class="t m5 x26 h26 yabf ff7 fs19 fc1 sc0 ls0 ws0">Procedures<span class="_ _11"> </span><span class="ffd">show_int</span>,<span class="_ _16"> </span><span class="ffd">show_float</span>,<span class="_ _16"> </span>and<span class="_ _11"> </span><span class="ffd">show_pointer<span class="_ _16"> </span></span>demonstrate<span class="_ _11"> </span>how<span class="_ _16"> </span>to</div><div class="t m5 x17 h26 yac0 ff7 fs19 fc1 sc0 ls0 ws0">use<span class="_ _13"> </span>procedure<span class="_ _13"> </span><span class="ffd">show_bytes<span class="_ _13"> </span></span>to<span class="_ _13"> </span>print<span class="_"> </span>the<span class="_ _13"> </span>byte<span class="_ _13"> </span>representations<span class="_ _13"> </span>of<span class="_ _13"> </span>C<span class="_ _13"> </span>program<span class="_ _13"> </span>objects</div><div class="t m5 x17 h26 yac1 ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_ _13"> </span>type<span class="_"> </span><span class="ffd">int</span>,<span class="_ _13"> </span><span class="ffd">float</span>,<span class="_"> </span>and<span class="_ _13"> </span><span class="ffd">void<span class="_ _16"> </span>*</span>,<span class="_ _13"> </span>respectively<span class="_ _3"></span>.<span class="_"> </span>Observe<span class="_ _13"> </span>that<span class="_ _13"> </span>they<span class="_"> </span>simply<span class="_ _13"> </span>pass<span class="_ _13"> </span><span class="ffd">show_</span></div><div class="t m5 x17 h26 yac2 ffd fs19 fc1 sc0 ls0 ws0">bytes<span class="_ _13"> </span><span class="ff7">a<span class="_ _13"> </span>pointer<span class="_ _13"> </span></span>&amp;x<span class="_ _13"> </span><span class="ff7">to<span class="_"> </span>their<span class="_ _13"> </span>argument<span class="_ _13"> </span></span>x<span class="ff7">,<span class="_ _13"> </span>casting<span class="_ _13"> </span>the<span class="_ _13"> </span>pointer<span class="_ _13"> </span>to<span class="_ _13"> </span>be<span class="_"> </span>of<span class="_ _13"> </span>type<span class="_ _13"> </span></span>unsigned</div><div class="t m5 x17 h26 yac3 ffd fs19 fc1 sc0 ls0 ws0">char<span class="_ _11"> </span>*<span class="ff7">.<span class="_ _16"> </span>T<span class="_ _1"></span>his<span class="_ _11"> </span>cast<span class="_ _11"> </span>indicates<span class="_ _16"> </span>to<span class="_"> </span>the<span class="_ _11"> </span>compiler<span class="_ _16"> </span>that<span class="_"> </span>the<span class="_ _16"> </span>program<span class="_"> </span>should<span class="_ _16"> </span>consider<span class="_"> </span>the</span></div><div class="t m5 x17 h26 yac4 ff7 fs19 fc1 sc0 ls0 ws0">pointer<span class="_"> </span>to<span class="_ _11"> </span>be<span class="_ _11"> </span>to<span class="_ _11"> </span>a<span class="_ _11"> </span>sequence<span class="_ _11"> </span>of<span class="_ _11"> </span>bytes<span class="_ _11"> </span>rather<span class="_ _11"> </span>than<span class="_ _11"> </span>to<span class="_ _11"> </span>an<span class="_ _11"> </span>object<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>original<span class="_ _11"> </span>data</div><div class="t m5 x17 h26 yac5 ff7 fs19 fc1 sc0 ls0 ws0">type<span class="_ _1"></span>.<span class="_"> </span>This<span class="_"> </span>pointer<span class="_"> </span>will<span class="_"> </span>then<span class="_"> </span>be<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>lowest<span class="_"> </span>byte<span class="_"> </span>address<span class="_"> </span>occupied<span class="_"> </span>by<span class="_"> </span>the<span class="_"> </span>object.</div><div class="t m5 x26 h26 yac6 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>hese<span class="_ _6"> </span>procedures<span class="_ _6"> </span>use<span class="_ _6"> </span>the<span class="_ _6"> </span>C<span class="_ _13"> </span><span class="ffd">sizeof<span class="_ _a"> </span></span>operator<span class="_ _6"> </span>to<span class="_ _6"> </span>determine<span class="_ _6"> </span>the<span class="_ _6"> </span>number<span class="_ _6"> </span>of<span class="_ _6"> </span>bytes</div><div class="t m5 x17 h26 yac7 ff7 fs19 fc1 sc0 ls0 ws0">used<span class="_"> </span>by<span class="_ _11"> </span>the<span class="_ _11"> </span>object.<span class="_ _11"> </span>In<span class="_ _11"> </span>general,<span class="_ _11"> </span>the<span class="_ _11"> </span>expression<span class="_ _11"> </span><span class="ffd">sizeof(<span class="ff11">T<span class="_ _13"> </span></span>)<span class="_ _11"> </span></span>returns<span class="_ _11"> </span>the<span class="_ _11"> </span>number<span class="_ _11"> </span>of</div><div class="t m5 x17 h26 yac8 ff7 fs19 fc1 sc0 ls0 ws0">bytes<span class="_ _13"> </span>required<span class="_ _13"> </span>to<span class="_ _13"> </span>store<span class="_ _13"> </span>an<span class="_ _13"> </span>object<span class="_ _13"> </span>of<span class="_ _13"> </span>type<span class="_ _13"> </span><span class="ff11">T<span class="_ _13"> </span></span>.<span class="_ _13"> </span>Using<span class="_ _13"> </span><span class="ffd">sizeof<span class="_ _13"> </span></span>rather<span class="_ _13"> </span>than<span class="_ _13"> </span>a<span class="_ _13"> </span>ﬁxed<span class="_ _13"> </span>value</div><div class="t m5 x17 h26 yac9 ff7 fs19 fc1 sc0 ls0 ws0">is<span class="_"> </span>one<span class="_"> </span>step<span class="_"> </span>toward<span class="_"> </span>writing<span class="_"> </span>code<span class="_"> </span>that<span class="_"> </span>is<span class="_"> </span>portable<span class="_"> </span>across<span class="_"> </span>different<span class="_"> </span>machine<span class="_"> </span>types<span class="_ _1"></span>.</div><div class="t m5 x26 h26 yaca ff7 fs19 fc1 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_"> </span>ran<span class="_ _13"> </span>the<span class="_ _13"> </span>code<span class="_"> </span>shown<span class="_ _13"> </span>in<span class="_ _13"> </span>Figure<span class="_ _13"> </span>2.5<span class="_ _13"> </span>on<span class="_"> </span>several<span class="_ _13"> </span>different<span class="_ _13"> </span>machines<span class="_ _1"></span>,<span class="_"> </span>giving<span class="_ _13"> </span>the</div><div class="t m5 x17 h26 yacb ff7 fs19 fc1 sc0 ls0 ws0">results<span class="_"> </span>shown<span class="_"> </span>in<span class="_"> </span>F<span class="_ _1"></span>igure<span class="_"> </span>2.6.<span class="_"> </span>The<span class="_"> </span>following<span class="_"> </span>machines<span class="_"> </span>were<span class="_"> </span>used:</div><div class="t m5 x17 h31 yacc ff7 fs21 fc1 sc0 ls0 ws0">Linux<span class="_"> </span>32<span class="_ _46"> </span>Intel<span class="_"> </span>IA32<span class="_"> </span>processor<span class="_"> </span>running<span class="_"> </span>Linux.</div><div class="t m5 x17 h31 yacd ff7 fs21 fc1 sc0 ls0 ws0">W<span class="_ _1"></span>indows<span class="_ _26"> </span>Intel<span class="_"> </span>IA32<span class="_"> </span>processor<span class="_"> </span>running<span class="_"> </span>Windows<span class="_ _1"></span>.</div><div class="t m5 x17 h31 yace ff7 fs21 fc1 sc0 ls0 ws0">Sun<span class="_ _71"> </span>Sun<span class="_"> </span>Microsystems<span class="_ _10"> </span>SP<span class="_ _3"></span>ARC<span class="_"> </span>processor<span class="_ _10"> </span>running<span class="_ _10"> </span>Solaris<span class="_ _0"></span>.<span class="_"> </span>(These<span class="_"> </span>machines</div><div class="t m5 xc5 h31 yacf ff7 fs21 fc1 sc0 ls0 ws0">are<span class="_"> </span>now<span class="_"> </span>produced<span class="_"> </span>by<span class="_"> </span>Oracle<span class="_ _1"></span>.)</div><div class="t m5 x17 h31 yad0 ff7 fs21 fc1 sc0 ls0 ws0">Linux<span class="_"> </span>64<span class="_ _46"> </span>Intel<span class="_"> </span>x86-64<span class="_"> </span>processor<span class="_"> </span>running<span class="_"> </span>Linux.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
