<div id="pf102" class="pf w2 h11" data-page-no="102"><div class="pc pc102 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg102.png"/><div class="t m5 x1dc h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>3.6<span class="_ _60"> </span>Control<span class="_ _3e"> </span><span class="ffe fs1e">257</span></div><div class="t m5 x17 h34 ye7 ff6 fs16 fc2 sc0 ls0 ws0">(a)<span class="_ _10"> </span>C<span class="_ _11"> </span>code</div><div class="t m5 x17 h2d y2283 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>fact_do(long<span class="_ _1f"> </span>n)</div><div class="t m5 x17 h2d y2284 ffd fs1e fc2 sc0 ls0 ws0">{</div><div class="t m5 x1b6 h2d y2285 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>result<span class="_ _1f"> </span>=<span class="_ _1f"> </span>1;</div><div class="t m5 x1b6 h2d y2286 ffd fs1e fc2 sc0 ls0 ws0">do<span class="_ _e"> </span>{</div><div class="t m5 x21e h2d y2287 ffd fs1e fc2 sc0 ls0 ws0">result<span class="_ _e"> </span>*=<span class="_ _1f"> </span>n;</div><div class="t m5 x21e h2d y2288 ffd fs1e fc2 sc0 ls0 ws0">n<span class="_ _e"> </span>=<span class="_ _1f"> </span>n-1;</div><div class="t m5 x1b6 h2d y23a1 ffd fs1e fc2 sc0 ls0 ws0">}<span class="_ _e"> </span>while<span class="_ _1f"> </span>(n<span class="_ _1f"> </span>&gt;<span class="_ _e"> </span>1);</div><div class="t m5 x1b6 h2d y23a2 ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>result;</div><div class="t m5 x17 h2d y2554 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x9e h34 y255c ff6 fs16 fc2 sc0 ls0 ws0">(b)<span class="_ _10"> </span>Equivalent<span class="_ _11"> </span>goto<span class="_ _10"> </span>version</div><div class="t m5 x9e h2d y26a4 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>fact_do_goto(long<span class="_ _1f"> </span>n)</div><div class="t m5 x9e h2d y26a5 ffd fs1e fc2 sc0 ls0 ws0">{</div><div class="t m5 x1b1 h2d y26a6 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>result<span class="_ _1f"> </span>=<span class="_ _1f"> </span>1;</div><div class="t m5 x197 h2d y26a7 ffd fs1e fc2 sc0 ls0 ws0">loop:</div><div class="t m5 x1b1 h2d y26a8 ffd fs1e fc2 sc0 ls0 ws0">result<span class="_ _e"> </span>*=<span class="_ _1f"> </span>n;</div><div class="t m5 x1b1 h2d y26a9 ffd fs1e fc2 sc0 ls0 ws0">n<span class="_ _e"> </span>=<span class="_ _1f"> </span>n-1;</div><div class="t m5 x1b1 h2d y26aa ffd fs1e fc2 sc0 ls0 ws0">if<span class="_ _e"> </span>(n<span class="_ _1f"> </span>&gt;<span class="_ _1f"> </span>1)</div><div class="t m5 x7f h2d y26ab ffd fs1e fc2 sc0 ls0 ws0">goto<span class="_ _e"> </span>loop;</div><div class="t m5 x1b1 h2d y26ac ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>result;</div><div class="t m5 x9e h2d y26ad ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x17 h34 y26ae ff6 fs16 fc2 sc0 ls0 ws0">(c)<span class="_ _10"> </span>Corresponding<span class="_ _11"> </span>assembly-language<span class="_ _10"> </span>code</div><div class="t m5 x2e h61 y26af ff13 fs35 fc6 sc0 ls0 ws0">long<span class="_ _f"> </span>fact_do(long<span class="_ _f"> </span>n)</div><div class="t m5 x2e h61 y26b0 ff13 fs35 fc6 sc0 ls0 ws0">n<span class="_ _f"> </span>in<span class="_ _f"> </span>%rdi</div><div class="t m5 x2c h2d y26b1 ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">fact_do:</span></div><div class="t m5 x2c h2d y26b2 ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _45"> </span><span class="ffd fs1e fc2">movl<span class="_ _46"> </span>$1,<span class="_ _e"> </span>%eax<span class="_ _88"> </span></span><span class="ff13 fs35">Set<span class="_ _21"> </span>result<span class="_ _e"> </span>=<span class="_ _21"> </span>1</span></div><div class="t m5 x2c h2d y26b3 ff6 fs20 fc6 sc0 ls0 ws0">3<span class="_ _1c"> </span><span class="ffd fs1e fc2">.L2:<span class="_ _bc"> </span></span><span class="ff2d fs35">loop:</span></div><div class="t m5 x2c h2d y26b4 ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _45"> </span><span class="ffd fs1e fc2">imulq<span class="_ _3f"> </span>%rdi,<span class="_ _e"> </span>%rax<span class="_ _93"> </span></span><span class="ff13 fs35">Compute<span class="_ _e"> </span>result<span class="_ _21"> </span>*=<span class="_ _f"> </span>n</span></div><div class="t m5 x2c h2d y26b5 ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _45"> </span><span class="ffd fs1e fc2">subq<span class="_ _46"> </span>$1,<span class="_ _e"> </span>%rdi<span class="_ _88"> </span></span><span class="ff13 fs35">Decrement<span class="_ _21"> </span>n</span></div><div class="t m5 x2c h2d y26b6 ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _45"> </span><span class="ffd fs1e fc2">cmpq<span class="_ _46"> </span>$1,<span class="_ _e"> </span>%rdi<span class="_ _88"> </span></span><span class="ff13 fs35">Compare<span class="_ _21"> </span>n:1</span></div><div class="t m5 x2c h2e y26b7 ff6 fs20 fc6 sc0 ls0 ws0">7</div><div class="t m5 xd1 h2d y26b8 ffd fs1e fc2 sc0 ls0 ws0">jg<span class="_ _5a"> </span>.L2<span class="_ _12b"> </span><span class="ff13 fs35 fc6">If<span class="_ _f"> </span>&gt;,<span class="_ _e"> </span>goto<span class="_ _21"> </span><span class="ff2d">loop</span></span></div><div class="t m5 x2c h2d y26b9 ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _45"> </span><span class="ffd fs1e fc2">rep;<span class="_ _e"> </span>ret<span class="_ _c1"> </span></span><span class="ff13 fs35">Return</span></div><div class="t m5 x17 h3a y26ba ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _16"> </span>3.19<span class="_ _66"> </span><span class="fc1">Code<span class="_ _14"> </span>for<span class="_ _16"> </span><span class="ffd fs19">do</span>–<span class="ffd fs19">while<span class="_ _16"> </span></span>version<span class="_ _16"> </span>of<span class="_ _16"> </span>factorial<span class="_ _16"> </span>program.<span class="_ _16"> </span><span class="ff6">A<span class="_ _16"> </span>conditional<span class="_ _16"> </span>jump</span></span></div><div class="t m5 x17 h34 y26bb ff6 fs16 fc1 sc0 ls0 ws0">causes<span class="_ _10"> </span>the<span class="_ _11"> </span>program<span class="_ _10"> </span>to<span class="_ _10"> </span>loop.</div><div class="t m5 x26 h26 y26bc ff7 fs19 fc1 sc0 ls0 ws0">As<span class="_"> </span>an<span class="_ _13"> </span>example,<span class="_"> </span>F<span class="_ _1"></span>igure<span class="_"> </span>3.19(a)<span class="_ _13"> </span>shows<span class="_"> </span>an<span class="_"> </span>implementation<span class="_"> </span>of<span class="_ _13"> </span>a<span class="_"> </span>routine<span class="_"> </span>to<span class="_"> </span>com-</div><div class="t m5 x17 h26 y26bd ff7 fs19 fc1 sc0 ls0 ws0">pute<span class="_"> </span>the<span class="_"> </span>factorial<span class="_ _11"> </span>of<span class="_"> </span>its<span class="_"> </span>argument,<span class="_ _11"> </span>written<span class="_"> </span><span class="ff11">n</span>!<span class="_ _3"></span>,<span class="_ _11"> </span>with<span class="_"> </span>a<span class="_ _11"> </span><span class="ffd">do</span>-<span class="ffd">while<span class="_ _10"> </span></span>loop<span class="_ _0"></span>.<span class="_"> </span>T<span class="_ _0"></span>his<span class="_"> </span>function</div><div class="t m5 x17 h26 y26be ff7 fs19 fc1 sc0 ls0 ws0">only<span class="_"> </span>computes<span class="_"> </span>the<span class="_"> </span>proper<span class="_"> </span>value<span class="_"> </span>for<span class="_"> </span><span class="ff11 ls42">n&gt;</span><span class="ls93">0.</span></div><div class="t m5 x17 h47 y26bf ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>3.22<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>369)</span></div><div class="t m5 x34 h26 y26c0 ff7 fs19 fc1 sc0 ls0 ws0">A.<span class="_ _1f"> </span>T<span class="_ _7"></span>ry<span class="_"> </span>to<span class="_ _11"> </span>calculate<span class="_"> </span>14!<span class="_ _13"> </span>with<span class="_"> </span>a<span class="_"> </span>32-bit<span class="_ _11"> </span>int.<span class="_"> </span>V<span class="_ _3"></span>erify<span class="_"> </span>whether<span class="_ _11"> </span>the<span class="_"> </span>computation<span class="_ _11"> </span>of<span class="_"> </span>14!</div><div class="t m5 x2d h26 y26c1 ff7 fs19 fc1 sc0 ls0 ws0">overﬂows<span class="_ _1"></span>.</div><div class="t m5 x34 h26 y26c2 ff7 fs19 fc1 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>What<span class="_"> </span>if<span class="_"> </span>the<span class="_"> </span>computation<span class="_"> </span>is<span class="_"> </span>done<span class="_"> </span>with<span class="_"> </span>a<span class="_"> </span>64-bit<span class="_"> </span>long<span class="_"> </span>int?</div><div class="t m5 x26 h26 ye93 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _16"> </span>goto<span class="_"> </span>code<span class="_ _16"> </span>shown<span class="_ _11"> </span>in<span class="_ _11"> </span>F<span class="_ _0"></span>igure<span class="_ _11"> </span>3.19(b)<span class="_ _11"> </span>shows<span class="_ _16"> </span>how<span class="_"> </span>the<span class="_ _16"> </span>loop<span class="_ _11"> </span>gets<span class="_ _11"> </span>turned<span class="_ _11"> </span>into</div><div class="t m5 x17 h26 y2532 ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_ _14"> </span>lower<span class="_ _1"></span>-level<span class="_ _14"> </span>combination<span class="_ _14"> </span>of<span class="_ _16"> </span>tests<span class="_ _14"> </span>and<span class="_ _14"> </span>conditional<span class="_ _14"> </span>jumps<span class="_ _1"></span>.<span class="_ _14"> </span>F<span class="_ _1"></span>ollowing<span class="_ _14"> </span>the<span class="_ _14"> </span>initial-</div><div class="t m5 x17 h26 y2533 ff7 fs19 fc1 sc0 ls0 ws0">ization<span class="_ _16"> </span>of<span class="_ _16"> </span><span class="ffd">result</span>,<span class="_ _16"> </span>the<span class="_ _16"> </span>program<span class="_ _11"> </span>begins<span class="_ _16"> </span>looping.<span class="_ _16"> </span>F<span class="_ _1"></span>irst<span class="_ _16"> </span>it<span class="_ _16"> </span>executes<span class="_ _16"> </span>the<span class="_ _16"> </span>body<span class="_ _11"> </span>of<span class="_ _16"> </span>the</div><div class="t m5 x17 h26 y2534 ff7 fs19 fc1 sc0 ls0 ws0">loop<span class="_ _1"></span>,<span class="_ _16"> </span>consisting<span class="_"> </span>here<span class="_ _11"> </span>of<span class="_ _11"> </span>updates<span class="_ _16"> </span>to<span class="_"> </span>variables<span class="_ _11"> </span><span class="ffd">result<span class="_ _11"> </span></span>and<span class="_ _16"> </span><span class="ff11">n</span>.<span class="_"> </span>It<span class="_ _11"> </span>then<span class="_ _11"> </span>tests<span class="_ _11"> </span>whether</div><div class="t m5 x17 h26 y2535 ff11 fs19 fc1 sc0 ls83 ws0">n&gt;<span class="ff7 ls0">1<span class="_ _1"></span>,<span class="_ _11"> </span>and,<span class="_ _11"> </span>if<span class="_"> </span>so,<span class="_"> </span>it<span class="_"> </span>jumps<span class="_ _11"> </span>back<span class="_ _11"> </span>to<span class="_ _11"> </span>the<span class="_"> </span>beginning<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>loop<span class="_ _1"></span>.<span class="_ _11"> </span>F<span class="_ _0"></span>igure<span class="_"> </span>3.19(c)<span class="_ _11"> </span>shows</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
