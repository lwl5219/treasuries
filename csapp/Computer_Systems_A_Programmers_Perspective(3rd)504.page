<div id="pf1f8" class="pf w2 h11" data-page-no="1f8"><div class="pc pc1f8 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1f8.png"/><div class="t m5 x13d h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>4.5<span class="_ _60"> </span>Pipelined<span class="_ _10"> </span>Y86-64<span class="_ _10"> </span>Implementations<span class="_ _3e"> </span><span class="ffe fs1e">503</span></div><div class="t m5 x34 h2a y257 fff fs1c fc2 sc0 ls0 ws0">W<span class="_ _1"></span>eb<span class="_ _16"> </span>Aside<span class="_ _14"> </span>ARCH:VLOG<span class="_ _1b"> </span><span class="ff6 fs19">V<span class="_ _3"></span>erilog<span class="_ _16"> </span>implementation<span class="_ _11"> </span>of<span class="_ _11"> </span>a<span class="_ _16"> </span>pipelined<span class="_ _11"> </span>Y86-64<span class="_ _11"> </span>processor</span></div><div class="t m5 x34 h2b y2d0 ff7 fs1e fc2 sc0 ls0 ws0">As<span class="_ _15"> </span>we<span class="_ _15"> </span>have<span class="_ _15"> </span>mentioned,<span class="_ _21"> </span>modern<span class="_ _15"> </span>logic<span class="_ _21"> </span>design<span class="_ _15"> </span>involves<span class="_ _15"> </span>writing<span class="_ _15"> </span>textual<span class="_ _15"> </span>representations<span class="_ _15"> </span>of<span class="_ _15"> </span>hardware</div><div class="t m5 x34 h2b y2d1 ff7 fs1e fc2 sc0 ls0 ws0">designs<span class="_ _16"> </span>in<span class="_ _11"> </span>a<span class="_ _16"> </span><span class="ffa">hardware<span class="_ _11"> </span>description<span class="_ _16"> </span>language</span>.<span class="_ _16"> </span>T<span class="_ _1"></span>he<span class="_ _16"> </span>design<span class="_ _16"> </span>can<span class="_ _16"> </span>then<span class="_ _11"> </span>be<span class="_ _16"> </span>tested<span class="_ _16"> </span>by<span class="_ _16"> </span>both<span class="_ _11"> </span>simulation<span class="_ _16"> </span>and<span class="_ _16"> </span>a</div><div class="t m5 x34 h2b y2d2 ff7 fs1e fc2 sc0 ls0 ws0">variety<span class="_"> </span>of<span class="_ _10"> </span>formal<span class="_ _11"> </span>veriﬁcation<span class="_"> </span>tools<span class="_ _1"></span>.<span class="_ _11"> </span>Once<span class="_"> </span>we<span class="_ _11"> </span>have<span class="_"> </span>conﬁdence<span class="_ _10"> </span>in<span class="_ _11"> </span>the<span class="_"> </span>design,<span class="_ _11"> </span>we<span class="_"> </span>can<span class="_ _10"> </span>use<span class="_ _11"> </span><span class="ffa">logic<span class="_"> </span>synthesis</span></div><div class="t m5 x34 h2b y2d3 ff7 fs1e fc2 sc0 ls0 ws0">tools<span class="_"> </span>to<span class="_"> </span>translate<span class="_"> </span>the<span class="_"> </span>design<span class="_"> </span>into<span class="_"> </span>actual<span class="_"> </span>logic<span class="_"> </span>circuits<span class="_ _1"></span>.</div><div class="t m5 x35 h2b y2d4 ff7 fs1e fc2 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_ _11"> </span>have<span class="_ _10"> </span>developed<span class="_ _11"> </span>models<span class="_ _11"> </span>of<span class="_"> </span>our<span class="_ _11"> </span>Y86-64<span class="_ _11"> </span>processor<span class="_"> </span>designs<span class="_ _11"> </span>in<span class="_ _10"> </span>the<span class="_ _11"> </span>V<span class="_ _3"></span>erilog<span class="_ _11"> </span>hardware<span class="_ _10"> </span>description</div><div class="t m5 x34 h2b y2d5 ff7 fs1e fc2 sc0 ls0 ws0">language<span class="_ _1"></span>.<span class="_ _16"> </span>These<span class="_ _11"> </span>designs<span class="_ _16"> </span>combine<span class="_ _16"> </span>modules<span class="_ _14"> </span>implementing<span class="_ _16"> </span>the<span class="_ _16"> </span>basic<span class="_ _16"> </span>building<span class="_ _16"> </span>blocks<span class="_ _16"> </span>of<span class="_ _16"> </span>the<span class="_ _16"> </span>processor,</div><div class="t m5 x34 h2b y2d6 ff7 fs1e fc2 sc0 ls0 ws0">along<span class="_ _13"> </span>with<span class="_ _6"> </span>control<span class="_ _13"> </span>logic<span class="_ _6"> </span>generated<span class="_ _13"> </span>directly<span class="_ _6"> </span>from<span class="_ _13"> </span>the<span class="_ _13"> </span>HCL<span class="_ _6"> </span>descriptions<span class="_ _1"></span>.<span class="_ _13"> </span>W<span class="_ _3"></span>e<span class="_ _13"> </span>have<span class="_ _6"> </span>been<span class="_ _13"> </span>able<span class="_ _6"> </span>to<span class="_ _13"> </span>synthesize</div><div class="t m5 x34 h2b y549 ff7 fs1e fc2 sc0 ls0 ws0">some<span class="_ _14"> </span>of<span class="_ _15"> </span>these<span class="_ _14"> </span>designs<span class="_ _1"></span>,<span class="_ _21"> </span>download<span class="_ _15"> </span>the<span class="_ _14"> </span>logic<span class="_ _15"> </span>circuit<span class="_ _14"> </span>descriptions<span class="_ _15"> </span>onto<span class="_ _14"> </span>ﬁeld-programmable<span class="_ _15"> </span>gate<span class="_ _14"> </span>array</div><div class="t m5 x34 h2b y54a ff7 fs1e fc2 sc0 ls0 ws0">(FPGA)<span class="_"> </span>hardware<span class="_ _1"></span>,<span class="_"> </span>and<span class="_"> </span>run<span class="_"> </span>the<span class="_"> </span>processors<span class="_"> </span>on<span class="_"> </span>actual<span class="_"> </span>programs<span class="_ _0"></span>.</div><div class="t m5 x25 h46 y4611 ff7 fs19 fc2 sc0 ls0 ws0">CPI<span class="_ _13"> </span><span class="ff12">=<span class="_ _10"> </span></span>1<span class="_ _1"></span><span class="ff11">.<span class="ff7">0<span class="_"> </span><span class="ff12">+<span class="_ _13"></span><span class="ffa">lp<span class="_ _13"> </span></span>+<span class="_ _13"> </span><span class="ffa">mp<span class="_ _13"> </span></span>+<span class="_ _10"> </span><span class="ffa">rp</span></span></span></span></div><div class="t m5 x17 h26 y4612 ff7 fs19 fc2 sc0 ls0 ws0">where<span class="_"> </span><span class="ffa">lp<span class="_ _13"> </span></span>(for<span class="_ _13"> </span>“load<span class="_"> </span>penalty”)<span class="_"> </span>is<span class="_ _13"> </span>the<span class="_"> </span>average<span class="_ _13"> </span>frequency<span class="_"> </span>with<span class="_ _13"> </span>which<span class="_"> </span>bubbles<span class="_"> </span>are<span class="_ _13"> </span>in-</div><div class="t m5 x17 h26 y4613 ff7 fs19 fc2 sc0 ls0 ws0">jected<span class="_ _13"> </span>while<span class="_ _13"> </span>stalling<span class="_ _13"> </span>for<span class="_ _13"> </span>load/use<span class="_"> </span>hazards<span class="_ _3"></span>,<span class="_"> </span><span class="ffa">mp<span class="_ _6"> </span></span>(for<span class="_ _13"> </span>“mispredicted<span class="_ _13"> </span>branch<span class="_ _13"> </span>penalty”)</div><div class="t m5 x17 h26 y4614 ff7 fs19 fc2 sc0 ls0 ws0">is<span class="_"> </span>the<span class="_"> </span>average<span class="_"> </span>frequenc<span class="_ _0"></span>y<span class="_"> </span>with<span class="_"> </span>which<span class="_"> </span>bubbles<span class="_"> </span>are<span class="_"> </span>injected<span class="_"> </span>when<span class="_ _13"> </span>canceling<span class="_"> </span>instruc-</div><div class="t m5 x17 h26 y4615 ff7 fs19 fc2 sc0 ls0 ws0">tions<span class="_ _11"> </span>due<span class="_ _16"> </span>to<span class="_ _11"> </span>mispredicted<span class="_ _11"> </span>branches<span class="_ _0"></span>,<span class="_ _11"> </span>and<span class="_ _16"> </span><span class="ffa">rp<span class="_"> </span></span>(for<span class="_ _16"> </span>“return<span class="_ _11"> </span>penalty”)<span class="_ _11"> </span>is<span class="_ _16"> </span>the<span class="_ _11"> </span>average</div><div class="t m5 x17 h26 y4616 ff7 fs19 fc2 sc0 ls0 ws0">frequency<span class="_ _6"> </span>with<span class="_ _13"> </span>which<span class="_ _13"> </span>bubbles<span class="_ _6"> </span>are<span class="_ _13"> </span>injected<span class="_ _13"> </span>while<span class="_ _13"> </span>stalling<span class="_ _6"> </span>for<span class="_ _13"> </span><span class="ffd">ret<span class="_ _13"> </span></span>instructions<span class="_ _3"></span>.<span class="_ _13"> </span>Each</div><div class="t m5 x17 h26 y4617 ff7 fs19 fc2 sc0 ls0 ws0">of<span class="_ _14"> </span>these<span class="_ _14"> </span>penalties<span class="_ _14"> </span>indicates<span class="_ _14"> </span>the<span class="_ _16"> </span>total<span class="_ _14"> </span>number<span class="_ _14"> </span>of<span class="_ _14"> </span>bubbles<span class="_ _14"> </span>injected<span class="_ _14"> </span>for<span class="_ _14"> </span>the<span class="_ _14"> </span>stated</div><div class="t m5 x17 h26 y4618 ff7 fs19 fc2 sc0 ls0 ws0">reason<span class="_ _13"> </span>(some<span class="_"> </span>portion<span class="_ _13"> </span>of<span class="_ _13"> </span><span class="ff11">C</span></div><div class="t m5 x1c6 h50 y4619 ff11 fs25 fc2 sc0 ls0 ws0">b</div><div class="t m5 x112 h26 y461a ff7 fs19 fc2 sc0 ls0 ws0">)<span class="_ _13"> </span>divided<span class="_"> </span>by<span class="_ _13"> </span>the<span class="_ _13"> </span>total<span class="_"> </span>number<span class="_ _13"> </span>of<span class="_ _13"> </span>instructions<span class="_ _13"> </span>that<span class="_"> </span>were</div><div class="t m5 x17 h26 y461b ff7 fs19 fc2 sc0 ls0 ws0">executed<span class="_"> </span>(<span class="ff11">C</span></div><div class="t m5 x74 h50 y461c ff11 fs25 fc2 sc0 ls0 ws0">i</div><div class="t m5 x156 h26 y461d ff7 fs19 fc2 sc0 ls0 ws0">.)</div><div class="t m5 x26 h26 y461e ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _7"></span>o<span class="_ _21"> </span>estimate<span class="_ _15"> </span>each<span class="_ _15"> </span>of<span class="_ _21"> </span>these<span class="_ _15"> </span>penalties<span class="_ _1"></span>,<span class="_ _f"> </span>we<span class="_ _15"> </span>need<span class="_ _15"> </span>to<span class="_ _15"> </span>know<span class="_ _21"> </span>how<span class="_ _15"> </span>frequently<span class="_ _15"> </span>the</div><div class="t m5 x17 h26 y461f ff7 fs19 fc2 sc0 ls0 ws0">relevant<span class="_ _13"> </span>instructions<span class="_"> </span>(load,<span class="_ _13"> </span>conditional<span class="_ _13"> </span>branch,<span class="_"> </span>and<span class="_ _13"> </span>return)<span class="_ _13"> </span>occur,<span class="_"> </span>and<span class="_ _13"> </span>for<span class="_ _13"> </span>each<span class="_"> </span>of</div><div class="t m5 x17 h26 y4620 ff7 fs19 fc2 sc0 ls0 ws0">these<span class="_"> </span>how<span class="_"> </span>frequently<span class="_ _13"> </span>the<span class="_"> </span>particular<span class="_"> </span>condition<span class="_"> </span>arises<span class="_ _3"></span>.<span class="_"> </span>Let<span class="_"> </span>us<span class="_"> </span>pick<span class="_"> </span>the<span class="_ _13"> </span>following<span class="_"> </span>set</div><div class="t m5 x17 h26 y4621 ff7 fs19 fc2 sc0 ls0 ws0">of<span class="_"> </span>frequencies<span class="_"> </span>for<span class="_"> </span>our<span class="_ _11"> </span>CPI<span class="_"> </span>computation<span class="_"> </span>(these<span class="_"> </span>are<span class="_ _11"> </span>comparable<span class="_"> </span>to<span class="_"> </span>measurements</div><div class="t m5 x17 h26 y4622 ff7 fs19 fc2 sc0 ls0 ws0">reported<span class="_"> </span>in<span class="_"> </span>[44]<span class="_"> </span>and<span class="_"> </span>[46]):</div><div class="t m5 x72 h3d y4623 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y4624 ff7 fs19 fc1 sc0 ls0 ws0">Load<span class="_ _f"> </span>instructions<span class="_ _f"> </span>(<span class="ffd">mrmovq<span class="_ _e"> </span></span>and<span class="_ _21"> </span><span class="ffd">popq</span>)<span class="_ _e"> </span>account<span class="_ _21"> </span>for<span class="_ _f"> </span>25%<span class="_ _e"> </span>of<span class="_ _21"> </span>all<span class="_ _e"> </span>instructions</div><div class="t m5 x26 h26 y4625 ff7 fs19 fc1 sc0 ls0 ws0">executed.<span class="_"> </span>Of<span class="_"> </span>these<span class="_ _1"></span>,<span class="_"> </span>20%<span class="_"> </span>cause<span class="_"> </span>load/use<span class="_"> </span>hazards<span class="_ _1"></span>.</div><div class="t m5 x72 h3d y4626 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y4627 ff7 fs19 fc1 sc0 ls0 ws0">Conditional<span class="_"> </span>branches<span class="_"> </span>account<span class="_"> </span>for<span class="_"> </span>20%<span class="_"> </span>of<span class="_"> </span>all<span class="_"> </span>instructions<span class="_"> </span>executed.<span class="_"> </span>Of<span class="_"> </span>these<span class="_ _1"></span>,</div><div class="t m5 x26 h26 y4628 ff7 fs19 fc1 sc0 ls0 ws0">60%<span class="_"> </span>are<span class="_"> </span>taken<span class="_"> </span>and<span class="_"> </span>40%<span class="_"> </span>are<span class="_"> </span>not<span class="_"> </span>taken.</div><div class="t m5 x72 h3d y4629 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x26 h26 y462a ff7 fs19 fc1 sc0 ls0 ws0">Return<span class="_"> </span>instructions<span class="_"> </span>account<span class="_"> </span>for<span class="_"> </span>2%<span class="_"> </span>of<span class="_"> </span>all<span class="_"> </span>instructions<span class="_"> </span>executed.</div><div class="t m5 x26 h26 y462b ff7 fs19 fc1 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_ _14"> </span>can<span class="_ _15"> </span>therefore<span class="_ _14"> </span>estimate<span class="_ _14"> </span>each<span class="_ _14"> </span>of<span class="_ _15"> </span>our<span class="_ _14"> </span>penalties<span class="_ _14"> </span>as<span class="_ _14"> </span>the<span class="_ _14"> </span>product<span class="_ _15"> </span>of<span class="_ _14"> </span>the<span class="_ _14"> </span>fre-</div><div class="t m5 x17 h26 y462c ff7 fs19 fc1 sc0 ls0 ws0">quency<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>instruction<span class="_ _13"> </span>type<span class="_ _1"></span>,<span class="_ _13"> </span>the<span class="_ _13"> </span>frequency<span class="_ _13"> </span>the<span class="_ _13"> </span>condition<span class="_ _13"> </span>arises<span class="_ _1"></span>,<span class="_ _13"> </span>and<span class="_ _13"> </span>the<span class="_ _13"> </span>number</div><div class="t m5 x17 h26 y462d ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_"> </span>bubbles<span class="_"> </span>that<span class="_"> </span>get<span class="_"> </span>injected<span class="_"> </span>when<span class="_"> </span>the<span class="_"> </span>condition<span class="_"> </span>occurs:</div><div class="t m5 x129 h31 y462e ff7 fs21 fc2 sc0 ls0 ws0">Instruction<span class="_ _26"> </span>Condition</div><div class="t m5 x17 h31 y462f ff7 fs21 fc2 sc0 ls0 ws0">Cause<span class="_ _c0"> </span>Name<span class="_ _61"> </span>frequenc<span class="_ _1"></span>y<span class="_ _61"> </span>frequency<span class="_ _5e"> </span>Bubbles<span class="_ _26"> </span>Product</div><div class="t m5 x17 h31 y4630 ff7 fs21 fc2 sc0 ls0 ws0">Load/use<span class="_ _117"> </span><span class="ffa">lp<span class="_ _30"> </span></span>0<span class="ff11">.</span>25<span class="_ _5d"> </span>0<span class="ff11">.</span>20<span class="_ _11c"> </span>1<span class="_ _71"> </span>0<span class="ff11">.</span>05</div><div class="t m5 x17 h31 y4631 ff7 fs21 fc2 sc0 ls0 ws0">Mispredict<span class="_ _63"> </span><span class="ffa">mp<span class="_ _d0"> </span></span>0<span class="ff11">.</span>20<span class="_ _5d"> </span>0<span class="ff11">.</span>40<span class="_ _11c"> </span>2<span class="_ _71"> </span>0<span class="_ _2"></span><span class="ff11">.</span>16</div><div class="t m5 x17 h31 y4632 ff7 fs21 fc2 sc0 ls0 ws0">Return<span class="_ _86"> </span><span class="ffa">rp<span class="_ _148"> </span></span>0<span class="ff11">.</span>02<span class="_ _1b4"> </span>1<span class="_ _0"></span><span class="ff11">.<span class="ff7">00<span class="_ _82"> </span>3<span class="_ _148"> </span>0<span class="_ _2"></span></span>.<span class="ff7">06</span></span></div><div class="t m5 x17 h31 y4633 ff7 fs21 fc2 sc0 ls0 ws0">T<span class="_ _3"></span>otal<span class="_"> </span>penalty<span class="_ _183"> </span>0<span class="ff11">.</span>27</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
