<div id="pf170" class="pf w2 h11" data-page-no="170"><div class="pc pc170 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg170.png"/><div class="t m5 x107 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Solutions<span class="_ _10"> </span>to<span class="_ _10"> </span>Practice<span class="_ _10"> </span>Problems<span class="_ _1b"> </span><span class="ffe fs1e">367</span></div><div class="t m5 x34 h46 ye7 ff7 fs19 fc2 sc0 ls2a ws0">B.<span class="_ _66"> </span>T<span class="_ _2"></span>h<span class="_ _5"></span>e<span class="_ _21"> </span><span class="ffd ls0">je<span class="_ _14"> </span><span class="ff7">instruction<span class="_ _14"> </span>has<span class="_ _14"> </span>as<span class="_ _14"> </span>its<span class="_ _14"> </span>target<span class="_ _14"> </span></span>0x0x400431<span class="_ _13"> </span><span class="ff12">−<span class="_ _13"> </span><span class="ff7">12<span class="_ _15"> </span>(since<span class="_ _16"> </span></span></span>0xf4<span class="_ _14"> </span><span class="ff7">is<span class="_ _14"> </span>the<span class="_ _14"> </span>1-</span></span></div><div class="t m5 x2d h46 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">byte<span class="_ _6"> </span>two’s-complement<span class="_ _a"> </span>representation<span class="_ _6"> </span>of<span class="_ _6"> </span><span class="ff12">−</span>12).<span class="_ _6"> </span>As<span class="_ _6"> </span>the<span class="_ _6"> </span>original<span class="_ _6"> </span>disassembled</div><div class="t m5 x2d h26 y2a8 ff7 fs19 fc2 sc0 ls0 ws0">code<span class="_"> </span>shows<span class="_ _1"></span>,<span class="_"> </span>this<span class="_"> </span>is<span class="_"> </span><span class="ffd">0x400425</span>:</div><div class="t m5 xd1 h2d y339e ffd fs1e fc2 sc0 ls0 ws0">40042f:<span class="_ _e"> </span>74<span class="_ _1f"> </span>f4<span class="_ _15a"> </span>je<span class="_ _8c"> </span>400425</div><div class="t m5 xd1 h2d y339f ffd fs1e fc2 sc0 ls0 ws0">400431:<span class="_ _e"> </span>5d<span class="_ _15b"> </span>pop<span class="_ _46"> </span>%rbp</div><div class="t m5 x34 h26 y33a0 ff7 fs19 fc2 sc0 ls0 ws0">C.<span class="_ _25"> </span>According<span class="_"> </span>to<span class="_ _13"> </span>the<span class="_"> </span>annotation<span class="_ _13"> </span>produced<span class="_"> </span>by<span class="_"> </span>the<span class="_ _13"> </span>disassembler,<span class="_"> </span>the<span class="_ _13"> </span>jump<span class="_"> </span>target</div><div class="t m5 x2d h26 y33a1 ff7 fs19 fc2 sc0 ls0 ws0">is<span class="_"> </span>at<span class="_ _11"> </span>absolute<span class="_"> </span>address<span class="_ _11"> </span><span class="ffd">0x400547</span>.<span class="_ _11"> </span>According<span class="_"> </span>to<span class="_ _11"> </span>the<span class="_"> </span>byte<span class="_ _11"> </span>encoding,<span class="_"> </span>this<span class="_ _11"> </span>must</div><div class="t m5 x2d h26 y33a2 ff7 fs19 fc2 sc0 ls0 ws0">be<span class="_ _11"> </span>at<span class="_ _16"> </span>an<span class="_ _16"> </span>address<span class="_ _11"> </span><span class="ffd">0x2<span class="_ _16"> </span></span>bytes<span class="_ _16"> </span>beyond<span class="_ _11"> </span>that<span class="_ _16"> </span>of<span class="_ _11"> </span>the<span class="_ _16"> </span><span class="ffd">pop<span class="_ _16"> </span></span>instruction.<span class="_ _11"> </span>Subtracting</div><div class="t m5 x2d h26 y33a3 ff7 fs19 fc2 sc0 ls0 ws0">these<span class="_ _13"> </span>gives<span class="_ _13"> </span>address<span class="_ _13"> </span><span class="ffd">0x400545</span>.<span class="_ _13"> </span>Noting<span class="_ _13"> </span>that<span class="_ _13"> </span>the<span class="_ _13"> </span>encoding<span class="_ _13"> </span>of<span class="_ _6"> </span>the<span class="_"> </span><span class="ffd">ja<span class="_ _6"> </span></span>instruction</div><div class="t m5 x2d h26 y33a4 ff7 fs19 fc2 sc0 ls0 ws0">requires<span class="_ _6"> </span>2<span class="_ _13"> </span>bytes<span class="_ _3"></span>,<span class="_ _13"> </span>it<span class="_ _6"> </span>must<span class="_ _13"> </span>be<span class="_ _a"> </span>located<span class="_ _13"> </span>at<span class="_ _6"> </span>address<span class="_ _6"> </span><span class="ffd">0x400543</span>.<span class="_ _13"> </span>T<span class="_ _1"></span>hese<span class="_ _6"> </span>are<span class="_ _13"> </span>conﬁrmed</div><div class="t m5 x2d h26 y33a5 ff7 fs19 fc2 sc0 ls0 ws0">by<span class="_"> </span>examining<span class="_"> </span>the<span class="_"> </span>original<span class="_"> </span>disassembly:</div><div class="t m5 xd1 h2d y33a6 ffd fs1e fc2 sc0 ls0 ws0">400543:<span class="_ _e"> </span>77<span class="_ _1f"> </span>02<span class="_ _15a"> </span>ja<span class="_ _8c"> </span>400547</div><div class="t m5 xd1 h2d y33a7 ffd fs1e fc2 sc0 ls0 ws0">400545:<span class="_ _e"> </span>5d<span class="_ _15b"> </span>pop<span class="_ _46"> </span>%rbp</div><div class="t m5 x34 h26 y33a8 ff7 fs19 fc2 sc0 ls0 ws0">D<span class="_ _3"></span>.<span class="_ _23"> </span>Reading<span class="_ _f"> </span>the<span class="_ _f"> </span>bytes<span class="_ _f"> </span>in<span class="_ _f"> </span>reverse<span class="_ _f"> </span>order,<span class="_ _e"> </span>we<span class="_ _21"> </span>can<span class="_ _f"> </span>see<span class="_ _f"> </span>that<span class="_ _f"> </span>the<span class="_ _f"> </span>target<span class="_ _f"> </span>offset<span class="_ _f"> </span>is</div><div class="t m5 x2d h46 y33a9 ffd fs19 fc2 sc0 ls0 ws0">0xffffff73<span class="ff7">,<span class="_ _16"> </span>or<span class="_ _16"> </span>decimal<span class="_ _16"> </span><span class="ff12">−</span>141.<span class="_ _16"> </span>Adding<span class="_ _16"> </span>this<span class="_ _11"> </span>to<span class="_ _16"> </span></span>0x0x4005ed<span class="_ _16"> </span><span class="ff7">(the<span class="_ _16"> </span>address<span class="_ _16"> </span>of</span></div><div class="t m5 x2d h26 y33aa ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span><span class="ffd">nop<span class="_ _10"> </span></span>instruction)<span class="_"> </span>gives<span class="_"> </span>address<span class="_"> </span><span class="ffd">0x400560</span>:</div><div class="t m5 xd1 h2d y33ab ffd fs1e fc2 sc0 ls0 ws0">4005e8:<span class="_ _e"> </span>e9<span class="_ _1f"> </span>73<span class="_ _1f"> </span>ff<span class="_ _e"> </span>ff<span class="_ _1f"> </span>ff<span class="_ _71"> </span>jmpq<span class="_ _3f"> </span>400560</div><div class="t m5 xd1 h2d y33ac ffd fs1e fc2 sc0 ls0 ws0">4005ed:<span class="_ _e"> </span>90<span class="_ _15b"> </span>nop</div><div class="t m5 x17 h28 y33ad ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>3.16</div><div class="t m5 x112 h2f y33ae ffe fs16 fc6 sc0 ls0 ws0">(page<span class="_"> </span>248)</div><div class="t m5 x17 h26 y33af ff7 fs19 fc1 sc0 ls0 ws0">Annotating<span class="_ _6"> </span>assembly<span class="_ _6"> </span>code<span class="_ _6"> </span>and<span class="_ _13"> </span>writing<span class="_ _a"> </span>C<span class="_ _13"> </span>code<span class="_ _a"> </span>that<span class="_ _6"> </span>mimics<span class="_ _13"> </span>its<span class="_ _a"> </span>control<span class="_ _13"> </span>ﬂow<span class="_ _a"> </span>are<span class="_ _6"> </span>good</div><div class="t m5 x17 h26 y33b0 ff7 fs19 fc1 sc0 ls0 ws0">ﬁrst<span class="_"> </span>steps<span class="_ _13"> </span>in<span class="_"> </span>understanding<span class="_"> </span>assembly-language<span class="_"> </span>programs<span class="_ _3"></span>.<span class="_"> </span>T<span class="_ _1"></span>his<span class="_"> </span>problem<span class="_"> </span>gives<span class="_"> </span>you</div><div class="t m5 x17 h26 y33b1 ff7 fs19 fc1 sc0 ls0 ws0">practice<span class="_ _14"> </span>for<span class="_ _14"> </span>an<span class="_ _14"> </span>example<span class="_ _14"> </span>with<span class="_ _15"> </span>simple<span class="_ _14"> </span>control<span class="_ _14"> </span>ﬂow<span class="_ _3"></span>.<span class="_ _14"> </span>It<span class="_ _15"> </span>also<span class="_ _14"> </span>gives<span class="_ _14"> </span>you<span class="_ _14"> </span>a<span class="_ _14"> </span>chance<span class="_ _14"> </span>to</div><div class="t m5 x17 h26 y33b2 ff7 fs19 fc1 sc0 ls0 ws0">examine<span class="_"> </span>the<span class="_"> </span>implementation<span class="_"> </span>of<span class="_"> </span>logical<span class="_"> </span>operations<span class="_ _1"></span>.</div><div class="t m5 x34 h26 y33b3 ff7 fs19 fc1 sc0 ls0 ws0">A.<span class="_ _1f"> </span>Here<span class="_"> </span>is<span class="_"> </span>the<span class="_"> </span>C<span class="_"> </span>code:</div><div class="t m5 x2d h2d y33b4 ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>goto_cond(short<span class="_ _1f"> </span>a,<span class="_ _1f"> </span>short<span class="_ _e"> </span>*p)<span class="_ _1f"> </span>{</div><div class="t m5 x142 h2d y33b5 ffd fs1e fc2 sc0 ls0 ws0">if<span class="_ _e"> </span>(a<span class="_ _1f"> </span>==<span class="_ _1f"> </span>0)</div><div class="t m5 xc5 h2d y33b6 ffd fs1e fc2 sc0 ls0 ws0">goto<span class="_ _e"> </span>done;</div><div class="t m5 x142 h2d y33b7 ffd fs1e fc2 sc0 ls0 ws0">if<span class="_ _e"> </span>(a<span class="_ _1f"> </span>&gt;=<span class="_ _1f"> </span>*p)</div><div class="t m5 xc5 h2d y33b8 ffd fs1e fc2 sc0 ls0 ws0">goto<span class="_ _e"> </span>done;</div><div class="t m5 x142 h2d y33b9 ffd fs1e fc2 sc0 ls33 ws0">*<span class="_ _41"></span>p=a<span class="_ _41"></span>;</div><div class="t m5 x239 h2d y33ba ffd fs1e fc2 sc0 ls0 ws0">done:</div><div class="t m5 x142 h2d y33bb ffd fs1e fc2 sc0 ls0 ws0">return;</div><div class="t m5 x2d h2d y33bc ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x34 h26 y33bd ff7 fs19 fc2 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>The<span class="_"> </span>ﬁrst<span class="_"> </span>conditional<span class="_"> </span>branch<span class="_"> </span>is<span class="_"> </span>part<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>implementation<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span><span class="ffd">&amp;&amp;<span class="_ _11"> </span></span>expres-</div><div class="t m5 x2d h26 y33be ff7 fs19 fc2 sc0 ls0 ws0">sion.<span class="_ _6"> </span>If<span class="_ _13"> </span>the<span class="_ _6"> </span>test<span class="_ _13"> </span>for<span class="_ _6"> </span><span class="ffd">a<span class="_ _13"> </span></span>being<span class="_ _6"> </span>non-null<span class="_ _13"> </span>fails<span class="_ _3"></span>,<span class="_ _13"> </span>the<span class="_ _6"> </span>code<span class="_ _13"> </span>will<span class="_ _6"> </span>skip<span class="_ _13"> </span>the<span class="_ _6"> </span>test<span class="_ _13"> </span>of<span class="_ _6"> </span><span class="ffd ls4b">a&gt;<span class="_ _49"></span>=*<span class="_ _49"></span>p<span class="_ _42"></span><span class="ff7 ls0">.</span></span></div><div class="t m5 x17 h28 y1d59 ffe fs1e fc6 sc0 ls0 ws0">Solution<span class="_"> </span>to<span class="_"> </span>Problem<span class="_"> </span>3.17<span class="_ _e"> </span><span class="fs16">(page<span class="_"> </span>248)</span></div><div class="t m5 x17 h26 y587 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _16"> </span>is<span class="_ _11"> </span>an<span class="_ _11"> </span>exercise<span class="_ _16"> </span>to<span class="_ _11"> </span>help<span class="_ _11"> </span>you<span class="_ _16"> </span>think<span class="_ _11"> </span>about<span class="_ _11"> </span>the<span class="_ _16"> </span>idea<span class="_ _11"> </span>of<span class="_ _11"> </span>a<span class="_ _16"> </span>general<span class="_ _11"> </span>translation<span class="_ _11"> </span>rule</div><div class="t m5 x17 h26 y588 ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_"> </span>how<span class="_"> </span>to<span class="_"> </span>apply<span class="_"> </span>it.</div><div class="t m5 x34 h26 y33bf ff7 fs19 fc1 sc0 ls0 ws0">A.<span class="_ _1f"> </span>Converting<span class="_ _13"> </span>to<span class="_"> </span>this<span class="_ _13"> </span>alternate<span class="_ _13"> </span>form<span class="_"> </span>involves<span class="_ _13"> </span>only<span class="_ _13"> </span>switching<span class="_"> </span>around<span class="_ _13"> </span>a<span class="_"> </span>few<span class="_ _13"> </span>lines</div><div class="t m5 x2d h26 y33c0 ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_"> </span>the<span class="_"> </span>code:</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
