<div id="pf15e" class="pf w2 h11" data-page-no="15e"><div class="pc pc15e w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg15e.png"/><div class="t m5 x5f h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Homework<span class="_ _10"> </span>Problems<span class="_ _1b"> </span><span class="ffe fs1e">349</span></div><div class="t m5 x2c h2d ye7 ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">long<span class="_ _1f"> </span>loop(long<span class="_ _e"> </span>x,<span class="_ _1f"> </span>long<span class="_ _1f"> </span>n)</span></div><div class="t m5 x2c h2d yc4d ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x2c h2d yecb ff6 fs20 fc6 sc0 ls0 ws0">3<span class="_ _20"> </span><span class="ffd fs1e fc2">long<span class="_ _e"> </span>result<span class="_ _1f"> </span>=<span class="_ _86"> </span>;</span></div><div class="t m5 x2c h2d yecc ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _20"> </span><span class="ffd fs1e fc2">long<span class="_ _e"> </span>mask;</span></div><div class="t m5 x2c h2d yecd ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _20"> </span><span class="ffd fs1e fc2">for<span class="_ _e"> </span>(mask<span class="_ _1f"> </span>=<span class="_ _86"> </span>;<span class="_ _1f"> </span>mask<span class="_ _169"> </span>;<span class="_ _1f"> </span>mask<span class="_ _1f"> </span>=<span class="_ _6b"> </span><span class="ls33">){</span></span></div><div class="t m5 x2c h2d yece ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _70"> </span><span class="ffd fs1e fc2">result<span class="_ _e"> </span>|=<span class="_ _6b"> </span>;</span></div><div class="t m5 x2c h2d yecf ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _20"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x2c h2d yed0 ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _20"> </span><span class="ffd fs1e fc2">return<span class="_ _e"> </span>result;</span></div><div class="t m5 x2c h2e y20fe ff6 fs20 fc6 sc0 ls0 ws0">9</div><div class="t m5 x2d h2d y1a10 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x26 h26 y3195 ff7 fs19 fc2 sc0 ls0 ws0">Y<span class="_ _3"></span>our<span class="_ _6"> </span>task<span class="_ _6"> </span>is<span class="_ _6"> </span>to<span class="_ _13"> </span>ﬁll<span class="_ _a"> </span>in<span class="_ _6"> </span>the<span class="_ _13"> </span>missing<span class="_ _a"> </span>parts<span class="_ _13"> </span>of<span class="_ _a"> </span>the<span class="_ _6"> </span>C<span class="_ _13"> </span>code<span class="_ _a"> </span>to<span class="_ _6"> </span>get<span class="_ _13"> </span>a<span class="_ _a"> </span>program<span class="_ _13"> </span>equivalent</div><div class="t m5 x17 h26 y3196 ff7 fs19 fc2 sc0 ls0 ws0">to<span class="_"> </span>the<span class="_"> </span>generated<span class="_"> </span>assembly<span class="_"> </span>code.<span class="_"> </span>Recall<span class="_"> </span>that<span class="_"> </span>the<span class="_"> </span>result<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>function<span class="_"> </span>is<span class="_"> </span>returned</div><div class="t m5 x17 h26 y3197 ff7 fs19 fc2 sc0 ls0 ws0">in<span class="_ _14"> </span>register<span class="_ _15"> </span><span class="ffd">%rax</span>.<span class="_ _14"> </span>Y<span class="_ _3"></span>ou<span class="_ _14"> </span>will<span class="_ _15"> </span>ﬁnd<span class="_ _14"> </span>it<span class="_ _15"> </span>helpful<span class="_ _14"> </span>to<span class="_ _14"> </span>examine<span class="_ _15"> </span>the<span class="_ _14"> </span>assembly<span class="_ _15"> </span>code<span class="_ _14"> </span>before,</div><div class="t m5 x17 h26 y3198 ff7 fs19 fc2 sc0 ls0 ws0">during,<span class="_ _13"> </span>and<span class="_ _13"> </span>after<span class="_"> </span>the<span class="_ _13"> </span>loop<span class="_ _13"> </span>to<span class="_ _13"> </span>form<span class="_"> </span>a<span class="_ _13"> </span>consistent<span class="_ _13"> </span>mapping<span class="_ _13"> </span>between<span class="_"> </span>the<span class="_ _13"> </span>registers<span class="_ _13"> </span>and</div><div class="t m5 x17 h26 y3199 ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span>program<span class="_"> </span>variables<span class="_ _1"></span>.</div><div class="t m5 x34 h26 y319a ff7 fs19 fc2 sc0 ls0 ws0">A.<span class="_ _1f"> </span>Which<span class="_"> </span>registers<span class="_"> </span>hold<span class="_"> </span>program<span class="_"> </span>values<span class="_"> </span><span class="ffd">x</span>,<span class="_"> </span><span class="ffd">n</span>,<span class="_"> </span><span class="ffd">result</span>,<span class="_"> </span>and<span class="_"> </span><span class="ffd">mask</span>?</div><div class="t m5 x34 h26 y319b ff7 fs19 fc2 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>What<span class="_"> </span>are<span class="_"> </span>the<span class="_"> </span>initial<span class="_"> </span>values<span class="_"> </span>of<span class="_"> </span><span class="ffd">result<span class="_ _10"> </span></span>and<span class="_"> </span><span class="ffd">mask</span>?</div><div class="t m5 x34 h26 y319c ff7 fs19 fc2 sc0 ls0 ws0">C.<span class="_ _25"> </span>What<span class="_"> </span>is<span class="_"> </span>the<span class="_"> </span>test<span class="_"> </span>condition<span class="_"> </span>for<span class="_"> </span><span class="ffd">mask</span>?</div><div class="t m5 x34 h26 y319d ff7 fs19 fc2 sc0 ls0 ws0">D<span class="_ _3"></span>.<span class="_ _23"> </span>How<span class="_"> </span>does<span class="_"> </span><span class="ffd">mask<span class="_ _10"> </span></span>get<span class="_"> </span>updated?</div><div class="t m5 x34 h26 y319e ff7 fs19 fc2 sc0 ls0 ws0">E.<span class="_ _25"> </span>How<span class="_"> </span>does<span class="_"> </span><span class="ffd">result<span class="_ _10"> </span></span>get<span class="_"> </span>updated?</div><div class="t m5 x34 h26 y319f ff7 fs19 fc2 sc0 ls0 ws0">F<span class="_ _7"></span>.<span class="_ _3d"> </span>F<span class="_ _1"></span>ill<span class="_"> </span>in<span class="_"> </span>all<span class="_"> </span>the<span class="_"> </span>missing<span class="_"> </span>parts<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>C<span class="_"> </span>code<span class="_ _0"></span>.</div><div class="t m5 x17 h73 y31a0 ffe fs1e fc6 sc0 ls0 ws0">3.61<span class="_ _23"> </span><span class="ff10 fs19">◆◆</span></div><div class="t m5 x17 h26 y31a1 ff7 fs19 fc1 sc0 ls0 ws0">In<span class="_ _14"> </span>Section<span class="_ _14"> </span>3.6.6,<span class="_ _14"> </span>we<span class="_ _14"> </span>examined<span class="_ _14"> </span>the<span class="_ _14"> </span>following<span class="_ _14"> </span>code<span class="_ _14"> </span>as<span class="_ _14"> </span>a<span class="_ _14"> </span>candidate<span class="_ _14"> </span>for<span class="_ _14"> </span>the<span class="_ _14"> </span>use<span class="_ _14"> </span>of</div><div class="t m5 x17 h26 y31a2 ff7 fs19 fc1 sc0 ls0 ws0">conditional<span class="_"> </span>data<span class="_"> </span>transfer:</div><div class="t m5 x17 h2d y31a3 ffd fs1e fc2 sc0 ls0 ws0">long<span class="_ _e"> </span>cread(long<span class="_ _1f"> </span>*xp)<span class="_ _1f"> </span>{</div><div class="t m5 x1b6 h2d y31a4 ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>(xp<span class="_ _1f"> </span>?<span class="_ _1f"> </span>*xp<span class="_ _e"> </span>:<span class="_ _1f"> </span>0);</div><div class="t m5 x17 h2d y31a5 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x17 h26 y31a6 ff7 fs19 fc2 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_ _6"> </span>showed<span class="_ _13"> </span>a<span class="_ _a"> </span>trial<span class="_ _6"> </span>implementation<span class="_ _13"> </span>using<span class="_ _a"> </span>a<span class="_ _13"> </span>conditional<span class="_ _a"> </span>move<span class="_ _6"> </span>instruction<span class="_ _13"> </span>but<span class="_ _a"> </span>argued</div><div class="t m5 x17 h26 y31a7 ff7 fs19 fc2 sc0 ls0 ws0">that<span class="_"> </span>it<span class="_"> </span>was<span class="_"> </span>not<span class="_"> </span>valid,<span class="_"> </span>since<span class="_"> </span>it<span class="_"> </span>could<span class="_"> </span>attempt<span class="_"> </span>to<span class="_"> </span>read<span class="_"> </span>from<span class="_"> </span>a<span class="_"> </span>null<span class="_"> </span>address<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y31a8 ff7 fs19 fc2 sc0 ls0 ws0">Write<span class="_ _16"> </span>a<span class="_ _16"> </span>C<span class="_ _11"> </span>function<span class="_ _16"> </span><span class="ffd">cread_alt<span class="_ _16"> </span></span>that<span class="_ _16"> </span>has<span class="_ _16"> </span>the<span class="_ _16"> </span>same<span class="_ _16"> </span>behavior<span class="_ _16"> </span>as<span class="_ _11"> </span><span class="ffd">cread</span>,<span class="_ _14"> </span>except</div><div class="t m5 x17 h26 y31a9 ff7 fs19 fc2 sc0 ls0 ws0">that<span class="_ _21"> </span>it<span class="_ _21"> </span>can<span class="_ _21"> </span>be<span class="_ _f"> </span>compiled<span class="_ _21"> </span>to<span class="_ _21"> </span>use<span class="_ _f"> </span>conditional<span class="_ _21"> </span>data<span class="_ _21"> </span>transfer.<span class="_ _21"> </span>When<span class="_ _21"> </span>compiled,<span class="_ _e"> </span>the</div><div class="t m5 x17 h26 y31aa ff7 fs19 fc2 sc0 ls0 ws0">generated<span class="_"> </span>code<span class="_"> </span>should<span class="_ _11"> </span>use<span class="_"> </span>a<span class="_"> </span>conditional<span class="_ _11"> </span>move<span class="_"> </span>instruction<span class="_ _11"> </span>rather<span class="_"> </span>than<span class="_"> </span>one<span class="_ _11"> </span>of<span class="_"> </span>the</div><div class="t m5 x17 h26 y31ab ff7 fs19 fc2 sc0 ls0 ws0">jump<span class="_"> </span>instructions<span class="_ _1"></span>.</div><div class="t m5 x17 h73 y5b5 ffe fs1e fc6 sc0 ls0 ws0">3.62<span class="_ _23"> </span><span class="ff10 fs19">◆◆</span></div><div class="t m5 x17 h26 y5b6 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _15"> </span>code<span class="_ _15"> </span>that<span class="_ _14"> </span>follows<span class="_ _15"> </span>shows<span class="_ _15"> </span>an<span class="_ _15"> </span>example<span class="_ _14"> </span>of<span class="_ _15"> </span>branching<span class="_ _15"> </span>on<span class="_ _14"> </span>an<span class="_ _15"> </span>enumerated<span class="_ _15"> </span>type</div><div class="t m5 x17 h26 y5b7 ff7 fs19 fc1 sc0 ls0 ws0">value<span class="_ _11"> </span>in<span class="_ _11"> </span>a<span class="_ _11"> </span>switch<span class="_ _11"> </span>statement.<span class="_ _11"> </span>Recall<span class="_ _11"> </span>that<span class="_ _11"> </span>enumerated<span class="_ _11"> </span>types<span class="_ _11"> </span>in<span class="_ _11"> </span>C<span class="_ _11"> </span>are<span class="_ _11"> </span>simply<span class="_ _11"> </span>a<span class="_ _11"> </span>way</div><div class="t m5 x17 h26 y5b8 ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_ _13"> </span>introduce<span class="_ _6"> </span>a<span class="_ _13"> </span>set<span class="_ _13"> </span>of<span class="_ _6"> </span>names<span class="_ _13"> </span>having<span class="_ _13"> </span>associated<span class="_ _6"> </span>integer<span class="_ _13"> </span>values<span class="_ _1"></span>.<span class="_ _13"> </span>By<span class="_ _6"> </span>default,<span class="_ _13"> </span>the<span class="_ _13"> </span>values</div><div class="t m5 x17 h26 y5b9 ff7 fs19 fc1 sc0 ls0 ws0">assigned<span class="_ _13"> </span>to<span class="_ _13"> </span>the<span class="_ _6"> </span>names<span class="_ _13"> </span>count<span class="_ _13"> </span>from<span class="_ _13"> </span>zero<span class="_ _13"> </span>upward.<span class="_ _13"> </span>In<span class="_ _6"> </span>our<span class="_ _13"> </span>code<span class="_ _0"></span>,<span class="_ _13"> </span>the<span class="_ _13"> </span>actions<span class="_ _13"> </span>associated</div><div class="t m5 x17 h26 y5ba ff7 fs19 fc1 sc0 ls0 ws0">with<span class="_"> </span>the<span class="_"> </span>different<span class="_"> </span>case<span class="_"> </span>labels<span class="_"> </span>have<span class="_"> </span>been<span class="_"> </span>omitted.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
