<div id="pf2cf" class="pf w2 h11" data-page-no="2cf"><div class="pc pc2cf w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg2cf.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">718<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>7<span class="_ _3d"> </span>Linking</span></div><div class="t m5 x29 h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">At<span class="_ _16"> </span>run<span class="_ _14"> </span>time<span class="_ _1"></span>,<span class="_ _15"> </span>function<span class="_ _16"> </span><span class="ffd">f<span class="_ _14"> </span></span>changes<span class="_ _16"> </span>the<span class="_ _14"> </span>value<span class="_ _16"> </span>of<span class="_ _14"> </span><span class="ffd">x<span class="_ _16"> </span></span>from<span class="_ _14"> </span>15213<span class="_ _16"> </span>to<span class="_ _16"> </span>15212,<span class="_ _14"> </span>which</div><div class="t m5 x1d h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">might<span class="_ _13"> </span>come<span class="_"> </span>as<span class="_ _13"> </span>an<span class="_"> </span>unwelcome<span class="_ _13"> </span>surprise<span class="_"> </span>to<span class="_ _13"> </span>the<span class="_"> </span>author<span class="_ _13"> </span>of<span class="_"> </span>function<span class="_ _13"> </span><span class="ffd">main</span>!<span class="_"> </span>Notice<span class="_ _13"> </span>that</div><div class="t m5 x1d h26 y2a8 ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _16"> </span>linker<span class="_ _14"> </span>normally<span class="_ _14"> </span>gives<span class="_ _16"> </span>no<span class="_ _14"> </span>indication<span class="_ _14"> </span>that<span class="_ _16"> </span>it<span class="_ _14"> </span>has<span class="_ _14"> </span>detected<span class="_ _16"> </span>multiple<span class="_ _14"> </span>deﬁnitions</div><div class="t m5 x1d h26 y2f7 ff7 fs19 fc2 sc0 ls0 ws0">of<span class="_"> </span><span class="ffd">x</span>:</div><div class="t m5 x1d h2d y5f5e ffd fs1e fc2 sc0 ls0 ws0">linux&gt;<span class="_ _e"> </span><span class="ff13">gcc<span class="_ _1f"> </span>-o<span class="_ _1f"> </span>foobar3<span class="_ _e"> </span>foo3.c<span class="_ _1f"> </span>bar3.c</span></div><div class="t m5 x1d h2d y5f5f ffd fs1e fc2 sc0 ls0 ws0">linux&gt;<span class="_ _e"> </span><span class="ff13">./foobar3</span></div><div class="t m5 x1d h2d y5f60 ffd fs1e fc2 sc0 ls0 ws0">x<span class="_ _e"> </span>=<span class="_ _1f"> </span>15212</div><div class="t m5 x1d h26 y4493 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>same<span class="_"> </span>thing<span class="_"> </span>can<span class="_"> </span>happen<span class="_"> </span>if<span class="_"> </span>there<span class="_"> </span>are<span class="_"> </span>two<span class="_"> </span>weak<span class="_"> </span>deﬁnitions<span class="_"> </span>of<span class="_"> </span><span class="ffd">x<span class="_ _10"> </span></span>(rule<span class="_"> </span>3):</div><div class="t m5 x1f h2d yed4 ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">/*<span class="_ _1f"> </span>foo4.c<span class="_ _e"> </span>*/</span></div><div class="t m5 x1f h2e y462 ff6 fs20 fc6 sc0 ls0 ws0">2</div><div class="t m5 x4f h2d y1ab0 ffd fs1e fc2 sc0 ls0 ws0">#include<span class="_ _e"> </span>&lt;stdio.h&gt;</div><div class="t m5 x1f h2d y26dd ff6 fs20 fc6 sc0 ls0 ws0">3<span class="_ _1c"> </span><span class="ffd fs1e fc2">void<span class="_ _1f"> </span>f(void);</span></div><div class="t m5 x1f h2e y2651 ff6 fs20 fc6 sc0 ls0 ws0">4</div><div class="t m5 x1f h2e y5f61 ff6 fs20 fc6 sc0 ls0 ws0">5</div><div class="t m5 x4f h2d yeab ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>x;</div><div class="t m5 x1f h2e y19a5 ff6 fs20 fc6 sc0 ls0 ws0">6</div><div class="t m5 x1f h2e y5f62 ff6 fs20 fc6 sc0 ls0 ws0">7</div><div class="t m5 x4f h2d y4b5d ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>main()</div><div class="t m5 x1f h2d y19a9 ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x1f h2d y418 ff6 fs20 fc6 sc0 ls0 ws0">9<span class="_ _20"> </span><span class="ffd fs1e fc2">x<span class="_ _e"> </span>=<span class="_ _1f"> </span>15213;</span></div><div class="t m5 x1b0 h2d y5c7b ff6 fs20 fc6 sc0 ls0 ws0">10<span class="_ _20"> </span><span class="ffd fs1e fc2">f();</span></div><div class="t m5 x1b0 h2d y3ed ff6 fs20 fc6 sc0 ls0 ws0">11<span class="_ _20"> </span><span class="ffd fs1e fc2">printf(&quot;x<span class="_ _e"> </span>=<span class="_ _1f"> </span>%d\n&quot;,<span class="_ _1f"> </span>x);</span></div><div class="t m5 x1b0 h2d y2656 ff6 fs20 fc6 sc0 ls0 ws0">12<span class="_ _20"> </span><span class="ffd fs1e fc2">return<span class="_ _e"> </span>0;</span></div><div class="t m5 x1b0 h2d y19b0 ff6 fs20 fc6 sc0 ls0 ws0">13<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x1f h2d y323c ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">/*<span class="_ _1f"> </span>bar4.c<span class="_ _e"> </span>*/</span></div><div class="t m5 x1f h2d y2968 ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _1c"> </span><span class="ffd fs1e fc2">int<span class="_ _1f"> </span>x;</span></div><div class="t m5 x1f h2e y323e ff6 fs20 fc6 sc0 ls0 ws0">3</div><div class="t m5 x1f h2e y5f63 ff6 fs20 fc6 sc0 ls0 ws0">4</div><div class="t m5 x4f h2d y323f ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>f()</div><div class="t m5 x1f h2d y1849 ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x1f h2d y30bb ff6 fs20 fc6 sc0 ls0 ws0">6<span class="_ _20"> </span><span class="ffd fs1e fc2">x<span class="_ _e"> </span>=<span class="_ _1f"> </span>15212;</span></div><div class="t m5 x1f h2d y3241 ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x29 h26 y322d ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _11"> </span>application<span class="_ _11"> </span>of<span class="_ _11"> </span>rules<span class="_ _11"> </span>2<span class="_ _11"> </span>and<span class="_ _11"> </span>3<span class="_ _11"> </span>can<span class="_ _11"> </span>introduce<span class="_ _11"> </span>some<span class="_ _11"> </span>insidious<span class="_ _11"> </span>run-time<span class="_ _11"> </span>bugs</div><div class="t m5 x1d h26 y5f64 ff7 fs19 fc2 sc0 ls0 ws0">that<span class="_"> </span>are<span class="_"> </span>incomprehensible<span class="_"> </span>to<span class="_"> </span>the<span class="_ _11"> </span>unwary<span class="_"> </span>programmer,<span class="_"> </span>especially<span class="_"> </span>if<span class="_"> </span>the<span class="_"> </span>duplicate</div><div class="t m5 x1d h26 y5f65 ff7 fs19 fc2 sc0 ls0 ws0">symbol<span class="_ _13"> </span>deﬁnitions<span class="_"> </span>have<span class="_ _13"> </span>different<span class="_ _13"> </span>types<span class="_ _1"></span>.<span class="_"> </span>Consider<span class="_ _13"> </span>the<span class="_ _13"> </span>following<span class="_ _13"> </span>example,<span class="_ _13"> </span>in<span class="_ _13"> </span>which</div><div class="t m5 x1d h26 y5f66 ffd fs19 fc2 sc0 ls0 ws0">x<span class="_ _10"> </span><span class="ff7">is<span class="_"> </span>inadvertently<span class="_"> </span>deﬁned<span class="_"> </span>as<span class="_"> </span>an<span class="_"> </span></span>int<span class="_ _10"> </span><span class="ff7">in<span class="_"> </span>one<span class="_"> </span>module<span class="_"> </span>and<span class="_"> </span>a<span class="_"> </span></span>double<span class="_ _10"> </span><span class="ff7">in<span class="_"> </span>another:</span></div><div class="t m5 x1f h2d y2972 ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">/*<span class="_ _1f"> </span>foo5.c<span class="_ _e"> </span>*/</span></div><div class="t m5 x1f h2e y2594 ff6 fs20 fc6 sc0 ls0 ws0">2</div><div class="t m5 x4f h2d y211a ffd fs1e fc2 sc0 ls0 ws0">#include<span class="_ _e"> </span>&lt;stdio.h&gt;</div><div class="t m5 x1f h2d y74e ff6 fs20 fc6 sc0 ls0 ws0">3<span class="_ _1c"> </span><span class="ffd fs1e fc2">void<span class="_ _1f"> </span>f(void);</span></div><div class="t m5 x1f h2e y278 ff6 fs20 fc6 sc0 ls0 ws0">4</div><div class="t m5 x1f h2e y5f67 ff6 fs20 fc6 sc0 ls0 ws0">5</div><div class="t m5 x4f h2d y24e1 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>y<span class="_ _1f"> </span>=<span class="_ _1f"> </span>15212;</div><div class="t m5 x1f h2e y13c0 ff6 fs20 fc6 sc0 ls0 ws0">6</div><div class="t m5 x4f h2d y543 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>x<span class="_ _1f"> </span>=<span class="_ _1f"> </span>15213;</div><div class="t m5 x1f h2e y587 ff6 fs20 fc6 sc0 ls0 ws0">7</div><div class="t m5 x1f h2e y5f68 ff6 fs20 fc6 sc0 ls0 ws0">8</div><div class="t m5 x4f h2d yeef ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>main()</div><div class="t m5 x1f h2d yd7a ff6 fs20 fc6 sc0 ls0 ws0">9<span class="_ _1c"> </span><span class="ffd fs1e fc2">{</span></div><div class="t m5 x1b0 h2d y1db4 ff6 fs20 fc6 sc0 ls0 ws0">10<span class="_ _20"> </span><span class="ffd fs1e fc2">f();</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
