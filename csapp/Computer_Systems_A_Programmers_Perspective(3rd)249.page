<div id="pff9" class="pf w2 h11" data-page-no="f9"><div class="pc pcf9 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bgf9.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">248<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>3<span class="_ _3d"> </span>Machine-Level<span class="_ _10"> </span>Representation<span class="_ _10"> </span>of<span class="_ _10"> </span>Programs</span></div><div class="t m5 x1d h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>hat<span class="_ _15"> </span>is<span class="_ _1"></span>,<span class="_ _21"> </span>the<span class="_ _14"> </span>compiler<span class="_ _15"> </span>generates<span class="_ _15"> </span>separate<span class="_ _14"> </span>blocks<span class="_ _15"> </span>of<span class="_ _15"> </span>code<span class="_ _14"> </span>for<span class="_ _15"> </span><span class="ffa">then-statement<span class="_ _21"> </span></span>and</div><div class="t m5 x1d h26 y2a7 ffa fs19 fc2 sc0 ls0 ws0">else-statement<span class="_ _2"></span><span class="ff7">.<span class="_"> </span>It<span class="_ _13"> </span>inserts<span class="_ _13"> </span>conditional<span class="_"> </span>and<span class="_ _13"> </span>unconditional<span class="_ _13"> </span>branches<span class="_ _13"> </span>to<span class="_"> </span>make<span class="_ _13"> </span>sure<span class="_ _13"> </span>the</span></div><div class="t m5 x1d h26 y2a8 ff7 fs19 fc2 sc0 ls0 ws0">correct<span class="_"> </span>block<span class="_"> </span>is<span class="_"> </span>executed.</div><div class="t m5 x1d h47 y259c ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>3.16<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>367)</span></div><div class="t m5 x1d h26 y259d ff7 fs19 fc1 sc0 ls0 ws0">When<span class="_"> </span>given<span class="_"> </span>the<span class="_"> </span>C<span class="_"> </span>code</div><div class="t m5 x1d h2d y259e ffd fs1e fc2 sc0 ls0 ws0">void<span class="_ _e"> </span>cond(short<span class="_ _1f"> </span>a,<span class="_ _1f"> </span>short<span class="_ _e"> </span>*p)</div><div class="t m5 x1d h2d y259f ffd fs1e fc2 sc0 ls0 ws0">{</div><div class="t m5 x10c h2d y25a0 ffd fs1e fc2 sc0 ls0 ws0">if<span class="_ _e"> </span>(a<span class="_ _1f"> </span>&amp;&amp;<span class="_ _1f"> </span>*p<span class="_ _e"> </span>&lt;<span class="_ _1f"> </span>a)</div><div class="t m5 x22b h2d y25a1 ffd fs1e fc2 sc0 ls33 ws0">*<span class="_ _41"></span>p=a<span class="_ _41"></span>;</div><div class="t m5 x1d h2d y25a2 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x1d h26 y25a3 ff9 fs19 fc2 sc0 ls0 ws0">gcc<span class="_ _10"> </span><span class="ff7">generates<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>assembly<span class="_"> </span>code:</span></div><div class="t m5 x17e h61 y25a4 ff13 fs35 fc6 sc0 ls0 ws0">void<span class="_ _f"> </span>cond(short<span class="_ _f"> </span>a,<span class="_ _f"> </span>short<span class="_ _e"> </span>*p)</div><div class="t m5 x17e h61 y25a5 ff13 fs35 fc6 sc0 ls0 ws0">a<span class="_ _f"> </span>in<span class="_ _f"> </span>%rdi,<span class="_ _f"> </span>p<span class="_ _e"> </span>in<span class="_ _21"> </span>%rsi</div><div class="t m5 x1d h2d y25a6 ffd fs1e fc2 sc0 ls0 ws0">cond:</div><div class="t m5 x75 h2d y25a7 ffd fs1e fc2 sc0 ls0 ws0">testq<span class="_ _3f"> </span>%rdi,<span class="_ _e"> </span>%rdi</div><div class="t m5 x75 h2d y25a8 ffd fs1e fc2 sc0 ls0 ws0">je<span class="_ _5a"> </span>.L1</div><div class="t m5 x75 h2d y25a9 ffd fs1e fc2 sc0 ls0 ws0">cmpq<span class="_ _46"> </span>%rsi,<span class="_ _e"> </span>(%rdi)</div><div class="t m5 x75 h2d y25aa ffd fs1e fc2 sc0 ls0 ws0">jle<span class="_ _8c"> </span>.L1</div><div class="t m5 x75 h2d y25ab ffd fs1e fc2 sc0 ls0 ws0">movq<span class="_ _46"> </span>%rdi,<span class="_ _e"> </span>(%rsi)</div><div class="t m5 x1d h2d y25ac ffd fs1e fc2 sc0 ls0 ws0">.L1:</div><div class="t m5 x75 h2d y25ad ffd fs1e fc2 sc0 ls0 ws0">rep;<span class="_ _e"> </span>ret</div><div class="t m5 x124 h26 y25ae ff7 fs19 fc2 sc0 ls0 ws0">A.<span class="_ _1f"> </span>Write<span class="_"> </span>a<span class="_ _11"> </span>goto<span class="_ _11"> </span>version<span class="_ _11"> </span>in<span class="_ _11"> </span>C<span class="_ _11"> </span>that<span class="_ _11"> </span>performs<span class="_ _11"> </span>the<span class="_ _11"> </span>same<span class="_ _11"> </span>computation<span class="_"> </span>and<span class="_ _11"> </span>mimics</div><div class="t m5 x4f h26 y25af ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _11"> </span>control<span class="_ _11"> </span>ﬂow<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>assembly<span class="_ _11"> </span>code<span class="_ _1"></span>,<span class="_ _16"> </span>in<span class="_"> </span>the<span class="_ _11"> </span>style<span class="_ _11"> </span>shown<span class="_ _11"> </span>in<span class="_ _11"> </span>Figure<span class="_"> </span>3.16(b).</div><div class="t m5 x4f h26 y25b0 ff7 fs19 fc2 sc0 ls0 ws0">Y<span class="_ _3"></span>ou<span class="_ _13"> </span>might<span class="_ _6"> </span>ﬁnd<span class="_ _13"> </span>it<span class="_ _13"> </span>helpful<span class="_ _13"> </span>to<span class="_ _13"> </span>ﬁrst<span class="_ _6"> </span>annotate<span class="_ _13"> </span>the<span class="_ _13"> </span>assembly<span class="_ _13"> </span>code<span class="_ _6"> </span>as<span class="_ _13"> </span>we<span class="_ _13"> </span>have<span class="_ _13"> </span>done</div><div class="t m5 x4f h26 y25b1 ff7 fs19 fc2 sc0 ls0 ws0">in<span class="_"> </span>our<span class="_"> </span>examples<span class="_ _1"></span>.</div><div class="t m5 x124 h26 y25b2 ff7 fs19 fc2 sc0 ls0 ws0">B<span class="_ _3"></span>.<span class="_ _1d"> </span>Explain<span class="_ _21"> </span>why<span class="_ _21"> </span>the<span class="_ _21"> </span>assembly<span class="_ _15"> </span>code<span class="_ _21"> </span>contains<span class="_ _21"> </span>two<span class="_ _21"> </span>conditional<span class="_ _21"> </span>branches<span class="_ _1"></span>,<span class="_ _f"> </span>even</div><div class="t m5 x4f h26 y25b3 ff7 fs19 fc2 sc0 ls0 ws0">though<span class="_"> </span>the<span class="_"> </span>C<span class="_"> </span>code<span class="_"> </span>has<span class="_"> </span>only<span class="_"> </span>one<span class="_"> </span><span class="ffd">if<span class="_ _10"> </span></span>statement.</div><div class="t m5 x1d h47 y25b4 ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>3.17<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>367)</span></div><div class="t m5 x1d h26 y25b5 ff7 fs19 fc1 sc0 ls0 ws0">An<span class="_"> </span>alternate<span class="_"> </span>rule<span class="_"> </span>for<span class="_"> </span>translating<span class="_"> </span><span class="ffd">if<span class="_ _10"> </span></span>statements<span class="_"> </span>into<span class="_"> </span>goto<span class="_"> </span>code<span class="_"> </span>is<span class="_"> </span>as<span class="_"> </span>follows:</div><div class="t m5 x10c h53 y25b6 ffd fs1e fc2 sc0 ls33 ws0">t=<span class="ffa ls0">test-expr<span class="_ _2"></span><span class="ffd">;</span></span></div><div class="t m5 x10c h2d y25b7 ffd fs1e fc2 sc0 ls0 ws0">if<span class="_ _e"> </span>(t)</div><div class="t m5 x22b h2d y25b8 ffd fs1e fc2 sc0 ls0 ws0">goto<span class="_ _e"> </span>true;</div><div class="t m5 x10c h53 y25b9 ffa fs1e fc2 sc0 ls0 ws0">else-statement</div><div class="t m5 x10c h2d y25ba ffd fs1e fc2 sc0 ls0 ws0">goto<span class="_ _e"> </span>done;</div><div class="t m5 x1d h2d y25bb ffd fs1e fc2 sc0 ls0 ws0">true:</div><div class="t m5 x10c h53 y25bc ffa fs1e fc2 sc0 ls0 ws0">then-statement</div><div class="t m5 x1d h2d y25bd ffd fs1e fc2 sc0 ls0 ws0">done:</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
