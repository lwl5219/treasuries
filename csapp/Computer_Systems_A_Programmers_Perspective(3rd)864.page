<div id="pf360" class="pf w2 h11" data-page-no="360"><div class="pc pc360 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg360.png"/><div class="t m5 xed h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>9.7<span class="_ _60"> </span>Case<span class="_ _10"> </span>Study:<span class="_ _10"> </span>The<span class="_ _10"> </span>Intel<span class="_ _10"> </span>Core<span class="_ _10"> </span>i7/Linux<span class="_ _10"> </span>Memory<span class="_ _10"> </span>System<span class="_ _3e"> </span><span class="ffe fs1e">863</span></div><div class="t m5 xae h6a y701a ffb6 fs3b fc1 sc0 ls0 ws0">R/W<span class="_ _ee"></span><span class="ls2a7">U/S<span class="_ _19f"></span><span class="ls0">WT<span class="_ _206"></span>CD<span class="_ _f2"></span>A<span class="_ _191"></span>PS<span class="_ _1fa"></span>G<span class="_ _21c"></span>Page table physical base addr<span class="_ _e"> </span>Unused<span class="_ _21d"></span>Unused<span class="_ _21e"> </span><span class="ffb8">P=1</span></span></span></div><div class="t m5 x127 h6a y701b ffb6 fs3b fc1 sc0 ls0 ws0">Available for OS (page table location on disk)<span class="_ _9e"> </span><span class="ffb8">P=0</span></div><div class="t m5 x45 h8e y701c ffb6 fs54 fc1 sc0 ls0 ws0">0<span class="_ _cc"></span>1<span class="_ _ad"></span>2<span class="_ _cc"></span>3</div><div class="t m5 x22d h6a y701a ffb6 fs3b fc1 sc0 ls0 ws0">XD</div><div class="t m5 x52 h8e y701c ffb6 fs54 fc1 sc0 ls0 ws0">63<span class="_ _21f"> </span>4<span class="_ _cc"></span>5<span class="_ _ad"></span>6<span class="_ _cc"></span>7<span class="_ _ad"></span>8<span class="_ _c5"></span>9<span class="_ _19f"></span><span class="ls2a8">11<span class="_ _1c4"></span><span class="ls0">12<span class="_ _220"></span>51<span class="_ _208"></span>52<span class="_ _ee"></span>62</span></span></div><div class="t m5 x17 h31 y701d ff7 fs21 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>ield<span class="_ _64"> </span>Description</div><div class="t m5 x17 h31 y701e ff7 fs21 fc2 sc0 ls0 ws0">P<span class="_ _18b"> </span>Child<span class="_"> </span>page<span class="_"> </span>table<span class="_"> </span>present<span class="_"> </span>in<span class="_"> </span>physical<span class="_"> </span>memory<span class="_"> </span>(1)<span class="_"> </span>or<span class="_"> </span>not<span class="_"> </span>(0).</div><div class="t m5 x17 h31 y701f ff7 fs21 fc2 sc0 ls0 ws0">R/W<span class="_ _148"> </span>Read-only<span class="_"> </span>or<span class="_"> </span>read-write<span class="_"> </span>access<span class="_"> </span>permission<span class="_"> </span>for<span class="_"> </span>all<span class="_"> </span>reachable<span class="_"> </span>pages<span class="_ _1"></span>.</div><div class="t m5 x17 h31 y7020 ff7 fs21 fc2 sc0 ls0 ws0">U/S<span class="_ _53"> </span>User<span class="_"> </span>or<span class="_"> </span>supervisor<span class="_"> </span>(kernel)<span class="_"> </span>mode<span class="_"> </span>access<span class="_"> </span>permission<span class="_"> </span>for<span class="_"> </span>all<span class="_"> </span>reachable<span class="_"> </span>pages<span class="_ _0"></span>.</div><div class="t m5 x17 h31 y7021 ff7 fs21 fc2 sc0 ls0 ws0">WT<span class="_ _53"> </span>Write-through<span class="_"> </span>or<span class="_"> </span>write-back<span class="_"> </span>cache<span class="_"> </span>policy<span class="_"> </span>for<span class="_"> </span>the<span class="_"> </span>child<span class="_"> </span>page<span class="_"> </span>table<span class="_ _0"></span>.</div><div class="t m5 x17 h31 y7022 ff7 fs21 fc2 sc0 ls0 ws0">CD<span class="_ _1b4"> </span>Caching<span class="_"> </span>disabled<span class="_"> </span>or<span class="_"> </span>enabled<span class="_"> </span>for<span class="_"> </span>the<span class="_"> </span>child<span class="_"> </span>page<span class="_"> </span>table<span class="_ _1"></span>.</div><div class="t m5 x17 h31 y7023 ff7 fs21 fc2 sc0 ls0 ws0">A<span class="_ _84"> </span>Reference<span class="_"> </span>bit<span class="_"> </span>(set<span class="_"> </span>by<span class="_"> </span>MMU<span class="_"> </span>on<span class="_"> </span>reads<span class="_"> </span>and<span class="_"> </span>writes<span class="_ _1"></span>,<span class="_"> </span>cleared<span class="_"> </span>by<span class="_"> </span>software).</div><div class="t m5 x17 h31 y7024 ff7 fs21 fc2 sc0 ls0 ws0">PS<span class="_ _122"> </span>Page<span class="_"> </span>size<span class="_"> </span>either<span class="_"> </span>4<span class="_"> </span>KB<span class="_"> </span>or<span class="_"> </span>4<span class="_"> </span>MB<span class="_"> </span>(deﬁned<span class="_"> </span>for<span class="_"> </span>level<span class="_"> </span>1<span class="_"> </span>PTEs<span class="_"> </span>only).</div><div class="t m5 x17 h31 y7025 ff7 fs21 fc2 sc0 ls0 ws0">Base<span class="_"> </span>addr<span class="_ _26"> </span>40<span class="_"> </span>most<span class="_"> </span>signiﬁcant<span class="_"> </span>bits<span class="_"> </span>of<span class="_"> </span>physical<span class="_"> </span>base<span class="_"> </span>address<span class="_"> </span>of<span class="_"> </span>child<span class="_"> </span>page<span class="_"> </span>table<span class="_ _1"></span>.</div><div class="t m5 x17 h31 y7026 ff7 fs21 fc2 sc0 ls0 ws0">XD<span class="_ _77"> </span>Disable<span class="_"> </span>or<span class="_"> </span>enable<span class="_"> </span>instruction<span class="_"> </span>fetches<span class="_"> </span>from<span class="_"> </span>all<span class="_"> </span>pages<span class="_"> </span>reachable<span class="_"> </span>from<span class="_"> </span>this<span class="_"> </span>PTE.</div><div class="t m5 x17 h34 y7027 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _16"> </span>9.23<span class="_ _66"> </span><span class="fc1">Format<span class="_ _14"> </span>of<span class="_ _16"> </span>level<span class="_ _16"> </span>1,<span class="_ _16"> </span>level<span class="_ _16"> </span>2,<span class="_ _14"> </span>and<span class="_ _16"> </span>level<span class="_ _16"> </span>3<span class="_ _16"> </span>page<span class="_ _16"> </span>table<span class="_ _16"> </span>entries.<span class="_ _16"> </span><span class="ff6">Each<span class="_ _16"> </span>entry</span></span></div><div class="t m5 x17 h34 y7028 ff6 fs16 fc1 sc0 ls0 ws0">reference<span class="ls20b">sa4K<span class="_ _4a"></span>B<span class="ls0">child<span class="_ _10"> </span>page<span class="_ _10"> </span>table.</span></span></div><div class="t m5 x26 h26 y950 ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_ _f"> </span>9.23<span class="_ _f"> </span>shows<span class="_ _f"> </span>the<span class="_ _f"> </span>format<span class="_ _f"> </span>of<span class="_ _f"> </span>an<span class="_ _f"> </span>entry<span class="_ _21"> </span>in<span class="_ _f"> </span>a<span class="_ _f"> </span>level<span class="_ _f"> </span>1,<span class="_ _e"> </span>level<span class="_ _f"> </span>2,<span class="_ _e"> </span>or<span class="_ _21"> </span>level<span class="_ _f"> </span>3</div><div class="t m5 x17 h46 y951 ff7 fs19 fc1 sc0 ls0 ws0">page<span class="_ _16"> </span>table<span class="_ _1"></span>.<span class="_ _16"> </span>When<span class="_ _11"> </span><span class="ff11">P<span class="_ _15"> </span><span class="ff12">=<span class="_ _10"> </span></span></span>1<span class="_"> </span>(which<span class="_ _11"> </span>is<span class="_ _16"> </span>always<span class="_ _16"> </span>the<span class="_ _11"> </span>case<span class="_ _16"> </span>with<span class="_ _16"> </span>Linux),<span class="_ _16"> </span>the<span class="_ _11"> </span>address<span class="_ _16"> </span>ﬁeld</div><div class="t m5 x17 h26 y952 ff7 fs19 fc1 sc0 ls0 ws0">contains<span class="_"> </span>a<span class="_"> </span>40-bit<span class="_"> </span>physical<span class="_"> </span>page<span class="_"> </span>number<span class="_"> </span>(PPN)<span class="_"> </span>that<span class="_"> </span>points<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>beginning<span class="_"> </span>of<span class="_"> </span>the</div><div class="t m5 x17 h26 y953 ff7 fs19 fc1 sc0 ls0 ws0">appropriate<span class="_ _16"> </span>page<span class="_ _11"> </span>table.<span class="_ _11"> </span>Notice<span class="_ _16"> </span>that<span class="_ _16"> </span>this<span class="_ _11"> </span>impose<span class="ls2a9">sa4K<span class="_ _49"></span>B<span class="ls0">alignment<span class="_ _16"> </span>requirement</span></span></div><div class="t m5 x17 h26 y954 ff7 fs19 fc1 sc0 ls0 ws0">on<span class="_"> </span>page<span class="_"> </span>tables<span class="_ _1"></span>.</div><div class="t m5 x26 h46 y955 ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_"> </span>9.24<span class="_"> </span>shows<span class="_"> </span>the<span class="_"> </span>format<span class="_"> </span>of<span class="_"> </span>an<span class="_"> </span>entry<span class="_ _13"> </span>in<span class="_"> </span>a<span class="_"> </span>level<span class="_"> </span>4<span class="_"> </span>page<span class="_"> </span>table<span class="_ _1"></span>.<span class="_"> </span>When<span class="_"> </span><span class="ff11">P<span class="_"> </span><span class="ff12">=<span class="_ _10"> </span></span></span><span class="ls25">1,</span></div><div class="t m5 x17 h26 y956 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _16"> </span>address<span class="_ _14"> </span>ﬁeld<span class="_ _16"> </span>contains<span class="_ _14"> </span>a<span class="_ _16"> </span>40-bit<span class="_ _14"> </span>PPN<span class="_ _16"> </span>that<span class="_ _14"> </span>points<span class="_ _16"> </span>to<span class="_ _14"> </span>the<span class="_ _14"> </span>base<span class="_ _16"> </span>of<span class="_ _14"> </span>some<span class="_ _16"> </span>page<span class="_ _14"> </span>in</div><div class="t m5 x17 h26 y957 ff7 fs19 fc1 sc0 ls0 ws0">physical<span class="_"> </span>memory<span class="_ _3"></span>.<span class="_"> </span>Again,<span class="_"> </span>this<span class="_"> </span>impose<span class="ls2aa">sa4K<span class="_ _49"></span>B<span class="ls0">alignment<span class="_"> </span>requirement<span class="_"> </span>on<span class="_"> </span>physical</span></span></div><div class="t m5 x17 h26 y958 ff7 fs19 fc1 sc0 ls0 ws0">pages<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y959 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _6"> </span>PTE<span class="_ _6"> </span>has<span class="_ _13"> </span>three<span class="_ _a"> </span>permission<span class="_ _6"> </span>bits<span class="_ _6"> </span>that<span class="_ _6"> </span>control<span class="_ _6"> </span>access<span class="_ _13"> </span>to<span class="_ _a"> </span>the<span class="_ _6"> </span>page<span class="_ _0"></span>.<span class="_ _6"> </span>T<span class="_ _1"></span>he<span class="_ _6"> </span><span class="ff11 ls10">R/<span class="_ _2"></span>W<span class="_ _10"> </span></span>bit</div><div class="t m5 x17 h26 y95a ff7 fs19 fc1 sc0 ls0 ws0">determines<span class="_"> </span>whether<span class="_ _11"> </span>the<span class="_ _11"> </span>contents<span class="_ _11"> </span>of<span class="_ _11"> </span>a<span class="_ _11"> </span>page<span class="_ _11"> </span>are<span class="_ _11"> </span>read/write<span class="_"> </span>or<span class="_ _11"> </span>read-only<span class="_ _3"></span>.<span class="_ _11"> </span>T<span class="_ _0"></span>he<span class="_"> </span><span class="ff11 ls12">U/<span class="_ _1"></span>S</span></div><div class="t m5 x17 h26 y95b ff7 fs19 fc1 sc0 ls0 ws0">bit,<span class="_ _16"> </span>which<span class="_ _14"> </span>determines<span class="_ _16"> </span>whether<span class="_ _16"> </span>the<span class="_ _16"> </span>page<span class="_ _16"> </span>can<span class="_ _14"> </span>be<span class="_ _16"> </span>accessed<span class="_ _16"> </span>in<span class="_ _16"> </span>user<span class="_ _16"> </span>mode,<span class="_ _16"> </span>protects</div><div class="t m5 x17 h26 y95c ff7 fs19 fc1 sc0 ls0 ws0">code<span class="_"> </span>and<span class="_"> </span>data<span class="_ _11"> </span>in<span class="_"> </span>the<span class="_ _11"> </span>operating<span class="_"> </span>system<span class="_"> </span>kernel<span class="_ _11"> </span>from<span class="_"> </span>user<span class="_ _11"> </span>programs<span class="_ _1"></span>.<span class="_"> </span>The<span class="_"> </span><span class="ffa">XD<span class="_ _13"> </span></span>(exe-</div><div class="t m5 x17 h26 y95d ff7 fs19 fc1 sc0 ls0 ws0">cute<span class="_ _11"> </span>disable)<span class="_ _16"> </span>bit,<span class="_ _16"> </span>which<span class="_ _11"> </span>was<span class="_ _11"> </span>introduced<span class="_ _16"> </span>in<span class="_ _11"> </span>64-bit<span class="_ _16"> </span>systems<span class="_ _1"></span>,<span class="_ _16"> </span>can<span class="_ _11"> </span>be<span class="_ _16"> </span>used<span class="_ _11"> </span>to<span class="_ _11"> </span>disable</div><div class="t m5 x17 h26 y95e ff7 fs19 fc1 sc0 ls0 ws0">instruction<span class="_"> </span>fetches<span class="_ _11"> </span>from<span class="_ _11"> </span>individual<span class="_ _11"> </span>memory<span class="_ _11"> </span>pages<span class="_ _1"></span>.<span class="_ _11"> </span>This<span class="_"> </span>is<span class="_ _11"> </span>an<span class="_ _11"> </span>important<span class="_ _11"> </span>new<span class="_ _11"> </span>fea-</div><div class="t m5 x17 h26 y95f ff7 fs19 fc1 sc0 ls0 ws0">ture<span class="_"> </span>that<span class="_"> </span>allows<span class="_ _13"> </span>the<span class="_"> </span>operating<span class="_"> </span>system<span class="_"> </span>kernel<span class="_"> </span>to<span class="_ _13"> </span>reduce<span class="_"> </span>the<span class="_"> </span>risk<span class="_"> </span>of<span class="_"> </span>buffer<span class="_ _13"> </span>overﬂow</div><div class="t m5 x17 h26 y960 ff7 fs19 fc1 sc0 ls0 ws0">attacks<span class="_"> </span>by<span class="_"> </span>restricting<span class="_"> </span>execution<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>read-only<span class="_"> </span>code<span class="_"> </span>segment.</div><div class="t m5 x26 h26 y961 ff7 fs19 fc1 sc0 ls0 ws0">As<span class="_ _6"> </span>the<span class="_ _13"> </span>MMU<span class="_ _6"> </span>translates<span class="_ _13"> </span>each<span class="_ _6"> </span>virtual<span class="_ _6"> </span>address<span class="_ _0"></span>,<span class="_ _13"> </span>it<span class="_ _6"> </span>also<span class="_ _6"> </span>updates<span class="_ _13"> </span>two<span class="_ _6"> </span>other<span class="_ _13"> </span>bits<span class="_ _6"> </span>that</div><div class="t m5 x17 h26 y962 ff7 fs19 fc1 sc0 ls0 ws0">can<span class="_ _16"> </span>be<span class="_ _11"> </span>used<span class="_ _16"> </span>by<span class="_ _16"> </span>the<span class="_ _16"> </span>kernel’s<span class="_ _11"> </span>page<span class="_ _16"> </span>fault<span class="_ _16"> </span>handler.<span class="_ _11"> </span>The<span class="_ _11"> </span>MMU<span class="_ _16"> </span>sets<span class="_ _16"> </span>the<span class="_ _16"> </span><span class="ff11">A<span class="_ _11"> </span></span>bit,<span class="_ _14"> </span>which</div><div class="t m5 x17 h26 y963 ff7 fs19 fc1 sc0 ls0 ws0">is<span class="_ _11"> </span>known<span class="_ _11"> </span>as<span class="_ _16"> </span>a<span class="_"> </span><span class="ffa">reference<span class="_ _16"> </span>bit<span class="_ _2"></span></span>,<span class="_ _11"> </span>each<span class="_ _16"> </span>time<span class="_"> </span>a<span class="_ _16"> </span>page<span class="_ _11"> </span>is<span class="_ _11"> </span>accessed.<span class="_ _11"> </span>The<span class="_"> </span>kernel<span class="_ _11"> </span>can<span class="_ _16"> </span>use<span class="_ _11"> </span>the</div><div class="t m5 x17 h26 y964 ff7 fs19 fc1 sc0 ls0 ws0">reference<span class="_"> </span>bit<span class="_ _13"> </span>to<span class="_"> </span>implement<span class="_"> </span>its<span class="_ _13"> </span>page<span class="_"> </span>replacement<span class="_"> </span>algorithm.<span class="_ _13"> </span>The<span class="_ _13"> </span>MMU<span class="_"> </span>sets<span class="_"> </span>the<span class="_ _13"> </span><span class="ff11">D</span></div><div class="t m5 x17 h26 y965 ff7 fs19 fc1 sc0 ls0 ws0">bit,<span class="_"> </span>or<span class="_"> </span><span class="ffa">dirty<span class="_ _13"> </span>bit<span class="_ _5"></span></span>,<span class="_"> </span>each<span class="_"> </span>time<span class="_"> </span>the<span class="_ _13"> </span>page<span class="_"> </span>is<span class="_"> </span>written<span class="_"> </span>to<span class="_ _1"></span>.<span class="_"> </span>A<span class="_"> </span>page<span class="_"> </span>that<span class="_ _13"> </span>has<span class="_"> </span>been<span class="_"> </span>modiﬁed<span class="_"> </span>is</div><div class="t m5 x17 h26 y966 ff7 fs19 fc1 sc0 ls0 ws0">sometimes<span class="_ _13"> </span>called<span class="_"> </span>a<span class="_ _13"> </span><span class="ffa">dirty<span class="_"> </span>page</span>.<span class="_"> </span>T<span class="_ _3"></span>he<span class="_"> </span>dirty<span class="_ _13"> </span>bit<span class="_"> </span>tells<span class="_ _13"> </span>the<span class="_"> </span>kernel<span class="_ _13"> </span>whether<span class="_"> </span>or<span class="_ _13"> </span>not<span class="_"> </span>it<span class="_ _13"> </span>must</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
