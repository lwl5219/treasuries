<div id="pf22c" class="pf w2 h11" data-page-no="22c"><div class="pc pc22c w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg22c.png"/><div class="t m5 x23b h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>5.7<span class="_ _60"> </span>Understanding<span class="_ _10"> </span>Modern<span class="_ _10"> </span>Processors<span class="_ _3e"> </span><span class="ffe fs1e">555</span></div><div class="t m5 xc3 h6f y4bca ff58 fs3e fc1 sc0 ls0 ws0">Instruction control unit</div><div class="t m5 x24e h3f y4bcb ff58 fs27 fc1 sc0 ls0 ws0">Address</div><div class="t m5 x86 h3f y4bcc ff58 fs27 fc1 sc0 ls0 ws0">Instructions</div><div class="t m5 xa6 h3f y4bcd ff58 fs27 fc1 sc0 ls0 ws0">Retirement</div><div class="t m5 x1c h3f y4bce ff58 fs27 fc1 sc0 ls0 ws0">unit</div><div class="t m5 x1d7 h3f y4bcf ff58 fs27 fc1 sc0 ls0 ws0">Fetch</div><div class="t m5 x18d h3f y4bd0 ff58 fs27 fc1 sc0 ls0 ws0">control</div><div class="t m5 x5d h3f y4bd1 ff58 fs27 fc1 sc0 ls0 ws0">Instruction</div><div class="t m5 xe7 h3f y4bd2 ff58 fs27 fc1 sc0 ls0 ws0">decode</div><div class="t m5 xe5 h3f y4bd3 ff58 fs27 fc1 sc0 ls0 ws0">Operations</div><div class="t m5 x1e7 h3f y4bd4 ff58 fs27 fc1 sc0 ls0 ws0">Instruction</div><div class="t m5 x51 h3f y4bd5 ff58 fs27 fc1 sc0 ls0 ws0">cache</div><div class="t m5 x20a h3f y4bd6 ff58 fs27 fc1 sc0 ls0 ws0">Prediction</div><div class="t m5 x20a h3f y4bd7 ff58 fs27 fc1 sc0 ls0 ws0">OK?</div><div class="t m5 x17 h3f y4bd6 ff58 fs27 fc1 sc0 ls0 ws0">Register</div><div class="t m5 x17 h3f y4bd7 ff58 fs27 fc1 sc0 ls0 ws0">updates</div><div class="t m5 xf6 h3f y4bd8 ff58 fs27 fc1 sc0 ls0 ws0">Operation results</div><div class="t m5 x1d1 h44 y4bd9 ff58 fs2a fc1 sc0 ls0 ws0">Addr<span class="_ _1"></span>.<span class="_ _14a"> </span>Addr<span class="_ _0"></span>.</div><div class="t m5 xb8 h44 y4bda ff58 fs2a fc1 sc0 ls0 ws0">Data<span class="_ _5d"> </span>Data</div><div class="t m5 x215 h3f y4bdb ff58 fs27 fc1 sc0 ls0 ws0">Data</div><div class="t m5 x179 h3f y4bdc ff58 fs27 fc1 sc0 ls0 ws0">cache</div><div class="t m5 xe6 h3f y4bdd ff58 fs27 fc1 sc0 ls0 ws0">Execution unit</div><div class="t m5 x19a h3f y4bde ff58 fs27 fc1 sc0 ls0 ws0">Functional</div><div class="t m5 x60 h3f y4bdf ff58 fs27 fc1 sc0 ls0 ws0">units</div><div class="t m5 x3f h3f y4be0 ff58 fs27 fc0 sc0 ls0 ws0">Store<span class="_ _16b"></span>Load</div><div class="t m5 x183 h3f y4be1 ff58 fs27 fc0 sc0 ls0 ws0">Arithmetic</div><div class="t m5 x238 h3f y4be2 ff58 fs27 fc0 sc0 ls0 ws0">operations</div><div class="t m5 x8c h3f y4be1 ff58 fs27 fc0 sc0 ls0 ws0">Arithmetic</div><div class="t m5 x10d h3f y4be2 ff58 fs27 fc0 sc0 ls0 ws0">operations</div><div class="t m5 x160 h3f y4be3 ff58 fs27 fc0 sc0 ls0 ws0">Branch</div><div class="t m5 x22c h3f y4be4 ff58 fs27 fc1 sc0 ls0 ws0">Register</div><div class="t m5 x203 h3f y4be5 ff58 fs27 fc1 sc0 ls0 ws0">file</div><div class="t m5 x17 h34 y4be6 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _14"> </span>5.11<span class="_ _c"> </span><span class="fc1">Block<span class="_ _14"> </span>diagram<span class="_ _14"> </span>of<span class="_ _14"> </span>an<span class="_ _15"> </span>out-of-order<span class="_ _14"> </span>processor<span class="_ _3"></span>.<span class="_ _15"> </span><span class="ff6">The<span class="_ _14"> </span>instruction<span class="_ _14"> </span>control</span></span></div><div class="t m5 x17 h34 y4be7 ff6 fs16 fc1 sc0 ls0 ws0">unit<span class="_ _16"> </span>is<span class="_ _14"> </span>responsible<span class="_ _16"> </span>for<span class="_ _14"> </span>reading<span class="_ _14"> </span>instructions<span class="_ _16"> </span>from<span class="_ _14"> </span>memory<span class="_ _14"> </span>and<span class="_ _16"> </span>generating<span class="_ _14"> </span>a<span class="_ _16"> </span>sequence</div><div class="t m5 x17 h34 y4be8 ff6 fs16 fc1 sc0 ls0 ws0">of<span class="_ _11"> </span>primitive<span class="_ _11"> </span>operations.<span class="_ _11"> </span>The<span class="_ _11"> </span>execution<span class="_ _11"> </span>unit<span class="_ _11"> </span>then<span class="_ _11"> </span>per<span class="_ _2"></span>forms<span class="_ _11"> </span>the<span class="_ _11"> </span>operations<span class="_ _11"> </span>and<span class="_ _11"> </span>indicates</div><div class="t m5 x17 h34 y4be9 ff6 fs16 fc1 sc0 ls0 ws0">whether<span class="_ _10"> </span>the<span class="_ _11"> </span>branches<span class="_ _10"> </span>were<span class="_ _10"> </span>correctly<span class="_ _11"> </span>predicted.</div><div class="t m5 x17 h26 ycc7 ff7 fs19 fc1 sc0 ls0 ws0">instruction<span class="_ _16"> </span>in<span class="_ _14"> </span>the<span class="_ _16"> </span>instruction<span class="_ _14"> </span>sequence<span class="_ _1"></span>.<span class="_ _14"> </span>Modern<span class="_ _16"> </span>processors<span class="_ _14"> </span>employ<span class="_ _16"> </span>a<span class="_ _14"> </span>technique</div><div class="t m5 x17 h26 ycc8 ff7 fs19 fc1 sc0 ls0 ws0">known<span class="_"> </span>as<span class="_ _11"> </span><span class="ffa">branch<span class="_"> </span>prediction</span>,<span class="_"> </span>in<span class="_ _11"> </span>which<span class="_ _11"> </span>they<span class="_"> </span>guess<span class="_ _11"> </span>whether<span class="_"> </span>or<span class="_ _11"> </span>not<span class="_ _11"> </span>a<span class="_"> </span>branch<span class="_ _11"> </span>will<span class="_"> </span>be</div><div class="t m5 x17 h26 ycc9 ff7 fs19 fc1 sc0 ls0 ws0">taken<span class="_ _13"> </span>and<span class="_ _13"> </span>also<span class="_ _13"> </span>predict<span class="_ _13"> </span>the<span class="_ _6"> </span>target<span class="_ _13"> </span>address<span class="_ _13"> </span>for<span class="_ _13"> </span>the<span class="_ _13"> </span>branch.<span class="_ _13"> </span>Using<span class="_ _13"> </span>a<span class="_ _13"> </span>technique<span class="_ _13"> </span>known</div><div class="t m5 x17 h26 ycca ff7 fs19 fc1 sc0 ls0 ws0">as<span class="_ _11"> </span><span class="ffa">speculative<span class="_ _11"> </span>execution</span>,<span class="_"> </span>the<span class="_ _11"> </span>processor<span class="_ _11"> </span>begins<span class="_ _11"> </span>fetching<span class="_ _11"> </span>and<span class="_ _16"> </span>decoding<span class="_"> </span>instructions</div><div class="t m5 x17 h26 yccb ff7 fs19 fc1 sc0 ls0 ws0">at<span class="_ _13"> </span>where<span class="_ _13"> </span>it<span class="_ _13"> </span>predicts<span class="_ _6"> </span>the<span class="_ _13"> </span>branch<span class="_ _13"> </span>will<span class="_ _13"> </span>go<span class="_ _1"></span>,<span class="_ _13"> </span>and<span class="_ _13"> </span>even<span class="_ _13"> </span>begins<span class="_ _13"> </span>executing<span class="_ _13"> </span>these<span class="_ _13"> </span>operations</div><div class="t m5 x17 h26 yccc ff7 fs19 fc1 sc0 ls0 ws0">before<span class="_"> </span>it<span class="_"> </span>has<span class="_"> </span>been<span class="_ _11"> </span>determined<span class="_"> </span>whether<span class="_"> </span>or<span class="_ _11"> </span>not<span class="_"> </span>the<span class="_"> </span>branch<span class="_ _11"> </span>prediction<span class="_"> </span>was<span class="_"> </span>correct.</div><div class="t m5 x17 h26 yccd ff7 fs19 fc1 sc0 ls0 ws0">If<span class="_"> </span>it<span class="_ _11"> </span>later<span class="_"> </span>determines<span class="_ _11"> </span>that<span class="_"> </span>the<span class="_ _11"> </span>branch<span class="_"> </span>was<span class="_"> </span>predicted<span class="_ _11"> </span>incorrectly<span class="_ _3"></span>,<span class="_"> </span>it<span class="_ _11"> </span>resets<span class="_"> </span>the<span class="_ _11"> </span>state</div><div class="t m5 x17 h26 ycce ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_ _11"> </span>that<span class="_ _11"> </span>at<span class="_ _16"> </span>the<span class="_ _11"> </span>branch<span class="_ _11"> </span>point<span class="_ _16"> </span>and<span class="_"> </span>begins<span class="_ _16"> </span>fetching<span class="_ _11"> </span>and<span class="_ _11"> </span>executing<span class="_ _16"> </span>instructions<span class="_ _11"> </span>in<span class="_ _11"> </span>the</div><div class="t m5 x17 h26 yccf ff7 fs19 fc1 sc0 ls0 ws0">other<span class="_ _13"> </span>direction.<span class="_ _6"> </span>The<span class="_ _6"> </span>block<span class="_ _13"> </span>labeled<span class="_ _13"> </span>“F<span class="_ _1"></span>etch<span class="_ _13"> </span>control”<span class="_ _13"> </span>incorporates<span class="_ _6"> </span>branch<span class="_ _13"> </span>prediction</div><div class="t m5 x17 h26 ycd0 ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_"> </span>perform<span class="_"> </span>the<span class="_"> </span>task<span class="_"> </span>of<span class="_"> </span>determining<span class="_"> </span>which<span class="_"> </span>instructions<span class="_"> </span>to<span class="_"> </span>fetch.</div><div class="t m5 x26 h26 ycd1 ff7 fs19 fc1 sc0 lsd ws0">Th<span class="_ _2"></span>e<span class="_ _10"> </span><span class="ffa ls0">instruction<span class="_"> </span>decoding<span class="_"> </span><span class="ff7">logic<span class="_ _13"> </span>takes<span class="_"> </span>the<span class="_ _13"> </span>actual<span class="_"> </span>program<span class="_ _13"> </span>instructions<span class="_"> </span>and<span class="_ _13"> </span>con-</span></span></div><div class="t m5 x17 h26 ycd2 ff7 fs19 fc1 sc0 ls0 ws0">verts<span class="_ _15"> </span>them<span class="_ _15"> </span>into<span class="_ _15"> </span>a<span class="_ _15"> </span>set<span class="_ _15"> </span>of<span class="_ _15"> </span>primitive<span class="_ _15"> </span><span class="ffa">operations<span class="_ _15"> </span></span>(sometimes<span class="_ _15"> </span>referred<span class="_ _15"> </span>to<span class="_ _15"> </span>as<span class="_ _21"> </span><span class="ffa">micro-</span></div><div class="t m5 x17 h26 ycd3 ffa fs19 fc1 sc0 ls0 ws0">operations<span class="ff7">).<span class="_ _11"> </span>Each<span class="_ _11"> </span>of<span class="_ _11"> </span>these<span class="_ _11"> </span>operations<span class="_ _16"> </span>performs<span class="_"> </span>some<span class="_ _16"> </span>simple<span class="_"> </span>computational<span class="_ _16"> </span>task</span></div><div class="t m5 x17 h26 ycd4 ff7 fs19 fc1 sc0 ls0 ws0">such<span class="_"> </span>as<span class="_"> </span>adding<span class="_ _13"> </span>two<span class="_"> </span>numbers<span class="_ _1"></span>,<span class="_"> </span>reading<span class="_"> </span>data<span class="_"> </span>from<span class="_ _13"> </span>memory<span class="_ _3"></span>,<span class="_"> </span>or<span class="_"> </span>writing<span class="_"> </span>data<span class="_ _13"> </span>to<span class="_"> </span>mem-</div><div class="t m5 x17 h26 ycd5 ff7 fs19 fc1 sc0 ls0 ws0">ory<span class="_ _3"></span>.<span class="_ _13"> </span>F<span class="_ _3"></span>or<span class="_ _13"> </span>machines<span class="_ _6"> </span>with<span class="_ _13"> </span>complex<span class="_ _13"> </span>instructions<span class="_ _3"></span>,<span class="_ _13"> </span>such<span class="_ _13"> </span>as<span class="_ _6"> </span>x86<span class="_ _13"> </span>processors<span class="_ _1"></span>,<span class="_ _13"> </span>an<span class="_ _13"> </span>instruction</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
