<div id="pfc9" class="pf w2 h11" data-page-no="c9"><div class="pc pcc9 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bgc9.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">200<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>3<span class="_ _3d"> </span>Machine-Level<span class="_ _10"> </span>Representation<span class="_ _10"> </span>of<span class="_ _10"> </span>Programs</span></div><div class="t m5 x1d h38 y4ac ff7 fs1b fc6 sc0 ls0 ws0">C</div><div class="t m5 x178 h26 ye7 ff7 fs19 fc1 sc0 ls0 ws0">omputers<span class="_ _16"> </span>execute<span class="_ _11"> </span><span class="ffa">machine<span class="_ _16"> </span>code</span>,<span class="_ _16"> </span>sequences<span class="_ _16"> </span>of<span class="_ _16"> </span>bytes<span class="_ _16"> </span>encoding<span class="_ _16"> </span>the<span class="_ _11"> </span>low-level</div><div class="t m5 x178 h26 y2a7 ff7 fs19 fc1 sc0 ls0 ws0">operations<span class="_ _14"> </span>that<span class="_ _14"> </span>manipulate<span class="_ _15"> </span>data,<span class="_ _15"> </span>manage<span class="_ _15"> </span>memory<span class="_ _3"></span>,<span class="_ _15"> </span>read<span class="_ _14"> </span>and<span class="_ _15"> </span>write<span class="_ _14"> </span>data<span class="_ _14"> </span>on</div><div class="t m5 x1d h26 y2a8 ff7 fs19 fc1 sc0 ls0 ws0">storage<span class="_"> </span>devices<span class="_ _3"></span>,<span class="_"> </span>and<span class="_"> </span>communicate<span class="_"> </span>over<span class="_"> </span>networks<span class="_ _1"></span>.<span class="_"> </span>A<span class="_"> </span>compiler<span class="_ _13"> </span>generates<span class="_"> </span>machine</div><div class="t m5 x1d h26 y2f7 ff7 fs19 fc1 sc0 ls0 ws0">code<span class="_"> </span>through<span class="_"> </span>a<span class="_"> </span>series<span class="_"> </span>of<span class="_"> </span>stages<span class="_ _1"></span>,<span class="_"> </span>based<span class="_"> </span>on<span class="_"> </span>the<span class="_"> </span>rules<span class="_"> </span>of<span class="_"> </span>the<span class="_ _11"> </span>programming<span class="_"> </span>language<span class="_ _1"></span>,</div><div class="t m5 x1d h26 y2f8 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _13"> </span>instruction<span class="_"> </span>set<span class="_ _13"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>target<span class="_"> </span>machine<span class="_ _1"></span>,<span class="_"> </span>and<span class="_ _13"> </span>the<span class="_"> </span>conventions<span class="_ _13"> </span>followed<span class="_"> </span>by<span class="_ _13"> </span>the<span class="_"> </span>op-</div><div class="t m5 x1d h26 y2f9 ff7 fs19 fc1 sc0 ls0 ws0">erating<span class="_ _11"> </span>system.<span class="_ _11"> </span>T<span class="_ _1"></span>he<span class="_ _11"> </span><span class="ff9">gcc<span class="_ _11"> </span></span>C<span class="_ _11"> </span>compiler<span class="_ _11"> </span>generates<span class="_ _11"> </span>its<span class="_ _11"> </span>output<span class="_ _11"> </span>in<span class="_ _11"> </span>the<span class="_ _11"> </span>form<span class="_ _11"> </span>of<span class="_ _11"> </span><span class="ffa">assembly</span></div><div class="t m5 x1d h26 y2fa ffa fs19 fc1 sc0 ls0 ws0">code<span class="ff7">,<span class="_ _11"> </span>a<span class="_ _11"> </span>textual<span class="_ _16"> </span>representation<span class="_"> </span>of<span class="_ _11"> </span>the<span class="_ _16"> </span>machine<span class="_"> </span>code<span class="_ _11"> </span>giving<span class="_ _16"> </span>the<span class="_"> </span>individual<span class="_ _16"> </span>instruc-</span></div><div class="t m5 x1d h26 y2fb ff7 fs19 fc1 sc0 ls0 ws0">tions<span class="_ _13"> </span>in<span class="_ _13"> </span>the<span class="_ _13"> </span>program.<span class="_ _13"> </span><span class="ff9">Gcc<span class="_ _13"> </span></span>then<span class="_ _13"> </span>invokes<span class="_ _6"> </span>both<span class="_ _13"> </span>an<span class="_ _13"> </span><span class="ffa">assembler<span class="_"> </span></span>and<span class="_ _13"> </span>a<span class="_ _13"> </span><span class="ffa">linker<span class="_ _13"> </span></span>to<span class="_ _13"> </span>generate</div><div class="t m5 x1d h26 y2fc ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _13"> </span>executable<span class="_ _13"> </span>machine<span class="_ _13"> </span>code<span class="_ _13"> </span>from<span class="_ _13"> </span>the<span class="_ _13"> </span>assembly<span class="_ _13"> </span>code<span class="_ _0"></span>.<span class="_ _13"> </span>In<span class="_ _13"> </span>this<span class="_ _13"> </span>chapter,<span class="_ _13"> </span>we<span class="_ _13"> </span>will<span class="_ _13"> </span>take</div><div class="t m5 x1d h26 y2fd ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_ _16"> </span>close<span class="_ _14"> </span>look<span class="_ _14"> </span>at<span class="_ _14"> </span>machine<span class="_ _14"> </span>code<span class="_ _14"> </span>and<span class="_ _14"> </span>its<span class="_ _16"> </span>human-readable<span class="_ _14"> </span>representation<span class="_ _14"> </span>as<span class="_ _14"> </span>assem-</div><div class="t m5 x1d h26 y2fe ff7 fs19 fc1 sc0 ls0 ws0">bly<span class="_"> </span>code<span class="_ _1"></span>.</div><div class="t m5 x29 h26 y2ff ff7 fs19 fc1 sc0 ls0 ws0">When<span class="_ _14"> </span>programming<span class="_ _14"> </span>in<span class="_ _14"> </span>a<span class="_ _15"> </span>high-level<span class="_ _14"> </span>language<span class="_ _15"> </span>such<span class="_ _14"> </span>as<span class="_ _15"> </span>C,<span class="_ _14"> </span>and<span class="_ _15"> </span>even<span class="_ _14"> </span>more<span class="_ _15"> </span>so</div><div class="t m5 x1d h26 y300 ff7 fs19 fc1 sc0 ls0 ws0">in<span class="_ _11"> </span>J<span class="_ _1"></span>ava,<span class="_ _16"> </span>we<span class="_ _11"> </span>are<span class="_ _16"> </span>shielded<span class="_ _16"> </span>from<span class="_ _11"> </span>the<span class="_ _16"> </span>detailed<span class="_ _11"> </span>machine-level<span class="_ _16"> </span>implementation<span class="_ _11"> </span>of<span class="_ _16"> </span>our</div><div class="t m5 x1d h26 y21a ff7 fs19 fc1 sc0 ls0 ws0">program.<span class="_ _13"> </span>In<span class="_ _13"> </span>contrast,<span class="_ _13"> </span>when<span class="_ _13"> </span>writing<span class="_ _13"> </span>programs<span class="_ _6"> </span>in<span class="_ _13"> </span>assembly<span class="_ _13"> </span>code<span class="_ _13"> </span>(as<span class="_ _13"> </span>was<span class="_ _13"> </span>done<span class="_ _13"> </span>in<span class="_ _6"> </span>the</div><div class="t m5 x1d h26 y450 ff7 fs19 fc1 sc0 ls0 ws0">early<span class="_ _16"> </span>days<span class="_ _14"> </span>of<span class="_ _14"> </span>computing)<span class="_ _16"> </span>a<span class="_ _14"> </span>programmer<span class="_ _14"> </span>must<span class="_ _16"> </span>specify<span class="_ _14"> </span>the<span class="_ _14"> </span>low-level<span class="_ _16"> </span>instructions</div><div class="t m5 x1d h26 y451 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _11"> </span>program<span class="_ _16"> </span>uses<span class="_ _11"> </span>to<span class="_ _16"> </span>carry<span class="_ _11"> </span>out<span class="_ _16"> </span>a<span class="_ _11"> </span>computation.<span class="_ _16"> </span>Most<span class="_ _11"> </span>of<span class="_ _16"> </span>the<span class="_ _11"> </span>time,<span class="_ _11"> </span>it<span class="_ _16"> </span>is<span class="_ _11"> </span>much<span class="_ _16"> </span>more</div><div class="t m5 x1d h26 y452 ff7 fs19 fc1 sc0 ls0 ws0">productive<span class="_ _11"> </span>and<span class="_ _16"> </span>reliable<span class="_ _16"> </span>to<span class="_ _11"> </span>work<span class="_ _16"> </span>at<span class="_ _16"> </span>the<span class="_ _11"> </span>higher<span class="_ _16"> </span>level<span class="_ _11"> </span>of<span class="_ _16"> </span>abstraction<span class="_ _16"> </span>provided<span class="_ _11"> </span>by<span class="_ _16"> </span>a</div><div class="t m5 x1d h26 y453 ff7 fs19 fc1 sc0 ls0 ws0">high-level<span class="_ _13"> </span>language.<span class="_ _13"> </span>T<span class="_ _1"></span>he<span class="_"> </span>type<span class="_ _13"> </span>checking<span class="_ _13"> </span>provided<span class="_"> </span>by<span class="_ _13"> </span>a<span class="_"> </span>compiler<span class="_ _13"> </span>helps<span class="_ _13"> </span>detect<span class="_"> </span>many</div><div class="t m5 x1d h26 y454 ff7 fs19 fc1 sc0 ls0 ws0">program<span class="_ _16"> </span>errors<span class="_ _11"> </span>and<span class="_ _16"> </span>makes<span class="_ _16"> </span>sure<span class="_ _11"> </span>we<span class="_ _16"> </span>reference<span class="_ _16"> </span>and<span class="_ _16"> </span>manipulate<span class="_ _11"> </span>data<span class="_ _16"> </span>in<span class="_ _16"> </span>consistent</div><div class="t m5 x1d h26 y455 ff7 fs19 fc1 sc0 ls0 ws0">ways<span class="_ _1"></span>.<span class="_"> </span>W<span class="_ _1"></span>ith<span class="_"> </span>modern<span class="_ _13"> </span>optimizing<span class="_"> </span>compilers<span class="_ _3"></span>,<span class="_"> </span>the<span class="_ _13"> </span>generated<span class="_"> </span>code<span class="_ _13"> </span>is<span class="_"> </span>usually<span class="_ _13"> </span>at<span class="_"> </span>least<span class="_ _13"> </span>as</div><div class="t m5 x1d h26 y456 ff7 fs19 fc1 sc0 ls0 ws0">efﬁcient<span class="_ _11"> </span>as<span class="_ _16"> </span>what<span class="_ _16"> </span>a<span class="_ _11"> </span>skilled<span class="_ _16"> </span>assembly-language<span class="_ _11"> </span>programmer<span class="_ _16"> </span>would<span class="_ _16"> </span>write<span class="_ _11"> </span>by<span class="_ _16"> </span>hand.</div><div class="t m5 x1d h26 y457 ff7 fs19 fc1 sc0 ls0 ws0">Best<span class="_ _f"> </span>of<span class="_ _f"> </span>all,<span class="_ _e"> </span>a<span class="_ _f"> </span>program<span class="_ _e"> </span>written<span class="_ _21"> </span>in<span class="_ _f"> </span>a<span class="_ _f"> </span>high-level<span class="_ _e"> </span>language<span class="_ _21"> </span>can<span class="_ _f"> </span>be<span class="_ _f"> </span>compiled<span class="_ _f"> </span>and</div><div class="t m5 x1d h26 y458 ff7 fs19 fc1 sc0 ls0 ws0">executed<span class="_ _14"> </span>on<span class="_ _15"> </span>a<span class="_ _15"> </span>number<span class="_ _15"> </span>of<span class="_ _15"> </span>different<span class="_ _15"> </span>machines<span class="_ _1"></span>,<span class="_ _21"> </span>whereas<span class="_ _15"> </span>assembly<span class="_ _15"> </span>code<span class="_ _14"> </span>is<span class="_ _15"> </span>highly</div><div class="t m5 x1d h26 y459 ff7 fs19 fc1 sc0 ls0 ws0">machine<span class="_"> </span>speciﬁc.</div><div class="t m5 x29 h26 y45a ff7 fs19 fc1 sc0 ls0 ws0">So<span class="_"> </span>why<span class="_ _13"> </span>should<span class="_"> </span>we<span class="_ _13"> </span>spend<span class="_"> </span>our<span class="_ _13"> </span>time<span class="_"> </span>learning<span class="_ _13"> </span>machine<span class="_"> </span>code?<span class="_ _13"> </span>Even<span class="_"> </span>though<span class="_ _13"> </span>com-</div><div class="t m5 x1d h26 y45b ff7 fs19 fc1 sc0 ls0 ws0">pilers<span class="_ _16"> </span>do<span class="_ _16"> </span>most<span class="_ _11"> </span>of<span class="_ _16"> </span>the<span class="_ _16"> </span>work<span class="_ _16"> </span>in<span class="_ _16"> </span>generating<span class="_ _16"> </span>assembly<span class="_ _16"> </span>code<span class="_ _1"></span>,<span class="_ _16"> </span>being<span class="_ _16"> </span>able<span class="_ _16"> </span>to<span class="_ _16"> </span>read<span class="_ _16"> </span>and</div><div class="t m5 x1d h26 y45c ff7 fs19 fc1 sc0 ls0 ws0">understand<span class="_ _13"> </span>it<span class="_ _13"> </span>is<span class="_"> </span>an<span class="_ _13"> </span>important<span class="_ _13"> </span>skill<span class="_ _13"> </span>for<span class="_"> </span>serious<span class="_ _13"> </span>programmers<span class="_ _1"></span>.<span class="_ _13"> </span>By<span class="_ _13"> </span>invoking<span class="_"> </span>the<span class="_ _13"> </span>com-</div><div class="t m5 x1d h26 y227 ff7 fs19 fc1 sc0 ls0 ws0">piler<span class="_ _13"> </span>with<span class="_ _13"> </span>appropriate<span class="_"> </span>command-line<span class="_ _13"> </span>parameters<span class="_ _3"></span>,<span class="_"> </span>the<span class="_ _13"> </span>compiler<span class="_ _13"> </span>will<span class="_ _13"> </span>generate<span class="_ _13"> </span>a<span class="_"> </span>ﬁle</div><div class="t m5 x1d h26 y45d ff7 fs19 fc1 sc0 ls0 ws0">showing<span class="_ _16"> </span>its<span class="_ _16"> </span>output<span class="_ _14"> </span>in<span class="_ _16"> </span>assembly-code<span class="_ _14"> </span>form.<span class="_ _16"> </span>By<span class="_ _16"> </span>reading<span class="_ _14"> </span>this<span class="_ _16"> </span>code,<span class="_ _16"> </span>we<span class="_ _16"> </span>can<span class="_ _14"> </span>under<span class="_ _1"></span>-</div><div class="t m5 x1d h26 y45e ff7 fs19 fc1 sc0 ls0 ws0">stand<span class="_ _14"> </span>the<span class="_ _15"> </span>optimization<span class="_ _14"> </span>capabilities<span class="_ _15"> </span>of<span class="_ _15"> </span>the<span class="_ _14"> </span>compiler<span class="_ _15"> </span>and<span class="_ _15"> </span>analyze<span class="_ _14"> </span>the<span class="_ _15"> </span>underlying</div><div class="t m5 x1d h26 y4ad ff7 fs19 fc1 sc0 ls0 ws0">inefﬁciencies<span class="_"> </span>in<span class="_ _13"> </span>the<span class="_"> </span>code<span class="_ _1"></span>.<span class="_"> </span>As<span class="_ _13"> </span>we<span class="_"> </span>will<span class="_ _13"> </span>experience<span class="_"> </span>in<span class="_ _13"> </span>Chapter<span class="_"> </span>5,<span class="_ _13"> </span>programmers<span class="_"> </span>seek-</div><div class="t m5 x1d h26 y45f ff7 fs19 fc1 sc0 ls0 ws0">ing<span class="_ _11"> </span>to<span class="_ _16"> </span>maximize<span class="_ _11"> </span>the<span class="_ _16"> </span>performance<span class="_ _11"> </span>of<span class="_ _16"> </span>a<span class="_ _11"> </span>critical<span class="_ _16"> </span>section<span class="_ _11"> </span>of<span class="_ _16"> </span>code<span class="_ _11"> </span>often<span class="_ _16"> </span>try<span class="_ _11"> </span>different</div><div class="t m5 x1d h26 y460 ff7 fs19 fc1 sc0 ls0 ws0">variations<span class="_ _11"> </span>of<span class="_ _11"> </span>the<span class="_ _11"> </span>source<span class="_ _11"> </span>code<span class="_ _0"></span>,<span class="_ _11"> </span>each<span class="_ _11"> </span>time<span class="_ _11"> </span>compiling<span class="_ _11"> </span>and<span class="_ _11"> </span>examining<span class="_ _16"> </span>the<span class="_"> </span>generated</div><div class="t m5 x1d h26 y461 ff7 fs19 fc1 sc0 ls0 ws0">assembly<span class="_ _13"> </span>code<span class="_ _13"> </span>to<span class="_ _13"> </span>get<span class="_ _6"> </span>a<span class="_ _13"> </span>sense<span class="_ _13"> </span>of<span class="_ _13"> </span>how<span class="_ _13"> </span>efﬁciently<span class="_ _13"> </span>the<span class="_ _6"> </span>program<span class="_ _13"> </span>will<span class="_ _13"> </span>run.<span class="_ _13"> </span>Furthermore<span class="_ _1"></span>,</div><div class="t m5 x1d h26 y322 ff7 fs19 fc1 sc0 ls0 ws0">there<span class="_ _11"> </span>are<span class="_ _16"> </span>times<span class="_ _16"> </span>when<span class="_ _11"> </span>the<span class="_ _16"> </span>layer<span class="_ _11"> </span>of<span class="_ _16"> </span>abstraction<span class="_ _11"> </span>provided<span class="_ _16"> </span>by<span class="_ _11"> </span>a<span class="_ _16"> </span>high-level<span class="_ _16"> </span>language</div><div class="t m5 x1d h26 y323 ff7 fs19 fc1 sc0 ls0 ws0">hides<span class="_ _6"> </span>information<span class="_ _6"> </span>about<span class="_ _6"> </span>the<span class="_ _6"> </span>run-time<span class="_ _6"> </span>behavior<span class="_ _6"> </span>of<span class="_ _6"> </span>a<span class="_ _6"> </span>program<span class="_ _6"> </span>that<span class="_ _6"> </span>we<span class="_ _6"> </span>need<span class="_ _6"> </span>to<span class="_ _6"> </span>under<span class="_ _1"></span>-</div><div class="t m5 x1d h26 y324 ff7 fs19 fc1 sc0 ls0 ws0">stand.<span class="_ _13"> </span>F<span class="_ _1"></span>or<span class="_"> </span>example<span class="_ _3"></span>,<span class="_"> </span>when<span class="_ _13"> </span>writing<span class="_ _13"> </span>concurrent<span class="_"> </span>programs<span class="_ _13"> </span>using<span class="_ _13"> </span>a<span class="_ _13"> </span>thread<span class="_ _13"> </span>package,<span class="_ _13"> </span>as</div><div class="t m5 x1d h26 y325 ff7 fs19 fc1 sc0 ls0 ws0">covered<span class="_ _13"> </span>in<span class="_ _13"> </span>Chapter<span class="_ _13"> </span>12,<span class="_ _13"> </span>it<span class="_ _13"> </span>is<span class="_ _13"> </span>important<span class="_ _13"> </span>to<span class="_ _13"> </span>understand<span class="_ _13"> </span>how<span class="_ _13"> </span>program<span class="_ _13"> </span>data<span class="_ _13"> </span>are<span class="_ _13"> </span>shared</div><div class="t m5 x1d h26 y326 ff7 fs19 fc1 sc0 ls0 ws0">or<span class="_"> </span>kept<span class="_ _13"> </span>private<span class="_"> </span>by<span class="_"> </span>the<span class="_"> </span>different<span class="_ _13"> </span>threads<span class="_"> </span>and<span class="_"> </span>precisely<span class="_ _13"> </span>how<span class="_"> </span>and<span class="_"> </span>where<span class="_"> </span>shared<span class="_ _13"> </span>data</div><div class="t m5 x1d h26 y319 ff7 fs19 fc1 sc0 ls0 ws0">are<span class="_ _16"> </span>accessed.<span class="_ _16"> </span>Such<span class="_ _16"> </span>information<span class="_ _16"> </span>is<span class="_ _16"> </span>visible<span class="_ _16"> </span>at<span class="_ _14"> </span>the<span class="_ _16"> </span>machine-code<span class="_ _16"> </span>level.<span class="_ _16"> </span>As<span class="_ _16"> </span>another</div><div class="t m5 x1d h26 y31a ff7 fs19 fc1 sc0 ls0 ws0">example<span class="_ _1"></span>,<span class="_ _15"> </span>many<span class="_ _16"> </span>of<span class="_ _14"> </span>the<span class="_ _14"> </span>ways<span class="_ _16"> </span>programs<span class="_ _14"> </span>can<span class="_ _14"> </span>be<span class="_ _16"> </span>attacked,<span class="_ _15"> </span>allowing<span class="_ _16"> </span>malware<span class="_ _14"> </span>to<span class="_ _16"> </span>in-</div><div class="t m5 x1d h26 y31b ff7 fs19 fc1 sc0 ls0 ws0">fest<span class="_ _16"> </span>a<span class="_ _11"> </span>system,<span class="_ _16"> </span>involve<span class="_ _16"> </span>nuances<span class="_ _16"> </span>of<span class="_ _11"> </span>the<span class="_ _16"> </span>way<span class="_ _16"> </span>programs<span class="_ _16"> </span>store<span class="_ _11"> </span>their<span class="_ _16"> </span>run-time<span class="_ _16"> </span>control</div><div class="t m5 x1d h26 y31c ff7 fs19 fc1 sc0 ls0 ws0">information.<span class="_ _11"> </span>Many<span class="_ _11"> </span>attacks<span class="_ _11"> </span>involve<span class="_ _16"> </span>exploiting<span class="_"> </span>weaknesses<span class="_ _16"> </span>in<span class="_"> </span>system<span class="_ _16"> </span>programs<span class="_"> </span>to</div><div class="t m5 x1d h26 y31d ff7 fs19 fc1 sc0 ls0 ws0">overwrite<span class="_ _6"> </span>information<span class="_ _13"> </span>and<span class="_ _6"> </span>thereby<span class="_ _13"> </span>take<span class="_ _6"> </span>control<span class="_ _6"> </span>of<span class="_ _13"> </span>the<span class="_ _6"> </span>system.<span class="_ _13"> </span>Understanding<span class="_ _6"> </span>how</div><div class="t m5 x1d h26 y31e ff7 fs19 fc1 sc0 ls0 ws0">these<span class="_ _13"> </span>vulnerabilities<span class="_ _13"> </span>arise<span class="_"> </span>and<span class="_ _13"> </span>how<span class="_ _13"> </span>to<span class="_ _13"> </span>guard<span class="_ _13"> </span>against<span class="_ _13"> </span>them<span class="_"> </span>requires<span class="_ _13"> </span>a<span class="_ _13"> </span>knowledge<span class="_ _13"> </span>of</div><div class="t m5 x1d h26 y31f ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _13"> </span>machine-level<span class="_ _6"> </span>representation<span class="_ _13"> </span>of<span class="_ _6"> </span>programs<span class="_ _1"></span>.<span class="_ _13"> </span>T<span class="_ _1"></span>he<span class="_ _13"> </span>need<span class="_ _13"> </span>for<span class="_ _6"> </span>programmers<span class="_ _13"> </span>to<span class="_ _6"> </span>learn</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
