<div id="pf301" class="pf w2 h11" data-page-no="301"><div class="pc pc301 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg301.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">768<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>8<span class="_ _3d"> </span>Exceptional<span class="_ _10"> </span>Control<span class="_ _10"> </span>Flow</span></div><div class="t m5 x1d h3b ye7 fff fs24 fc6 sc0 ls0 ws0">8.2<span class="_ _17"> </span><span class="ffe fs18">Processes</span></div><div class="t m5 x1d h26 y327 ff7 fs19 fc1 sc0 ls0 ws0">Exceptions<span class="_ _16"> </span>are<span class="_ _11"> </span>the<span class="_ _16"> </span>basic<span class="_ _16"> </span>building<span class="_ _11"> </span>blocks<span class="_ _16"> </span>that<span class="_ _16"> </span>allow<span class="_ _16"> </span>the<span class="_ _11"> </span>operating<span class="_ _16"> </span>system<span class="_ _16"> </span>kernel</div><div class="t m5 x1d h26 y328 ff7 fs19 fc1 sc0 ls0 ws0">to<span class="_"> </span>provide<span class="_"> </span>the<span class="_ _13"> </span>notion<span class="_"> </span>of<span class="_"> </span>a<span class="_"> </span><span class="ffa">process</span>,<span class="_"> </span>one<span class="_"> </span>of<span class="_ _13"> </span>the<span class="_"> </span>most<span class="_"> </span>profound<span class="_"> </span>and<span class="_"> </span>successful<span class="_"> </span>ideas</div><div class="t m5 x1d h26 y329 ff7 fs19 fc1 sc0 ls0 ws0">in<span class="_"> </span>computer<span class="_"> </span>science<span class="_ _1"></span>.</div><div class="t m5 x29 h26 y32a ff7 fs19 fc1 sc0 ls0 ws0">When<span class="_ _15"> </span>we<span class="_ _15"> </span>run<span class="_ _21"> </span>a<span class="_ _15"> </span>program<span class="_ _21"> </span>on<span class="_ _15"> </span>a<span class="_ _21"> </span>modern<span class="_ _15"> </span>system,<span class="_ _f"> </span>we<span class="_ _21"> </span>are<span class="_ _21"> </span>presented<span class="_ _15"> </span>with<span class="_ _21"> </span>the</div><div class="t m5 x1d h26 y32b ff7 fs19 fc1 sc0 ls0 ws0">illusion<span class="_ _14"> </span>that<span class="_ _14"> </span>our<span class="_ _14"> </span>program<span class="_ _15"> </span>is<span class="_ _14"> </span>the<span class="_ _14"> </span>only<span class="_ _15"> </span>one<span class="_ _14"> </span>currently<span class="_ _14"> </span>running<span class="_ _14"> </span>in<span class="_ _15"> </span>the<span class="_ _14"> </span>system.<span class="_ _14"> </span>Our</div><div class="t m5 x1d h26 y32c ff7 fs19 fc1 sc0 ls0 ws0">program<span class="_ _14"> </span>appears<span class="_ _14"> </span>to<span class="_ _14"> </span>have<span class="_ _14"> </span>exclusive<span class="_ _14"> </span>use<span class="_ _14"> </span>of<span class="_ _14"> </span>both<span class="_ _14"> </span>the<span class="_ _14"> </span>processor<span class="_ _14"> </span>and<span class="_ _14"> </span>the<span class="_ _14"> </span>memory<span class="_ _3"></span>.</div><div class="t m5 x1d h26 y32d ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _16"> </span>processor<span class="_ _11"> </span>appears<span class="_ _16"> </span>to<span class="_ _11"> </span>execute<span class="_ _11"> </span>the<span class="_ _16"> </span>instructions<span class="_ _11"> </span>in<span class="_ _16"> </span>our<span class="_ _11"> </span>program,<span class="_ _16"> </span>one<span class="_ _11"> </span>after<span class="_ _16"> </span>the</div><div class="t m5 x1d h26 y32e ff7 fs19 fc1 sc0 ls0 ws0">other,<span class="_"> </span>without<span class="_ _11"> </span>interruption.<span class="_ _11"> </span>F<span class="_ _0"></span>inally<span class="_ _3"></span>,<span class="_"> </span>the<span class="_ _11"> </span>code<span class="_ _11"> </span>and<span class="_ _11"> </span>data<span class="_ _11"> </span>of<span class="_ _11"> </span>our<span class="_ _11"> </span>program<span class="_ _11"> </span>appear<span class="_ _11"> </span>to</div><div class="t m5 x1d h26 y1cf ff7 fs19 fc1 sc0 ls0 ws0">be<span class="_"> </span>the<span class="_"> </span>only<span class="_"> </span>objects<span class="_"> </span>in<span class="_"> </span>the<span class="_"> </span>system’s<span class="_"> </span>memory<span class="_ _7"></span>.<span class="_ _11"> </span>T<span class="_ _1"></span>hese<span class="_"> </span>illusions<span class="_"> </span>are<span class="_"> </span>provided<span class="_ _11"> </span>to<span class="_"> </span>us<span class="_"> </span>by</div><div class="t m5 x1d h26 y32f ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>notion<span class="_"> </span>of<span class="_"> </span>a<span class="_"> </span>process<span class="_ _1"></span>.</div><div class="t m5 x29 h26 y330 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _14"> </span>classic<span class="_ _14"> </span>deﬁnition<span class="_ _14"> </span>of<span class="_ _14"> </span>a<span class="_ _16"> </span>process<span class="_ _14"> </span>is<span class="_ _14"> </span><span class="ffa">an<span class="_ _14"> </span>instance<span class="_ _14"> </span>of<span class="_ _14"> </span>a<span class="_ _16"> </span>program<span class="_ _14"> </span>in<span class="_ _14"> </span>execution</span>.</div><div class="t m5 x1d h26 y331 ff7 fs19 fc1 sc0 ls0 ws0">Each<span class="_ _15"> </span>program<span class="_ _15"> </span>in<span class="_ _21"> </span>the<span class="_ _15"> </span>system<span class="_ _15"> </span>runs<span class="_ _21"> </span>in<span class="_ _15"> </span>the<span class="_ _15"> </span><span class="ffa">context<span class="_ _e"> </span></span>of<span class="_ _14"> </span>some<span class="_ _15"> </span>process<span class="_ _0"></span>.<span class="_ _15"> </span>T<span class="_ _1"></span>he<span class="_ _21"> </span>context</div><div class="t m5 x1d h26 y4da6 ff7 fs19 fc1 sc0 ls0 ws0">consists<span class="_ _13"> </span>of<span class="_ _6"> </span>the<span class="_ _13"> </span>state<span class="_ _13"> </span>that<span class="_ _6"> </span>the<span class="_ _13"> </span>program<span class="_ _13"> </span>needs<span class="_ _6"> </span>to<span class="_ _13"> </span>run<span class="_ _13"> </span>correctly<span class="_ _7"></span>.<span class="_ _13"> </span>T<span class="_ _1"></span>his<span class="_ _13"> </span>state<span class="_ _6"> </span>includes<span class="_ _13"> </span>the</div><div class="t m5 x1d h26 y203d ff7 fs19 fc1 sc0 ls0 ws0">program’s<span class="_"> </span>code<span class="_ _11"> </span>and<span class="_ _11"> </span>data<span class="_ _11"> </span>stored<span class="_"> </span>in<span class="_ _11"> </span>memory<span class="_ _3"></span>,<span class="_ _11"> </span>its<span class="_ _11"> </span>stack,<span class="_ _11"> </span>the<span class="_ _11"> </span>contents<span class="_ _11"> </span>of<span class="_ _11"> </span>its<span class="_ _11"> </span>general-</div><div class="t m5 x1d h26 y203e ff7 fs19 fc1 sc0 ls0 ws0">purpose<span class="_ _13"> </span>registers<span class="_ _1"></span>,<span class="_ _13"> </span>its<span class="_ _13"> </span>program<span class="_ _13"> </span>counter,<span class="_ _13"> </span>environment<span class="_ _13"> </span>variables<span class="_ _1"></span>,<span class="_ _13"> </span>and<span class="_ _13"> </span>the<span class="_ _13"> </span>set<span class="_ _13"> </span>of<span class="_ _13"> </span>open</div><div class="t m5 x1d h26 y203f ff7 fs19 fc1 sc0 ls0 ws0">ﬁle<span class="_"> </span>descriptors<span class="_ _1"></span>.</div><div class="t m5 x29 h26 y50f5 ff7 fs19 fc1 sc0 ls0 ws0">Each<span class="_"> </span>time<span class="_"> </span>a<span class="_"> </span>user<span class="_"> </span>runs<span class="_"> </span>a<span class="_"> </span>program<span class="_ _11"> </span>by<span class="_"> </span>typing<span class="_"> </span>the<span class="_"> </span>name<span class="_"> </span>of<span class="_"> </span>an<span class="_ _11"> </span>executable<span class="_"> </span>object</div><div class="t m5 x1d h26 y50f6 ff7 fs19 fc1 sc0 ls0 ws0">ﬁle<span class="_ _13"> </span>to<span class="_ _6"> </span>the<span class="_ _13"> </span>shell,<span class="_ _13"> </span>the<span class="_ _13"> </span>shell<span class="_ _13"> </span>creates<span class="_ _6"> </span>a<span class="_ _13"> </span>new<span class="_ _13"> </span>process<span class="_ _13"> </span>and<span class="_ _6"> </span>then<span class="_ _13"> </span>runs<span class="_ _13"> </span>the<span class="_ _13"> </span>executable<span class="_ _6"> </span>object</div><div class="t m5 x1d h26 y5b58 ff7 fs19 fc1 sc0 ls0 ws0">ﬁle<span class="_"> </span>in<span class="_ _11"> </span>the<span class="_"> </span>context<span class="_ _11"> </span>of<span class="_"> </span>this<span class="_ _11"> </span>new<span class="_"> </span>process<span class="_ _1"></span>.<span class="_ _11"> </span>Application<span class="_"> </span>programs<span class="_ _11"> </span>can<span class="_ _11"> </span>also<span class="_"> </span>create<span class="_ _11"> </span>new</div><div class="t m5 x1d h26 y5b59 ff7 fs19 fc1 sc0 ls0 ws0">processes<span class="_ _13"> </span>and<span class="_ _13"> </span>run<span class="_ _13"> </span>either<span class="_ _13"> </span>their<span class="_ _13"> </span>own<span class="_ _13"> </span>code<span class="_ _13"> </span>or<span class="_ _13"> </span>other<span class="_"> </span>applications<span class="_ _13"> </span>in<span class="_ _13"> </span>the<span class="_ _13"> </span>context<span class="_ _13"> </span>of<span class="_ _13"> </span>the</div><div class="t m5 x1d h26 y5b5a ff7 fs19 fc1 sc0 ls0 ws0">new<span class="_"> </span>process<span class="_ _1"></span>.</div><div class="t m5 x29 h26 y5b5b ff7 fs19 fc1 sc0 ls0 ws0">A<span class="_ _16"> </span>detailed<span class="_ _16"> </span>discussion<span class="_ _16"> </span>of<span class="_ _16"> </span>how<span class="_ _14"> </span>operating<span class="_ _16"> </span>systems<span class="_ _16"> </span>implement<span class="_ _16"> </span>processes<span class="_ _16"> </span>is<span class="_ _14"> </span>be-</div><div class="t m5 x1d h26 y5b5c ff7 fs19 fc1 sc0 ls0 ws0">yond<span class="_ _15"> </span>our<span class="_ _21"> </span>scope.<span class="_ _15"> </span>Instead,<span class="_ _f"> </span>we<span class="_ _21"> </span>will<span class="_ _21"> </span>focus<span class="_ _21"> </span>on<span class="_ _21"> </span>the<span class="_ _21"> </span>key<span class="_ _21"> </span>abstractions<span class="_ _21"> </span>that<span class="_ _21"> </span>a<span class="_ _21"> </span>process</div><div class="t m5 x1d h26 y5b5d ff7 fs19 fc1 sc0 ls0 ws0">provides<span class="_"> </span>to<span class="_"> </span>the<span class="_"> </span>application:</div><div class="t m5 x75 h3d y64f3 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x29 h26 y64f4 ff7 fs19 fc1 sc0 ls0 ws0">An<span class="_ _16"> </span>independent<span class="_ _11"> </span>logical<span class="_ _16"> </span>control<span class="_ _16"> </span>ﬂow<span class="_ _11"> </span>that<span class="_ _16"> </span>provides<span class="_ _11"> </span>the<span class="_ _16"> </span>illusion<span class="_ _16"> </span>that<span class="_ _11"> </span>our<span class="_ _16"> </span>pro-</div><div class="t m5 x29 h26 y64f5 ff7 fs19 fc1 sc0 ls0 ws0">gram<span class="_"> </span>has<span class="_"> </span>exclusive<span class="_"> </span>use<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>processor.</div><div class="t m5 x75 h3d y64f6 ff14 fs26 fc6 sc0 ls0 ws0">.</div><div class="t m5 x29 h26 y64f7 ff7 fs19 fc1 sc0 ls0 ws0">A<span class="_ _13"> </span>private<span class="_ _13"> </span>address<span class="_ _13"> </span>space<span class="_ _13"> </span>that<span class="_ _13"> </span>provides<span class="_ _13"> </span>the<span class="_ _13"> </span>illusion<span class="_ _13"> </span>that<span class="_"> </span>our<span class="_ _13"> </span>program<span class="_ _13"> </span>has<span class="_ _13"> </span>exclu-</div><div class="t m5 x29 h26 y64f8 ff7 fs19 fc1 sc0 ls0 ws0">sive<span class="_"> </span>use<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>memory<span class="_"> </span>system.</div><div class="t m5 x1d h26 y64f9 ff7 fs19 fc1 sc0 ls0 ws0">Let’s<span class="_"> </span>look<span class="_"> </span>more<span class="_"> </span>closely<span class="_"> </span>at<span class="_"> </span>these<span class="_"> </span>abstractions<span class="_ _3"></span>.</div><div class="t m5 x1d h41 y8f8 ffe fs29 fc1 sc0 ls0 ws0">8.2.1<span class="_ _48"> </span><span class="fs19">Logical<span class="_"> </span>Control<span class="_"> </span>Flow</span></div><div class="t m5 x1d h26 yb97 ff7 fs19 fc1 sc0 ls0 ws0">A<span class="_"> </span>process<span class="_"> </span>provides<span class="_"> </span>each<span class="_ _13"> </span>program<span class="_"> </span>with<span class="_"> </span>the<span class="_"> </span>illusion<span class="_"> </span>that<span class="_"> </span>it<span class="_"> </span>has<span class="_ _13"> </span>exclusive<span class="_"> </span>use<span class="_"> </span>of<span class="_"> </span>the</div><div class="t m5 x1d h26 yb98 ff7 fs19 fc1 sc0 ls0 ws0">processor,<span class="_"> </span>even<span class="_ _11"> </span>though<span class="_ _11"> </span>many<span class="_ _11"> </span>other<span class="_ _11"> </span>programs<span class="_ _11"> </span>are<span class="_ _11"> </span>typically<span class="_ _11"> </span>running<span class="_ _11"> </span>concurrently</div><div class="t m5 x1d h26 yb99 ff7 fs19 fc1 sc0 ls0 ws0">on<span class="_ _f"> </span>the<span class="_ _e"> </span>system.<span class="_ _21"> </span>If<span class="_ _e"> </span>we<span class="_ _f"> </span>were<span class="_ _f"> </span>to<span class="_ _e"> </span>use<span class="_ _21"> </span>a<span class="_ _e"> </span>debugger<span class="_ _f"> </span>to<span class="_ _f"> </span>single-step<span class="_ _e"> </span>the<span class="_ _21"> </span>execution<span class="_ _e"> </span>of</div><div class="t m5 x1d h26 yb9a ff7 fs19 fc1 sc0 ls0 ws0">our<span class="_ _15"> </span>program,<span class="_ _21"> </span>we<span class="_ _15"> </span>would<span class="_ _21"> </span>observe<span class="_ _15"> </span>a<span class="_ _15"> </span>series<span class="_ _15"> </span>of<span class="_ _21"> </span>program<span class="_ _15"> </span>counter<span class="_ _15"> </span>(PC)<span class="_ _15"> </span>values<span class="_ _15"> </span>that</div><div class="t m5 x1d h26 yb9b ff7 fs19 fc1 sc0 ls0 ws0">corresponded<span class="_ _16"> </span>exclusively<span class="_ _16"> </span>to<span class="_ _16"> </span>instructions<span class="_ _16"> </span>contained<span class="_ _16"> </span>in<span class="_ _16"> </span>our<span class="_ _16"> </span>program’s<span class="_ _16"> </span>executable</div><div class="t m5 x1d h26 yb9c ff7 fs19 fc1 sc0 ls0 ws0">object<span class="_ _11"> </span>ﬁle<span class="_ _11"> </span>or<span class="_ _11"> </span>in<span class="_ _16"> </span>shared<span class="_ _11"> </span>objects<span class="_ _11"> </span>linked<span class="_ _11"> </span>into<span class="_ _11"> </span>our<span class="_ _16"> </span>program<span class="_ _11"> </span>dynamically<span class="_ _11"> </span>at<span class="_ _11"> </span>run<span class="_ _11"> </span>time.</div><div class="t m5 x1d h26 yb9d ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>his<span class="_ _16"> </span>sequence<span class="_ _16"> </span>of<span class="_ _16"> </span>PC<span class="_ _16"> </span>values<span class="_ _16"> </span>is<span class="_ _16"> </span>known<span class="_ _16"> </span>as<span class="_ _14"> </span>a<span class="_ _16"> </span><span class="ffa">logical<span class="_ _16"> </span>control<span class="_ _16"> </span>ﬂow<span class="_ _0"></span><span class="ff7">,<span class="_ _16"> </span>or<span class="_ _16"> </span>simply<span class="_ _16"> </span><span class="ffa">logical</span></span></span></div><div class="t m5 x1d h26 yb9e ffa fs19 fc1 sc0 ls0 ws0">ﬂow<span class="_ _0"></span><span class="ff7">.</span></div><div class="t m5 x29 h26 yb9f ff7 fs19 fc1 sc0 ls0 ws0">Consider<span class="_ _14"> </span>a<span class="_ _15"> </span>system<span class="_ _15"> </span>that<span class="_ _15"> </span>runs<span class="_ _14"> </span>three<span class="_ _15"> </span>processes<span class="_ _1"></span>,<span class="_ _21"> </span>as<span class="_ _15"> </span>shown<span class="_ _15"> </span>in<span class="_ _14"> </span>Figure<span class="_ _14"> </span>8.12.<span class="_ _15"> </span>T<span class="_ _1"></span>he</div><div class="t m5 x1d h26 yba0 ff7 fs19 fc1 sc0 ls0 ws0">single<span class="_ _13"> </span>physical<span class="_"> </span>control<span class="_ _13"> </span>ﬂow<span class="_"> </span>of<span class="_ _13"> </span>the<span class="_"> </span>processor<span class="_ _13"> </span>is<span class="_ _13"> </span>partitioned<span class="_"> </span>into<span class="_ _13"> </span>three<span class="_"> </span>logical<span class="_ _13"> </span>ﬂows<span class="_ _1"></span>,</div><div class="t m5 x1d h26 yba1 ff7 fs19 fc1 sc0 ls0 ws0">one<span class="_ _13"> </span>for<span class="_"> </span>each<span class="_ _13"> </span>process<span class="_ _3"></span>.<span class="_"> </span>Each<span class="_ _13"> </span>vertical<span class="_ _13"> </span>line<span class="_ _13"> </span>represents<span class="_"> </span>a<span class="_ _13"> </span>portion<span class="_ _13"> </span>of<span class="_"> </span>the<span class="_ _13"> </span>logical<span class="_ _13"> </span>ﬂow<span class="_ _13"> </span>for</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
