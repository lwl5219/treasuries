<div id="pf78" class="pf w2 h11" data-page-no="78"><div class="pc pc78 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg78.png"/><div class="t m5 x94 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>2.2<span class="_ _60"> </span>Integer<span class="_ _10"> </span>Representations<span class="_ _3e"> </span><span class="ffe fs1e">119</span></div><div class="t m5 x17 h41 ye7 ffe fs29 fc2 sc0 ls0 ws0">2.2.8<span class="_ _48"> </span><span class="fs19">Advice<span class="_"> </span>on<span class="_"> </span>Signed<span class="_"> </span>versus<span class="_"> </span>Unsigned</span></div><div class="t m5 x17 h26 ybbe ff7 fs19 fc2 sc0 ls0 ws0">As<span class="_ _16"> </span>we<span class="_ _16"> </span>have<span class="_ _14"> </span>seen,<span class="_ _14"> </span>the<span class="_ _16"> </span>implicit<span class="_ _14"> </span>casting<span class="_ _16"> </span>of<span class="_ _16"> </span>signed<span class="_ _14"> </span>to<span class="_ _16"> </span>unsigned<span class="_ _14"> </span>leads<span class="_ _16"> </span>to<span class="_ _14"> </span>some<span class="_ _16"> </span>non-</div><div class="t m5 x17 h26 ybbf ff7 fs19 fc2 sc0 ls0 ws0">intuitive<span class="_ _14"> </span>behavior.<span class="_ _14"> </span>Nonintuitive<span class="_ _14"> </span>features<span class="_ _15"> </span>often<span class="_ _14"> </span>lead<span class="_ _14"> </span>to<span class="_ _15"> </span>program<span class="_ _14"> </span>bugs<span class="_ _1"></span>,<span class="_ _15"> </span>and<span class="_ _15"> </span>ones</div><div class="t m5 x17 h26 ybc0 ff7 fs19 fc2 sc0 ls0 ws0">involving<span class="_ _13"> </span>the<span class="_ _6"> </span>nuances<span class="_ _13"> </span>of<span class="_ _13"> </span>implicit<span class="_ _13"> </span>casting<span class="_ _6"> </span>can<span class="_ _13"> </span>be<span class="_ _13"> </span>especially<span class="_ _6"> </span>difﬁcult<span class="_ _13"> </span>to<span class="_ _13"> </span>see<span class="_ _1"></span>.<span class="_ _13"> </span>Since<span class="_ _13"> </span>the</div><div class="t m5 x17 h26 ybc1 ff7 fs19 fc2 sc0 ls0 ws0">casting<span class="_ _11"> </span>takes<span class="_ _16"> </span>place<span class="_ _16"> </span>without<span class="_ _11"> </span>any<span class="_ _16"> </span>clear<span class="_ _11"> </span>indication<span class="_ _16"> </span>in<span class="_ _16"> </span>the<span class="_ _11"> </span>code<span class="_ _0"></span>,<span class="_ _16"> </span>programmers<span class="_ _11"> </span>often</div><div class="t m5 x17 h26 ybc2 ff7 fs19 fc2 sc0 ls0 ws0">overlook<span class="_"> </span>its<span class="_"> </span>effects<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y119b ff7 fs19 fc2 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_"> </span>following<span class="_ _11"> </span>two<span class="_"> </span>practice<span class="_"> </span>problems<span class="_"> </span>illustrate<span class="_ _11"> </span>some<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>subtle<span class="_ _11"> </span>errors<span class="_"> </span>that</div><div class="t m5 x17 h26 y119c ff7 fs19 fc2 sc0 ls0 ws0">can<span class="_"> </span>arise<span class="_"> </span>due<span class="_"> </span>to<span class="_"> </span>implicit<span class="_"> </span>casting<span class="_"> </span>and<span class="_"> </span>the<span class="_"> </span>unsigned<span class="_"> </span>data<span class="_"> </span>type<span class="_ _1"></span>.</div><div class="t m5 x17 h47 y119d ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>2.25<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>187)</span></div><div class="t m5 x17 h26 y119e ff7 fs19 fc1 sc0 ls0 ws0">Consider<span class="_ _6"> </span>the<span class="_ _6"> </span>following<span class="_ _6"> </span>code<span class="_ _13"> </span>that<span class="_ _a"> </span>attempts<span class="_ _13"> </span>to<span class="_ _a"> </span>sum<span class="_ _6"> </span>the<span class="_ _13"> </span>elements<span class="_ _a"> </span>of<span class="_ _13"> </span>an<span class="_ _a"> </span>array<span class="_ _6"> </span><span class="ffd">a</span>,<span class="_ _13"> </span>where</div><div class="t m5 x17 h26 y119f ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>number<span class="_"> </span>of<span class="_"> </span>elements<span class="_"> </span>is<span class="_"> </span>given<span class="_"> </span>by<span class="_"> </span>parameter<span class="_"> </span><span class="ffd">length</span>:</div><div class="t m5 x2c h2d y11a0 ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">/*<span class="_ _1f"> </span>WARNING:<span class="_ _e"> </span>This<span class="_ _1f"> </span>is<span class="_ _1f"> </span>buggy<span class="_ _e"> </span>code<span class="_ _1f"> </span>*/</span></div><div class="t m5 x2c h2d y11a1 ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _1c"> </span><span class="ffd fs1e fc2">float<span class="_ _1f"> </span>sum_elements(float<span class="_ _e"> </span>a[],<span class="_ _1f"> </span>unsigned<span class="_ _1f"> </span>length)<span class="_ _e"> </span>{</span></div><div class="t m5 x2c h2d y11a2 ff6 fs20 fc6 sc0 ls0 ws0">3<span class="_ _20"> </span><span class="ffd fs1e fc2">int<span class="_ _e"> </span>i;</span></div><div class="t m5 x2c h2d y11a3 ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _20"> </span><span class="ffd fs1e fc2">float<span class="_ _e"> </span>result<span class="_ _1f"> </span>=<span class="_ _1f"> </span>0;</span></div><div class="t m5 x2c h2e y11a4 ff6 fs20 fc6 sc0 ls0 ws0">5</div><div class="t m5 x2c h2e y11a5 ff6 fs20 fc6 sc0 ls0 ws0">6</div><div class="t m5 x142 h2d y11a6 ffd fs1e fc2 sc0 ls0 ws0">for<span class="_ _e"> </span>(i<span class="_ _1f"> </span>=<span class="_ _1f"> </span>0;<span class="_ _e"> </span>i<span class="_ _1f"> </span>&lt;=<span class="_ _e"> </span>length-1;<span class="_ _1f"> </span>i++)</div><div class="t m5 x2c h2d y11a7 ff6 fs20 fc6 sc0 ls0 ws0">7<span class="_ _70"> </span><span class="ffd fs1e fc2">result<span class="_ _e"> </span>+=<span class="_ _1f"> </span>a[i];</span></div><div class="t m5 x2c h2d y11a8 ff6 fs20 fc6 sc0 ls0 ws0">8<span class="_ _20"> </span><span class="ffd fs1e fc2">return<span class="_ _e"> </span>result;</span></div><div class="t m5 x2c h2d y11a9 ff6 fs20 fc6 sc0 ls0 ws0">9<span class="_ _1c"> </span><span class="ffd fs1e fc2">}</span></div><div class="t m5 x26 h26 y11aa ff7 fs19 fc2 sc0 ls0 ws0">When<span class="_ _15"> </span>run<span class="_ _21"> </span>with<span class="_ _f"> </span>argument<span class="_ _21"> </span><span class="ffd">length<span class="_ _21"> </span></span>equal<span class="_ _21"> </span>to<span class="_ _f"> </span>0,<span class="_ _f"> </span>this<span class="_ _f"> </span>code<span class="_ _21"> </span>should<span class="_ _21"> </span>return<span class="_ _21"> </span>0<span class="ff11">.</span><span class="ls93">0.</span></div><div class="t m5 x17 h26 y11ab ff7 fs19 fc2 sc0 ls0 ws0">Instead,<span class="_"> </span>it<span class="_"> </span>encounters<span class="_"> </span>a<span class="_"> </span>memory<span class="_ _11"> </span>error.<span class="_"> </span>Explain<span class="_"> </span>why<span class="_"> </span>this<span class="_"> </span>happens<span class="_ _1"></span>.<span class="_"> </span>Show<span class="_"> </span>how<span class="_"> </span>this</div><div class="t m5 x17 h26 y11ac ff7 fs19 fc2 sc0 ls0 ws0">code<span class="_"> </span>can<span class="_"> </span>be<span class="_"> </span>corrected.</div><div class="t m5 x17 h47 y11ad ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>2.26<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>187)</span></div><div class="t m5 x17 h26 y11ae ff7 fs19 fc1 sc0 ls0 ws0">Y<span class="_ _3"></span>ou<span class="_"> </span>are<span class="_ _11"> </span>given<span class="_ _11"> </span>the<span class="_ _11"> </span>assignment<span class="_ _11"> </span>of<span class="_ _11"> </span>writing<span class="_"> </span>a<span class="_ _11"> </span>function<span class="_ _11"> </span>that<span class="_ _11"> </span>determines<span class="_ _11"> </span>whether<span class="_ _11"> </span>one</div><div class="t m5 x17 h26 y11af ff7 fs19 fc1 sc0 ls0 ws0">string<span class="_ _13"> </span>is<span class="_ _13"> </span>longer<span class="_ _13"> </span>than<span class="_ _13"> </span>another<span class="_ _0"></span>.<span class="_ _13"> </span>Y<span class="_ _7"></span>ou<span class="_ _13"> </span>decide<span class="_ _13"> </span>to<span class="_ _13"> </span>make<span class="_ _13"> </span>use<span class="_ _13"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>string<span class="_ _13"> </span>library<span class="_ _13"> </span>function</div><div class="t m5 x17 h26 y11b0 ffd fs19 fc1 sc0 ls0 ws0">strlen<span class="_ _10"> </span><span class="ff7">having<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>declaration:</span></div><div class="t m5 x17 h2d y11b1 ffd fs1e fc2 sc0 ls0 ws0">/*<span class="_ _e"> </span>Prototype<span class="_ _1f"> </span>for<span class="_ _1f"> </span>library<span class="_ _e"> </span>function<span class="_ _1f"> </span>strlen<span class="_ _e"> </span>*/</div><div class="t m5 x17 h2d y11b2 ffd fs1e fc2 sc0 ls0 ws0">size_t<span class="_ _e"> </span>strlen(const<span class="_ _1f"> </span>char<span class="_ _1f"> </span>*s);</div><div class="t m5 x26 h26 y11b3 ff7 fs19 fc2 sc0 ls0 ws0">Here<span class="_"> </span>is<span class="_"> </span>your<span class="_"> </span>ﬁrst<span class="_"> </span>attempt<span class="_"> </span>at<span class="_"> </span>the<span class="_"> </span>function:</div><div class="t m5 x17 h2d y11b4 ffd fs1e fc2 sc0 ls0 ws0">/*<span class="_ _e"> </span>Determine<span class="_ _1f"> </span>whether<span class="_ _1f"> </span>string<span class="_ _e"> </span>s<span class="_ _1f"> </span>is<span class="_ _e"> </span>longer<span class="_ _1f"> </span>than<span class="_ _1f"> </span>string<span class="_ _e"> </span>t<span class="_ _1f"> </span>*/</div><div class="t m5 x17 h2d y11b5 ffd fs1e fc2 sc0 ls0 ws0">/*<span class="_ _e"> </span>WARNING:<span class="_ _1f"> </span>This<span class="_ _1f"> </span>function<span class="_ _e"> </span>is<span class="_ _1f"> </span>buggy<span class="_ _e"> </span>*/</div><div class="t m5 x17 h2d y11b6 ffd fs1e fc2 sc0 ls0 ws0">int<span class="_ _e"> </span>strlonger(char<span class="_ _1f"> </span>*s,<span class="_ _1f"> </span>char<span class="_ _e"> </span>*t)<span class="_ _1f"> </span>{</div><div class="t m5 x1b6 h2d y11b7 ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>strlen(s)<span class="_ _1f"> </span>-<span class="_ _1f"> </span>strlen(t)<span class="_ _e"> </span>&gt;<span class="_ _1f"> </span>0;</div><div class="t m5 x17 h2d y11b8 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x26 h26 y6e1 ff7 fs19 fc2 sc0 ls0 ws0">When<span class="_ _11"> </span>you<span class="_ _16"> </span>test<span class="_ _16"> </span>this<span class="_ _16"> </span>on<span class="_ _16"> </span>some<span class="_ _16"> </span>sample<span class="_ _16"> </span>data,<span class="_ _16"> </span>things<span class="_ _16"> </span>do<span class="_ _16"> </span>not<span class="_ _16"> </span>seem<span class="_ _16"> </span>to<span class="_ _11"> </span>work<span class="_ _16"> </span>quite</div><div class="t m5 x17 h26 y6e2 ff7 fs19 fc2 sc0 ls0 ws0">right.<span class="_ _f"> </span>Y<span class="_ _3"></span>ou<span class="_ _21"> </span>investigate<span class="_ _f"> </span>further<span class="_ _f"> </span>and<span class="_ _f"> </span>determine<span class="_ _f"> </span>that,<span class="_ _e"> </span>when<span class="_ _f"> </span>compiled<span class="_ _f"> </span>as<span class="_ _f"> </span>a<span class="_ _f"> </span>32-bit</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
