<div id="pfdd" class="pf w2 h11" data-page-no="dd"><div class="pc pcdd w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bgdd.png"/><div class="t m5 x14 h28 y9b ffe fs1e fc2 sc0 ls0 ws0">220<span class="_ _1b"> </span><span class="ff6 fs1f">Chapter<span class="_ _10"> </span>3<span class="_ _3d"> </span>Machine-Level<span class="_ _10"> </span>Representation<span class="_ _10"> </span>of<span class="_ _10"> </span>Programs</span></div><div class="t m5 x28 h2a y548 fff fs1c fc2 sc0 ls0 ws0">Aside<span class="_ _1b"> </span><span class="ff6 fs19">Understanding<span class="_ _11"> </span>how<span class="_ _11"> </span>data<span class="_ _11"> </span>movement<span class="_ _16"> </span>changes<span class="_ _11"> </span>a<span class="_ _11"> </span>destination<span class="_ _11"> </span>register</span></div><div class="t m5 x28 h2b y2d0 ff7 fs1e fc2 sc0 ls0 ws0">As<span class="_"> </span>described,<span class="_ _13"> </span>there<span class="_ _13"> </span>are<span class="_"> </span>two<span class="_ _13"> </span>different<span class="_ _13"> </span>conventions<span class="_"> </span>regarding<span class="_ _13"> </span>whether<span class="_ _13"> </span>and<span class="_"> </span>how<span class="_ _13"> </span>data<span class="_ _13"> </span>movement<span class="_"> </span>instruc-</div><div class="t m5 x28 h2b y2d1 ff7 fs1e fc2 sc0 ls0 ws0">tions<span class="_ _11"> </span>modify<span class="_ _16"> </span>the<span class="_ _11"> </span>upper<span class="_ _16"> </span>bytes<span class="_ _16"> </span>of<span class="_ _11"> </span>a<span class="_ _16"> </span>destination<span class="_ _11"> </span>register.<span class="_ _11"> </span>This<span class="_ _11"> </span>distinction<span class="_ _11"> </span>is<span class="_ _16"> </span>illustrated<span class="_ _11"> </span>by<span class="_ _16"> </span>the<span class="_ _16"> </span>following</div><div class="t m5 x28 h2b y2d2 ff7 fs1e fc2 sc0 ls0 ws0">code<span class="_"> </span>sequence:</div><div class="t m5 xc6 h2d y223d ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _45"> </span><span class="ffd fs1e fc2">movabsq<span class="_ _e"> </span>$0x0011223344556677,<span class="_ _1f"> </span>%rax<span class="_ _95"> </span></span><span class="ff13 fs35">%rax<span class="_ _e"> </span>=<span class="_ _21"> </span>0011223344556677</span></div><div class="t m5 xc6 h2d y120a ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _45"> </span><span class="ffd fs1e fc2">movb<span class="_ _46"> </span>$-1,<span class="_ _e"> </span>%al<span class="_ _12c"> </span></span><span class="ff13 fs35">%rax<span class="_ _e"> </span>=<span class="_ _21"> </span>00112233445566FF</span></div><div class="t m5 xc6 h2d y223e ff6 fs20 fc6 sc0 ls0 ws0">3<span class="_ _45"> </span><span class="ffd fs1e fc2">movw<span class="_ _46"> </span>$-1,<span class="_ _e"> </span>%ax<span class="_ _12c"> </span></span><span class="ff13 fs35">%rax<span class="_ _e"> </span>=<span class="_ _21"> </span>001122334455FFFF</span></div><div class="t m5 xc6 h2d y223f ff6 fs20 fc6 sc0 ls0 ws0">4<span class="_ _45"> </span><span class="ffd fs1e fc2">movl<span class="_ _46"> </span>$-1,<span class="_ _e"> </span>%eax<span class="_ _27"> </span></span><span class="ff13 fs35">%rax<span class="_ _21"> </span>=<span class="_ _e"> </span>00000000FFFFFFFF</span></div><div class="t m5 xc6 h2d y2240 ff6 fs20 fc6 sc0 ls0 ws0">5<span class="_ _45"> </span><span class="ffd fs1e fc2">movq<span class="_ _46"> </span>$-1,<span class="_ _e"> </span>%rax<span class="_ _27"> </span></span><span class="ff13 fs35">%rax<span class="_ _21"> </span>=<span class="_ _e"> </span>FFFFFFFFFFFFFFFF</span></div><div class="t m5 x57 h2b y2241 ff7 fs1e fc2 sc0 ls0 ws0">In<span class="_ _13"> </span>the<span class="_"> </span>following<span class="_ _13"> </span>discussion,<span class="_ _13"> </span>we<span class="_"> </span>use<span class="_ _13"> </span>hexadecimal<span class="_ _13"> </span>notation.<span class="_"> </span>In<span class="_ _13"> </span>the<span class="_ _13"> </span>example<span class="_ _1"></span>,<span class="_"> </span>the<span class="_"> </span>instruction<span class="_ _13"> </span>on<span class="_ _13"> </span>line<span class="_ _13"> </span>1</div><div class="t m5 x28 h2b y2242 ff7 fs1e fc2 sc0 ls0 ws0">initializes<span class="_ _13"> </span>register<span class="_"> </span><span class="ffd">%rax<span class="_ _13"> </span></span>to<span class="_ _13"> </span>the<span class="_ _13"> </span>pattern<span class="_ _13"> </span><span class="ffd">0011223344556677</span>.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_ _13"> </span>remaining<span class="_"> </span>instructions<span class="_ _13"> </span>have<span class="_ _13"> </span>immediate</div><div class="t m5 x28 h4a y2243 ff7 fs1e fc2 sc0 ls0 ws0">value<span class="_ _13"> </span><span class="ff12">−</span>1<span class="_ _6"> </span>as<span class="_ _13"> </span>their<span class="_ _13"> </span>source<span class="_ _13"> </span>values<span class="_ _1"></span>.<span class="_ _13"> </span>Recall<span class="_"> </span>that<span class="_ _6"> </span>the<span class="_"> </span>hexadecimal<span class="_ _13"> </span>representation<span class="_ _13"> </span>of<span class="_ _13"> </span><span class="ff12">−</span>1<span class="_ _a"> </span>is<span class="_"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>form<span class="_ _13"> </span><span class="ffd">FF</span></div><div class="t m5 x223 h49 y2244 ff11 fs1e fc2 sc0 ls6e ws0">...</div><div class="t m5 x213 h2b y2243 ffd fs1e fc2 sc0 ls0 ws0">F<span class="ff7">,</span></div><div class="t m5 x28 h2b y2245 ff7 fs1e fc2 sc0 ls0 ws0">where<span class="_ _6"> </span>the<span class="_ _13"> </span>number<span class="_ _6"> </span>of<span class="_ _13"> </span><span class="ffd">F</span>’<span class="_ _1"></span>s<span class="_ _13"> </span>is<span class="_ _6"> </span>twice<span class="_ _13"> </span>the<span class="_ _6"> </span>number<span class="_ _13"> </span>of<span class="_ _6"> </span>bytes<span class="_ _6"> </span>in<span class="_ _13"> </span>the<span class="_ _6"> </span>representation.<span class="_ _13"> </span>T<span class="_ _1"></span>he<span class="_ _6"> </span><span class="ffd">movb<span class="_ _13"> </span></span>instruction<span class="_ _6"> </span>(line<span class="_ _13"> </span>2)</div><div class="t m5 x28 h2b y2246 ff7 fs1e fc2 sc0 ls0 ws0">therefore<span class="_ _10"> </span>sets<span class="_ _11"> </span>the<span class="_ _11"> </span>low-order<span class="_"> </span>byte<span class="_ _11"> </span>of<span class="_ _11"> </span><span class="ffd">%rax<span class="_ _10"> </span></span>to<span class="_ _11"> </span><span class="ffd">FF</span>,<span class="_ _11"> </span>while<span class="_"> </span>the<span class="_ _11"> </span><span class="ffd">movw<span class="_ _11"> </span></span>instruction<span class="_"> </span>(line<span class="_ _11"> </span>3)<span class="_ _11"> </span>sets<span class="_ _10"> </span>the<span class="_ _11"> </span>low-order</div><div class="t m5 x28 h2b y2247 ff7 fs1e fc2 sc0 ls0 ws0">2<span class="_"> </span>bytes<span class="_ _10"> </span>to<span class="_ _11"> </span><span class="ffd">FFFF</span>,<span class="_"> </span>with<span class="_"> </span>the<span class="_ _11"> </span>remaining<span class="_"> </span>bytes<span class="_ _10"> </span>unchanged.<span class="_ _10"> </span>The<span class="_"> </span><span class="ffd">movl<span class="_ _10"> </span></span>instruction<span class="_"> </span>(line<span class="_ _11"> </span>4)<span class="_"> </span>sets<span class="_"> </span>the<span class="_ _11"> </span>low-order</div><div class="t m5 x28 h2b y2248 ff7 fs1e fc2 sc0 ls0 ws0">4<span class="_ _11"> </span>bytes<span class="_ _10"> </span>to<span class="_ _11"> </span><span class="ffd">FFFFFFFF</span>,<span class="_ _11"> </span>but<span class="_ _11"> </span>it<span class="_ _11"> </span>also<span class="_ _11"> </span>sets<span class="_ _11"> </span>the<span class="_ _11"> </span>high-order<span class="_ _11"> </span>4<span class="_ _10"> </span>bytes<span class="_ _11"> </span>to<span class="_ _11"> </span><span class="ffd">00000000</span>.<span class="_ _11"> </span>F<span class="_ _0"></span>inally<span class="_ _3"></span>,<span class="_ _11"> </span>the<span class="_ _11"> </span><span class="ffd">movq<span class="_ _11"> </span></span>instruction</div><div class="t m5 x28 h2b y2249 ff7 fs1e fc2 sc0 ls0 ws0">(line<span class="_"> </span>5)<span class="_"> </span>sets<span class="_"> </span>the<span class="_"> </span>complete<span class="_"> </span>register<span class="_"> </span>to<span class="_"> </span><span class="ffd">FFFFFFFFFFFFFFFF</span>.</div><div class="t m5 x1d h31 y224a ff7 fs21 fc2 sc0 ls0 ws0">Instruction<span class="_ _73"> </span>Effect<span class="_ _e5"> </span>Description</div><div class="t m5 x1d h32 y224b ff9 fs21 fc2 sc0 ls0 ws0">mo<span class="_ _0"></span>vz<span class="_ _13d"> </span><span class="ff11">S<span class="_ _2"></span><span class="ff7">,<span class="_"> </span></span><span class="ls149">RR<span class="_ _106"></span><span class="ff12 ls0">←<span class="_ _23"> </span><span class="ff6">ZeroExtend<span class="_ _0"></span><span class="ff11">(S<span class="_ _2"></span>)<span class="_ _26"> </span><span class="ff7">Move<span class="_"> </span>with<span class="_"> </span>zero<span class="_"> </span>extension</span></span></span></span></span></span></div><div class="t m5 x17e h31 y224c ffd fs1e fc2 sc0 ls0 ws0">movzbw<span class="_ _13e"> </span><span class="ff7 fs21">Move<span class="_"> </span>zero-extended<span class="_"> </span>byte<span class="_"> </span>to<span class="_"> </span>word</span></div><div class="t m5 x17e h31 y224d ffd fs1e fc2 sc0 ls0 ws0">movzbl<span class="_ _13e"> </span><span class="ff7 fs21">Move<span class="_"> </span>zero-extended<span class="_"> </span>byte<span class="_"> </span>to<span class="_"> </span>double<span class="_"> </span>word</span></div><div class="t m5 x17e h31 y224e ffd fs1e fc2 sc0 ls0 ws0">movzwl<span class="_ _13e"> </span><span class="ff7 fs21">Move<span class="_"> </span>zero-extended<span class="_"> </span>word<span class="_"> </span>to<span class="_"> </span>double<span class="_"> </span>word</span></div><div class="t m5 x17e h31 y224f ffd fs1e fc2 sc0 ls0 ws0">movzbq<span class="_ _13e"> </span><span class="ff7 fs21">Move<span class="_"> </span>zero-extended<span class="_"> </span>byte<span class="_"> </span>to<span class="_"> </span>quad<span class="_"> </span>word</span></div><div class="t m5 x17e h31 y2250 ffd fs1e fc2 sc0 ls0 ws0">movzwq<span class="_ _13e"> </span><span class="ff7 fs21">Move<span class="_"> </span>zero-extended<span class="_"> </span>word<span class="_"> </span>to<span class="_"> </span>quad<span class="_"> </span>word</span></div><div class="t m5 x1d h34 y2251 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _11"> </span>3.5<span class="_ _c"> </span><span class="fc1">Zero-extending<span class="_ _16"> </span>data<span class="_ _16"> </span>movement<span class="_ _11"> </span>instructions.<span class="_ _16"> </span><span class="ff6">These<span class="_ _11"> </span>instructions<span class="_ _16"> </span>have<span class="_ _16"> </span>a</span></span></div><div class="t m5 x1d h34 y2252 ff6 fs16 fc1 sc0 ls0 ws0">register<span class="_ _10"> </span>or<span class="_ _11"> </span>memory<span class="_ _10"> </span>location<span class="_ _11"> </span>as<span class="_ _10"> </span>the<span class="_ _11"> </span>source<span class="_ _10"> </span>and<span class="_ _10"> </span>a<span class="_ _10"> </span>register<span class="_ _11"> </span>as<span class="_ _10"> </span>the<span class="_ _11"> </span>destination.</div><div class="t m5 x1d h26 y107a ff7 fs19 fc1 sc0 ls0 ws0">in<span class="_ _15"> </span>memory<span class="_ _3"></span>,<span class="_ _15"> </span>to<span class="_ _15"> </span>a<span class="_ _15"> </span>register<span class="_ _15"> </span>destination.<span class="_ _15"> </span>Instructions<span class="_ _15"> </span>in<span class="_ _15"> </span>the<span class="_ _15"> </span><span class="ff9">mo<span class="_ _0"></span>vz<span class="_ _14"> </span><span class="ff7">class<span class="_ _15"> </span>ﬁll<span class="_ _15"> </span>out<span class="_ _15"> </span>the</span></span></div><div class="t m5 x1d h26 y2179 ff7 fs19 fc1 sc0 ls0 ws0">remaining<span class="_ _14"> </span>bytes<span class="_ _14"> </span>of<span class="_ _14"> </span>the<span class="_ _14"> </span>destination<span class="_ _14"> </span>with<span class="_ _14"> </span>zeros<span class="_ _1"></span>,<span class="_ _15"> </span>while<span class="_ _14"> </span>those<span class="_ _14"> </span>in<span class="_ _14"> </span>the<span class="_ _14"> </span><span class="ff9">mo<span class="_ _0"></span>vs<span class="_ _14"> </span><span class="ff7">class<span class="_ _14"> </span>ﬁll</span></span></div><div class="t m5 x1d h26 y217a ff7 fs19 fc1 sc0 ls0 ws0">them<span class="_ _16"> </span>out<span class="_ _14"> </span>by<span class="_ _14"> </span>sign<span class="_ _16"> </span>extension,<span class="_ _15"> </span>replicating<span class="_ _16"> </span>copies<span class="_ _14"> </span>of<span class="_ _14"> </span>the<span class="_ _16"> </span>most<span class="_ _14"> </span>signiﬁcant<span class="_ _14"> </span>bit<span class="_ _16"> </span>of<span class="_ _14"> </span>the</div><div class="t m5 x1d h26 y217b ff7 fs19 fc1 sc0 ls0 ws0">source<span class="_ _14"> </span>operand.<span class="_ _16"> </span>Observe<span class="_ _14"> </span>that<span class="_ _14"> </span>each<span class="_ _14"> </span>instruction<span class="_ _14"> </span>name<span class="_ _14"> </span>has<span class="_ _14"> </span>size<span class="_ _14"> </span>designators<span class="_ _14"> </span>as<span class="_ _14"> </span>its</div><div class="t m5 x1d h26 y217c ff7 fs19 fc1 sc0 ls0 ws0">ﬁnal<span class="_ _13"> </span>two<span class="_ _13"> </span>characters—the<span class="_ _6"> </span>ﬁrst<span class="_ _13"> </span>specifying<span class="_ _13"> </span>the<span class="_ _13"> </span>source<span class="_ _6"> </span>size,<span class="_ _13"> </span>and<span class="_ _6"> </span>the<span class="_ _13"> </span>second<span class="_ _13"> </span>specifying</div><div class="t m5 x1d h26 y217d ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>destination<span class="_ _11"> </span>size<span class="_ _0"></span>.<span class="_"> </span>As<span class="_ _11"> </span>can<span class="_ _11"> </span>be<span class="_ _11"> </span>seen,<span class="_"> </span>there<span class="_ _11"> </span>are<span class="_ _11"> </span>three<span class="_ _11"> </span>instructions<span class="_"> </span>in<span class="_ _11"> </span>each<span class="_ _11"> </span>of<span class="_ _11"> </span>these</div><div class="t m5 x1d h26 y217e ff7 fs19 fc1 sc0 ls0 ws0">classes<span class="_ _1"></span>,<span class="_ _13"> </span>covering<span class="_ _a"> </span>all<span class="_ _6"> </span>cases<span class="_ _6"> </span>of<span class="_ _13"> </span>1-<span class="_ _a"> </span>and<span class="_ _6"> </span>2-byte<span class="_ _13"> </span>source<span class="_ _a"> </span>sizes<span class="_ _6"> </span>and<span class="_ _6"> </span>2-<span class="_ _13"> </span>and<span class="_ _a"> </span>4-byte<span class="_ _6"> </span>destination</div><div class="t m5 x1d h26 y217f ff7 fs19 fc1 sc0 ls0 ws0">sizes<span class="_ _1"></span>,<span class="_ _14"> </span>considering<span class="_ _14"> </span>only<span class="_ _14"> </span>cases<span class="_ _14"> </span>where<span class="_ _14"> </span>the<span class="_ _16"> </span>destination<span class="_ _14"> </span>is<span class="_ _14"> </span>larger<span class="_ _14"> </span>than<span class="_ _14"> </span>the<span class="_ _16"> </span>source,<span class="_ _14"> </span>of</div><div class="t m5 x1d h26 y2180 ff7 fs19 fc1 sc0 ls0 ws0">course<span class="_ _1"></span>.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
