<div id="pf34c" class="pf w2 h11" data-page-no="34c"><div class="pc pc34c w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg34c.png"/><div class="t m5 x170 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>9.3<span class="_ _60"> </span>VM<span class="_ _10"> </span>as<span class="_ _10"> </span>a<span class="_ _10"> </span>T<span class="_ _1"></span>ool<span class="_ _10"> </span>for<span class="_ _10"> </span>Caching<span class="_ _3e"> </span><span class="ffe fs1e">843</span></div><div class="t m5 x17 h2f y9c ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_"> </span>9.4</div><div class="t m5 x17 h2f y676 ffe fs16 fc1 sc0 ls0 ws0">Page<span class="_"> </span>table.</div><div class="t m5 xb3 h3f y6c8f ffa9 fs27 fc1 sc0 ls0 ws0">PTE 0</div><div class="t m5 x148 h3f y6c90 ffa9 fs27 fc1 sc0 ls0 ws0">PP 0</div><div class="t m5 x148 h3f y6c91 ffa9 fs27 fc1 sc0 ls0 ws0">PP 3</div><div class="t m5 x110 h3f y6c92 ffa9 fs27 fc1 sc0 ls0 ws0">1</div><div class="t m5 x110 h3f y6c93 ffa9 fs27 fc1 sc0 ls0 ws0">1</div><div class="t m5 x110 h3f y6c94 ffa9 fs27 fc1 sc0 ls0 ws0">0</div><div class="t m5 x110 h3f y6c95 ffa9 fs27 fc1 sc0 ls0 ws0">1</div><div class="t m5 x110 h3f y6c96 ffa9 fs27 fc1 sc0 ls0 ws0">0</div><div class="t m5 x110 h3f y6c97 ffa9 fs27 fc1 sc0 ls0 ws0">0</div><div class="t m5 x110 h3f y6c98 ffa9 fs27 fc1 sc0 ls0 ws0">1</div><div class="t m5 x110 h3f y6c99 ffa9 fs27 fc1 sc0 ls0 ws0">0</div><div class="t m5 xb3 h3f y6c9a ffa9 fs27 fc1 sc0 ls0 ws0">PTE 7</div><div class="t m5 x200 h3f y6c9b ffa9 fs27 fc1 sc0 ls0 ws0">Null</div><div class="t m5 xb5 h3f y6c98 ffa9 fs27 fc1 sc0 ls0 ws0">VP 1</div><div class="t m5 xb5 h3f y6c9c ffa9 fs27 fc1 sc0 ls0 ws0">VP 4</div><div class="t m5 xb5 h3f y6c9d ffa9 fs27 fc1 sc0 ls0 ws0">VP 7</div><div class="t m5 xb5 h3f y6c9e ffa9 fs27 fc1 sc0 ls0 ws0">VP 2</div><div class="t m5 xb5 h3f y6c9f ffa9 fs27 fc1 sc0 ls0 ws0">VP 1</div><div class="t m5 xb5 h3f y6ca0 ffa9 fs27 fc1 sc0 ls0 ws0">VP 2</div><div class="t m5 xb5 h3f y6ca1 ffa9 fs27 fc1 sc0 ls0 ws0">VP 3</div><div class="t m5 xb5 h3f y6ca2 ffa9 fs27 fc1 sc0 ls0 ws0">VP 4</div><div class="t m5 xb5 h3f y6ca3 ffa9 fs27 fc1 sc0 ls0 ws0">VP 6</div><div class="t m5 xb5 h3f y6ca4 ffa9 fs27 fc1 sc0 ls0 ws0">VP 7</div><div class="t m5 x200 h3f y6ca5 ffa9 fs27 fc1 sc0 ls0 ws0">Null</div><div class="t m5 x192 h3f y6ca6 ffaa fs27 fc1 sc0 ls0 ws0">Physical page</div><div class="t m5 x9e h3f y6ca7 ffaa fs27 fc1 sc0 ls0 ws0">number or</div><div class="t m5 xdd h3f y6ca8 ffaa fs27 fc1 sc0 ls0 ws0">disk address</div><div class="t m5 xba h3f y6ca9 ffa9 fs27 fc1 sc0 ls0 ws0">Memory-resident</div><div class="t m5 x1d1 h3f y6caa ffa9 fs27 fc1 sc0 ls0 ws0">page table</div><div class="t m5 xe4 h3f y6cab ffa9 fs27 fc1 sc0 ls0 ws0">(DRAM)</div><div class="t m5 x54 h3f y6cac ffa9 fs27 fc1 sc0 ls0 ws0">Virtual memory</div><div class="t m5 x16a h3f y6cad ffa9 fs27 fc1 sc0 ls0 ws0">(disk)</div><div class="t m5 xf2 h3f y6cae ffa9 fs27 fc1 sc0 ls0 ws0">Physical memory</div><div class="t m5 xb6 h3f y6caf ffa9 fs27 fc1 sc0 ls0 ws0">(DRAM)</div><div class="t m5 x1b2 h3f y6cb0 ffaa fs27 fc1 sc0 ls0 ws0">V<span class="_ _1"></span>alid</div><div class="t m5 x17 h26 y54af ff7 fs19 fc1 sc0 ls0 ws0">where<span class="_"> </span>the<span class="_"> </span>virtual<span class="_"> </span>page<span class="_"> </span>is<span class="_"> </span>stored<span class="_"> </span>on<span class="_ _11"> </span>disk,<span class="_"> </span>select<span class="_"> </span>a<span class="_"> </span>victim<span class="_"> </span>page<span class="_"> </span>in<span class="_ _11"> </span>physical<span class="_"> </span>memory<span class="_ _3"></span>,</div><div class="t m5 x17 h26 y6cb1 ff7 fs19 fc1 sc0 ls0 ws0">and<span class="_"> </span>copy<span class="_"> </span>the<span class="_"> </span>virtual<span class="_"> </span>page<span class="_"> </span>from<span class="_"> </span>disk<span class="_"> </span>to<span class="_"> </span>DRAM,<span class="_"> </span>replacing<span class="_"> </span>the<span class="_"> </span>victim<span class="_"> </span>page<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y6cb2 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>hese<span class="_ _14"> </span>capabilities<span class="_ _16"> </span>are<span class="_ _14"> </span>provided<span class="_ _16"> </span>by<span class="_ _14"> </span>a<span class="_ _16"> </span>combination<span class="_ _14"> </span>of<span class="_ _14"> </span>operating<span class="_ _16"> </span>system<span class="_ _14"> </span>soft-</div><div class="t m5 x17 h26 y6cb3 ff7 fs19 fc1 sc0 ls0 ws0">ware<span class="_ _1"></span>,<span class="_ _13"> </span>address<span class="_ _13"> </span>translation<span class="_ _13"> </span>hardware<span class="_ _13"> </span>in<span class="_ _6"> </span>the<span class="_ _13"> </span>MMU<span class="_ _13"> </span>(memory<span class="_ _6"> </span>management<span class="_ _13"> </span>unit),<span class="_ _13"> </span>and</div><div class="t m5 x17 h26 y6cb4 ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_ _11"> </span>data<span class="_ _11"> </span>structure<span class="_ _16"> </span>stored<span class="_ _11"> </span>in<span class="_ _11"> </span>physical<span class="_ _16"> </span>memory<span class="_"> </span>known<span class="_ _16"> </span>as<span class="_ _11"> </span>a<span class="_ _11"> </span><span class="ffa">page<span class="_ _11"> </span>table<span class="_ _16"> </span></span>that<span class="_ _11"> </span>maps<span class="_ _11"> </span>vir<span class="_ _1"></span>-</div><div class="t m5 x17 h26 y6cb5 ff7 fs19 fc1 sc0 ls0 ws0">tual<span class="_ _6"> </span>pages<span class="_ _13"> </span>to<span class="_ _a"> </span>physical<span class="_ _13"> </span>pages<span class="_ _3"></span>.<span class="_ _13"> </span>T<span class="_ _3"></span>he<span class="_ _13"> </span>address<span class="_ _6"> </span>translation<span class="_ _6"> </span>hardware<span class="_ _13"> </span>reads<span class="_ _a"> </span>the<span class="_ _13"> </span>page<span class="_ _a"> </span>table</div><div class="t m5 x17 h26 y6cb6 ff7 fs19 fc1 sc0 ls0 ws0">each<span class="_ _13"> </span>time<span class="_"> </span>it<span class="_ _13"> </span>converts<span class="_ _13"> </span>a<span class="_"> </span>virtual<span class="_ _13"> </span>address<span class="_ _13"> </span>to<span class="_"> </span>a<span class="_ _13"> </span>physical<span class="_ _13"> </span>address<span class="_ _1"></span>.<span class="_"> </span>T<span class="_ _1"></span>he<span class="_ _13"> </span>operating<span class="_"> </span>system</div><div class="t m5 x17 h26 y6cb7 ff7 fs19 fc1 sc0 ls0 ws0">is<span class="_ _6"> </span>responsible<span class="_ _13"> </span>for<span class="_ _6"> </span>maintaining<span class="_ _6"> </span>the<span class="_ _13"> </span>contents<span class="_ _6"> </span>of<span class="_ _6"> </span>the<span class="_ _13"> </span>page<span class="_ _6"> </span>table<span class="_ _6"> </span>and<span class="_ _13"> </span>transferring<span class="_ _6"> </span>pages</div><div class="t m5 x17 h26 y6cb8 ff7 fs19 fc1 sc0 ls0 ws0">back<span class="_"> </span>and<span class="_"> </span>forth<span class="_"> </span>between<span class="_"> </span>disk<span class="_"> </span>and<span class="_"> </span>DRAM.</div><div class="t m5 x26 h26 y6cb9 ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_ _13"> </span>9.4<span class="_ _a"> </span>shows<span class="_ _13"> </span>the<span class="_ _6"> </span>basic<span class="_ _6"> </span>organization<span class="_ _6"> </span>of<span class="_ _13"> </span>a<span class="_ _6"> </span>page<span class="_ _6"> </span>table<span class="_ _0"></span>.<span class="_ _6"> </span>A<span class="_ _13"> </span>page<span class="_ _a"> </span>table<span class="_ _13"> </span>is<span class="_ _a"> </span>an<span class="_ _13"> </span>array</div><div class="t m5 x17 h26 y6cba ff7 fs19 fc1 sc0 ls0 ws0">of<span class="_"> </span><span class="ffa">page<span class="_"> </span>table<span class="_ _11"> </span>entries<span class="_"> </span>(PTEs)<span class="_ _1"></span><span class="ff7">.<span class="_"> </span>Each<span class="_"> </span>page<span class="_ _11"> </span>in<span class="_"> </span>the<span class="_"> </span>virtual<span class="_ _11"> </span>address<span class="_"> </span>space<span class="_"> </span>has<span class="_ _11"> </span>a<span class="_"> </span>PTE<span class="_"> </span>at</span></span></div><div class="t m5 x17 h26 y6cbb ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_ _11"> </span>ﬁxed<span class="_ _11"> </span>offset<span class="_ _16"> </span>in<span class="_ _11"> </span>the<span class="_ _11"> </span>page<span class="_ _16"> </span>table<span class="_ _1"></span>.<span class="_ _16"> </span>F<span class="_ _3"></span>or<span class="_ _16"> </span>our<span class="_ _11"> </span>purposes<span class="_ _1"></span>,<span class="_ _16"> </span>we<span class="_ _11"> </span>will<span class="_ _11"> </span>assume<span class="_ _11"> </span>that<span class="_ _16"> </span>each<span class="_ _11"> </span>PTE</div><div class="t m5 x17 h26 y6cbc ff7 fs19 fc1 sc0 ls0 ws0">consists<span class="_ _16"> </span>of<span class="_ _11"> </span>a<span class="_ _16"> </span><span class="ffa">valid<span class="_ _16"> </span>bit<span class="_ _15"> </span></span>and<span class="_ _16"> </span>an<span class="_ _11"> </span><span class="ff11">n</span>-bit<span class="_ _16"> </span>address<span class="_ _16"> </span>ﬁeld.<span class="_ _16"> </span>T<span class="_ _1"></span>he<span class="_ _16"> </span>valid<span class="_ _16"> </span>bit<span class="_ _16"> </span>indicates<span class="_ _16"> </span>whether</div><div class="t m5 x17 h26 y6cbd ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _11"> </span>virtual<span class="_ _11"> </span>page<span class="_ _11"> </span>is<span class="_ _11"> </span>currently<span class="_ _16"> </span>cached<span class="_"> </span>in<span class="_ _16"> </span>DRAM.<span class="_"> </span>If<span class="_ _16"> </span>the<span class="_"> </span>valid<span class="_ _16"> </span>bit<span class="_"> </span>is<span class="_ _11"> </span>set,<span class="_ _16"> </span>the<span class="_ _11"> </span>address</div><div class="t m5 x17 h26 y6cbe ff7 fs19 fc1 sc0 ls0 ws0">ﬁeld<span class="_ _11"> </span>indicates<span class="_ _11"> </span>the<span class="_ _11"> </span>start<span class="_ _16"> </span>of<span class="_"> </span>the<span class="_ _16"> </span>corresponding<span class="_"> </span>physical<span class="_ _16"> </span>page<span class="_"> </span>in<span class="_ _16"> </span>DRAM<span class="_"> </span>where<span class="_ _16"> </span>the</div><div class="t m5 x17 h26 y6cbf ff7 fs19 fc1 sc0 ls0 ws0">virtual<span class="_"> </span>page<span class="_"> </span>is<span class="_"> </span>cached.<span class="_"> </span>If<span class="_"> </span>the<span class="_"> </span>valid<span class="_ _11"> </span>bit<span class="_"> </span>is<span class="_"> </span>not<span class="_"> </span>set,<span class="_"> </span>then<span class="_"> </span>a<span class="_ _11"> </span>null<span class="_"> </span>address<span class="_"> </span>indicates<span class="_"> </span>that</div><div class="t m5 x17 h26 y6cc0 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_ _11"> </span>virtual<span class="_ _11"> </span>page<span class="_ _11"> </span>has<span class="_ _11"> </span>not<span class="_ _11"> </span>yet<span class="_ _16"> </span>been<span class="_"> </span>allocated.<span class="_ _11"> </span>Otherwise,<span class="_ _11"> </span>the<span class="_ _11"> </span>address<span class="_ _11"> </span>points<span class="_ _11"> </span>to<span class="_ _11"> </span>the</div><div class="t m5 x17 h26 y6cc1 ff7 fs19 fc1 sc0 ls0 ws0">start<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>virtual<span class="_"> </span>page<span class="_"> </span>on<span class="_"> </span>disk.</div><div class="t m5 x26 h26 y6cc2 ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>he<span class="_ _11"> </span>example<span class="_ _11"> </span>in<span class="_ _11"> </span>F<span class="_ _0"></span>igure<span class="_"> </span>9.4<span class="_ _11"> </span>shows<span class="_ _11"> </span>a<span class="_ _11"> </span>page<span class="_ _11"> </span>table<span class="_ _11"> </span>for<span class="_ _11"> </span>a<span class="_ _11"> </span>system<span class="_"> </span>with<span class="_ _11"> </span>eight<span class="_ _11"> </span>virtual</div><div class="t m5 x17 h26 y6cc3 ff7 fs19 fc1 sc0 ls0 ws0">pages<span class="_ _11"> </span>and<span class="_ _16"> </span>four<span class="_ _11"> </span>physical<span class="_ _16"> </span>pages<span class="_ _1"></span>.<span class="_ _11"> </span>F<span class="_ _1"></span>our<span class="_ _16"> </span>virtual<span class="_ _11"> </span>pages<span class="_ _16"> </span>(VP<span class="_ _11"> </span>1,<span class="_ _16"> </span>VP<span class="_ _11"> </span>2,<span class="_ _16"> </span>VP<span class="_ _16"> </span>4,<span class="_ _11"> </span>and<span class="_ _16"> </span>VP<span class="_ _11"> </span>7)</div><div class="t m5 x17 h26 y6cc4 ff7 fs19 fc1 sc0 ls0 ws0">are<span class="_ _16"> </span>currently<span class="_ _11"> </span>cached<span class="_ _16"> </span>in<span class="_ _16"> </span>DRAM.<span class="_ _16"> </span>T<span class="_ _7"></span>wo<span class="_ _16"> </span>pages<span class="_ _11"> </span>(VP<span class="_ _16"> </span>0<span class="_ _16"> </span>and<span class="_ _16"> </span>VP<span class="_ _16"> </span>5)<span class="_ _11"> </span>have<span class="_ _16"> </span>not<span class="_ _16"> </span>yet<span class="_ _16"> </span>been</div><div class="t m5 x17 h26 y6cc5 ff7 fs19 fc1 sc0 ls0 ws0">allocated,<span class="_"> </span>and<span class="_ _13"> </span>the<span class="_"> </span>rest<span class="_"> </span>(VP<span class="_ _13"> </span>3<span class="_"> </span>and<span class="_"> </span>VP<span class="_ _13"> </span>6)<span class="_"> </span>have<span class="_ _13"> </span>been<span class="_"> </span>allocated<span class="_"> </span>but<span class="_ _13"> </span>are<span class="_"> </span>not<span class="_"> </span>currently</div><div class="t m5 x17 h26 y6cc6 ff7 fs19 fc1 sc0 ls0 ws0">cached.<span class="_ _13"> </span>An<span class="_"> </span>important<span class="_ _13"> </span>point<span class="_ _13"> </span>to<span class="_"> </span>notice<span class="_ _13"> </span>about<span class="_ _13"> </span>Figure<span class="_ _13"> </span>9.4<span class="_ _13"> </span>is<span class="_"> </span>that<span class="_ _13"> </span>because<span class="_ _13"> </span>the<span class="_"> </span>DRAM</div><div class="t m5 x17 h26 y6cc7 ff7 fs19 fc1 sc0 ls0 ws0">cache<span class="_"> </span>is<span class="_"> </span>fully<span class="_"> </span>associative<span class="_ _1"></span>,<span class="_"> </span>any<span class="_"> </span>physical<span class="_"> </span>page<span class="_"> </span>can<span class="_"> </span>contain<span class="_"> </span>any<span class="_"> </span>virtual<span class="_"> </span>page.</div><div class="t m5 x17 h47 y9b8 ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>9.2<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>917)</span></div><div class="t m5 x17 h26 y8d6 ff7 fs19 fc1 sc0 ls0 ws0">Determine<span class="_ _f"> </span>the<span class="_ _f"> </span>number<span class="_ _f"> </span>of<span class="_ _f"> </span>page<span class="_ _f"> </span>table<span class="_ _f"> </span>entries<span class="_ _f"> </span>(PTEs)<span class="_ _f"> </span>that<span class="_ _f"> </span>are<span class="_ _f"> </span>needed<span class="_ _f"> </span>for<span class="_ _f"> </span>the</div><div class="t m5 x17 h26 y8d7 ff7 fs19 fc1 sc0 ls0 ws0">following<span class="_"> </span>combinations<span class="_"> </span>of<span class="_"> </span>virtual<span class="_"> </span>address<span class="_"> </span>size<span class="_"> </span>(<span class="ff11">n</span>)<span class="_"> </span>and<span class="_"> </span>page<span class="_"> </span>size<span class="_"> </span>(<span class="ff11">P<span class="_ _6"> </span></span>):</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
