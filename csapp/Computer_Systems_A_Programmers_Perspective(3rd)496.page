<div id="pf1f0" class="pf w2 h11" data-page-no="1f0"><div class="pc pc1f0 w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg1f0.png"/><div class="t m5 x13d h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>4.5<span class="_ _60"> </span>Pipelined<span class="_ _10"> </span>Y86-64<span class="_ _10"> </span>Implementations<span class="_ _3e"> </span><span class="ffe fs1e">495</span></div><div class="t m5 x17 h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">instruction<span class="_"> </span>is<span class="_"> </span>in<span class="_"> </span>the<span class="_ _11"> </span>execute<span class="_"> </span>stage<span class="_ _0"></span>,<span class="_"> </span>so<span class="_"> </span>that<span class="_"> </span>it<span class="_ _11"> </span>can<span class="_"> </span>set<span class="_"> </span>up<span class="_ _11"> </span>the<span class="_"> </span>conditions<span class="_"> </span>required<span class="_"> </span>to</div><div class="t m5 x17 h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">recover<span class="_ _6"> </span>from<span class="_ _6"> </span>the<span class="_ _13"> </span>misprediction<span class="_ _a"> </span>as<span class="_ _13"> </span>the<span class="_ _a"> </span>instruction<span class="_ _13"> </span>enters<span class="_ _a"> </span>the<span class="_ _13"> </span>memory<span class="_ _a"> </span>stage.<span class="_ _a"> </span>When<span class="_ _6"> </span>a</div><div class="t m5 x17 h26 y2a8 ff7 fs19 fc2 sc0 ls0 ws0">jump<span class="_ _13"> </span>instruction<span class="_ _13"> </span>is<span class="_ _13"> </span>in<span class="_"> </span>the<span class="_ _13"> </span>execute<span class="_ _13"> </span>stage<span class="_ _1"></span>,<span class="_"> </span>the<span class="_ _13"> </span>signal<span class="_ _13"> </span><span class="ff6">e_Cnd<span class="_ _13"> </span></span>indicates<span class="_ _13"> </span>whether<span class="_ _13"> </span>or<span class="_"> </span>not</div><div class="t m5 x17 h26 y2f7 ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_ _11"> </span>jump<span class="_ _16"> </span>should<span class="_ _16"> </span>be<span class="_ _11"> </span>taken.<span class="_ _16"> </span>W<span class="_ _3"></span>e<span class="_ _16"> </span>detect<span class="_ _16"> </span>an<span class="_ _11"> </span>excepting<span class="_ _16"> </span>instruction<span class="_ _16"> </span>by<span class="_ _11"> </span>examining<span class="_ _16"> </span>the</div><div class="t m5 x17 h26 y2f8 ff7 fs19 fc2 sc0 ls0 ws0">instruction<span class="_ _16"> </span>status<span class="_ _16"> </span>values<span class="_ _16"> </span>in<span class="_ _14"> </span>the<span class="_ _16"> </span>memory<span class="_ _16"> </span>and<span class="_ _16"> </span>write-back<span class="_ _14"> </span>stages<span class="_ _1"></span>.<span class="_ _16"> </span>F<span class="_ _1"></span>or<span class="_ _16"> </span>the<span class="_ _16"> </span>memory</div><div class="t m5 x17 h26 y2f9 ff7 fs19 fc2 sc0 ls0 ws0">stage<span class="_ _1"></span>,<span class="_ _15"> </span>we<span class="_ _16"> </span>use<span class="_ _14"> </span>the<span class="_ _14"> </span>signal<span class="_ _16"> </span><span class="ff6">m_stat</span>,<span class="_ _15"> </span>computed<span class="_ _14"> </span>within<span class="_ _16"> </span>the<span class="_ _14"> </span>stage<span class="_ _0"></span>,<span class="_ _14"> </span>rather<span class="_ _14"> </span>than<span class="_ _16"> </span><span class="ff6">M_stat</span></div><div class="t m5 x17 h26 y2fa ff7 fs19 fc2 sc0 ls0 ws0">from<span class="_ _14"> </span>the<span class="_ _14"> </span>pipeline<span class="_ _15"> </span>register.<span class="_ _14"> </span>T<span class="_ _1"></span>his<span class="_ _15"> </span>internal<span class="_ _14"> </span>signal<span class="_ _15"> </span>incorporates<span class="_ _14"> </span>the<span class="_ _14"> </span>possibility<span class="_ _15"> </span>of<span class="_ _14"> </span>a</div><div class="t m5 x17 h26 y2fb ff7 fs19 fc2 sc0 ls0 ws0">data<span class="_"> </span>memory<span class="_"> </span>address<span class="_"> </span>error.</div><div class="t m5 x17 h42 y451c ff6 fs29 fc6 sc0 ls0 ws0">Pipeline<span class="_ _11"> </span>Control<span class="_ _16"> </span>Mechanisms</div><div class="t m5 x17 h26 y451d ff7 fs19 fc1 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_ _16"> </span>4.65<span class="_ _16"> </span>shows<span class="_ _16"> </span>low-level<span class="_ _16"> </span>mechanisms<span class="_ _16"> </span>that<span class="_ _16"> </span>allow<span class="_ _11"> </span>the<span class="_ _16"> </span>pipeline<span class="_ _16"> </span>control<span class="_ _16"> </span>logic<span class="_ _16"> </span>to</div><div class="t m5 x17 h26 y451e ff7 fs19 fc1 sc0 ls0 ws0">hold<span class="_ _6"> </span>back<span class="_ _6"> </span>an<span class="_ _13"> </span>instruction<span class="_ _a"> </span>in<span class="_ _6"> </span>a<span class="_ _13"> </span>pipeline<span class="_ _a"> </span>register<span class="_ _13"> </span>or<span class="_ _a"> </span>to<span class="_ _13"> </span>inject<span class="_ _a"> </span>a<span class="_ _6"> </span>bubble<span class="_ _13"> </span>into<span class="_ _a"> </span>the<span class="_ _13"> </span>pipeline<span class="_ _1"></span>.</div><div class="t m5 x17 h26 y451f ff7 fs19 fc1 sc0 ls0 ws0">T<span class="_ _1"></span>hese<span class="_ _13"> </span>mechanisms<span class="_ _6"> </span>involve<span class="_ _13"> </span>small<span class="_ _6"> </span>extensions<span class="_ _13"> </span>to<span class="_ _6"> </span>the<span class="_ _6"> </span>basic<span class="_ _13"> </span>clocked<span class="_ _6"> </span>register<span class="_ _13"> </span>described</div><div class="t m5 x30 h4c y4520 ff50 fs2d fc1 sc0 ls0 ws0">x<span class="_ _1d3"> </span>y</div><div class="t m5 x30 h4c y4521 ff50 fs2d fc1 sc0 ls0 ws0">x</div><div class="t m5 x30 h4c y4522 ff50 fs2d fc1 sc0 ls0 ws0">x</div><div class="t m5 x12d h4c y4523 ff50 fs2d fc1 sc0 ls0 ws0">n</div><div class="t m5 x12d h4c y4522 ff50 fs2d fc1 sc0 ls0 ws0">o</div><div class="t m5 x12d h4c y4524 ff50 fs2d fc1 sc0 ls0 ws0">p</div><div class="t m5 x12d h4c y4521 ff50 fs2d fc1 sc0 ls0 ws0">x</div><div class="t m5 x73 h4c y4525 ff50 fs2d fc1 sc0 ls0 ws0">State = x</div><div class="t m5 x17 hca y4526 ff50 fs7e fc1 sc0 ls0 ws0">(a) Normal</div><div class="t m5 xa1 h4c y4527 ff50 fs2d fc1 sc0 ls0 ws0">State = y</div><div class="t m5 x17 h4c y4528 ff50 fs2d fc1 sc0 ls0 ws0">Input = y</div><div class="t m5 x22d h4c y4529 ff50 fs2d fc1 sc0 ls0 ws0">stall</div><div class="t m5 x52 h4c y452a ff50 fs2d fc1 sc0 ls0 ws0">= 0</div><div class="t m5 x1c5 h4c y4529 ff50 fs2d fc1 sc0 ls0 ws0">bubble</div><div class="t m5 x1d h4c y452a ff50 fs2d fc1 sc0 ls0 ws0">= 0</div><div class="t m5 x1ef h4c y452b ff50 fs2d fc1 sc0 ls0 ws0">Output = x</div><div class="t m5 x18b h4c y452c ff50 fs2d fc1 sc0 ls0 ws0">Output = y</div><div class="t m5 xdc h4c y452d ff50 fs2d fc1 sc0 ls0 ws0">Rising</div><div class="t m5 x167 h4c y452e ff50 fs2d fc1 sc0 ls0 ws0">clock</div><div class="t m5 x73 h4c y452f ff50 fs2d fc1 sc0 ls0 ws0">State = x</div><div class="t m5 x17 hca y4530 ff50 fs7e fc1 sc0 ls0 ws0">(b) Stall</div><div class="t m5 xa1 h4c y4531 ff50 fs2d fc1 sc0 ls0 ws0">State = x</div><div class="t m5 x17 h4c y4532 ff50 fs2d fc1 sc0 ls0 ws0">Input = y</div><div class="t m5 x22d h4c y4533 ff50 fs2d fc1 sc0 ls0 ws0">stall</div><div class="t m5 x52 h4c y4534 ff50 fs2d fc1 sc0 ls0 ws0">= 1</div><div class="t m5 x1c5 h4c y4533 ff50 fs2d fc1 sc0 ls0 ws0">bubble</div><div class="t m5 x1d h4c y4534 ff50 fs2d fc1 sc0 ls0 ws0">= 0</div><div class="t m5 x1ef h4c y4535 ff50 fs2d fc1 sc0 ls0 ws0">Output = x</div><div class="t m5 x18b h4c y4536 ff50 fs2d fc1 sc0 ls0 ws0">Output = x</div><div class="t m5 xdc h4c y4537 ff50 fs2d fc1 sc0 ls0 ws0">Rising</div><div class="t m5 x167 h4c y4538 ff50 fs2d fc1 sc0 ls0 ws0">clock</div><div class="t m5 x73 h4c y4539 ff50 fs2d fc1 sc0 ls0 ws0">State = x</div><div class="t m5 x17 hca y453a ff50 fs7e fc1 sc0 ls0 ws0">(c) Bubble</div><div class="t m5 x1db hcb y453b ff50 fs2d fc1 sc0 ls0 ws0">State = <span class="ff4a fs7f">nop</span></div><div class="t m5 x17 h4c y453c ff50 fs2d fc1 sc0 ls0 ws0">Input = y</div><div class="t m5 x22d h4c y453d ff50 fs2d fc1 sc0 ls0 ws0">stall</div><div class="t m5 x52 h4c y453e ff50 fs2d fc1 sc0 ls0 ws0">= 0</div><div class="t m5 x1c5 h4c y453d ff50 fs2d fc1 sc0 ls0 ws0">bubble</div><div class="t m5 x1d h4c y453e ff50 fs2d fc1 sc0 ls0 ws0">= 1</div><div class="t m5 x1ef h4c y453f ff50 fs2d fc1 sc0 ls0 ws0">Output = x</div><div class="t m5 xf9 h4c y4540 ff50 fs2d fc1 sc0 ls0 ws0">Output = </div><div class="t m5 x22f hcb y4541 ff4a fs7f fc1 sc0 ls0 ws0">nop</div><div class="t m5 xdc h4c y4542 ff50 fs2d fc1 sc0 ls0 ws0">Rising</div><div class="t m5 x167 h4c y4543 ff50 fs2d fc1 sc0 ls0 ws0">clock</div><div class="t m5 x17 h34 y4544 ffe fs16 fc6 sc0 ls0 ws0">Figure<span class="_ _16"> </span>4.65<span class="_ _c"> </span><span class="fc1">Additional<span class="_ _16"> </span>pipeline<span class="_ _16"> </span>register<span class="_ _16"> </span>operations.<span class="_ _16"> </span><span class="ff6">(a)<span class="_ _16"> </span>Under<span class="_ _16"> </span>normal<span class="_ _16"> </span>conditions,</span></span></div><div class="t m5 x17 h34 y4545 ff6 fs16 fc1 sc0 ls0 ws0">the<span class="_ _10"> </span>state<span class="_ _13"> </span>and<span class="_ _10"> </span>output<span class="_ _10"> </span>of<span class="_ _10"> </span>the<span class="_ _10"> </span>register<span class="_ _13"> </span>are<span class="_ _10"> </span>set<span class="_ _10"> </span>to<span class="_ _10"> </span>the<span class="_ _13"> </span>value<span class="_ _10"> </span>at<span class="_ _10"> </span>the<span class="_ _10"> </span>input<span class="_ _10"> </span>when<span class="_ _13"> </span>the<span class="_ _10"> </span>clock<span class="_ _10"> </span>rises.</div><div class="t m5 x17 h34 y4546 ff6 fs16 fc1 sc0 ls0 ws0">(b)<span class="_ _11"> </span>When<span class="_ _11"> </span>operated<span class="_ _11"> </span>in<span class="_ _11"> </span><span class="ffb">stall<span class="_ _15"> </span></span>mode,<span class="_ _11"> </span>the<span class="_ _11"> </span>state<span class="_ _11"> </span>is<span class="_ _11"> </span>held<span class="_ _11"> </span>ﬁxed<span class="_ _11"> </span>at<span class="_ _16"> </span>its<span class="_ _10"> </span>previous<span class="_ _16"> </span>value.<span class="_ _10"> </span>(c)<span class="_ _16"> </span>When</div><div class="t m5 x17 h34 y4547 ff6 fs16 fc1 sc0 ls0 ws0">operated<span class="_ _10"> </span>in<span class="_ _11"> </span><span class="ffb">bubble<span class="_ _11"> </span></span>mode,<span class="_ _11"> </span>the<span class="_ _10"> </span>state<span class="_ _11"> </span>is<span class="_ _10"> </span>over<span class="_ _2"></span>written<span class="_ _10"> </span>with<span class="_ _10"> </span>that<span class="_ _11"> </span>of<span class="_ _10"> </span>a</div><div class="t m5 x24f h3a y4548 ffd fs19 fc1 sc0 ls0 ws0">nop<span class="_ _10"> </span><span class="ff6 fs16">operation.</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
