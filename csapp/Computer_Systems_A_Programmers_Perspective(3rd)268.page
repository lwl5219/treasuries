<div id="pf10c" class="pf w2 h11" data-page-no="10c"><div class="pc pc10c w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg10c.png"/><div class="t m5 x1dc h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>3.6<span class="_ _60"> </span>Control<span class="_ _3e"> </span><span class="ffe fs1e">267</span></div><div class="t m5 x26 h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">Indeed,<span class="_ _e"> </span>a<span class="_ _21"> </span>close<span class="_ _e"> </span>examination<span class="_ _21"> </span>of<span class="_ _f"> </span>the<span class="_ _f"> </span>assembly<span class="_ _f"> </span>code<span class="_ _f"> </span>produced<span class="_ _f"> </span>by<span class="_ _f"> </span><span class="ff9">gcc<span class="_ _f"> </span></span>with</div><div class="t m5 x17 h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">command-line<span class="_"> </span>option<span class="_"> </span><span class="ffd">-Og<span class="_ _10"> </span></span>closely<span class="_"> </span>follows<span class="_"> </span>this<span class="_"> </span>template:</div><div class="t m5 xee h61 y2802 ff13 fs35 fc6 sc0 ls0 ws0">long<span class="_ _f"> </span>fact_for(long<span class="_ _f"> </span>n)</div><div class="t m5 xee h61 y2803 ff13 fs35 fc6 sc0 ls0 ws0">n<span class="_ _f"> </span>in<span class="_ _f"> </span>%rdi</div><div class="t m5 x17 h2d y2804 ffd fs1e fc2 sc0 ls0 ws0">fact_for:</div><div class="t m5 x72 h2d y2805 ffd fs1e fc2 sc0 ls0 ws0">movl<span class="_ _46"> </span>$1,<span class="_ _e"> </span>%eax</div><div class="t m5 x7c h61 y2806 ff13 fs35 fc6 sc0 ls0 ws0">Set<span class="_ _f"> </span>result<span class="_ _f"> </span>=<span class="_ _f"> </span>1</div><div class="t m5 x72 h2d y2807 ffd fs1e fc2 sc0 ls0 ws0">movl<span class="_ _46"> </span>$2,<span class="_ _e"> </span>%edx<span class="_ _88"> </span><span class="ff13 fs35 fc6 ls156">S<span class="_ _8a"></span>e<span class="_ _8a"></span>ti=2</span></div><div class="t m5 x72 h2d y2808 ffd fs1e fc2 sc0 ls0 ws0">jmp<span class="_ _8c"> </span>.L8<span class="_ _12b"> </span><span class="ff13 fs35 fc6">Goto<span class="_ _f"> </span><span class="ff2d">test</span></span></div><div class="t m5 x17 h2d y2809 ffd fs1e fc2 sc0 ls0 ws0">.L9:<span class="_ _151"> </span><span class="ff2d fs35 fc6">loop:</span></div><div class="t m5 x72 h2d y280a ffd fs1e fc2 sc0 ls0 ws0">imulq<span class="_ _3f"> </span>%rdx,<span class="_ _e"> </span>%rax<span class="_ _93"> </span><span class="ff13 fs35 fc6">Compute<span class="_ _e"> </span>result<span class="_ _21"> </span>*=<span class="_ _f"> </span>i</span></div><div class="t m5 x72 h2d y280b ffd fs1e fc2 sc0 ls0 ws0">addq<span class="_ _46"> </span>$1,<span class="_ _e"> </span>%rdx<span class="_ _88"> </span><span class="ff13 fs35 fc6">Increment<span class="_ _21"> </span>i</span></div><div class="t m5 x17 h2d y280c ffd fs1e fc2 sc0 ls0 ws0">.L8:<span class="_ _151"> </span><span class="ff2d fs35 fc6">test:</span></div><div class="t m5 x72 h2d y280d ffd fs1e fc2 sc0 ls0 ws0">cmpq<span class="_ _46"> </span>%rdi,<span class="_ _e"> </span>%rdx<span class="_ _93"> </span><span class="ff13 fs35 fc6">Compare<span class="_ _e"> </span>i:n</span></div><div class="t m5 x72 h2d y280e ffd fs1e fc2 sc0 ls0 ws0">jle<span class="_ _8c"> </span>.L9<span class="_ _12b"> </span><span class="ff13 fs35 fc6">If<span class="_ _f"> </span>&lt;=,<span class="_ _f"> </span>goto<span class="_ _e"> </span><span class="ff2d">loop</span></span></div><div class="t m5 x72 h2d y280f ffd fs1e fc2 sc0 ls0 ws0">rep;<span class="_ _e"> </span>ret<span class="_ _c1"> </span><span class="ff13 fs35 fc6">Return</span></div><div class="t m5 x17 h47 y2810 ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>3.27<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>372)</span></div><div class="t m5 x17 h26 y2811 ff7 fs19 fc1 sc0 ls0 ws0">Write<span class="_ _13"> </span>goto<span class="_"> </span>code<span class="_ _13"> </span>for<span class="_"> </span>a<span class="_ _13"> </span>function<span class="_"> </span>called<span class="_ _13"> </span><span class="ffd">fibonacci<span class="_ _10"> </span></span>to<span class="_ _13"> </span>print<span class="_"> </span>ﬁbonacci<span class="_ _13"> </span>numbers<span class="_"> </span>using</div><div class="t m5 x17 h26 y2812 ff7 fs19 fc1 sc0 ls0 ws0">a<span class="_"> </span><span class="ffd">while<span class="_ _10"> </span></span>loop<span class="_ _1"></span>.<span class="_"> </span>Apply<span class="_"> </span>the<span class="_"> </span>guarded-do<span class="_"> </span>transformation.</div><div class="t m5 x26 h26 y2813 ff7 fs19 fc1 sc0 ls0 ws0">W<span class="_ _3"></span>e<span class="_ _16"> </span>see<span class="_ _11"> </span>from<span class="_ _11"> </span>this<span class="_ _16"> </span>presentation<span class="_ _11"> </span>that<span class="_ _11"> </span>all<span class="_ _16"> </span>three<span class="_ _11"> </span>forms<span class="_ _11"> </span>of<span class="_ _16"> </span>loops<span class="_ _11"> </span>in<span class="_ _11"> </span>C—<span class="ffd">do</span>-<span class="ffd">while</span>,</div><div class="t m5 x17 h26 y2814 ffd fs19 fc1 sc0 ls0 ws0">while<span class="ff7">,<span class="_ _13"> </span>and<span class="_"> </span></span>for<span class="ff7">—can<span class="_ _13"> </span>be<span class="_ _13"> </span>translated<span class="_ _13"> </span>by<span class="_"> </span>a<span class="_ _13"> </span>simple<span class="_ _13"> </span>strategy<span class="_ _3"></span>,<span class="_"> </span>generating<span class="_ _13"> </span>code<span class="_ _13"> </span>that<span class="_ _13"> </span>con-</span></div><div class="t m5 x17 h26 y2815 ff7 fs19 fc1 sc0 ls0 ws0">tains<span class="_"> </span>one<span class="_ _11"> </span>or<span class="_"> </span>more<span class="_ _11"> </span>conditional<span class="_"> </span>branches<span class="_ _0"></span>.<span class="_"> </span>Conditional<span class="_ _11"> </span>transfer<span class="_"> </span>of<span class="_ _11"> </span>control<span class="_"> </span>provides</div><div class="t m5 x17 h26 y2816 ff7 fs19 fc1 sc0 ls0 ws0">the<span class="_"> </span>basic<span class="_"> </span>mechanism<span class="_"> </span>for<span class="_"> </span>translating<span class="_"> </span>loops<span class="_"> </span>into<span class="_"> </span>machine<span class="_"> </span>code<span class="_ _1"></span>.</div><div class="t m5 x17 h47 y2817 ffe fs2b fc1 sc0 ls0 ws0">Practice<span class="_"> </span>Problem<span class="_"> </span>3.28<span class="_ _1f"> </span><span class="fs16">(solution<span class="_"> </span>page<span class="_"> </span>372)</span></div><div class="t m5 x17 h26 y2818 ff7 fs19 fc1 sc0 ls0 ws0">A<span class="_"> </span>function<span class="_"> </span><span class="ffd">test_two<span class="_ _10"> </span></span>has<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>overall<span class="_"> </span>structure:</div><div class="t m5 x17 h2d y2819 ffd fs1e fc2 sc0 ls0 ws0">short<span class="_ _e"> </span>test_two(unsigned<span class="_ _1f"> </span>short<span class="_ _1f"> </span>x)<span class="_ _e"> </span>{</div><div class="t m5 x1b6 h2d y281a ffd fs1e fc2 sc0 ls0 ws0">short<span class="_ _e"> </span>val<span class="_ _1f"> </span>=<span class="_ _1f"> </span>0;</div><div class="t m5 x1b6 h2d y281b ffd fs1e fc2 sc0 ls0 ws0">short<span class="_ _e"> </span>i;</div><div class="t m5 x1b6 h2d y281c ffd fs1e fc2 sc0 ls33 ws0">f<span class="_ _41"></span>o<span class="_ _41"></span>r(.<span class="_ _41"></span>.<span class="_ _41"></span>.;.<span class="_ _41"></span>.<span class="_ _41"></span>.;.<span class="_ _41"></span>.<span class="_ _41"></span>.){</div><div class="t m5 x21e h2d y281d ffd fs1e fc2 sc0 ls0 ws0">.</div><div class="t m5 x21e h2d y281e ffd fs1e fc2 sc0 ls0 ws0">.</div><div class="t m5 x21e h2d y281f ffd fs1e fc2 sc0 ls0 ws0">.</div><div class="t m5 x1b6 h2d y2820 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x1b6 h2d y2821 ffd fs1e fc2 sc0 ls0 ws0">return<span class="_ _e"> </span>val;</div><div class="t m5 x17 h2d y2822 ffd fs1e fc2 sc0 ls0 ws0">}</div><div class="t m5 x26 h26 y2823 ff7 fs19 fc2 sc0 lsd ws0">Th<span class="_ _2"></span>e<span class="_ _11"> </span><span class="ff9 ls0">gcc<span class="_ _10"> </span><span class="ff7">C<span class="_"> </span>compiler<span class="_"> </span>generates<span class="_"> </span>the<span class="_"> </span>following<span class="_"> </span>assembly<span class="_"> </span>code:</span></span></div><div class="t m5 x2e h61 y587 ff13 fs35 fc6 sc0 ls0 ws0">test<span class="_ _f"> </span>fun_b(unsigned<span class="_ _f"> </span>test<span class="_ _f"> </span>x)</div><div class="t m5 x2e h61 y2824 ff13 fs35 fc6 sc0 ls0 ws0">x<span class="_ _f"> </span>in<span class="_ _f"> </span>%rdi</div><div class="t m5 x2c h2d y15bf ff6 fs20 fc6 sc0 ls0 ws0">1<span class="_ _1c"> </span><span class="ffd fs1e fc2">test_two:</span></div><div class="t m5 x2c h2d y1db4 ff6 fs20 fc6 sc0 ls0 ws0">2<span class="_ _45"> </span><span class="ffd fs1e fc2">movl<span class="_ _46"> </span>$1,<span class="_ _e"> </span>%edx</span></div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
