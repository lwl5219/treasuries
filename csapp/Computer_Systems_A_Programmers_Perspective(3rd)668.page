<div id="pf29c" class="pf w2 h11" data-page-no="29c"><div class="pc pc29c w2 h11"><img class="bi x0 y0 w1 h1" alt="" src="csapp/bg29c.png"/><div class="t m5 xf2 h28 y9b ff6 fs1f fc2 sc0 ls0 ws0">Section<span class="_ _10"> </span>6.4<span class="_ _60"> </span>Cache<span class="_ _10"> </span>Memories<span class="_ _3e"> </span><span class="ffe fs1e">667</span></div><div class="t m5 x17 h26 ye7 ff7 fs19 fc2 sc0 ls0 ws0">ably<span class="_ _11"> </span>cache-friendly<span class="_ _11"> </span>programs<span class="_ _1"></span>,<span class="_ _11"> </span>we<span class="_ _11"> </span>suggest<span class="_ _11"> </span>adopting<span class="_ _11"> </span>a<span class="_ _11"> </span>mental<span class="_ _11"> </span>model<span class="_ _11"> </span>that<span class="_ _11"> </span>assumes</div><div class="t m5 x17 h26 y2a7 ff7 fs19 fc2 sc0 ls0 ws0">write-back,<span class="_ _13"> </span>write-allocate<span class="_ _6"> </span>caches<span class="_ _1"></span>.<span class="_ _13"> </span>T<span class="_ _1"></span>here<span class="_ _13"> </span>are<span class="_ _13"> </span>several<span class="_ _6"> </span>reasons<span class="_ _13"> </span>for<span class="_ _6"> </span>this<span class="_ _13"> </span>suggestion:<span class="_ _6"> </span>As</div><div class="t m5 x17 h26 y2a8 ff7 fs19 fc2 sc0 ls0 ws0">a<span class="_ _13"> </span>rule<span class="_ _1"></span>,<span class="_ _13"> </span>caches<span class="_ _13"> </span>at<span class="_ _13"> </span>lower<span class="_ _13"> </span>levels<span class="_ _6"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>memory<span class="_ _13"> </span>hierarchy<span class="_ _13"> </span>are<span class="_ _6"> </span>more<span class="_ _13"> </span>likely<span class="_ _13"> </span>to<span class="_ _13"> </span>use<span class="_ _13"> </span>write-</div><div class="t m5 x17 h26 y2f7 ff7 fs19 fc2 sc0 ls0 ws0">back<span class="_ _11"> </span>instead<span class="_ _11"> </span>of<span class="_ _16"> </span>write-through<span class="_ _11"> </span>because<span class="_ _11"> </span>of<span class="_ _16"> </span>the<span class="_ _11"> </span>larger<span class="_ _11"> </span>transfer<span class="_ _16"> </span>times<span class="_ _3"></span>.<span class="_ _16"> </span>F<span class="_ _1"></span>or<span class="_ _11"> </span>example<span class="_ _0"></span>,</div><div class="t m5 x17 h26 y2f8 ff7 fs19 fc2 sc0 ls0 ws0">virtual<span class="_ _13"> </span>memory<span class="_"> </span>systems<span class="_ _13"> </span>(which<span class="_"> </span>use<span class="_ _13"> </span>main<span class="_ _13"> </span>memory<span class="_"> </span>as<span class="_ _13"> </span>a<span class="_ _13"> </span>cache<span class="_"> </span>for<span class="_ _13"> </span>the<span class="_"> </span>blocks<span class="_ _13"> </span>stored</div><div class="t m5 x17 h26 y2f9 ff7 fs19 fc2 sc0 ls0 ws0">on<span class="_"> </span>disk)<span class="_ _11"> </span>use<span class="_ _11"> </span>write-back<span class="_ _11"> </span>exclusively<span class="_ _3"></span>.<span class="_"> </span>But<span class="_ _11"> </span>as<span class="_ _11"> </span>logic<span class="_"> </span>densities<span class="_ _11"> </span>increase,<span class="_"> </span>the<span class="_"> </span>increased</div><div class="t m5 x17 h26 y2fa ff7 fs19 fc2 sc0 ls0 ws0">complexity<span class="_ _16"> </span>of<span class="_ _14"> </span>write-back<span class="_ _16"> </span>is<span class="_ _14"> </span>becoming<span class="_ _16"> </span>less<span class="_ _14"> </span>of<span class="_ _16"> </span>an<span class="_ _14"> </span>impediment<span class="_ _16"> </span>and<span class="_ _14"> </span>we<span class="_ _16"> </span>are<span class="_ _14"> </span>seeing</div><div class="t m5 x17 h26 y2fb ff7 fs19 fc2 sc0 ls0 ws0">write-back<span class="_ _13"> </span>caches<span class="_ _13"> </span>at<span class="_ _13"> </span>all<span class="_ _13"> </span>levels<span class="_ _13"> </span>of<span class="_ _13"> </span>modern<span class="_ _13"> </span>systems<span class="_ _3"></span>.<span class="_ _13"> </span>So<span class="_ _13"> </span>this<span class="_ _13"> </span>assumption<span class="_ _13"> </span>matches<span class="_ _13"> </span>cur<span class="_ _1"></span>-</div><div class="t m5 x17 h26 y2fc ff7 fs19 fc2 sc0 ls0 ws0">rent<span class="_ _13"> </span>trends<span class="_ _1"></span>.<span class="_"> </span>Another<span class="_ _13"> </span>reason<span class="_ _13"> </span>for<span class="_"> </span>assuming<span class="_ _13"> </span>a<span class="_ _13"> </span>write-back,<span class="_"> </span>write-allocate<span class="_ _13"> </span>approach<span class="_"> </span>is</div><div class="t m5 x17 h26 y2fd ff7 fs19 fc2 sc0 ls0 ws0">that<span class="_ _13"> </span>it<span class="_ _13"> </span>is<span class="_ _13"> </span>symmetric<span class="_"> </span>to<span class="_ _13"> </span>the<span class="_ _13"> </span>way<span class="_ _13"> </span>reads<span class="_ _13"> </span>are<span class="_ _13"> </span>handled,<span class="_"> </span>in<span class="_ _13"> </span>that<span class="_ _13"> </span>write-back<span class="_ _13"> </span>write-allocate</div><div class="t m5 x17 h26 y2fe ff7 fs19 fc2 sc0 ls0 ws0">tries<span class="_ _6"> </span>to<span class="_ _6"> </span>exploit<span class="_ _13"> </span>locality<span class="_ _7"></span>.<span class="_ _6"> </span>Thus<span class="_ _3"></span>,<span class="_ _13"> </span>we<span class="_ _a"> </span>can<span class="_ _13"> </span>develop<span class="_ _a"> </span>our<span class="_ _13"> </span>programs<span class="_ _a"> </span>at<span class="_ _13"> </span>a<span class="_ _a"> </span>high<span class="_ _6"> </span>level<span class="_ _13"> </span>to<span class="_ _a"> </span>exhibit</div><div class="t m5 x17 h26 y2ff ff7 fs19 fc2 sc0 ls0 ws0">good<span class="_"> </span>spatial<span class="_ _11"> </span>and<span class="_ _11"> </span>temporal<span class="_ _11"> </span>locality<span class="_"> </span>rather<span class="_ _11"> </span>than<span class="_ _11"> </span>trying<span class="_ _11"> </span>to<span class="_"> </span>optimize<span class="_ _11"> </span>for<span class="_ _11"> </span>a<span class="_ _11"> </span>particular</div><div class="t m5 x17 h26 y300 ff7 fs19 fc2 sc0 ls0 ws0">memory<span class="_"> </span>system.</div><div class="t m5 x17 h41 y58d3 ffe fs29 fc2 sc0 ls0 ws0">6.4.6<span class="_ _48"> </span><span class="fs19">Anatomy<span class="_"> </span>of<span class="_"> </span>a<span class="_"> </span>Real<span class="_"> </span>Cache<span class="_"> </span>Hierarchy</span></div><div class="t m5 x17 h26 y58d4 ff7 fs19 fc2 sc0 ls0 ws0">So<span class="_"> </span>far,<span class="_"> </span>we<span class="_"> </span>have<span class="_"> </span>assumed<span class="_"> </span>that<span class="_"> </span>caches<span class="_ _11"> </span>hold<span class="_"> </span>only<span class="_"> </span>program<span class="_"> </span>data.<span class="_"> </span>But,<span class="_ _11"> </span>in<span class="_"> </span>fact,<span class="_"> </span>caches</div><div class="t m5 x17 h26 y58d5 ff7 fs19 fc2 sc0 ls0 ws0">can<span class="_ _13"> </span>hold<span class="_"> </span>instructions<span class="_ _13"> </span>as<span class="_"> </span>well<span class="_ _13"> </span>as<span class="_"> </span>data.<span class="_ _13"> </span>A<span class="_ _13"> </span>cache<span class="_"> </span>that<span class="_ _13"> </span>holds<span class="_"> </span>instructions<span class="_ _13"> </span>only<span class="_ _13"> </span>is<span class="_"> </span>called</div><div class="t m5 x17 h26 y58d6 ff7 fs19 fc2 sc0 ls0 ws0">an<span class="_"> </span><span class="ffa">i-cac<span class="_ _1"></span>he<span class="_ _2"></span><span class="ff7">.<span class="_ _13"> </span>A<span class="_"> </span>cache<span class="_ _13"> </span>that<span class="_"> </span>holds<span class="_"> </span>program<span class="_ _13"> </span>data<span class="_"> </span>only<span class="_ _13"> </span>is<span class="_"> </span>called<span class="_ _13"> </span>a<span class="_"> </span></span>d-cache<span class="ff7">.<span class="_ _13"> </span>A<span class="_"> </span>cache<span class="_ _13"> </span>that</span></span></div><div class="t m5 x17 h26 y58d7 ff7 fs19 fc2 sc0 ls0 ws0">holds<span class="_"> </span>both<span class="_ _11"> </span>instructions<span class="_ _11"> </span>and<span class="_ _11"> </span>data<span class="_ _11"> </span>is<span class="_ _11"> </span>known<span class="_"> </span>as<span class="_ _11"> </span>a<span class="_ _11"> </span><span class="ffa">uniÔ¨Åed<span class="_ _11"> </span>cache</span>.<span class="_ _11"> </span>Modern<span class="_"> </span>processors</div><div class="t m5 x17 h26 y58d8 ff7 fs19 fc2 sc0 ls0 ws0">include<span class="_ _16"> </span>separate<span class="_ _14"> </span>i-caches<span class="_ _16"> </span>and<span class="_ _14"> </span>d-caches<span class="_ _1"></span>.<span class="_ _16"> </span>T<span class="_ _0"></span>here<span class="_ _16"> </span>are<span class="_ _14"> </span>a<span class="_ _16"> </span>number<span class="_ _14"> </span>of<span class="_ _16"> </span>reasons<span class="_ _14"> </span>for<span class="_ _16"> </span>this<span class="_ _1"></span>.</div><div class="t m5 x17 h26 y58d9 ff7 fs19 fc2 sc0 ls0 ws0">W<span class="_ _1"></span>ith<span class="_ _11"> </span>two<span class="_"> </span>separate<span class="_ _11"> </span>caches<span class="_ _1"></span>,<span class="_"> </span>the<span class="_ _11"> </span>processor<span class="_"> </span>can<span class="_ _11"> </span>read<span class="_"> </span>an<span class="_ _11"> </span>instruction<span class="_"> </span>word<span class="_ _11"> </span>and<span class="_"> </span>a<span class="_"> </span>data</div><div class="t m5 x17 h26 y58da ff7 fs19 fc2 sc0 ls0 ws0">word<span class="_ _14"> </span>at<span class="_ _15"> </span>the<span class="_ _15"> </span>same<span class="_ _15"> </span>time<span class="_ _0"></span>.<span class="_ _14"> </span>I-caches<span class="_ _15"> </span>are<span class="_ _15"> </span>typically<span class="_ _15"> </span>read-only<span class="_ _3"></span>,<span class="_ _21"> </span>and<span class="_ _14"> </span>thus<span class="_ _15"> </span>simpler.<span class="_ _15"> </span>T<span class="_ _1"></span>he</div><div class="t m5 x17 h26 y58db ff7 fs19 fc2 sc0 ls0 ws0">two<span class="_ _13"> </span>caches<span class="_ _13"> </span>are<span class="_"> </span>often<span class="_ _13"> </span>optimized<span class="_ _13"> </span>to<span class="_ _13"> </span>different<span class="_ _13"> </span>access<span class="_"> </span>patterns<span class="_ _13"> </span>and<span class="_ _13"> </span>can<span class="_ _13"> </span>have<span class="_ _13"> </span>different</div><div class="t m5 x17 h26 y58dc ff7 fs19 fc2 sc0 ls0 ws0">block<span class="_ _16"> </span>sizes<span class="_ _0"></span>,<span class="_ _14"> </span>associativities<span class="_ _1"></span>,<span class="_ _15"> </span>and<span class="_ _16"> </span>capacities<span class="_ _0"></span>.<span class="_ _16"> </span>Also,<span class="_ _14"> </span>having<span class="_ _16"> </span>separate<span class="_ _14"> </span>caches<span class="_ _14"> </span>ensures</div><div class="t m5 x17 h26 y58dd ff7 fs19 fc2 sc0 ls0 ws0">that<span class="_"> </span>data<span class="_ _13"> </span>accesses<span class="_"> </span>do<span class="_"> </span>not<span class="_"> </span>create<span class="_ _13"> </span>conÔ¨Çict<span class="_"> </span>misses<span class="_"> </span>with<span class="_ _13"> </span>instruction<span class="_"> </span>accesses<span class="_ _1"></span>,<span class="_"> </span>and<span class="_"> </span>vice</div><div class="t m5 x17 h26 y58de ff7 fs19 fc2 sc0 ls0 ws0">versa,<span class="_"> </span>at<span class="_"> </span>the<span class="_"> </span>cost<span class="_"> </span>of<span class="_"> </span>a<span class="_"> </span>potential<span class="_"> </span>increase<span class="_"> </span>in<span class="_"> </span>capacity<span class="_"> </span>misses<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y58df ff7 fs19 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_ _16"> </span>6.38<span class="_ _16"> </span>shows<span class="_ _11"> </span>the<span class="_ _16"> </span>cache<span class="_ _11"> </span>hierarchy<span class="_ _16"> </span>for<span class="_ _16"> </span>the<span class="_ _11"> </span>Intel<span class="_ _16"> </span>Core<span class="_ _16"> </span>i7<span class="_ _11"> </span>processor.<span class="_ _11"> </span>Each</div><div class="t m5 x17 h26 y58e0 ff7 fs19 fc2 sc0 ls0 ws0">CPU<span class="_ _13"> </span>chip<span class="_ _13"> </span>has<span class="_ _6"> </span>four<span class="_ _13"> </span>cores<span class="_ _1"></span>.<span class="_ _13"> </span>Each<span class="_ _13"> </span>core<span class="_ _6"> </span>has<span class="_ _13"> </span>its<span class="_ _13"> </span>own<span class="_ _13"> </span>private<span class="_ _6"> </span>L1<span class="_ _13"> </span>i-cache<span class="_ _0"></span>,<span class="_ _13"> </span>L1<span class="_ _13"> </span>d-cache<span class="_ _1"></span>,<span class="_ _13"> </span>and</div><div class="t m5 x17 h26 y58e1 ff7 fs19 fc2 sc0 ls0 ws0">L2<span class="_ _13"> </span>uniÔ¨Åed<span class="_ _6"> </span>cache<span class="_ _0"></span>.<span class="_ _13"> </span>All<span class="_ _6"> </span>of<span class="_ _13"> </span>the<span class="_ _6"> </span>cores<span class="_ _13"> </span>share<span class="_ _13"> </span>an<span class="_ _6"> </span>on-chip<span class="_ _13"> </span>L3<span class="_ _6"> </span>uniÔ¨Åed<span class="_ _13"> </span>cache<span class="_ _1"></span>.<span class="_ _13"> </span>An<span class="_ _13"> </span>interesting</div><div class="t m5 x17 h26 y58e2 ff7 fs19 fc2 sc0 ls0 ws0">feature<span class="_ _13"> </span>of<span class="_"> </span>this<span class="_ _13"> </span>hierarchy<span class="_"> </span>is<span class="_ _13"> </span>that<span class="_ _13"> </span>all<span class="_"> </span>of<span class="_ _13"> </span>the<span class="_ _13"> </span>SRAM<span class="_"> </span>cache<span class="_ _13"> </span>memories<span class="_"> </span>are<span class="_ _13"> </span>contained<span class="_ _13"> </span>in</div><div class="t m5 x17 h26 y58e3 ff7 fs19 fc2 sc0 ls0 ws0">the<span class="_"> </span>CPU<span class="_"> </span>chip<span class="_ _1"></span>.</div><div class="t m5 x26 h26 y58e4 ff7 fs19 fc2 sc0 ls0 ws0">F<span class="_ _1"></span>igure<span class="_"> </span>6.39<span class="_"> </span>summarizes<span class="_"> </span>the<span class="_"> </span>basic<span class="_"> </span>characteristics<span class="_"> </span>of<span class="_"> </span>the<span class="_"> </span>Core<span class="_"> </span>i7<span class="_"> </span>caches<span class="_ _1"></span>.</div><div class="t m5 x17 h41 y58e5 ffe fs29 fc2 sc0 ls0 ws0">6.4.7<span class="_ _48"> </span><span class="fs19">Performance<span class="_"> </span>Impact<span class="_"> </span>of<span class="_"> </span>Cache<span class="_"> </span>Parameters</span></div><div class="t m5 x17 h26 y58e6 ff7 fs19 fc2 sc0 ls0 ws0">Cache<span class="_"> </span>performance<span class="_"> </span>is<span class="_"> </span>evaluated<span class="_"> </span>with<span class="_"> </span>a<span class="_"> </span>number<span class="_"> </span>of<span class="_"> </span>metrics:</div><div class="t m5 x72 h26 y58e7 ffa fs19 fc2 sc0 ls0 ws0">Miss<span class="_ _14"> </span>rate.<span class="_ _15"> </span><span class="ff7">T<span class="_ _0"></span>he<span class="_ _14"> </span>fraction<span class="_ _14"> </span>of<span class="_ _14"> </span>memory<span class="_ _14"> </span>references<span class="_ _14"> </span>during<span class="_ _14"> </span>the<span class="_ _14"> </span>execution<span class="_ _14"> </span>of<span class="_ _14"> </span>a<span class="_ _14"> </span>pro-</span></div><div class="t m5 x30 h26 y58e8 ff7 fs19 fc2 sc0 ls0 ws0">gram,<span class="_ _e"> </span>or<span class="_ _f"> </span>a<span class="_ _e"> </span>part<span class="_ _f"> </span>of<span class="_ _f"> </span>a<span class="_ _e"> </span>program,<span class="_ _e"> </span>that<span class="_ _f"> </span>miss<span class="_ _1"></span>.<span class="_ _f"> </span>It<span class="_ _e"> </span>is<span class="_ _f"> </span>computed<span class="_ _f"> </span>as<span class="_ _e"> </span>#<span class="_ _13"> </span><span class="ffa">misses<span class="ff11">/</span></span></div><div class="t m5 x30 h26 y58e9 ff7 fs19 fc2 sc0 ls0 ws0">#<span class="_"> </span><span class="ffa">references</span>.</div><div class="t m5 x72 h26 y58ea ffa fs19 fc2 sc0 ls0 ws0">Hit<span class="_ _23"> </span>rate<span class="_ _1"></span>.<span class="_ _f"> </span><span class="ff7">T<span class="_ _1"></span>he<span class="_ _23"> </span>fraction<span class="_ _23"> </span>of<span class="_ _23"> </span>memory<span class="_ _22"> </span>references<span class="_ _23"> </span>that<span class="_ _23"> </span>hit.<span class="_ _22"> </span>It<span class="_ _23"> </span>is<span class="_ _23"> </span>computed<span class="_ _22"> </span>as</span></div><div class="t m5 x30 h46 y58eb ff7 fs19 fc2 sc0 ls0 ws0">1<span class="_ _6"> </span><span class="ff12">‚àí<span class="_ _10"> </span><span class="ffa">miss<span class="_ _13"> </span>rate<span class="_ _2"></span></span></span>.</div><div class="t m5 x72 h26 y58ec ffa fs19 fc2 sc0 ls0 ws0">Hit<span class="_ _13"> </span>time.<span class="_ _15"> </span><span class="ff7">T<span class="_ _0"></span>he<span class="_ _13"> </span>time<span class="_ _13"> </span>to<span class="_ _13"> </span>deliver<span class="_"> </span>a<span class="_ _13"> </span>word<span class="_ _13"> </span>in<span class="_ _13"> </span>the<span class="_ _13"> </span>cache<span class="_ _13"> </span>to<span class="_ _13"> </span>the<span class="_ _13"> </span>CPU<span class="_ _3"></span>,<span class="_"> </span>including<span class="_ _13"> </span>the<span class="_ _13"> </span>time</span></div><div class="t m5 x30 h26 y58ed ff7 fs19 fc2 sc0 ls0 ws0">for<span class="_ _13"> </span>set<span class="_ _13"> </span>selection,<span class="_"> </span>line<span class="_ _13"> </span>identiÔ¨Åcation,<span class="_ _13"> </span>and<span class="_"> </span>word<span class="_ _13"> </span>selection.<span class="_ _13"> </span>Hit<span class="_ _13"> </span>time<span class="_"> </span>is<span class="_ _13"> </span>on<span class="_ _13"> </span>the</div><div class="t m5 x30 h26 y58ee ff7 fs19 fc2 sc0 ls0 ws0">order<span class="_"> </span>of<span class="_"> </span>several<span class="_"> </span>clock<span class="_"> </span>cycles<span class="_"> </span>for<span class="_"> </span>L1<span class="_"> </span>caches<span class="_ _3"></span>.</div></div><div class="pi" data-data='{"ctm":[2.000000,0.000000,0.000000,2.000000,0.000000,0.000000]}'></div></div>
