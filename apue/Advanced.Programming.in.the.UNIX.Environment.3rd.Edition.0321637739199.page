<div id="pfc7" class="pf w4 h1f" data-page-no="c7"><div class="pc pcc7 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bgc7.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>5.12<span class="_ _1e3"> </span>Implementation <span class="_"> </span>Details<span class="_ _1b"> </span><span class="ff18">165</span></div><div class="t m0 x8a h57 y425 ff1a fs2d fc0 sc0 ls0 ws0">if ((fp = fopen(&quot;/etc/passwd&quot;, &quot;r&quot;)) == NULL)</div><div class="t m0 x9d h57 y426 ff1a fs2d fc0 sc0 ls0 ws0">err_sys(&quot;fopen error&quot;);</div><div class="t m0 x8a h57 y800 ff1a fs2d fc0 sc0 ls0 ws0">if (getc(fp) == EOF)</div><div class="t m0 x9d h57 y801 ff1a fs2d fc0 sc0 ls0 ws0">err_sys(&quot;getc error&quot;);</div><div class="t m0 x8a h57 y802 ff1a fs2d fc0 sc0 ls0 ws0">pr_stdio(&quot;/etc/passwd&quot;, fp);</div><div class="t m0 x8a h57 y803 ff1a fs2d fc0 sc0 ls0 ws0">exit(0);</div><div class="t m0 x32 h57 y804 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y16df ff1a fs2d fc0 sc0 ls0 ws0">void</div><div class="t m0 x32 h57 y16e0 ff1a fs2d fc0 sc0 ls0 ws0">pr_stdio(const char *name, FILE *fp)</div><div class="t m0 x32 h57 y16e1 ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y16e2 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;stream = %s, &quot;, name);</div><div class="t m0 x8a h57 y16e3 ff1a fs2d fc0 sc0 ls0 ws0">if (is_unbuffered(fp))</div><div class="t m0 x9d h57 y16e4 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;unbuffered&quot;);</div><div class="t m0 x8a h57 y16e5 ff1a fs2d fc0 sc0 ls0 ws0">else if (is_linebuffered(fp))</div><div class="t m0 x9d h57 y16e6 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;line buffered&quot;);</div><div class="t m0 x8a h57 y16e7 ff1a fs2d fc0 sc0 ls0 ws0">else /* if neither of above */</div><div class="t m0 x9d h57 y16e8 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;fully buffered&quot;);</div><div class="t m0 x8a h57 y16e9 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;, buffer size = %d\n&quot;, buffer_size(fp));</div><div class="t m0 x32 h57 y16ea ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y16eb ff1a fs2d fc0 sc0 ls0 ws0">/*</div><div class="t m0 x140 h57 y16ec ff1a fs2d fc0 sc0 ls15c ws0">*T<span class="_ _1d"></span><span class="ls0">he following is nonportable.</span></div><div class="t m0 x140 h57 y8e2 ff1a fs2d fc0 sc0 ls0 ws0">*/</div><div class="t m0 x32 h57 y16ed ff1a fs2d fc0 sc0 ls0 ws0">#if defined(_IO_UNBUFFERED)</div><div class="t m0 x32 h57 y131d ff1a fs2d fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 h57 y131e ff1a fs2d fc0 sc0 ls0 ws0">is_unbuffered(FILE *fp)</div><div class="t m0 x32 h57 y131f ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y1320 ff1a fs2d fc0 sc0 ls0 ws0">return(fp-&gt;_flags &amp; _IO_UNBUFFERED);</div><div class="t m0 x32 h57 y1321 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y16ee ff1a fs2d fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 h57 y16ef ff1a fs2d fc0 sc0 ls0 ws0">is_linebuffered(FILE *fp)</div><div class="t m0 x32 h57 y16f0 ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y16f1 ff1a fs2d fc0 sc0 ls0 ws0">return(fp-&gt;_flags &amp; _IO_LINE_BUF);</div><div class="t m0 x32 h57 y16f2 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y16f3 ff1a fs2d fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 h57 y16f4 ff1a fs2d fc0 sc0 ls0 ws0">buffer_size(FILE *fp)</div><div class="t m0 x32 h57 y16f5 ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y16f6 ff1a fs2d fc0 sc0 ls0 ws0">return(fp-&gt;_IO_buf_end - fp-&gt;_IO_buf_base);</div><div class="t m0 x32 h57 y16f7 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y16f8 ff1a fs2d fc0 sc0 ls0 ws0">#elif defined(__SNBF)</div><div class="t m0 x32 h57 y132e ff1a fs2d fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 h57 y132f ff1a fs2d fc0 sc0 ls0 ws0">is_unbuffered(FILE *fp)</div><div class="t m0 x32 h57 y1330 ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y1331 ff1a fs2d fc0 sc0 ls0 ws0">return(fp-&gt;_flags &amp; __SNBF);</div><div class="t m0 x32 h57 y1332 ff1a fs2d fc0 sc0 ls0 ws0">}</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
