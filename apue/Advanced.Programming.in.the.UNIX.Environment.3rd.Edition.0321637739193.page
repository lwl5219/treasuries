<div id="pfc1" class="pf w4 h1f" data-page-no="c1"><div class="pc pcc1 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bgc1.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>5.1<span class="_ _1"></span><span class="ls6ec">1F<span class="_ _1dd"></span><span class="ls0">ormatted <span class="_"> </span>I/O<span class="_ _1b"> </span><span class="ff18">159</span></span></span></div><div class="t m0 x32 h26 y12f ff19 fsf fc0 sc0 ls0 ws0">The<span class="_ _44"> </span><span class="ff1a">fgetpos<span class="_ _4b"> </span></span>function <span class="_ _53"> </span>stores <span class="_ _42"> </span>the <span class="_ _53"> </span>current <span class="_ _42"> </span>value <span class="_ _e"> </span>of <span class="_ _53"> </span>the <span class="_ _53"> </span>ﬁle’s <span class="_ _53"> </span>position <span class="_ _53"> </span>indicator <span class="_ _53"> </span>in <span class="_ _53"> </span>the</div><div class="t m0 x32 h26 y130 ff19 fsf fc0 sc0 ls0 ws0">object <span class="_ _2"></span>pointed <span class="_ _2"></span>to <span class="_ _3"></span>by<span class="_ _66"> </span><span class="ff1b">pos</span><span class="ls6ed">.T<span class="_ _5b"></span><span class="ls0">his <span class="_ _2"></span>value <span class="_ _3"></span>can <span class="_ _2"></span>be <span class="_ _2"></span>used <span class="_ _3"></span>in <span class="_ _2"></span>a <span class="_ _2"></span>later <span class="_ _3"></span>call <span class="_ _2"></span>to<span class="_ _47"> </span><span class="ff1a">fsetpos<span class="_ _66"> </span></span>to <span class="_ _3"></span>reposition</span></span></div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">the stream to that location.</div><div class="t m0 x35 h53 y1625 ff16 fs2b fc0 sc0 ls0 ws0">5.11 <span class="_ _93"> </span>Formatted<span class="_ _54"> </span>I/O</div><div class="t m0 x35 h27 y1626 ff16 fsf fc0 sc0 ls0 ws0">Formatted Output</div><div class="t m0 x32 h26 y1627 ff19 fsf fc0 sc0 ls0 ws0">Formatted output is handled by the ﬁve<span class="_"> </span><span class="ff1a">printf<span class="_ _80"> </span></span>functions.</div><div class="t m0 x3f h57 y1628 ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;stdio.h&gt;</div><div class="t m0 x3f h57 y1629 ff1a fs2d fc0 sc0 ls0 ws0">int printf(const char *restrict<span class="_"> </span><span class="ff1b">format</span><span class="ls15c">,.<span class="_ _1d"></span><span class="ls0">..);</span></span></div><div class="t m0 x3f h57 y162a ff1a fs2d fc0 sc0 ls0 ws0">int fprintf(FILE *restrict<span class="_"> </span><span class="ff1b">fp</span><span class="ls15c">,c<span class="_ _1d"></span><span class="ls0">onst char *restrict<span class="_"> </span><span class="ff1b">format</span><span class="ls15c">,.<span class="_ _5b"></span><span class="ls0">..);</span></span></span></span></div><div class="t m0 x3f h57 y162b ff1a fs2d fc0 sc0 ls0 ws0">int dprintf(int<span class="_"> </span><span class="ff1b">fd</span><span class="ls15c">,c<span class="_ _1d"></span><span class="ls0">onst char *restrict<span class="_"> </span><span class="ff1b">format</span><span class="ls15c">,.<span class="_ _5b"></span><span class="ls0">..);</span></span></span></span></div><div class="t m0 x7c h5f y162c ff19 fs2d fc0 sc0 ls0 ws0">All three r<span class="_ _0"></span>eturn: number of characters output if OK, negative value if output error</div><div class="t m0 x3f h57 y162d ff1a fs2d fc0 sc0 ls0 ws0">int sprintf(char *restrict<span class="_"> </span><span class="ff1b">buf</span><span class="ls15c">,c<span class="_ _1d"></span><span class="ls0">onst char *restrict<span class="_"> </span><span class="ff1b">format</span><span class="ls15c">,.<span class="_ _5b"></span><span class="ls0">..);</span></span></span></span></div><div class="t m0 x52 h5f y162e ff19 fs2d fc0 sc0 ls0 ws0">Returns: number of characters stored in array if OK, negative value if encoding err<span class="_ _0"></span>or</div><div class="t m0 x3f h57 y162f ff1a fs2d fc0 sc0 ls0 ws0">int snprintf(char *restrict<span class="_"> </span><span class="ff1b">buf</span><span class="ls15c">,s<span class="_ _1d"></span><span class="ls0">ize_t<span class="_"> </span><span class="ff1b">n</span>,</span></span></div><div class="t m0 xf0 h57 y1630 ff1a fs2d fc0 sc0 ls0 ws0">const char *restrict<span class="_"> </span><span class="ff1b">format</span><span class="ls15c">,.<span class="_ _1d"></span><span class="ls0">..);</span></span></div><div class="t m0 xab h5f y1631 ff19 fs2d fc0 sc0 ls0 ws0">Returns: number of characters that would have been stored in array</div><div class="t m0 x11b h5f y1632 ff19 fs2d fc0 sc0 ls0 ws0">if buffer was lar<span class="_ _0"></span>ge enough, negative value if encoding error</div><div class="t m0 x32 h4d y1633 ff19 fs26 fc0 sc0 ls0 ws0">The<span class="_ _35"> </span><span class="ff1a">printf<span class="_ _35"> </span></span>function <span class="_ _42"> </span>writes <span class="_ _42"> </span>to <span class="_ _23"> </span>the <span class="_ _42"> </span>standar<span class="ls52d">do<span class="_ _43"></span><span class="ls0">utput,<span class="_ _35"> </span><span class="ff1a">fprintf<span class="_ _35"> </span></span>writes <span class="_ _23"> </span>to <span class="_ _42"> </span>the <span class="_ _42"> </span>speciﬁed</span></span></div><div class="t m0 x32 h4d y1634 ff19 fs26 fc0 sc0 ls0 ws0">stream,<span class="_ _16"> </span><span class="ff1a">dprintf<span class="_"> </span></span>writes <span class="_ _45"> </span>to <span class="_ _45"> </span>the <span class="_ _35"> </span>speciﬁed <span class="_ _45"> </span>ﬁle <span class="_ _45"> </span>descriptor<span class="_ _6"></span><span class="ls6ee">,a<span class="_ _62"></span><span class="ls0">nd<span class="_ _5a"> </span><span class="ff1a">sprintf<span class="_"> </span></span>places <span class="_ _45"> </span>the</span></span></div><div class="t m0 x32 h4d y1635 ff19 fs26 fc0 sc0 ls0 ws0">formatted <span class="_ _9"></span>characters <span class="_ _9"></span>in <span class="_ _23"></span>the <span class="_ _9"></span>array<span class="_ _45"> </span><span class="ff1b">buf</span><span class="ls6ef">.T<span class="_ _26"></span><span class="ls0">he<span class="_ _35"> </span><span class="ff1a">sprintf<span class="_ _45"> </span></span>function <span class="_ _9"></span>automatically <span class="_ _9"></span>appends <span class="_ _9"></span>a</span></span></div><div class="t m0 x32 h49 y1636 ff19 fs26 fc0 sc0 ls0 ws0">null byte at the end of the array<span class="_ _4"></span><span class="lsd3">,b<span class="_ _5"></span><span class="ls0">ut this null byte is not included in the return value.</span></span></div><div class="t m0 x3f h4d y1637 ff19 fs26 fc0 sc0 ls0 ws0">Note <span class="_ _23"></span>that <span class="_ _9"></span>it’s <span class="_ _23"> </span>possible <span class="_ _23"> </span>for<span class="_ _35"> </span><span class="ff1a">sprintf<span class="_ _45"> </span></span>to <span class="_ _23"> </span>overﬂow <span class="_ _23"></span>the <span class="_ _23"></span>buffer <span class="_ _9"></span>pointed <span class="_ _23"></span>to <span class="_ _23"></span>by<span class="_ _45"> </span><span class="ff1b">buf</span><span class="ls6f0">.T<span class="_ _26"></span><span class="ls0">he</span></span></div><div class="t m0 x32 h49 y1638 ff19 fs26 fc0 sc0 ls0 ws0">caller <span class="_ _47"> </span>is <span class="_ _45"> </span>responsible <span class="_ _47"> </span>for <span class="_ _45"> </span>ensuring <span class="_ _47"> </span>that <span class="_ _45"> </span>the <span class="_ _47"> </span>buffer <span class="_ _45"> </span>is <span class="_ _47"> </span>large <span class="_ _47"> </span>enough.<span class="_ _1a3"> </span>Because <span class="_ _47"> </span>buffer</div><div class="t m0 x32 h4d y1639 ff19 fs26 fc0 sc0 ls0 ws0">overﬂows <span class="_ _3"></span>can <span class="_ _9"></span>lead <span class="_ _9"></span>to <span class="_ _3"></span>program <span class="_ _3"></span>instability <span class="_ _9"></span>and <span class="_ _9"></span>even <span class="_ _3"></span>security <span class="_ _9"></span>violations,<span class="_ _45"> </span><span class="ff1a">snprintf<span class="_ _47"> </span></span>was</div><div class="t m0 x32 h49 y163a ff19 fs26 fc0 sc0 ls0 ws0">introduced. <span class="_ _45"> </span>W<span class="_ _1"></span>ith <span class="_ _9"></span>it, <span class="_ _23"></span>the <span class="_ _9"></span>size <span class="_ _9"></span>of <span class="_ _23"></span>the <span class="_ _9"></span>buffer <span class="_ _9"></span>is <span class="_ _23"></span>an <span class="_ _9"></span>explicit <span class="_ _23"></span>parameter; <span class="_ _9"></span>any <span class="_ _9"></span>characters <span class="_ _23"></span>that</div><div class="t m0 x32 h49 y163b ff19 fs26 fc0 sc0 ls0 ws0">would <span class="_ _45"> </span>have <span class="_ _45"> </span>been <span class="_ _45"> </span>written <span class="_ _45"> </span>past <span class="_ _45"> </span>the <span class="_ _45"> </span>end <span class="_ _35"> </span>of <span class="_ _45"> </span>the <span class="_ _45"> </span>buffer <span class="_ _47"> </span>ar<span class="ls6f1">ed<span class="_ _26"></span><span class="ls0">iscarded <span class="_ _45"> </span>instead.<span class="_ _1a3"> </span>The</span></span></div><div class="t m0 x32 h4d y163c ff1a fs26 fc0 sc0 ls0 ws0">snprintf<span class="_ _45"> </span><span class="ff19">function <span class="_ _9"></span>returns <span class="_ _9"></span>the <span class="_ _9"></span>number <span class="_ _9"></span>of <span class="_ _23"></span>characters <span class="_ _9"></span>that <span class="_ _9"></span>would <span class="_ _9"></span>have <span class="_ _23"></span>been <span class="_ _9"></span>written <span class="_ _9"></span>to</span></div><div class="t m0 x32 h4d y163d ff19 fs26 fc0 sc0 ls0 ws0">the <span class="_ _3"></span>buffer <span class="_ _3"></span>had <span class="_ _9"></span>it <span class="_ _3"></span>been <span class="_ _9"></span>big <span class="_ _3"></span>enough.<span class="_ _5a"> </span>As <span class="_ _3"></span>with<span class="_ _45"> </span><span class="ff1a">sprintf</span><span class="ls6f2">,t<span class="_ _b"></span><span class="ls0">he <span class="_ _9"></span>return <span class="_ _2"></span>value <span class="_ _9"></span>doesn’t <span class="_ _9"></span>include</span></span></div><div class="t m0 x32 h4d y163e ff19 fs26 fc0 sc0 ls0 ws0">the terminating <span class="_ _2"></span>null byte.<span class="_ _61"> </span>If<span class="_ _66"> </span><span class="ff1a">snprintf<span class="_ _66"> </span></span><span class="lscc">re<span class="_ _2"></span></span>turns a <span class="_ _2"></span>positive <span class="_ _2"></span>value less <span class="_ _2"></span>than <span class="_ _2"></span>the buffer size</div><div class="t m0 x32 h4d y163f ff1b fs26 fc0 sc0 ls0 ws0">n<span class="ff19 ls6f3">,t<span class="_ _8"></span><span class="ls0">hen <span class="_ _3"></span>the <span class="_ _3"></span>output <span class="_ _3"></span>was <span class="_ _3"></span>not <span class="_ _3"></span>truncated. <span class="_ _47"> </span>If<span class="_ _47"> </span>an <span class="_ _3"></span>encoding <span class="_ _3"></span>error <span class="_ _2"></span>occurs,<span class="_ _47"> </span><span class="ff1a">snprintf<span class="_ _47"> </span></span><span class="lscc">re<span class="_ _2"></span></span>turns <span class="_ _3"></span>a</span></span></div><div class="t m0 x32 h49 y1640 ff19 fs26 fc0 sc0 ls0 ws0">negative value.</div><div class="t m0 x3f h4d y1641 ff19 fs26 fc0 sc0 ls0 ws0">Although<span class="_"> </span><span class="ff1a">dprintf<span class="_ _80"> </span></span>doesn’t deal with a <span class="_ _2"></span>ﬁle pointer<span class="_ _6"></span>,<span class="_"> </span>we<span class="_ _66"> </span>include it with the rest of the</div><div class="t m0 x32 h4d y1642 ff19 fs26 fc0 sc0 lscc ws0">re<span class="ls0">lated <span class="_ _9"></span>functions <span class="_ _3"></span>that <span class="_ _3"></span>handle <span class="_ _3"></span>formatted <span class="_ _3"></span>output.<span class="_ _5a"> </span>Note <span class="_ _3"></span>that <span class="_ _3"></span>using<span class="_ _47"> </span><span class="ff1a">dprintf<span class="_ _45"> </span></span></span>re<span class="ls0">moves <span class="_ _3"></span>the</span></div><div class="t m0 x32 h4d y1643 ff19 fs26 fc0 sc0 ls0 ws0">need to call<span class="_ _66"> </span><span class="ff1a">fdopen<span class="_ _66"> </span></span>to convert a <span class="_ _2"></span>ﬁle descriptor <span class="_ _2"></span>into a ﬁle <span class="_ _2"></span>pointer for use <span class="_ _2"></span>with<span class="_"> </span><span class="ff1a">fprintf</span>.</div><div class="t m0 x3f h49 y1644 ff19 fs26 fc0 sc0 ls0 ws0">The <span class="_ _66"> </span>format <span class="_ _66"> </span>speciﬁcation <span class="_ _47"> </span>controls <span class="_"> </span>how <span class="_ _66"> </span>the <span class="_ _47"> </span>remainder <span class="_"> </span>of <span class="_ _66"> </span>the <span class="_ _47"> </span>arguments <span class="_"> </span>will <span class="_ _66"> </span>be</div><div class="t m0 x32 h49 y1645 ff19 fs26 fc0 sc0 ls0 ws0">encoded <span class="_ _59"> </span>and <span class="_ _46"> </span>ultimately <span class="_ _46"> </span>displayed.<span class="_ _5e"> </span>Each <span class="_ _46"> </span>argument <span class="_ _59"> </span>is <span class="_ _46"> </span>encoded <span class="_ _59"> </span>according <span class="_ _46"> </span>to <span class="_ _59"> </span>a</div><div class="t m0 x32 h49 y1646 ff19 fs26 fc0 sc0 ls0 ws0">conversion <span class="_ _23"></span>speciﬁcation <span class="_ _9"></span>that <span class="_ _23"></span>starts <span class="_ _23"></span>with <span class="_ _9"></span>a <span class="_ _23"> </span>percent <span class="_ _9"></span>sign <span class="_ _23"></span>(%).<span class="_ _51"> </span>Except <span class="_ _9"></span>for <span class="_ _23"></span>the <span class="_ _23"></span>conversion</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.893259px;bottom:1105.248863px;width:117.348404px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
