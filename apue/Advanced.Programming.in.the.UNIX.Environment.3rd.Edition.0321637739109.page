<div id="pf6d" class="pf w4 h1f" data-page-no="6d"><div class="pc pc6d w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg6d.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>3.10<span class="_ _174"> </span>File <span class="_"> </span>Sharing<span class="_ _1b"> </span><span class="ff18">75</span></div><div class="t m0 x150 h2a y12f ff19 fsf fc0 sc0 ls0 ws0">v-node also contains <span class="_ _2"></span>the i-node <span class="_ _2"></span>for the <span class="_ _2"></span>ﬁle.<span class="_ _46"> </span>This information <span class="_ _2"></span>is read from disk when</div><div class="t m0 x150 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_"> </span>ﬁle <span class="_ _e"> </span>is <span class="_"> </span>opened, <span class="_ _e"> </span>so <span class="_"> </span>that <span class="_ _e"> </span>all <span class="_"> </span>the <span class="_ _e"> </span>pertinent <span class="_"> </span>information <span class="_"> </span>about <span class="_ _e"> </span>the <span class="_"> </span>ﬁle <span class="_ _e"> </span>is <span class="_"> </span>r<span class="_ _0"></span>eadily</div><div class="t m0 x150 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">available. <span class="_ _47"> </span>For<span class="_ _66"> </span>example, <span class="_ _3"></span>the <span class="_ _3"></span>i-node <span class="_ _2"></span>contains <span class="_ _3"></span>the <span class="_ _2"></span>owner <span class="_ _3"></span>of <span class="_ _3"></span>the <span class="_ _2"></span>ﬁle, <span class="_ _3"></span>the <span class="_ _3"></span>size <span class="_ _2"></span>of <span class="_ _3"></span>the <span class="_ _3"></span>ﬁle,</div><div class="t m0 x150 h2a y132 ff19 fsf fc0 sc0 ls0 ws0">pointers <span class="_ _9"></span>to <span class="_ _9"></span>wher<span class="ls3ca">et<span class="_ _b"></span><span class="ls0">he <span class="_ _9"></span>actual <span class="_ _9"></span>data <span class="_ _9"></span>blocks <span class="_ _9"></span>for <span class="_ _9"></span>the <span class="_ _9"></span>ﬁle <span class="_ _9"></span>ar<span class="ls3ca">el<span class="_ _b"></span><span class="ls0">ocated <span class="_ _9"></span>on <span class="_ _9"></span>disk, <span class="_ _9"></span>and <span class="_ _9"></span>so <span class="_ _23"></span>on.</span></span></span></span></div><div class="t m0 x150 h2a y133 ff19 fsf fc0 sc0 ls0 ws0">(W<span class="_ _6"></span><span class="ls316">et<span class="_ _8"></span><span class="ls0">alk <span class="_ _3"></span>mor<span class="ls316">ea<span class="_ _8"></span><span class="ls0">bout <span class="_ _3"></span>i-nodes <span class="_ _3"></span>in <span class="_ _3"></span>Section <span class="_ _3"></span>4.14 <span class="_ _3"></span>when <span class="_ _2"></span>we <span class="_ _3"></span>describe <span class="_ _3"></span>the <span class="_ _3"></span>typical <span class="_ _3"></span>UNIX <span class="_ _3"></span>ﬁle</span></span></span></span></div><div class="t m0 x150 h2a y134 ff19 fsf fc0 sc0 ls0 ws0">system in mor<span class="ls44">ed<span class="_ _4f"></span><span class="ls0">etail.)</span></span></div><div class="t m0 x76 h51 y736 ff19 fs2a fc0 sc0 ls0 ws0">Linux <span class="_ _59"> </span>has <span class="_ _4b"> </span>no <span class="_ _59"> </span>v-node.<span class="_ _98"> </span>Instead, <span class="_ _59"> </span>a <span class="_ _4b"> </span>generic <span class="_ _59"> </span>i-node <span class="_ _59"> </span>structure<span class="_ _54"> </span>is<span class="_ _54"> </span>used. <span class="_ _65"> </span>Although<span class="_ _54"> </span>the</div><div class="t m0 x76 h51 ybc5 ff19 fs2a fc0 sc0 ls0 ws0">implementations <span class="_ _2"></span>differ<span class="_ _1"></span><span class="ls3cb">,t<span class="_ _d"></span><span class="ls0">he <span class="_ _3"></span>v-node <span class="_ _2"></span>is <span class="_ _2"></span>conceptually <span class="_ _3"></span>the <span class="_ _2"></span>same <span class="_ _2"></span>as <span class="_ _2"></span>a <span class="_ _3"></span>generic <span class="_ _2"></span>i-node.<span class="_ _4b"> </span>Both <span class="_ _2"></span>point <span class="_ _2"></span>to</span></span></div><div class="t m0 x76 h51 ybc6 ff19 fs2a fc0 sc0 ls0 ws0">an i-node structur<span class="lse9">es<span class="_ _5"></span><span class="ls0">peciﬁc to the ﬁle system.</span></span></div><div class="t m0 x3f h2a ybc7 ff19 fsf fc0 sc0 ls5f ws0">We<span class="_ _9"></span><span class="ls0">’r<span class="ls3cc">ei<span class="_ _43"></span><span class="ls0">gnoring <span class="_ _23"> </span>some <span class="_ _42"> </span>implementation <span class="_ _23"> </span>details <span class="_ _42"> </span>that <span class="_ _42"> </span>don’t <span class="_ _23"> </span>affect <span class="_ _23"> </span>our <span class="_ _42"> </span>discussion.<span class="_ _51"> </span>For</span></span></span></div><div class="t m0 x32 h2a ybc8 ff19 fsf fc0 sc0 ls0 ws0">example, the <span class="_ _2"></span>table <span class="_ _2"></span>of <span class="_ _2"></span>open <span class="_ _2"></span>ﬁle <span class="_ _2"></span>descriptors <span class="_ _2"></span>can <span class="_ _2"></span>be <span class="_ _2"></span>stored in <span class="_ _2"></span>the <span class="_ _2"></span>user <span class="_ _2"></span>area (a <span class="_ _2"></span>separate <span class="_ _2"></span>per-</div><div class="t m0 x32 h2a ybc9 ff19 fsf fc0 sc0 ls0 ws0">process <span class="_ _2"></span>structur<span class="ls274">et<span class="_ _b"></span><span class="ls0">hat <span class="_ _3"></span>can <span class="_ _9"></span>be <span class="_ _3"></span>paged <span class="_ _3"></span>out) <span class="_ _3"></span>instead <span class="_ _3"></span>of <span class="_ _3"></span>the <span class="_ _9"></span>process <span class="_ _2"></span>table.<span class="_ _16"> </span>Also, <span class="_ _3"></span>these <span class="_ _9"></span>tables</span></span></div><div class="t m0 x32 h2a ybca ff19 fsf fc0 sc0 ls0 ws0">can <span class="_ _45"> </span>be <span class="_ _45"> </span>implemented <span class="_ _35"> </span>in <span class="_ _45"> </span>numerous <span class="_ _45"> </span>ways<span class="_ _3"></span><span class="ls9d">—t<span class="_ _1"></span><span class="ls0">hey <span class="_ _45"> </span>need <span class="_ _45"> </span>not <span class="_ _35"> </span>be <span class="_ _45"> </span>arrays; <span class="_ _45"> </span>one <span class="_ _45"> </span>alternate</span></span></div><div class="t m0 x32 h2a ybcb ff19 fsf fc0 sc0 ls0 ws0">implementation <span class="_ _2"></span>is <span class="_ _2"></span>a <span class="_ _2"></span>linked <span class="_ _2"></span>lists <span class="_ _2"></span>of <span class="_ _2"></span>structures. <span class="_ _66"> </span>Regardless of <span class="_ _3"></span>the <span class="_ _2"></span>implementation <span class="_ _2"></span>details,</div><div class="t m0 x32 h2a y9ff ff19 fsf fc0 sc0 ls0 ws0">the general concepts remain the same.</div><div class="t m0 x3f h2a ybcc ff19 fsf fc0 sc0 ls0 ws0">Figur<span class="ls3cd">e3<span class="_ _43"></span><span class="ls0">.7 <span class="_ _23"></span>shows <span class="_ _23"></span>a <span class="_ _23"></span>pictorial <span class="_ _9"></span>arrangement <span class="_ _23"> </span>of <span class="_ _23"> </span>these <span class="_ _23"></span>three <span class="_ _9"></span>tables <span class="_ _23"> </span>for <span class="_ _23"> </span>a <span class="_ _23"></span>single <span class="_ _23"></span>process</span></span></div><div class="t m0 x32 h2a ybcd ff19 fsf fc0 sc0 ls0 ws0">that <span class="_ _9"></span>has <span class="_ _23"> </span>two <span class="_ _23"></span>differ<span class="_ _1"></span>ent <span class="_ _23"></span>ﬁles <span class="_ _23"></span>open: <span class="_ _9"></span>one <span class="_ _23"></span>ﬁle <span class="_ _9"></span>is <span class="_ _23"> </span>open <span class="_ _23"></span>on <span class="_ _9"></span>standar<span class="ls3ce">di<span class="_ _b"></span><span class="ls0">nput <span class="_ _9"></span>(ﬁle <span class="_ _23"></span>descriptor <span class="_ _9"></span>0),</span></span></div><div class="t m0 x32 h2a ybce ff19 fsf fc0 sc0 ls0 ws0">and the other is open on standar<span class="ls44">do<span class="_ _4f"></span><span class="ls0">utput (ﬁle descriptor 1).</span></span></div><div class="t m0 x8a h2d ybcf ff19 fs10 fc0 sc0 ls0 ws0">process table entry</div><div class="t m0 x139 h80 ybd0 ff19 fs3e fc0 sc0 ls3cf ws0">...</div><div class="t m0 x3f h81 ybd1 ff19 fs3f fc0 sc0 ls0 ws0">fd 0:</div><div class="t m0 x3f h81 ybd2 ff19 fs3f fc0 sc0 ls0 ws0">fd 1:</div><div class="t m0 x3f h81 ybd3 ff19 fs3f fc0 sc0 ls0 ws0">fd 2:</div><div class="t m0 x167 h82 ybd4 ff19 fs40 fc0 sc0 ls0 ws0">fd</div><div class="t m0 x135 h82 ybd5 ff19 fs40 fc0 sc0 ls0 ws0">ﬂags</div><div class="t m0 x137 h82 ybd4 ff19 fs40 fc0 sc0 ls0 ws0">ﬁle</div><div class="t m0 x159 h82 ybd5 ff19 fs40 fc0 sc0 ls0 ws0">pointer</div><div class="t m0 x87 h30 ybd6 ff19 fs13 fc0 sc0 ls0 ws0">ﬁle status ﬂags</div><div class="t m0 x10f h31 ybd7 ff19 fs14 fc0 sc0 ls0 ws0">current ﬁle of<span class="_ _0"></span>fset</div><div class="t m0 x87 h32 ybd8 ff19 fs15 fc0 sc0 ls0 ws0">v-node pointer</div><div class="t m0 x87 h33 ybd9 ff19 fs16 fc0 sc0 ls0 ws0">ﬁle status ﬂags</div><div class="t m0 x17 h83 ybda ff19 fs36 fc0 sc0 ls0 ws0">current ﬁle of<span class="_ _0"></span>fset</div><div class="t m0 x87 h34 ybdb ff19 fs17 fc0 sc0 ls0 ws0">v-node pointer</div><div class="t m0 x86 h34 ybdc ff19 fs17 fc0 sc0 ls0 ws0">ﬁle table entry</div><div class="t m0 x86 h34 ybdd ff19 fs17 fc0 sc0 ls0 ws0">ﬁle table entry</div><div class="t m0 x168 h84 ybde ff19 fs41 fc0 sc0 ls0 ws0">v-node information</div><div class="t m0 x11f h85 ybdf ff1a fs41 fc0 sc0 ls0 ws0">v_data</div><div class="t m0 x13b h84 ybe0 ff19 fs41 fc0 sc0 ls0 ws0">i-node information</div><div class="t m0 xd4 h84 ybe1 ff19 fs41 fc0 sc0 ls0 ws0">current ﬁle size</div><div class="t m0 x169 h85 ybe2 ff1a fs41 fc0 sc0 ls0 ws0">i_vnode</div><div class="t m0 x168 h86 ybe3 ff19 fs42 fc0 sc0 ls0 ws0">v-node information</div><div class="t m0 x11f h87 ybe4 ff1a fs42 fc0 sc0 ls0 ws0">v_data</div><div class="t m0 x13b h86 ybe5 ff19 fs42 fc0 sc0 ls0 ws0">i-node information</div><div class="t m0 xd4 h86 ybe6 ff19 fs42 fc0 sc0 ls0 ws0">current ﬁle size</div><div class="t m0 x169 h87 ybe7 ff1a fs42 fc0 sc0 ls0 ws0">i_vnode</div><div class="t m0 x16a h88 ybe8 ff19 fs43 fc0 sc0 ls0 ws0">v-node table entry</div><div class="t m0 x16a h88 ybe9 ff19 fs43 fc0 sc0 ls0 ws0">v-node table entry</div><div class="t m0 x16b h88 ybea ff19 fs43 fc0 sc0 ls0 ws0">i-node</div><div class="t m0 x16b h88 ybeb ff19 fs43 fc0 sc0 ls0 ws0">i-node</div><div class="t m0 xbe h3f ybec ff18 fs21 fc0 sc0 ls0 ws0">Figure 3.7<span class="_ _5a"> </span><span class="ff19">Kernel data structures for open ﬁles</span></div><div class="t m0 x32 h89 ybed ff19 fs44 fc0 sc0 ls0 ws0">The <span class="_ _9"></span>arrangement <span class="_ _3"></span>of <span class="_ _9"></span>these <span class="_ _9"></span>three <span class="_ _3"></span>tables <span class="_ _9"></span>has <span class="_ _9"></span>existed <span class="_ _9"></span>since <span class="_ _9"></span>the <span class="_ _9"></span>early <span class="_ _9"></span>versions <span class="_ _9"></span>of <span class="_ _9"></span>the <span class="_ _3"></span>UNIX</div><div class="t m0 x32 h89 ybee ff19 fs44 fc0 sc0 ls0 ws0">System</div><div class="t m0 x135 h89 ybef ff19 fs44 fc0 sc0 ls0 ws0">[</div><div class="t m0 x2d h89 ybee ff19 fs44 fc0 sc0 ls0 ws0">Thompson <span class="_"> </span>1978</div><div class="t m0 x8c h89 ybef ff19 fs44 fc0 sc0 ls0 ws0">]</div><div class="t m0 x6b h89 ybee ff19 fs44 fc0 sc0 ls3d0 ws0">.T<span class="_ _49"></span><span class="ls0">his <span class="_"> </span>arrangement <span class="_ _47"> </span>is <span class="_"> </span>critical <span class="_ _47"> </span>to <span class="_"> </span>the <span class="_ _47"> </span>way <span class="_ _66"> </span>ﬁles <span class="_ _66"> </span>ar<span class="ls3d1">es<span class="_ _5b"></span><span class="ls0">hared</span></span></span></div><div class="t m0 x32 h89 ybf0 ff19 fs44 fc0 sc0 ls0 ws0">among <span class="_ _47"> </span>processes. <span class="_ _16"> </span>W<span class="_ _6"></span>e’ll <span class="_ _47"> </span>return <span class="_ _47"> </span>to <span class="_ _45"> </span>this <span class="_ _47"> </span>ﬁgure<span class="_ _16"> </span>in<span class="_ _16"> </span>later <span class="_ _47"> </span>chapters, <span class="_ _45"> </span>when <span class="_ _47"> </span>we <span class="_ _45"> </span>describe</div><div class="t m0 x32 h89 ybf1 ff19 fs44 fc0 sc0 ls0 ws0">additional ways that ﬁles ar<span class="ls3d2">es<span class="_ _4f"></span><span class="ls0">hared.</span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
