<div id="pf2f" class="pf w4 h1f" data-page-no="2f"><div class="pc pc2f w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg2f.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>1.6<span class="_ _89"> </span>Programs <span class="_"> </span>and <span class="_"> </span>Pr<span class="_ _0"></span>ocesses<span class="_ _1b"> </span><span class="ff18">13</span></div><div class="t m0 x15 h26 y12f ff19 fsf fc0 sc0 ls0 ws0">and <span class="_ _2"></span>returns <span class="_ _2"></span>0 <span class="_ _2"></span>to <span class="_ _2"></span>the <span class="_ _3"></span>child.<span class="_ _61"> </span>Because<span class="_ _47"> </span><span class="ff1a">fork<span class="_ _66"> </span></span>creates <span class="_ _2"></span>a <span class="_ _3"></span>new <span class="_ _2"></span>process, <span class="_ _2"></span>we <span class="_ _2"></span>say <span class="_ _2"></span>that <span class="_ _3"></span>it <span class="_ _2"></span>is</div><div class="t m0 x15 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">called once<span class="_ _9"></span><span class="ls9d">—b<span class="_ _6"></span><span class="ls44">yt<span class="_ _d"></span><span class="ls0">he parent <span class="_ _a"></span>— <span class="_ _a"></span>but<span class="_"> </span><span class="ls45">re<span class="_ _2"></span></span>turns twice<span class="_ _9"></span><span class="ls9d">—i<span class="_ _6"></span><span class="ls44">nt<span class="_ _5"></span><span class="ls0">he parent and in the child.</span></span></span></span></span></span></div><div class="t m0 x3f h26 y3eb ff19 fsf fc0 sc0 ls49 ws0">•I<span class="_ _4d"></span><span class="ls168">nt<span class="_ _43"></span><span class="ls0">he <span class="_ _23"> </span>child, <span class="_ _42"> </span>we <span class="_ _42"> </span>call<span class="_ _35"> </span><span class="ff1a">execlp<span class="_ _35"> </span></span>to <span class="_ _42"> </span>execute <span class="_ _42"> </span>the <span class="_ _23"> </span>command <span class="_ _42"> </span>that <span class="_ _23"> </span>was <span class="_ _42"> </span>read <span class="_ _23"> </span>from <span class="_ _23"> </span>the</span></span></div><div class="t m0 x15 h2a y3ec ff19 fsf fc0 sc0 ls0 ws0">standar<span class="ls169">di<span class="_ _b"></span><span class="ls0">nput. <span class="_ _47"> </span>This<span class="_ _45"> </span><span class="ls45">re</span>places <span class="_ _3"></span>the <span class="_ _9"></span>child <span class="_ _3"></span>process <span class="_ _3"></span>with <span class="_ _3"></span>the <span class="_ _3"></span>new <span class="_ _9"></span>program <span class="_ _2"></span>ﬁle.<span class="_ _5a"> </span>The</span></span></div><div class="t m0 x15 h26 y1ad ff19 fsf fc0 sc0 ls0 ws0">combination <span class="_ _42"> </span>of<span class="_ _44"> </span><span class="ff1a">fork<span class="_ _44"> </span></span>followed <span class="_ _42"> </span>by<span class="_ _44"> </span><span class="ff1a">exec<span class="_ _44"> </span></span>is <span class="_ _42"> </span>called <span class="_ _42"> </span>spawning <span class="_ _42"> </span>a <span class="_ _42"> </span>new <span class="_ _53"> </span>process <span class="_ _23"> </span>on</div><div class="t m0 x15 h2a y1ae ff19 fsf fc0 sc0 ls0 ws0">some <span class="_ _9"></span>operating <span class="_ _9"></span>systems.<span class="_ _16"> </span>In <span class="_ _9"></span>the <span class="_ _9"></span>UNIX <span class="_ _9"></span>System, <span class="_ _9"></span>the <span class="_ _9"></span>two <span class="_ _9"></span>parts <span class="_ _9"></span>ar<span class="ls16a">es<span class="_ _b"></span><span class="ls0">eparated <span class="_ _3"></span>into</span></span></div><div class="t m0 x15 h2a y1af ff19 fsf fc0 sc0 ls0 ws0">individual functions.<span class="_ _59"> </span><span class="ls5f">We<span class="_ _23"></span></span>’ll say a lot mor<span class="ls44">ea<span class="_ _4f"></span><span class="ls0">bout these functions in Chapter 8.</span></span></div><div class="t m0 x3f h26 y3ed ff19 fsf fc0 sc0 ls49 ws0">•B<span class="_ _4d"></span><span class="ls0">ecause <span class="_"> </span>the <span class="_ _e"> </span>child <span class="_"> </span>calls<span class="_ _59"> </span><span class="ff1a">execlp<span class="_ _59"> </span></span>to <span class="_"> </span>execute <span class="_ _e"> </span>the <span class="_"> </span>new <span class="_"> </span>pr<span class="_ _0"></span>ogram <span class="_"> </span>ﬁle, <span class="_ _e"> </span>the <span class="_"> </span>par<span class="_ _0"></span>ent</span></div><div class="t m0 x15 h26 y3ee ff19 fsf fc0 sc0 ls0 ws0">wants <span class="_"> </span>to <span class="_"> </span>wait <span class="_ _e"> </span>for <span class="_"> </span>the <span class="_"> </span>child <span class="_"> </span>to <span class="_ _e"> </span>terminate.<span class="_ _60"> </span>This <span class="_"> </span>is <span class="_"> </span>done <span class="_ _e"> </span>by <span class="_"> </span>calling<span class="_ _59"> </span><span class="ff1a">waitpid</span>,</div><div class="t m0 x15 h26 y1b1 ff19 fsf fc0 sc0 ls0 ws0">specifying <span class="_ _2"></span>which <span class="_ _3"></span>process <span class="_ _2"></span>to <span class="_ _2"></span>wait <span class="_ _3"></span>for: <span class="_ _2"></span>the<span class="_ _47"> </span><span class="ff1a">pid<span class="_ _47"> </span></span>argument, <span class="_ _2"></span>which <span class="_ _2"></span>is <span class="_ _3"></span>the <span class="_ _3"></span>process ID</div><div class="t m0 x15 h26 y157 ff19 fsf fc0 sc0 ls0 ws0">of <span class="_ _42"> </span>the <span class="_ _23"> </span>child.<span class="_ _54"> </span>The<span class="_ _35"> </span><span class="ff1a">waitpid<span class="_ _44"> </span></span>function <span class="_ _23"> </span>also <span class="_ _42"> </span>returns <span class="_ _23"> </span>the <span class="_ _42"> </span>termination <span class="_ _42"> </span>status <span class="_ _23"> </span>of <span class="_ _42"> </span>the</div><div class="t m0 x15 h26 y15a ff19 fsf fc0 sc0 ls0 ws0">child <span class="_ _a"></span>— <span class="_ _a"></span>the<span class="_ _47"> </span><span class="ff1a">status<span class="_ _66"> </span></span>variable <span class="_ _a"></span>— <span class="_ _4"></span>but<span class="_"> </span>in <span class="_ _2"></span>this <span class="_ _2"></span>simple program, <span class="_ _2"></span>we <span class="_ _2"></span>don’t <span class="_ _2"></span>do <span class="_ _2"></span>anything</div><div class="t m0 x15 h2a y15b ff19 fsf fc0 sc0 ls0 ws0">with this value.<span class="_ _59"> </span><span class="ls5f">We <span class="_ _e"> </span>c<span class="_ _9"></span></span>ould examine it to determine how the child terminated.</div><div class="t m0 x3f h2a y13b ff19 fsf fc0 sc0 ls49 ws0">•T<span class="_ _4d"></span><span class="ls0">he <span class="_ _4b"> </span>most <span class="_ _4b"> </span>fundamental <span class="_ _4b"> </span>limitation <span class="_ _44"> </span>of <span class="_ _4b"> </span>this <span class="_ _4b"> </span>program <span class="_ _4b"> </span>is <span class="_ _4b"> </span>that <span class="_ _4b"> </span>we <span class="_ _44"> </span>can’t <span class="_ _4b"> </span>pass</span></div><div class="t m0 x15 h2a y13c ff19 fsf fc0 sc0 ls0 ws0">arguments to the command <span class="_ _2"></span>we execute.<span class="_ _46"> </span><span class="ls5f">We <span class="_ _e"> </span>c<span class="_ _9"></span></span>an’t, <span class="_ _2"></span>for example, specify <span class="_ _2"></span>the name</div><div class="t m0 x15 h26 y256 ff19 fsf fc0 sc0 ls0 ws0">of a <span class="_ _2"></span>directory to list.<span class="_ _46"> </span><span class="ls5f">We <span class="_ _e"> </span>c<span class="_ _23"></span></span>an execute<span class="_"> </span><span class="ff1a">ls<span class="_ _66"> </span></span>only <span class="_ _2"></span>on the <span class="_ _2"></span>working <span class="_ _2"></span>directory<span class="_ _4"></span><span class="ls16b">.T<span class="_ _26"></span><span class="ls16c">oa<span class="_ _4f"></span><span class="ls0">llow</span></span></span></div><div class="t m0 x15 h2a y257 ff19 fsf fc0 sc0 ls0 ws0">arguments would <span class="_ _2"></span>requir<span class="_ _0"></span><span class="ls16d">et<span class="_ _4f"></span><span class="ls0">hat <span class="_ _2"></span>we <span class="_ _2"></span>parse <span class="_ _2"></span>the <span class="_ _2"></span>input <span class="_ _2"></span>line, <span class="_ _2"></span>separating <span class="_ _2"></span>the arguments</span></span></div><div class="t m0 x15 h2a y258 ff19 fsf fc0 sc0 ls0 ws0">by <span class="_ _2"></span>some <span class="_ _3"></span>convention, <span class="_ _3"></span>probably <span class="_ _2"></span>spaces <span class="_ _3"></span>or <span class="_ _3"></span>tabs, <span class="_ _3"></span>and <span class="_ _3"></span>then <span class="_ _3"></span>pass <span class="_ _2"></span>each <span class="_ _3"></span>argument <span class="_ _2"></span>as <span class="_ _3"></span>a</div><div class="t m0 x15 h26 y161 ff19 fsf fc0 sc0 ls0 ws0">separate <span class="_ _2"></span>parameter <span class="_ _2"></span>to <span class="_ _2"></span>the<span class="_ _66"> </span><span class="ff1a">execlp<span class="_ _47"> </span></span>function. <span class="_ _66"> </span>Nevertheless,<span class="_ _66"> </span>this <span class="_ _3"></span>program is <span class="_ _2"></span>still <span class="_ _2"></span>a</div><div class="t m0 x15 h2a y162 ff19 fsf fc0 sc0 ls0 ws0">useful demonstration of the UNIX System’s process contr<span class="_ _0"></span>ol functions.</div><div class="t m0 x32 h2a y25a ff19 fsf fc0 sc0 ls0 ws0">If <span class="_ _53"> </span>we <span class="_ _53"> </span>run <span class="_ _e"> </span>this <span class="_ _53"> </span>program, <span class="_ _53"> </span>we <span class="_ _53"> </span>get <span class="_ _e"> </span>the <span class="_ _53"> </span>following <span class="_ _e"> </span>results. <span class="_ _44"> </span>Note<span class="_ _4b"> </span>that <span class="_ _53"> </span>our <span class="_ _e"> </span>program <span class="_ _53"> </span>has <span class="_ _53"> </span>a</div><div class="t m0 x32 h2a y164 ff19 fsf fc0 sc0 ls0 ws0">differ<span class="_ _0"></span>ent pr<span class="_ _0"></span>ompt <span class="_ _a"></span>— <span class="_ _a"></span>the<span class="_"> </span>percent sign<span class="_ _9"></span><span class="ls9d">—t<span class="_ _6"></span><span class="ls44">od<span class="_ _d"></span><span class="ls0">istinguish it from the shell’s prompt.</span></span></span></div><div class="t m0 x3f h57 y3ef ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">./a.out</span></div><div class="t m0 x3f h57 y3f0 ff1a fs2d fc0 sc0 ls0 ws0">%<span class="_"> </span><span class="ff1f">date</span></div><div class="t m0 x3f h57 y3f1 ff1a fs2d fc0 sc0 ls0 ws0">Sat Jan 21 19:42:07 EST 2012</div><div class="t m0 x3f h57 y3f2 ff1a fs2d fc0 sc0 ls0 ws0">%<span class="_"> </span><span class="ff1f">who</span></div><div class="t m0 x3f h57 y3f3 ff1a fs2d fc0 sc0 ls0 ws0">sar <span class="_ _8a"> </span>console<span class="_ _3a"> </span>Jan <span class="_"> </span>1<span class="_"> </span>14:59</div><div class="t m0 x3f h57 y3f4 ff1a fs2d fc0 sc0 ls0 ws0">sar <span class="_ _8a"> </span>ttys000<span class="_ _3a"> </span>Jan <span class="_"> </span>1<span class="_"> </span>14:59</div><div class="t m0 x3f h57 y3f5 ff1a fs2d fc0 sc0 ls0 ws0">sar <span class="_ _8a"> </span>ttys001<span class="_ _3a"> </span>Jan 15 15:28</div><div class="t m0 x3f h57 y3f6 ff1a fs2d fc0 sc0 ls0 ws0">%<span class="_"> </span><span class="ff1f">pwd</span></div><div class="t m0 x3f h57 y3f7 ff1a fs2d fc0 sc0 ls0 ws0">/home/sar/bk/apue/3e</div><div class="t m0 x3f h57 y3f8 ff1a fs2d fc0 sc0 ls0 ws0">%<span class="_"> </span><span class="ff1f">ls</span></div><div class="t m0 x3f h57 y3f9 ff1a fs2d fc0 sc0 ls0 ws0">Makefile</div><div class="t m0 x3f h57 y3fa ff1a fs2d fc0 sc0 ls0 ws0">a.out</div><div class="t m0 x3f h57 y3fb ff1a fs2d fc0 sc0 ls0 ws0">shell1.c</div><div class="t m0 x3f h57 y3fc ff1a fs2d fc0 sc0 ls0 ws0">%<span class="_"> </span><span class="ff1f">ˆD<span class="_ _8b"> </span><span class="ff1b">type the end-of-ﬁle character</span></span></div><div class="t m0 x3f h57 y3fd ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_ _8c"> </span><span class="ff1b">the regular shell pr<span class="_ _0"></span>ompt</span></div><div class="t m0 x76 h5e y3fe ff19 fs10 fc0 sc0 ls0 ws0">The <span class="_ _66"> </span>notation<span class="_ _59"> </span><span class="ff1a">ˆD<span class="_"> </span></span>is <span class="_ _47"> </span>used <span class="_ _47"> </span>to <span class="_ _66"> </span>indicate <span class="_ _47"> </span>a <span class="_ _66"> </span>control <span class="_ _66"> </span>character<span class="_ _1"></span><span class="ls16e">.C<span class="_ _52"></span><span class="ls0">ontrol <span class="_ _66"> </span>characters <span class="_ _66"> </span>ar<span class="ls16f">es<span class="_ _4a"></span><span class="ls0">pecial</span></span></span></span></div><div class="t m0 x76 h5e y3ff ff19 fs10 fc0 sc0 ls0 ws0">characters <span class="_ _23"> </span>formed <span class="_ _23"> </span>by <span class="_ _42"> </span>holding <span class="_ _23"> </span>down <span class="_ _42"> </span>the <span class="_ _23"> </span>control <span class="_ _23"> </span>key<span class="_ _3"></span><span class="ls170">—o<span class="_ _1"></span><span class="ls0">ften <span class="_ _23"> </span>labeled<span class="_ _45"> </span><span class="ff1a">Control<span class="_ _45"> </span></span>or<span class="_ _45"> </span><span class="ff1a">Ctrl<span class="_ _3"></span></span><span class="ls170">—o<span class="_ _1"></span><span class="ls0">n</span></span></span></span></div><div class="t m0 x76 h2d y400 ff19 fs10 fc0 sc0 ls0 ws0">your <span class="_"> </span>keyboar<span class="_ _0"></span><span class="ls171">da<span class="_ _43"></span><span class="ls0">nd <span class="_"> </span>then <span class="_ _42"> </span>pressing <span class="_"> </span>another <span class="_ _42"> </span>key <span class="_"> </span>at <span class="_ _42"> </span>the <span class="_"> </span>same <span class="_ _42"> </span>time.<span class="_ _5a"> </span>Control</span></span></div><div class="t m0 xb2 h2d y401 ff19 fs10 fc0 sc0 ls0 ws0">-</div><div class="t m0 xb3 h5e y400 ff19 fs10 fc0 sc0 ls0 ws0">D, <span class="_"> </span>or<span class="_ _45"> </span><span class="ff1a">ˆD</span>,<span class="_ _35"> </span>is<span class="_ _35"> </span>the</div><div class="t m0 x76 h2d y402 ff19 fs10 fc0 sc0 ls0 ws0">default <span class="_ _66"> </span>end-of-ﬁle <span class="_ _47"> </span>character<span class="_ _1"></span><span class="ls172">.W<span class="_ _5d"></span><span class="ls0">e’ll <span class="_ _66"> </span>see <span class="_ _47"> </span>many <span class="_ _47"> </span>mor<span class="ls173">ec<span class="_ _4a"></span><span class="ls0">ontrol <span class="_ _66"> </span>characters <span class="_ _47"> </span>when <span class="_ _66"> </span>we <span class="_ _47"> </span>discuss</span></span></span></span></div><div class="t m0 x76 h2d y403 ff19 fs10 fc0 sc0 ls0 ws0">terminal I/O in Chapter 18.</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
