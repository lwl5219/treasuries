<div id="pf7b" class="pf w4 h1f" data-page-no="7b"><div class="pc pc7b w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg7b.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h7a ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>3.16<span class="_ _183"> </span><span class="ff1a">/dev/fd<span class="_ _1b"> </span><span class="ff18">89</span></span></div><div class="t m0 x3f h2a y12f ff19 fsf fc0 sc0 ls0 ws0">In the function call</div><div class="t m0 x3f h57 yd36 ff1a fs2d fc0 sc0 ls0 ws0">fd = open(&quot;/dev/fd/0&quot;, mode);</div><div class="t m0 x32 h26 yd37 ff19 fsf fc0 sc0 ls0 ws0">most systems <span class="_ _2"></span>ignor<span class="ls1bf">et<span class="_ _4f"></span><span class="ls0">he speciﬁed<span class="_ _66"> </span><span class="ff1a">mode</span><span class="ls1bf">,w<span class="_ _d"></span><span class="ls0">hereas others requir<span class="ls1bf">et<span class="_ _4f"></span><span class="ls0">hat it <span class="_ _2"></span>be a <span class="_ _2"></span>subset of <span class="_ _2"></span>the</span></span></span></span></span></span></div><div class="t m0 x32 h2a yd38 ff19 fsf fc0 sc0 ls0 ws0">mode used when the referenced ﬁle (standar<span class="_ _0"></span><span class="ls450">di<span class="_ _d"></span><span class="ls0">nput, in this case) was originally opened.</span></span></div><div class="t m0 x32 h26 yd39 ff19 fsf fc0 sc0 ls0 ws0">Because the previous<span class="_"> </span><span class="ff1a">open<span class="_ _80"> </span></span>is equivalent to</div><div class="t m0 x3f h57 yd9e ff1a fs2d fc0 sc0 ls0 ws0">fd = dup(0);</div><div class="t m0 x32 h26 yd9f ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _42"> </span>descriptors <span class="_ _23"> </span>0 <span class="_ _42"> </span>and<span class="_ _44"> </span><span class="ff1a">fd<span class="_ _35"> </span></span>shar<span class="ls451">et<span class="_ _43"></span><span class="ls0">he <span class="_ _23"> </span>same <span class="_ _42"> </span>ﬁle <span class="_ _42"> </span>table <span class="_ _42"> </span>entry <span class="_ _42"> </span>(Figur<span class="ls452">e3<span class="_ _43"></span><span class="ls0">.9). <span class="_ _35"> </span>For<span class="_ _35"> </span>example, <span class="_ _42"> </span>if</span></span></span></span></div><div class="t m0 x32 h26 yda0 ff19 fsf fc0 sc0 ls0 ws0">descriptor <span class="_ _2"></span>0 <span class="_ _2"></span>was <span class="_ _3"></span>opened <span class="_ _2"></span>read-only<span class="_ _4"></span>,<span class="_ _47"> </span>we<span class="_ _47"> </span>can <span class="_ _2"></span>only <span class="_ _2"></span>read <span class="_ _2"></span>on<span class="_ _47"> </span><span class="ff1a">fd</span><span class="ls453">.E<span class="_ _1d"></span><span class="ls0">ven <span class="_ _3"></span>if <span class="_ _2"></span>the <span class="_ _3"></span>system <span class="_ _2"></span>ignores</span></span></div><div class="t m0 x32 h2a yda1 ff19 fsf fc0 sc0 ls0 ws0">the open mode and the call</div><div class="t m0 x3f h57 yda2 ff1a fs2d fc0 sc0 ls0 ws0">fd = open(&quot;/dev/fd/0&quot;, O_RDWR);</div><div class="t m0 x32 h26 yda3 ff19 fsf fc0 sc0 ls0 ws0">succeeds, we still can’t write to<span class="_"> </span><span class="ff1a">fd</span>.</div><div class="t m0 x76 h52 yda4 ff19 fs2a fc0 sc0 ls0 ws0">The <span class="_ _2"></span>Linux <span class="_ _3"></span>implementation <span class="_ _2"></span>of<span class="_ _80"> </span><span class="ff1a">/dev/fd<span class="_ _66"> </span></span>is <span class="_ _2"></span>an <span class="_ _3"></span>exception.<span class="_ _44"> </span>It <span class="_ _3"></span>maps <span class="_ _3"></span>ﬁle <span class="_ _2"></span>descriptors <span class="_ _3"></span>into <span class="_ _2"></span>symbolic</div><div class="t m0 x76 h52 yda5 ff19 fs2a fc0 sc0 ls0 ws0">links <span class="_ _2"></span>pointing <span class="_ _2"></span>to <span class="_ _2"></span>the <span class="_ _2"></span>underlying <span class="_ _2"></span>physical <span class="_ _2"></span>ﬁles.<span class="_ _44"> </span>When <span class="_ _2"></span>you <span class="_ _2"></span>open<span class="_ _80"> </span><span class="ff1a">/dev/fd/0</span><span class="ls454">,f<span class="_ _5"></span><span class="ls0">or <span class="_ _2"></span>example, <span class="_ _2"></span>you</span></span></div><div class="t m0 x76 h51 yda6 ff19 fs2a fc0 sc0 ls0 ws0">ar<span class="ls455">er<span class="_ _d"></span><span class="ls0">eally <span class="_ _2"></span>opening <span class="_ _2"></span>the <span class="_ _2"></span>ﬁle <span class="_ _2"></span>associated <span class="_ _2"></span>with <span class="_ _2"></span>your <span class="_ _2"></span>standar<span class="ls456">di<span class="_ _5"></span><span class="ls0">nput. <span class="_ _80"> </span>Thus<span class="_ _e"> </span>the <span class="_ _2"></span>mode <span class="_ _3"></span>of <span class="_ _2"></span>the <span class="_ _2"></span>new <span class="_ _2"></span>ﬁle</span></span></span></span></div><div class="t m0 x76 h52 yda7 ff19 fs2a fc0 sc0 ls0 ws0">descriptor returned is unr<span class="_ _0"></span>elated to the mode of the<span class="_"> </span><span class="ff1a">/dev/fd<span class="_ _53"> </span></span>ﬁle descriptor<span class="_ _1"></span>.</div><div class="t m0 x3f h26 yda8 ff19 fsf fc0 sc0 ls5f ws0">We <span class="_ _35"> </span>c<span class="_ _9"></span><span class="ls0">an <span class="_ _53"> </span>also <span class="_ _53"> </span>call<span class="_ _44"> </span><span class="ff1a">creat<span class="_ _4b"> </span></span>with <span class="_ _53"> </span>a<span class="_ _4b"> </span><span class="ff1a">/dev/fd<span class="_ _44"> </span></span>pathname <span class="_ _53"> </span>argument <span class="_ _53"> </span>as <span class="_ _53"> </span>well <span class="_ _53"> </span>as <span class="_ _53"> </span>specify</span></div><div class="t m0 x32 h26 yda9 ff1a fsf fc0 sc0 ls0 ws0">O_CREAT<span class="_ _47"> </span><span class="ff19">in <span class="_ _9"></span>a <span class="_ _9"></span>call <span class="_ _3"></span>to<span class="_ _45"> </span></span>open<span class="ff19 ls457">.T<span class="_ _62"></span><span class="ls0">his <span class="_ _9"></span>allows <span class="_ _3"></span>a <span class="_ _9"></span>program <span class="_ _3"></span>that <span class="_ _3"></span>calls<span class="_ _45"> </span><span class="ff1a">creat<span class="_ _47"> </span></span>to <span class="_ _9"></span>still <span class="_ _9"></span>work <span class="_ _3"></span>if <span class="_ _9"></span>the</span></span></div><div class="t m0 x32 h26 ydaa ff19 fsf fc0 sc0 ls0 ws0">pathname argument is<span class="_"> </span><span class="ff1a">/dev/fd/1</span><span class="ls44">,f<span class="_ _4f"></span><span class="ls0">or example.</span></span></div><div class="t m0 x76 h51 ydab ff19 fs2a fc0 sc0 ls0 ws0">Beware<span class="_ _80"> </span>of<span class="_ _66"> </span>doing <span class="_ _3"></span>this <span class="_ _3"></span>on <span class="_ _3"></span>Linux.<span class="_ _4b"> </span>Because <span class="_ _3"></span>the <span class="_ _9"></span>Linux <span class="_ _3"></span>implementation <span class="_ _3"></span>uses <span class="_ _3"></span>symbolic <span class="_ _3"></span>links <span class="_ _3"></span>to <span class="_ _3"></span>the</div><div class="t m0 x76 h52 ydac ff19 fs2a fc0 sc0 ls34e ws0">re<span class="ls0">al ﬁles, using<span class="_"> </span><span class="ff1a">creat<span class="_ _e"> </span></span>on a<span class="_"> </span><span class="ff1a">/dev/fd<span class="_ _e"> </span></span>ﬁle will result in the underlying ﬁle being truncated.</span></div><div class="t m0 x3f h26 ydad ff19 fsf fc0 sc0 ls0 ws0">Some <span class="_ _65"> </span>systems <span class="_ _48"> </span>provide <span class="_ _48"> </span>the <span class="_ _48"> </span>pathnames<span class="_ _7f"> </span><span class="ff1a">/dev/stdin</span>,<span class="_ _93"> </span><span class="ff1a">/dev/stdout</span><span class="ls458">,a<span class="_ _184"></span><span class="ls0">nd</span></span></div><div class="t m0 x32 h26 ydae ff1a fsf fc0 sc0 ls0 ws0">/dev/stderr<span class="ff19 ls459">.T<span class="_ _56"></span><span class="ls0">hese <span class="_ _47"> </span>pathnames <span class="_ _45"> </span>ar<span class="ls45a">ee<span class="_ _62"></span><span class="ls0">quivalent <span class="_ _47"> </span>to<span class="_ _5a"> </span><span class="ff1a">/dev/fd/0</span>,<span class="_ _16"> </span><span class="ff1a">/dev/fd/1</span><span class="ls45b">,a<span class="_ _1d"></span><span class="ls0">nd</span></span></span></span></span></span></div><div class="t m0 x32 h26 ydaf ff1a fsf fc0 sc0 ls0 ws0">/dev/fd/2<span class="ff19 ls44">,r<span class="_ _4f"></span><span class="ls0">espectively<span class="_ _6"></span>.</span></span></div><div class="t m0 x3f h26 ydb0 ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _23"></span>main <span class="_ _23"> </span>use <span class="_ _23"> </span>of <span class="_ _23"> </span>the<span class="_ _35"> </span><span class="ff1a">/dev/fd<span class="_ _35"> </span></span>ﬁles <span class="_ _23"> </span>is <span class="_ _23"> </span>from <span class="_ _23"> </span>the <span class="_ _23"> </span>shell.<span class="_ _51"> </span>It <span class="_ _23"> </span>allows <span class="_ _23"> </span>programs <span class="_ _23"> </span>that <span class="_ _23"> </span>use</div><div class="t m0 x32 h2a ydb1 ff19 fsf fc0 sc0 ls0 ws0">pathname <span class="_ _45"> </span>ar<span class="_ _0"></span>guments <span class="_ _45"> </span>to <span class="_ _47"> </span>handle <span class="_ _45"> </span>standar<span class="ls45c">di<span class="_ _62"></span><span class="ls0">nput <span class="_ _45"> </span>and <span class="_ _47"> </span>standar<span class="ls45c">do<span class="_ _62"></span><span class="ls0">utput <span class="_ _45"> </span>in <span class="_ _45"> </span>the <span class="_ _47"> </span>same</span></span></span></span></div><div class="t m0 x32 h26 ydb2 ff19 fsf fc0 sc0 ls0 ws0">manner <span class="_ _2"></span>as <span class="_ _3"></span>other <span class="_ _3"></span>pathnames.<span class="_ _16"> </span>For <span class="_ _3"></span>example, <span class="_ _3"></span>the<span class="_ _47"> </span><span class="ff1a">cat</span></div><div class="t m0 x177 h2a ydb3 ff19 fsf fc0 sc0 ls0 ws0">(</div><div class="t m0 x117 h2a ydb2 ff19 fsf fc0 sc0 ls0 ws0">1</div><div class="t m0 x81 h2a ydb3 ff19 fsf fc0 sc0 ls0 ws0">)</div><div class="t m0 x178 h2a ydb2 ff19 fsf fc0 sc0 ls0 ws0">program <span class="_ _2"></span>speciﬁcally <span class="_ _3"></span>looks <span class="_ _3"></span>for <span class="_ _2"></span>an</div><div class="t m0 x32 h26 ydb4 ff19 fsf fc0 sc0 ls0 ws0">input ﬁlename of<span class="_"> </span><span class="ff1a">-<span class="_ _80"> </span></span>and uses it to mean standar<span class="ls44">di<span class="_ _d"></span><span class="ls0">nput. <span class="_"> </span>The<span class="_"> </span>command</span></span></div><div class="t m0 x3f h57 ydb5 ff1a fs2d fc0 sc0 ls0 ws0">filter file2 | cat file1 - file3 | lpr</div><div class="t m0 x32 h26 ydb6 ff19 fsf fc0 sc0 ls0 ws0">is <span class="_"> </span>an <span class="_"> </span>example.<span class="_ _48"> </span>First,<span class="_ _46"> </span><span class="ff1a">cat<span class="_ _46"> </span></span><span class="ls45">re</span>ads<span class="_ _46"> </span><span class="ff1a">file1</span><span class="ls45d">,t<span class="_ _4a"></span><span class="ls0">hen <span class="_"> </span>its <span class="_"> </span>standar<span class="ls45d">di<span class="_ _5b"></span><span class="ls0">nput <span class="_"> </span>(the <span class="_"> </span>output <span class="_"> </span>of <span class="_"> </span>the</span></span></span></span></div><div class="t m0 x32 h26 ydb7 ff1a fsf fc0 sc0 ls0 ws0">filter<span class="_ _35"> </span><span class="ff19">program <span class="_ _42"> </span>on<span class="_ _44"> </span></span>file2<span class="ff19">), <span class="_ _23"> </span>and <span class="_ _42"> </span>then<span class="_ _44"> </span></span>file3<span class="ff19 ls45e">.I<span class="_ _7"></span><span class="ls0">f<span class="_ _35"> </span><span class="ff1a">/dev/fd<span class="_ _44"> </span></span>is <span class="_ _42"> </span>supported, <span class="_ _42"> </span>the <span class="_ _42"> </span>special</span></span></div><div class="t m0 x32 h26 ydb8 ff19 fsf fc0 sc0 ls0 ws0">handling of<span class="_"> </span><span class="ff1a">-<span class="_ _80"> </span></span>can be removed from<span class="_"> </span><span class="ff1a">cat</span><span class="ls44">,a<span class="_ _4f"></span><span class="ls0">nd we can enter</span></span></div><div class="t m0 x3f h57 ydb9 ff1a fs2d fc0 sc0 ls0 ws0">filter file2 | cat file1 /dev/fd/0 file3 | lpr</div><div class="t m0 x3f h26 ydba ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _53"> </span>special <span class="_ _e"> </span>meaning <span class="_ _e"> </span>of<span class="_ _4b"> </span><span class="ff1a">-<span class="_ _4b"> </span></span>as <span class="_ _e"> </span>a <span class="_ _e"> </span>command</div><div class="t m0 x179 h2a ydbb ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 x17a h2a ydba ff19 fsf fc0 sc0 ls0 ws0">line <span class="_ _53"> </span>argument <span class="_ _53"> </span>to <span class="_ _e"> </span>refer <span class="_ _53"> </span>to <span class="_ _e"> </span>the <span class="_ _e"> </span>standard</div><div class="t m0 x32 h2a ydbc ff19 fsf fc0 sc0 ls0 ws0">input <span class="_ _3"></span>or <span class="_ _3"></span>the <span class="_ _3"></span>standar<span class="ls45f">do<span class="_ _8"></span><span class="ls0">utput <span class="_ _3"></span>is <span class="_ _3"></span>a <span class="_ _3"></span>kludge <span class="_ _3"></span>that <span class="_ _9"></span>has <span class="_ _3"></span>crept <span class="_ _2"></span>into <span class="_ _3"></span>many <span class="_ _9"></span>programs. <span class="_ _66"> </span>Ther<span class="ls460">ea<span class="_ _8"></span><span class="ls45">re</span></span></span></span></div><div class="t m0 x32 h26 ydbd ff19 fsf fc0 sc0 ls0 ws0">also <span class="_"> </span>problems <span class="_"> </span>if <span class="_"> </span>we <span class="_"> </span>specify<span class="_ _59"> </span><span class="ff1a">-<span class="_ _46"> </span></span>as <span class="_ _66"> </span>the <span class="_"> </span>ﬁrst <span class="_"> </span>ﬁle, <span class="_"> </span>as <span class="_ _66"> </span>it <span class="_"> </span>looks <span class="_"> </span>like <span class="_"> </span>the <span class="_ _66"> </span>start <span class="_"> </span>of <span class="_"> </span>another</div><div class="t m0 x32 h2a ydbe ff19 fsf fc0 sc0 ls0 ws0">command</div><div class="t m0 xc3 h2a ydbf ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 xc4 h26 ydbe ff19 fsf fc0 sc0 ls0 ws0">line option.<span class="_ _59"> </span>Using<span class="_"> </span><span class="ff1a">/dev/fd<span class="_ _66"> </span></span>is a step towar<span class="ls44">du<span class="_ _4f"></span><span class="ls0">niformity and cleanliness.</span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
