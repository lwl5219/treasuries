<div id="pfdd" class="pf w4 h1f" data-page-no="dd"><div class="pc pcdd w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bgdd.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>6.9<span class="_ _1fc"> </span>System <span class="_"> </span>Identiﬁcation<span class="_ _1b"> </span><span class="ff18">187</span></div><div class="t m0 x3f h57 y1945 ff1a fs2d fc0 sc0 ls0 ws0">struct utmp {</div><div class="t m0 xf4 h57 y1946 ff1a fs2d fc0 sc0 ls0 ws0">char <span class="_"> </span>ut_line[8];<span class="_"> </span>/* tty line: &quot;ttyh0&quot;, &quot;ttyd0&quot;, &quot;ttyp0&quot;, ... */</div><div class="t m0 xf4 h57 y1947 ff1a fs2d fc0 sc0 ls0 ws0">char <span class="_"> </span>ut_name[8];<span class="_"> </span>/* login name */</div><div class="t m0 xf4 h57 y1948 ff1a fs2d fc0 sc0 ls0 ws0">long <span class="_"> </span>ut_time;<span class="_ _15"> </span>/* seconds since Epoch */</div><div class="t m0 x3f h57 y1949 ff1a fs2d fc0 sc0 ls0 ws0">};</div><div class="t m0 x32 h26 y194a ff19 fsf fc0 sc0 ls0 ws0">On login, <span class="_ _2"></span>one <span class="_ _2"></span>of <span class="_ _2"></span>these structures was <span class="_ _2"></span>ﬁlled <span class="_ _2"></span>in and <span class="_ _2"></span>written <span class="_ _2"></span>to <span class="_ _2"></span>the<span class="_"> </span><span class="ff1a">utmp<span class="_ _66"> </span></span>ﬁle <span class="_ _2"></span>by <span class="_ _2"></span>the<span class="_ _66"> </span><span class="ff1a">login</span></div><div class="t m0 x32 h26 y194b ff19 fsf fc0 sc0 ls0 ws0">program, <span class="_ _3"></span>and <span class="_ _9"></span>the <span class="_ _9"></span>same <span class="_ _3"></span>structur<span class="ls7dd">ew<span class="_ _b"></span><span class="ls0">as <span class="_ _9"></span>appended <span class="_ _9"></span>to <span class="_ _3"></span>the<span class="_ _45"> </span><span class="ff1a">wtmp<span class="_ _45"> </span></span>ﬁle. <span class="_ _45"> </span>On<span class="_ _47"> </span>logout, <span class="_ _9"></span>the <span class="_ _9"></span>entry</span></span></div><div class="t m0 x32 h26 y194c ff19 fsf fc0 sc0 ls0 ws0">in <span class="_ _23"></span>the<span class="_ _45"> </span><span class="ff1a">utmp<span class="_ _35"> </span></span>ﬁle <span class="_ _9"></span>was <span class="_ _23"> </span>erased<span class="_ _9"></span><span class="ls9d">—ﬁ<span class="_ _6"></span><span class="ls0">lled <span class="_ _23"></span>with <span class="_ _23"></span>null <span class="_ _9"></span>bytes<span class="_ _9"></span><span class="ls9d">—b<span class="_ _1"></span><span class="ls7de">yt<span class="_ _b"></span><span class="ls0">he<span class="_ _45"> </span><span class="ff1a">init<span class="_ _45"> </span></span>process, <span class="_ _23"></span>and <span class="_ _9"></span>a <span class="_ _23"> </span>new</span></span></span></span></span></div><div class="t m0 x32 h26 y194d ff19 fsf fc0 sc0 ls0 ws0">entry <span class="_"> </span>was <span class="_"> </span>appended <span class="_ _66"> </span>to <span class="_ _66"> </span>the<span class="_ _46"> </span><span class="ff1a">wtmp<span class="_ _61"> </span></span>ﬁle. <span class="_ _46"> </span>This<span class="_ _46"> </span>logout <span class="_ _66"> </span>entry <span class="_ _66"> </span>in <span class="_"> </span>the<span class="_ _61"> </span><span class="ff1a">wtmp<span class="_ _46"> </span></span>ﬁle <span class="_"> </span>had <span class="_ _66"> </span>the</div><div class="t m0 x32 h26 y194e ff1a fsf fc0 sc0 ls0 ws0">ut_name<span class="_ _45"> </span><span class="ff19">ﬁeld <span class="_ _23"> </span>zeroed <span class="_ _9"></span>out.<span class="_ _51"> </span>Special <span class="_ _23"></span>entries <span class="_ _9"></span>wer<span class="ls7df">ea<span class="_ _b"></span><span class="ls0">ppended <span class="_ _9"></span>to <span class="_ _23"></span>the<span class="_ _45"> </span><span class="ff1a">wtmp<span class="_ _35"> </span></span>ﬁle <span class="_ _9"></span>to <span class="_ _23"> </span>indicate</span></span></span></div><div class="t m0 x32 h2a y194f ff19 fsf fc0 sc0 ls0 ws0">when <span class="_ _23"></span>the <span class="_ _23"> </span>system <span class="_ _23"> </span>was <span class="_ _23"> </span>rebooted <span class="_ _23"> </span>and <span class="_ _23"> </span>right <span class="_ _42"> </span>befor<span class="_ _0"></span><span class="ls7e0">ea<span class="_ _43"></span><span class="ls0">nd <span class="_ _23"> </span>after <span class="_ _42"> </span>the <span class="_ _23"></span>system’s <span class="_ _23"> </span>time <span class="_ _23"> </span>and <span class="_ _23"> </span>date</span></span></div><div class="t m0 x32 h26 y1950 ff19 fsf fc0 sc0 ls0 ws0">was <span class="_ _53"> </span>changed.<span class="_ _48"> </span>The<span class="_ _4b"> </span><span class="ff1a">who</span></div><div class="t m0 x36 h2a y1951 ff19 fsf fc0 sc0 ls0 ws0">(</div><div class="t m0 x2f h2a y1950 ff19 fsf fc0 sc0 ls0 ws0">1</div><div class="t m0 x6b h2a y1951 ff19 fsf fc0 sc0 ls0 ws0">)</div><div class="t m0 x13c h26 y1950 ff19 fsf fc0 sc0 ls0 ws0">program <span class="_ _53"> </span>read <span class="_ _42"> </span>the<span class="_ _4b"> </span><span class="ff1a">utmp<span class="_ _4b"> </span></span>ﬁle <span class="_ _e"> </span>and <span class="_ _e"> </span>printed <span class="_ _53"> </span>its <span class="_ _e"> </span>contents <span class="_ _e"> </span>in <span class="_ _53"> </span>a</div><div class="t m0 x32 h26 y1952 ff19 fsf fc0 sc0 ls45 ws0">re<span class="ls0">adable <span class="_ _53"> </span>form.<span class="_ _65"> </span>Later <span class="_ _53"> </span>versions <span class="_ _53"> </span>of <span class="_ _53"> </span>the <span class="_ _53"> </span>UNIX <span class="_ _53"> </span>System <span class="_ _53"> </span>provided <span class="_ _42"> </span>the<span class="_ _4b"> </span><span class="ff1a">last</span></span></div><div class="t m0 x3b h2a y1953 ff19 fsf fc0 sc0 ls0 ws0">(</div><div class="t m0 xb3 h2a y1952 ff19 fsf fc0 sc0 ls0 ws0">1</div><div class="t m0 x1d4 h2a y1953 ff19 fsf fc0 sc0 ls0 ws0">)</div><div class="t m0 x1d5 h2a y1952 ff19 fsf fc0 sc0 ls0 ws0">command,</div><div class="t m0 x32 h26 y1954 ff19 fsf fc0 sc0 ls0 ws0">which read thr<span class="_ _0"></span>ough the<span class="_"> </span><span class="ff1a">wtmp<span class="_ _80"> </span></span>ﬁle and printed selected entries.</div><div class="t m0 x3f h26 y1955 ff19 fsf fc0 sc0 ls0 ws0">Most <span class="_ _42"> </span>versions <span class="_ _42"> </span>of <span class="_ _42"> </span>the <span class="_ _53"> </span>UNIX <span class="_ _42"> </span>System <span class="_ _42"> </span>still <span class="_ _42"> </span>provide <span class="_ _42"> </span>the<span class="_ _44"> </span><span class="ff1a">utmp<span class="_ _44"> </span></span>and<span class="_ _44"> </span><span class="ff1a">wtmp<span class="_ _44"> </span></span>ﬁles, <span class="_ _42"> </span>but <span class="_ _42"> </span>as</div><div class="t m0 x32 h2a y1956 ff19 fsf fc0 sc0 ls0 ws0">expected, the amount of <span class="_ _2"></span>information in these ﬁles <span class="_ _2"></span>has grown. <span class="_"> </span>The<span class="_"> </span>20</div><div class="t m0 xe3 h2a y1957 ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 x151 h2a y1956 ff19 fsf fc0 sc0 ls0 ws0">byte structur<span class="ls7e1">et<span class="_ _4f"></span><span class="ls0">hat</span></span></div><div class="t m0 x32 h26 y1958 ff19 fsf fc0 sc0 ls0 ws0">was <span class="_ _2"></span>written <span class="_ _3"></span>by <span class="_ _2"></span>V<span class="_ _6"></span>ersion <span class="_ _2"></span>7 <span class="_ _3"></span>grew <span class="_ _2"></span>to <span class="_ _2"></span>36 <span class="_ _3"></span>bytes <span class="_ _2"></span>with <span class="_ _3"></span>SVR2, <span class="_ _3"></span>and <span class="_ _2"></span>the <span class="_ _3"></span>extended<span class="_ _47"> </span><span class="ff1a">utmp<span class="_ _47"> </span></span>structur<span class="_ _0"></span>e</div><div class="t m0 x32 h2a y1959 ff19 fsf fc0 sc0 ls0 ws0">with SVR4 takes mor<span class="ls44">et<span class="_ _4f"></span><span class="ls0">han 350 bytes!</span></span></div><div class="t m0 x76 h52 y195a ff19 fs2a fc0 sc0 ls0 ws0">The <span class="_ _9"> </span>detailed <span class="_ _23"> </span>format <span class="_ _23"> </span>of <span class="_ _9"></span>these <span class="_ _23"> </span>recor<span class="_ _0"></span>ds <span class="_ _9"> </span>in <span class="_ _23"> </span>Solaris <span class="_ _23"> </span>is <span class="_ _9"></span>given <span class="_ _23"> </span>in <span class="_ _9"> </span>the<span class="_ _45"> </span><span class="ff1a">utmpx</span>(4) <span class="_ _9"></span>manual <span class="_ _23"> </span>page.<span class="_ _46"> </span><span class="ls341">Wi<span class="_ _2"></span></span>th</div><div class="t m0 x76 h52 y195b ff19 fs2a fc0 sc0 ls0 ws0">Solaris <span class="_"> </span>10, <span class="_ _42"> </span>both <span class="_"> </span>ﬁles <span class="_ _42"> </span>are<span class="_ _45"> </span>in<span class="_ _35"> </span>the<span class="_ _35"> </span><span class="ff1a">/var/adm<span class="_ _35"> </span></span>directory<span class="_ _6"></span><span class="ls7e2">.S<span class="_ _62"></span><span class="ls0">olaris <span class="_"> </span>pr<span class="_ _0"></span>ovides <span class="_ _42"> </span>numerous <span class="_"> </span>functions</span></span></div><div class="t m0 x76 h52 y195c ff19 fs2a fc0 sc0 ls0 ws0">described in<span class="_"> </span><span class="ff1a">getutxent</span>(3) to read and write these two ﬁles.</div><div class="t m0 x76 h52 y195d ff19 fs2a fc0 sc0 ls0 ws0">On FreeBSD 8.0 <span class="_ _2"></span>and <span class="_ _2"></span>Linux 3.2.0, <span class="_ _2"></span>the<span class="_ _80"> </span><span class="ff1a">utmp</span>(5) manual <span class="_ _2"></span>page <span class="_ _2"></span>gives the <span class="_ _2"></span>format <span class="_ _2"></span>of their <span class="_ _2"></span>versions <span class="_ _2"></span>of</div><div class="t m0 x76 h52 y195e ff19 fs2a fc0 sc0 ls0 ws0">these <span class="_ _59"> </span>login <span class="_ _46"> </span>records. <span class="_ _54"> </span>The<span class="_ _48"> </span>pathnames <span class="_ _46"> </span>of <span class="_ _59"> </span>these <span class="_ _46"> </span>two <span class="_ _46"> </span>ﬁles <span class="_ _46"> </span>are<span class="_ _65"> </span><span class="ff1a">/var/run/utmp<span class="_ _65"> </span></span>and</div><div class="t m0 x76 h52 y195f ff1a fs2a fc0 sc0 ls0 ws0">/var/log/wtmp<span class="ff19 ls7e3">.O<span class="_ _c"></span><span class="ls7e4">nM<span class="_ _5"></span><span class="ls0">ac <span class="_ _2"></span>OS <span class="_ _2"></span>X <span class="_ _2"></span>10.6.8, the<span class="_ _80"> </span><span class="ff1a">utmp<span class="_ _e"> </span></span>and<span class="_ _80"> </span><span class="ff1a">wtmp<span class="_ _e"> </span></span>ﬁles <span class="_ _2"></span>do <span class="_ _2"></span>not exist.<span class="_ _4b"> </span>As of <span class="_ _2"></span>Mac <span class="_ _2"></span>OS X</span></span></span></div><div class="t m0 x76 h52 y1960 ff19 fs2a fc0 sc0 ls0 ws0">10.5, <span class="_ _3"></span>the <span class="_ _9"></span>information <span class="_ _3"></span>found <span class="_ _9"></span>in <span class="_ _3"></span>the<span class="_ _66"> </span><span class="ff1a">wtmp<span class="_ _66"> </span></span>ﬁle <span class="_ _9"></span>can <span class="_ _3"></span>be <span class="_ _9"></span>obtained <span class="_ _3"></span>from <span class="_ _3"></span>the <span class="_ _9"></span>system <span class="_ _3"></span>logging <span class="_ _3"></span>facility<span class="_ _1"></span>,</div><div class="t m0 x76 h52 y1961 ff19 fs2a fc0 sc0 ls0 ws0">and the<span class="_"> </span><span class="ff1a">utmpx<span class="_ _53"> </span></span>ﬁle contains information about the active login sessions.</div><div class="t m0 x35 h53 y1962 ff16 fs2b fc0 sc0 ls0 ws0">6.9 <span class="_ _68"> </span>System<span class="_ _54"> </span>Identiﬁcation</div><div class="t m0 x32 h26 y1963 ff19 fsf fc0 sc0 ls0 ws0">POSIX.1 <span class="_"> </span>deﬁnes <span class="_"> </span>the<span class="_ _4b"> </span><span class="ff1a">uname<span class="_ _46"> </span></span>function <span class="_"> </span>to <span class="_"> </span>r<span class="_ _1"></span>eturn <span class="_"> </span>information <span class="_"> </span>on <span class="_"> </span>the <span class="_ _e"> </span>current <span class="_"> </span>host <span class="_"> </span>and</div><div class="t m0 x32 h2a y1964 ff19 fsf fc0 sc0 ls0 ws0">operating system.</div><div class="t m0 x3f h57 y1965 ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;sys/utsname.h&gt;</div><div class="t m0 x3f h57 y1966 ff1a fs2d fc0 sc0 ls0 ws0">int uname(struct utsname *<span class="ff1b">name</span>);</div><div class="t m0 x1ac h5f y1967 ff19 fs2d fc0 sc0 ls0 ws0">Returns: non-negative value if OK,<span class="_"> </span><span class="ff20">−</span>1<span class="_"> </span>on<span class="_"> </span>error</div><div class="t m0 x32 h4d y1968 ff19 fs26 fc0 sc0 ls164 ws0">We <span class="_ _80"> </span>p<span class="_ _9"></span><span class="ls0">ass <span class="_ _3"></span>the <span class="_ _2"></span>address <span class="_ _3"></span>of <span class="_ _3"></span>a<span class="_ _47"> </span><span class="ff1a">utsname<span class="_ _47"> </span></span>structur<span class="_ _0"></span>e<span class="_ _47"> </span>to<span class="_ _47"> </span>this <span class="_ _2"></span>function, <span class="_ _3"></span>and <span class="_ _3"></span>the <span class="_ _3"></span>function <span class="_ _3"></span>then <span class="_ _3"></span>ﬁlls</span></div><div class="t m0 x32 h49 y1969 ff19 fs26 fc0 sc0 ls0 ws0">it <span class="_ _3"></span>in.<span class="_ _61"> </span>POSIX.1 <span class="_ _9"></span>deﬁnes <span class="_ _2"></span>only <span class="_ _3"></span>the <span class="_ _3"></span>minimum <span class="_ _9"></span>ﬁelds <span class="_ _2"></span>in <span class="_ _3"></span>the <span class="_ _3"></span>structure, <span class="_ _3"></span>which <span class="_ _3"></span>ar<span class="ls6fe">ea<span class="_ _b"></span><span class="ls0">ll <span class="_ _3"></span>character</span></span></div><div class="t m0 x32 h49 y196a ff19 fs26 fc0 sc0 ls0 ws0">arrays, <span class="_ _45"> </span>and <span class="_ _35"> </span>it’s <span class="_ _35"> </span>up <span class="_ _45"> </span>to <span class="_ _35"> </span>each <span class="_ _45"> </span>implementation <span class="_ _35"> </span>to <span class="_ _35"> </span>set <span class="_ _45"> </span>the <span class="_ _35"> </span>size <span class="_ _45"> </span>of <span class="_ _35"> </span>each <span class="_ _35"> </span>array<span class="_ _4"></span><span class="ls7e5">.S<span class="_ _4d"></span><span class="ls0">ome</span></span></div><div class="t m0 x32 h49 y196b ff19 fs26 fc0 sc0 ls0 ws0">implementations provide additional ﬁelds in the str<span class="_ _0"></span>ucture.</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.888004px;bottom:484.108816px;width:160.030899px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
