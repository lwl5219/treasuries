<div id="pf38" class="pf w4 h1f" data-page-no="38"><div class="pc pc38 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg38.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">22<span class="_ _1b"> </span><span class="ff19">UNIX <span class="_"> </span>System <span class="_"> </span>Overview<span class="_ _85"> </span>Chapter <span class="_"> </span>1</span></div><div class="t m0 xc5 h51 y534 ff19 fs2a fc0 sc0 ls0 ws0">application</div><div class="t m0 x67 h51 y535 ff19 fs2a fc0 sc0 ls0 ws0">code</div><div class="t m0 xb5 h2e y536 ff19 fs11 fc0 sc0 ls0 ws0">memory allocation</div><div class="t m0 xc6 h4f y537 ff19 fs11 fc0 sc0 ls0 ws0">function<span class="_"> </span><span class="ff1a">malloc</span></div><div class="t m0 x45 h63 y538 ff1a fs13 fc0 sc0 ls0 ws0">sbrk</div><div class="t m0 xc5 h30 y539 ff19 fs13 fc0 sc0 ls0 ws0">system call</div><div class="t m0 x97 h31 y53a ff19 fs14 fc0 sc0 ls0 ws0">kernel</div><div class="t m0 x75 h32 y53b ff19 fs15 fc0 sc0 ls0 ws0">user process</div><div class="t m0 x50 h66 y53c ff18 fs15 fc0 sc0 ls0 ws0">Figure 1.1<span class="_ _0"></span>1<span class="_ _5a"> </span><span class="ff19">Separation of<span class="_"> </span><span class="ff1a">malloc<span class="_ _e"> </span></span>function and<span class="_"> </span><span class="ff1a">sbrk<span class="_ _e"> </span></span>system call</span></div><div class="t m0 x3f h67 y53d ff19 fs33 fc0 sc0 ls0 ws0">Here<span class="_"> </span>we<span class="_ _47"> </span>have <span class="_ _3"></span>a <span class="_ _2"></span>clean <span class="_ _3"></span>separation <span class="_ _2"></span>of <span class="_ _3"></span>duties: <span class="_ _2"></span>the <span class="_ _3"></span>system <span class="_ _2"></span>call <span class="_ _3"></span>in <span class="_ _3"></span>the <span class="_ _2"></span>kernel <span class="_ _3"></span>allocates <span class="_ _2"></span>an</div><div class="t m0 x32 h68 y53e ff19 fs33 fc0 sc0 ls0 ws0">additional <span class="_ _66"> </span>chunk <span class="_ _47"> </span>of <span class="_ _47"> </span>space <span class="_ _47"> </span>on <span class="_ _66"> </span>behalf <span class="_ _47"> </span>of <span class="_ _47"> </span>the <span class="_ _66"> </span>process. <span class="_ _61"> </span>The<span class="_ _61"> </span><span class="ff1a">malloc<span class="_ _16"> </span></span>library <span class="_ _47"> </span>function</div><div class="t m0 x32 h67 y53f ff19 fs33 fc0 sc0 ls0 ws0">manages this space from user level.</div><div class="t m0 x3f h67 y540 ff19 fs33 fc0 sc0 ls0 ws0">Another <span class="_ _53"> </span>example <span class="_ _53"> </span>to <span class="_ _42"> </span>illustrate <span class="_ _53"> </span>the <span class="_ _53"> </span>difference <span class="_ _42"> </span>between <span class="_ _53"> </span>a <span class="_ _53"> </span>system <span class="_ _53"> </span>call <span class="_ _53"> </span>and <span class="_ _53"> </span>a <span class="_ _53"> </span>library</div><div class="t m0 x32 h67 y541 ff19 fs33 fc0 sc0 ls0 ws0">function <span class="_ _9"></span>is <span class="_ _23"></span>the <span class="_ _23"></span>interface <span class="_ _9"></span>the <span class="_ _23"></span>UNIX <span class="_ _9"></span>System <span class="_ _23"></span>provides <span class="_ _9"></span>to <span class="_ _23"></span>determine <span class="_ _9"></span>the <span class="_ _23"></span>current <span class="_ _9"></span>time <span class="_ _9"></span>and</div><div class="t m0 x32 h67 y542 ff19 fs33 fc0 sc0 ls0 ws0">date. <span class="_"> </span>Some<span class="_ _66"> </span>operating systems <span class="_ _2"></span>provide one system <span class="_ _2"></span>call to <span class="_ _2"></span>return the time <span class="_ _2"></span>and another <span class="_ _2"></span>to</div><div class="t m0 x32 h67 y543 ff19 fs33 fc0 sc0 ls1d5 ws0">re<span class="ls0">turn <span class="_ _42"> </span>the <span class="_ _23"> </span>date.<span class="_ _51"> </span>Any <span class="_ _42"> </span>special <span class="_ _23"> </span>handling, <span class="_ _42"> </span>such <span class="_ _23"> </span>as <span class="_ _42"> </span>the <span class="_ _23"> </span>switch <span class="_ _42"> </span>to <span class="_ _23"> </span>or <span class="_ _23"> </span>from <span class="_ _23"> </span>daylight <span class="_ _42"> </span>saving</span></div><div class="t m0 x32 h67 y544 ff19 fs33 fc0 sc0 ls0 ws0">time, <span class="_ _23"></span>is <span class="_ _23"> </span>handled <span class="_ _23"> </span>by <span class="_ _23"> </span>the <span class="_ _42"> </span>kernel <span class="_ _23"></span>or <span class="_ _23"> </span>requires <span class="_ _9"></span>human <span class="_ _23"> </span>intervention.<span class="_ _51"> </span>The <span class="_ _42"> </span>UNIX <span class="_ _23"></span>System, <span class="_ _23"> </span>in</div><div class="t m0 x32 h67 y545 ff19 fs33 fc0 sc0 ls0 ws0">contrast, <span class="_ _53"> </span>provides <span class="_ _53"> </span>a <span class="_ _53"> </span>single <span class="_ _e"> </span>system <span class="_ _53"> </span>call <span class="_ _e"> </span>that <span class="_ _e"> </span>returns <span class="_ _42"> </span>the <span class="_ _e"> </span>number <span class="_ _e"> </span>of <span class="_ _53"> </span>seconds <span class="_ _e"> </span>since <span class="_ _53"> </span>the</div><div class="t m0 x32 h67 y546 ff19 fs33 fc0 sc0 ls0 ws0">Epoch: <span class="_ _23"></span>midnight, <span class="_ _9"></span>January <span class="_ _23"> </span>1, <span class="_ _23"> </span>1970, <span class="_ _23"></span>Coordinated <span class="_ _9"></span>Universal <span class="_ _23"></span>T<span class="_ _1"></span>ime. <span class="_ _35"> </span>Any<span class="_ _45"> </span>interpretation <span class="_ _23"></span>of</div><div class="t m0 x32 h67 y547 ff19 fs33 fc0 sc0 ls0 ws0">this <span class="_ _2"></span>value, <span class="_ _2"></span>such <span class="_ _2"></span>as <span class="_ _2"></span>converting <span class="_ _2"></span>it <span class="_ _2"></span>to <span class="_ _3"></span>a <span class="_ _2"></span>human-readable time <span class="_ _2"></span>and <span class="_ _2"></span>date <span class="_ _3"></span>using <span class="_ _2"></span>the <span class="_ _2"></span>local <span class="_ _2"></span>time</div><div class="t m0 x32 h67 y548 ff19 fs33 fc0 sc0 ls0 ws0">zone, <span class="_ _42"> </span>is <span class="_ _42"> </span>left <span class="_ _53"> </span>to <span class="_ _42"> </span>the <span class="_ _53"> </span>user <span class="_ _42"> </span>process. <span class="_ _44"> </span>The<span class="_ _44"> </span>standar<span class="_ _0"></span><span class="ls1d6">dCl<span class="_ _c"></span><span class="ls0">ibrary <span class="_ _53"> </span>provides <span class="_ _42"> </span>routines <span class="_ _42"> </span>to <span class="_ _42"> </span>handle</span></span></div><div class="t m0 x32 h67 y549 ff19 fs33 fc0 sc0 ls0 ws0">most <span class="_ _42"> </span>cases.<span class="_ _65"> </span>These <span class="_ _53"> </span>library <span class="_ _53"> </span>routines <span class="_ _42"> </span>handle <span class="_ _53"> </span>such <span class="_ _53"> </span>details <span class="_ _53"> </span>as <span class="_ _53"> </span>the <span class="_ _53"> </span>various <span class="_ _53"> </span>algorithms <span class="_ _53"> </span>for</div><div class="t m0 x32 h67 y54a ff19 fs33 fc0 sc0 ls0 ws0">daylight saving time.</div><div class="t m0 x3f h67 y54b ff19 fs33 fc0 sc0 ls0 ws0">An <span class="_ _9"></span>application <span class="_ _9"></span>can <span class="_ _9"></span>either <span class="_ _3"></span>make <span class="_ _9"></span>a <span class="_ _9"></span>system <span class="_ _9"></span>call <span class="_ _9"></span>or <span class="_ _9"></span>call <span class="_ _9"></span>a <span class="_ _9"></span>library <span class="_ _9"></span>routine. <span class="_ _47"> </span>Also<span class="_ _45"> </span><span class="ls1d5">re<span class="_ _2"></span></span>alize</div><div class="t m0 x32 h67 y54c ff19 fs33 fc0 sc0 ls0 ws0">that many library routines invoke a system call.<span class="_ _59"> </span>This is shown in Figur<span class="ls1d7">e1<span class="_ _4f"></span><span class="ls0">.12.</span></span></div><div class="t m0 x3f h67 y54d ff19 fs33 fc0 sc0 ls0 ws0">Another <span class="_ _23"></span>differ<span class="_ _1"></span>ence <span class="_ _23"> </span>between <span class="_ _23"> </span>system <span class="_ _23"> </span>calls <span class="_ _23"> </span>and <span class="_ _23"> </span>library <span class="_ _23"> </span>functions <span class="_ _23"> </span>is <span class="_ _23"> </span>that <span class="_ _23"> </span>system <span class="_ _23"></span>calls</div><div class="t m0 x32 h67 y54e ff19 fs33 fc0 sc0 ls0 ws0">usually <span class="_"> </span>provide <span class="_"> </span>a <span class="_ _66"> </span>minimal <span class="_ _66"> </span>interface, <span class="_ _66"> </span>whereas <span class="_"> </span>library <span class="_"> </span>functions <span class="_ _66"> </span>often <span class="_ _66"> </span>provide <span class="_"> </span>more</div><div class="t m0 x32 h68 y54f ff19 fs33 fc0 sc0 ls0 ws0">elaborate <span class="_ _e"> </span>functionality<span class="_ _4"></span><span class="ls1d8">.W<span class="_ _49"></span><span class="ls0">eâ€™ve <span class="_ _53"> </span>seen <span class="_"> </span>this <span class="_ _53"> </span>already <span class="_ _e"> </span>in <span class="_ _e"> </span>the <span class="_"> </span>dif<span class="_ _1"></span>ference <span class="_ _e"> </span>between <span class="_"> </span>the<span class="_ _44"> </span><span class="ff1a">sbrk</span></span></span></div><div class="t m0 x32 h68 y550 ff19 fs33 fc0 sc0 ls0 ws0">system <span class="_ _2"></span>call <span class="_ _3"></span>and <span class="_ _2"></span>the<span class="_ _47"> </span><span class="ff1a">malloc<span class="_ _47"> </span></span>library <span class="_ _2"></span>function.<span class="_ _16"> </span><span class="ls1d9">We<span class="_ _9"></span></span>â€™ll <span class="_ _3"></span>see <span class="_ _2"></span>this <span class="_ _3"></span>difference again <span class="_ _3"></span>later<span class="_ _6"></span><span class="ls1da">,w<span class="_ _4f"></span><span class="ls0">hen</span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
