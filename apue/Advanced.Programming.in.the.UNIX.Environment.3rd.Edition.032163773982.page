<div id="pf52" class="pf w4 h1f" data-page-no="52"><div class="pc pc52 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg52.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">48<span class="_ _1b"> </span><span class="ff19">UNIX <span class="_"> </span>Standardization <span class="_"> </span>and <span class="_"> </span>Implementations<span class="_ _99"> </span>Chapter <span class="_"> </span>2</span></div><div class="t m0 x126 h57 y425 ff1a fs2d fc0 sc0 ls0 ws0">err_sys(&quot;sysconf error&quot;);</div><div class="t m0 x9d h57 y426 ff1a fs2d fc0 sc0 ls15c ws0">}e<span class="_ _1d"></span><span class="ls0">lse {</span></div><div class="t m0 x1f h57 y800 ff1a fs2d fc0 sc0 ls0 ws0">fputs(&quot; (no limit)\n&quot;, stdout);</div><div class="t m0 x9d h57 y801 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x8a h57 y802 ff1a fs2d fc0 sc0 ls15c ws0">}e<span class="_ _1d"></span><span class="ls0">lse {</span></div><div class="t m0 x9d h57 y803 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot; %ld\n&quot;, val);</div><div class="t m0 x8a h57 y804 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y805 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y86e ff1a fs2d fc0 sc0 ls0 ws0">static void</div><div class="t m0 x32 h57 y86f ff1a fs2d fc0 sc0 ls0 ws0">pr_pathconf(char *mesg, char *path, int name)</div><div class="t m0 x32 h57 y870 ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y871 ff1a fs2d fc0 sc0 ls0 ws0">long <span class="_ _68"> </span>val;</div><div class="t m0 x8a h57 y872 ff1a fs2d fc0 sc0 ls0 ws0">fputs(mesg, stdout);</div><div class="t m0 x8a h57 y873 ff1a fs2d fc0 sc0 ls0 ws0">errno = 0;</div><div class="t m0 x8a h57 y874 ff1a fs2d fc0 sc0 ls0 ws0">if ((val = pathconf(path, name)) &lt; 0) {</div><div class="t m0 x9d h57 y875 ff1a fs2d fc0 sc0 ls0 ws0">if (errno != 0) {</div><div class="t m0 x1f h57 y876 ff1a fs2d fc0 sc0 ls0 ws0">if (errno == EINVAL)</div><div class="t m0 x126 h57 y877 ff1a fs2d fc0 sc0 ls0 ws0">fputs(&quot; (not supported)\n&quot;, stdout);</div><div class="t m0 x1f h57 y878 ff1a fs2d fc0 sc0 ls0 ws0">else</div><div class="t m0 x126 h57 y879 ff1a fs2d fc0 sc0 ls0 ws0">err_sys(&quot;pathconf error, path = %s&quot;, path);</div><div class="t m0 x9d h57 y87a ff1a fs2d fc0 sc0 ls15c ws0">}e<span class="_ _1d"></span><span class="ls0">lse {</span></div><div class="t m0 x1f h57 y87b ff1a fs2d fc0 sc0 ls0 ws0">fputs(&quot; (no limit)\n&quot;, stdout);</div><div class="t m0 x9d h57 y87c ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x8a h57 y87d ff1a fs2d fc0 sc0 ls15c ws0">}e<span class="_ _1d"></span><span class="ls0">lse {</span></div><div class="t m0 x9d h57 y87e ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot; %ld\n&quot;, val);</div><div class="t m0 x8a h57 y87f ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y880 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 xe7 h5e y881 ff18 fs10 fc0 sc0 ls0 ws0">Figure 2.14<span class="_ _5a"> </span><span class="ff19">Print all possible<span class="_"> </span><span class="ff1a">sysconf<span class="_ _e"> </span></span>and<span class="_"> </span><span class="ff1a">pathconf<span class="_ _e"> </span></span>values</span></div><div class="t m0 x32 h49 y882 ff19 fs26 fc0 sc0 ls0 ws0">Figur<span class="ls2c7">e2<span class="_ _b"></span><span class="ls0">.15 <span class="_ _3"></span>summarizes <span class="_ _9"></span>the <span class="_ _3"></span>results <span class="_ _3"></span>from <span class="_ _3"></span>Figur<span class="ls2c8">e2<span class="_ _b"></span><span class="ls0">.14 <span class="_ _9"></span>for <span class="_ _9"></span>the <span class="_ _3"></span>four <span class="_ _9"></span>systems <span class="_ _3"></span>we <span class="_ _9"></span>discuss <span class="_ _3"></span>in</span></span></span></span></div><div class="t m0 x32 h49 y883 ff19 fs26 fc0 sc0 ls0 ws0">this <span class="_ _59"> </span>book.<span class="_ _5e"> </span>The <span class="_ _59"> </span>entry <span class="_ _46"> </span>‘<span class="_ _0"></span>‘no <span class="_ _59"> </span>symbol’<span class="ls2c9">’m<span class="_ _49"></span><span class="ls0">eans <span class="_ _46"> </span>that <span class="_ _59"> </span>the <span class="_ _46"> </span>system <span class="_ _46"> </span>doesn’t <span class="_ _59"> </span>provide <span class="_ _59"> </span>a</span></span></div><div class="t m0 x32 h4d y884 ff19 fs26 fc0 sc0 ls0 ws0">corresponding<span class="_ _66"> </span><span class="ff1a">_SC<span class="_ _45"> </span></span>or<span class="_ _47"> </span><span class="ff1a">_PC<span class="_ _47"> </span></span>symbol <span class="_ _3"></span>to <span class="_ _3"></span>query <span class="_ _3"></span>the <span class="_ _3"></span>value <span class="_ _3"></span>of <span class="_ _3"></span>the <span class="_ _3"></span>constant.<span class="_ _16"> </span>Thus <span class="_ _3"></span>the <span class="_ _3"></span>limit <span class="_ _3"></span>is</div><div class="t m0 x32 h49 y885 ff19 fs26 fc0 sc0 ls0 ws0">undeﬁned <span class="_ _9"></span>in <span class="_ _9"></span>this <span class="_ _9"></span>case.<span class="_ _5a"> </span>In <span class="_ _9"></span>contrast, <span class="_ _23"></span>the <span class="_ _9"></span>entry <span class="_ _9"></span>‘<span class="_ _1"></span>‘unsupported’<span class="ls2ca">’m<span class="_ _b"></span><span class="ls0">eans <span class="_ _9"></span>that <span class="_ _9"></span>the <span class="_ _9"></span>symbol <span class="_ _9"></span>is</span></span></div><div class="t m0 x32 h4d y886 ff19 fs26 fc0 sc0 ls0 ws0">deﬁned <span class="_ _3"></span>by <span class="_ _3"></span>the <span class="_ _9"></span>system <span class="_ _3"></span>but <span class="_ _9"></span>unrecognized <span class="_ _2"></span>by <span class="_ _9"></span>the<span class="_ _47"> </span><span class="ff1a">sysconf<span class="_ _45"> </span></span>or<span class="_ _47"> </span><span class="ff1a">pathconf<span class="_ _47"> </span></span>functions. <span class="_ _45"> </span>The</div><div class="t m0 x32 h49 y887 ff19 fs26 fc0 sc0 ls0 ws0">entry ‘‘no limit’<span class="_ _1"></span><span class="ls2bb">’m<span class="_ _d"></span><span class="ls0">eans <span class="_ _2"></span>that the <span class="_ _2"></span>system deﬁnes no <span class="_ _2"></span>limit for <span class="_ _2"></span>the constant, <span class="_ _2"></span>but this <span class="_ _2"></span>doesn’t</span></span></div><div class="t m0 x32 h49 y888 ff19 fs26 fc0 sc0 ls0 ws0">mean that the limit is inﬁnite; it just means that the limit is indeterminite.</div><div class="t m0 x76 h5e y889 ff19 fs10 fc0 sc0 ls0 ws0">Bewar<span class="ls2cb">et<span class="_ _b"></span><span class="ls0">hat <span class="_ _23"> </span>some <span class="_ _23"> </span>limits <span class="_ _42"> </span>ar<span class="ls2cc">er<span class="_ _b"></span><span class="ls0">eported <span class="_ _23"> </span>incorrectly<span class="_ _4"></span><span class="ls2cd">.F<span class="_ _5b"></span><span class="ls0">or <span class="_ _42"> </span>example, <span class="_ _23"> </span>on <span class="_ _42"> </span>Linux,<span class="_ _45"> </span><span class="ff1a">SYMLOOP_MAX<span class="_ _45"> </span></span>is</span></span></span></span></span></span></div><div class="t m0 x76 h2d y88a ff19 fs10 fc0 sc0 ls21d ws0">re<span class="ls0">portedly <span class="_ _23"> </span>unlimited, <span class="_ _23"> </span>but <span class="_ _23"> </span>an <span class="_ _23"> </span>examination <span class="_ _23"> </span>of <span class="_ _42"> </span>the <span class="_ _23"> </span>source <span class="_ _9"></span>code <span class="_ _23"> </span>reveals <span class="_ _23"> </span>that <span class="_ _23"> </span>there<span class="_ _47"> </span>is<span class="_ _45"> </span>actually <span class="_ _23"> </span>a</span></div><div class="t m0 x76 h2d y88b ff19 fs10 fc0 sc0 ls0 ws0">hard-coded limit of 40 for the number of consecutive symbolic <span class="_ _2"></span>links traversed in the absence of</div><div class="t m0 x76 h5e y88c ff19 fs10 fc0 sc0 ls136 ws0">al<span class="_ _84"></span><span class="ls0">oop (see the<span class="_"> </span><span class="ff1a">follow_link<span class="_ _53"> </span></span>function in<span class="_"> </span><span class="ff1a">fs/namei.c</span>).</span></div><div class="t m0 x76 h5e y88d ff19 fs10 fc0 sc0 ls0 ws0">Another <span class="_ _80"> </span>potential <span class="_ _80"> </span>source <span class="_ _80"> </span>of <span class="_ _80"> </span>inaccuracy <span class="_ _66"> </span>in <span class="_ _80"> </span>Linux <span class="_ _80"> </span>is <span class="_ _80"> </span>that <span class="_ _66"> </span>the<span class="_ _4b"> </span><span class="ff1a">pathconf<span class="_ _4b"> </span></span>and<span class="_ _44"> </span><span class="ff1a">fpathconf</span></div><div class="t m0 x76 h2d y88e ff19 fs10 fc0 sc0 ls0 ws0">functions <span class="_ _80"> </span>ar<span class="ls2ce">ei<span class="_ _55"></span><span class="ls0">mplemented <span class="_ _66"> </span>in <span class="_ _66"> </span>the <span class="_ _80"> </span>C <span class="_ _66"> </span>library<span class="_ _6"></span><span class="ls2cf">.T<span class="_ _7"></span><span class="ls0">he <span class="_ _80"> </span>conﬁguration <span class="_ _66"> </span>limits <span class="_ _66"> </span>returned <span class="_ _80"> </span>by <span class="_ _66"> </span>these</span></span></span></span></div><div class="t m0 x76 h2d y88f ff19 fs10 fc0 sc0 ls0 ws0">functions <span class="_ _2"></span>depend <span class="_ _3"></span>on <span class="_ _3"></span>the <span class="_ _3"></span>underlying <span class="_ _2"></span>ﬁle <span class="_ _3"></span>system <span class="_ _3"></span>type, <span class="_ _3"></span>so <span class="_ _3"></span>if <span class="_ _2"></span>your <span class="_ _3"></span>ﬁle <span class="_ _3"></span>system <span class="_ _3"></span>is <span class="_ _3"></span>unknown <span class="_ _2"></span>to <span class="_ _3"></span>the</div><div class="t m0 x76 h2d y890 ff19 fs10 fc0 sc0 ls136 ws0">Cl<span class="_ _84"></span><span class="ls0">ibrary<span class="_ _6"></span><span class="ls136">,t<span class="_ _84"></span><span class="ls0">he functions return an educated guess.</span></span></span></div><div class="t m0 x3f h4d y891 ff19 fs26 fc0 sc0 ls164 ws0">We<span class="_ _9"></span><span class="ls0">’ll <span class="_ _23"></span>see <span class="_ _9"></span>in <span class="_ _23"></span>Section <span class="_ _9"></span>4.14 <span class="_ _23"></span>that<span class="_ _45"> </span><span class="ff1a">UFS<span class="_ _35"> </span></span>is <span class="_ _9"></span>the <span class="_ _23"></span>SVR4 <span class="_ _9"></span>implementation <span class="_ _23"></span>of <span class="_ _9"></span>the <span class="_ _23"></span>Berkeley <span class="_ _9"></span>fast</span></div><div class="t m0 x32 h49 y892 ff19 fs26 fc0 sc0 ls0 ws0">ﬁle system.<span class="_ _59"> </span>PCFS is the MS</div><div class="t m0 x39 h49 y893 ff19 fs26 fc0 sc0 ls0 ws0">-</div><div class="t m0 xc0 h49 y892 ff19 fs26 fc0 sc0 ls0 ws0">DOS F<span class="_ _6"></span><span class="ls2d0">AT <span class="_"> </span>ﬁ<span class="_ _3"></span><span class="ls0">le system implementation for Solaris.</span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
