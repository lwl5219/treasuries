<div id="pf29e" class="pf w4 h1f" data-page-no="29e"><div class="pc pc29e w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg29e.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">636<span class="_ _1b"> </span><span class="ff19">Advanced <span class="_"> </span>IPC<span class="_ _e8"> </span>Chapter <span class="_"> </span>17</span></div><div class="t m0 x7 h51 y4b89 ff19 fs2a fc0 sc0 ls0 ws0">socket</div><div class="t m0 x1af h2d y4b8a ff19 fs10 fc0 sc0 ls0 ws0">socket</div><div class="t m0 x1d0 h31 y4b8b ff19 fs14 fc0 sc0 ls0 ws0">server process<span class="_ _2a4"> </span>client pr<span class="_ _0"></span>ocess</div><div class="t m0 x85 h6f y4b8c ff1a fs14 fc0 sc0 ls0 ws0">sun_path</div><div class="t m0 x9f h6f y4b8d ff18 fs14 fc0 sc0 ls0 ws0">Figure 17.6<span class="_ _5a"> </span><span class="ff19">Client and server sockets befor<span class="ls56a">ea</span><span class="ff1a">connect</span></span></div><div class="t m0 x3f h96 y4b8e ff19 fs49 fc0 sc0 ls0 ws0">Figur<span class="ls13af">e1<span class="_ _43"></span><span class="ls0">7.6 <span class="_ _23"></span>shows <span class="_ _23"></span>a <span class="_ _23"></span>client <span class="_ _23"></span>process <span class="_ _9"></span>and <span class="_ _23"> </span>a <span class="_ _23"> </span>server <span class="_ _23"> </span>process <span class="_ _23"></span>befor<span class="ls13b0">eac<span class="_ _43"></span><span class="ls0">onnection <span class="_ _23"></span>exists</span></span></span></span></div><div class="t m0 x32 h9b y4b8f ff19 fs49 fc0 sc0 ls0 ws0">between <span class="_ _23"></span>the <span class="_ _23"> </span>two.<span class="_ _51"> </span>The <span class="_ _23"> </span>server <span class="_ _23"> </span>has <span class="_ _23"> </span>bound <span class="_ _23"> </span>its <span class="_ _42"> </span>socket <span class="_ _23"></span>to <span class="_ _23"></span>a<span class="_ _35"> </span><span class="ff1a">sockaddr_un<span class="_ _35"> </span></span>address <span class="_ _9"></span>and <span class="_ _23"> </span>is</div><div class="t m0 x32 h96 y4b90 ff19 fs49 fc0 sc0 ls0 ws0">listening <span class="_ _2"></span>for <span class="_ _2"></span>connection <span class="_ _2"></span>requests. <span class="_"> </span>Figur<span class="ls13b1">e1<span class="_ _4f"></span><span class="ls0">7.7 <span class="_ _2"></span>shows <span class="_ _2"></span>the <span class="_ _2"></span>unique <span class="_ _2"></span>connection <span class="_ _2"></span>between <span class="_ _2"></span>the</span></span></div><div class="t m0 x32 h96 y4b91 ff19 fs49 fc0 sc0 ls0 ws0">client and server after the server has accepted the client’s connection request.</div><div class="t m0 xea h32 y4b92 ff19 fs15 fc0 sc0 ls0 ws0">socket</div><div class="t m0 x67 h33 y4b93 ff19 fs16 fc0 sc0 ls0 ws0">socket</div><div class="t m0 x1da h83 y4b94 ff19 fs36 fc0 sc0 ls0 ws0">socket</div><div class="t m0 xa8 h39 y4b95 ff19 fs1c fc0 sc0 ls0 ws0">server process<span class="_ _2a4"> </span>client pr<span class="_ _0"></span>ocess</div><div class="t m0 xa8 hd7 y4b96 ff1a fs1c fc0 sc0 ls0 ws0">sun_path</div><div class="t m0 x188 h103 y4b97 ff18 fs1e fc0 sc0 ls0 ws0">Figure 17.7<span class="_ _5a"> </span><span class="ff19">Client and server sockets after a<span class="_"> </span><span class="ff1a">connect</span></span></div><div class="t m0 x3f h16b y4b98 ff19 fs4b fc0 sc0 ls13b2 ws0">We <span class="_ _80"> </span>w<span class="_ _9"></span><span class="ls0">ill <span class="_ _3"></span>now <span class="_ _3"></span>develop <span class="_ _3"></span>three <span class="_ _2"></span>functions <span class="_ _9"></span>that <span class="_ _2"></span>can <span class="_ _3"></span>be <span class="_ _3"></span>used <span class="_ _9"></span>to <span class="_ _2"></span>create <span class="_ _3"></span>unique <span class="_ _3"></span>connections</span></div><div class="t m0 x32 h16b y4b99 ff19 fs4b fc0 sc0 ls0 ws0">between <span class="_ _2"></span>unrelated <span class="_ _3"></span>processes <span class="_ _2"></span>running <span class="_ _2"></span>on <span class="_ _3"></span>the <span class="_ _3"></span>same <span class="_ _3"></span>machine.<span class="_ _16"> </span>These <span class="_ _2"></span>functions <span class="_ _3"></span>mimic <span class="_ _3"></span>the</div><div class="t m0 x32 h16b y4b9a ff19 fs4b fc0 sc0 ls0 ws0">connection-oriented <span class="_ _23"></span>socket <span class="_ _23"></span>functions <span class="_ _23"></span>discussed <span class="_ _23"></span>in <span class="_ _23"></span>Section <span class="_ _9"></span>16.4.<span class="_ _51"> </span><span class="ls13b2">We <span class="_ _47"> </span>u<span class="_ _23"></span></span>se <span class="_ _23"></span>UNIX <span class="_ _23"></span>domain</div><div class="t m0 x32 h16b y4b9b ff19 fs4b fc0 sc0 ls0 ws0">sockets for the underlying communication mechanism here.</div><div class="t m0 x3f hb6 y4b9c ff1a fs60 fc0 sc0 ls0 ws0">#include &quot;apue.h&quot;</div><div class="t m0 x3f hb6 y4b9d ff1a fs60 fc0 sc0 ls0 ws0">int serv_listen(const char *<span class="ff1b">name</span>);</div><div class="t m0 x220 h16c y4b9e ff19 fs60 fc0 sc0 ls0 ws0">Returns: ﬁle descriptor to listen on if OK, negative value on error</div><div class="t m0 x3f hb6 y4b9f ff1a fs60 fc0 sc0 ls0 ws0">int serv_accept(int<span class="_"> </span><span class="ff1b">listenfd</span><span class="ls13b3">,u<span class="_ _1d"></span><span class="ls0">id_t *<span class="ff1b">uidptr</span>);</span></span></div><div class="t m0 x22d h16c y4ba0 ff19 fs60 fc0 sc0 ls0 ws0">Returns: new ﬁle descriptor if OK, negative value on error</div><div class="t m0 x3f hb6 y4ba1 ff1a fs60 fc0 sc0 ls0 ws0">int cli_conn(const char *<span class="ff1b">name</span>);</div><div class="t m0 xe h16c y4ba2 ff19 fs60 fc0 sc0 ls0 ws0">Returns: ﬁle descriptor if OK, negative value on error</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
