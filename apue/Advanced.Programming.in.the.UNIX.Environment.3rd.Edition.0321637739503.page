<div id="pf1f7" class="pf w4 h1f" data-page-no="1f7"><div class="pc pc1f7 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg1f7.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>13.4<span class="_ _ea"> </span>Error <span class="_"> </span>Logging<span class="_ _1fb"> </span><span class="ff18">469</span></div><div class="t m0 x32 h26 y12f ff19 fsf fc0 sc0 ls5f ws0">We <span class="_ _53"> </span>c<span class="_ _9"></span><span class="ls0">an also use<span class="_"> </span><span class="ff1a">ps<span class="_ _66"> </span></span>to verify that no active process exists with ID 13799.<span class="_ _59"> </span>This means that</span></div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">our <span class="_ _9"></span>daemon <span class="_ _9"></span>is <span class="_ _9"></span>in <span class="_ _9"></span>an <span class="_ _9"></span>orphaned <span class="_ _9"></span>process <span class="_ _3"></span>group <span class="_ _9"></span>(Section <span class="_ _9"></span>9.10) <span class="_ _9"></span>and <span class="_ _9"></span>is <span class="_ _9"></span>not <span class="_ _9"></span>a <span class="_ _9"></span>session <span class="_ _9"></span>leader</div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">and, <span class="_ _42"> </span>therefore, <span class="_ _42"> </span>has <span class="_ _42"> </span>no <span class="_ _53"> </span>chance <span class="_ _42"> </span>of <span class="_ _53"> </span>allocating <span class="_ _42"> </span>a <span class="_ _53"> </span>controlling <span class="_ _42"> </span>terminal.<span class="_ _54"> </span>This <span class="_ _53"> </span>is <span class="_ _42"> </span>a <span class="_ _53"> </span>result <span class="_ _42"> </span>of</div><div class="t m0 x32 h26 y132 ff19 fsf fc0 sc0 ls0 ws0">performing <span class="_ _3"></span>the <span class="_ _3"></span>second<span class="_ _47"> </span><span class="ff1a">fork<span class="_ _45"> </span></span>in <span class="_ _3"></span>the<span class="_ _47"> </span><span class="ff1a">daemonize<span class="_ _47"> </span></span>function. <span class="_ _45"> </span>W<span class="_ _6"></span><span class="ls82">ec<span class="_ _b"></span><span class="ls0">an <span class="_ _9"></span>see <span class="_ _3"></span>that <span class="_ _3"></span>our <span class="_ _3"></span>daemon</span></span></div><div class="t m0 x32 h2a y133 ff19 fsf fc0 sc0 ls0 ws0">has been initialized correctly<span class="_ _4"></span>.</div><div class="t m0 x35 h4b y3a03 ff16 fs27 fc0 sc0 ls0 ws0">13.4 <span class="_ _93"> </span>Error <span class="_"> </span>Log<span class="_ _0"></span>ging</div><div class="t m0 x32 h49 y3a04 ff19 fs26 fc0 sc0 ls0 ws0">One <span class="_ _9"></span>problem <span class="_ _9"></span>a <span class="_ _23"> </span>daemon <span class="_ _23"></span>has <span class="_ _9"></span>is <span class="_ _23"></span>how <span class="_ _9"></span>to <span class="_ _23"> </span>handle <span class="_ _23"></span>error <span class="_ _9"></span>messages.<span class="_ _5a"> </span>It <span class="_ _23"></span>can’t <span class="_ _9"></span>simply <span class="_ _23"></span>write <span class="_ _23"></span>to</div><div class="t m0 x32 h49 y3a05 ff19 fs26 fc0 sc0 ls0 ws0">standar<span class="ls742">de<span class="_ _55"></span><span class="ls0">rror<span class="_ _6"></span><span class="ls742">,s<span class="_ _43"></span><span class="ls0">ince <span class="_ _42"> </span>it <span class="_ _53"> </span>shouldn’t <span class="_ _42"> </span>have <span class="_ _53"> </span>a <span class="_ _53"> </span>controlling <span class="_ _42"> </span>terminal.<span class="_ _54"> </span><span class="ls164">We <span class="_ _45"> </span>d<span class="_ _23"></span></span>on’t <span class="_ _42"> </span>want <span class="_ _53"> </span>all <span class="_ _42"> </span>the</span></span></span></span></div><div class="t m0 x32 h49 y3a06 ff19 fs26 fc0 sc0 ls0 ws0">daemons <span class="_"> </span>writing <span class="_"> </span>to <span class="_"> </span>the <span class="_"> </span>console <span class="_ _e"> </span>device, <span class="_"> </span>because <span class="_"> </span>on <span class="_"> </span>many <span class="_"> </span>workstations <span class="_"> </span>the <span class="_"> </span>console</div><div class="t m0 x32 h49 y3a07 ff19 fs26 fc0 sc0 ls0 ws0">device <span class="_ _42"> </span>runs <span class="_ _42"> </span>a <span class="_ _42"> </span>windowing <span class="_ _42"> </span>system.<span class="_ _54"> </span><span class="ls164">We <span class="_ _45"> </span>a<span class="_ _9"></span></span>lso <span class="_ _42"> </span>don’t <span class="_ _42"> </span>want <span class="_ _53"> </span>each <span class="_ _42"> </span>daemon <span class="_ _42"> </span>writing <span class="_ _42"> </span>its <span class="_ _42"> </span>own</div><div class="t m0 x32 h49 y3a08 ff19 fs26 fc0 sc0 ls0 ws0">error <span class="_ _9"></span>messages <span class="_ _23"> </span>into <span class="_ _23"> </span>a <span class="_ _23"> </span>separate <span class="_ _23"> </span>ﬁle.<span class="_ _51"> </span>It <span class="_ _23"> </span>would <span class="_ _23"> </span>be <span class="_ _23"> </span>a <span class="_ _23"> </span>headache <span class="_ _42"> </span>for <span class="_ _23"></span>anyone <span class="_ _23"></span>administering</div><div class="t m0 x32 h49 y3a09 ff19 fs26 fc0 sc0 ls0 ws0">the <span class="_ _9"></span>system <span class="_ _9"></span>to <span class="_ _23"></span>keep <span class="_ _9"></span>up <span class="_ _9"></span>with <span class="_ _9"></span>which <span class="_ _23"></span>daemon <span class="_ _9"></span>writes <span class="_ _9"></span>to <span class="_ _9"></span>which <span class="_ _23"></span>log <span class="_ _9"></span>ﬁle <span class="_ _9"></span>and <span class="_ _9"></span>to <span class="_ _23"></span>check <span class="_ _9"></span>these</div><div class="t m0 x32 h49 y3a0a ff19 fs26 fc0 sc0 ls0 ws0">ﬁles on a regular basis.<span class="_ _59"> </span><span class="lsd3">Ac<span class="_ _d"></span><span class="ls0">entral daemon error-logging facility is r<span class="_ _1"></span>equired.</span></span></div><div class="t m0 x76 h5e y3a0b ff19 fs10 fc0 sc0 ls0 ws0">The BSD<span class="_"> </span><span class="ff1a">syslog<span class="_ _53"> </span></span>facility <span class="_ _2"></span>was developed at Berkeley and used widely in 4.2BSD.<span class="_ _44"> </span>Most systems</div><div class="t m0 x76 h5e y3a0c ff19 fs10 fc0 sc0 ls0 ws0">derived <span class="_"> </span>from <span class="_"> </span>BSD <span class="_ _80"> </span>support<span class="_ _44"> </span><span class="ff1a">syslog</span><span class="lsf76">.U<span class="_ _7"></span><span class="ls0">ntil <span class="_ _80"> </span>SVR4, <span class="_"> </span>System <span class="_ _80"> </span>V <span class="_"> </span>never <span class="_ _80"> </span>had <span class="_"> </span>a <span class="_ _e"> </span>central <span class="_ _80"> </span>daemon</span></span></div><div class="t m0 x76 h5e y3a0d ff19 fs10 fc0 sc0 ls0 ws0">logging <span class="_"> </span>facility<span class="_ _6"></span><span class="lsf77">.T<span class="_ _26"></span><span class="ls0">he<span class="_ _44"> </span><span class="ff1a">syslog<span class="_ _44"> </span></span>function <span class="_ _80"> </span>is <span class="_"> </span>included <span class="_ _80"> </span>in <span class="_"> </span>the <span class="_ _80"> </span>XSI <span class="_"> </span>option <span class="_ _80"> </span>in <span class="_"> </span>the <span class="_ _80"> </span>Single <span class="_"> </span>UNIX</span></span></div><div class="t m0 x76 h2d y3a0e ff19 fs10 fc0 sc0 ls0 ws0">Speciﬁcation.</div><div class="t m0 x3f h4d y3a0f ff19 fs26 fc0 sc0 ls0 ws0">The <span class="_ _23"> </span>BSD<span class="_ _35"> </span><span class="ff1a">syslog<span class="_ _35"> </span></span>facility <span class="_ _23"> </span>has <span class="_ _42"> </span>been <span class="_ _23"></span>widely <span class="_ _23"> </span>used <span class="_ _23"> </span>since <span class="_ _42"> </span>4.2BSD.<span class="_ _51"> </span>Most <span class="_ _23"> </span>daemons <span class="_ _23"> </span>use</div><div class="t m0 x32 h49 y3a10 ff19 fs26 fc0 sc0 ls0 ws0">this facility<span class="_ _4"></span><span class="ls199">.F<span class="_ _4a"></span><span class="ls0">igur<span class="lsd3">e1<span class="_ _d"></span><span class="ls0">3.2 illustrates its structure.</span></span></span></span></div><div class="t m0 xd0 h4f y3a11 ff1a fs11 fc0 sc0 ls0 ws0">/dev/log</div><div class="t m0 x1a4 h2f y3a12 ff19 fs12 fc0 sc0 ls0 ws0">UDP</div><div class="t m0 x154 h2f y3a13 ff19 fs12 fc0 sc0 ls0 ws0">port 514</div><div class="t m0 x1dc h63 y3a14 ff1a fs13 fc0 sc0 ls0 ws0">/dev/klog</div><div class="t m0 x180 h31 y3a15 ff19 fs14 fc0 sc0 ls0 ws0">user</div><div class="t m0 x132 h31 y3a16 ff19 fs14 fc0 sc0 ls0 ws0">process</div><div class="t m0 x159 h6f y3a17 ff1a fs14 fc0 sc0 ls0 ws0">syslog</div><div class="t m0 x9c h66 y3a18 ff1a fs15 fc0 sc0 ls0 ws0">syslogd</div><div class="t m0 x1 h34 y3a19 ff19 fs17 fc0 sc0 ls0 ws0">kernel</div><div class="t m0 x98 h34 y3a1a ff19 fs17 fc0 sc0 lsad2 ws0">ro<span class="ls0">utines</span></div><div class="t m0 x21d hcc y3a1b ff1a fs17 fc0 sc0 ls0 ws0">log</div><div class="t m0 x24 h35 y3a1c ff19 fs18 fc0 sc0 ls0 ws0">written to ﬁle or</div><div class="t m0 x121 h35 y3a1d ff19 fs18 fc0 sc0 ls0 ws0">to logged-in users or</div><div class="t m0 xe h35 y3a1e ff19 fs18 fc0 sc0 ls0 ws0">sent to another host</div><div class="t m0 x143 h35 y3a1f ff19 fs18 fc0 sc0 ls0 ws0">UNIX domain</div><div class="t m0 xf6 h35 y3a20 ff19 fs18 fc0 sc0 ls0 ws0">datagram socket</div><div class="t m0 x24 h35 y3a1f ff19 fs18 fc0 sc0 ls0 ws0">Internet domain</div><div class="t m0 x205 h35 y3a20 ff19 fs18 fc0 sc0 ls0 ws0">datagram socket</div><div class="t m0 x125 h36 y3a21 ff19 fs19 fc0 sc0 ls0 ws0">kernel</div><div class="t m0 xc6 h37 y3a22 ff19 fs1a fc0 sc0 ls0 ws0">TCP/IP network</div><div class="t m0 x72 h8d y3a23 ff18 fs1a fc0 sc0 ls0 ws0">Figure 13.2<span class="_ _5a"> </span><span class="ff19">The BSD<span class="_"> </span><span class="ff1a">syslog<span class="_ _e"> </span></span>facility</span></div><a class="l" href="#pf11" data-dest-detail='[17,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.892634px;bottom:1057.371068px;width:118.979698px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
