<div id="pf17a" class="pf w4 h1f" data-page-no="17a"><div class="pc pc17a w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg17a.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">344<span class="_ _1b"> </span><span class="ff19">Signals <span class="_ _24b"> </span>Chapter<span class="_ _21"> </span>10</span></div><div class="t m0 x35 h53 y12f ff16 fs2b fc0 sc0 ls0 ws0">10.11 <span class="_ _66"> </span>Signal<span class="_ _54"> </span>Sets</div><div class="t m0 x32 h2b y4de ff19 fsf fc0 sc0 ls5f ws0">We <span class="_ _e"> </span>n<span class="_ _9"></span><span class="ls0">eed <span class="_ _2"></span>a <span class="_ _3"></span>data <span class="_ _2"></span>type <span class="_ _2"></span>to <span class="_ _2"></span>represent multiple <span class="_ _2"></span>signals<span class="_ _9"></span><span class="ls9d">—a<span class="_ _e"> </span></span><span class="ff1b">signal <span class="_ _2"></span>set</span><span class="lsc90">.W<span class="_ _26"></span><span class="ls0">e’ll <span class="_ _2"></span>use <span class="_ _2"></span>this <span class="_ _3"></span>data <span class="_ _2"></span>type</span></span></span></div><div class="t m0 x32 h26 y6d0 ff19 fsf fc0 sc0 ls0 ws0">with such <span class="_ _2"></span>functions <span class="_ _2"></span>as<span class="_ _47"> </span><span class="ff1a">sigprocmask<span class="_ _66"> </span></span>(in <span class="_ _2"></span>the <span class="_ _2"></span>next <span class="_ _2"></span>section) <span class="_ _2"></span>to <span class="_ _2"></span>tell <span class="_ _2"></span>the kernel <span class="_ _2"></span>not <span class="_ _2"></span>to <span class="_ _2"></span>allow</div><div class="t m0 x32 h2a y6d1 ff19 fsf fc0 sc0 ls0 ws0">any <span class="_ _3"></span>of <span class="_ _3"></span>the <span class="_ _3"></span>signals <span class="_ _9"></span>in <span class="_ _3"></span>the <span class="_ _3"></span>set <span class="_ _3"></span>to <span class="_ _9"></span>occur<span class="_ _6"></span><span class="lsc91">.A<span class="_ _1d"></span><span class="ls0">s<span class="_ _47"> </span>we<span class="_ _45"> </span>mentioned <span class="_ _2"></span>earlier<span class="_ _1"></span><span class="lsc92">,t<span class="_ _8"></span><span class="ls0">he <span class="_ _3"></span>number <span class="_ _9"></span>of <span class="_ _3"></span>differ<span class="_ _0"></span>ent</span></span></span></span></div><div class="t m0 x32 h2a y6d2 ff19 fsf fc0 sc0 ls0 ws0">signals can <span class="_ _2"></span>exceed the <span class="_ _2"></span>number <span class="_ _2"></span>of bits <span class="_ _2"></span>in <span class="_ _2"></span>an integer<span class="_ _1"></span><span class="ls8e9">,s<span class="_ _d"></span><span class="ls0">o<span class="_"> </span>in<span class="_ _66"> </span>general <span class="_ _2"></span>we <span class="_ _2"></span>can’t use <span class="_ _2"></span>an <span class="_ _2"></span>integer</span></span></div><div class="t m0 x32 h26 y6d3 ff19 fsf fc0 sc0 ls0 ws0">to <span class="_ _2"></span>repr<span class="_ _0"></span>esent the <span class="_ _2"></span>set <span class="_ _2"></span>with <span class="_ _2"></span>one <span class="_ _2"></span>bit <span class="_ _2"></span>per <span class="_ _2"></span>signal.<span class="_ _61"> </span>POSIX.1 <span class="_ _2"></span>deﬁnes <span class="_ _2"></span>the <span class="_ _2"></span>data <span class="_ _2"></span>type<span class="_ _47"> </span><span class="ff1a">sigset_t<span class="_ _66"> </span></span>to</div><div class="t m0 x32 h2a y6d4 ff19 fsf fc0 sc0 ls0 ws0">contain a signal set and the following ﬁve functions to manipulate signal sets.</div><div class="t m0 x3f h57 y21b3 ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;signal.h&gt;</div><div class="t m0 x3f h57 y2bfc ff1a fs2d fc0 sc0 ls0 ws0">int sigemptyset(sigset_t *<span class="ff1b">set</span>);</div><div class="t m0 x3f h57 y2bfd ff1a fs2d fc0 sc0 ls0 ws0">int sigfillset(sigset_t *<span class="ff1b">set</span>);</div><div class="t m0 x3f h57 y2bfe ff1a fs2d fc0 sc0 ls0 ws0">int sigaddset(sigset_t *<span class="ff1b">set</span><span class="ls15c">,i<span class="_ _1d"></span><span class="ls0">nt<span class="_"> </span><span class="ff1b">signo</span>);</span></span></div><div class="t m0 x3f h57 y2bff ff1a fs2d fc0 sc0 ls0 ws0">int sigdelset(sigset_t *<span class="ff1b">set</span><span class="ls15c">,i<span class="_ _1d"></span><span class="ls0">nt<span class="_"> </span><span class="ff1b">signo</span>);</span></span></div><div class="t m0 x17b h5f y2c00 ff19 fs2d fc0 sc0 ls0 ws0">All four return: 0 if OK,<span class="_"> </span><span class="ff20">−</span>1<span class="_"> </span>on<span class="_"> </span>err<span class="_ _0"></span>or</div><div class="t m0 x3f h57 y2c01 ff1a fs2d fc0 sc0 ls0 ws0">int sigismember(const sigset_t *<span class="ff1b">set</span><span class="ls15c">,i<span class="_ _1d"></span><span class="ls0">nt<span class="_"> </span><span class="ff1b">signo</span>);</span></span></div><div class="t m0 x1eb h5f y2c02 ff19 fs2d fc0 sc0 ls0 ws0">Returns: 1 if true, 0 if false,<span class="_"> </span><span class="ff20">−</span>1<span class="_"> </span>on<span class="_"> </span>error</div><div class="t m0 x32 h4d y2c03 ff19 fs26 fc0 sc0 ls0 ws0">The <span class="_ _2"></span>function<span class="_ _47"> </span><span class="ff1a">sigemptyset<span class="_ _47"> </span></span>initializes <span class="_ _2"></span>the <span class="_ _3"></span>signal <span class="_ _3"></span>set <span class="_ _2"></span>pointed <span class="_ _3"></span>to <span class="_ _3"></span>by<span class="_ _47"> </span><span class="ff1b">set<span class="_ _47"> </span></span>so <span class="_ _2"></span>that <span class="_ _3"></span>all <span class="_ _2"></span>signals</div><div class="t m0 x32 h4d y2c04 ff19 fs26 fc0 sc0 ls0 ws0">ar<span class="ls37e">ee<span class="_ _b"></span><span class="ls0">xcluded. <span class="_ _47"> </span>The<span class="_ _45"> </span>function<span class="_ _47"> </span><span class="ff1a">sigfillset<span class="_ _47"> </span></span>initializes <span class="_ _3"></span>the <span class="_ _3"></span>signal <span class="_ _3"></span>set <span class="_ _3"></span>so <span class="_ _9"></span>that <span class="_ _3"></span>all <span class="_ _3"></span>signals <span class="_ _3"></span>are</span></span></div><div class="t m0 x32 h4d y2c05 ff19 fs26 fc0 sc0 ls0 ws0">included. <span class="_ _45"> </span>All<span class="_ _35"> </span>applications <span class="_ _9"></span>have <span class="_ _23"></span>to <span class="_ _9"></span>call <span class="_ _23"></span>either<span class="_ _45"> </span><span class="ff1a">sigemptyset<span class="_ _45"> </span></span>or<span class="_ _35"> </span><span class="ff1a">sigfillset<span class="_ _45"> </span></span>once <span class="_ _23"></span>for</div><div class="t m0 x32 h49 y2c06 ff19 fs26 fc0 sc0 ls0 ws0">each <span class="_"> </span>signal <span class="_ _66"> </span>set, <span class="_ _66"> </span>befor<span class="lsc93">eu<span class="_ _5b"></span><span class="ls0">sing <span class="_ _66"> </span>the <span class="_ _66"> </span>signal <span class="_ _66"> </span>set, <span class="_ _66"> </span>because <span class="_ _66"> </span>we <span class="_ _66"> </span>cannot <span class="_ _66"> </span>assume <span class="_ _66"> </span>that <span class="_ _66"> </span>the <span class="_ _66"> </span>C</span></span></div><div class="t m0 x32 h49 y2c07 ff19 fs26 fc0 sc0 ls0 ws0">initialization <span class="_ _9"></span>for <span class="_ _9"></span>external <span class="_ _9"></span>and <span class="_ _23"></span>static <span class="_ _9"></span>variables</div><div class="t m0 x8d h49 y2c08 ff19 fs26 fc0 sc0 ls0 ws0">(</div><div class="t m0 x8e h49 y2c07 ff19 fs26 fc0 sc0 ls0 ws0">0</div><div class="t m0 x15d h49 y2c08 ff19 fs26 fc0 sc0 ls0 ws0">)</div><div class="t m0 xdc h49 y2c07 ff19 fs26 fc0 sc0 ls0 ws0">corresponds <span class="_ _3"></span>to <span class="_ _23"></span>the <span class="_ _9"></span>implementation <span class="_ _9"></span>of</div><div class="t m0 x32 h49 y2c09 ff19 fs26 fc0 sc0 ls0 ws0">signal sets on a given system.</div><div class="t m0 x3f h49 y2c0a ff19 fs26 fc0 sc0 ls0 ws0">Once <span class="_ _3"></span>we <span class="_ _9"></span>have <span class="_ _9"></span>initialized <span class="_ _3"></span>a <span class="_ _9"></span>signal <span class="_ _9"></span>set, <span class="_ _3"></span>we <span class="_ _9"></span>can <span class="_ _9"></span>add <span class="_ _9"></span>and <span class="_ _3"></span>delete <span class="_ _9"></span>speciﬁc <span class="_ _9"></span>signals <span class="_ _3"></span>in <span class="_ _9"></span>the</div><div class="t m0 x32 h4d y2c0b ff19 fs26 fc0 sc0 ls0 ws0">set. <span class="_ _45"> </span>The<span class="_ _35"> </span>function<span class="_ _45"> </span><span class="ff1a">sigaddset<span class="_ _45"> </span></span>adds <span class="_ _23"></span>a <span class="_ _9"></span>single <span class="_ _23"></span>signal <span class="_ _9"></span>to <span class="_ _23"></span>an <span class="_ _9"></span>existing <span class="_ _23"></span>set, <span class="_ _9"></span>and<span class="_ _35"> </span><span class="ff1a">sigdelset</span></div><div class="t m0 x32 h49 y2c0c ff19 fs26 fc0 sc0 lscc ws0">re<span class="ls0">moves <span class="_ _e"> </span>a <span class="_ _e"> </span>single <span class="_ _53"> </span>signal <span class="_ _e"> </span>from <span class="_ _53"> </span>a <span class="_ _e"> </span>set.<span class="_ _65"> </span>In <span class="_ _e"> </span>all <span class="_ _e"> </span>the <span class="_ _53"> </span>functions <span class="_ _e"> </span>that <span class="_ _e"> </span>take <span class="_ _53"> </span>a <span class="_ _e"> </span>signal <span class="_ _e"> </span>set <span class="_ _53"> </span>as <span class="_ _e"> </span>an</span></div><div class="t m0 x32 h49 y2c0d ff19 fs26 fc0 sc0 ls0 ws0">argument, we always pass the addr<span class="_ _0"></span>ess of the signal set as the ar<span class="_ _0"></span>gument.</div><div class="t m0 x35 h4c y2c0e ff16 fs26 fc0 sc0 ls0 ws0">Implementation</div><div class="t m0 x32 h49 y2c0f ff19 fs26 fc0 sc0 ls0 ws0">If <span class="_ _e"> </span>the <span class="_"> </span>implementation <span class="_ _53"> </span>has <span class="_"> </span>fewer <span class="_ _e"> </span>signals <span class="_ _e"> </span>than <span class="_"> </span>bits <span class="_ _53"> </span>in <span class="_"> </span>an <span class="_ _e"> </span>integer<span class="_ _6"></span><span class="lsc94">,as<span class="_ _55"></span><span class="ls0">ignal <span class="_"> </span>set <span class="_ _e"> </span>can <span class="_ _e"> </span>be</span></span></div><div class="t m0 x32 h49 y2c10 ff19 fs26 fc0 sc0 ls0 ws0">implemented using <span class="_ _2"></span>one <span class="_ _2"></span>bit <span class="_ _2"></span>per <span class="_ _2"></span>signal.<span class="_ _46"> </span>For <span class="_ _2"></span>the <span class="_ _2"></span>remainder of <span class="_ _2"></span>this section, <span class="_ _2"></span>assume <span class="_ _2"></span>that <span class="_ _2"></span>an</div><div class="t m0 x32 h49 y2c11 ff19 fs26 fc0 sc0 ls0 ws0">implementation <span class="_ _23"> </span>has <span class="_ _42"> </span>31 <span class="_ _23"></span>signals <span class="_ _23"> </span>and <span class="_ _42"> </span>32</div><div class="t m0 x1f5 h49 y2c12 ff19 fs26 fc0 sc0 ls0 ws0">-</div><div class="t m0 xdd h4d y2c11 ff19 fs26 fc0 sc0 ls0 ws0">bit <span class="_ _23"> </span>integers.<span class="_ _51"> </span>The<span class="_ _35"> </span><span class="ff1a">sigemptyset<span class="_ _44"> </span></span>function <span class="_ _23"></span>zeros</div><div class="t m0 x32 h4d y2c13 ff19 fs26 fc0 sc0 ls0 ws0">the integer<span class="_ _1"></span><span class="lsc95">,a<span class="_ _4f"></span><span class="ls0">nd <span class="_ _2"></span>the<span class="_"> </span><span class="ff1a">sigfillset<span class="_ _66"> </span></span>function <span class="_ _2"></span>turns on <span class="_ _2"></span>all the <span class="_ _2"></span>bits in <span class="_ _2"></span>the integer<span class="_ _1"></span><span class="lsc96">.T<span class="_ _5b"></span><span class="ls0">hese <span class="_ _2"></span>two</span></span></span></span></div><div class="t m0 x32 h4d y2c14 ff19 fs26 fc0 sc0 ls0 ws0">functions can be implemented as macros in the<span class="_"> </span><span class="ff1a">&lt;signal.h&gt;<span class="_ _80"> </span></span>header:</div><div class="t m0 x3f h4e y2c15 ff1a fs28 fc0 sc0 ls0 ws0">#define sigemptyset(ptr)<span class="_ _d9"> </span>(*(ptr) = 0)</div><div class="t m0 x3f h4e y2c16 ff1a fs28 fc0 sc0 ls0 ws0">#define sigfillset(ptr)<span class="_ _68"> </span>(*(ptr) = ˜(sigset_t)0, 0)</div><div class="t m0 x32 h4d y2c17 ff19 fs26 fc0 sc0 ls0 ws0">Note <span class="_ _2"></span>that<span class="_ _47"> </span><span class="ff1a">sigfillset<span class="_ _47"> </span></span>must <span class="_ _3"></span>return <span class="_ _2"></span>0, <span class="_ _3"></span>in <span class="_ _3"></span>addition <span class="_ _2"></span>to <span class="_ _3"></span>setting <span class="_ _3"></span>all <span class="_ _3"></span>the <span class="_ _3"></span>bits <span class="_ _2"></span>on <span class="_ _3"></span>in <span class="_ _3"></span>the <span class="_ _3"></span>signal</div><div class="t m0 x32 h49 y2c18 ff19 fs26 fc0 sc0 ls0 ws0">set, <span class="_ _42"> </span>so <span class="_ _53"> </span>we <span class="_ _53"> </span>use <span class="_ _53"> </span>C’s <span class="_ _53"> </span>comma <span class="_ _42"> </span>operator<span class="_ _1"></span><span class="lsc97">,w<span class="_ _c"></span><span class="ls0">hich <span class="_ _53"> </span>returns <span class="_ _42"> </span>the <span class="_ _53"> </span>value <span class="_ _53"> </span>after <span class="_ _53"> </span>the <span class="_ _42"> </span>comma <span class="_ _53"> </span>as <span class="_ _53"> </span>the</span></span></div><div class="t m0 x32 h49 y2c19 ff19 fs26 fc0 sc0 ls0 ws0">value of the expression.</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.892409px;bottom:1236.288916px;width:104.027809px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
