<div id="pf2c2" class="pf w4 h1f" data-page-no="2c2"><div class="pc pc2c2 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg2c2.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">672<span class="_ _1b"> </span><span class="ff19 ls719">Te<span class="_ _9"></span><span class="ls0">rminal <span class="_"> </span>I/O<span class="_ _eb"> </span>Chapter <span class="_"> </span>18</span></span></div><div class="t m0 x32 h2a y12f ff19 fsf fc0 sc0 ls0 ws0">If <span class="_ _2"></span>we <span class="_ _2"></span>don’t <span class="_ _2"></span>do <span class="_ _3"></span>anything <span class="_ _2"></span>special, <span class="_ _2"></span>canonical <span class="_ _2"></span>mode <span class="_ _3"></span>is <span class="_ _2"></span>the <span class="_ _2"></span>default.<span class="_ _61"> </span>For <span class="_ _2"></span>example, <span class="_ _3"></span>if <span class="_ _2"></span>the <span class="_ _2"></span>shell</div><div class="t m0 x32 h26 y130 ff19 fsf fc0 sc0 ls45 ws0">re<span class="ls0">directs <span class="_ _3"></span>standar<span class="ls1039">di<span class="_ _b"></span><span class="ls0">nput <span class="_ _3"></span>to <span class="_ _9"></span>the <span class="_ _3"></span>terminal <span class="_ _3"></span>and <span class="_ _3"></span>we <span class="_ _3"></span>use<span class="_ _47"> </span><span class="ff1a">read<span class="_ _45"> </span></span>and<span class="_ _47"> </span><span class="ff1a">write<span class="_ _47"> </span></span>to <span class="_ _3"></span>copy <span class="_ _3"></span>standard</span></span></span></div><div class="t m0 x32 h26 y131 ff19 fsf fc0 sc0 ls0 ws0">input <span class="_ _9"></span>to <span class="_ _9"></span>standar<span class="ls142b">do<span class="_ _b"></span><span class="ls0">utput, <span class="_ _9"></span>the <span class="_ _9"></span>terminal <span class="_ _9"></span>is <span class="_ _9"></span>in <span class="_ _23"></span>canonical <span class="_ _9"></span>mode, <span class="_ _9"></span>and <span class="_ _9"></span>each<span class="_ _45"> </span><span class="ff1a">read<span class="_ _45"> </span></span><span class="ls45">re<span class="_ _2"></span></span>turns <span class="_ _9"></span>at</span></span></div><div class="t m0 x32 h26 y132 ff19 fsf fc0 sc0 ls0 ws0">most <span class="_ _23"></span>one <span class="_ _23"></span>line.<span class="_ _5a"> </span>Programs <span class="_ _23"></span>that <span class="_ _23"></span>manipulate <span class="_ _23"></span>the <span class="_ _23"></span>entir<span class="ls4aa">es<span class="_ _43"></span><span class="ls0">creen, <span class="_ _9"></span>such <span class="_ _23"> </span>as <span class="_ _23"> </span>the<span class="_ _35"> </span><span class="ff1a">vi<span class="_ _35"> </span></span>editor<span class="_ _6"></span><span class="ls4aa">,u<span class="_ _b"></span><span class="ls0">se</span></span></span></span></div><div class="t m0 x32 h2a y133 ff19 fsf fc0 sc0 ls0 ws0">noncanonical <span class="_ _44"> </span>mode, <span class="_ _44"> </span>since <span class="_ _35"> </span>the <span class="_ _44"> </span>commands <span class="_ _44"> </span>may <span class="_ _44"> </span>be <span class="_ _44"> </span>single <span class="_ _44"> </span>characters <span class="_ _44"> </span>and <span class="_ _35"> </span>ar<span class="ls217">en<span class="_ _52"></span><span class="ls0">ot</span></span></div><div class="t m0 x32 h2a y134 ff19 fsf fc0 sc0 ls0 ws0">terminated <span class="_ _3"></span>by <span class="_ _2"></span>newlines.<span class="_ _16"> </span>Also, <span class="_ _3"></span>this <span class="_ _3"></span>editor <span class="_ _3"></span>doesn’t <span class="_ _3"></span>want <span class="_ _3"></span>processing <span class="_ _3"></span>by <span class="_ _2"></span>the <span class="_ _3"></span>system <span class="_ _3"></span>of <span class="_ _3"></span>the</div><div class="t m0 x32 h2a y135 ff19 fsf fc0 sc0 ls0 ws0">special <span class="_ _2"></span>characters, <span class="_ _2"></span>since <span class="_ _3"></span>they <span class="_ _2"></span>may <span class="_ _2"></span>overlap <span class="_ _3"></span>with <span class="_ _2"></span>the <span class="_ _2"></span>editor <span class="_ _3"></span>commands.<span class="_ _61"> </span>For <span class="_ _2"></span>example, <span class="_ _3"></span>the</div><div class="t m0 x32 h2a y136 ff19 fsf fc0 sc0 ls0 ws0">Control</div><div class="t m0 x22f h2a y4e9d ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 x135 h26 y136 ff19 fsf fc0 sc0 ls8a1 ws0">Dc<span class="_ _b"></span><span class="ls0">haracter <span class="_ _9"></span>is <span class="_ _9"></span>often <span class="_ _3"></span>the <span class="_ _9"></span>end-of-ﬁle <span class="_ _3"></span>character <span class="_ _9"></span>for <span class="_ _9"></span>the <span class="_ _3"></span>terminal, <span class="_ _9"></span>but <span class="_ _9"></span>it’s <span class="_ _3"></span>also <span class="_ _9"></span>a<span class="_ _47"> </span><span class="ff1a">vi</span></span></div><div class="t m0 x32 h2a y137 ff19 fsf fc0 sc0 ls0 ws0">command to scroll down one-half scr<span class="_ _0"></span>een.</div><div class="t m0 x76 h51 y1571 ff19 fs2a fc0 sc0 ls0 ws0">The <span class="_ _2"></span>V<span class="_ _6"></span>ersion <span class="_ _2"></span>7 <span class="_ _3"></span>and <span class="_ _2"></span>older <span class="_ _2"></span>BSD-style <span class="_ _2"></span>terminal <span class="_ _3"></span>drivers <span class="_ _2"></span>supported <span class="_ _2"></span>three <span class="_ _2"></span>modes <span class="_ _2"></span>for <span class="_ _3"></span>terminal <span class="_ _2"></span>input:</div><div class="t m0 x76 h51 y1572 ff19 fs2a fc0 sc0 ls0 ws0">(a) cooked <span class="_ _2"></span>mode <span class="_ _2"></span>(the <span class="_ _2"></span>input <span class="_ _2"></span>is <span class="_ _2"></span>collected <span class="_ _2"></span>into <span class="_ _2"></span>lines, and <span class="_ _2"></span>the <span class="_ _2"></span>special <span class="_ _2"></span>characters <span class="_ _2"></span>ar<span class="ls142c">ep<span class="_ _5"></span><span class="ls34e">ro<span class="ls0">cessed), <span class="_ _2"></span>(b)</span></span></span></div><div class="t m0 x76 h51 y1574 ff19 fs2a fc0 sc0 ls0 ws0">raw <span class="_ _80"> </span>mode <span class="_ _80"> </span>(the <span class="_ _66"> </span>input <span class="_ _80"> </span>is <span class="_ _80"> </span>not <span class="_ _66"> </span>assembled <span class="_ _80"> </span>into <span class="_ _80"> </span>lines, <span class="_ _66"> </span>and <span class="_ _80"> </span>there<span class="_ _44"> </span>is<span class="_ _4b"> </span>no<span class="_ _4b"> </span>p<span class="ls34e">ro<span class="_ _2"></span></span>cessing <span class="_ _80"> </span>of <span class="_ _66"> </span>special</div><div class="t m0 x76 h51 y4e9e ff19 fs2a fc0 sc0 ls0 ws0">characters), <span class="_ _2"></span>and <span class="_ _2"></span>(c) <span class="_ _2"></span>cbreak mode <span class="_ _3"></span>(the <span class="_ _2"></span>input <span class="_ _2"></span>is <span class="_ _2"></span>not <span class="_ _2"></span>assembled <span class="_ _2"></span>into <span class="_ _2"></span>lines, <span class="_ _2"></span>but <span class="_ _3"></span>some <span class="_ _2"></span>of <span class="_ _2"></span>the <span class="_ _2"></span>special</div><div class="t m0 x76 h51 y4e9f ff19 fs2a fc0 sc0 ls0 ws0">characters <span class="_ _23"> </span>ar<span class="ls142d">ep<span class="_ _b"></span><span class="ls34e">ro<span class="ls0">cessed). <span class="_ _45"> </span>Figur<span class="ls142d">e1<span class="_ _b"></span><span class="ls0">8.20 <span class="_ _42"> </span>shows <span class="_ _23"> </span>a <span class="_ _42"> </span>POSIX.1 <span class="_ _42"> </span>function <span class="_ _23"> </span>that <span class="_ _42"> </span>places <span class="_ _23"> </span>a <span class="_ _42"> </span>terminal <span class="_ _42"> </span>in</span></span></span></span></span></div><div class="t m0 x76 h51 y4ea0 ff19 fs2a fc0 sc0 ls0 ws0">cbreak or raw mode.</div><div class="t m0 x3f h2a y4ea1 ff19 fsf fc0 sc0 ls0 ws0">POSIX.1 <span class="_ _2"></span>deﬁnes <span class="_ _3"></span>1<span class="_ _1"></span><span class="ls8d9">1s<span class="_ _4f"></span><span class="ls0">pecial <span class="_ _3"></span>input <span class="_ _2"></span>characters, <span class="_ _3"></span>9 <span class="_ _3"></span>of <span class="_ _2"></span>which <span class="_ _3"></span>we <span class="_ _3"></span>can <span class="_ _3"></span>change.<span class="_ _61"> </span><span class="ls5f">We<span class="_ _9"></span></span>’ve <span class="_ _3"></span>been</span></span></div><div class="t m0 x32 h2a y4ea2 ff19 fsf fc0 sc0 ls0 ws0">using <span class="_ _9"></span>some <span class="_ _9"></span>of <span class="_ _9"></span>these <span class="_ _9"></span>throughout <span class="_ _3"></span>the <span class="_ _9"></span>text<span class="_ _9"></span><span class="ls9d">—t<span class="_ _6"></span><span class="ls0">he <span class="_ _9"></span>end-of-ﬁle <span class="_ _9"></span>character <span class="_ _9"></span>(usually <span class="_ _9"></span>Control</span></span></div><div class="t m0 x55 h2a y4ea3 ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 x1b8 h2a y4ea2 ff19 fsf fc0 sc0 ls0 ws0">D)</div><div class="t m0 x32 h2a y4ea4 ff19 fsf fc0 sc0 ls0 ws0">and the <span class="_ _2"></span>suspend <span class="_ _2"></span>character <span class="_ _2"></span>(usually <span class="_ _2"></span>Control</div><div class="t m0 x114 h2a y4ea5 ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 xca h2a y4ea4 ff19 fsf fc0 sc0 ls0 ws0">Z), for <span class="_ _2"></span>example.<span class="_ _61"> </span>Section <span class="_ _2"></span>18.3 <span class="_ _2"></span>describes <span class="_ _2"></span>each</div><div class="t m0 x32 h2a y4ea6 ff19 fsf fc0 sc0 ls0 ws0">of these characters.</div><div class="t m0 x3f h2a y4ea7 ff19 fsf fc0 sc0 ls5f ws0">We <span class="_ _80"> </span>c<span class="_ _23"></span><span class="ls0">an <span class="_ _3"></span>think <span class="_ _9"></span>of <span class="_ _9"></span>a <span class="_ _3"></span>terminal <span class="_ _9"></span>device <span class="_ _9"></span>as <span class="_ _3"></span>being <span class="_ _9"></span>controlled <span class="_ _3"></span>by <span class="_ _9"></span>a <span class="_ _9"></span>terminal <span class="_ _3"></span>driver<span class="_ _1"></span><span class="ls142e">,u<span class="_ _b"></span><span class="ls0">sually</span></span></span></div><div class="t m0 x32 h2a y4ea8 ff19 fsf fc0 sc0 ls0 ws0">within <span class="_"> </span>the <span class="_ _53"> </span>kernel.<span class="_ _60"> </span>Each <span class="_"> </span>terminal <span class="_ _53"> </span>device <span class="_"> </span>has <span class="_"> </span>an <span class="_ _53"> </span>input <span class="_"> </span>queue <span class="_"> </span>and <span class="_ _e"> </span>an <span class="_"> </span>output <span class="_ _53"> </span>queue,</div><div class="t m0 x32 h2a y4ea9 ff19 fsf fc0 sc0 ls0 ws0">shown in Figur<span class="ls44">e1<span class="_ _4f"></span><span class="ls0">8.1.</span></span></div><div class="t m0 x6 h2d y4eaa ff19 fs10 fc0 sc0 ls0 ws0">output queue</div><div class="t m0 x1f5 h2e y4eab ff19 fs11 fc0 sc0 ls0 ws0">if echo enabled</div><div class="t m0 x13e h2f y4eac ff19 fs12 fc0 sc0 ls0 ws0">input queue</div><div class="t m0 x20 h31 y4ead ff19 fs14 fc0 sc0 ls0 ws0">next character to</div><div class="t m0 xf2 h31 y4eae ff19 fs14 fc0 sc0 ls0 ws0">transmit to device</div><div class="t m0 x1d2 h32 y4eaf ff19 fs15 fc0 sc0 ls0 ws0">next character</div><div class="t m0 x8c h32 y4eb0 ff19 fs15 fc0 sc0 ls0 ws0">written by process</div><div class="t m0 x177 h33 y4eb1 ff19 fs16 fc0 sc0 ls0 ws0">next character</div><div class="t m0 x1c5 h33 y4eb2 ff19 fs16 fc0 sc0 lscd8 ws0">re<span class="ls0">ad from device</span></div><div class="t m0 x160 h83 y4eb3 ff19 fs36 fc0 sc0 ls0 ws0">next character</div><div class="t m0 x1b1 h83 y4eb4 ff19 fs36 fc0 sc0 ls871 ws0">re<span class="ls0">ad by process</span></div><div class="t m0 x5e hd4 y4eb5 ff1a fs18 fc0 sc0 ls0 ws0">MAX_INPUT</div><div class="t m0 x1b0 h35 y4eb6 ff18 fs18 fc0 sc0 ls0 ws0">Figure 18.1<span class="_ _5a"> </span><span class="ff19">Logical picture<span class="_"> </span>of<span class="_"> </span>input and output queues for a terminal device</span></div><div class="t m0 x32 h69 y4eb7 ff19 fs34 fc0 sc0 ls0 ws0">Ther<span class="ls66a">ea<span class="_ _4f"></span><span class="ls1df">re <span class="_ _3"></span>s<span class="ls0">everal points to consider from this picture.</span></span></span></div><div class="t m0 x3f h69 y4eb8 ff19 fs34 fc0 sc0 ls142f ws0">•I<span class="_ _4d"></span><span class="ls1430">fe<span class="_ _b"></span><span class="ls0">choing <span class="_ _9"></span>is <span class="_ _9"></span>enabled, <span class="_ _3"></span>there<span class="_ _45"> </span>is<span class="_ _47"> </span>an<span class="_ _45"> </span>implied <span class="_ _9"></span>link <span class="_ _3"></span>between <span class="_ _9"></span>the <span class="_ _9"></span>input <span class="_ _9"></span>queue <span class="_ _3"></span>and <span class="_ _9"></span>the</span></span></div><div class="t m0 x15 h69 y4eb9 ff19 fs34 fc0 sc0 ls0 ws0">output queue.</div><div class="t m0 x3f h6a y4eba ff19 fs34 fc0 sc0 ls142f ws0">•T<span class="_ _4d"></span><span class="ls0">he <span class="_ _23"></span>size <span class="_ _23"> </span>of <span class="_ _23"> </span>the <span class="_ _23"> </span>input <span class="_ _23"> </span>queue,<span class="_ _35"> </span><span class="ff1a">MAX_INPUT<span class="_ _35"> </span></span>(see <span class="_ _23"> </span>Figur<span class="ls1431">e2<span class="_ _43"></span><span class="ls0">.12), <span class="_ _23"> </span>is <span class="_ _23"> </span>ﬁnite.<span class="_ _51"> </span>When <span class="_ _23"> </span>the</span></span></span></div><div class="t m0 x15 h69 y4ebb ff19 fs34 fc0 sc0 ls0 ws0">input <span class="_ _3"></span>queue <span class="_ _9"></span>for <span class="_ _9"></span>a <span class="_ _3"></span>particular <span class="_ _9"></span>device <span class="_ _9"></span>ﬁlls, <span class="_ _3"></span>the <span class="_ _9"></span>system <span class="_ _9"></span>behavior <span class="_ _9"></span>is <span class="_ _3"></span>implementation</div><div class="t m0 x15 h69 y4ebc ff19 fs34 fc0 sc0 ls0 ws0">dependent. <span class="_"> </span>Most<span class="_"> </span>UNIX systems echo the bell character when this happens.</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
