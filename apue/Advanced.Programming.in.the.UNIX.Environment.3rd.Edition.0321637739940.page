<div id="pf3ac" class="pf w4 h1f" data-page-no="3ac"><div class="pc pc3ac w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg3ac.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">906<span class="_ _1b"> </span><span class="ff19">Solutions <span class="_"> </span>to <span class="_"> </span>Selected <span class="_"> </span>Exercises <span class="_ _2eb"> </span>Appendix<span class="_ _4b"> </span>C</span></div><div class="t m0 x215 h26 y12f ff19 fsf fc0 sc0 ls0 ws0">argument <span class="_ _3"></span>to<span class="_ _45"> </span><span class="ff1a">strerror<span class="_ _47"> </span></span>is <span class="_ _9"></span>an <span class="_ _9"></span>integer<span class="_ _1"></span><span class="ls17f7">,a<span class="_ _b"></span><span class="ls0">nd <span class="_ _9"></span>since <span class="_ _9"></span>C <span class="_ _3"></span>passes <span class="_ _9"></span>all <span class="_ _9"></span>arguments <span class="_ _3"></span>by <span class="_ _9"></span>value,</span></span></div><div class="t m0 x215 h26 y130 ff19 fsf fc0 sc0 ls0 ws0">the<span class="_ _35"> </span><span class="ff1a">strerror<span class="_ _35"> </span></span>function <span class="_ _42"> </span>couldn’t <span class="_ _42"> </span>modify <span class="_ _23"> </span>this <span class="_ _42"> </span>value <span class="_ _42"> </span>even <span class="_ _23"> </span>if <span class="_ _42"> </span>it <span class="_ _42"> </span>wanted <span class="_ _23"> </span>to.<span class="_ _54"> </span>(If <span class="_ _42"> </span>the</div><div class="t m0 x215 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">handling <span class="_ _2"></span>of <span class="_ _2"></span>function <span class="_ _2"></span>arguments <span class="_ _2"></span>in <span class="_ _2"></span>C <span class="_ _2"></span>is <span class="_ _2"></span>not <span class="_ _2"></span>clear<span class="_ _1"></span><span class="ls109">,y<span class="_ _4f"></span><span class="ls0">ou <span class="_ _2"></span>should <span class="_ _3"></span>review Section <span class="_ _2"></span>5.2 <span class="_ _3"></span>of</span></span></div><div class="t m0 x215 h2a y132 ff19 fsf fc0 sc0 ls0 ws0">Kernighan and Ritchie</div><div class="t m0 x72 h2a y1ab0 ff19 fsf fc0 sc0 ls0 ws0">[</div><div class="t m0 x59 h2a y132 ff19 fsf fc0 sc0 ls0 ws0">1988</div><div class="t m0 x5b h2a y1ab0 ff19 fsf fc0 sc0 ls0 ws0">]</div><div class="t m0 x5c h2a y132 ff19 fsf fc0 sc0 ls0 ws0">.)</div><div class="t m0 x32 h26 y2936 ff18 fsf fc0 sc0 ls0 ws0">1.4<span class="_ _9b"> </span><span class="ff19">During the year 2038.<span class="_ _61"> </span><span class="ls5f">We <span class="_ _53"> </span>c<span class="_ _9"></span></span>an <span class="_ _2"></span>solve the <span class="_ _2"></span>problem by making <span class="_ _2"></span>the<span class="_"> </span><span class="ff1a">time_t<span class="_ _66"> </span></span>data <span class="_ _2"></span>type</span></div><div class="t m0 x215 h2a y2914 ff19 fsf fc0 sc0 ls14a5 ws0">a6<span class="_ _55"></span><span class="ls0">4</span></div><div class="t m0 x1c h2a y5fe1 ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 xd8 h2a y2914 ff19 fsf fc0 sc0 ls0 ws0">bit <span class="_ _e"> </span>integer<span class="_ _6"></span><span class="ls17f8">.I<span class="_ _64"></span><span class="ls14a5">fi<span class="_ _c"></span><span class="ls0">t<span class="_ _4b"> </span>is<span class="_ _4b"> </span>currently <span class="_ _e"> </span>a <span class="_ _e"> </span>32</span></span></span></div><div class="t m0 x74 h2a y5fe1 ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 xaf h2a y2914 ff19 fsf fc0 sc0 ls0 ws0">bit <span class="_ _e"> </span>integer<span class="_ _6"></span><span class="ls17f9">,a<span class="_ _c"></span><span class="ls0">pplications <span class="_ _53"> </span>will <span class="_"> </span>have <span class="_ _53"> </span>to <span class="_ _e"> </span>be</span></span></div><div class="t m0 x215 h2a y2915 ff19 fsf fc0 sc0 ls45 ws0">re<span class="ls0">compiled <span class="_ _23"> </span>to <span class="_ _23"> </span>work <span class="_ _23"> </span>properly<span class="_ _4"></span><span class="ls17fa">.B<span class="_ _26"></span><span class="ls0">ut <span class="_ _23"></span>the <span class="_ _23"></span>pr<span class="_ _0"></span>oblem <span class="_ _23"></span>is <span class="_ _23"></span>worse.<span class="_ _5a"> </span>Some <span class="_ _23"> </span>ﬁle <span class="_ _23"> </span>systems <span class="_ _23"> </span>and</span></span></span></div><div class="t m0 x215 h2a y2937 ff19 fsf fc0 sc0 ls0 ws0">backup <span class="_ _3"></span>media <span class="_ _9"></span>stor<span class="ls732">et<span class="_ _b"></span><span class="ls0">imes <span class="_ _9"></span>in <span class="_ _9"></span>32</span></span></div><div class="t m0 x9a h2a y5fe2 ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 x1bb h2a y2937 ff19 fsf fc0 sc0 ls0 ws0">bit <span class="_ _3"></span>integers.<span class="_ _5a"> </span>These <span class="_ _9"></span>would <span class="_ _9"></span>need <span class="_ _3"></span>to <span class="_ _9"></span>be <span class="_ _9"></span>updated <span class="_ _9"></span>as</div><div class="t m0 x215 h2a y2938 ff19 fsf fc0 sc0 ls0 ws0">well, but we still need to be able to read the old format.</div><div class="t m0 x32 h2a y1153 ff18 fsf fc0 sc0 ls0 ws0">1.5<span class="_ _9b"> </span><span class="ff19">Appr<span class="_ _1"></span>oximately 248 days.</span></div><div class="t m0 x35 h27 y508d ff16 fsf fc0 sc0 ls0 ws0">Chapter <span class="_"> </span>2</div><div class="t m0 x32 h2a y1f11 ff18 fsf fc0 sc0 ls0 ws0">2.1<span class="_ _9b"> </span><span class="ff19">The <span class="_ _9"></span>following <span class="_ _23"> </span>technique <span class="_ _42"> </span>is <span class="_ _23"></span>used <span class="_ _23"></span>by <span class="_ _23"></span>FreeBSD. <span class="_ _45"> </span>The<span class="_ _35"> </span>primitive <span class="_ _23"> </span>data <span class="_ _23"> </span>types <span class="_ _42"> </span>that <span class="_ _23"></span>can</span></div><div class="t m0 x215 h26 y2853 ff19 fsf fc0 sc0 ls0 ws0">appear <span class="_ _e"> </span>in <span class="_ _e"> </span>multiple <span class="_ _e"> </span>headers <span class="_ _e"> </span>ar<span class="ls17fb">ed<span class="_ _55"></span><span class="ls0">eﬁned <span class="_ _e"> </span>in <span class="_ _e"> </span>the <span class="_ _e"> </span>header<span class="_ _59"> </span><span class="ff1a">&lt;machine/_types.h&gt;</span>.</span></span></div><div class="t m0 x215 h2a y2854 ff19 fsf fc0 sc0 ls0 ws0">For example:</div><div class="t m0 x1a7 h57 y5fe3 ff1a fs2d fc0 sc0 ls0 ws0">#ifndef _MACHINE__TYPES_H_</div><div class="t m0 x1a7 h57 y5fe4 ff1a fs2d fc0 sc0 ls0 ws0">#define _MACHINE__TYPES_H_</div><div class="t m0 x1a7 h57 y5fe5 ff1a fs2d fc0 sc0 ls0 ws0">typedef int<span class="_ _166"> </span>__int32_t;</div><div class="t m0 x1a7 h57 y5fe6 ff1a fs2d fc0 sc0 ls0 ws0">typedef unsigned int<span class="_ _15"> </span>__uint32_t;</div><div class="t m0 x148 h57 y5fe7 ff1a fs2d fc0 sc0 ls0 ws0">.</div><div class="t m0 x148 h57 y5fe8 ff1a fs2d fc0 sc0 ls0 ws0">.</div><div class="t m0 x148 h57 y5fe9 ff1a fs2d fc0 sc0 ls0 ws0">.</div><div class="t m0 x1a7 h57 y5fea ff1a fs2d fc0 sc0 ls0 ws0">typedef __uint32_t<span class="_ _189"> </span>__size_t;</div><div class="t m0 x148 h57 y5feb ff1a fs2d fc0 sc0 ls0 ws0">.</div><div class="t m0 x148 h57 y5fec ff1a fs2d fc0 sc0 ls0 ws0">.</div><div class="t m0 x148 h57 y5fed ff1a fs2d fc0 sc0 ls0 ws0">.</div><div class="t m0 x1a7 h57 y5fee ff1a fs2d fc0 sc0 ls0 ws0">#endif <span class="_"> </span>/*<span class="_"> </span>_MACHINE__TYPES_H_ */</div><div class="t m0 x215 h26 y5fef ff19 fsf fc0 sc0 ls0 ws0">In <span class="_ _2"></span>each <span class="_ _3"></span>of <span class="_ _2"></span>the <span class="_ _3"></span>headers <span class="_ _2"></span>that <span class="_ _3"></span>can <span class="_ _2"></span>deﬁne <span class="_ _3"></span>the<span class="_ _47"> </span><span class="ff1a">size_t<span class="_ _66"> </span></span>primitive <span class="_ _3"></span>system <span class="_ _2"></span>data <span class="_ _3"></span>type, <span class="_ _2"></span>we</div><div class="t m0 x215 h2a y5ff0 ff19 fsf fc0 sc0 ls0 ws0">have the sequence</div><div class="t m0 x1a7 h57 y5ff1 ff1a fs2d fc0 sc0 ls0 ws0">#ifndef <span class="_"> </span>_SIZE_T_DECLARED</div><div class="t m0 x1a7 h57 y5ff2 ff1a fs2d fc0 sc0 ls0 ws0">typedef __size_t<span class="_ _b7"> </span>size_t;</div><div class="t m0 x1a7 h57 y5ff3 ff1a fs2d fc0 sc0 ls0 ws0">#define _SIZE_T_DECLARED</div><div class="t m0 x1a7 h57 y5ff4 ff1a fs2d fc0 sc0 ls0 ws0">#endif</div><div class="t m0 x215 h26 y5ff5 ff19 fsf fc0 sc0 ls0 ws0">This way<span class="_ _4"></span><span class="ls44">,t<span class="_ _5"></span><span class="ls0">he<span class="_"> </span><span class="ff1a">typedef<span class="_ _80"> </span></span>for<span class="_"> </span><span class="ff1a">size_t<span class="_ _80"> </span></span>is executed only once.</span></span></div><div class="t m0 x32 h26 y5ff6 ff18 fsf fc0 sc0 ls0 ws0">2.3<span class="_ _9b"> </span><span class="ff19">If<span class="_ _47"> </span><span class="ff1a">OPEN_MAX<span class="_ _45"> </span></span>is <span class="_ _9"></span>indeterminate <span class="_ _9"></span>or <span class="_ _3"></span>ridiculously <span class="_ _9"></span>large <span class="_ _9"></span>(i.e., <span class="_ _9"></span>equal <span class="_ _9"></span>to<span class="_ _45"> </span><span class="ff1a">LONG_MAX</span>), <span class="_ _3"></span>we</span></div><div class="t m0 x215 h26 y5ff7 ff19 fsf fc0 sc0 ls0 ws0">can <span class="_ _42"> </span>use<span class="_ _4b"> </span><span class="ff1a">getrlimit<span class="_ _44"> </span></span>to <span class="_ _42"> </span>get <span class="_ _53"> </span>the <span class="_ _53"> </span>per-pr<span class="_ _0"></span>ocess <span class="_ _42"> </span>maximum <span class="_ _53"> </span>for <span class="_ _53"> </span>open <span class="_ _53"> </span>ﬁle <span class="_ _42"> </span>descriptors.</div><div class="t m0 x215 h2a y5ff8 ff19 fsf fc0 sc0 ls0 ws0">Since <span class="_ _42"> </span>the <span class="_ _53"> </span>per-process <span class="_ _42"> </span>limit <span class="_ _42"> </span>can <span class="_ _53"> </span>be <span class="_ _53"> </span>modiﬁed, <span class="_ _42"> </span>we <span class="_ _53"> </span>can’t <span class="_ _53"> </span>cache <span class="_ _53"> </span>the <span class="_ _42"> </span>value <span class="_ _53"> </span>obtained</div><div class="t m0 x215 h2a y5ff9 ff19 fsf fc0 sc0 ls0 ws0">from the pr<span class="_ _0"></span>evious call (it might have changed).<span class="_ _59"> </span>See Figur<span class="ls44">eC<span class="_ _d"></span><span class="ls0">.1.</span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
