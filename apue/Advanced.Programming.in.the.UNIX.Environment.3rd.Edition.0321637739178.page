<div id="pfb2" class="pf w4 h1f" data-page-no="b2"><div class="pc pcb2 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bgb2.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">144<span class="_ _1b"> </span><span class="ff19">Standar<span class="ls30a">dI<span class="_ _55"></span><span class="ls0">/O <span class="_"> </span>Library<span class="_ _1c9"> </span>Chapter <span class="_"> </span>5</span></span></span></div><div class="t m0 x32 h2a y12f ff19 fsf fc0 sc0 ls0 ws0">Standar<span class="ls630">dI<span class="_ _c"></span><span class="ls0">/O <span class="_ _42"> </span>ﬁle <span class="_ _42"> </span>streams <span class="_ _42"> </span>can <span class="_ _42"> </span>be <span class="_ _53"> </span>used <span class="_ _42"> </span>with <span class="_ _42"> </span>both <span class="_ _53"> </span>single-byte <span class="_ _42"> </span>and <span class="_ _42"> </span>multibyte <span class="_ _42"> </span>(‘‘wide’<span class="_ _1"></span>’)</span></span></div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">character <span class="_ _9"></span>sets.<span class="_ _51"> </span><span class="ls631">As<span class="_ _b"></span><span class="ls0">tr<span class="_ _0"></span>eam’s <span class="_ _9"></span>orientation <span class="_ _23"></span>determines <span class="_ _9"></span>whether <span class="_ _23"></span>the <span class="_ _9"></span>characters <span class="_ _23"> </span>that <span class="_ _23"></span>ar<span class="_ _0"></span><span class="ls632">er<span class="_ _43"></span><span class="ls0">ead</span></span></span></span></div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">and <span class="_ _23"></span>written <span class="_ _9"></span>ar<span class="ls4b6">es<span class="_ _b"></span><span class="ls0">ingle <span class="_ _9"></span>byte <span class="_ _23"></span>or <span class="_ _23"></span>multibyte.<span class="_ _5a"> </span>Initially<span class="_ _6"></span><span class="ls4b6">,w<span class="_ _b"></span><span class="ls0">hen <span class="_ _9"></span>a <span class="_ _23"></span>stream <span class="_ _9"></span>is <span class="_ _23"></span>created, <span class="_ _9"></span>it <span class="_ _23"></span>has <span class="_ _23"></span>no</span></span></span></span></div><div class="t m0 x32 h26 y132 ff19 fsf fc0 sc0 ls0 ws0">orientation. <span class="_ _45"> </span>If<span class="_ _47"> </span><span class="ls633">am<span class="_ _8"></span><span class="ls0">ultibyte <span class="_ _9"></span>I/O <span class="_ _9"></span>function <span class="_ _9"></span>(see<span class="_ _45"> </span><span class="ff1a">&lt;wchar.h&gt;</span>)<span class="_ _45"> </span>is<span class="_ _47"> </span>used <span class="_ _9"></span>on <span class="_ _9"></span>a <span class="_ _9"></span>stream <span class="_ _3"></span>without</span></span></div><div class="t m0 x32 h2a y133 ff19 fsf fc0 sc0 ls0 ws0">orientation, <span class="_ _23"> </span>the <span class="_ _42"> </span>stream’s <span class="_ _23"> </span>orientation <span class="_ _42"> </span>is <span class="_ _23"> </span>set <span class="_ _42"> </span>to <span class="_ _42"> </span>wide <span class="_ _23"> </span>oriented.<span class="_ _54"> </span>If <span class="_ _23"> </span>a <span class="_ _42"> </span>byte <span class="_ _23"> </span>I/O <span class="_ _42"> </span>function <span class="_ _42"> </span>is</div><div class="t m0 x32 h2a y134 ff19 fsf fc0 sc0 ls0 ws0">used <span class="_ _23"> </span>on <span class="_ _42"> </span>a <span class="_ _23"> </span>stream <span class="_ _23"> </span>without <span class="_ _42"> </span>orientation, <span class="_ _23"> </span>the <span class="_ _42"> </span>str<span class="_ _0"></span>eam’s <span class="_ _23"> </span>orientation <span class="_ _42"> </span>is <span class="_ _23"> </span>set <span class="_ _42"> </span>to <span class="_ _23"> </span>byte <span class="_ _42"> </span>oriented.</div><div class="t m0 x32 h26 y135 ff19 fsf fc0 sc0 ls0 ws0">Only <span class="_ _45"> </span>two <span class="_ _35"> </span>functions <span class="_ _45"> </span>can <span class="_ _45"> </span>change <span class="_ _35"> </span>the <span class="_ _45"> </span>orientation <span class="_ _35"> </span>once <span class="_ _45"> </span>set.<span class="_ _5c"> </span>The<span class="_ _5a"> </span><span class="ff1a">freopen<span class="_ _51"> </span></span>function</div><div class="t m0 x32 h26 y136 ff19 fsf fc0 sc0 ls0 ws0">(discussed <span class="_ _3"></span>shortly) <span class="_ _9"></span>will <span class="_ _3"></span>clear <span class="_ _9"></span>a <span class="_ _3"></span>stream’s <span class="_ _3"></span>orientation; <span class="_ _9"></span>the<span class="_ _47"> </span><span class="ff1a">fwide<span class="_ _45"> </span></span>function <span class="_ _3"></span>can <span class="_ _9"></span>be <span class="_ _3"></span>used <span class="_ _9"></span>to</div><div class="t m0 x32 h2a y137 ff19 fsf fc0 sc0 ls0 ws0">set a stream’s orientation.</div><div class="t m0 x3f h57 y146f ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;stdio.h&gt;</div><div class="t m0 x3f h57 y1470 ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;wchar.h&gt;</div><div class="t m0 x3f h57 y1471 ff1a fs2d fc0 sc0 ls0 ws0">int fwide(FILE *<span class="ff1b">fp</span><span class="ls15c">,i<span class="_ _1d"></span><span class="ls0">nt<span class="_"> </span><span class="ff1b">mode</span>);</span></span></div><div class="t m0 x7e h5f y1472 ff19 fs2d fc0 sc0 ls0 ws0">Returns: positive if stream is wide oriented,</div><div class="t m0 x6d h5f y1473 ff19 fs2d fc0 sc0 ls0 ws0">negative if stream is byte oriented,</div><div class="t m0 x6d h5f y1474 ff19 fs2d fc0 sc0 ls0 ws0">or 0 if stream has no orientation</div><div class="t m0 x32 h4d y1475 ff19 fs26 fc0 sc0 ls0 ws0">The<span class="_ _46"> </span><span class="ff1a">fwide<span class="_ _46"> </span></span>function <span class="_ _66"> </span>performs <span class="_ _66"> </span>different <span class="_"> </span>tasks, <span class="_"> </span>depending <span class="_"> </span>on <span class="_ _66"> </span>the <span class="_ _66"> </span>value <span class="_ _66"> </span>of <span class="_ _66"> </span>the<span class="_ _61"> </span><span class="ff1b">mode</span></div><div class="t m0 x32 h49 y1476 ff19 fs26 fc0 sc0 ls0 ws0">argument.</div><div class="t m0 x3f h4d y1477 ff19 fs26 fc0 sc0 ls15d ws0">•I<span class="_ _4d"></span><span class="ls634">ft<span class="_ _43"></span><span class="ls0">he<span class="_ _35"> </span><span class="ff1b">mode<span class="_ _35"> </span></span>argument <span class="_ _23"></span>is <span class="_ _23"> </span>negative,<span class="_ _35"> </span><span class="ff1a">fwide<span class="_ _35"> </span></span>will <span class="_ _23"> </span>try <span class="_ _23"> </span>to <span class="_ _42"> </span>make <span class="_ _23"></span>the <span class="_ _23"> </span>speciﬁed <span class="_ _23"> </span>stream</span></span></div><div class="t m0 x15 h49 y1478 ff19 fs26 fc0 sc0 ls0 ws0">byte oriented.</div><div class="t m0 x3f h4d y1479 ff19 fs26 fc0 sc0 ls15d ws0">•I<span class="_ _4d"></span><span class="ls635">ft<span class="_ _43"></span><span class="ls0">he<span class="_ _35"> </span><span class="ff1b">mode<span class="_ _44"> </span></span>ar<span class="_ _0"></span>gument <span class="_ _42"> </span>is <span class="_ _23"> </span>positive,<span class="_ _44"> </span><span class="ff1a">fwide<span class="_ _35"> </span></span>will <span class="_ _42"> </span>try <span class="_ _42"> </span>to <span class="_ _42"> </span>make <span class="_ _42"> </span>the <span class="_ _23"> </span>speciﬁed <span class="_ _42"> </span>stream</span></span></div><div class="t m0 x15 h49 y147a ff19 fs26 fc0 sc0 ls0 ws0">wide oriented.</div><div class="t m0 x3f h4d y147b ff19 fs26 fc0 sc0 ls15d ws0">•I<span class="_ _4d"></span><span class="ls636">ft<span class="_ _b"></span><span class="ls0">he<span class="_ _45"> </span><span class="ff1b">mode<span class="_ _45"> </span></span>argument <span class="_ _9"></span>is <span class="_ _9"></span>zero,<span class="_ _45"> </span><span class="ff1a">fwide<span class="_ _45"> </span></span>will <span class="_ _9"></span>not <span class="_ _9"></span>try <span class="_ _9"></span>to <span class="_ _23"></span>set <span class="_ _9"></span>the <span class="_ _9"></span>orientation, <span class="_ _9"></span>but <span class="_ _23"></span>will</span></span></div><div class="t m0 x15 h49 y147c ff19 fs26 fc0 sc0 ls0 ws0">still return a value identifying the str<span class="_ _0"></span>eam’s orientation.</div><div class="t m0 x3f h4d y147d ff19 fs26 fc0 sc0 ls0 ws0">Note that<span class="_"> </span><span class="ff1a">fwide<span class="_ _66"> </span></span>will not <span class="_ _2"></span>change the <span class="_ _2"></span>orientation of a <span class="_ _2"></span>stream that is already oriented.</div><div class="t m0 x32 h49 y147e ff19 fs26 fc0 sc0 ls0 ws0">Also <span class="_ _23"></span>note <span class="_ _23"></span>that <span class="_ _23"></span>there<span class="_ _45"> </span>is<span class="_ _35"> </span>no<span class="_ _35"> </span>err<span class="_ _0"></span>or <span class="_ _23"></span>return. <span class="_ _45"> </span>Consider<span class="_ _35"> </span>what <span class="_ _23"></span>would <span class="_ _23"></span>happen <span class="_ _23"></span>if <span class="_ _23"></span>the <span class="_ _23"></span>str<span class="_ _0"></span>eam <span class="_ _23"></span>is</div><div class="t m0 x32 h4d y147f ff19 fs26 fc0 sc0 ls0 ws0">invalid. <span class="_ _45"> </span>The<span class="_ _45"> </span>only <span class="_ _23"></span>recourse <span class="_ _9"></span>we <span class="_ _9"></span>have <span class="_ _23"></span>is <span class="_ _9"></span>to <span class="_ _23"></span>clear<span class="_ _45"> </span><span class="ff1a">errno<span class="_ _45"> </span></span>befor<span class="ls637">ec<span class="_ _b"></span><span class="ls0">alling<span class="_ _45"> </span><span class="ff1a">fwide<span class="_ _45"> </span></span>and <span class="_ _23"></span>check</span></span></div><div class="t m0 x32 h4d y1480 ff19 fs26 fc0 sc0 ls0 ws0">the value of<span class="_"> </span><span class="ff1a">errno<span class="_ _66"> </span></span>when we return. <span class="_"> </span>Throughout the rest of this book, we will deal only</div><div class="t m0 x32 h49 y1481 ff19 fs26 fc0 sc0 ls0 ws0">with byte-oriented streams.</div><div class="t m0 x3f h4d y1482 ff19 fs26 fc0 sc0 ls0 ws0">When <span class="_ _23"></span>we <span class="_ _23"></span>open <span class="_ _9"></span>a <span class="_ _23"> </span>stream, <span class="_ _23"></span>the <span class="_ _23"></span>standar<span class="_ _0"></span><span class="ls638">dI<span class="_ _b"></span><span class="ls0">/O <span class="_ _9"></span>function<span class="_ _35"> </span><span class="ff1a">fopen<span class="_ _45"> </span></span>(Section <span class="_ _23"> </span>5.5) <span class="_ _23"> </span>returns <span class="_ _9"></span>a</span></span></div><div class="t m0 x32 h4d y1483 ff19 fs26 fc0 sc0 ls0 ws0">pointer <span class="_"> </span>to <span class="_ _47"> </span>a<span class="_ _46"> </span><span class="ff1a">FILE<span class="_ _61"> </span></span>object. <span class="_ _46"> </span>This<span class="_ _61"> </span>object <span class="_ _66"> </span>is <span class="_ _66"> </span>normally <span class="_ _47"> </span>a <span class="_"> </span>structur<span class="ls639">et<span class="_ _5b"></span><span class="ls0">hat <span class="_"> </span>contains <span class="_ _47"> </span>all <span class="_"> </span>the</span></span></div><div class="t m0 x32 h49 y1484 ff19 fs26 fc0 sc0 ls0 ws0">information <span class="_ _45"> </span>requir<span class="_ _1"></span>ed <span class="_ _45"> </span>by <span class="_ _45"> </span>the <span class="_ _45"> </span>standar<span class="ls63a">dI<span class="_ _26"></span><span class="ls0">/O <span class="_ _45"> </span>library <span class="_ _45"> </span>to <span class="_ _45"> </span>manage <span class="_ _45"> </span>the <span class="_ _45"> </span>stream: <span class="_ _45"> </span>the <span class="_ _45"> </span>ﬁle</span></span></div><div class="t m0 x32 h49 y1485 ff19 fs26 fc0 sc0 ls0 ws0">descriptor used <span class="_ _2"></span>for <span class="_ _2"></span>actual <span class="_ _2"></span>I/O, a <span class="_ _2"></span>pointer <span class="_ _2"></span>to <span class="_ _2"></span>a buffer for <span class="_ _2"></span>the <span class="_ _2"></span>stream, the <span class="_ _2"></span>size <span class="_ _2"></span>of the <span class="_ _2"></span>buffer<span class="_ _6"></span>,</div><div class="t m0 x32 h49 y1486 ff19 fs26 fc0 sc0 lsd3 ws0">ac<span class="_ _d"></span><span class="ls0">ount of the number of characters currently in the buffer<span class="_ _6"></span>,<span class="_"> </span>an<span class="_"> </span>error ﬂag, and the like.</span></div><div class="t m0 x3f h4d y1487 ff19 fs26 fc0 sc0 ls0 ws0">Application <span class="_ _2"></span>softwar<span class="ls4dc">es<span class="_ _8"></span><span class="ls0">hould <span class="_ _2"></span>never <span class="_ _3"></span>need <span class="_ _2"></span>to <span class="_ _2"></span>examine <span class="_ _2"></span>a<span class="_ _66"> </span><span class="ff1a">FILE<span class="_ _47"> </span></span>object. <span class="_ _66"> </span>T<span class="_ _6"></span><span class="ls63b">or<span class="_ _4f"></span><span class="ls0">eference the</span></span></span></span></div><div class="t m0 x32 h4d y1488 ff19 fs26 fc0 sc0 ls0 ws0">stream, <span class="_"> </span>we <span class="_ _47"> </span>pass <span class="_ _47"> </span>its<span class="_ _61"> </span><span class="ff1a">FILE<span class="_ _16"> </span></span>pointer <span class="_ _47"> </span>as <span class="_ _66"> </span>an <span class="_ _47"> </span>argument <span class="_ _66"> </span>to <span class="_ _47"> </span>each <span class="_ _47"> </span>standar<span class="ls63c">dI<span class="_ _1d"></span><span class="ls0">/O <span class="_ _47"> </span>function.</span></span></div><div class="t m0 x32 h4d y1489 ff19 fs26 fc0 sc0 ls0 ws0">Throughout <span class="_ _2"></span>this <span class="_ _3"></span>text, <span class="_ _3"></span>we’ll <span class="_ _3"></span>refer <span class="_ _2"></span>to <span class="_ _3"></span>a <span class="_ _9"></span>pointer <span class="_ _2"></span>to <span class="_ _3"></span>a<span class="_ _45"> </span><span class="ff1a">FILE<span class="_ _66"> </span></span>object, <span class="_ _3"></span>the <span class="_ _9"></span>type<span class="_ _47"> </span><span class="ff1a">FILE <span class="_ _4f"></span>*<span class="ff19">,<span class="_ _47"> </span>as<span class="_ _45"> </span>a<span class="_ _66"> </span><span class="ff1b">ﬁle</span></span></span></div><div class="t m0 x32 h4a y148a ff1b fs26 fc0 sc0 ls0 ws0">pointer<span class="ff19">.</span></div><div class="t m0 x3f h49 y148b ff19 fs26 fc0 sc0 ls0 ws0">Throughout <span class="_ _9"></span>this <span class="_ _42"> </span>chapter<span class="_ _6"></span>,<span class="_ _35"> </span>we<span class="_ _35"> </span>describe <span class="_ _23"></span>the <span class="_ _23"> </span>standar<span class="ls63d">dI<span class="_ _43"></span><span class="ls0">/O <span class="_ _23"> </span>library <span class="_ _23"> </span>in <span class="_ _23"> </span>the <span class="_ _23"> </span>context <span class="_ _42"> </span>of <span class="_ _23"></span>a</span></span></div><div class="t m0 x32 h49 y148c ff19 fs26 fc0 sc0 ls0 ws0">UNIX <span class="_ _2"></span>system.<span class="_ _61"> </span>As <span class="_ _2"></span>we <span class="_ _2"></span>mentioned, <span class="_ _2"></span>this <span class="_ _2"></span>library <span class="_ _2"></span>has <span class="_ _2"></span>been <span class="_ _2"></span>ported <span class="_ _2"></span>to <span class="_ _2"></span>a <span class="_ _3"></span>wide <span class="_ _2"></span>variety <span class="_ _2"></span>of <span class="_ _2"></span>other</div><div class="t m0 x32 h49 y148d ff19 fs26 fc0 sc0 ls0 ws0">operating <span class="_ _16"> </span>systems.<span class="_ _3a"> </span><span class="ls164">To <span class="_ _50"> </span>p<span class="_ _9"></span><span class="lscc">ro<span class="_ _2"></span></span></span>vide <span class="_ _5a"> </span>some <span class="_ _16"> </span>insight <span class="_ _5a"> </span>about <span class="_ _5a"> </span>how <span class="_ _5a"> </span>this <span class="_ _16"> </span>library <span class="_ _5a"> </span>can <span class="_ _5a"> </span>be</div><div class="t m0 x32 h49 y148e ff19 fs26 fc0 sc0 ls0 ws0">implemented, we will talk about its typical implementation on a UNIX system.</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
