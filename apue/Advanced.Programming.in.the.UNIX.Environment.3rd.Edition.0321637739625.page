<div id="pf271" class="pf w4 h1f" data-page-no="271"><div class="pc pc271 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg271.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>16.2<span class="_ _e5"> </span>Socket <span class="_"> </span>Descriptors<span class="_ _1b"> </span><span class="ff18">591</span></div><div class="t m0 x32 h2a y12f ff19 fsf fc0 sc0 ls0 ws0">TCP</div><div class="t m0 x8a h2a y1ac ff19 fsf fc0 sc0 ls0 ws0">(</div><div class="t m0 x33 h2a y12f ff19 fsf fc0 sc0 lsbc ws0">Tr<span class="_ _9"></span><span class="ls0">ansmission <span class="_ _2"></span>Control Protocol</span></div><div class="t m0 x16 h2a y1ac ff19 fsf fc0 sc0 ls0 ws0">)</div><div class="t m0 x99 h26 y12f ff19 fsf fc0 sc0 ls9e8 ws0">.T<span class="_ _5b"></span><span class="ls0">he <span class="_ _2"></span>default <span class="_ _2"></span>protocol for <span class="_ _2"></span>a<span class="_ _47"> </span><span class="ff1a">SOCK_DGRAM<span class="_ _66"> </span></span>socket <span class="_ _2"></span>in</span></div><div class="t m0 x32 h26 y130 ff19 fsf fc0 sc0 ls0 ws0">the<span class="_ _44"> </span><span class="ff1a">AF_INET<span class="_ _44"> </span></span>communication <span class="_ _53"> </span>domain <span class="_ _53"> </span>is <span class="_ _42"> </span>UDP</div><div class="t m0 x15d h2a y29cf ff19 fsf fc0 sc0 ls0 ws0">(</div><div class="t m0 xdb h2a y130 ff19 fsf fc0 sc0 ls0 ws0">User <span class="_ _42"> </span>Datagram <span class="_ _53"> </span>Protocol</div><div class="t m0 x3b h2a y29cf ff19 fsf fc0 sc0 ls0 ws0">)</div><div class="t m0 xb3 h2a y130 ff19 fsf fc0 sc0 ls640 ws0">.F<span class="_ _52"></span><span class="ls0">igur<span class="ls12f7">e1<span class="_ _55"></span><span class="ls0">6.3</span></span></span></div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">lists the protocols deﬁned for the Internet domain sockets.</div><div class="t m0 x161 h2d y41c9 ff19 fs10 fc0 sc0 ls0 ws0">Protocol <span class="_ _142"> </span>Description</div><div class="t m0 x50 h4f y2662 ff1a fs11 fc0 sc0 ls0 ws0">IPPROTO_IP<span class="_ _15"> </span><span class="ff19">IPv4 Internet Protocol</span></div><div class="t m0 x50 h4f y46e2 ff1a fs11 fc0 sc0 ls0 ws0">IPPROTO_IPV6<span class="_ _6e"> </span><span class="ff19">IPv6 Internet Protocol (optional in POSIX.1)</span></div><div class="t m0 x50 h4f y46e3 ff1a fs11 fc0 sc0 ls0 ws0">IPPROTO_ICMP<span class="_ _6e"> </span><span class="ff19">Internet Control Message Pr<span class="_ _0"></span>otocol</span></div><div class="t m0 x50 h4f y46e4 ff1a fs11 fc0 sc0 ls0 ws0">IPPROTO_RAW<span class="_ _75"> </span><span class="ff19">Raw IP packets protocol (optional in POSIX.1)</span></div><div class="t m0 x50 h4f y46e5 ff1a fs11 fc0 sc0 ls0 ws0">IPPROTO_TCP<span class="_ _75"> </span><span class="ff19 ls999">Tr<span class="_ _3"></span><span class="ls0">ansmission Control Protocol</span></span></div><div class="t m0 x50 h4f y46e6 ff1a fs11 fc0 sc0 ls0 ws0">IPPROTO_UDP<span class="_ _75"> </span><span class="ff19">User Datagram Protocol</span></div><div class="t m0 x4 h2f y449b ff18 fs12 fc0 sc0 ls0 ws0">Figure 16.3<span class="_ _5a"> </span><span class="ff19">Protocols deﬁned for Internet domain sockets</span></div><div class="t m0 x3f h5c y46e7 ff19 fs29 fc0 sc0 ls12f8 ws0">Wi<span class="_ _3"></span><span class="ls0">th <span class="_"> </span>a <span class="_ _47"> </span>datagram <span class="_"> </span>(<span class="ff1a">SOCK_DGRAM</span><span class="ls3b9">)i<span class="_ _5b"></span><span class="ls0">nterface, <span class="_ _66"> </span>no <span class="_ _47"> </span>logical <span class="_"> </span>connection <span class="_ _66"> </span>needs <span class="_ _66"> </span>to <span class="_ _47"> </span>exist</span></span></span></div><div class="t m0 x32 h50 y46e8 ff19 fs29 fc0 sc0 ls0 ws0">between <span class="_ _47"> </span>peers <span class="_ _47"> </span>for <span class="_ _47"> </span>them <span class="_ _47"> </span>to <span class="_ _47"> </span>communicate.<span class="_ _50"> </span>All <span class="_ _47"> </span>you <span class="_ _47"> </span>need <span class="_ _47"> </span>to <span class="_ _47"> </span>do <span class="_ _47"> </span>is <span class="_ _47"> </span>send <span class="_ _47"> </span>a <span class="_ _47"> </span>message</div><div class="t m0 x32 h50 y46e9 ff19 fs29 fc0 sc0 ls0 ws0">addressed to the socket being used by the peer pr<span class="_ _0"></span>ocess.</div><div class="t m0 x3f h50 y46ea ff19 fs29 fc0 sc0 ls12f9 ws0">Ad<span class="_ _95"></span><span class="ls0">atagram, <span class="_ _5a"> </span>therefor<span class="_ _0"></span>e, <span class="_ _5a"> </span>provides <span class="_ _16"> </span>a <span class="_ _51"> </span>connectionless <span class="_ _5a"> </span>service.<span class="_ _3a"> </span><span class="ls12fa">Ab<span class="_ _95"></span><span class="ls0">yte <span class="_ _5a"> </span>stream</span></span></span></div><div class="t m0 x32 h5c y46eb ff19 fs29 fc0 sc0 ls0 ws0">(<span class="ff1a">SOCK_STREAM</span>), <span class="_ _9"></span>in <span class="_ _3"></span>contrast, <span class="_ _9"></span>requires <span class="_ _3"></span>that, <span class="_ _9"></span>befor<span class="ls12fb">ey<span class="_ _b"></span><span class="ls0">ou <span class="_ _3"></span>can <span class="_ _9"></span>exchange <span class="_ _9"></span>data, <span class="_ _9"></span>you <span class="_ _9"></span>set <span class="_ _9"></span>up <span class="_ _9"></span>a</span></span></div><div class="t m0 x32 h50 y46ec ff19 fs29 fc0 sc0 ls0 ws0">logical connection between <span class="_ _2"></span>your socket and <span class="_ _2"></span>the socket <span class="_ _2"></span>belonging to the <span class="_ _2"></span>peer with which</div><div class="t m0 x32 h50 y46ed ff19 fs29 fc0 sc0 ls0 ws0">you wish to communicate.</div><div class="t m0 x3f h50 y46ee ff19 fs29 fc0 sc0 ls12fc ws0">Ad<span class="_ _1d"></span><span class="ls0">atagram <span class="_ _47"> </span>is <span class="_ _47"> </span>a <span class="_ _66"> </span>self-contained <span class="_ _47"> </span>message.<span class="_ _5f"> </span>Sending <span class="_ _66"> </span>a <span class="_ _47"> </span>datagram <span class="_ _47"> </span>is <span class="_ _47"> </span>analogous <span class="_ _66"> </span>to</span></div><div class="t m0 x32 h50 y46ef ff19 fs29 fc0 sc0 ls0 ws0">mailing <span class="_ _2"></span>someone <span class="_ _3"></span>a <span class="_ _3"></span>letter<span class="_ _1"></span><span class="ls12fd">.Y<span class="_ _7"></span><span class="ls0">ou <span class="_ _3"></span>can <span class="_ _3"></span>mail <span class="_ _2"></span>many <span class="_ _3"></span>letters, <span class="_ _3"></span>but <span class="_ _3"></span>you <span class="_ _3"></span>can’t <span class="_ _3"></span>guarantee <span class="_ _3"></span>the <span class="_ _3"></span>order</span></span></div><div class="t m0 x32 h50 y46f0 ff19 fs29 fc0 sc0 ls0 ws0">of <span class="_ _3"></span>delivery<span class="_ _6"></span><span class="ls12fe">,a<span class="_ _b"></span><span class="ls0">nd <span class="_ _9"></span>some <span class="_ _3"></span>might <span class="_ _9"></span>get <span class="_ _3"></span>lost <span class="_ _3"></span>along <span class="_ _9"></span>the <span class="_ _3"></span>way<span class="_ _6"></span><span class="ls7fa">.E<span class="_ _62"></span><span class="ls0">ach <span class="_ _9"></span>letter <span class="_ _3"></span>contains <span class="_ _3"></span>the <span class="_ _9"></span>address <span class="_ _3"></span>of</span></span></span></span></div><div class="t m0 x32 h50 y46f1 ff19 fs29 fc0 sc0 ls0 ws0">the recipient, making <span class="_ _2"></span>the <span class="_ _2"></span>letter <span class="_ _2"></span>independent <span class="_ _2"></span>from all <span class="_ _2"></span>the others.<span class="_ _61"> </span>Each <span class="_ _2"></span>letter <span class="_ _2"></span>can even <span class="_ _2"></span>go</div><div class="t m0 x32 h50 y46f2 ff19 fs29 fc0 sc0 ls0 ws0">to differ<span class="_ _0"></span>ent r<span class="_ _0"></span>ecipients.</div><div class="t m0 x3f h50 y46f3 ff19 fs29 fc0 sc0 ls0 ws0">In <span class="_ _3"></span>contrast, <span class="_ _9"></span>using <span class="_ _9"></span>a <span class="_ _9"></span>connection-oriented <span class="_ _3"></span>protocol <span class="_ _9"></span>for <span class="_ _3"></span>communicating <span class="_ _9"></span>with <span class="_ _9"></span>a <span class="_ _9"></span>peer <span class="_ _3"></span>is</div><div class="t m0 x32 h50 y46f4 ff19 fs29 fc0 sc0 ls0 ws0">like <span class="_ _3"></span>making <span class="_ _9"></span>a <span class="_ _9"></span>phone <span class="_ _9"></span>call.<span class="_ _16"> </span>First, <span class="_ _9"></span>you <span class="_ _9"></span>need <span class="_ _3"></span>to <span class="_ _9"></span>establish <span class="_ _9"></span>a <span class="_ _3"></span>connection <span class="_ _9"></span>by <span class="_ _9"></span>placing <span class="_ _9"></span>a <span class="_ _3"></span>phone</div><div class="t m0 x32 h50 y46f5 ff19 fs29 fc0 sc0 ls0 ws0">call, <span class="_ _2"></span>but <span class="_ _2"></span>after <span class="_ _2"></span>the <span class="_ _2"></span>connection <span class="_ _3"></span>is <span class="_ _2"></span>in <span class="_ _2"></span>place, <span class="_ _2"></span>you <span class="_ _2"></span>can <span class="_ _3"></span>communicate <span class="_ _2"></span>bidirectionally with <span class="_ _3"></span>each</div><div class="t m0 x32 h50 y46f6 ff19 fs29 fc0 sc0 ls0 ws0">other<span class="_ _6"></span><span class="ls12ff">.T<span class="_ _7"></span><span class="ls0">he <span class="_ _42"> </span>connection <span class="_ _42"> </span>is <span class="_ _42"> </span>a <span class="_ _23"> </span>peer-to-peer <span class="_ _42"> </span>communication <span class="_ _23"> </span>channel <span class="_ _42"> </span>over <span class="_ _42"> </span>which <span class="_ _42"> </span>you <span class="_ _42"> </span>talk.</span></span></div><div class="t m0 x32 h50 y46f7 ff19 fs29 fc0 sc0 lse2 ws0">Yo<span class="_ _9"></span><span class="ls0">ur <span class="_ _23"> </span>words <span class="_ _23"> </span>contain <span class="_ _42"> </span>no <span class="_ _23"> </span>addressing <span class="_ _23"> </span>information, <span class="_ _42"> </span>as <span class="_ _23"> </span>a <span class="_ _42"> </span>point-to-point <span class="_ _23"> </span>virtual <span class="_ _42"> </span>connection</span></div><div class="t m0 x32 h50 y46f8 ff19 fs29 fc0 sc0 ls0 ws0">exists between both <span class="_ _2"></span>ends of the <span class="_ _2"></span>call, and <span class="_ _2"></span>the connection itself <span class="_ _2"></span>implies a particular <span class="_ _2"></span>source</div><div class="t m0 x32 h50 y46f9 ff19 fs29 fc0 sc0 ls0 ws0">and destination.</div><div class="t m0 x3f h5c y46fa ff19 fs29 fc0 sc0 ls0 ws0">A<span class="_"> </span><span class="ff1a">SOCK_STREAM<span class="_ _66"> </span></span>socket provides a byte-stream service; applications ar<span class="ls1300">eu<span class="_ _4f"></span><span class="ls0">nawar<span class="ls1300">eo<span class="_ _d"></span><span class="ls0">f</span></span></span></span></div><div class="t m0 x32 h5c y46fb ff19 fs29 fc0 sc0 ls0 ws0">message boundaries.<span class="_ _61"> </span>This <span class="_ _2"></span>means <span class="_ _2"></span>that <span class="_ _2"></span>when <span class="_ _2"></span>we <span class="_ _2"></span>read data <span class="_ _2"></span>from a<span class="_ _47"> </span><span class="ff1a">SOCK_STREAM<span class="_ _66"> </span></span>socket,</div><div class="t m0 x32 h50 y46fc ff19 fs29 fc0 sc0 ls0 ws0">it <span class="_ _2"></span>might <span class="_ _2"></span>not <span class="_ _2"></span>return <span class="_ _2"></span>the <span class="_ _2"></span>same <span class="_ _2"></span>number <span class="_ _3"></span>of <span class="_ _2"></span>bytes <span class="_ _2"></span>written <span class="_ _2"></span>by <span class="_ _3"></span>the <span class="_ _2"></span>sender<span class="_ _1"></span><span class="ls1301">.W<span class="_ _7"></span><span class="ls1302">ew<span class="_ _4f"></span><span class="ls0">ill <span class="_ _3"></span>eventually</span></span></span></div><div class="t m0 x32 h50 y46fd ff19 fs29 fc0 sc0 ls0 ws0">get everything sent to us, but it might take several function calls.</div><div class="t m0 x3f h5c y46fe ff19 fs29 fc0 sc0 ls0 ws0">A<span class="_ _66"> </span><span class="ff1a">SOCK_SEQPACKET<span class="_ _47"> </span></span>socket <span class="_ _2"></span>is <span class="_ _2"></span>just <span class="_ _3"></span>like <span class="_ _2"></span>a<span class="_ _47"> </span><span class="ff1a">SOCK_STREAM<span class="_ _66"> </span></span>socket <span class="_ _3"></span>except <span class="_ _2"></span>that <span class="_ _2"></span>we <span class="_ _3"></span>get <span class="_ _2"></span>a</div><div class="t m0 x32 h50 y46ff ff19 fs29 fc0 sc0 ls0 ws0">message-based <span class="_ _3"></span>service <span class="_ _3"></span>instead <span class="_ _3"></span>of <span class="_ _3"></span>a <span class="_ _3"></span>byte-stream <span class="_ _2"></span>service.<span class="_ _16"> </span>This <span class="_ _3"></span>means <span class="_ _3"></span>that <span class="_ _9"></span>the <span class="_ _2"></span>amount <span class="_ _9"></span>of</div><div class="t m0 x32 h5c y4700 ff19 fs29 fc0 sc0 ls0 ws0">data <span class="_ _2"></span>received from a<span class="_ _47"> </span><span class="ff1a">SOCK_SEQPACKET<span class="_ _66"> </span></span>socket <span class="_ _2"></span>is <span class="_ _2"></span>the <span class="_ _2"></span>same <span class="_ _2"></span>amount <span class="_ _2"></span>as <span class="_ _2"></span>was <span class="_ _2"></span>written.<span class="_ _61"> </span>The</div><div class="t m0 x32 h50 y4701 ff19 fs29 fc0 sc0 ls0 ws0">Stream <span class="_ _23"> </span>Control <span class="_ _42"> </span>T<span class="_ _6"></span>ransmission <span class="_ _42"> </span>Protocol</div><div class="t m0 x6c h50 y4702 ff19 fs29 fc0 sc0 ls0 ws0">(</div><div class="t m0 x18c h50 y4701 ff19 fs29 fc0 sc0 ls0 ws0">SCTP</div><div class="t m0 x77 h50 y4702 ff19 fs29 fc0 sc0 ls0 ws0">)</div><div class="t m0 x176 h50 y4701 ff19 fs29 fc0 sc0 ls0 ws0">provides <span class="_ _23"> </span>a <span class="_ _53"> </span>sequential <span class="_ _42"> </span>packet <span class="_ _42"> </span>service <span class="_ _42"> </span>in</div><div class="t m0 x32 h50 y4703 ff19 fs29 fc0 sc0 ls0 ws0">the Internet domain.</div><div class="t m0 x3f h5c y4704 ff19 fs29 fc0 sc0 ls0 ws0">A<span class="_ _16"> </span><span class="ff1a">SOCK_RAW<span class="_"> </span></span>socket <span class="_ _45"> </span>pr<span class="_ _0"></span>ovides <span class="_ _47"> </span>a <span class="_ _45"> </span>datagram <span class="_ _45"> </span>interface <span class="_ _45"> </span>dir<span class="_ _0"></span>ectly <span class="_ _47"> </span>to <span class="_ _45"> </span>the <span class="_ _45"> </span>underlying</div><div class="t m0 x32 h50 y4705 ff19 fs29 fc0 sc0 ls0 ws0">network <span class="_ _23"></span>layer <span class="_ _23"></span>(which <span class="_ _23"> </span>means <span class="_ _23"> </span>IP <span class="_ _23"> </span>in <span class="_ _23"> </span>the <span class="_ _23"> </span>Internet <span class="_ _23"> </span>domain).<span class="_ _51"> </span>Applications <span class="_ _23"> </span>ar<span class="ls1303">er<span class="_ _43"></span><span class="ls0">esponsible</span></span></div><div class="t m0 x32 h50 y4706 ff19 fs29 fc0 sc0 ls0 ws0">for building <span class="_ _2"></span>their own <span class="_ _2"></span>protocol headers when <span class="_ _2"></span>using this <span class="_ _2"></span>interface, because <span class="_ _2"></span>the transport</div><div class="t m0 x32 h50 y4707 ff19 fs29 fc0 sc0 ls0 ws0">protocols <span class="_ _2"></span>(TCP <span class="_ _3"></span>and <span class="_ _3"></span>UDP<span class="_ _4"></span><span class="ls1304">,f<span class="_ _8"></span><span class="ls0">or <span class="_ _3"></span>example) <span class="_ _3"></span>ar<span class="ls1304">eb<span class="_ _8"></span><span class="ls0">ypassed. <span class="_ _47"> </span>Superuser <span class="_ _2"></span>privileges <span class="_ _3"></span>ar<span class="ls1305">er<span class="_ _b"></span><span class="ls0">equired</span></span></span></span></span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
