<div id="pffc" class="pf w4 h1f" data-page-no="fc"><div class="pc pcfc w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bgfc.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">218<span class="_ _1b"> </span><span class="ff19">Process <span class="_"> </span>Envir<span class="_ _0"></span>onment <span class="_ _1c1"> </span>Chapter<span class="_ _44"> </span>7</span></div><div class="t m0 x32 h57 y362 ff1a fs2d fc0 sc0 ls0 ws0">#include &quot;apue.h&quot;</div><div class="t m0 x32 h57 y3c0 ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;setjmp.h&gt;</div><div class="t m0 x32 h57 y3c1 ff1a fs2d fc0 sc0 ls0 ws0">static void f1(int, int, int, int);</div><div class="t m0 x32 h57 y3c2 ff1a fs2d fc0 sc0 ls0 ws0">static void f2(void);</div><div class="t m0 x32 h57 y1d34 ff1a fs2d fc0 sc0 ls0 ws0">static jmp_buf<span class="_ _d9"> </span>jmpbuffer;</div><div class="t m0 x32 h57 y158d ff1a fs2d fc0 sc0 ls0 ws0">static int<span class="_ _189"> </span>globval;</div><div class="t m0 x32 h57 y1d35 ff1a fs2d fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 h57 y1d36 ff1a fs2d fc0 sc0 ls0 ws0">main(void)</div><div class="t m0 x32 h57 y1590 ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y1591 ff1a fs2d fc0 sc0 ls0 ws0">int <span class="_ _82"> </span>autoval;</div><div class="t m0 x8a h57 y1d37 ff1a fs2d fc0 sc0 ls0 ws0">register int<span class="_ _15"> </span>regival;</div><div class="t m0 x8a h57 y1d38 ff1a fs2d fc0 sc0 ls0 ws0">volatile int<span class="_ _15"> </span>volaval;</div><div class="t m0 x8a h57 y3cb ff1a fs2d fc0 sc0 ls0 ws0">static int<span class="_ _189"> </span>statval;</div><div class="t m0 x8a h57 y1d39 ff1a fs2d fc0 sc0 ls0 ws0">globval = 1; autoval = 2; regival = 3; volaval = 4; statval = 5;</div><div class="t m0 x8a h57 y1d3a ff1a fs2d fc0 sc0 ls0 ws0">if (setjmp(jmpbuffer) != 0) {</div><div class="t m0 x9d h57 y1d3b ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;after longjmp:\n&quot;);</div><div class="t m0 x9d h57 y1d3c ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;globval = %d, autoval = %d, regival = %d,&quot;</div><div class="t m0 x1f h57 y1d3d ff1a fs2d fc0 sc0 ls15c ws0">&quot;v<span class="_ _1d"></span><span class="ls0">olaval = %d, statval = %d\n&quot;,</span></div><div class="t m0 x1f h57 y1d3e ff1a fs2d fc0 sc0 ls0 ws0">globval, autoval, regival, volaval, statval);</div><div class="t m0 x9d h57 y855 ff1a fs2d fc0 sc0 ls0 ws0">exit(0);</div><div class="t m0 x8a h57 y1d3f ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x8a h57 y1d40 ff1a fs2d fc0 sc0 ls0 ws0">/*</div><div class="t m0 xe1 h57 y1d41 ff1a fs2d fc0 sc0 ls15c ws0">*C<span class="_ _1d"></span><span class="ls0">hange variables after setjmp, but before longjmp.</span></div><div class="t m0 xe1 h57 y1d42 ff1a fs2d fc0 sc0 ls0 ws0">*/</div><div class="t m0 x8a h57 y1d43 ff1a fs2d fc0 sc0 ls0 ws0">globval = 95; autoval = 96; regival = 97; volaval = 98;</div><div class="t m0 x8a h57 y1d44 ff1a fs2d fc0 sc0 ls0 ws0">statval = 99;</div><div class="t m0 x8a h57 y1d45 ff1a fs2d fc0 sc0 ls0 ws0">f1(autoval, regival, volaval, statval); /* never returns */</div><div class="t m0 x8a h57 y1d46 ff1a fs2d fc0 sc0 ls0 ws0">exit(0);</div><div class="t m0 x32 h57 y1d47 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y1d48 ff1a fs2d fc0 sc0 ls0 ws0">static void</div><div class="t m0 x32 h57 y1d49 ff1a fs2d fc0 sc0 ls0 ws0">f1(int i, int j, int k, int l)</div><div class="t m0 x32 h57 y1d4a ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y1d4b ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;in f1():\n&quot;);</div><div class="t m0 x8a h57 y1d4c ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;globval = %d, autoval = %d, regival = %d,&quot;</div><div class="t m0 x9d h57 y1d4d ff1a fs2d fc0 sc0 ls15c ws0">&quot;v<span class="_ _1d"></span><span class="ls0">olaval = %d, statval = %d\n&quot;, globval, i, j, k, l);</span></div><div class="t m0 x8a h57 y1d4e ff1a fs2d fc0 sc0 ls0 ws0">f2();</div><div class="t m0 x32 h57 y1d4f ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y1d50 ff1a fs2d fc0 sc0 ls0 ws0">static void</div><div class="t m0 x32 h57 y1d51 ff1a fs2d fc0 sc0 ls0 ws0">f2(void)</div><div class="t m0 x32 h57 y1d52 ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y1d53 ff1a fs2d fc0 sc0 ls0 ws0">longjmp(jmpbuffer, 1);</div><div class="t m0 x32 h57 y1d54 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 xf0 h5e y1d55 ff18 fs10 fc0 sc0 ls0 ws0">Figure 7.13<span class="_ _5a"> </span><span class="ff19">Effect of<span class="_"> </span><span class="ff1a">longjmp<span class="_ _53"> </span></span>on various types of variables</span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
