<div id="pf24e" class="pf w4 h1f" data-page-no="24e"><div class="pc pc24e w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg24e.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">556<span class="_ _1b"> </span><span class="ff19">Interprocess <span class="_"> </span>Communication<span class="_ _2c"> </span>Chapter <span class="_"> </span>15</span></div><div class="t m0 x8c h163 y4354 ff19 fs2a fc0 sc0 ls0 ws0">client<span class="_ _ae"> </span><span class="ff18 fsf ls44">...</span></div><div class="t m0 x1ef h2d y4355 ff19 fs10 fc0 sc0 ls0 ws0">client</div><div class="t m0 x86 h2e y4356 ff19 fs11 fc0 sc0 ls0 ws0">well-known</div><div class="t m0 x1a4 h2e y4357 ff19 fs11 fc0 sc0 ls0 ws0">FIFO</div><div class="t m0 x88 h2f y4337 ff19 fs12 fc0 sc0 ls0 ws0">server</div><div class="t m0 x86 h6d y4358 ff1a fs12 fc0 sc0 ls0 ws0">read<span class="_ _35"> </span><span class="ff19 ls222">re<span class="_ _2"></span><span class="ls0">quests</span></span></div><div class="t m0 x10c h30 y4359 ff19 fs13 fc0 sc0 ls0 ws0">client-speciﬁc</div><div class="t m0 x25 h30 y435a ff19 fs13 fc0 sc0 ls0 ws0">FIFO</div><div class="t m0 x170 h31 y435b ff19 fs14 fc0 sc0 ls0 ws0">client-speciﬁc</div><div class="t m0 x228 h31 y435c ff19 fs14 fc0 sc0 ls0 ws0">FIFO</div><div class="t m2f x199 h164 y435d ff1a fsbb fc0 sc0 ls0 ws0">write<span class="_ _53"> </span><span class="ff19 ls11d1">re<span class="_ _2"></span><span class="ls0">plies</span></span></div><div class="t m30 x1d9 h165 y435e ff1a fsbc fc0 sc0 ls0 ws0">write<span class="_ _53"> </span><span class="ff19 ls11d2">re<span class="_ _2"></span><span class="ls0">plies</span></span></div><div class="t m0 x159 h71 y435f ff1a fs36 fc0 sc0 ls0 ws0">read<span class="_ _53"> </span><span class="ff19 ls871">re<span class="_ _2"></span><span class="ls0">plies</span></span></div><div class="t m0 x13d hcc y4360 ff1a fs17 fc0 sc0 ls0 ws0">read<span class="_ _53"> </span><span class="ff19 lsad2">re<span class="_ _2"></span><span class="ls0">plies</span></span></div><div class="t m31 x11b h166 y4361 ff1a fsbd fc0 sc0 ls0 ws0">write<span class="_ _53"> </span><span class="ff19 lsad4">re<span class="_ _2"></span><span class="ls0">quests</span></span></div><div class="t m32 xa9 h167 y4362 ff1a fsbe fc0 sc0 ls0 ws0">write<span class="_ _53"> </span><span class="ff19 ls11cb">re<span class="_ _2"></span><span class="ls0">quests</span></span></div><div class="t m0 x1ce h36 y4363 ff18 fs19 fc0 sc0 ls0 ws0">Figure 15.23<span class="_ _5a"> </span><span class="ff19">Client–server communication using FIFOs</span></div><div class="t m0 x32 h10b y4364 ff19 fs91 fc0 sc0 ls0 ws0">server <span class="_ _23"> </span>also <span class="_ _42"> </span>must <span class="_ _23"> </span>catch<span class="_ _35"> </span><span class="ff1a">SIGPIPE</span><span class="ls11d3">,s<span class="_ _43"></span><span class="ls0">ince <span class="_ _42"> </span>it’s <span class="_ _23"> </span>possible <span class="_ _42"> </span>for <span class="_ _23"> </span>a <span class="_ _42"> </span>client <span class="_ _23"> </span>to <span class="_ _42"> </span>send <span class="_ _23"></span>a <span class="_ _23"> </span>request <span class="_ _23"> </span>and</span></span></div><div class="t m0 x32 h10c y4365 ff19 fs91 fc0 sc0 ls0 ws0">terminate <span class="_ _9"></span>befor<span class="ls11d4">er<span class="_ _43"></span><span class="ls0">eading <span class="_ _23"></span>the <span class="_ _9"></span>response, <span class="_ _3"></span>leaving <span class="_ _23"></span>the <span class="_ _9"></span>client-speciﬁc <span class="_ _9"></span>FIFO <span class="_ _9"></span>with <span class="_ _9"></span>one <span class="_ _23"></span>writer</span></span></div><div class="t m0 x32 h10c y4366 ff19 fs91 fc0 sc0 ls0 ws0">(the server) and no reader<span class="_ _6"></span>.</div><div class="t m0 x3f h10c y4367 ff19 fs91 fc0 sc0 ls11d5 ws0">Wi<span class="_ _3"></span><span class="ls0">th <span class="_ _42"> </span>the <span class="_ _53"> </span>arrangement <span class="_ _42"> </span>shown <span class="_ _53"> </span>in <span class="_ _53"> </span>Figur<span class="ls11d6">e1<span class="_ _c"></span><span class="ls0">5.23, <span class="_ _42"> </span>if <span class="_ _53"> </span>the <span class="_ _42"> </span>server <span class="_ _53"> </span>opens <span class="_ _53"> </span>its <span class="_ _42"> </span>well-known</span></span></span></div><div class="t m0 x32 h10b y4368 ff19 fs91 fc0 sc0 ls0 ws0">FIFO read-only (since it <span class="_ _2"></span>only<span class="_"> </span><span class="ff1a">read</span><span class="ls11d7">sf<span class="_ _d"></span><span class="lsaeb">ro<span class="_ _2"></span><span class="ls11d7">mi<span class="_ _d"></span><span class="ls0">t) each <span class="_ _2"></span>time the <span class="_ _2"></span>number of <span class="_ _2"></span>clients goes <span class="_ _2"></span>from 1</span></span></span></span></div><div class="t m0 x32 h10b y4369 ff19 fs91 fc0 sc0 ls0 ws0">to <span class="_ _2"></span>0, <span class="_ _2"></span>the <span class="_ _2"></span>server <span class="_ _2"></span>will<span class="_ _47"> </span><span class="ff1a">read<span class="_ _66"> </span></span>an <span class="_ _3"></span>end <span class="_ _2"></span>of <span class="_ _2"></span>ﬁle <span class="_ _2"></span>on <span class="_ _2"></span>the <span class="_ _3"></span>FIFO.<span class="_ _61"> </span><span class="ls11d8">To <span class="_ _e"> </span>p<span class="_ _9"></span><span class="lsaeb">re<span class="_ _2"></span></span></span>vent <span class="_ _2"></span>the <span class="_ _2"></span>server <span class="_ _3"></span>from having</div><div class="t m0 x32 h10b y436a ff19 fs91 fc0 sc0 ls0 ws0">to <span class="_ _2"></span>handle <span class="_ _2"></span>this <span class="_ _2"></span>case, <span class="_ _3"></span>a <span class="_ _2"></span>common <span class="_ _2"></span>trick <span class="_ _3"></span>is <span class="_ _2"></span>just <span class="_ _2"></span>to <span class="_ _2"></span>have <span class="_ _3"></span>the <span class="_ _2"></span>server<span class="_ _47"> </span><span class="ff1a">open<span class="_ _66"> </span></span>its <span class="_ _2"></span>well-known <span class="_ _3"></span>FIFO</div><div class="t m0 x32 h10c y436b ff19 fs91 fc0 sc0 ls0 ws0">for read–write. <span class="_"> </span>(See<span class="_"> </span>Exer<span class="_ _0"></span>cise 15.10.)</div><div class="t m0 x35 h168 y436c ff16 fsbf fc0 sc0 ls0 ws0">15.6 <span class="_ _93"> </span>XSI<span class="_ _54"> </span>IPC</div><div class="t m0 x32 h8e y436d ff19 fs47 fc0 sc0 ls0 ws0">The <span class="_ _2"></span>three <span class="_ _3"></span>types <span class="_ _3"></span>of <span class="_ _2"></span>IPC <span class="_ _3"></span>that <span class="_ _3"></span>we <span class="_ _3"></span>call <span class="_ _3"></span>XSI <span class="_ _3"></span>IPC<span class="_ _9"></span><span class="ls3fb">—m<span class="_ _6"></span><span class="ls0">essage <span class="_ _3"></span>queues, <span class="_ _3"></span>semaphores, <span class="_ _2"></span>and <span class="_ _3"></span>shared</span></span></div><div class="t m0 x32 h8e y436e ff19 fs47 fc0 sc0 ls0 ws0">memory <span class="_ _a"></span>— <span class="_ _a"></span>have<span class="_"> </span>many <span class="_ _2"></span>similarities.<span class="_ _59"> </span>In <span class="_ _2"></span>this section, we cover these similar features; in the</div><div class="t m0 x32 h8e y436f ff19 fs47 fc0 sc0 ls0 ws0">following sections, we look at the speciﬁc functions for each of the three IPC types.</div><div class="t m0 x76 h37 y4370 ff19 fs1a fc0 sc0 ls0 ws0">The <span class="_ _3"></span>XSI <span class="_ _3"></span>IPC <span class="_ _9"></span>functions <span class="_ _3"></span>ar<span class="ls11d9">eb<span class="_ _4f"></span><span class="ls0">ased <span class="_ _9"></span>closely <span class="_ _3"></span>on <span class="_ _3"></span>the <span class="_ _9"></span>System <span class="_ _3"></span>V <span class="_ _3"></span>IPC <span class="_ _9"></span>functions.<span class="_ _4b"> </span>These <span class="_ _9"></span>three <span class="_ _2"></span>types <span class="_ _9"></span>of</span></span></div><div class="t m0 x76 h37 y4371 ff19 fs1a fc0 sc0 ls0 ws0">IPC originated in the <span class="_ _2"></span>1970s in an internal <span class="_ _2"></span>A<span class="_ _1"></span>T&amp;T version of <span class="_ _2"></span>the UNIX System called <span class="_ _2"></span>‘<span class="_ _0"></span>‘Columbus</div><div class="t m0 x76 h37 y4372 ff19 fs1a fc0 sc0 ls0 ws0">UNIX.’<span class="_ _0"></span><span class="ls11da">’T<span class="_ _7"></span><span class="ls0">hese <span class="_ _80"> </span>IPC <span class="_"> </span>features <span class="_"> </span>wer<span class="ls11db">el<span class="_ _43"></span><span class="ls0">ater <span class="_"> </span>added <span class="_"> </span>to <span class="_ _80"> </span>System <span class="_"> </span>V<span class="_ _6"></span><span class="ls11da">.T<span class="_ _26"></span><span class="ls0">hey <span class="_"> </span>ar<span class="ls11db">eo<span class="_ _c"></span><span class="ls0">ften <span class="_ _80"> </span>criticized <span class="_"> </span>for</span></span></span></span></span></span></span></span></div><div class="t m0 x76 h37 y4373 ff19 fs1a fc0 sc0 ls0 ws0">inventing their own namespace instead of using the ﬁle system.</div><div class="t m0 x32 h168 y4374 ff16 fsbf fc0 sc0 ls0 ws0">15.6.1 <span class="_ _54"> </span>Identiﬁer<span class="ls11dc">sa<span class="_ _52"></span><span class="ls0">nd <span class="_"> </span>K<span class="_ _0"></span><span class="ls11dd">ey<span class="ls0">s</span></span></span></span></div><div class="t m0 x32 h169 y4375 ff19 fs47 fc0 sc0 ls0 ws0">Each<span class="_ _59"> </span><span class="ff1b">IPC <span class="_"> </span>structure<span class="_ _4b"> </span></span>(message <span class="_"> </span>queue, <span class="_"> </span>semaphore, <span class="_ _e"> </span>or <span class="_"> </span>shared <span class="_"> </span>memory <span class="_ _e"> </span>segment) <span class="_"> </span>in <span class="_"> </span>the</div><div class="t m0 x32 h169 y4376 ff19 fs47 fc0 sc0 ls0 ws0">kernel <span class="_ _2"></span>is <span class="_ _2"></span>referred to <span class="_ _2"></span>by <span class="_ _3"></span>a <span class="_ _2"></span>non-negative <span class="_ _2"></span>integer<span class="_ _47"> </span><span class="ff1b">identiﬁer</span><span class="ls11de">.T<span class="_ _7"></span><span class="ls11df">os<span class="_ _4f"></span><span class="ls0">end <span class="_ _2"></span>a <span class="_ _3"></span>message <span class="_ _2"></span>to <span class="_ _2"></span>or <span class="_ _3"></span>fetch <span class="_ _2"></span>a</span></span></span></div><div class="t m0 x32 h8e y4377 ff19 fs47 fc0 sc0 ls0 ws0">message <span class="_ _3"></span>from <span class="_ _3"></span>a <span class="_ _3"></span>message <span class="_ _9"></span>queue, <span class="_ _3"></span>for <span class="_ _9"></span>example, <span class="_ _3"></span>all <span class="_ _9"></span>we <span class="_ _3"></span>need <span class="_ _3"></span>know <span class="_ _9"></span>is <span class="_ _3"></span>the <span class="_ _9"></span>identiﬁer <span class="_ _3"></span>for <span class="_ _3"></span>the</div><div class="t m0 x32 h8e y4378 ff19 fs47 fc0 sc0 ls0 ws0">queue. <span class="_ _35"> </span>Unlike<span class="_ _35"> </span>ﬁle <span class="_ _23"> </span>descriptors, <span class="_ _23"> </span>IPC <span class="_ _23"> </span>identiﬁers <span class="_ _42"> </span>ar<span class="ls11e0">en<span class="_ _43"></span><span class="ls0">ot <span class="_ _23"></span>small <span class="_ _23"> </span>integers.<span class="_ _51"> </span>Indeed, <span class="_ _23"> </span>when <span class="_ _42"> </span>a</span></span></div><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.895982px;bottom:522.301476px;width:82.021103px;height:19.680024px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:156.498290px;bottom:249.295197px;width:163.539001px;height:19.680008px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
