<div id="pf2d9" class="pf w4 h1f" data-page-no="2d9"><div class="pc pc2d9 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg2d9.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>18.9<span class="_ _30a"> </span><span class="ls719">Te<span class="_ _9"></span></span>rminal <span class="_"> </span>Identiﬁcation<span class="_ _1b"> </span><span class="ff18">695</span></div><div class="t m0 x3f h2a y12f ff19 fsf fc0 sc0 ls0 ws0">Note <span class="_ _3"></span>that <span class="_ _3"></span>we <span class="_ _3"></span>can’t <span class="_ _3"></span>protect <span class="_ _2"></span>against <span class="_ _3"></span>overrunning <span class="_ _3"></span>the <span class="_ _3"></span>caller<span class="_ _9"></span>’s <span class="_ _3"></span>buffer<span class="_ _6"></span><span class="ls14eb">,b<span class="_ _8"></span><span class="ls0">ecause <span class="_ _3"></span>we <span class="_ _3"></span>have</span></span></div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">no way to determine its size.</div><div class="t m0 x3f h4d y50f4 ff19 fs26 fc0 sc0 lsf94 ws0">Tw<span class="_ _9"></span><span class="ls14ec">of<span class="_ _55"></span><span class="ls0">unctions <span class="_ _e"> </span>that <span class="_"> </span>ar<span class="_ _0"></span><span class="ls14ec">em<span class="_ _4a"></span><span class="ls0">or<span class="ls14ed">ei<span class="_ _55"></span><span class="ls0">nteresting <span class="_ _53"> </span>for <span class="_"> </span>a <span class="_ _e"> </span>UNIX <span class="_"> </span>system <span class="_ _53"> </span>are<span class="_ _59"> </span><span class="ff1a">isatty</span><span class="ls14ed">,w<span class="_ _4a"></span><span class="ls0">hich</span></span></span></span></span></span></span></span></div><div class="t m0 x32 h4d y50f5 ff19 fs26 fc0 sc0 lscc ws0">re<span class="ls0">turns <span class="_ _3"></span>true <span class="_ _3"></span>if <span class="_ _3"></span>a <span class="_ _3"></span>ﬁle <span class="_ _3"></span>descriptor <span class="_ _3"></span>refers <span class="_ _2"></span>to <span class="_ _3"></span>a <span class="_ _3"></span>terminal <span class="_ _3"></span>device, <span class="_ _2"></span>and<span class="_ _45"> </span><span class="ff1a">ttyname</span><span class="lsbe4">,w<span class="_ _8"></span><span class="ls0">hich <span class="_ _3"></span>returns</span></span></span></div><div class="t m0 x32 h49 y50f6 ff19 fs26 fc0 sc0 ls0 ws0">the pathname of the terminal device that is open on a ﬁle descriptor<span class="_ _6"></span>.</div><div class="t m0 x3f h4e y50f7 ff1a fs28 fc0 sc0 ls0 ws0">#include &lt;unistd.h&gt;</div><div class="t m0 x3f h4e y50f8 ff1a fs28 fc0 sc0 ls0 ws0">int isatty(int<span class="_"> </span><span class="ff1b">fd</span>);</div><div class="t m0 x121 h7c y50f9 ff19 fs28 fc0 sc0 ls0 ws0">Returns: 1 (true) if terminal device, 0 (false) otherwise</div><div class="t m0 x3f h4e y50fa ff1a fs28 fc0 sc0 ls0 ws0">char *ttyname(int<span class="_"> </span><span class="ff1b">fd</span>);</div><div class="t m0 x1e2 h4e y50fb ff19 fs28 fc0 sc0 ls0 ws0">Returns: pointer to pathname of terminal,<span class="_"> </span><span class="ff1a">NULL<span class="_ _e"> </span></span>on error</div><div class="t m0 x35 h54 y50fc ff16 fs2c fc0 sc0 ls0 ws0">Example <span class="_ _84"></span>—<span class="_ _9"></span><span class="ff1f">isatty<span class="_ _66"> </span></span>Function</div><div class="t m0 x32 h54 y50fd ff19 fs2c fc0 sc0 ls0 ws0">The<span class="_"> </span><span class="ff1a">isatty<span class="_ _66"> </span></span>function is trivial <span class="_ _2"></span>to implement, as <span class="_ _2"></span>we show in <span class="_ _2"></span>Figur<span class="ls14ee">e1<span class="_ _4f"></span><span class="ls0">8.13. <span class="_ _66"> </span>W<span class="_ _6"></span><span class="ls14ee">es<span class="_ _d"></span><span class="ls0">imply try</span></span></span></span></div><div class="t m0 x32 h55 y50fe ff19 fs2c fc0 sc0 ls0 ws0">one <span class="_ _9"></span>of <span class="_ _9"></span>the <span class="_ _9"></span>terminal-speciﬁc <span class="_ _9"></span>functions <span class="_ _9"></span>(that <span class="_ _9"></span>doesn’t <span class="_ _9"></span>change <span class="_ _9"></span>anything <span class="_ _9"></span>if <span class="_ _9"></span>it <span class="_ _9"></span>succeeds) <span class="_ _9"></span>and</div><div class="t m0 x32 h55 y50ff ff19 fs2c fc0 sc0 ls0 ws0">look at the return value.</div><div class="t m0 x32 h62 y5100 ff1a fs30 fc0 sc0 ls0 ws0">#include <span class="_ _68"> </span>&lt;termios.h&gt;</div><div class="t m0 x32 h62 y5101 ff1a fs30 fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 h62 y5102 ff1a fs30 fc0 sc0 ls0 ws0">isatty(int fd)</div><div class="t m0 x32 h62 y5103 ff1a fs30 fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h62 y5104 ff1a fs30 fc0 sc0 ls0 ws0">struct termios<span class="_ _d9"> </span>ts;</div><div class="t m0 x8a h62 y5105 ff1a fs30 fc0 sc0 ls0 ws0">return(tcgetattr(fd, &amp;ts) != -1); /* true if no error (is a tty) */</div><div class="t m0 x32 h62 y5106 ff1a fs30 fc0 sc0 ls0 ws0">}</div><div class="t m0 x38 h63 y5107 ff18 fs13 fc0 sc0 ls0 ws0">Figure 18.13<span class="_ _5a"> </span><span class="ff19">Implementation of POSIX.1<span class="_"> </span><span class="ff1a">isatty<span class="_ _e"> </span></span>function</span></div><div class="t m0 x3f h64 y5108 ff19 fs31 fc0 sc0 ls43f ws0">We <span class="_ _53"> </span>t<span class="_ _9"></span><span class="ls0">est our<span class="_"> </span><span class="ff1a">isatty<span class="_ _66"> </span></span>function with the program in Figur<span class="_ _1"></span><span class="ls229">e1<span class="_ _5"></span><span class="ls0">8.14.</span></span></span></div><div class="t m0 x32 hc1 y5109 ff1a fs69 fc0 sc0 ls0 ws0">#include &quot;apue.h&quot;</div><div class="t m0 x32 hc1 y510a ff1a fs69 fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 hc1 y510b ff1a fs69 fc0 sc0 ls0 ws0">main(void)</div><div class="t m0 x32 hc1 y510c ff1a fs69 fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a hc1 y510d ff1a fs69 fc0 sc0 ls0 ws0">printf(&quot;fd 0: %s\n&quot;, isatty(0) ? &quot;tty&quot; : &quot;not a tty&quot;);</div><div class="t m0 x8a hc1 y510e ff1a fs69 fc0 sc0 ls0 ws0">printf(&quot;fd 1: %s\n&quot;, isatty(1) ? &quot;tty&quot; : &quot;not a tty&quot;);</div><div class="t m0 x8a hc1 y510f ff1a fs69 fc0 sc0 ls0 ws0">printf(&quot;fd 2: %s\n&quot;, isatty(2) ? &quot;tty&quot; : &quot;not a tty&quot;);</div><div class="t m0 x8a hc1 y5110 ff1a fs69 fc0 sc0 ls0 ws0">exit(0);</div><div class="t m0 x32 hc1 y5111 ff1a fs69 fc0 sc0 ls0 ws0">}</div><div class="t m0 xc0 h66 y5112 ff18 fs15 fc0 sc0 ls0 ws0">Figure 18.14<span class="_ _5a"> </span><span class="ff19 ls14ef">Te<span class="_ _9"></span><span class="ls0">st the<span class="_"> </span><span class="ff1a">isatty<span class="_ _53"> </span></span>function</span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
