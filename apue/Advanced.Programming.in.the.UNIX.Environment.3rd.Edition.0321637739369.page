<div id="pf171" class="pf w4 h1f" data-page-no="171"><div class="pc pc171 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg171.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>10.8<span class="_ _3b"> </span>Reliable-Signal <span class="_"> </span>T<span class="_ _6"></span>erminology <span class="_"> </span>and <span class="_"> </span>Semantics<span class="_ _1b"> </span><span class="ff18">335</span></div><div class="t m0 x3f h26 y12f ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _23"></span>problem <span class="_ _9"></span>with <span class="_ _23"> </span>this <span class="_ _23"></span>program <span class="_ _9"></span>is <span class="_ _23"> </span>that <span class="_ _23"> </span>the <span class="_ _23"> </span>call <span class="_ _23"></span>to<span class="_ _35"> </span><span class="ff1a">signal<span class="_ _45"> </span></span>at <span class="_ _23"> </span>the <span class="_ _23"> </span>beginning <span class="_ _23"> </span>of <span class="_ _23"></span>the</div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">signal <span class="_ _45"> </span>handler <span class="_ _35"> </span>invokes <span class="_ _35"> </span>item <span class="_ _45"> </span>2 <span class="_ _35"> </span>from <span class="_ _45"> </span>the <span class="_ _35"> </span>pr<span class="_ _0"></span>eceding <span class="_ _35"> </span>discussion<span class="_ _3"></span><span class="ls9d">—t<span class="_ _1"></span><span class="ls0">he <span class="_ _45"> </span>kernel <span class="_ _35"> </span>checks</span></span></div><div class="t m0 x32 h26 y131 ff19 fsf fc0 sc0 ls0 ws0">whether <span class="_ _42"> </span>a <span class="_ _42"> </span>child <span class="_ _53"> </span>needs <span class="_ _42"> </span>to <span class="_ _42"> </span>be<span class="_ _44"> </span><span class="ff1a">wait</span>ed <span class="_ _53"> </span>for <span class="_ _42"> </span>(which <span class="_ _42"> </span>is <span class="_ _53"> </span>the <span class="_ _42"> </span>case, <span class="_ _53"> </span>since <span class="_ _42"> </span>we’r<span class="lsc44">ep<span class="_ _c"></span><span class="ls45">ro<span class="_ _2"></span><span class="ls0">cessing <span class="_ _42"> </span>a</span></span></span></div><div class="t m0 x32 h26 y132 ff1a fsf fc0 sc0 ls0 ws0">SIGCLD<span class="_ _35"> </span><span class="ff19">signal), <span class="_ _23"></span>so <span class="_ _23"> </span>it <span class="_ _23"> </span>generates <span class="_ _42"> </span>another <span class="_ _23"></span>call <span class="_ _23"></span>to <span class="_ _23"> </span>the <span class="_ _23"> </span>signal <span class="_ _42"> </span>handler<span class="_ _6"></span><span class="lsc45">.T<span class="_ _26"></span><span class="ls0">he <span class="_ _23"></span>signal <span class="_ _23"> </span>handler</span></span></span></div><div class="t m0 x32 h26 y133 ff19 fsf fc0 sc0 ls0 ws0">calls<span class="_"> </span><span class="ff1a">signal</span><span class="ls44">,a<span class="_ _d"></span><span class="ls0">nd the whole process starts over again.</span></span></div><div class="t m0 x3f h26 y134 ff19 fsf fc0 sc0 ls5f ws0">To <span class="_ _80"> </span>ﬁ<span class="_ _9"></span><span class="lsc46">xt<span class="_ _8"></span><span class="ls0">his <span class="_ _3"></span>program, <span class="_ _3"></span>we <span class="_ _3"></span>have <span class="_ _3"></span>to <span class="_ _3"></span>move <span class="_ _9"></span>the <span class="_ _3"></span>call <span class="_ _3"></span>to<span class="_ _47"> </span><span class="ff1a">signal<span class="_ _45"> </span></span>after <span class="_ _2"></span>the <span class="_ _3"></span>call <span class="_ _3"></span>to<span class="_ _45"> </span><span class="ff1a">wait</span><span class="ls17f">.B<span class="_ _62"></span><span class="ls0">y</span></span></span></span></div><div class="t m0 x32 h26 y135 ff19 fsf fc0 sc0 ls0 ws0">doing <span class="_ _42"> </span>this, <span class="_ _42"> </span>we <span class="_ _53"> </span>call<span class="_ _44"> </span><span class="ff1a">signal<span class="_ _44"> </span></span>after <span class="_ _42"> </span>fetching <span class="_ _42"> </span>the <span class="_ _42"> </span>child’s <span class="_ _53"> </span>termination <span class="_ _42"> </span>status; <span class="_ _42"> </span>the <span class="_ _53"> </span>signal <span class="_ _42"> </span>is</div><div class="t m0 x32 h2a y136 ff19 fsf fc0 sc0 ls0 ws0">generated again by the kernel only if some other child has since terminated.</div><div class="t m0 x76 h52 y2aee ff19 fs2a fc0 sc0 ls0 ws0">POSIX.1 <span class="_ _e"> </span>states <span class="_ _80"> </span>that <span class="_ _80"> </span>when <span class="_ _80"> </span>we <span class="_ _80"> </span>establish <span class="_ _e"> </span>a <span class="_ _80"> </span>signal <span class="_ _80"> </span>handler <span class="_ _80"> </span>for<span class="_ _44"> </span><span class="ff1a">SIGCHLD<span class="_ _4b"> </span></span>and <span class="_ _e"> </span>ther<span class="lsc47">ee<span class="_ _c"></span><span class="ls0">xists <span class="_ _80"> </span>a</span></span></div><div class="t m0 x76 h52 y2aef ff19 fs2a fc0 sc0 ls0 ws0">terminated child <span class="_ _2"></span>we <span class="_ _2"></span>have <span class="_ _2"></span>not <span class="_ _2"></span>yet<span class="_ _80"> </span><span class="ff1a">wait</span>ed for<span class="_ _1"></span>,<span class="_ _80"> </span>it<span class="_ _80"> </span>is<span class="_"> </span>unspeciﬁed <span class="_ _2"></span>whether <span class="_ _2"></span>the <span class="_ _2"></span>signal <span class="_ _2"></span>is <span class="_ _2"></span>generated.</div><div class="t m0 x76 h51 y2af0 ff19 fs2a fc0 sc0 ls0 ws0">This <span class="_ _42"> </span>allows <span class="_ _23"> </span>the <span class="_ _42"> </span>behavior <span class="_ _42"> </span>described <span class="_ _42"> </span>previously<span class="_ _4"></span><span class="lsc48">.B<span class="_ _5b"></span><span class="ls0">ut <span class="_ _42"> </span>since <span class="_ _23"> </span>POSIX.1 <span class="_ _42"> </span>does <span class="_ _42"> </span>not <span class="_ _42"> </span>reset <span class="_ _23"> </span>a <span class="_ _42"> </span>signal’s</span></span></div><div class="t m0 x76 h51 y2af1 ff19 fs2a fc0 sc0 ls0 ws0">disposition <span class="_"> </span>to <span class="_"> </span>its <span class="_ _42"> </span>default <span class="_"> </span>when <span class="_"> </span>the <span class="_"> </span>signal <span class="_"> </span>occurs <span class="_"> </span>(assuming <span class="_ _42"> </span>that <span class="_"> </span>we’r<span class="lsc49">eu<span class="_ _43"></span><span class="ls0">sing <span class="_"> </span>the <span class="_ _42"> </span>POSIX.1</span></span></div><div class="t m0 x76 h52 y2af2 ff1a fs2a fc0 sc0 ls0 ws0">sigaction<span class="_ _47"> </span><span class="ff19">function <span class="_ _9"></span>to <span class="_ _9"></span>set <span class="_ _23"> </span>its <span class="_ _9"></span>disposition), <span class="_ _9"></span>there<span class="_ _47"> </span>is<span class="_ _66"> </span>n<span class="lsc4a">on<span class="_ _4f"></span><span class="ls0">eed <span class="_ _23"> </span>for <span class="_ _9"></span>us <span class="_ _9"></span>to <span class="_ _9"> </span>ever <span class="_ _23"> </span>establish <span class="_ _9"></span>a <span class="_ _9"> </span>signal</span></span></span></div><div class="t m0 x76 h52 y2af3 ff19 fs2a fc0 sc0 ls0 ws0">handler for<span class="_"> </span><span class="ff1a">SIGCHLD<span class="_ _53"> </span></span>within that handler<span class="_ _1"></span>.</div><div class="t m0 x3f h4d y2af4 ff19 fs26 fc0 sc0 ls0 ws0">Be <span class="_ _e"> </span>cognizant <span class="_ _e"> </span>of <span class="_ _e"> </span>the<span class="_ _4b"> </span><span class="ff1a">SIGCHLD<span class="_ _59"> </span></span>semantics <span class="_ _e"> </span>for <span class="_ _e"> </span>your <span class="_ _e"> </span>implementation.<span class="_ _48"> </span>Be <span class="_ _e"> </span>especially</div><div class="t m0 x32 h4d y2af5 ff19 fs26 fc0 sc0 ls0 ws0">aware<span class="_"> </span>of<span class="_ _47"> </span>some <span class="_ _2"></span>systems <span class="_ _3"></span>that<span class="_ _47"> </span><span class="ff1a">#define <span class="_ _8"></span>SIGCHLD<span class="_ _66"> </span><span class="ff19">to <span class="_ _3"></span>be<span class="_ _47"> </span></span>SIGCLD<span class="ff19">,<span class="_ _66"> </span>or<span class="_ _47"> </span>vice <span class="_ _3"></span>versa.<span class="_ _61"> </span>Changing</span></span></div><div class="t m0 x32 h49 y2af6 ff19 fs26 fc0 sc0 ls0 ws0">the name <span class="_ _2"></span>may <span class="_ _2"></span>allow <span class="_ _2"></span>you <span class="_ _2"></span>to compile <span class="_ _2"></span>a <span class="_ _2"></span>program that <span class="_ _2"></span>was <span class="_ _2"></span>written for <span class="_ _2"></span>another <span class="_ _2"></span>system, <span class="_ _2"></span>but</div><div class="t m0 x32 h49 y2af7 ff19 fs26 fc0 sc0 ls0 ws0">if that program depends on the other semantics, it may not work.</div><div class="t m0 x76 h5e y2af8 ff19 fs10 fc0 sc0 ls0 ws0">Of the four <span class="_ _2"></span>platforms described in <span class="_ _2"></span>this text, only <span class="_ _2"></span>Linux 3.2.0 and <span class="_ _2"></span>Solaris 10 deﬁne<span class="_"> </span><span class="ff1a">SIGCLD</span><span class="lsc4b">.O<span class="_ _43"></span><span class="ls0">n</span></span></div><div class="t m0 x76 h5e y2af9 ff19 fs10 fc0 sc0 ls0 ws0">these platforms,<span class="_"> </span><span class="ff1a">SIGCLD<span class="_ _53"> </span></span>is equivalent to<span class="_"> </span><span class="ff1a">SIGCHLD</span>.</div><div class="t m0 x35 h4b y2afa ff16 fs27 fc0 sc0 ls0 ws0">10.8 <span class="_ _93"> </span>Reliable-Signal <span class="_"> </span>T<span class="_ _6"></span>erminology <span class="_"> </span>and <span class="_"> </span>Semantics</div><div class="t m0 x32 h49 y2afb ff19 fs26 fc0 sc0 ls164 ws0">We <span class="_ _e"> </span>n<span class="_ _9"></span><span class="ls0">eed <span class="_ _2"></span>to <span class="_ _2"></span>deﬁne <span class="_ _2"></span>some <span class="_ _3"></span>of <span class="_ _2"></span>the <span class="_ _2"></span>terms <span class="_ _2"></span>used <span class="_ _2"></span>throughout our <span class="_ _3"></span>discussion <span class="_ _2"></span>of <span class="_ _2"></span>signals.<span class="_ _61"> </span>First, <span class="_ _2"></span>a</span></div><div class="t m0 x32 h4a y2afc ff19 fs26 fc0 sc0 ls0 ws0">signal <span class="_ _23"> </span>is<span class="_ _44"> </span><span class="ff1b">generated<span class="_ _35"> </span></span>for <span class="_ _42"> </span>a <span class="_ _42"> </span>process <span class="_ _23"></span>(or <span class="_ _42"> </span>sent <span class="_ _23"> </span>to <span class="_ _42"> </span>a <span class="_ _42"> </span>process) <span class="_ _23"></span>when <span class="_ _42"> </span>the <span class="_ _23"> </span>event <span class="_ _42"> </span>that <span class="_ _42"> </span>causes <span class="_ _42"> </span>the</div><div class="t m0 x32 h49 y2afd ff19 fs26 fc0 sc0 ls0 ws0">signal <span class="_ _9"></span>occurs.<span class="_ _5a"> </span>The <span class="_ _23"></span>event <span class="_ _9"></span>could <span class="_ _23"></span>be <span class="_ _9"></span>a <span class="_ _9"></span>hardwar<span class="lsc4c">ee<span class="_ _b"></span><span class="ls0">xception <span class="_ _3"></span>(e.g., <span class="_ _23"></span>divide <span class="_ _9"></span>by <span class="_ _23"></span>0), <span class="_ _9"></span>a <span class="_ _9"></span>software</span></span></div><div class="t m0 x32 h4d y2afe ff19 fs26 fc0 sc0 ls0 ws0">condition <span class="_ _23"></span>(e.g., <span class="_ _23"></span>an<span class="_ _35"> </span><span class="ff1a">alarm<span class="_ _45"> </span></span>timer <span class="_ _23"> </span>expiring), <span class="_ _23"> </span>a <span class="_ _23"> </span>terminal-generated <span class="_ _23"> </span>signal, <span class="_ _23"> </span>or <span class="_ _23"> </span>a <span class="_ _23"> </span>call <span class="_ _23"> </span>to <span class="_ _23"> </span>the</div><div class="t m0 x32 h4d y2aff ff1a fs26 fc0 sc0 ls0 ws0">kill<span class="_ _44"> </span><span class="ff19">function. <span class="_ _44"> </span>When<span class="_ _44"> </span>the <span class="_ _53"> </span>signal <span class="_ _42"> </span>is <span class="_ _53"> </span>generated, <span class="_ _42"> </span>the <span class="_ _53"> </span>kernel <span class="_ _53"> </span>usually <span class="_ _42"> </span>sets <span class="_ _53"> </span>a <span class="_ _42"> </span>ﬂag <span class="_ _53"> </span>of <span class="_ _53"> </span>some</span></div><div class="t m0 x32 h49 y2b00 ff19 fs26 fc0 sc0 ls0 ws0">form in the process table.</div><div class="t m0 x3f h4a y2b01 ff19 fs26 fc0 sc0 ls164 ws0">We <span class="_ _47"> </span>s<span class="_ _9"></span><span class="ls0">ay <span class="_ _23"></span>that <span class="_ _9"></span>a <span class="_ _23"></span>signal <span class="_ _23"></span>is<span class="_ _45"> </span><span class="ff1b">delivered<span class="_ _45"> </span></span>to <span class="_ _23"></span>a <span class="_ _23"></span>pr<span class="_ _0"></span>ocess <span class="_ _23"></span>when <span class="_ _9"></span>the <span class="_ _23"> </span>action <span class="_ _23"></span>for <span class="_ _9"></span>a <span class="_ _23"> </span>signal <span class="_ _23"></span>is <span class="_ _23"></span>taken.</span></div><div class="t m0 x32 h49 y2b02 ff19 fs26 fc0 sc0 ls0 ws0">During <span class="_ _2"></span>the <span class="_ _2"></span>time <span class="_ _3"></span>between <span class="_ _2"></span>the <span class="_ _2"></span>generation <span class="_ _3"></span>of <span class="_ _2"></span>a <span class="_ _2"></span>signal <span class="_ _3"></span>and <span class="_ _2"></span>its <span class="_ _3"></span>delivery<span class="_ _4"></span><span class="ls96f">,t<span class="_ _4f"></span><span class="ls0">he <span class="_ _2"></span>signal <span class="_ _3"></span>is <span class="_ _2"></span>said <span class="_ _3"></span>to</span></span></div><div class="t m0 x32 h4a y2b03 ff19 fs26 fc0 sc0 ls0 ws0">be<span class="_"> </span><span class="ff1b">pending</span>.</div><div class="t m0 x3f h4a y2b04 ff19 fs26 fc0 sc0 ls6a3 ws0">Ap<span class="_ _55"></span><span class="lscc">ro<span class="_ _2"></span><span class="ls0">cess <span class="_ _53"> </span>has <span class="_"> </span>the <span class="_ _53"> </span>option <span class="_ _53"> </span>of<span class="_ _59"> </span><span class="ff1b">blocking<span class="_ _4b"> </span></span>the <span class="_ _e"> </span>delivery <span class="_ _53"> </span>of <span class="_"> </span>a <span class="_ _53"> </span>signal.<span class="_ _65"> </span>If <span class="_ _e"> </span>a <span class="_ _e"> </span>signal <span class="_ _e"> </span>that <span class="_ _e"> </span>is</span></span></div><div class="t m0 x32 h49 y2b05 ff19 fs26 fc0 sc0 ls0 ws0">blocked <span class="_ _3"></span>is <span class="_ _9"></span>generated <span class="_ _9"></span>for <span class="_ _9"></span>a <span class="_ _9"></span>process, <span class="_ _3"></span>and <span class="_ _9"></span>if <span class="_ _3"></span>the <span class="_ _9"></span>action <span class="_ _9"></span>for <span class="_ _9"></span>that <span class="_ _9"></span>signal <span class="_ _3"></span>is <span class="_ _9"></span>either <span class="_ _9"></span>the <span class="_ _9"></span>default</div><div class="t m0 x32 h49 y2b06 ff19 fs26 fc0 sc0 ls0 ws0">action <span class="_ _9"></span>or <span class="_ _23"></span>to <span class="_ _9"></span>catch <span class="_ _23"></span>the <span class="_ _9"></span>signal, <span class="_ _23"></span>then <span class="_ _9"></span>the <span class="_ _9"></span>signal <span class="_ _23"></span>remains <span class="_ _9"></span>pending <span class="_ _9"></span>for <span class="_ _23"></span>the <span class="_ _9"></span>process <span class="_ _9"></span>until <span class="_ _23"></span>the</div><div class="t m0 x32 h49 y2b07 ff19 fs26 fc0 sc0 ls0 ws0">process either <span class="_ _2"></span>(a) <span class="_ _3"></span>unblocks <span class="_ _2"></span>the <span class="_ _2"></span>signal <span class="_ _2"></span>or <span class="_ _3"></span>(b) <span class="_ _2"></span>changes <span class="_ _2"></span>the <span class="_ _2"></span>action <span class="_ _3"></span>to <span class="_ _2"></span>ignor<span class="lsc4d">et<span class="_ _8"></span><span class="ls0">he <span class="_ _3"></span>signal.<span class="_ _61"> </span>The</span></span></div><div class="t m0 x32 h49 y2b08 ff19 fs26 fc0 sc0 ls0 ws0">system <span class="_ _9"></span>determines <span class="_ _23"></span>what <span class="_ _9"></span>to <span class="_ _23"></span>do <span class="_ _9"></span>with <span class="_ _23"></span>a <span class="_ _9"></span>blocked <span class="_ _23"></span>signal <span class="_ _9"></span>when <span class="_ _23"></span>the <span class="_ _9"></span>signal <span class="_ _23"></span>is <span class="_ _9"></span>delivered, <span class="_ _9"></span>not</div><div class="t m0 x32 h49 y2b09 ff19 fs26 fc0 sc0 ls0 ws0">when <span class="_ _9"></span>it’s <span class="_ _9"></span>generated.<span class="_ _16"> </span>This <span class="_ _9"></span>allows <span class="_ _9"></span>the <span class="_ _9"></span>process <span class="_ _9"></span>to <span class="_ _9"></span>change <span class="_ _9"></span>the <span class="_ _9"></span>action <span class="_ _9"></span>for <span class="_ _9"></span>the <span class="_ _9"></span>signal <span class="_ _9"></span>before</div><div class="t m0 x32 h4d y2b0a ff19 fs26 fc0 sc0 ls0 ws0">it’s <span class="_ _9"></span>delivered. <span class="_ _45"> </span>The<span class="_ _45"> </span><span class="ff1a">sigpending<span class="_ _35"> </span></span>function <span class="_ _9"></span>(Section <span class="_ _23"></span>10.13) <span class="_ _9"></span>can <span class="_ _9"></span>be <span class="_ _23"></span>called <span class="_ _9"></span>by <span class="_ _23"></span>a <span class="_ _9"></span>process <span class="_ _9"></span>to</div><div class="t m0 x32 h49 y2b0b ff19 fs26 fc0 sc0 ls0 ws0">determine which signals ar<span class="lsd3">eb<span class="_ _4f"></span><span class="ls0">locked and pending.</span></span></div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.893259px;bottom:589.908878px;width:294.575394px;height:19.680023px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
