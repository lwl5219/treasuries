<div id="pf180" class="pf w4 h1f" data-page-no="180"><div class="pc pc180 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg180.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">350<span class="_ _1b"> </span><span class="ff19">Signals <span class="_ _24b"> </span>Chapter<span class="_ _21"> </span>10</span></div><div class="t m0 x3f h57 y1295 ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;signal.h&gt;</div><div class="t m0 x3f h57 y22ef ff1a fs2d fc0 sc0 ls0 ws0">int sigaction(int<span class="_"> </span><span class="ff1b">signo</span><span class="ls15c">,c<span class="_ _1d"></span><span class="ls0">onst struct sigaction *restrict<span class="_"> </span><span class="ff1b">act</span>,</span></span></div><div class="t m0 xea h57 y2cac ff1a fs2d fc0 sc0 ls0 ws0">struct sigaction *restrict<span class="_"> </span><span class="ff1b">oact</span>);</div><div class="t m0 x153 h5f y2cad ff19 fs2d fc0 sc0 ls0 ws0">Returns: 0 if OK,<span class="_"> </span><span class="ff20">−</span>1<span class="_"> </span>on<span class="_"> </span>error</div><div class="t m0 x32 h4a y2cae ff19 fs26 fc0 sc0 ls0 ws0">The <span class="_ _2"></span>argument<span class="_ _47"> </span><span class="ff1b">signo<span class="_ _47"> </span></span>is <span class="_ _2"></span>the <span class="_ _3"></span>signal <span class="_ _3"></span>number <span class="_ _3"></span>whose <span class="_ _3"></span>action <span class="_ _2"></span>we <span class="_ _3"></span>ar<span class="lscaa">ee<span class="_ _8"></span><span class="ls0">xamining <span class="_ _3"></span>or <span class="_ _3"></span>modifying.</span></span></div><div class="t m0 x32 h4a y2caf ff19 fs26 fc0 sc0 ls0 ws0">If the<span class="_"> </span><span class="ff1b">act<span class="_ _66"> </span></span>pointer <span class="_ _2"></span>is non-null, <span class="_ _2"></span>we ar<span class="lscab">em<span class="_ _4f"></span><span class="ls0">odifying <span class="_ _2"></span>the action.<span class="_ _61"> </span>If the<span class="_ _66"> </span><span class="ff1b">oact<span class="_"> </span></span>pointer <span class="_ _2"></span>is non-null,</span></span></div><div class="t m0 x32 h4a y2cb0 ff19 fs26 fc0 sc0 ls0 ws0">the <span class="_ _e"> </span>system <span class="_ _e"> </span>returns <span class="_ _53"> </span>the <span class="_ _e"> </span>previous <span class="_ _53"> </span>action <span class="_ _e"> </span>for <span class="_ _e"> </span>the <span class="_ _e"> </span>signal <span class="_ _e"> </span>through <span class="_ _53"> </span>the<span class="_ _59"> </span><span class="ff1b">oact<span class="_ _4b"> </span></span>pointer<span class="_ _1"></span><span class="lscac">.T<span class="_ _64"></span><span class="ls0">his</span></span></div><div class="t m0 x32 h49 y2cb1 ff19 fs26 fc0 sc0 ls0 ws0">function uses the following structur<span class="_ _0"></span>e:</div><div class="t m0 x3f h4e y2cb2 ff1a fs28 fc0 sc0 ls0 ws0">struct sigaction {</div><div class="t m0 xf4 h4e y2cb3 ff1a fs28 fc0 sc0 ls0 ws0">void <span class="_ _15"> </span>(*sa_handler)(int);<span class="_ _d9"> </span>/* addr of signal handler, */</div><div class="t m0 x1cd h4e y2cb4 ff1a fs28 fc0 sc0 ls0 ws0">/* or SIG_IGN, or SIG_DFL */</div><div class="t m0 xf4 h4e y2cb5 ff1a fs28 fc0 sc0 ls0 ws0">sigset_t sa_mask;<span class="_ _166"> </span>/* additional signals to block */</div><div class="t m0 xf4 h4e y2cb6 ff1a fs28 fc0 sc0 ls0 ws0">int <span class="_ _8a"> </span>sa_flags;<span class="_ _82"> </span>/* signal options, Figure 10.16 */</div><div class="t m0 xf4 h4e y2cb7 ff1a fs28 fc0 sc0 ls0 ws0">/* alternate handler */</div><div class="t m0 xf4 h4e y2cb8 ff1a fs28 fc0 sc0 ls0 ws0">void <span class="_ _15"> </span>(*sa_sigaction)(int,<span class="_"> </span>siginfo_t *, void *);</div><div class="t m0 x3f h4e y2cb9 ff1a fs28 fc0 sc0 ls0 ws0">};</div><div class="t m0 x3f h4d y2cba ff19 fs26 fc0 sc0 ls0 ws0">When <span class="_ _47"> </span>changing <span class="_ _47"> </span>the <span class="_ _47"> </span>action <span class="_ _47"> </span>for <span class="_ _47"> </span>a <span class="_ _47"> </span>signal, <span class="_ _45"> </span>if <span class="_ _66"> </span>the<span class="_ _5a"> </span><span class="ff1a">sa_handler<span class="_ _61"> </span></span>ﬁeld <span class="_ _47"> </span>contains <span class="_ _47"> </span>the</div><div class="t m0 x32 h4d y2cbb ff19 fs26 fc0 sc0 ls0 ws0">address of <span class="_ _3"></span>a <span class="_ _2"></span>signal-catching <span class="_ _2"></span>function <span class="_ _3"></span>(as <span class="_ _2"></span>opposed <span class="_ _3"></span>to <span class="_ _2"></span>either <span class="_ _2"></span>of <span class="_ _3"></span>the <span class="_ _2"></span>constants<span class="_ _47"> </span><span class="ff1a">SIG_IGN<span class="_ _47"> </span></span>or</div><div class="t m0 x32 h4d y2cbc ff1a fs26 fc0 sc0 ls0 ws0">SIG_DFL<span class="ff19">), <span class="_ _2"></span>then <span class="_ _3"></span>the<span class="_ _47"> </span></span>sa_mask<span class="_ _47"> </span><span class="ff19">ﬁeld <span class="_ _3"></span>speciﬁes <span class="_ _2"></span>a <span class="_ _3"></span>set <span class="_ _3"></span>of <span class="_ _3"></span>signals <span class="_ _2"></span>that <span class="_ _3"></span>ar<span class="lscad">ea<span class="_ _8"></span><span class="ls0">dded <span class="_ _3"></span>to <span class="_ _3"></span>the <span class="_ _2"></span>signal</span></span></span></div><div class="t m0 x32 h49 y2cbd ff19 fs26 fc0 sc0 ls0 ws0">mask <span class="_"> </span>of <span class="_"> </span>the <span class="_"> </span>pr<span class="_ _0"></span>ocess <span class="_"> </span>befor<span class="lscae">et<span class="_ _5b"></span><span class="ls0">he <span class="_"> </span>signal-catching <span class="_"> </span>function <span class="_"> </span>is <span class="_"> </span>called.<span class="_ _60"> </span>If <span class="_"> </span>and <span class="_"> </span>when <span class="_"> </span>the</span></span></div><div class="t m0 x32 h49 y2cbe ff19 fs26 fc0 sc0 ls0 ws0">signal-catching <span class="_ _9"></span>function <span class="_ _23"></span>returns, <span class="_ _9"></span>the <span class="_ _23"></span>signal <span class="_ _9"></span>mask <span class="_ _23"></span>of <span class="_ _9"></span>the <span class="_ _23"></span>process <span class="_ _9"></span>is <span class="_ _9"></span>reset <span class="_ _9"></span>to <span class="_ _23"> </span>its <span class="_ _23"></span>pr<span class="_ _0"></span>evious</div><div class="t m0 x32 h49 y2cbf ff19 fs26 fc0 sc0 ls0 ws0">value. <span class="_ _4b"> </span>This<span class="_ _59"> </span>way<span class="_ _6"></span>,<span class="_ _4b"> </span>we<span class="_ _59"> </span>a<span class="lscc">re <span class="_ _66"> </span>a</span>ble <span class="_"> </span>to <span class="_ _e"> </span>block <span class="_"> </span>certain <span class="_ _53"> </span>signals <span class="_"> </span>whenever <span class="_ _e"> </span>a <span class="_"> </span>signal <span class="_ _53"> </span>handler <span class="_"> </span>is</div><div class="t m0 x32 h49 y2cc0 ff19 fs26 fc0 sc0 ls0 ws0">invoked. <span class="_ _45"> </span>The<span class="_ _45"> </span>operating <span class="_ _23"></span>system <span class="_ _9"></span>includes <span class="_ _9"></span>the <span class="_ _23"></span>signal <span class="_ _9"></span>being <span class="_ _9"></span>delivered <span class="_ _9"></span>in <span class="_ _23"></span>the <span class="_ _9"></span>signal <span class="_ _9"></span>mask</div><div class="t m0 x32 h49 y2cc1 ff19 fs26 fc0 sc0 ls0 ws0">when <span class="_ _45"> </span>the <span class="_ _35"> </span>handler <span class="_ _45"> </span>is <span class="_ _35"> </span>invoked.<span class="_ _1a3"> </span>Hence, <span class="_ _35"> </span>we <span class="_ _45"> </span>ar<span class="lscaf">eg<span class="_ _7"></span><span class="ls0">uaranteed <span class="_ _35"> </span>that <span class="_ _45"> </span>whenever <span class="_ _35"> </span>we <span class="_ _45"> </span>are</span></span></div><div class="t m0 x32 h49 y2cc2 ff19 fs26 fc0 sc0 ls0 ws0">processing <span class="_ _2"></span>a <span class="_ _3"></span>given <span class="_ _3"></span>signal, <span class="_ _3"></span>another <span class="_ _3"></span>occurrence <span class="_ _2"></span>of <span class="_ _3"></span>that <span class="_ _3"></span>same <span class="_ _3"></span>signal <span class="_ _3"></span>is <span class="_ _3"></span>blocked <span class="_ _3"></span>until <span class="_ _3"></span>we’re</div><div class="t m0 x32 h49 y2cc3 ff19 fs26 fc0 sc0 ls0 ws0">ﬁnished <span class="_ _35"> </span>pr<span class="_ _0"></span>ocessing <span class="_ _35"> </span>the <span class="_ _35"> </span>ﬁrst <span class="_ _45"> </span>occurrence. <span class="_ _51"> </span>Recall<span class="_ _51"> </span>from <span class="_ _45"> </span>Section <span class="_ _35"> </span>10.8 <span class="_ _35"> </span>that <span class="_ _35"> </span>additional</div><div class="t m0 x32 h49 y2cc4 ff19 fs26 fc0 sc0 ls0 ws0">occurrences <span class="_ _9"></span>of <span class="_ _23"></span>the <span class="_ _23"></span>same <span class="_ _9"></span>signal <span class="_ _23"> </span>ar<span class="lscb0">eu<span class="_ _43"></span><span class="ls0">sually <span class="_ _23"> </span>not <span class="_ _23"> </span>queued.<span class="_ _51"> </span>If <span class="_ _9"></span>the <span class="_ _23"> </span>signal <span class="_ _23"> </span>occurs <span class="_ _23"></span>ﬁve <span class="_ _23"></span>times</span></span></div><div class="t m0 x32 h49 y2cc5 ff19 fs26 fc0 sc0 ls0 ws0">while <span class="_ _23"></span>it <span class="_ _23"></span>is <span class="_ _9"></span>blocked, <span class="_ _23"> </span>when <span class="_ _23"> </span>we <span class="_ _23"> </span>unblock <span class="_ _23"></span>the <span class="_ _23"></span>signal, <span class="_ _23"></span>the <span class="_ _9"></span>signal-handling <span class="_ _23"> </span>function <span class="_ _23"> </span>for <span class="_ _23"> </span>that</div><div class="t m0 x32 h49 y2cc6 ff19 fs26 fc0 sc0 ls0 ws0">signal <span class="_ _3"></span>will <span class="_ _3"></span>usually <span class="_ _3"></span>be <span class="_ _3"></span>invoked <span class="_ _9"></span>only <span class="_ _3"></span>one <span class="_ _3"></span>time.<span class="_ _16"> </span>(This <span class="_ _3"></span>characteristic <span class="_ _9"></span>was <span class="_ _3"></span>illustrated <span class="_ _3"></span>in <span class="_ _3"></span>the</div><div class="t m0 x32 h49 y2cc7 ff19 fs26 fc0 sc0 ls0 ws0">previous example.)</div><div class="t m0 x3f h49 y2cc8 ff19 fs26 fc0 sc0 ls0 ws0">Once <span class="_ _9"></span>we <span class="_ _9"></span>install <span class="_ _23"></span>an <span class="_ _9"></span>action <span class="_ _9"></span>for <span class="_ _23"></span>a <span class="_ _9"></span>given <span class="_ _9"></span>signal, <span class="_ _9"></span>that <span class="_ _23"></span>action <span class="_ _9"></span>remains <span class="_ _9"></span>installed <span class="_ _9"></span>until <span class="_ _9"></span>we</div><div class="t m0 x32 h4d y2cc9 ff19 fs26 fc0 sc0 ls0 ws0">explicitly <span class="_ _2"></span>change <span class="_ _3"></span>it <span class="_ _3"></span>by <span class="_ _3"></span>calling<span class="_ _47"> </span><span class="ff1a">sigaction</span><span class="ls5a8">.U<span class="_ _5b"></span><span class="ls0">nlike <span class="_ _3"></span>earlier <span class="_ _2"></span>systems <span class="_ _3"></span>with <span class="_ _3"></span>their <span class="_ _3"></span>unreliable</span></span></div><div class="t m0 x32 h49 y2cca ff19 fs26 fc0 sc0 ls0 ws0">signals, POSIX.1 <span class="_ _2"></span>requires that <span class="_ _2"></span>a <span class="_ _2"></span>signal <span class="_ _2"></span>handler <span class="_ _2"></span>remain installed <span class="_ _2"></span>until <span class="_ _2"></span>explicitly <span class="_ _2"></span>changed.</div><div class="t m0 x3f h4d y2ccb ff19 fs26 fc0 sc0 ls0 ws0">The<span class="_"> </span><span class="ff1a">sa_flags<span class="_ _66"> </span></span>ﬁeld of <span class="_ _2"></span>the<span class="_"> </span><span class="ff1b">act<span class="_ _66"> </span></span>structur<span class="lscb1">es<span class="_ _4f"></span><span class="ls0">peciﬁes various <span class="_ _2"></span>options for <span class="_ _2"></span>the handling of</span></span></div><div class="t m0 x32 h49 y2ccc ff19 fs26 fc0 sc0 ls0 ws0">this <span class="_"> </span>signal.<span class="_ _50"> </span>Figur<span class="lscb2">e1<span class="_ _5b"></span><span class="ls0">0.16 <span class="_"> </span>details <span class="_ _47"> </span>the <span class="_"> </span>meaning <span class="_ _66"> </span>of <span class="_ _66"> </span>these <span class="_ _66"> </span>options <span class="_ _47"> </span>when <span class="_"> </span>set.<span class="_ _50"> </span>The <span class="_"> </span>SUS</span></span></div><div class="t m0 x32 h49 y2ccd ff19 fs26 fc0 sc0 ls0 ws0">column <span class="_ _23"></span>contains <span class="_ _23"></span>• <span class="_ _9"></span>if <span class="_ _23"> </span>the <span class="_ _23"> </span>ﬂag <span class="_ _23"> </span>is <span class="_ _23"></span>deﬁned <span class="_ _23"></span>as <span class="_ _23"></span>part <span class="_ _9"></span>of <span class="_ _23"> </span>the <span class="_ _23"> </span>base <span class="_ _23"> </span>POSIX.1 <span class="_ _23"></span>speciﬁcation, <span class="_ _23"></span>and</div><div class="t m0 x32 h49 y2cce ff18 fs26 fc0 sc0 ls0 ws0">XSI<span class="_"> </span><span class="ff19">if it is deﬁned as part of the XSI option.</span></div><div class="t m0 x3f h4d y2ccf ff19 fs26 fc0 sc0 ls0 ws0">The<span class="_ _60"> </span><span class="ff1a">sa_sigaction<span class="_ _50"> </span></span>ﬁeld <span class="_ _61"> </span>is <span class="_ _61"> </span>an <span class="_ _61"> </span>alternative <span class="_ _46"> </span>signal <span class="_ _61"> </span>handler <span class="_ _61"> </span>used <span class="_ _46"> </span>when <span class="_ _61"> </span>the</div><div class="t m0 x32 h4d y2cd0 ff1a fs26 fc0 sc0 ls0 ws0">SA_SIGINFO<span class="_ _46"> </span><span class="ff19">ﬂag <span class="_ _66"> </span>is <span class="_ _47"> </span>used <span class="_"> </span>with<span class="_ _61"> </span></span>sigaction<span class="ff19 lscb3">.I<span class="_ _49"></span><span class="ls0">mplementations <span class="_ _66"> </span>might <span class="_ _47"> </span>use <span class="_"> </span>the <span class="_ _66"> </span>same</span></span></div><div class="t m0 x32 h4d y2cd1 ff19 fs26 fc0 sc0 ls0 ws0">storage <span class="_ _23"> </span>for <span class="_ _42"> </span>both <span class="_ _23"> </span>the<span class="_ _35"> </span><span class="ff1a">sa_sigaction<span class="_ _35"> </span></span>ﬁeld <span class="_ _42"> </span>and <span class="_ _23"> </span>the<span class="_ _35"> </span><span class="ff1a">sa_handler<span class="_ _44"> </span></span>ﬁeld, <span class="_ _23"> </span>so <span class="_ _23"> </span>applications</div><div class="t m0 x32 h49 y2cd2 ff19 fs26 fc0 sc0 ls0 ws0">can use only one of these ﬁelds at a time.</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
