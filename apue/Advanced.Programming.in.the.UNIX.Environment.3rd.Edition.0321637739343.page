<div id="pf157" class="pf w4 h1f" data-page-no="157"><div class="pc pc157 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg157.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>9.10<span class="_ _249"> </span>Orphaned <span class="_"> </span>Process <span class="_"> </span>Gr<span class="_ _0"></span>oups<span class="_ _1b"> </span><span class="ff18">309</span></div><div class="t m0 x3f h2a y12f ff19 fsf fc0 sc0 ls49 ws0">•W<span class="_ _4d"></span><span class="ls0">hen <span class="_ _2"></span>the <span class="_ _3"></span>parent <span class="_ _2"></span>terminates, <span class="_ _3"></span>the <span class="_ _3"></span>child <span class="_ _3"></span>is <span class="_ _3"></span>orphaned, <span class="_ _2"></span>so <span class="_ _3"></span>the <span class="_ _3"></span>child’s <span class="_ _3"></span>parent <span class="_ _2"></span>process</span></div><div class="t m0 x15 h26 y130 ff19 fsf fc0 sc0 ls0 ws0">ID becomes 1, which is the<span class="_"> </span><span class="ff1a">init<span class="_ _80"> </span></span>process ID.</div><div class="t m0 x3f h2b y2802 ff19 fsf fc0 sc0 ls49 ws0">•A<span class="_ _4d"></span><span class="ls4a7">tt<span class="_ _4a"></span><span class="ls0">his <span class="_"> </span>point, <span class="_"> </span>the <span class="_ _e"> </span>child <span class="_"> </span>is <span class="_"> </span>now <span class="_ _e"> </span>a <span class="_"> </span>member <span class="_"> </span>of <span class="_"> </span>an<span class="_ _4b"> </span><span class="ff1b">orphaned <span class="_"> </span>process <span class="_"> </span>gr<span class="_ _1"></span>oup<span class="ff19 lsb58">.T<span class="_ _64"></span><span class="ls0">he</span></span></span></span></span></div><div class="t m0 x15 h2a y1f0b ff19 fsf fc0 sc0 ls0 ws0">POSIX.1 <span class="_ _9"></span>deﬁnition <span class="_ _9"></span>of <span class="_ _9"></span>an <span class="_ _23"></span>orphaned <span class="_ _9"></span>process <span class="_ _3"></span>group <span class="_ _9"></span>is <span class="_ _9"></span>one <span class="_ _23"></span>in <span class="_ _9"></span>which <span class="_ _9"></span>the <span class="_ _9"></span>parent <span class="_ _9"></span>of</div><div class="t m0 x15 h2a y2803 ff19 fsf fc0 sc0 ls0 ws0">every <span class="_ _9"></span>member <span class="_ _9"></span>is <span class="_ _23"></span>either <span class="_ _9"></span>itself <span class="_ _9"></span>a <span class="_ _9"></span>member <span class="_ _23"></span>of <span class="_ _9"></span>the <span class="_ _9"></span>group <span class="_ _9"></span>or <span class="_ _9"></span>is <span class="_ _9"></span>not <span class="_ _23"></span>a <span class="_ _9"></span>member <span class="_ _9"></span>of <span class="_ _9"></span>the</div><div class="t m0 x15 h2a y2804 ff19 fsf fc0 sc0 ls0 ws0">group’s <span class="_ _42"> </span>session.<span class="_ _65"> </span>Another <span class="_ _53"> </span>way <span class="_ _e"> </span>of <span class="_ _53"> </span>saying <span class="_ _53"> </span>this <span class="_ _53"> </span>is <span class="_ _e"> </span>that <span class="_ _53"> </span>the <span class="_ _53"> </span>process <span class="_ _53"> </span>group <span class="_ _42"> </span>is <span class="_ _e"> </span>not</div><div class="t m0 x15 h2a y2805 ff19 fsf fc0 sc0 ls0 ws0">orphaned <span class="_ _23"></span>as <span class="_ _23"></span>long <span class="_ _23"></span>as <span class="_ _23"></span>a <span class="_ _23"></span>pr<span class="_ _0"></span>ocess <span class="_ _23"></span>in <span class="_ _23"></span>the <span class="_ _23"></span>group <span class="_ _9"></span>has <span class="_ _23"> </span>a <span class="_ _23"> </span>parent <span class="_ _23"></span>in <span class="_ _9"></span>a <span class="_ _23"> </span>different <span class="_ _9"></span>process</div><div class="t m0 x15 h2a y2806 ff19 fsf fc0 sc0 ls0 ws0">group <span class="_ _3"></span>but <span class="_ _23"></span>in <span class="_ _9"></span>the <span class="_ _9"></span>same <span class="_ _9"></span>session.<span class="_ _5a"> </span>If <span class="_ _23"></span>the <span class="_ _9"></span>process <span class="_ _3"></span>group <span class="_ _9"></span>is <span class="_ _9"></span>not <span class="_ _9"></span>orphaned, <span class="_ _23"></span>there<span class="_ _47"> </span>is<span class="_ _45"> </span>a</div><div class="t m0 x15 h2a y2807 ff19 fsf fc0 sc0 ls0 ws0">chance <span class="_ _42"> </span>that <span class="_ _42"> </span>one <span class="_ _42"> </span>of <span class="_ _42"> </span>those <span class="_ _42"> </span>parents <span class="_ _23"> </span>in <span class="_ _42"> </span>a <span class="_ _42"> </span>differ<span class="_ _0"></span>ent <span class="_ _42"> </span>process <span class="_ _23"> </span>group <span class="_ _42"> </span>but <span class="_ _42"> </span>in <span class="_ _42"> </span>the <span class="_ _42"> </span>same</div><div class="t m0 x15 h2a y2808 ff19 fsf fc0 sc0 ls0 ws0">session <span class="_ _3"></span>will <span class="_ _3"></span>restart <span class="_ _2"></span>a <span class="_ _3"></span>stopped <span class="_ _3"></span>process <span class="_ _2"></span>in <span class="_ _3"></span>the <span class="_ _3"></span>process <span class="_ _2"></span>group <span class="_ _3"></span>that <span class="_ _3"></span>is <span class="_ _3"></span>not <span class="_ _3"></span>orphaned.</div><div class="t m0 x15 h2a y2809 ff19 fsf fc0 sc0 ls0 ws0">Here, <span class="_ _23"></span>the <span class="_ _23"></span>parent <span class="_ _23"></span>of <span class="_ _23"></span>every <span class="_ _23"> </span>process <span class="_ _23"></span>in <span class="_ _23"> </span>the <span class="_ _23"> </span>group <span class="_ _23"> </span>(e.g., <span class="_ _23"> </span>process <span class="_ _23"> </span>1 <span class="_ _42"> </span>is <span class="_ _23"></span>the <span class="_ _23"> </span>parent <span class="_ _23"></span>of</div><div class="t m0 x15 h2a y280a ff19 fsf fc0 sc0 ls0 ws0">process 6100) belongs to another session.</div><div class="t m0 x3f h2a y945 ff19 fsf fc0 sc0 ls49 ws0">•S<span class="_ _4d"></span><span class="ls0">ince <span class="_ _47"> </span>the <span class="_ _45"> </span>process <span class="_ _47"> </span>group <span class="_ _47"> </span>is <span class="_ _45"> </span>orphaned <span class="_ _47"> </span>when <span class="_ _45"> </span>the <span class="_ _47"> </span>parent <span class="_ _47"> </span>terminates, <span class="_ _45"> </span>and <span class="_ _47"> </span>the</span></div><div class="t m0 x15 h2a y946 ff19 fsf fc0 sc0 ls0 ws0">process gr<span class="_ _0"></span>oup contains a stopped process, POSIX.1 r<span class="_ _0"></span>equires that every pr<span class="_ _0"></span>ocess in</div><div class="t m0 x15 h26 y947 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _35"> </span>newly <span class="_ _35"> </span>orphaned <span class="_ _44"> </span>process <span class="_ _35"> </span>gr<span class="_ _0"></span>oup <span class="_ _35"> </span>be <span class="_ _35"> </span>sent <span class="_ _44"> </span>the <span class="_ _35"> </span>hang-up <span class="_ _35"> </span>signal <span class="_ _44"> </span>(<span class="ff1a">SIGHUP</span>)</div><div class="t m0 x15 h26 y948 ff19 fsf fc0 sc0 ls0 ws0">followed by the continue signal (<span class="ff1a">SIGCONT</span>).</div><div class="t m0 x3f h2a y5d8 ff19 fsf fc0 sc0 ls49 ws0">•T<span class="_ _4d"></span><span class="ls0">his <span class="_ _9"></span>causes <span class="_ _9"></span>the <span class="_ _9"></span>child <span class="_ _3"></span>to <span class="_ _9"></span>be <span class="_ _9"></span>continued, <span class="_ _9"></span>after <span class="_ _9"></span>processing <span class="_ _9"></span>the <span class="_ _9"></span>hang-up <span class="_ _9"></span>signal.<span class="_ _16"> </span>The</span></div><div class="t m0 x15 h2a y5d9 ff19 fsf fc0 sc0 ls0 ws0">default <span class="_ _9"></span>action <span class="_ _9"></span>for <span class="_ _9"></span>the <span class="_ _23"></span>hang-up <span class="_ _9"></span>signal <span class="_ _9"></span>is <span class="_ _9"></span>to <span class="_ _9"></span>terminate <span class="_ _9"></span>the <span class="_ _23"></span>pr<span class="_ _0"></span>ocess, <span class="_ _9"></span>so <span class="_ _9"></span>we <span class="_ _9"></span>have <span class="_ _23"></span>to</div><div class="t m0 x15 h26 y5da ff19 fsf fc0 sc0 ls0 ws0">provide <span class="_ _2"></span>a <span class="_ _3"></span>signal <span class="_ _2"></span>handler <span class="_ _3"></span>to <span class="_ _3"></span>catch <span class="_ _3"></span>the <span class="_ _3"></span>signal.<span class="_ _16"> </span><span class="ls5f">We <span class="_ _80"> </span>t<span class="_ _9"></span></span>herefor<span class="_ _0"></span><span class="lsb59">ee<span class="_ _8"></span><span class="ls0">xpect <span class="_ _3"></span>the<span class="_ _47"> </span><span class="ff1a">printf<span class="_ _47"> </span></span>in</span></span></div><div class="t m0 x15 h26 y5dc ff19 fsf fc0 sc0 ls0 ws0">the<span class="_"> </span><span class="ff1a">sig_hup<span class="_ _80"> </span></span>function to appear befor<span class="ls44">et<span class="_ _d"></span><span class="ls0">he<span class="_"> </span><span class="ff1a">printf<span class="_ _80"> </span></span>in the<span class="_"> </span><span class="ff1a">pr_ids<span class="_ _66"> </span></span>function.</span></span></div><div class="t m0 x32 h2a y5df ff19 fsf fc0 sc0 ls0 ws0">Here<span class="_"> </span>is<span class="_"> </span>the output fr<span class="_ _0"></span>om the pr<span class="_ _0"></span>ogram shown in Figur<span class="ls44">e9<span class="_ _4f"></span><span class="ls0">.13:</span></span></div><div class="t m0 x3f h57 y280b ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">./a.out</span></div><div class="t m0 x3f h57 y280c ff1a fs2d fc0 sc0 ls0 ws0">parent: pid = 6099, ppid = 2837, pgrp = 6099, tpgrp = 6099</div><div class="t m0 x3f h57 y280d ff1a fs2d fc0 sc0 ls0 ws0">child: pid = 6100, ppid = 6099, pgrp = 6099, tpgrp = 6099</div><div class="t m0 x3f h57 y280e ff1a fs2d fc0 sc0 ls15c ws0">$S<span class="_ _1d"></span><span class="ls0">IGHUP received, pid = 6100</span></div><div class="t m0 x3f h57 y280f ff1a fs2d fc0 sc0 ls0 ws0">child: pid = 6100, ppid = 1, pgrp = 6099, tpgrp = 2837</div><div class="t m0 x3f h57 y2810 ff1a fs2d fc0 sc0 ls0 ws0">read error 5 on controlling TTY</div><div class="t m0 x32 h2a y2811 ff19 fsf fc0 sc0 ls0 ws0">Note <span class="_ _35"> </span>that <span class="_ _35"> </span>our <span class="_ _35"> </span>shell <span class="_ _44"> </span>prompt <span class="_ _35"> </span>appears <span class="_ _35"> </span>with <span class="_ _35"> </span>the <span class="_ _35"> </span>output <span class="_ _35"> </span>from <span class="_ _35"> </span>the <span class="_ _35"> </span>child, <span class="_ _35"> </span>since <span class="_ _44"> </span>two</div><div class="t m0 x32 h2a y2812 ff19 fsf fc0 sc0 ls0 ws0">processes <span class="_ _84"></span>— <span class="_ _4"></span>our<span class="_ _45"> </span>login <span class="_ _42"> </span>shell <span class="_ _23"></span>and <span class="_ _23"> </span>the <span class="_ _23"> </span>child<span class="_ _9"></span><span class="ls9d">—a<span class="_ _1"></span><span class="ls45">re <span class="_ _42"> </span>w<span class="_ _2"></span><span class="ls0">riting <span class="_ _23"> </span>to <span class="_ _23"> </span>the <span class="_ _42"> </span>terminal.<span class="_ _51"> </span>As <span class="_ _23"></span>we <span class="_ _23"> </span>expect,</span></span></span></div><div class="t m0 x32 h2a y2813 ff19 fsf fc0 sc0 ls0 ws0">the parent pr<span class="_ _0"></span>ocess ID of the child has become 1.</div><div class="t m0 x3f h26 y2814 ff19 fsf fc0 sc0 ls0 ws0">After <span class="_ _23"></span>calling<span class="_ _35"> </span><span class="ff1a">pr_ids<span class="_ _35"> </span></span>in <span class="_ _23"></span>the <span class="_ _23"> </span>child, <span class="_ _23"> </span>the <span class="_ _23"> </span>program <span class="_ _23"> </span>tries <span class="_ _23"> </span>to <span class="_ _23"> </span>read <span class="_ _23"> </span>from <span class="_ _23"></span>standar<span class="lsb5a">di<span class="_ _43"></span><span class="ls0">nput.</span></span></div><div class="t m0 x32 h2a y2815 ff19 fsf fc0 sc0 ls0 ws0">As we saw <span class="_ _2"></span>earlier in this <span class="_ _2"></span>chapter<span class="_ _1"></span><span class="ls20f">,w<span class="_ _4f"></span><span class="ls0">hen <span class="_ _2"></span>a process in a <span class="_ _2"></span>background pr<span class="_ _0"></span>ocess group tries to</span></span></div><div class="t m0 x32 h26 y2816 ff19 fsf fc0 sc0 ls45 ws0">re<span class="ls0">ad <span class="_ _42"> </span>from <span class="_ _42"> </span>its <span class="_ _42"> </span>controlling <span class="_ _23"> </span>terminal,<span class="_ _44"> </span><span class="ff1a">SIGTTIN<span class="_ _35"> </span></span>is <span class="_ _42"> </span>generated <span class="_ _42"> </span>for <span class="_ _42"> </span>the <span class="_ _42"> </span>background <span class="_ _23"> </span>process</span></div><div class="t m0 x32 h2a y2817 ff19 fsf fc0 sc0 ls0 ws0">group. <span class="_ _66"> </span>But<span class="_ _45"> </span>here<span class="_ _66"> </span>we<span class="_ _45"> </span>have <span class="_ _2"></span>an <span class="_ _3"></span>orphaned <span class="_ _9"></span>process <span class="_ _2"></span>group; <span class="_ _3"></span>if <span class="_ _3"></span>the <span class="_ _3"></span>kernel <span class="_ _3"></span>were<span class="_ _47"> </span>to<span class="_ _47"> </span>stop <span class="_ _3"></span>it <span class="_ _9"></span>with</div><div class="t m0 x32 h2a y2818 ff19 fsf fc0 sc0 ls0 ws0">this <span class="_ _e"> </span>signal, <span class="_ _e"> </span>the <span class="_"> </span>pr<span class="_ _1"></span>ocesses <span class="_"> </span>in <span class="_ _53"> </span>the <span class="_"> </span>pr<span class="_ _1"></span>ocess <span class="_"> </span>gr<span class="_ _0"></span>oup <span class="_ _e"> </span>would <span class="_ _e"> </span>probably <span class="_ _e"> </span>never <span class="_ _e"> </span>be <span class="_ _e"> </span>continued.</div><div class="t m0 x32 h26 y2819 ff19 fsf fc0 sc0 ls0 ws0">POSIX.1 <span class="_ _42"> </span>speciﬁes <span class="_ _53"> </span>that <span class="_ _42"> </span>the<span class="_ _4b"> </span><span class="ff1a">read<span class="_ _44"> </span></span>is <span class="_ _42"> </span>to <span class="_ _53"> </span>return <span class="_ _42"> </span>an <span class="_ _42"> </span>error <span class="_ _42"> </span>with<span class="_ _4b"> </span><span class="ff1a">errno<span class="_ _44"> </span></span>set <span class="_ _42"> </span>to<span class="_ _44"> </span><span class="ff1a">EIO<span class="_ _4b"> </span></span>(whose</div><div class="t m0 x32 h2a y281a ff19 fsf fc0 sc0 ls0 ws0">value is 5 on this system) in this situation.</div><div class="t m0 x3f h2a y281b ff19 fsf fc0 sc0 ls0 ws0">Finally<span class="_ _4"></span><span class="lsb5b">,n<span class="_ _43"></span><span class="ls0">ote <span class="_ _42"> </span>that <span class="_ _42"> </span>our <span class="_ _42"> </span>child <span class="_ _42"> </span>was <span class="_ _53"> </span>placed <span class="_ _42"> </span>in <span class="_ _42"> </span>a <span class="_ _42"> </span>background <span class="_ _42"> </span>process <span class="_ _42"> </span>group <span class="_ _23"> </span>when <span class="_ _53"> </span>the</span></span></div><div class="t m0 x32 h2a y281c ff19 fsf fc0 sc0 ls0 ws0">parent terminated, since the par<span class="_ _0"></span>ent was executed as a for<span class="_ _0"></span>eground job by the shell.</div><div class="t m0 x3f h4d y281d ff19 fs26 fc0 sc0 ls164 ws0">We<span class="_ _9"></span><span class="ls0">’ll <span class="_ _2"></span>see <span class="_ _3"></span>another <span class="_ _3"></span>example <span class="_ _2"></span>of <span class="_ _3"></span>orphaned <span class="_ _2"></span>process <span class="_ _2"></span>groups <span class="_ _2"></span>in <span class="_ _3"></span>Section <span class="_ _2"></span>19.5 <span class="_ _3"></span>with <span class="_ _3"></span>the<span class="_ _47"> </span><span class="ff1a">pty</span></span></div><div class="t m0 x32 h49 y281e ff19 fs26 fc0 sc0 ls0 ws0">program.</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
