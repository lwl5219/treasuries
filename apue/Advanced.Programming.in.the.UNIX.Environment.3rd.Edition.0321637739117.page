<div id="pf75" class="pf w4 h1f" data-page-no="75"><div class="pc pc75 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg75.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h7a ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>3.14<span class="_ _177"> </span><span class="ff1a">fcntl<span class="_ _4b"> </span></span>Function<span class="_ _1b"> </span><span class="ff18">83</span></div><div class="t m0 x38 h51 y2a3 ff19 fs2a fc0 sc0 ls0 ws0">Be <span class="_ _9"></span>awar<span class="ls412">et<span class="_ _8"></span><span class="ls0">hat <span class="_ _9"></span>some <span class="_ _9"></span>existing <span class="_ _9"></span>programs <span class="_ _3"></span>that <span class="_ _9"></span>deal <span class="_ _9"></span>with <span class="_ _9"></span>the <span class="_ _9"></span>ﬁle <span class="_ _9"></span>descriptor <span class="_ _9"></span>ﬂags <span class="_ _3"></span>don’t</span></span></div><div class="t m0 x38 h52 y2a4 ff19 fs2a fc0 sc0 ls0 ws0">use the constant<span class="_ _e"> </span><span class="ff1a">FD_CLOEXEC</span><span class="ls413">.I<span class="_ _43"></span><span class="ls0">nstead, these <span class="_ _2"></span>programs set the ﬂag <span class="_ _2"></span>to either 0 <span class="_ _2"></span>(don’t</span></span></div><div class="t m0 x38 h51 y2a5 ff19 fs2a fc0 sc0 ls0 ws0">close-on-exec, the default) or 1 (do close-on-exec).</div><div class="t m0 x32 h26 ycc3 ff1a fsf fc0 sc0 ls0 ws0">F_GETFL<span class="_ _1b"> </span><span class="ff19">Return the ﬁle status ﬂags for<span class="_"> </span><span class="ff1b">fd<span class="_"> </span></span>as <span class="_ _2"></span>the value of the function.<span class="_ _46"> </span><span class="ls5f">We <span class="_ _53"> </span>d<span class="_ _23"></span></span>escribed</span></div><div class="t m0 x13f h26 ycc4 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _2"></span>ﬁle <span class="_ _3"></span>status <span class="_ _2"></span>ﬂags <span class="_ _2"></span>when <span class="_ _3"></span>we <span class="_ _2"></span>described <span class="_ _3"></span>the<span class="_ _47"> </span><span class="ff1a">open<span class="_ _66"> </span></span>function. <span class="_ _47"> </span>They<span class="_ _47"> </span>ar<span class="ls414">el<span class="_ _8"></span><span class="ls0">isted</span></span></div><div class="t m0 x13f h2a ycc5 ff19 fsf fc0 sc0 ls0 ws0">in Figur<span class="ls44">e3<span class="_ _4f"></span><span class="ls0">.10.</span></span></div><div class="t m0 x4 h2d ycc6 ff19 fs10 fc0 sc0 ls0 ws0">File status ﬂag<span class="_ _178"> </span>Description</div><div class="t m0 x4 h4f ycc7 ff1a fs11 fc0 sc0 ls0 ws0">O_RDONLY<span class="_ _18"> </span><span class="ff19">open for reading only</span></div><div class="t m0 x4 h4f ycc8 ff1a fs11 fc0 sc0 ls0 ws0">O_WRONLY<span class="_ _18"> </span><span class="ff19">open for writing only</span></div><div class="t m0 x4 h4f ycc9 ff1a fs11 fc0 sc0 ls0 ws0">O_RDWR<span class="_ _2e"> </span><span class="ff19">open for reading and writing</span></div><div class="t m0 x4 h4f ycca ff1a fs11 fc0 sc0 ls0 ws0">O_EXEC<span class="_ _2e"> </span><span class="ff19">open for execute only</span></div><div class="t m0 x4 h4f yccb ff1a fs11 fc0 sc0 ls0 ws0">O_SEARCH<span class="_ _18"> </span><span class="ff19">open directory for searching only</span></div><div class="t m0 x4 h6d yccc ff1a fs12 fc0 sc0 ls0 ws0">O_APPEND<span class="_ _18"> </span><span class="ff19">append on each write</span></div><div class="t m0 x4 h6d yccd ff1a fs12 fc0 sc0 ls0 ws0">O_NONBLOCK<span class="_ _179"> </span><span class="ff19">nonblocking mode</span></div><div class="t m0 x4 h6d ycce ff1a fs12 fc0 sc0 ls0 ws0">O_SYNC<span class="_ _2e"> </span><span class="ff19">wait for writes to complete (data and attributes)</span></div><div class="t m0 x4 h6d yccf ff1a fs12 fc0 sc0 ls0 ws0">O_DSYNC<span class="_ _171"> </span><span class="ff19">wait for writes to complete (data only)</span></div><div class="t m0 x4 h6d ycd0 ff1a fs12 fc0 sc0 ls0 ws0">O_RSYNC<span class="_ _171"> </span><span class="ff19">synchr<span class="_ _0"></span>onize reads and writes</span></div><div class="t m0 x4 h6d ycd1 ff1a fs12 fc0 sc0 ls0 ws0">O_FSYNC<span class="_ _171"> </span><span class="ff19">wait for writes to complete (Fr<span class="_ _0"></span>eeBSD and Mac OS X only)</span></div><div class="t m0 x4 h6d ycd2 ff1a fs12 fc0 sc0 ls0 ws0">O_ASYNC<span class="_ _171"> </span><span class="ff19">asynchr<span class="_ _0"></span>onous I/O (FreeBSD and Mac OS X only)</span></div><div class="t m0 xc1 h63 ycd3 ff18 fs13 fc0 sc0 ls0 ws0">Figure 3.10<span class="_ _5a"> </span><span class="ff19">File status ﬂags for<span class="_"> </span><span class="ff1a">fcntl</span></span></div><div class="t m0 x13f h64 ycd4 ff19 fs31 fc0 sc0 ls0 ws0">Unfortunately<span class="_ _4"></span><span class="ls415">,t<span class="_ _4d"></span><span class="ls0">he <span class="_ _51"> </span>ﬁve <span class="_ _65"> </span>access-mode <span class="_ _54"> </span>ﬂags<span class="_ _9"></span>—<span class="_ _9"></span><span class="ff1a">O_RDONLY</span>,<span class="_ _93"> </span><span class="ff1a">O_WRONLY</span>,</span></span></div><div class="t m0 x13f h64 ycd5 ff1a fs31 fc0 sc0 ls0 ws0">O_RDWR<span class="ff19">,<span class="_ _5a"> </span></span>O_EXEC<span class="ff19 ls416">,a<span class="_ _26"></span><span class="ls0">nd<span class="_ _5a"> </span><span class="ff1a">O_SEARCH<span class="_ _9"></span></span><span class="ls417">—a<span class="_ _6"></span><span class="ls225">re <span class="_ _35"> </span>n<span class="_ _2"></span><span class="ls0">ot <span class="_ _45"> </span>separate <span class="_ _45"> </span>bits <span class="_ _47"> </span>that <span class="_ _45"> </span>can <span class="_ _45"> </span>be</span></span></span></span></span></div><div class="t m0 x13f h6e ycd6 ff19 fs31 fc0 sc0 ls0 ws0">tested. <span class="_ _66"> </span>(As<span class="_ _47"> </span>we <span class="_ _2"></span>mentioned <span class="_ _2"></span>earlier<span class="_ _1"></span><span class="ls418">,t<span class="_ _4f"></span><span class="ls0">he <span class="_ _2"></span>ﬁrst <span class="_ _3"></span>three often <span class="_ _3"></span>have <span class="_ _2"></span>the <span class="_ _2"></span>values <span class="_ _3"></span>0, <span class="_ _2"></span>1,</span></span></div><div class="t m0 x13f h6e ycd7 ff19 fs31 fc0 sc0 ls0 ws0">and <span class="_ _47"> </span>2, <span class="_ _47"> </span>respectively<span class="_ _4"></span><span class="ls419">,f<span class="_ _1d"></span><span class="ls0">or <span class="_ _47"> </span>historical <span class="_ _47"> </span>reasons. <span class="_ _46"> </span>Also,<span class="_ _16"> </span>these <span class="_ _47"> </span>ﬁve <span class="_ _47"> </span>values <span class="_ _47"> </span>are</span></span></div><div class="t m0 x13f h6e ycd8 ff19 fs31 fc0 sc0 ls0 ws0">mutually <span class="_ _3"></span>exclusive; <span class="_ _9"></span>a <span class="_ _3"></span>ﬁle <span class="_ _9"></span>can <span class="_ _3"></span>have <span class="_ _9"></span>only <span class="_ _3"></span>one <span class="_ _9"></span>of <span class="_ _3"></span>them <span class="_ _9"></span>enabled.)<span class="_ _16"> </span>Therefore,</div><div class="t m0 x13f h64 ycd9 ff19 fs31 fc0 sc0 ls0 ws0">we must ﬁrst <span class="_ _2"></span>use the<span class="_ _66"> </span><span class="ff1a">O_ACCMODE<span class="_ _66"> </span></span>mask to <span class="_ _2"></span>obtain the <span class="_ _2"></span>access-mode bits and</div><div class="t m0 x13f h6e ycda ff19 fs31 fc0 sc0 ls0 ws0">then compar<span class="ls229">et<span class="_ _4f"></span><span class="ls0">he result against any of the ﬁve values.</span></span></div><div class="t m0 x32 h64 ycdb ff1a fs31 fc0 sc0 ls0 ws0">F_SETFL<span class="_ _1b"> </span><span class="ff19">Set <span class="_ _42"> </span>the <span class="_ _53"> </span>ﬁle <span class="_ _53"> </span>status <span class="_ _53"> </span>ﬂags <span class="_ _53"> </span>to <span class="_ _53"> </span>the <span class="_ _53"> </span>value <span class="_ _42"> </span>of <span class="_ _53"> </span>the <span class="_ _53"> </span>thir<span class="ls41a">da<span class="_ _c"></span><span class="ls225">rg<span class="_ _2"></span><span class="ls0">ument <span class="_ _42"> </span>(taken <span class="_ _53"> </span>as <span class="_ _53"> </span>an</span></span></span></span></div><div class="t m0 x13f h64 ycdc ff19 fs31 fc0 sc0 ls0 ws0">integer). <span class="_"> </span>The<span class="_"> </span>only <span class="_ _2"></span>ﬂags that <span class="_ _2"></span>can be <span class="_ _2"></span>changed are<span class="_"> </span><span class="ff1a">O_APPEND</span>,<span class="_"> </span><span class="ff1a">O_NONBLOCK</span>,</div><div class="t m0 x13f h64 ycdd ff1a fs31 fc0 sc0 ls0 ws0">O_SYNC<span class="ff19">,<span class="_"> </span></span>O_DSYNC<span class="ff19">,<span class="_"> </span></span>O_RSYNC<span class="ff19">,<span class="_"> </span></span>O_FSYNC<span class="ff19 ls229">,a<span class="_ _d"></span><span class="ls0">nd<span class="_"> </span><span class="ff1a">O_ASYNC</span>.</span></span></div><div class="t m0 x32 h64 ycde ff1a fs31 fc0 sc0 ls0 ws0">F_GETOWN<span class="_ _6e"> </span><span class="ff19">Get <span class="_ _2"></span>the <span class="_ _2"></span>process <span class="_ _2"></span>ID <span class="_ _2"></span>or <span class="_ _2"></span>process <span class="_ _2"></span>group <span class="_ _2"></span>ID <span class="_ _2"></span>currently receiving <span class="_ _2"></span>the<span class="_ _47"> </span></span>SIGIO<span class="_ _66"> </span><span class="ff19">and</span></div><div class="t m0 x13f h64 ycdf ff1a fs31 fc0 sc0 ls0 ws0">SIGURG<span class="_ _5f"> </span><span class="ff19">signals. <span class="_ _5c"> </span>W<span class="_ _4"></span><span class="ls41b">ed<span class="_ _56"></span><span class="ls0">escribe <span class="_ _5a"> </span>these <span class="_ _5a"> </span>asynchronous <span class="_ _16"> </span>I/O <span class="_ _5a"> </span>signals <span class="_ _16"> </span>in</span></span></span></div><div class="t m0 x13f h6e yce0 ff19 fs31 fc0 sc0 ls0 ws0">Section 14.5.2.</div><div class="t m0 x32 h64 yce1 ff1a fs31 fc0 sc0 ls0 ws0">F_SETOWN<span class="_ _6e"> </span><span class="ff19">Set <span class="_ _3"></span>the <span class="_ _9"></span>process <span class="_ _3"></span>ID <span class="_ _9"></span>or <span class="_ _3"></span>process <span class="_ _3"></span>group <span class="_ _3"></span>ID <span class="_ _9"></span>to <span class="_ _3"></span>receive <span class="_ _9"></span>the<span class="_ _47"> </span></span>SIGIO<span class="_ _45"> </span><span class="ff19">and<span class="_ _47"> </span></span>SIGURG</div><div class="t m0 x13f h79 yce2 ff19 fs31 fc0 sc0 ls0 ws0">signals. <span class="_ _44"> </span>A<span class="_ _44"> </span>positive<span class="_ _44"> </span><span class="ff1b">arg<span class="_ _44"> </span></span>speciﬁes <span class="_ _42"> </span>a <span class="_ _42"> </span>process <span class="_ _42"> </span>ID.<span class="_ _65"> </span><span class="ls41c">An<span class="_ _c"></span><span class="ls0">egative<span class="_ _44"> </span><span class="ff1b">arg<span class="_ _44"> </span></span>implies <span class="_ _42"> </span>a</span></span></div><div class="t m0 x13f h79 yce3 ff19 fs31 fc0 sc0 ls0 ws0">process gr<span class="_ _0"></span>oup ID equal to the absolute value of<span class="_"> </span><span class="ff1b">ar<span class="_ _0"></span>g<span class="ff19">.</span></span></div><div class="t m0 x3f h64 yce4 ff19 fs31 fc0 sc0 ls0 ws0">The <span class="_ _3"></span>return <span class="_ _3"></span>value <span class="_ _9"></span>from<span class="_ _47"> </span><span class="ff1a">fcntl<span class="_ _45"> </span></span>depends <span class="_ _9"></span>on <span class="_ _3"></span>the <span class="_ _9"></span>command.<span class="_ _5a"> </span>All <span class="_ _3"></span>commands <span class="_ _9"></span>return<span class="_ _47"> </span><span class="ff20">−</span>1</div><div class="t m0 x32 h6e yce5 ff19 fs31 fc0 sc0 ls0 ws0">on <span class="_ _53"> </span>an <span class="_ _53"> </span>error <span class="_ _42"> </span>or <span class="_ _53"> </span>some <span class="_ _e"> </span>other <span class="_ _53"> </span>value <span class="_ _53"> </span>if <span class="_ _53"> </span>OK.<span class="_ _65"> </span>The <span class="_ _53"> </span>following <span class="_ _53"> </span>four <span class="_ _53"> </span>commands <span class="_ _53"> </span>have <span class="_ _53"> </span>special</div><div class="t m0 x32 h64 yce6 ff19 fs31 fc0 sc0 ls225 ws0">re<span class="ls0">turn <span class="_ _47"> </span>values:<span class="_ _16"> </span><span class="ff1a">F_DUPFD</span>,<span class="_ _61"> </span><span class="ff1a">F_GETFD</span>,<span class="_ _16"> </span><span class="ff1a">F_GETFL</span><span class="ls41d">,a<span class="_ _1d"></span><span class="ls0">nd<span class="_ _16"> </span><span class="ff1a">F_GETOWN</span><span class="ls41e">.T<span class="_ _49"></span><span class="ls0">he <span class="_ _66"> </span>ﬁrst <span class="_ _47"> </span>command</span></span></span></span></span></div><div class="t m0 x32 h6e yce7 ff19 fs31 fc0 sc0 ls225 ws0">re<span class="ls0">turns <span class="_ _53"> </span>the <span class="_ _53"> </span>new <span class="_ _42"> </span>ﬁle <span class="_ _53"> </span>descriptor<span class="_ _6"></span><span class="ls41f">,t<span class="_ _43"></span><span class="ls0">he <span class="_ _42"> </span>next <span class="_ _53"> </span>two <span class="_ _42"> </span>return <span class="_ _42"> </span>the <span class="_ _53"> </span>corresponding <span class="_ _42"> </span>ﬂags, <span class="_ _42"> </span>and <span class="_ _53"> </span>the</span></span></span></div><div class="t m0 x32 h6e yce8 ff19 fs31 fc0 sc0 ls0 ws0">ﬁnal command returns a positive pr<span class="_ _0"></span>ocess ID or a negative pr<span class="_ _0"></span>ocess group ID.</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
