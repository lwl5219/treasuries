<div id="pf182" class="pf w4 h1f" data-page-no="182"><div class="pc pc182 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg182.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">352<span class="_ _1b"> </span><span class="ff19">Signals <span class="_ _24b"> </span>Chapter<span class="_ _21"> </span>10</span></div><div class="t m0 x3f h2a y12f ff19 fsf fc0 sc0 ls0 ws0">Normally<span class="_ _4"></span><span class="ls44">,t<span class="_ _5"></span><span class="ls0">he signal handler is called as</span></span></div><div class="t m0 x3f h57 ya9b ff1a fs2d fc0 sc0 ls0 ws0">void handler(int<span class="_"> </span><span class="ff1b">signo</span>);</div><div class="t m0 x32 h26 y22a6 ff19 fsf fc0 sc0 ls0 ws0">but if the<span class="_"> </span><span class="ff1a">SA_SIGINFO<span class="_ _80"> </span></span>ﬂag is set, the signal handler is called as</div><div class="t m0 x3f h57 y2cfb ff1a fs2d fc0 sc0 ls0 ws0">void handler(int<span class="_"> </span><span class="ff1b">signo</span><span class="ls15c">,s<span class="_ _1d"></span><span class="ls0">iginfo_t *<span class="ff1b">info</span><span class="ls15c">,v<span class="_ _5b"></span><span class="ls0">oid *<span class="ff1b">context</span>);</span></span></span></span></div><div class="t m0 x3f h26 y2cfc ff19 fsf fc0 sc0 ls0 ws0">The<span class="_ _45"> </span><span class="ff1a">siginfo<span class="_ _45"> </span></span>structur<span class="lscb4">ec<span class="_ _b"></span><span class="ls0">ontains <span class="_ _3"></span>information <span class="_ _23"></span>about <span class="_ _9"></span>why <span class="_ _9"></span>the <span class="_ _9"></span>signal <span class="_ _23"></span>was <span class="_ _9"></span>generated.</span></span></div><div class="t m0 x32 h2a y2cfd ff19 fsf fc0 sc0 ls0 ws0">An <span class="_ _45"> </span>example <span class="_ _35"> </span>of <span class="_ _35"> </span>what <span class="_ _45"> </span>it <span class="_ _35"> </span>might <span class="_ _45"> </span>look <span class="_ _35"> </span>like <span class="_ _45"> </span>is <span class="_ _35"> </span>shown <span class="_ _45"> </span>below<span class="_ _6"></span><span class="lscb5">.A<span class="_ _95"></span><span class="ls0">ll <span class="_ _45"> </span>POSIX.1-compliant</span></span></div><div class="t m0 x32 h26 y2cfe ff19 fsf fc0 sc0 ls0 ws0">implementations <span class="_ _59"> </span>must <span class="_ _46"> </span>include <span class="_ _59"> </span>at <span class="_ _46"> </span>least <span class="_ _46"> </span>the<span class="_ _60"> </span><span class="ff1a">si_signo<span class="_ _60"> </span></span>and<span class="_ _60"> </span><span class="ff1a">si_code<span class="_ _48"> </span></span>members.</div><div class="t m0 x32 h2a y2cff ff19 fsf fc0 sc0 ls0 ws0">Additionally<span class="_ _4"></span><span class="lscb6">,i<span class="_ _55"></span><span class="ls0">mplementations <span class="_"> </span>that <span class="_ _e"> </span>ar<span class="lscb6">eX<span class="_ _4a"></span><span class="ls0">SI <span class="_"> </span>compliant <span class="_ _e"> </span>contain <span class="_"> </span>at <span class="_"> </span>least <span class="_ _e"> </span>the <span class="_"> </span>following</span></span></span></span></div><div class="t m0 x32 h2a y2d00 ff19 fsf fc0 sc0 ls0 ws0">ﬁelds:</div><div class="t m0 x3f h57 y2d01 ff1a fs2d fc0 sc0 ls0 ws0">struct siginfo {</div><div class="t m0 xf4 h57 y2d02 ff1a fs2d fc0 sc0 ls0 ws0">int <span class="_ _176"> </span>si_signo;<span class="_ _d9"> </span>/* signal number */</div><div class="t m0 xf4 h57 y2d03 ff1a fs2d fc0 sc0 ls0 ws0">int <span class="_ _176"> </span>si_errno;<span class="_ _d9"> </span>/* if nonzero, errno value from errno.h */</div><div class="t m0 xf4 h57 y2d04 ff1a fs2d fc0 sc0 ls0 ws0">int <span class="_ _176"> </span>si_code;<span class="_ _68"> </span>/* additional info (depends on signal) */</div><div class="t m0 xf4 h57 y2d05 ff1a fs2d fc0 sc0 ls0 ws0">pid_t <span class="_ _b7"> </span>si_pid;<span class="_ _15"> </span>/* sending process ID */</div><div class="t m0 xf4 h57 y2d06 ff1a fs2d fc0 sc0 ls0 ws0">uid_t <span class="_ _b7"> </span>si_uid;<span class="_ _15"> </span>/* sending process real user ID */</div><div class="t m0 xf4 h57 y2d07 ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _b7"> </span>*si_addr;<span class="_ _87"> </span>/* address that caused the fault */</div><div class="t m0 xf4 h57 y2d08 ff1a fs2d fc0 sc0 ls0 ws0">int <span class="_ _176"> </span>si_status;<span class="_"> </span>/* exit value or signal number */</div><div class="t m0 xf4 h57 y2d09 ff1a fs2d fc0 sc0 ls0 ws0">union sigval si_value;<span class="_ _d9"> </span>/* application-specific value */</div><div class="t m0 xf4 h57 y2d0a ff1a fs2d fc0 sc0 ls0 ws0">/* possibly other fields also */</div><div class="t m0 x3f h57 y2d0b ff1a fs2d fc0 sc0 ls0 ws0">};</div><div class="t m0 x32 h26 y2d0c ff19 fsf fc0 sc0 ls0 ws0">The<span class="_"> </span><span class="ff1a">sigval<span class="_ _80"> </span></span>union contains the following ﬁelds:</div><div class="t m0 xf4 h57 y2d0d ff1a fs2d fc0 sc0 ls0 ws0">int <span class="_ _d9"> </span>sival_int;</div><div class="t m0 xf4 h57 y2d0e ff1a fs2d fc0 sc0 ls0 ws0">void *sival_ptr;</div><div class="t m0 x32 h26 y2d0f ff19 fsf fc0 sc0 ls0 ws0">Applications pass <span class="_ _2"></span>an integer <span class="_ _2"></span>value in<span class="_"> </span><span class="ff1a">si_value.sival_int<span class="_ _66"> </span></span>or <span class="_ _2"></span>pass a <span class="_ _2"></span>pointer value <span class="_ _2"></span>in</div><div class="t m0 x32 h26 y2d10 ff1a fsf fc0 sc0 ls0 ws0">si_value.sival_ptr<span class="_ _80"> </span><span class="ff19">when delivering signals.</span></div><div class="t m0 x3f h26 y2d11 ff19 fsf fc0 sc0 ls0 ws0">Figur<span class="lscb7">e1<span class="_ _b"></span><span class="ls0">0.17 <span class="_ _3"></span>shows <span class="_ _3"></span>values <span class="_ _3"></span>of<span class="_ _47"> </span><span class="ff1a">si_code<span class="_ _47"> </span></span>for <span class="_ _3"></span>various <span class="_ _3"></span>signals, <span class="_ _3"></span>as <span class="_ _3"></span>deﬁned <span class="_ _3"></span>by <span class="_ _3"></span>the <span class="_ _3"></span>Single</span></span></div><div class="t m0 x32 h2a y2d12 ff19 fsf fc0 sc0 ls0 ws0">UNIX Speciﬁcation.<span class="_ _59"> </span>Note that implementations may deﬁne additional code values.</div><div class="t m0 x3f h26 y2d13 ff19 fsf fc0 sc0 ls0 ws0">If <span class="_ _3"></span>the <span class="_ _3"></span>signal <span class="_ _3"></span>is<span class="_ _45"> </span><span class="ff1a">SIGCHLD</span><span class="lscb8">,t<span class="_ _b"></span><span class="ls0">hen <span class="_ _9"></span>the<span class="_ _47"> </span><span class="ff1a">si_pid</span>,<span class="_ _47"> </span><span class="ff1a">si_status</span><span class="lscb9">,a<span class="_ _4f"></span><span class="ls0">nd<span class="_ _47"> </span><span class="ff1a">si_uid<span class="_ _47"> </span></span>ﬁelds <span class="_ _9"></span>will <span class="_ _3"></span>be</span></span></span></span></div><div class="t m0 x32 h26 y2d14 ff19 fsf fc0 sc0 ls0 ws0">set. <span class="_ _66"> </span>If<span class="_ _47"> </span>the <span class="_ _2"></span>signal <span class="_ _2"></span>is<span class="_ _47"> </span><span class="ff1a">SIGBUS</span>,<span class="_ _66"> </span><span class="ff1a">SIGILL</span>,<span class="_ _47"> </span><span class="ff1a">SIGFPE</span><span class="lsc39">,o<span class="_ _8"></span><span class="ls0">r<span class="_ _47"> </span><span class="ff1a">SIGSEGV</span><span class="lsc39">,t<span class="_ _4f"></span><span class="ls0">hen <span class="_ _2"></span>the<span class="_ _47"> </span><span class="ff1a">si_addr<span class="_ _66"> </span></span>contains</span></span></span></span></div><div class="t m0 x32 h2a y2d15 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _9"></span>address <span class="_ _3"></span>responsible <span class="_ _9"></span>for <span class="_ _9"></span>the <span class="_ _9"></span>fault, <span class="_ _9"></span>although <span class="_ _23"></span>the <span class="_ _3"></span>address <span class="_ _9"></span>might <span class="_ _9"></span>not <span class="_ _9"></span>be <span class="_ _9"></span>accurate.<span class="_ _5a"> </span>The</div><div class="t m0 x32 h26 y2d16 ff1a fsf fc0 sc0 ls0 ws0">si_errno<span class="_ _45"> </span><span class="ff19">ﬁeld <span class="_ _9"></span>contains <span class="_ _9"></span>the <span class="_ _9"></span>error <span class="_ _9"></span>number <span class="_ _9"></span>corresponding <span class="_ _9"></span>to <span class="_ _9"></span>the <span class="_ _9"></span>condition <span class="_ _9"></span>that <span class="_ _23"></span>caused</span></div><div class="t m0 x32 h2a y2d17 ff19 fsf fc0 sc0 ls0 ws0">the signal to be generated, although its use is implementation deﬁned.</div><div class="t m0 x3f h2b y2d18 ff19 fsf fc0 sc0 ls0 ws0">The<span class="_ _66"> </span><span class="ff1b">context<span class="_ _47"> </span></span>argument to <span class="_ _3"></span>the <span class="_ _2"></span>signal <span class="_ _2"></span>handler <span class="_ _2"></span>is <span class="_ _3"></span>a <span class="_ _2"></span>typeless <span class="_ _2"></span>pointer <span class="_ _3"></span>that <span class="_ _2"></span>can <span class="_ _2"></span>be <span class="_ _2"></span>cast <span class="_ _3"></span>to <span class="_ _2"></span>a</div><div class="t m0 x32 h26 y2d19 ff1a fsf fc0 sc0 ls0 ws0">ucontext_t<span class="_ _44"> </span><span class="ff19">structur<span class="ls1f1">ei<span class="_ _55"></span><span class="ls0">dentifying <span class="_ _53"> </span>the <span class="_ _53"> </span>process <span class="_ _42"> </span>context <span class="_ _53"> </span>at <span class="_ _53"> </span>the <span class="_ _53"> </span>time <span class="_ _53"> </span>of <span class="_ _53"> </span>signal <span class="_ _53"> </span>delivery<span class="_ _6"></span>.</span></span></span></div><div class="t m0 x32 h2a y2d1a ff19 fsf fc0 sc0 ls0 ws0">This structur<span class="_ _0"></span><span class="ls44">ec<span class="_ _d"></span><span class="ls0">ontains at least the following ﬁelds:</span></span></div><div class="t m0 x3f h57 y2d1b ff1a fs2d fc0 sc0 ls0 ws0">ucontext_t *uc_link;<span class="_ _8a"> </span>/* pointer to context resumed when */</div><div class="t m0 x10 h57 y2d1c ff1a fs2d fc0 sc0 ls0 ws0">/* this context returns */</div><div class="t m0 x3f h57 y2d1d ff1a fs2d fc0 sc0 ls0 ws0">sigset_t <span class="_ _68"> </span>uc_sigmask;<span class="_ _3a"> </span>/* signals blocked when this context */</div><div class="t m0 x10 h57 y2d1e ff1a fs2d fc0 sc0 ls0 ws0">/* is active */</div><div class="t m0 x3f h57 y2d1f ff1a fs2d fc0 sc0 ls0 ws0">stack_t <span class="_ _15"> </span>uc_stack;<span class="_ _15"> </span>/* stack used by this context */</div><div class="t m0 x3f h57 y2d20 ff1a fs2d fc0 sc0 ls0 ws0">mcontext_t <span class="_"> </span>uc_mcontext;<span class="_"> </span>/* machine-specific representation of */</div><div class="t m0 x10 h57 y2d21 ff1a fs2d fc0 sc0 ls0 ws0">/* saved context */</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
