<div id="pf149" class="pf w4 h1f" data-page-no="149"><div class="pc pc149 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg149.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>9.5<span class="_ _1c8"> </span>Sessions<span class="_ _1b"> </span><span class="ff18">295</span></div><div class="t m0 x35 h53 y12f ff16 fs2b fc0 sc0 ls0 ws0">9.5 <span class="_ _68"> </span>Sessions</div><div class="t m0 x32 h2a y4de ff19 fsf fc0 sc0 lsb18 ws0">As<span class="_ _d"></span><span class="ls0">ession is a <span class="_ _2"></span>collection of one <span class="_ _2"></span>or mor<span class="ls57c">ep<span class="_ _d"></span><span class="ls45">ro<span class="ls0">cess <span class="_ _2"></span>groups. <span class="_"> </span>For<span class="_"> </span>example, we <span class="_ _2"></span>could have the</span></span></span></span></div><div class="t m0 x32 h2a y6d0 ff19 fsf fc0 sc0 ls0 ws0">arrangement <span class="_"> </span>shown <span class="_"> </span>in <span class="_ _66"> </span>Figur<span class="lsb19">e9<span class="_ _5b"></span><span class="ls0">.6. <span class="_ _46"> </span>Here<span class="_ _46"> </span>we<span class="_ _46"> </span>have <span class="_"> </span>three <span class="_"> </span>process <span class="_"> </span>groups <span class="_"> </span>in <span class="_"> </span>a <span class="_"> </span>single</span></span></div><div class="t m0 x32 h2a y6d1 ff19 fsf fc0 sc0 ls0 ws0">session.</div><div class="t m0 x2d h2d y2607 ff19 fs10 fc0 sc0 ls0 ws0">login shell</div><div class="t m0 xc0 h4f y2608 ff1a fs11 fc0 sc0 ls0 ws0">proc1</div><div class="t m0 x10a h6d y2609 ff1a fs12 fc0 sc0 ls0 ws0">proc2</div><div class="t m0 x1db h63 y260a ff1a fs13 fc0 sc0 ls0 ws0">proc3</div><div class="t m0 x120 h6f y260b ff1a fs14 fc0 sc0 ls0 ws0">proc4</div><div class="t m0 x44 h66 y260c ff1a fs15 fc0 sc0 ls0 ws0">proc5</div><div class="t m0 x183 h33 y260d ff19 fs16 fc0 sc0 ls0 ws0">process gr<span class="_ _0"></span>oup</div><div class="t m0 x4a h83 y260e ff19 fs36 fc0 sc0 ls0 ws0">process gr<span class="_ _0"></span>oup</div><div class="t m0 x1 h34 y260f ff19 fs17 fc0 sc0 ls0 ws0">process gr<span class="_ _0"></span>oup</div><div class="t m0 xde h69 y2610 ff19 fs34 fc0 sc0 ls0 ws0">session</div><div class="t m0 x206 h35 y2611 ff18 fs18 fc0 sc0 ls0 ws0">Figure 9.6<span class="_ _5a"> </span><span class="ff19">Arrangement of processes into process gr<span class="_ _0"></span>oups and sessions</span></div><div class="t m0 x32 h69 y2612 ff19 fs34 fc0 sc0 ls0 ws0">The <span class="_"> </span>pr<span class="_ _1"></span>ocesses <span class="_"> </span>in <span class="_"> </span>a <span class="_ _e"> </span>process <span class="_ _e"> </span>group <span class="_ _e"> </span>ar<span class="lsb1a">eu<span class="_ _4a"></span><span class="ls0">sually <span class="_"> </span>placed <span class="_ _e"> </span>there<span class="_ _4b"> </span>by<span class="_ _59"> </span>a<span class="_ _59"> </span>s<span class="_ _2"></span>hell <span class="_"> </span>pipeline.<span class="_ _65"> </span>For</span></span></div><div class="t m0 x32 h69 y2613 ff19 fs34 fc0 sc0 ls0 ws0">example, <span class="_ _e"> </span>the <span class="_"> </span>arrangement <span class="_ _e"> </span>shown <span class="_"> </span>in <span class="_ _e"> </span>Figur<span class="lsb1b">e9<span class="_ _4a"></span><span class="ls0">.6 <span class="_"> </span>could <span class="_ _53"> </span>have <span class="_"> </span>been <span class="_ _e"> </span>generated <span class="_"> </span>by <span class="_ _e"> </span>shell</span></span></div><div class="t m0 x32 h69 y2614 ff19 fs34 fc0 sc0 ls0 ws0">commands of the form</div><div class="t m0 x3f h110 y2615 ff1a fs92 fc0 sc0 ls0 ws0">proc1 | proc2 &amp;</div><div class="t m0 x3f h110 y2616 ff1a fs92 fc0 sc0 ls0 ws0">proc3 | proc4 | proc5</div><div class="t m0 x3f h6a y2617 ff19 fs34 fc0 sc0 ls66a ws0">Ap<span class="_ _d"></span><span class="ls1df">ro<span class="_ _2"></span><span class="ls0">cess establishes a new session by calling the<span class="_"> </span><span class="ff1a">setsid<span class="_ _80"> </span></span>function.</span></span></div><div class="t m0 x3f h110 y2618 ff1a fs92 fc0 sc0 ls0 ws0">#include &lt;unistd.h&gt;</div><div class="t m0 x3f h110 y2619 ff1a fs92 fc0 sc0 ls0 ws0">pid_t setsid(void);</div><div class="t m0 x115 h111 y261a ff19 fs92 fc0 sc0 ls0 ws0">Returns: process gr<span class="_ _0"></span>oup ID if OK,<span class="_"> </span><span class="ff20">−</span>1<span class="_"> </span>on<span class="_"> </span>error</div><div class="t m0 x32 h10c y261b ff19 fs91 fc0 sc0 ls0 ws0">If <span class="_ _9"></span>the <span class="_ _3"></span>calling <span class="_ _9"></span>process <span class="_ _3"></span>is <span class="_ _9"></span>not <span class="_ _9"></span>a <span class="_ _9"></span>process <span class="_ _3"></span>group <span class="_ _9"></span>leader<span class="_ _6"></span><span class="lsb1c">,t<span class="_ _8"></span><span class="ls0">his <span class="_ _9"></span>function <span class="_ _3"></span>creates <span class="_ _9"></span>a <span class="_ _9"></span>new <span class="_ _3"></span>session.</span></span></div><div class="t m0 x32 h10c y261c ff19 fs91 fc0 sc0 ls0 ws0">Three things happen.</div><div class="t m0 x3f h112 y261d ff19 fs91 fc0 sc0 ls0 ws0">1. <span class="_ _51"> </span>The<span class="_ _45"> </span>process <span class="_ _3"></span>becomes <span class="_ _9"></span>the<span class="_ _45"> </span><span class="ff1b">session <span class="_ _9"></span>leader<span class="_ _45"> </span></span>of <span class="_ _9"></span>this <span class="_ _9"></span>new <span class="_ _9"></span>session.<span class="_ _5a"> </span>(A <span class="_ _9"></span>session <span class="_ _9"></span>leader <span class="_ _9"></span>is</div><div class="t m0 x41 h10c y261e ff19 fs91 fc0 sc0 ls0 ws0">the <span class="_ _9"></span>process <span class="_ _9"></span>that <span class="_ _23"></span>cr<span class="_ _0"></span>eates <span class="_ _9"></span>a <span class="_ _23"></span>session.)<span class="_ _5a"> </span>The <span class="_ _9"></span>process <span class="_ _9"></span>is <span class="_ _23"></span>the <span class="_ _9"></span>only <span class="_ _23"></span>process <span class="_ _3"></span>in <span class="_ _23"></span>this <span class="_ _9"></span>new</div><div class="t m0 x41 h10c y261f ff19 fs91 fc0 sc0 ls0 ws0">session.</div><div class="t m0 x3f h10c y2620 ff19 fs91 fc0 sc0 ls0 ws0">2. <span class="_ _51"> </span>The<span class="_"> </span>process becomes the process group leader of a new <span class="_ _2"></span>process gr<span class="_ _0"></span>oup. <span class="_"> </span>The<span class="_"> </span>new</div><div class="t m0 x41 h10c y2621 ff19 fs91 fc0 sc0 ls0 ws0">process gr<span class="_ _0"></span>oup ID is the pr<span class="_ _0"></span>ocess ID of the calling process.</div><div class="t m0 x3f h10c y2622 ff19 fs91 fc0 sc0 ls0 ws0">3. <span class="_ _51"> </span>The<span class="_ _45"> </span>pr<span class="_ _0"></span>ocess <span class="_ _3"></span>has <span class="_ _9"></span>no <span class="_ _3"></span>controlling <span class="_ _3"></span>terminal.<span class="_ _5a"> </span>(W<span class="_ _6"></span>e’ll <span class="_ _3"></span>discuss <span class="_ _9"></span>controlling <span class="_ _3"></span>terminals <span class="_ _9"></span>in</div><div class="t m0 x41 h10c y2623 ff19 fs91 fc0 sc0 ls0 ws0">the <span class="_ _45"> </span>next <span class="_ _45"> </span>section.)<span class="_ _1a3"> </span>If <span class="_ _45"> </span>the <span class="_ _45"> </span>process <span class="_ _45"> </span>had <span class="_ _45"> </span>a <span class="_ _45"> </span>controlling <span class="_ _47"> </span>terminal <span class="_ _45"> </span>befor<span class="lsb1d">ec<span class="_ _26"></span><span class="ls0">alling</span></span></div><div class="t m0 x41 h10b y2624 ff1a fs91 fc0 sc0 ls0 ws0">setsid<span class="ff19 lsaea">,t<span class="_ _d"></span><span class="ls0">hat association is broken.</span></span></div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.892409px;bottom:1236.288916px;width:88.691810px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
