<div id="pf8e" class="pf w4 h1f" data-page-no="8e"><div class="pc pc8e w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg8e.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">108<span class="_ _1b"> </span><span class="ff19">Files <span class="_"> </span>and <span class="_"> </span>Directories <span class="_ _18d"> </span>Chapter<span class="_ _4b"> </span>4</span></div><div class="t m0 x76 h52 y2a3 ff19 fs2a fc0 sc0 ls0 ws0">On <span class="_ _2"></span>Solaris, <span class="_ _3"></span>the<span class="_ _80"> </span><span class="ff1a">ls<span class="_ _80"> </span></span>command <span class="_ _3"></span>displays <span class="_ _2"></span>an<span class="_ _80"> </span><span class="ff1a">l<span class="_ _66"> </span></span>instead <span class="_ _2"></span>of <span class="_ _3"></span>an<span class="_ _80"> </span><span class="ff1a">S<span class="_ _80"> </span></span>to <span class="_ _3"></span>indicate <span class="_ _2"></span>that <span class="_ _3"></span>mandatory <span class="_ _2"></span>ﬁle <span class="_ _3"></span>and</div><div class="t m0 x76 h51 y2a4 ff19 fs2a fc0 sc0 ls34e ws0">re<span class="ls0">cor<span class="ls4d8">dl<span class="_ _8"></span><span class="ls0">ocking <span class="_ _23"> </span>has <span class="_ _9"></span>been <span class="_ _9"></span>enabled <span class="_ _9"></span>for <span class="_ _9"> </span>this <span class="_ _23"> </span>ﬁle.<span class="_ _59"> </span>This <span class="_ _9"></span>behavior <span class="_ _9"></span>applies <span class="_ _9"> </span>only <span class="_ _23"> </span>to <span class="_ _9"></span>regular <span class="_ _3"></span>ﬁles, <span class="_ _23"> </span>but</span></span></span></div><div class="t m0 x76 h51 y2a5 ff19 fs2a fc0 sc0 ls0 ws0">we’ll discuss this more<span class="_"> </span>in<span class="_"> </span>Section 14.3.</div><div class="t m0 x3f h26 yfab ff19 fsf fc0 sc0 ls0 ws0">Finally<span class="_ _4"></span><span class="ls4d9">,n<span class="_ _8"></span><span class="ls0">ote <span class="_ _9"></span>that <span class="_ _3"></span>the <span class="_ _3"></span>time <span class="_ _3"></span>and <span class="_ _3"></span>date <span class="_ _9"></span>listed <span class="_ _3"></span>by <span class="_ _3"></span>the<span class="_ _47"> </span><span class="ff1a">ls<span class="_ _45"> </span></span>command <span class="_ _2"></span>did <span class="_ _9"></span>not <span class="_ _3"></span>change <span class="_ _3"></span>after</span></span></div><div class="t m0 x32 h26 yfac ff19 fsf fc0 sc0 ls0 ws0">we <span class="_ _23"> </span>ran <span class="_ _23"> </span>the <span class="_ _42"> </span>program <span class="_ _9"></span>in <span class="_ _42"> </span>Figur<span class="ls4da">e4<span class="_ _43"></span><span class="ls0">.12. <span class="_ _35"> </span>W<span class="_ _6"></span>e’ll <span class="_ _23"></span>see <span class="_ _23"> </span>in <span class="_ _42"> </span>Section <span class="_ _23"></span>4.19 <span class="_ _23"> </span>that <span class="_ _23"> </span>the<span class="_ _44"> </span><span class="ff1a">chmod<span class="_ _35"> </span></span>function</span></span></div><div class="t m0 x32 h26 yfad ff19 fsf fc0 sc0 ls0 ws0">updates <span class="_ _3"></span>only <span class="_ _9"></span>the <span class="_ _3"></span>time <span class="_ _9"></span>that <span class="_ _3"></span>the <span class="_ _9"></span>i-node <span class="_ _3"></span>was <span class="_ _9"></span>last <span class="_ _3"></span>changed.<span class="_ _5a"> </span>By <span class="_ _3"></span>default, <span class="_ _3"></span>the<span class="_ _45"> </span><span class="ff1a">ls <span class="_ _d"></span>-l<span class="_ _47"> </span><span class="ff19">lists <span class="_ _9"></span>the</span></span></div><div class="t m0 x32 h2a yfae ff19 fsf fc0 sc0 ls0 ws0">time when the contents of the ﬁle wer<span class="ls44">el<span class="_ _4f"></span><span class="ls0">ast modiﬁed.</span></span></div><div class="t m0 x3f h4d yfaf ff19 fs26 fc0 sc0 ls0 ws0">The<span class="_ _46"> </span><span class="ff1a">chmod<span class="_ _46"> </span></span>functions <span class="_ _47"> </span>automatically <span class="_"> </span>clear <span class="_ _66"> </span>two <span class="_ _66"> </span>of <span class="_ _66"> </span>the <span class="_ _66"> </span>permission <span class="_ _66"> </span>bits <span class="_ _66"> </span>under <span class="_ _66"> </span>the</div><div class="t m0 x32 h49 yfb0 ff19 fs26 fc0 sc0 ls0 ws0">following conditions:</div><div class="t m0 x3f h49 yfb1 ff19 fs26 fc0 sc0 ls15d ws0">•O<span class="_ _4d"></span><span class="ls4db">ns<span class="_ _b"></span><span class="ls0">ystems, <span class="_ _9"></span>such <span class="_ _23"></span>as <span class="_ _9"></span>Solaris, <span class="_ _23"> </span>that <span class="_ _23"></span>place <span class="_ _9"></span>special <span class="_ _23"> </span>meaning <span class="_ _23"></span>on <span class="_ _23"></span>the <span class="_ _9"></span>sticky <span class="_ _23"> </span>bit <span class="_ _23"></span>when</span></span></div><div class="t m0 x15 h4d yfb2 ff19 fs26 fc0 sc0 ls0 ws0">used <span class="_ _2"></span>with <span class="_ _3"></span>regular <span class="_ _2"></span>ﬁles, <span class="_ _3"></span>if <span class="_ _3"></span>we <span class="_ _3"></span>try <span class="_ _3"></span>to <span class="_ _2"></span>set <span class="_ _3"></span>the <span class="_ _3"></span>sticky <span class="_ _3"></span>bit <span class="_ _3"></span>(<span class="ff1a">S_ISVTX</span>)<span class="_ _47"> </span>on<span class="_ _47"> </span>a<span class="_ _47"> </span>regular <span class="_ _2"></span>ﬁle</div><div class="t m0 x15 h4a yfb3 ff19 fs26 fc0 sc0 ls0 ws0">and <span class="_ _3"></span>do <span class="_ _3"></span>not <span class="_ _3"></span>have <span class="_ _3"></span>superuser <span class="_ _3"></span>privileges, <span class="_ _3"></span>the <span class="_ _3"></span>sticky <span class="_ _3"></span>bit <span class="_ _3"></span>in <span class="_ _3"></span>the<span class="_ _47"> </span><span class="ff1b">mode<span class="_ _45"> </span></span>is <span class="_ _2"></span>automatically</div><div class="t m0 x15 h49 yfb4 ff19 fs26 fc0 sc0 ls0 ws0">turned <span class="_ _2"></span>off. <span class="_"> </span>(W<span class="_ _6"></span><span class="ls4dc">ed<span class="_ _4f"></span><span class="ls0">escribe <span class="_ _2"></span>the <span class="_ _3"></span>sticky <span class="_ _2"></span>bit <span class="_ _2"></span>in <span class="_ _2"></span>the <span class="_ _2"></span>next <span class="_ _2"></span>section.)<span class="_ _61"> </span><span class="ls164">To <span class="_ _e"> </span>p<span class="_ _23"></span><span class="lscc">re</span></span>vent <span class="_ _2"></span>malicious</span></span></div><div class="t m0 x15 h49 yfb5 ff19 fs26 fc0 sc0 ls0 ws0">users <span class="_ _53"> </span>from <span class="_ _42"> </span>setting <span class="_ _53"> </span>the <span class="_ _53"> </span>sticky <span class="_ _53"> </span>bit <span class="_ _53"> </span>and <span class="_ _53"> </span>adversely <span class="_ _53"> </span>affecting <span class="_ _42"> </span>system <span class="_ _53"> </span>performance,</div><div class="t m0 x15 h49 yfb6 ff19 fs26 fc0 sc0 ls0 ws0">only the superuser can set the sticky bit of a r<span class="_ _0"></span>egular ﬁle.</div><div class="t m0 x76 h2d yfb7 ff19 fs10 fc0 sc0 ls0 ws0">In <span class="_"> </span>Fr<span class="_ _1"></span>eeBSD <span class="_"> </span>8.0 <span class="_"> </span>and <span class="_ _42"> </span>Solaris <span class="_ _42"> </span>10, <span class="_"> </span>only <span class="_ _42"> </span>the <span class="_"> </span>superuser <span class="_ _42"> </span>can <span class="_"> </span>set <span class="_ _42"> </span>the <span class="_"> </span>sticky <span class="_ _42"> </span>bit <span class="_"> </span>on <span class="_ _42"> </span>a <span class="_"> </span>r<span class="_ _0"></span>egular <span class="_ _42"> </span>ﬁle.</div><div class="t m0 x76 h2d yfb8 ff19 fs10 fc0 sc0 ls0 ws0">Linux 3.2.0<span class="_ _35"> </span>and <span class="_ _42"> </span>Mac <span class="_ _42"> </span>OS <span class="_"> </span>X <span class="_ _23"> </span>10.6.8 <span class="_"> </span>place <span class="_ _42"> </span>no <span class="_ _42"> </span>such <span class="_"> </span>r<span class="_ _0"></span>estriction <span class="_ _42"> </span>on <span class="_"> </span>the <span class="_ _23"> </span>setting <span class="_"> </span>of <span class="_ _42"> </span>the <span class="_ _42"> </span>sticky <span class="_"> </span>bit,</div><div class="t m0 x76 h2d yfb9 ff19 fs10 fc0 sc0 ls0 ws0">because <span class="_ _2"></span>the <span class="_ _3"></span>bit <span class="_ _3"></span>has <span class="_ _3"></span>no <span class="_ _3"></span>meaning <span class="_ _2"></span>when <span class="_ _3"></span>applied <span class="_ _3"></span>to <span class="_ _3"></span>regular <span class="_ _2"></span>ﬁles <span class="_ _3"></span>on <span class="_ _3"></span>these <span class="_ _3"></span>systems.<span class="_ _4b"> </span>Although <span class="_ _3"></span>the</div><div class="t m0 x76 h2d yfba ff19 fs10 fc0 sc0 ls0 ws0">bit <span class="_"> </span>also <span class="_ _80"> </span>has <span class="_"> </span>no <span class="_ _80"> </span>meaning <span class="_ _e"> </span>when <span class="_ _80"> </span>applied <span class="_ _e"> </span>to <span class="_ _80"> </span>regular <span class="_"> </span>ﬁles <span class="_ _80"> </span>on <span class="_"> </span>FreeBSD, <span class="_"> </span>everyone <span class="_ _80"> </span>except <span class="_ _e"> </span>the</div><div class="t m0 x76 h2d yfbb ff19 fs10 fc0 sc0 ls0 ws0">superuser is prevented fr<span class="_ _0"></span>om setting it on a regular ﬁle.</div><div class="t m0 x3f h49 yfbc ff19 fs26 fc0 sc0 ls15d ws0">•T<span class="_ _4d"></span><span class="ls0">he group ID of a newly created ﬁle might potentially be a group that the calling</span></div><div class="t m0 x15 h49 yfbd ff19 fs26 fc0 sc0 ls0 ws0">process <span class="_ _53"> </span>does <span class="_ _e"> </span>not <span class="_ _e"> </span>belong <span class="_ _e"> </span>to.<span class="_ _48"> </span>Recall <span class="_ _e"> </span>from <span class="_ _53"> </span>Section <span class="_ _e"> </span>4.6 <span class="_"> </span>that <span class="_ _53"> </span>it’s <span class="_ _e"> </span>possible <span class="_ _e"> </span>for <span class="_ _e"> </span>the</div><div class="t m0 x15 h49 yfbe ff19 fs26 fc0 sc0 ls0 ws0">group <span class="_ _2"></span>ID <span class="_ _3"></span>of <span class="_ _3"></span>the <span class="_ _3"></span>new <span class="_ _3"></span>ﬁle <span class="_ _9"></span>to <span class="_ _3"></span>be <span class="_ _3"></span>the <span class="_ _3"></span>group <span class="_ _2"></span>ID <span class="_ _3"></span>of <span class="_ _3"></span>the <span class="_ _3"></span>parent <span class="_ _3"></span>directory<span class="_ _4"></span><span class="ls4dd">.S<span class="_ _1d"></span><span class="ls0">peciﬁcally<span class="_ _4"></span>,</span></span></div><div class="t m0 x15 h49 yfbf ff19 fs26 fc0 sc0 ls0 ws0">if <span class="_ _2"></span>the <span class="_ _2"></span>group ID <span class="_ _2"></span>of <span class="_ _2"></span>the <span class="_ _2"></span>new <span class="_ _2"></span>ﬁle <span class="_ _2"></span>does <span class="_ _2"></span>not <span class="_ _2"></span>equal <span class="_ _2"></span>either <span class="_ _2"></span>the <span class="_ _2"></span>effective <span class="_ _2"></span>group ID <span class="_ _2"></span>of <span class="_ _2"></span>the</div><div class="t m0 x15 h49 yfc0 ff19 fs26 fc0 sc0 ls0 ws0">process or <span class="_ _2"></span>one <span class="_ _2"></span>of <span class="_ _2"></span>the <span class="_ _2"></span>process’s supplementary <span class="_ _2"></span>group <span class="_ _2"></span>IDs <span class="_ _2"></span>and <span class="_ _2"></span>if <span class="_ _2"></span>the <span class="_ _2"></span>process does</div><div class="t m0 x15 h49 yfc1 ff19 fs26 fc0 sc0 ls0 ws0">not <span class="_ _3"></span>have <span class="_ _3"></span>superuser <span class="_ _3"></span>privileges, <span class="_ _9"></span>then <span class="_ _3"></span>the <span class="_ _3"></span>set-group-ID <span class="_ _3"></span>bit <span class="_ _3"></span>is <span class="_ _9"></span>automatically <span class="_ _3"></span>turned</div><div class="t m0 x15 h49 yfc2 ff19 fs26 fc0 sc0 ls0 ws0">off. <span class="_"> </span>This<span class="_"> </span>pr<span class="_ _0"></span>events a user from cr<span class="_ _0"></span>eating a set-group-ID ﬁle owned by a group that</div><div class="t m0 x15 h49 yfc3 ff19 fs26 fc0 sc0 ls0 ws0">the user doesn’t belong to.</div><div class="t m0 x76 h2d yfc4 ff19 fs10 fc0 sc0 ls0 ws0">FreeBSD <span class="_ _9"></span>8.0 <span class="_ _23"> </span>fails <span class="_ _23"> </span>an <span class="_ _9"></span>attempt <span class="_ _23"> </span>to <span class="_ _23"> </span>set <span class="_ _9"> </span>the <span class="_ _23"> </span>set-group-ID <span class="_ _9"> </span>in <span class="_ _23"> </span>this <span class="_ _23"> </span>case.<span class="_ _46"> </span>The <span class="_ _23"> </span>other <span class="_ _9"> </span>systems <span class="_ _23"> </span>silently</div><div class="t m0 x76 h2d yfc5 ff19 fs10 fc0 sc0 ls0 ws0">turn the bit off, but don’t fail the attempt to change the ﬁle access permissions.</div><div class="t m0 x76 h2d yfc6 ff19 fs10 fc0 sc0 ls0 ws0">FreeBSD 8.0, <span class="_ _2"></span>Linux <span class="_ _2"></span>3.2.0, <span class="_ _2"></span>Mac <span class="_ _2"></span>OS <span class="_ _2"></span>X <span class="_ _2"></span>10.6.8, <span class="_ _2"></span>and <span class="_ _2"></span>Solaris <span class="_ _2"></span>10 <span class="_ _2"></span>add <span class="_ _2"></span>another <span class="_ _2"></span>security <span class="_ _2"></span>feature<span class="_"> </span>to<span class="_ _80"> </span>try <span class="_ _2"></span>to</div><div class="t m0 x76 h2d yfc7 ff19 fs10 fc0 sc0 ls0 ws0">prevent <span class="_ _42"> </span>misuse <span class="_"> </span>of <span class="_"> </span>some <span class="_ _42"> </span>of <span class="_"> </span>the <span class="_ _42"> </span>protection <span class="_"> </span>bits.<span class="_ _16"> </span>If <span class="_"> </span>a <span class="_"> </span>pr<span class="_ _1"></span>ocess <span class="_"> </span>that <span class="_"> </span>does <span class="_ _42"> </span>not <span class="_"> </span>have <span class="_"> </span>super<span class="_ _0"></span>user</div><div class="t m0 x76 h2d yfc8 ff19 fs10 fc0 sc0 ls0 ws0">privileges writes <span class="_ _2"></span>to <span class="_ _2"></span>a <span class="_ _2"></span>ﬁle, the <span class="_ _2"></span>set-user-ID and <span class="_ _2"></span>set-group-ID bits <span class="_ _2"></span>ar<span class="ls4de">ea<span class="_ _5"></span><span class="ls0">utomatically <span class="_ _2"></span>turned off. <span class="_ _e"> </span>If</span></span></div><div class="t m0 x76 h2d yfc9 ff19 fs10 fc0 sc0 ls0 ws0">malicious users ﬁnd a set-group-ID or a set-user-ID ﬁle they can write to, even though they can</div><div class="t m0 x76 h2d yfca ff19 fs10 fc0 sc0 ls0 ws0">modify the ﬁle, they lose the special privileges of the ﬁle.</div><div class="t m0 x35 h4b yfcb ff16 fs27 fc0 sc0 ls0 ws0">4.10 <span class="_ _93"> </span>Sticky <span class="_"> </span>Bit</div><div class="t m0 x32 h4d yfcc ff19 fs26 fc0 sc0 ls0 ws0">The<span class="_ _59"> </span><span class="ff1a">S_ISVTX<span class="_ _59"> </span></span>bit <span class="_"> </span>has <span class="_ _e"> </span>an <span class="_"> </span>interesting <span class="_ _e"> </span>history<span class="_ _4"></span><span class="ls4df">.O<span class="_ _64"></span><span class="ls4e0">nv<span class="_ _4a"></span><span class="ls0">ersions <span class="_"> </span>of <span class="_"> </span>the <span class="_ _e"> </span>UNIX <span class="_"> </span>System <span class="_ _e"> </span>that</span></span></span></div><div class="t m0 x32 h4a yfcd ff19 fs26 fc0 sc0 ls0 ws0">predated <span class="_ _53"> </span>demand <span class="_"> </span>paging, <span class="_ _e"> </span>this <span class="_ _e"> </span>bit <span class="_"> </span>was <span class="_ _53"> </span>known <span class="_"> </span>as <span class="_ _e"> </span>the<span class="_ _4b"> </span><span class="ff1b">sticky <span class="_"> </span>bit</span><span class="ls4e1">.I<span class="_ _5d"></span><span class="ls0">f<span class="_ _59"> </span>it<span class="_ _59"> </span>was <span class="_ _e"> </span>set <span class="_"> </span>for <span class="_ _53"> </span>an</span></span></div><div class="t m0 x32 h49 yfce ff19 fs26 fc0 sc0 ls0 ws0">executable <span class="_ _42"> </span>program <span class="_ _23"> </span>ﬁle, <span class="_ _42"> </span>then <span class="_ _42"> </span>the <span class="_ _42"> </span>ﬁrst <span class="_ _42"> </span>time <span class="_ _42"> </span>the <span class="_ _42"> </span>program <span class="_ _42"> </span>was <span class="_ _42"> </span>executed, <span class="_ _42"> </span>a <span class="_ _42"> </span>copy <span class="_ _42"> </span>of <span class="_ _42"> </span>the</div><div class="t m0 x32 h49 yfcf ff19 fs26 fc0 sc0 ls0 ws0">program’s <span class="_ _42"> </span>text <span class="_ _e"> </span>was <span class="_ _e"> </span>saved <span class="_ _53"> </span>in <span class="_ _e"> </span>the <span class="_ _e"> </span>swap <span class="_ _53"> </span>area <span class="_ _53"> </span>when <span class="_ _e"> </span>the <span class="_ _53"> </span>process <span class="_ _53"> </span>terminated.<span class="_ _48"> </span>(The <span class="_ _53"> </span>text</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.890102px;bottom:253.908909px;width:93.779900px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
