<div id="pf2e5" class="pf w4 h1f" data-page-no="2e5"><div class="pc pc2e5 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg2e5.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>18.1<span class="_ _1"></span><span class="ls150d">1N<span class="_ _111"></span><span class="ls0">oncanonical <span class="_"> </span>Mode<span class="_ _1b"> </span><span class="ff18">707</span></span></span></div><div class="t m0 x214 h57 y425 ff1a fs2d fc0 sc0 ls15c ws0">*O<span class="_ _1d"></span><span class="ls0">utput processing off.</span></div><div class="t m0 x214 h57 y426 ff1a fs2d fc0 sc0 ls0 ws0">*/</div><div class="t m0 x8a h57 y800 ff1a fs2d fc0 sc0 ls0 ws0">buf.c_oflag &amp;= ˜(OPOST);</div><div class="t m0 x8a h57 y31b5 ff1a fs2d fc0 sc0 ls0 ws0">/*</div><div class="t m0 x214 h57 y124b ff1a fs2d fc0 sc0 ls15c ws0">*C<span class="_ _1d"></span><span class="ls0">ase B: 1 byte at a time, no timer.</span></div><div class="t m0 x214 h57 y124c ff1a fs2d fc0 sc0 ls0 ws0">*/</div><div class="t m0 x8a h57 y124d ff1a fs2d fc0 sc0 ls0 ws0">buf.c_cc[VMIN] = 1;</div><div class="t m0 x8a h57 y124e ff1a fs2d fc0 sc0 ls0 ws0">buf.c_cc[VTIME] = 0;</div><div class="t m0 x8a h57 y124f ff1a fs2d fc0 sc0 ls0 ws0">if (tcsetattr(fd, TCSAFLUSH, &amp;buf) &lt; 0)</div><div class="t m0 x9d h57 y1250 ff1a fs2d fc0 sc0 ls0 ws0">return(-1);</div><div class="t m0 x8a h57 y31b7 ff1a fs2d fc0 sc0 ls0 ws0">/*</div><div class="t m0 x214 h57 y31b8 ff1a fs2d fc0 sc0 ls15c ws0">*V<span class="_ _1d"></span><span class="ls0">erify that the changes stuck.<span class="_ _3a"> </span>tcsetattr can return 0 on</span></div><div class="t m0 x214 h57 y31b9 ff1a fs2d fc0 sc0 ls15c ws0">*p<span class="_ _1d"></span><span class="ls0">artial success.</span></div><div class="t m0 x214 h57 y31ba ff1a fs2d fc0 sc0 ls0 ws0">*/</div><div class="t m0 x8a h57 y31bb ff1a fs2d fc0 sc0 ls0 ws0">if (tcgetattr(fd, &amp;buf) &lt; 0) {</div><div class="t m0 x9d h57 y2f71 ff1a fs2d fc0 sc0 ls0 ws0">err = errno;</div><div class="t m0 x9d h57 y2f72 ff1a fs2d fc0 sc0 ls0 ws0">tcsetattr(fd, TCSAFLUSH, &amp;save_termios);</div><div class="t m0 x9d h57 y2f73 ff1a fs2d fc0 sc0 ls0 ws0">errno = err;</div><div class="t m0 x9d h57 y8e0 ff1a fs2d fc0 sc0 ls0 ws0">return(-1);</div><div class="t m0 x8a h57 y8e1 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x8a h57 y2f74 ff1a fs2d fc0 sc0 ls0 ws0">if ((buf.c_lflag &amp; (ECHO | ICANON | IEXTEN | ISIG)) ||</div><div class="t m0 x194 h57 y2f75 ff1a fs2d fc0 sc0 ls0 ws0">(buf.c_iflag &amp; (BRKINT | ICRNL | INPCK | ISTRIP | IXON)) ||</div><div class="t m0 x194 h57 y2f76 ff1a fs2d fc0 sc0 ls0 ws0">(buf.c_cflag &amp; (CSIZE | PARENB | CS8)) != CS8 ||</div><div class="t m0 x194 h57 y2f77 ff1a fs2d fc0 sc0 ls0 ws0">(buf.c_oflag &amp; OPOST) || buf.c_cc[VMIN] != 1 ||</div><div class="t m0 x194 h57 y31bc ff1a fs2d fc0 sc0 ls0 ws0">buf.c_cc[VTIME] != 0) {</div><div class="t m0 x9d h57 y3264 ff1a fs2d fc0 sc0 ls0 ws0">/*</div><div class="t m0 x175 h57 y3265 ff1a fs2d fc0 sc0 ls15c ws0">*O<span class="_ _1d"></span><span class="ls0">nly some of the changes were made.<span class="_ _3a"> </span>Restore the</span></div><div class="t m0 x175 h57 y3266 ff1a fs2d fc0 sc0 ls15c ws0">*o<span class="_ _1d"></span><span class="ls0">riginal settings.</span></div><div class="t m0 x175 h57 y3267 ff1a fs2d fc0 sc0 ls0 ws0">*/</div><div class="t m0 x9d h57 y3268 ff1a fs2d fc0 sc0 ls0 ws0">tcsetattr(fd, TCSAFLUSH, &amp;save_termios);</div><div class="t m0 x9d h57 y4853 ff1a fs2d fc0 sc0 ls0 ws0">errno = EINVAL;</div><div class="t m0 x9d h57 y4854 ff1a fs2d fc0 sc0 ls0 ws0">return(-1);</div><div class="t m0 x8a h57 y4855 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x8a h57 y326b ff1a fs2d fc0 sc0 ls0 ws0">ttystate = RAW;</div><div class="t m0 x8a h57 y326c ff1a fs2d fc0 sc0 ls0 ws0">ttysavefd = fd;</div><div class="t m0 x8a h57 y326d ff1a fs2d fc0 sc0 ls0 ws0">return(0);</div><div class="t m0 x32 h57 y326e ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y3f86 ff1a fs2d fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 h57 y3f87 ff1a fs2d fc0 sc0 ls0 ws0">tty_reset(int fd)<span class="_ _b7"> </span>/* restore terminal’s mode */</div><div class="t m0 x32 h57 y3f88 ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y3f89 ff1a fs2d fc0 sc0 ls0 ws0">if (ttystate == RESET)</div><div class="t m0 x9d h57 y3f8a ff1a fs2d fc0 sc0 ls0 ws0">return(0);</div><div class="t m0 x8a h57 y3f8b ff1a fs2d fc0 sc0 ls0 ws0">if (tcsetattr(fd, TCSAFLUSH, &amp;save_termios) &lt; 0)</div><div class="t m0 x9d h57 y3f8c ff1a fs2d fc0 sc0 ls0 ws0">return(-1);</div><div class="t m0 x8a h57 y3f8d ff1a fs2d fc0 sc0 ls0 ws0">ttystate = RESET;</div><div class="t m0 x8a h57 y3f8e ff1a fs2d fc0 sc0 ls0 ws0">return(0);</div><div class="t m0 x32 h57 y3f8f ff1a fs2d fc0 sc0 ls0 ws0">}</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
