<div id="pf2c9" class="pf w4 h1f" data-page-no="2c9"><div class="pc pc2c9 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg2c9.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>18.3<span class="_ _2d6"> </span>Special <span class="_"> </span>Input <span class="_"> </span>Characters<span class="_ _1b"> </span><span class="ff18">679</span></div><div class="t m0 x35 h27 y12f ff16 fsf fc0 sc0 ls0 ws0">Example</div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">Befor<span class="ls177">ed<span class="_ _43"></span><span class="ls0">escribing <span class="_ _23"></span>all <span class="_ _9"></span>the <span class="_ _23"></span>special <span class="_ _9"></span>characters <span class="_ _23"></span>in <span class="_ _9"></span>detail, <span class="_ _23"></span>let’s <span class="_ _9"></span>look <span class="_ _23"></span>at <span class="_ _9"></span>a <span class="_ _9"></span>small <span class="_ _23"></span>program <span class="_ _9"></span>that</span></span></div><div class="t m0 x32 h2a y132 ff19 fsf fc0 sc0 ls0 ws0">changes them.<span class="_ _46"> </span>The <span class="_ _2"></span>program in Figur<span class="lsff2">e1<span class="_ _4f"></span><span class="ls0">8.10 disables <span class="_ _2"></span>the interrupt character <span class="_ _2"></span>and sets <span class="_ _2"></span>the</span></span></div><div class="t m0 x32 h2a y133 ff19 fsf fc0 sc0 ls0 ws0">end-of-ﬁle character to Control</div><div class="t m0 x146 h2a y31d ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 x136 h2a y133 ff19 fsf fc0 sc0 ls0 ws0">B.</div><div class="t m0 x32 h4e y4f76 ff1a fs28 fc0 sc0 ls0 ws0">#include &quot;apue.h&quot;</div><div class="t m0 x32 h4e y4f77 ff1a fs28 fc0 sc0 ls0 ws0">#include &lt;termios.h&gt;</div><div class="t m0 x32 h4e y4f78 ff1a fs28 fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 h4e y4f79 ff1a fs28 fc0 sc0 ls0 ws0">main(void)</div><div class="t m0 x32 h4e y4f7a ff1a fs28 fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h4e y4f7b ff1a fs28 fc0 sc0 ls0 ws0">struct termios<span class="_ _d9"> </span>term;</div><div class="t m0 x8a h4e y4f7c ff1a fs28 fc0 sc0 ls0 ws0">long <span class="_ _bd"> </span>vdisable;</div><div class="t m0 x8a h4e y4f7d ff1a fs28 fc0 sc0 ls0 ws0">if (isatty(STDIN_FILENO) == 0)</div><div class="t m0 x9d h4e y4f7e ff1a fs28 fc0 sc0 ls0 ws0">err_quit(&quot;standard input is not a terminal device&quot;);</div><div class="t m0 x8a h4e y4f7f ff1a fs28 fc0 sc0 ls0 ws0">if ((vdisable = fpathconf(STDIN_FILENO, _PC_VDISABLE)) &lt; 0)</div><div class="t m0 x9d h4e y4f80 ff1a fs28 fc0 sc0 ls0 ws0">err_quit(&quot;fpathconf error or _POSIX_VDISABLE not in effect&quot;);</div><div class="t m0 x8a h4e y4f81 ff1a fs28 fc0 sc0 ls0 ws0">if (tcgetattr(STDIN_FILENO, &amp;term) &lt; 0) /* fetch tty state */</div><div class="t m0 x9d h4e y4f82 ff1a fs28 fc0 sc0 ls0 ws0">err_sys(&quot;tcgetattr error&quot;);</div><div class="t m0 x8a h4e y4f83 ff1a fs28 fc0 sc0 ls0 ws0">term.c_cc[VINTR] = vdisable;<span class="_ _15"> </span>/* disable INTR character */</div><div class="t m0 x8a h4e y4f84 ff1a fs28 fc0 sc0 ls0 ws0">term.c_cc[VEOF] <span class="_"> </span>=<span class="_"> </span>2; <span class="_ _74"> </span>/*<span class="_"> </span>EOF is Control-B */</div><div class="t m0 x8a h4e y4f85 ff1a fs28 fc0 sc0 ls0 ws0">if (tcsetattr(STDIN_FILENO, TCSAFLUSH, &amp;term) &lt; 0)</div><div class="t m0 x9d h4e y4f86 ff1a fs28 fc0 sc0 ls0 ws0">err_sys(&quot;tcsetattr error&quot;);</div><div class="t m0 x8a h4e y4f87 ff1a fs28 fc0 sc0 ls0 ws0">exit(0);</div><div class="t m0 x32 h4e y4f88 ff1a fs28 fc0 sc0 ls0 ws0">}</div><div class="t m0 x1f h2e y4f89 ff18 fs11 fc0 sc0 ls0 ws0">Figure 18.10<span class="_ _5a"> </span><span class="ff19">Disable interrupt character and change end-of-ﬁle character</span></div><div class="t m0 x32 h55 y4f8a ff19 fs2c fc0 sc0 ls0 ws0">Note the following points regar<span class="_ _0"></span>ding this pr<span class="_ _0"></span>ogram.</div><div class="t m0 x3f h55 y4f8b ff19 fs2c fc0 sc0 ls237 ws0">•W<span class="_ _4e"></span><span class="ls1463">em<span class="_ _b"></span><span class="ls0">odify <span class="_ _23"></span>the <span class="_ _23"></span>terminal <span class="_ _23"></span>characters <span class="_ _23"></span>only <span class="_ _23"></span>if <span class="_ _23"></span>standar<span class="ls1464">di<span class="_ _43"></span><span class="ls0">nput <span class="_ _23"></span>is <span class="_ _23"></span>a <span class="_ _23"> </span>terminal <span class="_ _23"> </span>device.</span></span></span></span></div><div class="t m0 x15 h54 y4f8c ff19 fs2c fc0 sc0 ls155 ws0">We <span class="_ _53"> </span>c<span class="_ _9"></span><span class="ls0">all<span class="_"> </span><span class="ff1a">isatty<span class="_ _66"> </span></span>(Section 18.9) to check this.</span></div><div class="t m0 x3f h54 y4f8d ff19 fs2c fc0 sc0 ls237 ws0">•W<span class="_ _4e"></span><span class="ls142">ef<span class="_ _5"></span><span class="ls0">etch the<span class="_"> </span><span class="ff1a">_POSIX_VDISABLE<span class="_ _80"> </span></span>value using<span class="_"> </span><span class="ff1a">fpathconf</span>.</span></span></div><div class="t m0 x3f h54 y4f8e ff19 fs2c fc0 sc0 ls237 ws0">•T<span class="_ _4d"></span><span class="ls0">he <span class="_ _42"> </span>function<span class="_ _44"> </span><span class="ff1a">tcgetattr<span class="_ _35"> </span></span>(Section <span class="_ _42"> </span>18.4) <span class="_ _42"> </span>fetches <span class="_ _42"> </span>a<span class="_ _44"> </span><span class="ff1a">termios<span class="_ _44"> </span></span>structur<span class="ls1465">ef<span class="_ _c"></span><span class="ls150">ro<span class="_ _2"></span><span class="ls1465">mt<span class="_ _43"></span><span class="ls0">he</span></span></span></span></span></div><div class="t m0 x15 h54 y4f8f ff19 fs2c fc0 sc0 ls0 ws0">kernel. <span class="_ _61"> </span>After<span class="_ _61"> </span>we’ve <span class="_ _47"> </span>modiﬁed <span class="_ _66"> </span>this <span class="_ _47"> </span>structur<span class="_ _0"></span>e, <span class="_ _66"> </span>we <span class="_ _47"> </span>call<span class="_ _61"> </span><span class="ff1a">tcsetattr<span class="_ _61"> </span></span>to <span class="_ _47"> </span>set <span class="_ _66"> </span>the</div><div class="t m0 x15 h55 y4f90 ff19 fs2c fc0 sc0 ls0 ws0">attributes. <span class="_"> </span>The<span class="_ _66"> </span>only <span class="_ _2"></span>attributes <span class="_ _2"></span>that change <span class="_ _2"></span>ar<span class="ls1466">et<span class="_ _4f"></span><span class="ls0">he <span class="_ _2"></span>ones we <span class="_ _2"></span>speciﬁcally <span class="_ _2"></span>modiﬁed.</span></span></div><div class="t m0 x3f h55 y4f91 ff19 fs2c fc0 sc0 ls237 ws0">•D<span class="_ _4d"></span><span class="ls0">isabling <span class="_ _9"></span>the <span class="_ _23"></span>interrupt <span class="_ _9"></span>key <span class="_ _9"></span>is <span class="_ _23"></span>differ<span class="_ _1"></span>ent <span class="_ _23"></span>from <span class="_ _9"></span>ignoring <span class="_ _9"></span>the <span class="_ _23"></span>interrupt <span class="_ _9"></span>signal.<span class="_ _5a"> </span>The</span></div><div class="t m0 x15 h55 y4f92 ff19 fs2c fc0 sc0 ls0 ws0">program <span class="_ _42"> </span>in <span class="_ _53"> </span>Figur<span class="ls1467">e1<span class="_ _c"></span><span class="ls0">8.10 <span class="_ _53"> </span>simply <span class="_ _53"> </span>disables <span class="_ _53"> </span>the <span class="_ _53"> </span>special <span class="_ _53"> </span>character <span class="_ _53"> </span>that <span class="_ _53"> </span>causes <span class="_ _e"> </span>the</span></span></div><div class="t m0 x15 h54 y4f93 ff19 fs2c fc0 sc0 ls0 ws0">terminal <span class="_ _3"></span>driver <span class="_ _3"></span>to <span class="_ _3"></span>generate<span class="_ _47"> </span><span class="ff1a">SIGINT</span><span class="ls1468">.W<span class="_ _7"></span><span class="ls1469">ec<span class="_ _8"></span><span class="ls0">an <span class="_ _3"></span>still <span class="_ _3"></span>use <span class="_ _3"></span>the<span class="_ _47"> </span><span class="ff1a">kill<span class="_ _45"> </span></span>function <span class="_ _2"></span>to <span class="_ _3"></span>send</span></span></span></div><div class="t m0 x15 h55 y4f94 ff19 fs2c fc0 sc0 ls0 ws0">the signal to the process.</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
