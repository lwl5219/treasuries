<div id="pf302" class="pf w4 h1f" data-page-no="302"><div class="pc pc302 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg302.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">736<span class="_ _1b"> </span><span class="ff19">Pseudo <span class="_"> </span>T<span class="_ _6"></span>erminals <span class="_ _23a"> </span>Chapter<span class="_ _4b"> </span>19</span></div><div class="t m0 x3f h57 y425 ff1a fs2d fc0 sc0 ls0 ws0">pty slowout &gt; file.out &amp;</div><div class="t m0 x32 h26 y27c1 ff19 fsf fc0 sc0 ls0 ws0">the<span class="_ _45"> </span><span class="ff1a">pty<span class="_ _45"> </span></span>pr<span class="_ _0"></span>ocess <span class="_ _9"></span>is <span class="_ _9"></span>stopped <span class="_ _9"></span>immediately <span class="_ _9"></span>when <span class="_ _9"></span>the <span class="_ _9"></span>child <span class="_ _9"></span>tries <span class="_ _9"></span>to <span class="_ _9"></span>read <span class="_ _3"></span>from <span class="_ _9"></span>its <span class="_ _9"></span>standard</div><div class="t m0 x32 h2a y27c2 ff19 fsf fc0 sc0 ls0 ws0">input <span class="_ _2"></span>(the <span class="_ _3"></span>terminal).<span class="_ _61"> </span>The <span class="_ _3"></span>reason <span class="_ _2"></span>is <span class="_ _3"></span>that <span class="_ _2"></span>the <span class="_ _3"></span>job <span class="_ _3"></span>is <span class="_ _2"></span>a <span class="_ _3"></span>background <span class="_ _2"></span>job <span class="_ _3"></span>and <span class="_ _2"></span>gets <span class="_ _3"></span>job-control</div><div class="t m0 x32 h26 y54ad ff19 fsf fc0 sc0 ls0 ws0">stopped <span class="_ _9"></span>when <span class="_ _9"></span>it <span class="_ _9"></span>tries <span class="_ _3"></span>to <span class="_ _9"></span>access <span class="_ _9"></span>the <span class="_ _9"></span>terminal.<span class="_ _5a"> </span>If <span class="_ _9"></span>we <span class="_ _9"></span>redir<span class="_ _0"></span>ect <span class="_ _9"></span>standar<span class="ls4d">di<span class="_ _b"></span><span class="ls0">nput <span class="_ _3"></span>so <span class="_ _9"></span>that<span class="_ _45"> </span><span class="ff1a">pty</span></span></span></div><div class="t m0 x32 h2a y54ae ff19 fsf fc0 sc0 ls0 ws0">doesn’t try to read fr<span class="_ _0"></span>om the terminal, as in</div><div class="t m0 x3f h57 y54af ff1a fs2d fc0 sc0 ls0 ws0">pty slowout &lt; /dev/null &gt; file.out &amp;</div><div class="t m0 x32 h26 y54b0 ff19 fsf fc0 sc0 ls0 ws0">the<span class="_"> </span><span class="ff1a">pty<span class="_ _66"> </span></span>program stops <span class="_ _2"></span>immediately <span class="_ _2"></span>because <span class="_ _2"></span>it reads an <span class="_ _2"></span>end <span class="_ _2"></span>of <span class="_ _2"></span>ﬁle <span class="_ _2"></span>on its <span class="_ _2"></span>standar<span class="ls88c">di<span class="_ _4f"></span><span class="ls0">nput</span></span></div><div class="t m0 x32 h26 y54b1 ff19 fsf fc0 sc0 ls0 ws0">and <span class="_ _2"></span>terminates.<span class="_ _61"> </span>The <span class="_ _3"></span>solution <span class="_ _2"></span>for <span class="_ _3"></span>this <span class="_ _2"></span>problem <span class="_ _2"></span>is <span class="_ _3"></span>the<span class="_ _47"> </span><span class="ff1a">-i<span class="_ _66"> </span></span>option, <span class="_ _3"></span>which <span class="_ _2"></span>says <span class="_ _3"></span>to <span class="_ _2"></span>ignor<span class="ls15c7">ea<span class="_ _4f"></span><span class="ls0">n</span></span></div><div class="t m0 x32 h2a y54b2 ff19 fsf fc0 sc0 ls0 ws0">end of ﬁle on the standar<span class="ls44">di<span class="_ _4f"></span><span class="ls0">nput:</span></span></div><div class="t m0 x3f h57 y54b3 ff1a fs2d fc0 sc0 ls0 ws0">pty -i slowout &lt; /dev/null &gt; file.out &amp;</div><div class="t m0 x32 h26 y54b4 ff19 fsf fc0 sc0 ls0 ws0">This ﬂag causes <span class="_ _2"></span>the<span class="_"> </span><span class="ff1a">pty<span class="_ _66"> </span></span>child in <span class="_ _2"></span>Figur<span class="ls9d9">e1<span class="_ _4f"></span><span class="ls0">9.12 to <span class="_ _2"></span>exit when the <span class="_ _2"></span>end of <span class="_ _2"></span>ﬁle is encountered,</span></span></div><div class="t m0 x32 h2a y54b5 ff19 fsf fc0 sc0 ls0 ws0">but <span class="_ _2"></span>the <span class="_ _3"></span>child <span class="_ _2"></span>doesn’t <span class="_ _3"></span>tell <span class="_ _2"></span>the <span class="_ _3"></span>parent <span class="_ _2"></span>to <span class="_ _2"></span>terminate.<span class="_ _16"> </span>Instead, <span class="_ _2"></span>the <span class="_ _3"></span>parent <span class="_ _2"></span>continues <span class="_ _2"></span>copying</div><div class="t m0 x32 h26 y54b6 ff19 fsf fc0 sc0 ls0 ws0">the PTY slave output to standar<span class="ls44">do<span class="_ _4f"></span><span class="ls0">utput (the ﬁle<span class="_"> </span><span class="ff1a">file.out<span class="_ _66"> </span></span>in the example).</span></span></div><div class="t m0 x35 h26 y54b7 ff1f fsf fc0 sc0 ls0 ws0">script<span class="_ _66"> </span><span class="ff16">Program</span></div><div class="t m0 x32 h26 y54b8 ff19 fsf fc0 sc0 ls0 ws0">Using <span class="_ _42"> </span>the<span class="_ _35"> </span><span class="ff1a">pty<span class="_ _44"> </span></span>program, <span class="_ _23"> </span>we <span class="_ _42"> </span>can <span class="_ _42"> </span>implement <span class="_ _42"> </span>the<span class="_ _44"> </span><span class="ff1a">script</span></div><div class="t m0 xa4 h2a y54b9 ff19 fsf fc0 sc0 ls0 ws0">(</div><div class="t m0 x15b h2a y54b8 ff19 fsf fc0 sc0 ls0 ws0">1</div><div class="t m0 x23a h2a y54b9 ff19 fsf fc0 sc0 ls0 ws0">)</div><div class="t m0 x12d h2a y54b8 ff19 fsf fc0 sc0 ls0 ws0">program <span class="_ _23"> </span>as <span class="_ _42"> </span>the <span class="_ _42"> </span>following</div><div class="t m0 x32 h2a y54ba ff19 fsf fc0 sc0 ls0 ws0">shell script:</div><div class="t m0 x3f h57 y54bb ff1a fs2d fc0 sc0 ls0 ws0">#!/bin/sh</div><div class="t m0 x3f h57 y54bc ff1a fs2d fc0 sc0 ls0 ws0">pty &quot;${SHELL:-/bin/sh}&quot; | tee typescript</div><div class="t m0 x32 h26 y54bd ff19 fsf fc0 sc0 ls0 ws0">Once <span class="_ _23"> </span>we <span class="_ _42"> </span>run <span class="_ _23"> </span>this <span class="_ _23"> </span>shell <span class="_ _42"> </span>script, <span class="_ _23"> </span>we <span class="_ _42"> </span>can <span class="_ _23"> </span>execute <span class="_ _42"> </span>the<span class="_ _35"> </span><span class="ff1a">ps<span class="_ _35"> </span></span>command <span class="_ _42"> </span>to <span class="_ _23"> </span>see <span class="_ _42"> </span>all <span class="_ _23"> </span>the <span class="_ _42"> </span>process</div><div class="t m0 x32 h2a y54be ff19 fsf fc0 sc0 ls45 ws0">re<span class="ls0">lationships. <span class="_"> </span>Figur<span class="ls44">e1<span class="_ _d"></span><span class="ls0">9.14 details these relationships.</span></span></span></div><div class="t m0 x6a h2d y54bf ff19 fs10 fc0 sc0 ls0 ws0">login</div><div class="t m0 x1f4 h2d y54c0 ff19 fs10 fc0 sc0 ls0 ws0">shell</div><div class="t m0 x8 h4f y54c1 ff1a fs11 fc0 sc0 ls0 ws0">sh</div><div class="t m0 x72 h6d y54c2 ff1a fs12 fc0 sc0 ls0 ws0">tee</div><div class="t m0 x1a4 h63 y54c3 ff1a fs13 fc0 sc0 ls0 ws0">pty</div><div class="t m0 x19a h30 y54c4 ff19 fs13 fc0 sc0 ls0 ws0">parent</div><div class="t m0 x23b h6f y54c5 ff1a fs14 fc0 sc0 ls0 ws0">pty</div><div class="t m0 x212 h31 y54c6 ff19 fs14 fc0 sc0 ls0 ws0">child</div><div class="t m0 x1ea h66 y54c7 ff1a fs15 fc0 sc0 ls0 ws0">ksh</div><div class="t m0 xfb h70 y54c8 ff1a fs16 fc0 sc0 ls0 ws0">ps</div><div class="t m0 x2f hcc y54c9 ff1a fs17 fc0 sc0 ls0 ws0">typescript</div><div class="t m0 xee h34 y54ca ff19 fs17 fc0 sc0 ls0 ws0">ﬁle</div><div class="t m0 xb7 h35 y54cb ff19 fs18 fc0 sc0 ls0 ws0">line</div><div class="t m0 x1e h35 y54cc ff19 fs18 fc0 sc0 ls0 ws0">discipline</div><div class="t m0 x145 h36 y54cd ff19 fs19 fc0 sc0 ls0 ws0">TTY</div><div class="t m0 xcd h37 y54ce ff19 fs1a fc0 sc0 ls0 ws0">PTY</div><div class="t m0 x78 h37 y54cf ff19 fs1a fc0 sc0 ls0 ws0">master</div><div class="t m0 x21e h38 y54d0 ff19 fs1b fc0 sc0 ls0 ws0">line</div><div class="t m0 x69 h38 y54d1 ff19 fs1b fc0 sc0 ls0 ws0">discipline</div><div class="t m0 x200 h39 y54d2 ff19 fs1c fc0 sc0 ls0 ws0">PTY</div><div class="t m0 x1ee h39 y54d3 ff19 fs1c fc0 sc0 ls0 ws0">slave</div><div class="t m0 x145 hab y54d4 ff19 fs57 fc0 sc0 ls0 ws0">user</div><div class="t m0 xc1 h191 y54d5 ff19 fscf fc0 sc0 ls0 ws0">pipe</div><div class="t m0 x144 h192 y54d6 ff18 fscf fc0 sc0 ls0 ws0">Figure 19.14<span class="_ _5a"> </span><span class="ff19">Arrangement of processes for<span class="_"> </span><span class="ff1a">script<span class="_ _53"> </span></span>shell script</span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
