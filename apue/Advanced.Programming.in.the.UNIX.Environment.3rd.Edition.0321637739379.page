<div id="pf17b" class="pf w4 h1f" data-page-no="17b"><div class="pc pc17b w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg17b.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>10.1<span class="_ _1"></span><span class="lsc98">1S<span class="_ _273"></span><span class="ls0">ignal <span class="_"> </span>Sets<span class="_ _1b"> </span><span class="ff18">345</span></span></span></div><div class="t m0 x3f h26 y12f ff19 fsf fc0 sc0 ls0 ws0">Using <span class="_ _2"></span>this <span class="_ _2"></span>implementation,<span class="_ _66"> </span><span class="ff1a">sigaddset<span class="_ _47"> </span></span>turns on <span class="_ _3"></span>a <span class="_ _2"></span>single <span class="_ _2"></span>bit <span class="_ _2"></span>and<span class="_ _66"> </span><span class="ff1a">sigdelset<span class="_ _47"> </span></span>turns</div><div class="t m0 x32 h26 y130 ff19 fsf fc0 sc0 ls0 ws0">of<span class="lsc99">fas<span class="_ _4f"></span><span class="ls0">ingle bit;<span class="_ _66"> </span><span class="ff1a">sigismember<span class="_ _66"> </span></span>tests a certain <span class="_ _2"></span>bit.<span class="_ _46"> </span>Since no <span class="_ _2"></span>signal is ever <span class="_ _2"></span>numbered 0, we</span></span></div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">subtract <span class="_ _9"></span>1 <span class="_ _9"></span>from <span class="_ _3"></span>the <span class="_ _9"></span>signal <span class="_ _9"></span>number <span class="_ _9"></span>to <span class="_ _9"></span>obtain <span class="_ _9"></span>the <span class="_ _9"></span>bit <span class="_ _23"></span>to <span class="_ _3"></span>manipulate.<span class="_ _5a"> </span>Figur<span class="ls24a">e1<span class="_ _b"></span><span class="ls0">0.12 <span class="_ _9"></span>shows</span></span></div><div class="t m0 x32 h2a y132 ff19 fsf fc0 sc0 ls0 ws0">implementations of these functions.</div><div class="t m0 x32 h4e y177c ff1a fs28 fc0 sc0 ls0 ws0">#include <span class="_ _68"> </span>&lt;signal.h&gt;</div><div class="t m0 x32 h4e y177d ff1a fs28 fc0 sc0 ls0 ws0">#include <span class="_ _68"> </span>&lt;errno.h&gt;</div><div class="t m0 x32 h4e y177e ff1a fs28 fc0 sc0 ls0 ws0">/*</div><div class="t m0 x140 h4e y2c1a ff1a fs28 fc0 sc0 ls1b6 ws0">*&lt;<span class="_ _1d"></span><span class="ls0">signal.h&gt; usually defines NSIG to include signal number 0.</span></div><div class="t m0 x140 h4e y2c1b ff1a fs28 fc0 sc0 ls0 ws0">*/</div><div class="t m0 x32 h4e y2c1c ff1a fs28 fc0 sc0 ls0 ws0">#define SIGBAD(signo)<span class="_ _68"> </span>((signo) &lt;= 0 || (signo) &gt;= NSIG)</div><div class="t m0 x32 h4e y1782 ff1a fs28 fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 h4e y1783 ff1a fs28 fc0 sc0 ls0 ws0">sigaddset(sigset_t *set, int signo)</div><div class="t m0 x32 h4e y2c1d ff1a fs28 fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h4e y2c1e ff1a fs28 fc0 sc0 ls0 ws0">if (SIGBAD(signo)) {</div><div class="t m0 x9d h4e y2c1f ff1a fs28 fc0 sc0 ls0 ws0">errno = EINVAL;</div><div class="t m0 x9d h4e y2c20 ff1a fs28 fc0 sc0 ls0 ws0">return(-1);</div><div class="t m0 x8a h4e y2c21 ff1a fs28 fc0 sc0 ls0 ws0">}</div><div class="t m0 x8a h4e y2c22 ff1a fs28 fc0 sc0 ls0 ws0">*set |= 1 &lt;&lt; (signo - 1);<span class="_ _b7"> </span>/* turn bit on */</div><div class="t m0 x8a h4e y2c23 ff1a fs28 fc0 sc0 ls0 ws0">return(0);</div><div class="t m0 x32 h4e y2c24 ff1a fs28 fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h4e y2c25 ff1a fs28 fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 h4e y2c26 ff1a fs28 fc0 sc0 ls0 ws0">sigdelset(sigset_t *set, int signo)</div><div class="t m0 x32 h4e y2c27 ff1a fs28 fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h4e y2c28 ff1a fs28 fc0 sc0 ls0 ws0">if (SIGBAD(signo)) {</div><div class="t m0 x9d h4e y2c29 ff1a fs28 fc0 sc0 ls0 ws0">errno = EINVAL;</div><div class="t m0 x9d h4e y2c2a ff1a fs28 fc0 sc0 ls0 ws0">return(-1);</div><div class="t m0 x8a h4e y2c2b ff1a fs28 fc0 sc0 ls0 ws0">}</div><div class="t m0 x8a h4e y2c2c ff1a fs28 fc0 sc0 ls0 ws0">*set &amp;= ˜(1 &lt;&lt; (signo - 1));<span class="_ _15"> </span>/* turn bit off */</div><div class="t m0 x8a h4e y2c2d ff1a fs28 fc0 sc0 ls0 ws0">return(0);</div><div class="t m0 x32 h4e y2c2e ff1a fs28 fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h4e y2c2f ff1a fs28 fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 h4e y2c30 ff1a fs28 fc0 sc0 ls0 ws0">sigismember(const sigset_t *set, int signo)</div><div class="t m0 x32 h4e y2c31 ff1a fs28 fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h4e y2c32 ff1a fs28 fc0 sc0 ls0 ws0">if (SIGBAD(signo)) {</div><div class="t m0 x9d h4e y2c33 ff1a fs28 fc0 sc0 ls0 ws0">errno = EINVAL;</div><div class="t m0 x9d h4e y2c34 ff1a fs28 fc0 sc0 ls0 ws0">return(-1);</div><div class="t m0 x8a h4e y2c35 ff1a fs28 fc0 sc0 ls0 ws0">}</div><div class="t m0 x8a h4e y2c36 ff1a fs28 fc0 sc0 ls0 ws0">return((*set &amp; (1 &lt;&lt; (signo - 1))) != 0);</div><div class="t m0 x32 h4e y2c37 ff1a fs28 fc0 sc0 ls0 ws0">}</div><div class="t m0 x175 h4f y2c38 ff18 fs11 fc0 sc0 ls0 ws0">Figure 10.12<span class="_ _5a"> </span><span class="ff19">An implementation of<span class="_"> </span><span class="ff1a">sigaddset</span>,<span class="_"> </span><span class="ff1a">sigdelset</span><span class="lsdb">,a<span class="_ _84"></span><span class="ls0">nd<span class="_"> </span><span class="ff1a">sigismember</span></span></span></span></div><div class="t m0 x32 h55 y2c39 ff19 fs2c fc0 sc0 ls155 ws0">We <span class="_ _35"> </span>m<span class="_ _9"></span><span class="ls0">ight <span class="_"> </span>be <span class="_ _53"> </span>tempted <span class="_ _e"> </span>to <span class="_ _e"> </span>implement <span class="_ _e"> </span>these <span class="_ _e"> </span>three <span class="_ _53"> </span>functions <span class="_ _e"> </span>as <span class="_"> </span>one-line <span class="_ _53"> </span>macros <span class="_ _53"> </span>in <span class="_ _e"> </span>the</span></div><div class="t m0 x32 h54 y2c3a ff1a fs2c fc0 sc0 ls0 ws0">&lt;signal.h&gt;<span class="_ _47"> </span><span class="ff19">header<span class="_ _6"></span><span class="lsc9a">,b<span class="_ _4f"></span><span class="ls0">ut <span class="_ _2"></span>POSIX.1 <span class="_ _3"></span>requires us <span class="_ _3"></span>to <span class="_ _3"></span>check <span class="_ _2"></span>the <span class="_ _3"></span>signal <span class="_ _3"></span>number <span class="_ _2"></span>argument <span class="_ _2"></span>for</span></span></span></div><div class="t m0 x32 h54 y2c3b ff19 fs2c fc0 sc0 ls0 ws0">validity and <span class="_ _2"></span>to set<span class="_ _66"> </span><span class="ff1a">errno<span class="_ _66"> </span></span>if <span class="_ _2"></span>it is <span class="_ _2"></span>invalid.<span class="_ _46"> </span>This <span class="_ _2"></span>is mor<span class="lsc9b">ed<span class="_ _4f"></span><span class="ls0">ifﬁcult to <span class="_ _2"></span>do in <span class="_ _2"></span>a macr<span class="lsc9b">ot<span class="_ _4f"></span><span class="ls0">han <span class="_ _2"></span>in a</span></span></span></span></div><div class="t m0 x32 h55 y2c3c ff19 fs2c fc0 sc0 ls0 ws0">function.</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
