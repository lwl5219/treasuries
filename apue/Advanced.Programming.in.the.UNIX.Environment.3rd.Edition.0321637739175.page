<div id="pfaf" class="pf w4 h1f" data-page-no="af"><div class="pc pcaf w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bgaf.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Chapter <span class="_"> </span>4<span class="_ _1c8"> </span>Exercises<span class="_ _1b"> </span><span class="ff18">141</span></div><div class="t m0 x32 h2a y12f ff19 fsf fc0 sc0 ls0 ws0">system, <span class="_ _47"> </span>and <span class="_ _47"> </span>we’ve <span class="_ _47"> </span>seen <span class="_ _47"> </span>how <span class="_ _47"> </span>to <span class="_ _47"> </span>navigate <span class="_ _47"> </span>the <span class="_ _47"> </span>ﬁle <span class="_ _47"> </span>system <span class="_ _47"> </span>namespace.<span class="_ _50"> </span><span class="ls610">At<span class="_ _5b"></span><span class="ls0">horough</span></span></div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">understanding <span class="_ _42"> </span>of <span class="_ _53"> </span>all <span class="_ _53"> </span>the <span class="_ _53"> </span>properties <span class="_ _42"> </span>of <span class="_ _53"> </span>ﬁles <span class="_ _42"> </span>and <span class="_ _53"> </span>directories <span class="_ _42"> </span>and <span class="_ _53"> </span>all <span class="_ _53"> </span>the <span class="_ _53"> </span>functions <span class="_ _53"> </span>that</div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">operate on them is essential to UNIX programming.</div><div class="t m0 x32 h53 y1429 ff16 fs2b fc0 sc0 ls0 ws0">Exer<span class="_ _0"></span>cises</div><div class="t m0 x32 h57 y142a ff18 fs2d fc0 sc0 ls0 ws0">4.1<span class="_ _6e"> </span><span class="ff19">Modify the <span class="_ _2"></span>program in Figur<span class="ls611">e4<span class="_ _d"></span><span class="ls0">.3 to <span class="_ _2"></span>use<span class="_"> </span><span class="ff1a">stat<span class="_ _80"> </span></span>instead of<span class="_"> </span><span class="ff1a">lstat</span><span class="ls612">.W<span class="_ _55"></span><span class="ls0">hat <span class="_ _2"></span>changes if one of <span class="_ _2"></span>the</span></span></span></span></span></div><div class="t m0 x90 h5f y142b ff19 fs2d fc0 sc0 ls0 ws0">command</div><div class="t m0 x125 h5f y142c ff19 fs2d fc0 sc0 ls0 ws0">-</div><div class="t m0 x53 h5f y142b ff19 fs2d fc0 sc0 ls0 ws0">line arguments is a symbolic link?</div><div class="t m0 x32 h5f y142d ff18 fs2d fc0 sc0 ls0 ws0">4.2<span class="_ _6e"> </span><span class="ff19">What <span class="_ _9"></span>happens <span class="_ _9"></span>if <span class="_ _9"></span>the <span class="_ _9"></span>ﬁle <span class="_ _23"></span>mode <span class="_ _3"></span>creation <span class="_ _9"></span>mask <span class="_ _9"></span>is <span class="_ _9"></span>set <span class="_ _9"></span>to <span class="_ _9"></span>777 <span class="_ _9"></span>(octal)?<span class="_ _16"> </span><span class="ls1e5">Ve<span class="_"> </span></span>rify <span class="_ _3"></span>the <span class="_ _9"></span>results <span class="_ _9"></span>using</span></div><div class="t m0 x90 h57 y142e ff19 fs2d fc0 sc0 ls0 ws0">your shell’s<span class="_"> </span><span class="ff1a">umask<span class="_ _e"> </span></span>command.</div><div class="t m0 x32 h5f y142f ff18 fs2d fc0 sc0 ls0 ws0">4.3<span class="_ _6e"> </span><span class="ff19 ls1e5">Ve<span class="_"> </span><span class="ls0">rify <span class="_ _9"></span>that <span class="_ _23"> </span>turning <span class="_ _23"> </span>of<span class="ls613">fu<span class="_ _b"></span><span class="ls0">ser<span class="_ _0"></span>-read <span class="_ _9"></span>permission <span class="_ _23"> </span>for <span class="_ _23"> </span>a <span class="_ _9"></span>ﬁle <span class="_ _23"> </span>that <span class="_ _23"> </span>you <span class="_ _23"> </span>own <span class="_ _9"></span>denies <span class="_ _23"> </span>your <span class="_ _23"> </span>access <span class="_ _23"></span>to</span></span></span></span></div><div class="t m0 x90 h5f y1430 ff19 fs2d fc0 sc0 ls0 ws0">the ﬁle.</div><div class="t m0 x32 h57 y1431 ff18 fs2d fc0 sc0 ls0 ws0">4.4<span class="_ _6e"> </span><span class="ff19">Run the program in Figur<span class="ls110">e4<span class="_ _d"></span><span class="ls0">.9<span class="_"> </span><span class="ff1b">after<span class="_"> </span></span>creating the ﬁles<span class="_"> </span><span class="ff1a">foo<span class="_ _e"> </span></span>and<span class="_"> </span><span class="ff1a">bar</span><span class="ls614">.W<span class="_ _c"></span><span class="ls0">hat happens?</span></span></span></span></span></div><div class="t m0 x32 h5f y1432 ff18 fs2d fc0 sc0 ls0 ws0">4.5<span class="_ _6e"> </span><span class="ff19">In <span class="_ _9"></span>Section <span class="_ _3"></span>4.12, <span class="_ _9"></span>we <span class="_ _3"></span>said <span class="_ _9"></span>that <span class="_ _9"></span>a <span class="_ _3"></span>ﬁle <span class="_ _9"></span>size <span class="_ _3"></span>of <span class="_ _9"></span>0 <span class="_ _3"></span>is <span class="_ _9"></span>valid <span class="_ _9"></span>for <span class="_ _3"></span>a <span class="_ _9"></span>regular <span class="_ _3"></span>ﬁle.<span class="_ _46"> </span><span class="ls32e">We <span class="_ _80"> </span>a<span class="_ _9"></span></span>lso <span class="_ _9"></span>said <span class="_ _3"></span>that <span class="_ _9"></span>the</span></div><div class="t m0 x90 h57 y1433 ff1a fs2d fc0 sc0 ls0 ws0">st_size<span class="_ _47"> </span><span class="ff19">ﬁeld <span class="_ _3"></span>is <span class="_ _3"></span>deﬁned <span class="_ _9"></span>for <span class="_ _3"></span>directories <span class="_ _3"></span>and <span class="_ _9"></span>symbolic <span class="_ _3"></span>links.<span class="_ _46"> </span>Should <span class="_ _9"></span>we <span class="_ _3"></span>ever <span class="_ _9"></span>see <span class="_ _3"></span>a <span class="_ _9"></span>ﬁle <span class="_ _3"></span>size</span></div><div class="t m0 x90 h5f y1434 ff19 fs2d fc0 sc0 ls0 ws0">of 0 for a directory or a symbolic link?</div><div class="t m0 x32 h57 y1435 ff18 fs2d fc0 sc0 ls0 ws0">4.6<span class="_ _6e"> </span><span class="ff19 ls467">Wr<span class="_ _9"></span><span class="ls0">ite <span class="_ _2"></span>a utility <span class="_ _2"></span>like<span class="_ _66"> </span><span class="ff1a">cp</span></span></span></div><div class="t m0 x18 h5f y1436 ff19 fs2d fc0 sc0 ls0 ws0">(</div><div class="t m0 xa6 h5f y1435 ff19 fs2d fc0 sc0 ls0 ws0">1</div><div class="t m0 x6b h5f y1436 ff19 fs2d fc0 sc0 ls0 ws0">)</div><div class="t m0 x7 h5f y1435 ff19 fs2d fc0 sc0 ls0 ws0">that <span class="_ _2"></span>copies a <span class="_ _2"></span>ﬁle <span class="_ _2"></span>containing <span class="_ _2"></span>holes, <span class="_ _2"></span>without <span class="_ _2"></span>writing <span class="_ _2"></span>the <span class="_ _2"></span>bytes <span class="_ _2"></span>of <span class="_ _2"></span>0 <span class="_ _2"></span>to</div><div class="t m0 x90 h5f y1437 ff19 fs2d fc0 sc0 ls0 ws0">the output ﬁle.</div><div class="t m0 x32 h57 y1438 ff18 fs2d fc0 sc0 ls0 ws0">4.7<span class="_ _6e"> </span><span class="ff19">Note <span class="_ _45"> </span>in <span class="_ _45"> </span>the <span class="_ _45"> </span>output <span class="_ _45"> </span>fr<span class="_ _0"></span>om <span class="_ _45"> </span>the<span class="_ _61"> </span><span class="ff1a">ls<span class="_ _16"> </span></span>command <span class="_ _45"> </span>in <span class="_ _45"> </span>Section <span class="_ _45"> </span>4.12 <span class="_ _47"> </span>that <span class="_ _45"> </span>the <span class="_ _45"> </span>ﬁles<span class="_ _16"> </span><span class="ff1a">core<span class="_ _16"> </span></span>and</span></div><div class="t m0 x90 h57 y1439 ff1a fs2d fc0 sc0 ls0 ws0">core.copy<span class="_ _47"> </span><span class="ff19">have <span class="_ _9"></span>different <span class="_ _3"></span>access <span class="_ _9"></span>permissions.<span class="_ _61"> </span>If <span class="_ _9"></span>the<span class="_ _45"> </span></span>umask<span class="_ _47"> </span><span class="ff19">value <span class="_ _9"></span>didn’t <span class="_ _9"></span>change <span class="_ _9"></span>between</span></div><div class="t m0 x90 h5f y143a ff19 fs2d fc0 sc0 ls0 ws0">the creation of the two ﬁles, explain how the dif<span class="_ _0"></span>ference could have occurr<span class="_ _0"></span>ed.</div><div class="t m0 x32 h57 y143b ff18 fs2d fc0 sc0 ls0 ws0">4.8<span class="_ _6e"> </span><span class="ff19">When <span class="_ _2"></span>running <span class="_ _2"></span>the <span class="_ _2"></span>program <span class="_ _2"></span>in <span class="_ _2"></span>Figur<span class="ls615">e4<span class="_ _4f"></span><span class="ls0">.16, <span class="_ _3"></span>we <span class="_ _2"></span>check <span class="_ _2"></span>the <span class="_ _2"></span>available <span class="_ _2"></span>disk <span class="_ _2"></span>space <span class="_ _2"></span>with <span class="_ _2"></span>the<span class="_ _66"> </span><span class="ff1a">df</span></span></span></span></div><div class="t m0 x1b8 h5f y143c ff19 fs2d fc0 sc0 ls0 ws0">(</div><div class="t m0 x34 h5f y143b ff19 fs2d fc0 sc0 ls0 ws0">1</div><div class="t m0 x17e h5f y143c ff19 fs2d fc0 sc0 ls0 ws0">)</div><div class="t m0 x90 h57 y143d ff19 fs2d fc0 sc0 ls0 ws0">command. <span class="_"> </span>Why<span class="_"> </span>didn’t we use the<span class="_"> </span><span class="ff1a">du</span></div><div class="t m0 x86 h5f y143e ff19 fs2d fc0 sc0 ls0 ws0">(</div><div class="t m0 x6c h5f y143d ff19 fs2d fc0 sc0 ls0 ws0">1</div><div class="t m0 x1be h5f y143e ff19 fs2d fc0 sc0 ls0 ws0">)</div><div class="t m0 x1a4 h5f y143d ff19 fs2d fc0 sc0 ls0 ws0">command?</div><div class="t m0 x32 h57 y143f ff18 fs2d fc0 sc0 ls0 ws0">4.9<span class="_ _6e"> </span><span class="ff19">In <span class="_ _9"></span>Figur<span class="ls616">e4<span class="_ _8"></span><span class="ls0">.20, <span class="_ _9"></span>we <span class="_ _3"></span>show <span class="_ _9"></span>the<span class="_ _47"> </span><span class="ff1a">unlink<span class="_ _47"> </span></span>function <span class="_ _9"></span>as <span class="_ _3"></span>modifying <span class="_ _9"></span>the <span class="_ _9"></span>changed-status <span class="_ _9"></span>time <span class="_ _3"></span>of <span class="_ _9"></span>the</span></span></span></div><div class="t m0 x90 h5f y1440 ff19 fs2d fc0 sc0 ls0 ws0">ﬁle itself.<span class="_ _4b"> </span>How can this happen?</div><div class="t m0 x32 h57 y1441 ff18 fs2d fc0 sc0 ls0 ws0">4.10<span class="_ _60"> </span><span class="ff19">In <span class="_ _23"></span>Section <span class="_ _9"></span>4.22, <span class="_ _9"></span>how <span class="_ _9"></span>does <span class="_ _23"></span>the <span class="_ _9"></span>system’s <span class="_ _9"></span>limit <span class="_ _9"></span>on <span class="_ _23"></span>the <span class="_ _9"></span>number <span class="_ _9"></span>of <span class="_ _9"></span>open <span class="_ _23"></span>ﬁles <span class="_ _9"></span>affect <span class="_ _9"></span>the<span class="_ _47"> </span><span class="ff1a">myftw</span></span></div><div class="t m0 x90 h5f y1442 ff19 fs2d fc0 sc0 ls0 ws0">function?</div><div class="t m0 x32 h57 y1443 ff18 fs2d fc0 sc0 ls0 ws0">4.1<span class="_ _0"></span>1<span class="_ _50"> </span><span class="ff19">In <span class="_ _9"></span>Section <span class="_ _3"></span>4.22, <span class="_ _3"></span>our <span class="_ _3"></span>version <span class="_ _9"></span>of<span class="_ _66"> </span><span class="ff1a">ftw<span class="_ _47"> </span></span>never <span class="_ _3"></span>changes <span class="_ _9"></span>its <span class="_ _3"></span>directory<span class="_ _4"></span><span class="ls617">.M<span class="_ _4a"></span><span class="ls0">odify <span class="_ _3"></span>this <span class="_ _3"></span>routine <span class="_ _3"></span>so <span class="_ _3"></span>that</span></span></span></div><div class="t m0 x90 h57 y1444 ff19 fs2d fc0 sc0 ls0 ws0">each <span class="_ _9"></span>time <span class="_ _9"></span>it <span class="_ _9"></span>encounters <span class="_ _9"></span>a <span class="_ _9"></span>directory<span class="_ _4"></span>,<span class="_ _45"> </span>it<span class="_ _47"> </span>uses <span class="_ _9"></span>the<span class="_ _47"> </span><span class="ff1a">chdir<span class="_ _45"> </span></span>function <span class="_ _3"></span>to <span class="_ _9"></span>change <span class="_ _23"></span>to <span class="_ _3"></span>that <span class="_ _9"></span>directory<span class="_ _6"></span>,</div><div class="t m0 x90 h57 y1445 ff19 fs2d fc0 sc0 ls0 ws0">allowing <span class="_ _3"></span>it <span class="_ _3"></span>to <span class="_ _3"></span>use <span class="_ _3"></span>the <span class="_ _9"></span>ﬁlename <span class="_ _3"></span>and <span class="_ _3"></span>not <span class="_ _3"></span>the <span class="_ _3"></span>pathname <span class="_ _9"></span>for <span class="_ _3"></span>each <span class="_ _3"></span>call <span class="_ _3"></span>to<span class="_ _47"> </span><span class="ff1a">lstat</span><span class="ls618">.W<span class="_ _5b"></span><span class="ls0">hen <span class="_ _9"></span>all <span class="_ _3"></span>the</span></span></div><div class="t m0 x90 h57 y1446 ff19 fs2d fc0 sc0 ls0 ws0">entries <span class="_ _2"></span>in <span class="_ _2"></span>a <span class="_ _3"></span>directory <span class="_ _2"></span>have <span class="_ _2"></span>been <span class="_ _3"></span>processed, execute<span class="_ _66"> </span><span class="ff1a">chdir(&quot;..&quot;)</span><span class="ls619">.C<span class="_ _4a"></span><span class="ls0">ompar<span class="ls61a">et<span class="_ _d"></span><span class="ls0">he <span class="_ _2"></span>time <span class="_ _3"></span>used</span></span></span></span></div><div class="t m0 x90 h5f y1447 ff19 fs2d fc0 sc0 ls0 ws0">by this version and the version in the text.</div><div class="t m0 x32 h5f y1448 ff18 fs2d fc0 sc0 ls0 ws0">4.12<span class="_ _60"> </span><span class="ff19">Each <span class="_ _42"> </span>process <span class="_ _23"> </span>also <span class="_ _42"> </span>has <span class="_ _23"> </span>a <span class="_ _42"> </span>root <span class="_ _23"> </span>directory <span class="_ _23"> </span>that <span class="_ _42"> </span>is <span class="_ _23"> </span>used <span class="_ _42"> </span>for <span class="_ _23"> </span>resolution <span class="_ _42"> </span>of <span class="_ _23"> </span>absolute <span class="_ _42"> </span>pathnames.</span></div><div class="t m0 x90 h57 y1449 ff19 fs2d fc0 sc0 ls0 ws0">This <span class="_ _3"></span>root <span class="_ _2"></span>directory <span class="_ _3"></span>can <span class="_ _3"></span>be <span class="_ _3"></span>changed <span class="_ _3"></span>with <span class="_ _3"></span>the<span class="_ _66"> </span><span class="ff1a">chroot<span class="_ _47"> </span></span>function. <span class="_ _66"> </span>Look<span class="_ _47"> </span>up <span class="_ _3"></span>the <span class="_ _3"></span>description <span class="_ _3"></span>for</div><div class="t m0 x90 h5f y144a ff19 fs2d fc0 sc0 ls0 ws0">this function in your manuals.<span class="_ _4b"> </span>When might this function be useful?</div><div class="t m0 x32 h57 y144b ff18 fs2d fc0 sc0 ls0 ws0">4.13<span class="_ _60"> </span><span class="ff19">How can you set only one of the two time values with the<span class="_"> </span><span class="ff1a">utimes<span class="_ _80"> </span></span>function?</span></div><div class="t m0 x32 h57 y144c ff18 fs2d fc0 sc0 ls0 ws0">4.14<span class="_ _60"> </span><span class="ff19">Some <span class="_ _42"> </span>versions <span class="_ _53"> </span>of <span class="_ _42"> </span>the<span class="_ _35"> </span><span class="ff1a">finger</span></span></div><div class="t m0 x13 h5f y144d ff19 fs2d fc0 sc0 ls0 ws0">(</div><div class="t m0 xf h5f y144c ff19 fs2d fc0 sc0 ls0 ws0">1</div><div class="t m0 x5c h5f y144d ff19 fs2d fc0 sc0 ls0 ws0">)</div><div class="t m0 xb5 h5f y144c ff19 fs2d fc0 sc0 ls0 ws0">command <span class="_ _42"> </span>output <span class="_ _42"> </span>‘‘New <span class="_ _23"> </span>mail <span class="_ _42"> </span>received <span class="_ _42"> </span>...’<span class="ls61b">’a<span class="_ _43"></span><span class="ls0">nd <span class="_ _23"> </span>‘‘unr<span class="_ _0"></span>ead</span></span></div><div class="t m0 x90 h5f y144e ff19 fs2d fc0 sc0 ls0 ws0">since ...’<span class="ls61c">’w<span class="_ _4a"></span><span class="ls0">her<span class="ls61d">e.<span class="_ _d"></span><span class="ls0">.. <span class="_ _2"></span>ar<span class="ls61d">et<span class="_ _d"></span><span class="ls0">he corresponding <span class="_ _2"></span>times <span class="_ _2"></span>and dates.<span class="_ _59"> </span>How <span class="_ _2"></span>can <span class="_ _2"></span>the <span class="_ _2"></span>program determine</span></span></span></span></span></span></div><div class="t m0 x90 h5f y144f ff19 fs2d fc0 sc0 ls0 ws0">these two times and dates?</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
