<div id="pf12b" class="pf w4 h1f" data-page-no="12b"><div class="pc pc12b w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg12b.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h7a ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>8.13<span class="_ _23a"> </span><span class="ff1a">system<span class="_ _4b"> </span></span>Function<span class="_ _1b"> </span><span class="ff18">265</span></div><div class="t m0 x3f h57 y1295 ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;stdlib.h&gt;</div><div class="t m0 x3f h57 y22ef ff1a fs2d fc0 sc0 ls0 ws0">int system(const char *<span class="ff1b">cmdstring</span>);</div><div class="t m0 x44 h5f y22f0 ff19 fs2d fc0 sc0 ls0 ws0">Returns: (see below)</div><div class="t m0 x3f h4d y22f1 ff19 fs26 fc0 sc0 ls0 ws0">If<span class="_ _47"> </span><span class="ff1b">cmdstring<span class="_ _47"> </span></span>is <span class="_ _2"></span>a <span class="_ _3"></span>null <span class="_ _2"></span>pointer<span class="_ _1"></span>,<span class="_ _47"> </span><span class="ff1a">system<span class="_ _47"> </span></span><span class="lscc">re</span>turns <span class="_ _3"></span>nonzer<span class="lsa47">oo<span class="_ _8"></span><span class="ls0">nly <span class="_ _3"></span>if <span class="_ _2"></span>a <span class="_ _3"></span>command <span class="_ _3"></span>processor</span></span></div><div class="t m0 x32 h4d y22f2 ff19 fs26 fc0 sc0 ls0 ws0">is <span class="_ _23"> </span>available.<span class="_ _51"> </span>This <span class="_ _23"> </span>featur<span class="lsa48">ed<span class="_ _43"></span><span class="ls0">etermines <span class="_ _42"> </span>whether <span class="_ _23"></span>the<span class="_ _35"> </span><span class="ff1a">system<span class="_ _35"> </span></span>function <span class="_ _23"> </span>is <span class="_ _23"> </span>supported <span class="_ _42"> </span>on <span class="_ _23"> </span>a</span></span></div><div class="t m0 x32 h4d y22f3 ff19 fs26 fc0 sc0 ls0 ws0">given operating system.<span class="_ _59"> </span>Under the UNIX System,<span class="_"> </span><span class="ff1a">system<span class="_ _66"> </span></span>is always available.</div><div class="t m0 x3f h4d y22f4 ff19 fs26 fc0 sc0 ls0 ws0">Because<span class="_ _35"> </span><span class="ff1a">system<span class="_ _44"> </span></span>is <span class="_ _23"> </span>implemented <span class="_ _42"> </span>by <span class="_ _42"> </span>calling<span class="_ _35"> </span><span class="ff1a">fork</span>,<span class="_ _35"> </span><span class="ff1a">exec</span><span class="lsa49">,a<span class="_ _43"></span><span class="ls0">nd<span class="_ _44"> </span><span class="ff1a">waitpid</span><span class="lsa49">,t<span class="_ _43"></span><span class="ls0">her<span class="lsa49">ea<span class="_ _c"></span><span class="lscc">re</span></span></span></span></span></span></div><div class="t m0 x32 h49 y22f5 ff19 fs26 fc0 sc0 ls0 ws0">three types of r<span class="_ _0"></span>eturn values.</div><div class="t m0 x3f h4d y22f6 ff19 fs26 fc0 sc0 ls0 ws0">1. <span class="_ _51"> </span>If<span class="_ _47"> </span>either <span class="_ _3"></span>the<span class="_ _47"> </span><span class="ff1a">fork<span class="_ _47"> </span></span>fails <span class="_ _3"></span>or<span class="_ _45"> </span><span class="ff1a">waitpid<span class="_ _47"> </span></span><span class="lscc">re</span>turns <span class="_ _3"></span>an <span class="_ _3"></span>error <span class="_ _2"></span>other <span class="_ _3"></span>than<span class="_ _45"> </span><span class="ff1a">EINTR</span>,<span class="_ _47"> </span><span class="ff1a">system</span></div><div class="t m0 x41 h4d y22f7 ff19 fs26 fc0 sc0 lscc ws0">re<span class="ls0">turns<span class="_"> </span><span class="ff20">−</span><span class="lsd3">1w<span class="_ _5"></span><span class="ls0">ith<span class="_"> </span><span class="ff1a">errno<span class="_ _80"> </span></span>set to indicate the error<span class="_ _6"></span>.</span></span></span></div><div class="t m0 x3f h4d y22f8 ff19 fs26 fc0 sc0 ls0 ws0">2. <span class="_ _51"> </span>If<span class="_ _66"> </span>the<span class="_ _47"> </span><span class="ff1a">exec<span class="_ _66"> </span></span>fails, <span class="_ _2"></span>implying <span class="_ _3"></span>that <span class="_ _2"></span>the <span class="_ _2"></span>shell <span class="_ _2"></span>can’t <span class="_ _2"></span>be <span class="_ _2"></span>executed, <span class="_ _2"></span>the <span class="_ _3"></span>return value <span class="_ _2"></span>is <span class="_ _2"></span>as</div><div class="t m0 x41 h4d y22f9 ff19 fs26 fc0 sc0 ls0 ws0">if the shell had executed<span class="_"> </span><span class="ff1a">exit(127)</span>.</div><div class="t m0 x3f h4d y22fa ff19 fs26 fc0 sc0 ls0 ws0">3. <span class="_ _51"> </span>Otherwise,<span class="_ _35"> </span>all <span class="_ _23"></span>thr<span class="_ _0"></span>ee <span class="_ _23"></span>functions<span class="_ _9"></span>—<span class="_ _3"></span><span class="ff1a">fork</span>,<span class="_ _35"> </span><span class="ff1a">exec</span><span class="lsa4a">,a<span class="_ _b"></span><span class="ls0">nd<span class="_ _45"> </span><span class="ff1a">waitpid<span class="_ _9"></span></span><span class="ls161">—s<span class="_ _6"></span><span class="ls0">ucceed, <span class="_ _23"> </span>and <span class="_ _23"> </span>the</span></span></span></span></div><div class="t m0 x41 h4d y22fb ff19 fs26 fc0 sc0 lscc ws0">re<span class="ls0">turn <span class="_ _42"> </span>value <span class="_ _23"></span>from<span class="_ _45"> </span><span class="ff1a">system<span class="_ _35"> </span></span>is <span class="_ _23"> </span>the <span class="_ _42"> </span>termination <span class="_ _23"></span>status <span class="_ _23"> </span>of <span class="_ _23"> </span>the <span class="_ _23"> </span>shell, <span class="_ _42"> </span>in <span class="_ _23"></span>the <span class="_ _23"> </span>format</span></div><div class="t m0 x41 h4d y22fc ff19 fs26 fc0 sc0 ls0 ws0">speciﬁed for<span class="_"> </span><span class="ff1a">waitpid</span>.</div><div class="t m0 xf6 h5e y22fd ff19 fs10 fc0 sc0 ls0 ws0">Some <span class="_"> </span>older <span class="_"> </span>implementations <span class="_ _80"> </span>of<span class="_ _44"> </span><span class="ff1a">system<span class="_ _44"> </span></span><span class="ls21d">re</span>turned <span class="_"> </span>an <span class="_ _e"> </span>error <span class="_"> </span>(<span class="ff1a">EINTR</span><span class="lsa4b">)i<span class="_ _43"></span><span class="ls0">f<span class="_ _44"> </span><span class="ff1a">waitpid<span class="_ _35"> </span></span>was</span></span></div><div class="t m0 xf6 h2d y22fe ff19 fs10 fc0 sc0 ls0 ws0">interrupted by a <span class="_ _2"></span>caught signal.<span class="_ _44"> </span>Because <span class="_ _2"></span>there<span class="_"> </span>is<span class="_ _e"> </span>no<span class="_ _80"> </span>strategy that <span class="_ _2"></span>an application <span class="_ _2"></span>can use <span class="_ _2"></span>to</div><div class="t m0 xf6 h2d y22ff ff19 fs10 fc0 sc0 ls21d ws0">re<span class="ls0">cover <span class="_ _42"> </span>from <span class="_ _23"> </span>this <span class="_ _23"> </span>type <span class="_ _23"> </span>of <span class="_ _42"> </span>error <span class="_ _23"> </span>(the <span class="_ _23"> </span>process <span class="_ _23"> </span>ID <span class="_ _42"> </span>of <span class="_ _23"> </span>the <span class="_ _23"> </span>child <span class="_ _42"> </span>is <span class="_ _23"> </span>hidden <span class="_ _42"> </span>from <span class="_ _23"> </span>the <span class="_ _23"> </span>caller),</span></div><div class="t m0 xf6 h5e y2300 ff19 fs10 fc0 sc0 ls0 ws0">POSIX <span class="_ _23"> </span>later <span class="_ _42"> </span>added <span class="_ _23"> </span>the <span class="_ _23"> </span>requirement <span class="_ _23"> </span>that<span class="_ _45"> </span><span class="ff1a">system<span class="_ _45"> </span></span>not <span class="_ _23"> </span>return <span class="_ _23"> </span>an <span class="_ _23"> </span>error <span class="_ _23"> </span>in <span class="_ _23"> </span>this <span class="_ _42"> </span>case.<span class="_ _61"> </span>(W<span class="_ _6"></span>e</div><div class="t m0 xf6 h2d y2301 ff19 fs10 fc0 sc0 ls0 ws0">discuss interrupted system calls in Section 10.5.)</div><div class="t m0 x3f h4d y2302 ff19 fs26 fc0 sc0 ls0 ws0">Figur<span class="ls2b9">e8<span class="_ _8"></span><span class="ls0">.22 <span class="_ _2"></span>shows <span class="_ _3"></span>an <span class="_ _2"></span>implementation <span class="_ _3"></span>of <span class="_ _2"></span>the<span class="_ _47"> </span><span class="ff1a">system<span class="_ _66"> </span></span>function. <span class="_ _47"> </span>The<span class="_ _47"> </span>one <span class="_ _2"></span>featur<span class="lsa4c">et<span class="_ _8"></span><span class="ls0">hat</span></span></span></span></div><div class="t m0 x32 h49 y2303 ff19 fs26 fc0 sc0 ls0 ws0">it <span class="_ _35"> </span>doesn’t <span class="_ _35"> </span>handle <span class="_ _35"> </span>is <span class="_ _35"> </span>signals.<span class="_ _5c"> </span><span class="ls164">We<span class="_ _23"></span></span>’ll <span class="_ _35"> </span>update <span class="_ _35"> </span>this <span class="_ _35"> </span>function <span class="_ _35"> </span>with <span class="_ _35"> </span>signal <span class="_ _35"> </span>handling <span class="_ _35"> </span>in</div><div class="t m0 x32 h49 y7f0 ff19 fs26 fc0 sc0 ls0 ws0">Section 10.18.</div><div class="t m0 x3f h4d y2304 ff19 fs26 fc0 sc0 ls0 ws0">The shell’s<span class="_ _66"> </span><span class="ff1a">-c<span class="_ _47"> </span></span>option tells <span class="_ _2"></span>it to <span class="_ _2"></span>take <span class="_ _2"></span>the <span class="_ _2"></span>next command</div><div class="t m0 x153 h49 y2305 ff19 fs26 fc0 sc0 ls0 ws0">-</div><div class="t m0 x1da h4a y2304 ff19 fs26 fc0 sc0 ls0 ws0">line argument—<span class="ff1b">cmdstring</span><span class="lsa4d">,i<span class="_ _4f"></span><span class="ls0">n</span></span></div><div class="t m0 x32 h49 y2306 ff19 fs26 fc0 sc0 ls0 ws0">this case<span class="_ _9"></span><span class="ls161">—a<span class="_ _6"></span><span class="lsa4e">si<span class="_ _d"></span><span class="ls0">ts command input instead <span class="_ _2"></span>of reading fr<span class="_ _0"></span>om standar<span class="lsa4f">di<span class="_ _4f"></span><span class="ls0">nput or from a given</span></span></span></span></span></div><div class="t m0 x32 h49 y2307 ff19 fs26 fc0 sc0 ls0 ws0">ﬁle. <span class="_ _46"> </span>The<span class="_ _61"> </span>shell <span class="_ _66"> </span>parses <span class="_ _47"> </span>this <span class="_ _66"> </span>null-terminated <span class="_ _66"> </span>C <span class="_ _47"> </span>string <span class="_"> </span>and <span class="_ _47"> </span>breaks <span class="_"> </span>it <span class="_ _66"> </span>up <span class="_ _66"> </span>into <span class="_ _47"> </span>separate</div><div class="t m0 x32 h49 y2308 ff19 fs26 fc0 sc0 ls0 ws0">command</div><div class="t m0 xc3 h49 y2309 ff19 fs26 fc0 sc0 ls0 ws0">-</div><div class="t m0 xc4 h49 y2308 ff19 fs26 fc0 sc0 ls0 ws0">line <span class="_ _3"></span>arguments <span class="_ _2"></span>for <span class="_ _3"></span>the <span class="_ _9"></span>command.<span class="_ _16"> </span>The <span class="_ _3"></span>actual <span class="_ _3"></span>command <span class="_ _3"></span>string <span class="_ _3"></span>that <span class="_ _9"></span>is <span class="_ _3"></span>passed</div><div class="t m0 x32 h49 y230a ff19 fs26 fc0 sc0 ls0 ws0">to <span class="_ _e"> </span>the <span class="_ _e"> </span>shell <span class="_ _e"> </span>can <span class="_ _e"> </span>contain <span class="_ _e"> </span>any <span class="_ _e"> </span>valid <span class="_ _e"> </span>shell <span class="_ _e"> </span>commands.<span class="_ _48"> </span>For <span class="_ _e"> </span>example, <span class="_ _e"> </span>input <span class="_ _e"> </span>and <span class="_ _e"> </span>output</div><div class="t m0 x32 h4d y230b ff19 fs26 fc0 sc0 lscc ws0">re<span class="ls0">direction using<span class="_"> </span><span class="ff1a">&lt;<span class="_ _80"> </span></span>and<span class="_"> </span><span class="ff1a">&gt;<span class="_ _66"> </span></span>can be used.</span></div><div class="t m0 x3f h49 y230c ff19 fs26 fc0 sc0 ls0 ws0">If <span class="_ _45"> </span>we <span class="_ _47"> </span>didn’t <span class="_ _45"> </span>use <span class="_ _45"> </span>the <span class="_ _45"> </span>shell <span class="_ _47"> </span>to <span class="_ _45"> </span>execute <span class="_ _45"> </span>the <span class="_ _47"> </span>command, <span class="_ _45"> </span>but <span class="_ _45"> </span>tried <span class="_ _45"> </span>to <span class="_ _47"> </span>execute <span class="_ _45"> </span>the</div><div class="t m0 x32 h4d y230d ff19 fs26 fc0 sc0 ls0 ws0">command <span class="_ _42"> </span>ourself, <span class="_ _53"> </span>it <span class="_ _53"> </span>would <span class="_ _42"> </span>be <span class="_ _53"> </span>mor<span class="lsa50">ed<span class="_ _c"></span><span class="ls0">ifﬁcult. <span class="_ _44"> </span>First,<span class="_ _44"> </span>we <span class="_ _42"> </span>would <span class="_ _53"> </span>want <span class="_ _53"> </span>to <span class="_ _53"> </span>call<span class="_ _44"> </span><span class="ff1a">execlp</span>,</span></span></div><div class="t m0 x32 h4d y230e ff19 fs26 fc0 sc0 ls0 ws0">instead <span class="_ _2"></span>of<span class="_ _47"> </span><span class="ff1a">execl</span>,<span class="_ _66"> </span>to<span class="_ _47"> </span>use <span class="_ _2"></span>the<span class="_ _47"> </span><span class="ff1a">PATH<span class="_ _47"> </span></span>variable, <span class="_ _2"></span>like <span class="_ _2"></span>the <span class="_ _3"></span>shell.<span class="_ _61"> </span><span class="ls164">We <span class="_ _80"> </span>w<span class="_ _9"></span></span>ould <span class="_ _2"></span>also <span class="_ _3"></span>have <span class="_ _2"></span>to <span class="_ _3"></span>break</div><div class="t m0 x32 h49 y230f ff19 fs26 fc0 sc0 ls0 ws0">up <span class="_ _23"></span>the <span class="_ _23"> </span>null-terminated <span class="_ _23"> </span>C <span class="_ _23"> </span>string <span class="_ _23"> </span>into <span class="_ _42"> </span>separate <span class="_ _23"></span>command</div><div class="t m0 x1b4 h49 y2310 ff19 fs26 fc0 sc0 ls0 ws0">-</div><div class="t m0 x1ef h49 y230f ff19 fs26 fc0 sc0 ls0 ws0">line <span class="_ _23"></span>arguments <span class="_ _23"></span>for <span class="_ _23"></span>the <span class="_ _23"></span>call <span class="_ _23"></span>to</div><div class="t m0 x32 h4d y2311 ff1a fs26 fc0 sc0 ls0 ws0">execlp<span class="ff19 ls199">.F<span class="_ _4a"></span><span class="ls0">inally<span class="_ _4"></span>,<span class="_"> </span>we<span class="_"> </span>wouldn’t be able to use any of the shell metacharacters.</span></span></div><div class="t m0 x3f h4d y2312 ff19 fs26 fc0 sc0 ls0 ws0">Note <span class="_ _3"></span>that <span class="_ _3"></span>we <span class="_ _9"></span>call<span class="_ _47"> </span><span class="ff1a">_exit<span class="_ _45"> </span></span>instead <span class="_ _3"></span>of<span class="_ _47"> </span><span class="ff1a">exit</span><span class="lsa51">.W<span class="_ _7"></span><span class="ls0">e<span class="_ _47"> </span>do<span class="_ _45"> </span>this <span class="_ _3"></span>to <span class="_ _3"></span>prevent <span class="_ _3"></span>any <span class="_ _3"></span>standar<span class="lsa52">dI<span class="_ _b"></span><span class="ls0">/O</span></span></span></span></div><div class="t m0 x32 h4d y2313 ff19 fs26 fc0 sc0 ls0 ws0">buffers, <span class="_ _9"></span>which <span class="_ _23"> </span>would <span class="_ _42"> </span>have <span class="_ _23"></span>been <span class="_ _23"></span>copied <span class="_ _23"></span>from <span class="_ _9"></span>the <span class="_ _42"> </span>parent <span class="_ _9"></span>to <span class="_ _23"> </span>the <span class="_ _23"> </span>child <span class="_ _23"> </span>across <span class="_ _23"></span>the<span class="_ _35"> </span><span class="ff1a">fork</span>,</div><div class="t m0 x32 h49 y2314 ff19 fs26 fc0 sc0 ls0 ws0">from being ﬂushed in the child.</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
