<div id="pf301" class="pf w4 h1f" data-page-no="301"><div class="pc pc301 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg301.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h7a ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>19.6<span class="_ _30e"> </span>Using <span class="_"> </span>the<span class="_ _4b"> </span><span class="ff1a">pty<span class="_ _4b"> </span></span>Program<span class="_ _1b"> </span><span class="ff18">735</span></div><div class="t m0 xac h51 y547f ff19 fs2a fc0 sc0 ls0 ws0">terminal</div><div class="t m0 x186 h51 y5480 ff19 fs2a fc0 sc0 ls0 ws0">device driver</div><div class="t m0 xcd h2d y5481 ff19 fs10 fc0 sc0 ls0 ws0">PTY master</div><div class="t m0 x16a h2e y5482 ff19 fs11 fc0 sc0 ls0 ws0">PTY slave</div><div class="t m0 x136 h2f y5483 ff19 fs12 fc0 sc0 ls0 ws0">terminal</div><div class="t m0 x63 h2f y5484 ff19 fs12 fc0 sc0 ls0 ws0">line discipline</div><div class="t m0 x13b h30 y5485 ff19 fs13 fc0 sc0 ls0 ws0">terminal</div><div class="t m0 x5e h30 y5486 ff19 fs13 fc0 sc0 ls0 ws0">line discipline</div><div class="t m0 x1e2 h6f y5487 ff1a fs14 fc0 sc0 ls0 ws0">pty</div><div class="t m0 x19b h31 y5488 ff19 fs14 fc0 sc0 ls0 ws0">parent</div><div class="t m0 x22b h66 y5489 ff1a fs15 fc0 sc0 ls0 ws0">pty</div><div class="t m0 x1e1 h32 y548a ff19 fs15 fc0 sc0 ls0 ws0">child</div><div class="t m0 xb0 h33 y548b ff19 fs16 fc0 sc0 ls0 ws0">login</div><div class="t m0 x13a h33 y548c ff19 fs16 fc0 sc0 ls0 ws0">shell</div><div class="t m0 x16f h71 y548d ff1a fs36 fc0 sc0 ls0 ws0">cat</div><div class="t m0 x211 h189 y548e ff19 fsca fc0 sc0 ls0 ws0">process group</div><div class="t m0 x239 h18a y548f ff19 fscb fc0 sc0 ls0 ws0">process group</div><div class="t m0 x68 h18b y5490 ff19 fscc fc0 sc0 ls0 ws0">process group</div><div class="t m0 x15e h37 y5491 ff19 fs1a fc0 sc0 ls0 ws0">session</div><div class="t m0 x1ea h38 y5492 ff19 fs1b fc0 sc0 ls0 ws0">session</div><div class="t m0 x136 h18c y5493 ff19 fscd fc0 sc0 ls0 ws0">user at a</div><div class="t m0 x136 h18c y5494 ff19 fscd fc0 sc0 ls0 ws0">terminal</div><div class="t m0 x10d h18d y5495 ff18 fscd fc0 sc0 ls0 ws0">Figure 19.13<span class="_ _5a"> </span><span class="ff19">Process groups and sessions for<span class="_"> </span><span class="ff1a">pty <span class="_ _5"></span>cat</span></span></div><div class="t m0 x32 h18e y5496 ff19 fsce fc0 sc0 ls0 ws0">belongs <span class="_ _53"> </span>to <span class="_ _53"> </span>an <span class="_ _53"> </span>orphaned <span class="_ _53"> </span>process <span class="_ _53"> </span>group <span class="_ _53"> </span>(Section <span class="_ _53"> </span>9.10).<span class="_ _65"> </span>The <span class="_ _53"> </span>parent <span class="_ _42"> </span>of<span class="_ _4b"> </span><span class="ff1a">cat<span class="_ _4b"> </span></span>is <span class="_ _53"> </span>the<span class="_ _4b"> </span><span class="ff1a">pty</span></div><div class="t m0 x32 h18f y5497 ff19 fsce fc0 sc0 ls0 ws0">parent, and it belongs to another session.</div><div class="t m0 x3f h18f y5498 ff19 fsce fc0 sc0 ls0 ws0">Historically<span class="_ _4"></span><span class="ls15c0">,i<span class="_ _d"></span><span class="ls0">mplementations <span class="_ _2"></span>have handled <span class="_ _2"></span>this <span class="_ _2"></span>condition <span class="_ _2"></span>differ<span class="_ _0"></span>ently<span class="_ _4"></span><span class="ls15c1">.P<span class="_ _5b"></span><span class="ls0">OSIX.1 <span class="_ _2"></span>says</span></span></span></span></div><div class="t m0 x32 h18e y5499 ff19 fsce fc0 sc0 ls0 ws0">only <span class="_ _9"></span>that <span class="_ _9"></span>the<span class="_ _45"> </span><span class="ff1a">SIGTSTP<span class="_ _35"> </span></span>signal <span class="_ _9"></span>can’t <span class="_ _9"></span>be <span class="_ _9"></span>delivered <span class="_ _9"></span>to <span class="_ _9"></span>the <span class="_ _23"></span>process. <span class="_ _47"> </span>Systems<span class="_ _45"> </span>derived <span class="_ _23"></span>from</div><div class="t m0 x32 h18e y549a ff19 fsce fc0 sc0 ls0 ws0">4.3BSD <span class="_ _2"></span>delivered<span class="_ _47"> </span><span class="ff1a">SIGKILL<span class="_ _47"> </span></span>instead, <span class="_ _3"></span>which <span class="_ _3"></span>the <span class="_ _2"></span>process <span class="_ _3"></span>can’t <span class="_ _3"></span>even <span class="_ _2"></span>catch.<span class="_ _16"> </span>In <span class="_ _3"></span>4.4BSD, <span class="_ _3"></span>this</div><div class="t m0 x32 h18e y549b ff19 fsce fc0 sc0 ls0 ws0">behavior was <span class="_ _2"></span>changed <span class="_ _2"></span>to <span class="_ _2"></span>conform <span class="_ _2"></span>to <span class="_ _2"></span>POSIX.1.<span class="_ _46"> </span>Instead <span class="_ _2"></span>of <span class="_ _2"></span>sending<span class="_ _66"> </span><span class="ff1a">SIGKILL</span><span class="ls15c2">,t<span class="_ _d"></span><span class="ls0">he <span class="_ _2"></span>4.4BSD</span></span></div><div class="t m0 x32 h18e y549c ff19 fsce fc0 sc0 ls0 ws0">kernel <span class="_ _3"></span>silently <span class="_ _3"></span>discards <span class="_ _2"></span>the<span class="_ _47"> </span><span class="ff1a">SIGTSTP<span class="_ _47"> </span></span>signal <span class="_ _3"></span>if <span class="_ _3"></span>it <span class="_ _3"></span>has <span class="_ _3"></span>the <span class="_ _3"></span>default <span class="_ _3"></span>disposition <span class="_ _3"></span>and <span class="_ _3"></span>is <span class="_ _3"></span>to <span class="_ _3"></span>be</div><div class="t m0 x32 h18f y549d ff19 fsce fc0 sc0 ls0 ws0">delivered <span class="_ _23"> </span>to <span class="_ _42"> </span>a <span class="_ _53"> </span>process <span class="_ _23"> </span>in <span class="_ _42"> </span>an <span class="_ _53"> </span>orphaned <span class="_ _42"> </span>process <span class="_ _42"> </span>gr<span class="_ _0"></span>oup. <span class="_ _44"> </span>Most<span class="_ _35"> </span>current <span class="_ _42"> </span>implementations</div><div class="t m0 x32 h18f y549e ff19 fsce fc0 sc0 ls0 ws0">follow this behavior<span class="_ _6"></span>.</div><div class="t m0 x3f h18e y549f ff19 fsce fc0 sc0 ls0 ws0">When <span class="_ _3"></span>we <span class="_ _9"></span>use<span class="_ _47"> </span><span class="ff1a">pty<span class="_ _45"> </span></span>to <span class="_ _3"></span>run <span class="_ _3"></span>a <span class="_ _9"></span>job-control <span class="_ _2"></span>shell, <span class="_ _9"></span>the <span class="_ _3"></span>jobs <span class="_ _9"></span>invoked <span class="_ _3"></span>by <span class="_ _9"></span>this <span class="_ _3"></span>new <span class="_ _3"></span>shell <span class="_ _9"></span>are</div><div class="t m0 x32 h18f y54a0 ff19 fsce fc0 sc0 ls0 ws0">never <span class="_ _e"> </span>members <span class="_ _e"> </span>of <span class="_"> </span>an <span class="_ _53"> </span>orphaned <span class="_"> </span>pr<span class="_ _1"></span>ocess <span class="_"> </span>gr<span class="_ _0"></span>oup, <span class="_ _e"> </span>because <span class="_ _e"> </span>the <span class="_"> </span>job-contr<span class="_ _1"></span>ol <span class="_"> </span>shell <span class="_ _53"> </span>always</div><div class="t m0 x32 h18f y54a1 ff19 fsce fc0 sc0 ls0 ws0">belongs <span class="_ _53"> </span>to <span class="_ _53"> </span>the <span class="_ _e"> </span>same <span class="_ _53"> </span>session.<span class="_ _65"> </span>In <span class="_ _53"> </span>that <span class="_ _e"> </span>case, <span class="_ _53"> </span>the <span class="_ _53"> </span>Control</div><div class="t m0 x100 h18f y54a2 ff19 fsce fc0 sc0 ls0 ws0">-</div><div class="t m0 x101 h18f y54a1 ff19 fsce fc0 sc0 ls15c3 ws0">Zt<span class="_ _55"></span><span class="ls0">hat <span class="_ _e"> </span>we <span class="_ _53"> </span>type <span class="_ _e"> </span>is <span class="_ _53"> </span>sent <span class="_ _53"> </span>to <span class="_ _e"> </span>the</span></div><div class="t m0 x32 h18f y54a3 ff19 fsce fc0 sc0 ls0 ws0">process invoked by the shell, not to the shell itself.</div><div class="t m0 x3f h18e y54a4 ff19 fsce fc0 sc0 ls0 ws0">The <span class="_"> </span>only <span class="_"> </span>way <span class="_"> </span>to <span class="_"> </span>avoid <span class="_"> </span>this <span class="_"> </span>inability <span class="_"> </span>of <span class="_"> </span>the <span class="_ _e"> </span>process <span class="_"> </span>invoked <span class="_"> </span>by<span class="_ _59"> </span><span class="ff1a">pty<span class="_ _46"> </span></span>to <span class="_"> </span>handle</div><div class="t m0 x32 h18f y54a5 ff19 fsce fc0 sc0 ls0 ws0">job-control signals is to add yet another command</div><div class="t m0 x173 h18f y54a6 ff19 fsce fc0 sc0 ls0 ws0">-</div><div class="t m0 x19c h18e y54a5 ff19 fsce fc0 sc0 ls0 ws0">line ﬂag to<span class="_"> </span><span class="ff1a">pty</span><span class="ls15c4">,t<span class="_ _d"></span><span class="ls0">elling it to recognize</span></span></div><div class="t m0 x32 h18e y54a7 ff19 fsce fc0 sc0 ls0 ws0">the <span class="_ _2"></span>job <span class="_ _2"></span>control suspend <span class="_ _2"></span>character <span class="_ _2"></span>itself <span class="_ _2"></span>(in <span class="_ _2"></span>the<span class="_ _47"> </span><span class="ff1a">pty<span class="_ _66"> </span></span>child) <span class="_ _2"></span>instead <span class="_ _2"></span>of <span class="_ _2"></span>letting <span class="_ _2"></span>the <span class="_ _2"></span>character</div><div class="t m0 x32 h18f y54a8 ff19 fsce fc0 sc0 ls0 ws0">get all the way through to the other line discipline.</div><div class="t m0 x35 h190 y54a9 ff16 fsce fc0 sc0 ls15c5 ws0">Wa<span class="_ _2"></span><span class="ls0">tching the Output of Long-Running Programs</span></div><div class="t m0 x32 h18e y54aa ff19 fsce fc0 sc0 ls0 ws0">Another <span class="_"> </span>example <span class="_ _66"> </span>of <span class="_ _47"> </span>job <span class="_"> </span>control <span class="_"> </span>interaction <span class="_ _66"> </span>with <span class="_ _66"> </span>the<span class="_ _61"> </span><span class="ff1a">pty<span class="_ _46"> </span></span>program <span class="_"> </span>is <span class="_ _66"> </span>found <span class="_ _47"> </span>in <span class="_"> </span>the</div><div class="t m0 x32 h18f y54ab ff19 fsce fc0 sc0 ls0 ws0">conﬁguration <span class="_ _23"> </span>illustrated <span class="_ _42"> </span>in <span class="_ _42"> </span>Figur<span class="ls15c6">e1<span class="_ _43"></span><span class="ls0">9.7. <span class="_ _35"> </span>If<span class="_ _35"> </span>we <span class="_ _42"> </span>run <span class="_ _23"> </span>the <span class="_ _42"> </span>program <span class="_ _23"> </span>that <span class="_ _42"> </span>generates <span class="_ _42"> </span>output</span></span></div><div class="t m0 x32 h18f y54ac ff19 fsce fc0 sc0 ls0 ws0">slowly as</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
