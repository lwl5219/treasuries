<div id="pfc9" class="pf w4 h1f" data-page-no="c9"><div class="pc pcc9 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bgc9.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>5.13<span class="_ _f0"> </span><span class="ls719">Te<span class="_ _9"></span></span>mporary <span class="_"> </span>Files<span class="_ _1b"> </span><span class="ff18">167</span></div><div class="t m0 x32 h2a y12f ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _9"></span>standar<span class="ls1a2">dI<span class="_ _b"></span><span class="ls0">/O <span class="_ _9"></span>library <span class="_ _9"></span>used <span class="_ _23"></span>on <span class="_ _9"></span>the <span class="_ _23"></span>four <span class="_ _9"></span>platforms <span class="_ _23"></span>described <span class="_ _9"></span>in <span class="_ _23"></span>this <span class="_ _9"></span>book.<span class="_ _5a"> </span>Be <span class="_ _23"></span>aware</span></span></div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">that <span class="_ _3"></span>implementations <span class="_ _3"></span>of <span class="_ _9"></span>the <span class="_ _3"></span>standar<span class="ls71a">dI<span class="_ _b"></span><span class="ls0">/O <span class="_ _9"></span>library <span class="_ _3"></span>vary<span class="_ _4"></span><span class="ls71a">,a<span class="_ _8"></span><span class="ls0">nd <span class="_ _9"></span>programs <span class="_ _2"></span>like <span class="_ _9"></span>this <span class="_ _3"></span>example</span></span></span></span></div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">ar<span class="ls44">en<span class="_ _4f"></span><span class="ls0">onportable, since they embed knowledge speciﬁc to particular implementations.</span></span></div><div class="t m0 x3f h2a y132 ff19 fsf fc0 sc0 ls0 ws0">If <span class="_ _23"> </span>we <span class="_ _23"> </span>run <span class="_ _23"> </span>the <span class="_ _23"> </span>program <span class="_ _23"> </span>in <span class="_ _23"> </span>Figur<span class="ls71b">e5<span class="_ _43"></span><span class="ls0">.1<span class="_ _1"></span><span class="ls71b">1t<span class="_ _b"></span><span class="ls0">wice, <span class="_ _23"></span>once <span class="_ _23"></span>with <span class="_ _23"> </span>the <span class="_ _23"> </span>three <span class="_ _23"> </span>standar<span class="ls71b">ds<span class="_ _43"></span><span class="ls0">treams</span></span></span></span></span></span></div><div class="t m0 x32 h2a y133 ff19 fsf fc0 sc0 ls0 ws0">connected <span class="_ _9"></span>to <span class="_ _9"></span>the <span class="_ _9"></span>terminal <span class="_ _9"></span>and <span class="_ _9"></span>once <span class="_ _9"></span>with <span class="_ _9"></span>the <span class="_ _9"></span>three <span class="_ _3"></span>standar<span class="ls71c">ds<span class="_ _b"></span><span class="ls0">treams <span class="_ _9"></span>redir<span class="_ _1"></span>ected <span class="_ _9"></span>to <span class="_ _9"></span>ﬁles,</span></span></div><div class="t m0 x32 h2a y134 ff19 fsf fc0 sc0 ls0 ws0">we get the following result:</div><div class="t m0 x3f h57 y1713 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">./a.out<span class="_ _1e4"> </span><span class="ff1b">stdin, stdout, and stderr connected to terminal</span></span></div><div class="t m0 x3f h57 y1714 ff1a fs2d fc0 sc0 ls0 ws0">enter any character</div><div class="t m0 x1cd h58 y1715 ff1b fs2d fc0 sc0 ls0 ws0">we type a newline</div><div class="t m0 x3f h57 y1716 ff1a fs2d fc0 sc0 ls0 ws0">one line to standard error</div><div class="t m0 x3f h57 y1717 ff1a fs2d fc0 sc0 ls0 ws0">stream = stdin, line buffered, buffer size = 1024</div><div class="t m0 x3f h57 y1718 ff1a fs2d fc0 sc0 ls0 ws0">stream = stdout, line buffered, buffer size = 1024</div><div class="t m0 x3f h57 y1719 ff1a fs2d fc0 sc0 ls0 ws0">stream = stderr, unbuffered, buffer size = 1</div><div class="t m0 x3f h57 y171a ff1a fs2d fc0 sc0 ls0 ws0">stream = /etc/passwd, fully buffered, buffer size = 4096</div><div class="t m0 x3f h57 y171b ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">./a.out &lt; /etc/group &gt; std.out 2&gt; std.err</span></div><div class="t m0 x1cd h58 y171c ff1b fs2d fc0 sc0 ls0 ws0">run it again with all three str<span class="_ _0"></span>eams redir<span class="_ _0"></span>ected</div><div class="t m0 x3f h57 y171d ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">cat std.err</span></div><div class="t m0 x3f h57 y171e ff1a fs2d fc0 sc0 ls0 ws0">one line to standard error</div><div class="t m0 x3f h57 y171f ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">cat std.out</span></div><div class="t m0 x3f h57 y1720 ff1a fs2d fc0 sc0 ls0 ws0">enter any character</div><div class="t m0 x3f h57 y1721 ff1a fs2d fc0 sc0 ls0 ws0">stream = stdin, fully buffered, buffer size = 4096</div><div class="t m0 x3f h57 y1722 ff1a fs2d fc0 sc0 ls0 ws0">stream = stdout, fully buffered, buffer size = 4096</div><div class="t m0 x3f h57 y1723 ff1a fs2d fc0 sc0 ls0 ws0">stream = stderr, unbuffered, buffer size = 1</div><div class="t m0 x3f h57 y1724 ff1a fs2d fc0 sc0 ls0 ws0">stream = /etc/passwd, fully buffered, buffer size = 4096</div><div class="t m0 x32 h2a y1725 ff19 fsf fc0 sc0 ls5f ws0">We <span class="_ _35"> </span>c<span class="_ _9"></span><span class="ls0">an <span class="_ _e"> </span>see <span class="_ _e"> </span>that <span class="_ _e"> </span>the <span class="_ _e"> </span>default <span class="_ _53"> </span>for <span class="_ _e"> </span>this <span class="_ _e"> </span>system <span class="_ _e"> </span>is <span class="_ _e"> </span>to <span class="_ _e"> </span>have <span class="_ _e"> </span>standar<span class="ls4ee">di<span class="_ _55"></span><span class="ls0">nput <span class="_ _53"> </span>and <span class="_ _e"> </span>standard</span></span></span></div><div class="t m0 x32 h2a y1726 ff19 fsf fc0 sc0 ls0 ws0">output <span class="_ _e"> </span>line <span class="_ _e"> </span>buffer<span class="_ _0"></span>ed <span class="_ _e"> </span>when <span class="_ _e"> </span>they’r<span class="ls71d">ec<span class="_ _55"></span><span class="ls0">onnected <span class="_ _e"> </span>to <span class="_ _e"> </span>a <span class="_ _e"> </span>terminal.<span class="_ _48"> </span>The <span class="_ _e"> </span>line <span class="_ _e"> </span>buffer <span class="_ _e"> </span>is <span class="_ _e"> </span>1,024</span></span></div><div class="t m0 x32 h2a y1727 ff19 fsf fc0 sc0 ls0 ws0">bytes. <span class="_ _47"> </span>Note<span class="_ _45"> </span>that <span class="_ _3"></span>this <span class="_ _9"></span>doesn’t <span class="_ _3"></span>restrict <span class="_ _3"></span>us <span class="_ _9"></span>to <span class="_ _3"></span>1,024</div><div class="t m0 xcd h2a y1728 ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 xce h2a y1727 ff19 fsf fc0 sc0 ls0 ws0">byte <span class="_ _3"></span>input <span class="_ _9"></span>and <span class="_ _3"></span>output <span class="_ _9"></span>lines; <span class="_ _3"></span>that’s <span class="_ _9"></span>just</div><div class="t m0 x32 h2a y1729 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _53"> </span>size <span class="_ _53"> </span>of <span class="_ _e"> </span>the <span class="_ _53"> </span>buffer<span class="_ _6"></span><span class="ls71e">.W<span class="_ _49"></span><span class="ls0">riting <span class="_ _e"> </span>a <span class="_ _53"> </span>2,048</span></span></div><div class="t m0 x6c h2a y172a ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 x18c h2a y1729 ff19 fsf fc0 sc0 ls0 ws0">byte <span class="_ _53"> </span>line <span class="_ _53"> </span>to <span class="_ _e"> </span>standar<span class="ls71f">do<span class="_ _55"></span><span class="ls0">utput <span class="_ _53"> </span>will <span class="_ _e"> </span>requir<span class="_ _0"></span><span class="ls71f">et<span class="_ _55"></span><span class="ls0">wo</span></span></span></span></div><div class="t m0 x32 h26 y172b ff1a fsf fc0 sc0 ls0 ws0">write<span class="_ _45"> </span><span class="ff19">system <span class="_ _3"></span>calls.<span class="_ _5a"> </span>When <span class="_ _9"></span>we <span class="_ _3"></span>redirect <span class="_ _3"></span>these <span class="_ _9"></span>two <span class="_ _9"></span>streams <span class="_ _3"></span>to <span class="_ _9"></span>regular <span class="_ _3"></span>ﬁles, <span class="_ _9"></span>they <span class="_ _9"></span>become</span></div><div class="t m0 x32 h26 y172c ff19 fsf fc0 sc0 ls0 ws0">fully <span class="_"> </span>buf<span class="_ _0"></span>fer<span class="_ _0"></span>ed, <span class="_"> </span>with <span class="_ _e"> </span>buffer <span class="_ _e"> </span>sizes <span class="_"> </span>equal <span class="_"> </span>to <span class="_ _e"> </span>the <span class="_"> </span>pr<span class="_ _0"></span>eferred <span class="_ _e"> </span>I/O <span class="_"> </span>size<span class="_ _3"></span><span class="ls9d">—t<span class="_ _1"></span><span class="ls0">he<span class="_ _59"> </span><span class="ff1a">st_blksize</span></span></span></div><div class="t m0 x32 h26 y172d ff19 fsf fc0 sc0 ls0 ws0">value <span class="_ _2"></span>from <span class="_ _2"></span>the<span class="_ _47"> </span><span class="ff1a">stat<span class="_ _47"> </span></span>structur<span class="ls9d">e—f<span class="_ _4"></span><span class="ls0">or <span class="_ _3"></span>the <span class="_ _3"></span>ﬁle <span class="_ _2"></span>system.<span class="_ _16"> </span><span class="ls5f">We <span class="_ _e"> </span>a<span class="_ _23"></span></span>lso <span class="_ _2"></span>see <span class="_ _3"></span>that <span class="_ _2"></span>the <span class="_ _3"></span>standar<span class="ls720">de<span class="_ _8"></span><span class="ls0">rror</span></span></span></span></div><div class="t m0 x32 h2a y172e ff19 fsf fc0 sc0 ls0 ws0">is always unbuffer<span class="_ _0"></span>ed, as it should be, and that a r<span class="_ _0"></span>egular ﬁle defaults to fully buffer<span class="_ _0"></span>ed.</div><div class="t m0 x35 h4b y172f ff16 fs27 fc0 sc0 ls0 ws0">5.13 <span class="_ _93"> </span>T<span class="_ _6"></span>emporar <span class="_ _8"></span>y<span class="_ _54"> </span>Files</div><div class="t m0 x32 h49 y1730 ff19 fs26 fc0 sc0 ls0 ws0">The ISO <span class="_ _2"></span>C standar<span class="ls721">dd<span class="_ _4f"></span><span class="ls0">eﬁnes <span class="_ _2"></span>two <span class="_ _2"></span>functions that <span class="_ _2"></span>ar<span class="ls721">ep<span class="_ _4f"></span><span class="lscc">ro<span class="ls0">vided <span class="_ _2"></span>by <span class="_ _2"></span>the standar<span class="ls721">dI<span class="_ _4f"></span><span class="ls0">/O <span class="_ _2"></span>library</span></span></span></span></span></span></span></div><div class="t m0 x32 h49 y1731 ff19 fs26 fc0 sc0 ls0 ws0">to assist in creating temporary ﬁles.</div><div class="t m0 x3f h4e y1732 ff1a fs28 fc0 sc0 ls0 ws0">#include &lt;stdio.h&gt;</div><div class="t m0 x3f h4e y1733 ff1a fs28 fc0 sc0 ls0 ws0">char *tmpnam(char *<span class="ff1b">ptr</span>);</div><div class="t m0 x19c h7c y1734 ff19 fs28 fc0 sc0 ls0 ws0">Returns: pointer to unique pathname</div><div class="t m0 x3f h4e y1735 ff1a fs28 fc0 sc0 ls0 ws0">FILE *tmpfile(void);</div><div class="t m0 x8e h4e y1736 ff19 fs28 fc0 sc0 ls0 ws0">Returns: ﬁle pointer if OK,<span class="_"> </span><span class="ff1a">NULL<span class="_ _e"> </span></span>on error</div><a class="l" href="#pfe" data-dest-detail='[14,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.892634px;bottom:394.440905px;width:131.436699px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
