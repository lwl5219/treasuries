<div id="pf57" class="pf w4 h1f" data-page-no="57"><div class="pc pc57 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg57.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>2.6<span class="_ _140"> </span>Options<span class="_ _1b"> </span><span class="ff18">53</span></div><div class="t m0 x3f h26 y12f ff19 fsf fc0 sc0 ls0 ws0">For <span class="_ _2"></span>example, <span class="_ _3"></span>we <span class="_ _2"></span>can <span class="_ _3"></span>use <span class="_ _3"></span>the<span class="_ _47"> </span><span class="ff1a">ulimit<span class="_ _47"> </span></span>command <span class="_ _2"></span>built <span class="_ _2"></span>into <span class="_ _3"></span>the <span class="_ _3"></span>Bourne-again <span class="_ _2"></span>shell <span class="_ _3"></span>to</div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">change <span class="_ _23"> </span>the <span class="_ _23"> </span>maximum <span class="_ _42"> </span>number <span class="_ _23"> </span>of <span class="_ _23"> </span>ﬁles <span class="_ _42"> </span>our <span class="_ _23"></span>processes <span class="_ _23"></span>can <span class="_ _23"></span>have <span class="_ _23"> </span>open <span class="_ _42"> </span>at <span class="_ _23"></span>one <span class="_ _23"> </span>time.<span class="_ _51"> </span>This</div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">generally <span class="_ _44"> </span>requires <span class="_ _44"> </span>special <span class="_ _44"> </span>(superuser) <span class="_ _4b"> </span>privileges <span class="_ _4b"> </span>if <span class="_ _44"> </span>the <span class="_ _4b"> </span>limit <span class="_ _44"> </span>is <span class="_ _4b"> </span>to <span class="_ _4b"> </span>be <span class="_ _44"> </span>effectively</div><div class="t m0 x32 h26 y132 ff19 fsf fc0 sc0 ls0 ws0">unlimited. <span class="_ _4b"> </span>But<span class="_ _4b"> </span>once <span class="_"> </span>set <span class="_ _53"> </span>to <span class="_ _e"> </span>inﬁnite,<span class="_ _4b"> </span><span class="ff1a">sysconf<span class="_ _59"> </span></span>will <span class="_ _e"> </span>report<span class="_ _44"> </span><span class="ff1a">LONG_MAX<span class="_ _59"> </span></span>as <span class="_ _e"> </span>the <span class="_ _e"> </span>limit <span class="_ _e"> </span>for</div><div class="t m0 x32 h26 y133 ff1a fsf fc0 sc0 ls0 ws0">OPEN_MAX<span class="ff19 ls2ee">.A<span class="_ _d"></span><span class="ls0">program that relies on this value as the <span class="_ _2"></span>upper bound of <span class="_ _2"></span>ﬁle descriptors to</span></span></div><div class="t m0 x32 h2a y134 ff19 fsf fc0 sc0 ls0 ws0">close, <span class="_ _9"></span>as <span class="_ _3"></span>shown <span class="_ _9"></span>in <span class="_ _9"></span>Figur<span class="ls1b0">e2<span class="_ _b"></span><span class="ls0">.17, <span class="_ _9"></span>will <span class="_ _9"></span>waste <span class="_ _3"></span>a <span class="_ _9"></span>lot <span class="_ _9"></span>of <span class="_ _9"></span>time <span class="_ _9"></span>trying <span class="_ _9"></span>to <span class="_ _9"></span>close <span class="_ _3"></span>2,147,483,647 <span class="_ _9"></span>ﬁle</span></span></div><div class="t m0 x32 h2a y135 ff19 fsf fc0 sc0 ls0 ws0">descriptors, most of which aren’t even in use.</div><div class="t m0 x3f h2a y136 ff19 fsf fc0 sc0 ls0 ws0">Systems <span class="_ _9"></span>that <span class="_ _9"></span>support <span class="_ _23"></span>the <span class="_ _9"></span>XSI <span class="_ _9"></span>option <span class="_ _23"></span>in <span class="_ _9"></span>the <span class="_ _9"></span>Single <span class="_ _23"></span>UNIX <span class="_ _9"></span>Speciﬁcation <span class="_ _9"></span>will <span class="_ _23"></span>pr<span class="_ _0"></span>ovide</div><div class="t m0 x32 h26 y137 ff19 fsf fc0 sc0 ls0 ws0">the<span class="_ _61"> </span><span class="ff1a">getrlimit</span></div><div class="t m0 x8 h2a y921 ff19 fsf fc0 sc0 ls0 ws0">(</div><div class="t m0 x143 h2a y137 ff19 fsf fc0 sc0 ls0 ws0">2</div><div class="t m0 x144 h2a y921 ff19 fsf fc0 sc0 ls0 ws0">)</div><div class="t m0 x38 h2a y137 ff19 fsf fc0 sc0 ls0 ws0">function <span class="_ _66"> </span>(Section <span class="_ _47"> </span>7.1<span class="_ _1"></span>1). <span class="_ _61"> </span>It<span class="_ _61"> </span>can <span class="_ _66"> </span>be <span class="_ _47"> </span>used <span class="_ _66"> </span>to <span class="_ _47"> </span>return <span class="_"> </span>the <span class="_ _47"> </span>maximum</div><div class="t m0 x32 h2a y138 ff19 fsf fc0 sc0 ls0 ws0">number <span class="_ _2"></span>of <span class="_ _2"></span>descriptors <span class="_ _3"></span>that <span class="_ _2"></span>a <span class="_ _3"></span>process can <span class="_ _3"></span>have <span class="_ _2"></span>open.<span class="_ _61"> </span><span class="ls65">Wi<span class="_ _3"></span></span>th <span class="_ _3"></span>it, <span class="_ _2"></span>we <span class="_ _3"></span>can <span class="_ _2"></span>detect <span class="_ _2"></span>that <span class="_ _3"></span>ther<span class="ls76">ei<span class="_ _8"></span><span class="ls0">s</span></span></div><div class="t m0 x32 h2a y139 ff19 fsf fc0 sc0 ls0 ws0">no <span class="_ _3"></span>conﬁgured <span class="_ _3"></span>upper <span class="_ _9"></span>bound <span class="_ _9"></span>to <span class="_ _3"></span>the <span class="_ _9"></span>number <span class="_ _9"></span>of <span class="_ _3"></span>open <span class="_ _9"></span>ﬁles <span class="_ _9"></span>our <span class="_ _3"></span>processes <span class="_ _3"></span>can <span class="_ _9"></span>open, <span class="_ _9"></span>so <span class="_ _3"></span>we</div><div class="t m0 x32 h2a y13a ff19 fsf fc0 sc0 ls0 ws0">can avoid this problem.</div><div class="t m0 x76 h52 y922 ff19 fs2a fc0 sc0 ls0 ws0">The<span class="_ _80"> </span><span class="ff1a">OPEN_MAX<span class="_ _80"> </span></span>value <span class="_ _3"></span>is <span class="_ _3"></span>called <span class="_ _3"></span>runtime <span class="_ _2"></span>invariant <span class="_ _3"></span>by <span class="_ _2"></span>POSIX, <span class="_ _3"></span>meaning <span class="_ _3"></span>that <span class="_ _3"></span>its <span class="_ _2"></span>value <span class="_ _3"></span>should <span class="_ _3"></span>not</div><div class="t m0 x76 h51 y923 ff19 fs2a fc0 sc0 ls0 ws0">change <span class="_ _9"></span>during <span class="_ _3"></span>the <span class="_ _9"></span>lifetime <span class="_ _9"></span>of <span class="_ _9"></span>a <span class="_ _9"></span>process. <span class="_ _66"> </span>But<span class="_ _66"> </span>on <span class="_ _9"></span>systems <span class="_ _9"></span>that <span class="_ _9"></span>support <span class="_ _3"></span>the <span class="_ _9"> </span>XSI <span class="_ _9"></span>option, <span class="_ _9"></span>we <span class="_ _9"></span>can</div><div class="t m0 x76 h52 y924 ff19 fs2a fc0 sc0 ls0 ws0">call the<span class="_ _80"> </span><span class="ff1a">setrlimit</span></div><div class="t m0 x13c h51 y925 ff19 fs2a fc0 sc0 ls0 ws0">(</div><div class="t m0 x145 h51 y924 ff19 fs2a fc0 sc0 ls0 ws0">2</div><div class="t m0 x59 h51 y925 ff19 fs2a fc0 sc0 ls0 ws0">)</div><div class="t m0 x146 h51 y924 ff19 fs2a fc0 sc0 ls0 ws0">function (Section <span class="_ _2"></span>7.1<span class="_ _0"></span>1) to <span class="_ _2"></span>change this <span class="_ _2"></span>value for <span class="_ _2"></span>a <span class="_ _2"></span>running process. <span class="_"> </span>(This</div><div class="t m0 x76 h52 y926 ff19 fs2a fc0 sc0 ls0 ws0">value <span class="_ _3"></span>can <span class="_ _9"></span>also <span class="_ _3"></span>be <span class="_ _9"></span>changed <span class="_ _3"></span>from <span class="_ _3"></span>the <span class="_ _9"></span>C <span class="_ _3"></span>shell <span class="_ _9"></span>with <span class="_ _3"></span>the<span class="_ _47"> </span><span class="ff1a">limit<span class="_ _66"> </span></span>command, <span class="_ _3"></span>and <span class="_ _9"></span>from <span class="_ _3"></span>the <span class="_ _3"></span>Bourne,</div><div class="t m0 x76 h52 y927 ff19 fs2a fc0 sc0 ls0 ws0">Bourne-again, <span class="_ _3"></span>Debian <span class="_ _9"></span>Almquist, <span class="_ _9"></span>and <span class="_ _9"></span>Korn <span class="_ _3"></span>shells <span class="_ _9"></span>with <span class="_ _9"></span>the<span class="_ _66"> </span><span class="ff1a">ulimit<span class="_ _47"> </span></span>command.) <span class="_ _66"> </span>If<span class="_ _66"> </span>our <span class="_ _9"></span>system</div><div class="t m0 x76 h52 y928 ff19 fs2a fc0 sc0 ls0 ws0">supports <span class="_ _2"></span>this <span class="_ _2"></span>functionality<span class="_ _6"></span>,<span class="_ _80"> </span>we<span class="_ _80"> </span>could <span class="_ _2"></span>change <span class="_ _2"></span>the <span class="_ _2"></span>function <span class="_ _2"></span>in <span class="_ _3"></span>Figur<span class="ls2ef">e2<span class="_ _d"></span><span class="ls0">.17 <span class="_ _2"></span>to <span class="_ _3"></span>call<span class="_ _80"> </span><span class="ff1a">sysconf<span class="_ _e"> </span></span>every</span></span></div><div class="t m0 x76 h51 y929 ff19 fs2a fc0 sc0 ls0 ws0">time it is called, not just the ﬁrst time.</div><div class="t m0 x35 h53 y92a ff16 fs2b fc0 sc0 ls0 ws0">2.6 <span class="_ _68"> </span>Options</div><div class="t m0 x32 h2a y92b ff19 fsf fc0 sc0 ls5f ws0">We <span class="_ _45"> </span>s<span class="_ _9"></span><span class="ls0">aw <span class="_ _23"> </span>the <span class="_ _42"> </span>list <span class="_ _42"> </span>of <span class="_ _23"> </span>POSIX.1 <span class="_ _42"> </span>options <span class="_ _42"> </span>in <span class="_ _23"> </span>Figur<span class="ls2f0">e2<span class="_ _43"></span><span class="ls0">.5 <span class="_ _23"> </span>and <span class="_ _42"> </span>discussed <span class="_ _42"> </span>XSI <span class="_ _23"> </span>option <span class="_ _42"> </span>groups <span class="_ _23"> </span>in</span></span></span></div><div class="t m0 x32 h2a y92c ff19 fsf fc0 sc0 ls0 ws0">Section <span class="_"> </span>2.2.3.<span class="_ _65"> </span>If <span class="_"> </span>we <span class="_ _e"> </span>are<span class="_ _4b"> </span>to<span class="_ _59"> </span>write <span class="_"> </span>portable <span class="_ _e"> </span>applications <span class="_"> </span>that <span class="_ _e"> </span>depend <span class="_"> </span>on <span class="_ _53"> </span>any <span class="_"> </span>of <span class="_ _e"> </span>these</div><div class="t m0 x32 h2a y92d ff19 fsf fc0 sc0 ls0 ws0">optionally <span class="_ _45"> </span>supported <span class="_ _45"> </span>featur<span class="_ _0"></span>es, <span class="_ _45"> </span>we <span class="_ _47"> </span>need <span class="_ _45"> </span>a <span class="_ _45"> </span>portable <span class="_ _45"> </span>way <span class="_ _45"> </span>to <span class="_ _45"> </span>determine <span class="_ _47"> </span>whether <span class="_ _45"> </span>an</div><div class="t m0 x32 h2a y92e ff19 fsf fc0 sc0 ls0 ws0">implementation supports a given option.</div><div class="t m0 x3f h2a y92f ff19 fsf fc0 sc0 ls0 ws0">Just as with limits (Section 2.5), POSIX.1 deﬁnes three ways to do this.</div><div class="t m0 x3f h26 y930 ff19 fsf fc0 sc0 ls0 ws0">1. <span class="_ _51"> </span>Compile-time<span class="_"> </span>options ar<span class="ls44">ed<span class="_ _4f"></span><span class="ls0">eﬁned in<span class="_"> </span><span class="ff1a">&lt;unistd.h&gt;</span>.</span></span></div><div class="t m0 x3f h2a y931 ff19 fsf fc0 sc0 ls0 ws0">2. <span class="_ _51"> </span>Runtime<span class="_ _45"> </span>options <span class="_ _9"></span>that <span class="_ _9"></span>ar<span class="ls2f1">en<span class="_ _b"></span><span class="ls0">ot <span class="_ _3"></span>associated <span class="_ _9"></span>with <span class="_ _9"></span>a <span class="_ _9"></span>ﬁle <span class="_ _9"></span>or <span class="_ _9"></span>a <span class="_ _9"></span>directory <span class="_ _9"></span>ar<span class="_ _0"></span><span class="ls2f2">ei<span class="_ _b"></span><span class="ls0">dentiﬁed</span></span></span></span></div><div class="t m0 x41 h26 y932 ff19 fsf fc0 sc0 ls0 ws0">with the<span class="_"> </span><span class="ff1a">sysconf<span class="_ _80"> </span></span>function.</div><div class="t m0 x3f h2a y933 ff19 fsf fc0 sc0 ls0 ws0">3. <span class="_ _51"> </span>Runtime<span class="_ _47"> </span>options <span class="_ _9"></span>that <span class="_ _3"></span>ar<span class="ls2f3">ea<span class="_ _8"></span><span class="ls0">ssociated <span class="_ _3"></span>with <span class="_ _9"></span>a <span class="_ _3"></span>ﬁle <span class="_ _9"></span>or <span class="_ _3"></span>a <span class="_ _3"></span>directory <span class="_ _3"></span>ar<span class="ls2f4">ed<span class="_ _b"></span><span class="ls0">iscovered <span class="_ _3"></span>by</span></span></span></span></div><div class="t m0 x41 h26 y934 ff19 fsf fc0 sc0 ls0 ws0">calling either the<span class="_"> </span><span class="ff1a">pathconf<span class="_ _80"> </span></span>or the<span class="_"> </span><span class="ff1a">fpathconf<span class="_ _66"> </span></span>function.</div><div class="t m0 x3f h2a y935 ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _3"></span>options <span class="_ _3"></span>include <span class="_ _3"></span>the <span class="_ _9"></span>symbols <span class="_ _3"></span>listed <span class="_ _3"></span>in <span class="_ _3"></span>the <span class="_ _9"></span>thir<span class="_ _0"></span><span class="ls2f5">dc<span class="_ _8"></span><span class="ls0">olumn <span class="_ _3"></span>of <span class="_ _3"></span>Figur<span class="ls2f5">e2<span class="_ _8"></span><span class="ls0">.5, <span class="_ _3"></span>as <span class="_ _3"></span>well <span class="_ _3"></span>as</span></span></span></span></div><div class="t m0 x32 h2a y936 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _3"></span>symbols <span class="_ _9"></span>listed <span class="_ _3"></span>in <span class="_ _9"></span>Figures <span class="_ _3"></span>2.19 <span class="_ _3"></span>and <span class="_ _9"></span>2.18.<span class="_ _16"> </span>If <span class="_ _9"></span>the <span class="_ _3"></span>symbolic <span class="_ _9"></span>constant <span class="_ _3"></span>is <span class="_ _9"></span>not <span class="_ _3"></span>deﬁned, <span class="_ _9"></span>we</div><div class="t m0 x32 h26 y937 ff19 fsf fc0 sc0 ls0 ws0">must <span class="_"> </span>use<span class="_ _59"> </span><span class="ff1a">sysconf</span>,<span class="_ _59"> </span><span class="ff1a">pathconf</span><span class="ls2f6">,o<span class="_ _4a"></span><span class="ls0">r<span class="_ _59"> </span><span class="ff1a">fpathconf<span class="_ _46"> </span></span>to <span class="_"> </span>determine <span class="_ _e"> </span>whether <span class="_"> </span>the <span class="_"> </span>option <span class="_ _e"> </span>is</span></span></div><div class="t m0 x32 h2b y938 ff19 fsf fc0 sc0 ls0 ws0">supported. <span class="_ _45"> </span>In<span class="_ _45"> </span>this <span class="_ _23"></span>case, <span class="_ _9"></span>the<span class="_ _45"> </span><span class="ff1b">name<span class="_ _45"> </span></span>argument <span class="_ _9"></span>to <span class="_ _23"></span>the <span class="_ _9"></span>function <span class="_ _23"></span>is <span class="_ _9"></span>formed <span class="_ _9"></span>by <span class="_ _23"></span>replacing <span class="_ _3"></span>the</div><div class="t m0 x32 h26 y939 ff1a fsf fc0 sc0 ls0 ws0">_POSIX<span class="_ _66"> </span><span class="ff19">at <span class="_ _2"></span>the <span class="_ _3"></span>beginning <span class="_ _2"></span>of <span class="_ _2"></span>the <span class="_ _2"></span>symbol <span class="_ _3"></span>with<span class="_ _66"> </span></span>_SC<span class="_ _47"> </span><span class="ff19">or<span class="_ _66"> </span></span>_PC<span class="ff19 ls2f7">.F<span class="_ _5b"></span><span class="ls0">or <span class="_ _3"></span>constants <span class="_ _2"></span>that <span class="_ _2"></span>begin <span class="_ _2"></span>with</span></span></div><div class="t m0 x32 h26 y93a ff1a fsf fc0 sc0 ls0 ws0">_XOPEN<span class="ff19 ls2f8">,t<span class="_ _b"></span><span class="ls0">he<span class="_ _45"> </span><span class="ff1b">name<span class="_ _47"> </span></span>argument <span class="_ _9"></span>is <span class="_ _3"></span>formed <span class="_ _9"></span>by <span class="_ _3"></span>prepending <span class="_ _9"></span>the <span class="_ _3"></span>string <span class="_ _9"></span>with<span class="_ _45"> </span><span class="ff1a">_SC<span class="_ _47"> </span></span>or<span class="_ _45"> </span><span class="ff1a">_PC</span><span class="ls2f9">.F<span class="_ _62"></span><span class="ls0">or</span></span></span></span></div><div class="t m0 x32 h26 y93b ff19 fsf fc0 sc0 ls0 ws0">example, <span class="_ _53"> </span>if <span class="_ _53"> </span>the <span class="_ _53"> </span>constant<span class="_ _4b"> </span><span class="ff1a">_POSIX_RAW_SOCKETS<span class="_ _4b"> </span></span>is <span class="_ _53"> </span>undeﬁned, <span class="_ _53"> </span>we <span class="_ _e"> </span>can <span class="_ _53"> </span>call<span class="_ _4b"> </span><span class="ff1a">sysconf</span></div><div class="t m0 x32 h26 y93c ff19 fsf fc0 sc0 ls0 ws0">with <span class="_ _9"></span>the<span class="_ _45"> </span><span class="ff1b">name<span class="_ _45"> </span></span>ar<span class="_ _0"></span>gument <span class="_ _9"></span>set <span class="_ _9"></span>to<span class="_ _45"> </span><span class="ff1a">_SC_RAW_SOCKETS<span class="_ _45"> </span></span>to <span class="_ _3"></span>determine <span class="_ _9"></span>whether <span class="_ _9"></span>the <span class="_ _9"></span>platform</div><div class="t m0 x32 h26 y93d ff19 fsf fc0 sc0 ls0 ws0">supports <span class="_ _23"> </span>the <span class="_ _42"> </span>raw <span class="_ _23"> </span>sockets <span class="_ _42"> </span>option.<span class="_ _51"> </span>If <span class="_ _23"> </span>the <span class="_ _42"> </span>constant<span class="_ _35"> </span><span class="ff1a">_XOPEN_UNIX<span class="_ _35"> </span></span>is <span class="_ _42"> </span>undeﬁned, <span class="_ _23"> </span>we <span class="_ _42"> </span>can</div><div class="t m0 x32 h26 y93e ff19 fsf fc0 sc0 ls0 ws0">call<span class="_ _45"> </span><span class="ff1a">sysconf<span class="_ _45"> </span></span>with <span class="_ _9"></span>the<span class="_ _35"> </span><span class="ff1b">name<span class="_ _45"> </span></span>argument <span class="_ _3"></span>set <span class="_ _23"></span>to<span class="_ _45"> </span><span class="ff1a">_SC_XOPEN_UNIX<span class="_ _45"> </span></span>to <span class="_ _9"></span>determine <span class="_ _23"></span>whether</div><div class="t m0 x32 h2a y93f ff19 fsf fc0 sc0 ls0 ws0">the platform supports the XSI option interfaces.</div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.892842px;bottom:712.548928px;width:81.335602px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
