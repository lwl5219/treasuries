<div id="pfef" class="pf w4 h1f" data-page-no="ef"><div class="pc pcef w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bgef.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>7.6<span class="_ _20e"> </span>Memory <span class="_"> </span>Layout <span class="_"> </span>of <span class="_"> </span>a <span class="_"> </span>C <span class="_"> </span>Program<span class="_ _1fb"> </span><span class="ff18">205</span></div><div class="t m0 x3f h2a y12f ff19 fsf fc0 sc0 ls49 ws0">•I<span class="_ _4d"></span><span class="ls0">nitialized <span class="_"> </span>data <span class="_ _e"> </span>segment, <span class="_"> </span>usually <span class="_"> </span>called <span class="_ _e"> </span>simply <span class="_"> </span>the <span class="_"> </span>data <span class="_ _e"> </span>segment, <span class="_"> </span>containing</span></div><div class="t m0 x15 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">variables <span class="_ _e"> </span>that <span class="_ _e"> </span>ar<span class="ls861">es<span class="_ _4a"></span><span class="ls0">peciﬁcally <span class="_"> </span>initialized <span class="_ _53"> </span>in <span class="_ _e"> </span>the <span class="_ _e"> </span>program. <span class="_ _4b"> </span>For<span class="_ _4b"> </span>example, <span class="_ _e"> </span>the <span class="_"> </span>C</span></span></div><div class="t m0 x15 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">declaration</div><div class="t m0 x1aa h57 y1bbb ff1a fs2d fc0 sc0 ls0 ws0">int <span class="_ _d9"> </span>maxcount<span class="_"> </span><span class="ls15c">=9<span class="_ _5b"></span><span class="ls0">9;</span></span></div><div class="t m0 x15 h2a y1bbc ff19 fsf fc0 sc0 ls0 ws0">appearing outside any <span class="_ _2"></span>function causes <span class="_ _2"></span>this variable to <span class="_ _2"></span>be stored in the <span class="_ _2"></span>initialized</div><div class="t m0 x15 h2a y1bbd ff19 fsf fc0 sc0 ls0 ws0">data segment with its initial value.</div><div class="t m0 x3f h2a y1bbe ff19 fsf fc0 sc0 ls49 ws0">•U<span class="_ _4d"></span><span class="ls0">ninitialized <span class="_"> </span>data <span class="_"> </span>segment, <span class="_ _66"> </span>often <span class="_ _66"> </span>called <span class="_ _66"> </span>the <span class="_ _66"> </span>‘‘bss’<span class="_ _1"></span><span class="ls862">’s<span class="_ _5b"></span><span class="ls0">egment, <span class="_ _66"> </span>named <span class="_ _66"> </span>after <span class="_ _66"> </span>an</span></span></span></div><div class="t m0 x15 h2a y1bbf ff19 fsf fc0 sc0 ls0 ws0">ancient <span class="_ _42"> </span>assembler <span class="_ _42"> </span>operator <span class="_ _42"> </span>that <span class="_ _42"> </span>stood <span class="_ _53"> </span>for <span class="_ _42"> </span>‘<span class="_ _0"></span>‘block <span class="_ _42"> </span>started <span class="_ _42"> </span>by <span class="_ _42"> </span>symbol.’<span class="ls863">’D<span class="_ _52"></span><span class="ls0">ata <span class="_ _42"> </span>in</span></span></div><div class="t m0 x15 h2a y1bc0 ff19 fsf fc0 sc0 ls0 ws0">this segment is initialized by the kernel to arithmetic 0 or null pointers befor<span class="ls864">et<span class="_ _d"></span><span class="ls0">he</span></span></div><div class="t m0 x15 h2a y1bc1 ff19 fsf fc0 sc0 ls0 ws0">program starts executing.<span class="_ _59"> </span>The C declaration</div><div class="t m0 x1aa h57 y1bc2 ff1a fs2d fc0 sc0 ls0 ws0">long <span class="_ _d9"> </span>sum[1000];</div><div class="t m0 x15 h2a y1bc3 ff19 fsf fc0 sc0 ls0 ws0">appearing <span class="_ _44"> </span>outside <span class="_ _4b"> </span>any <span class="_ _4b"> </span>function <span class="_ _4b"> </span>causes <span class="_ _44"> </span>this <span class="_ _4b"> </span>variable <span class="_ _4b"> </span>to <span class="_ _4b"> </span>be <span class="_ _44"> </span>stored <span class="_ _4b"> </span>in <span class="_ _4b"> </span>the</div><div class="t m0 x15 h2a y1bc4 ff19 fsf fc0 sc0 ls0 ws0">uninitialized data segment.</div><div class="t m0 x3f h2a y1bc5 ff19 fsf fc0 sc0 ls49 ws0">•S<span class="_ _4d"></span><span class="ls0">tack, wher<span class="ls4ac">ea<span class="_ _4f"></span><span class="ls0">utomatic variables ar<span class="ls4ac">es<span class="_ _d"></span><span class="ls0">tored, along with information that is saved</span></span></span></span></span></div><div class="t m0 x15 h2a y1bc6 ff19 fsf fc0 sc0 ls0 ws0">each <span class="_ _53"> </span>time <span class="_ _53"> </span>a <span class="_ _53"> </span>function <span class="_ _53"> </span>is <span class="_ _53"> </span>called.<span class="_ _65"> </span>Each <span class="_ _53"> </span>time <span class="_ _e"> </span>a <span class="_ _53"> </span>function <span class="_ _53"> </span>is <span class="_ _53"> </span>called, <span class="_ _53"> </span>the <span class="_ _e"> </span>address <span class="_ _42"> </span>of</div><div class="t m0 x15 h2a y1bc7 ff19 fsf fc0 sc0 ls0 ws0">where<span class="_ _66"> </span>to<span class="_ _45"> </span>r<span class="_ _0"></span>eturn <span class="_ _3"></span>to <span class="_ _3"></span>and <span class="_ _3"></span>certain <span class="_ _3"></span>information <span class="_ _3"></span>about <span class="_ _9"></span>the <span class="_ _3"></span>caller<span class="_ _9"></span>’s <span class="_ _3"></span>environment, <span class="_ _2"></span>such</div><div class="t m0 x15 h2a y1bc8 ff19 fsf fc0 sc0 ls0 ws0">as <span class="_"> </span>some <span class="_ _53"> </span>of <span class="_"> </span>the <span class="_"> </span>machine <span class="_ _53"> </span>registers, <span class="_"> </span>ar<span class="_ _1"></span><span class="ls865">es<span class="_ _55"></span><span class="ls0">aved <span class="_"> </span>on <span class="_ _e"> </span>the <span class="_"> </span>stack.<span class="_ _65"> </span>The <span class="_"> </span>newly <span class="_ _e"> </span>called</span></span></div><div class="t m0 x15 h2a y1bc9 ff19 fsf fc0 sc0 ls0 ws0">function <span class="_ _47"> </span>then <span class="_ _47"> </span>allocates <span class="_ _66"> </span>room <span class="_ _47"> </span>on <span class="_ _47"> </span>the <span class="_ _47"> </span>stack <span class="_ _47"> </span>for <span class="_ _47"> </span>its <span class="_ _66"> </span>automatic <span class="_ _47"> </span>and <span class="_ _47"> </span>temporary</div><div class="t m0 x15 h2a y1bca ff19 fsf fc0 sc0 ls0 ws0">variables. <span class="_ _47"> </span>This<span class="_ _66"> </span>is <span class="_ _3"></span>how <span class="_ _3"></span>recursive <span class="_ _2"></span>functions <span class="_ _2"></span>in <span class="_ _3"></span>C <span class="_ _3"></span>can <span class="_ _2"></span>work.<span class="_ _16"> </span>Each <span class="_ _3"></span>time <span class="_ _2"></span>a <span class="_ _3"></span>recursive</div><div class="t m0 x15 h2a y1bcb ff19 fsf fc0 sc0 ls0 ws0">function <span class="_ _23"> </span>calls <span class="_ _42"> </span>itself, <span class="_ _23"> </span>a <span class="_ _42"> </span>new <span class="_ _23"> </span>stack <span class="_ _42"> </span>frame <span class="_ _23"> </span>is <span class="_ _42"> </span>used, <span class="_ _23"> </span>so <span class="_ _42"> </span>one <span class="_ _23"> </span>set <span class="_ _42"> </span>of <span class="_ _23"> </span>variables <span class="_ _42"> </span>doesn’t</div><div class="t m0 x15 h2a y1bcc ff19 fsf fc0 sc0 ls0 ws0">interfer<span class="ls44">ew<span class="_ _4f"></span><span class="ls0">ith the variables from another instance of the function.</span></span></div><div class="t m0 x3f h2a y1bcd ff19 fsf fc0 sc0 ls49 ws0">•H<span class="_ _4d"></span><span class="ls0">eap, <span class="_ _23"></span>wher<span class="ls3f1">ed<span class="_ _43"></span><span class="ls0">ynamic <span class="_ _23"></span>memory <span class="_ _23"></span>allocation <span class="_ _23"></span>usually <span class="_ _9"></span>takes <span class="_ _23"> </span>place.<span class="_ _51"> </span>Historically<span class="_ _4"></span><span class="ls866">,t<span class="_ _b"></span><span class="ls0">he</span></span></span></span></span></div><div class="t m0 x15 h2a y1bce ff19 fsf fc0 sc0 ls0 ws0">heap has been located between the uninitialized data and the stack.</div><div class="t m0 x32 h2a y1bcf ff19 fsf fc0 sc0 ls0 ws0">Figur<span class="ls867">e7<span class="_ _8"></span><span class="ls0">.6 <span class="_ _2"></span>shows <span class="_ _3"></span>the <span class="_ _3"></span>typical <span class="_ _3"></span>arrangement <span class="_ _2"></span>of <span class="_ _3"></span>these <span class="_ _3"></span>segments.<span class="_ _61"> </span>This <span class="_ _3"></span>is <span class="_ _3"></span>a <span class="_ _2"></span>logical <span class="_ _3"></span>pictur<span class="ls868">eo<span class="_ _8"></span><span class="ls0">f</span></span></span></span></div><div class="t m0 x32 h2a y1bd0 ff19 fsf fc0 sc0 ls0 ws0">how <span class="_ _9"></span>a <span class="_ _9"></span>program <span class="_ _3"></span>looks; <span class="_ _9"></span>there<span class="_ _45"> </span>is<span class="_ _47"> </span>no<span class="_ _45"> </span>requirement <span class="_ _3"></span>that <span class="_ _9"></span>a <span class="_ _9"></span>given <span class="_ _9"></span>implementation <span class="_ _9"></span>arrange <span class="_ _9"></span>its</div><div class="t m0 x32 h2a y1bd1 ff19 fsf fc0 sc0 ls0 ws0">memory <span class="_ _9"></span>in <span class="_ _9"></span>this <span class="_ _9"></span>fashion.<span class="_ _5a"> </span>Nevertheless, <span class="_ _9"></span>this <span class="_ _9"></span>gives <span class="_ _9"></span>us <span class="_ _23"></span>a <span class="_ _9"></span>typical <span class="_ _9"></span>arrangement <span class="_ _9"></span>to <span class="_ _9"></span>describe.</div><div class="t m0 x32 h2a y1bd2 ff19 fsf fc0 sc0 ls65 ws0">Wi<span class="_ _3"></span><span class="ls0">th <span class="_ _44"> </span>Linux <span class="_ _44"> </span>on <span class="_ _44"> </span>a <span class="_ _44"> </span>32</span></div><div class="t m0 x108 h2a y1bd3 ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 x3c h2a y1bd2 ff19 fsf fc0 sc0 ls0 ws0">bit <span class="_ _44"> </span>Intel <span class="_ _44"> </span>x86 <span class="_ _44"> </span>processor<span class="_ _6"></span><span class="ls869">,t<span class="_ _52"></span><span class="ls0">he <span class="_ _44"> </span>text <span class="_ _44"> </span>segment <span class="_ _44"> </span>starts <span class="_ _44"> </span>at <span class="_ _44"> </span>location</span></span></div><div class="t m0 x32 h26 y1bd4 ff1a fsf fc0 sc0 ls0 ws0">0x08048000<span class="ff19 ls86a">,a<span class="_ _43"></span><span class="ls0">nd <span class="_ _23"> </span>the <span class="_ _42"> </span>bottom <span class="_ _23"></span>of <span class="_ _23"> </span>the <span class="_ _23"> </span>stack <span class="_ _42"> </span>starts <span class="_ _23"></span>just <span class="_ _23"> </span>below<span class="_ _35"> </span><span class="ff1a">0xC0000000</span><span class="ls86b">.(<span class="_ _7"></span><span class="ls0">The <span class="_ _42"> </span>stack</span></span></span></span></div><div class="t m0 x32 h2a y1bd5 ff19 fsf fc0 sc0 ls0 ws0">grows fr<span class="_ _0"></span>om higher-number<span class="_ _0"></span>ed addresses to lower-number<span class="_ _1"></span>ed <span class="_ _2"></span>addresses on this particular</div><div class="t m0 x32 h2a y1bd6 ff19 fsf fc0 sc0 ls0 ws0">architectur<span class="_ _0"></span>e.) <span class="_"> </span>The<span class="_"> </span>unused virtual address space between the top of the heap and the top</div><div class="t m0 x32 h2a y1bd7 ff19 fsf fc0 sc0 ls0 ws0">of the stack is large.</div><div class="t m0 x76 h52 y1bd8 ff19 fs2a fc0 sc0 ls0 ws0">Several <span class="_ _80"> </span>mor<span class="ls86c">es<span class="_ _55"></span><span class="ls0">egment <span class="_ _80"> </span>types <span class="_ _80"> </span>exist <span class="_ _66"> </span>in <span class="_ _80"> </span>an<span class="_ _4b"> </span><span class="ff1a">a.out</span><span class="ls86d">,c<span class="_ _55"></span><span class="ls0">ontaining <span class="_ _66"> </span>the <span class="_ _80"> </span>symbol <span class="_ _80"> </span>table, <span class="_ _80"> </span>debugging</span></span></span></span></div><div class="t m0 x76 h51 y1bd9 ff19 fs2a fc0 sc0 ls0 ws0">information, <span class="_ _66"> </span>linkage <span class="_ _80"> </span>tables <span class="_ _66"> </span>for <span class="_ _66"> </span>dynamic <span class="_ _66"> </span>shared <span class="_ _80"> </span>libraries, <span class="_ _66"> </span>and <span class="_ _66"> </span>the <span class="_ _66"> </span>like.<span class="_ _54"> </span>These <span class="_ _66"> </span>additional</div><div class="t m0 x76 h51 y1bda ff19 fs2a fc0 sc0 ls0 ws0">sections don’t get loaded as part of the program’s image executed by a pr<span class="_ _0"></span>ocess.</div><div class="t m0 x3f h2a y1bdb ff19 fsf fc0 sc0 ls0 ws0">Note <span class="_ _42"> </span>from <span class="_ _53"> </span>Figur<span class="ls86e">e7<span class="_ _55"></span><span class="ls0">.6 <span class="_ _53"> </span>that <span class="_ _53"> </span>the <span class="_ _53"> </span>contents <span class="_ _53"> </span>of <span class="_ _53"> </span>the <span class="_ _53"> </span>uninitialized <span class="_ _42"> </span>data <span class="_ _53"> </span>segment <span class="_ _53"> </span>ar<span class="ls86f">en<span class="_ _c"></span><span class="ls0">ot</span></span></span></span></div><div class="t m0 x32 h2a y1bdc ff19 fsf fc0 sc0 ls0 ws0">stored <span class="_ _9"></span>in <span class="_ _9"></span>the <span class="_ _9"></span>program <span class="_ _9"></span>ﬁle <span class="_ _23"></span>on <span class="_ _9"></span>disk, <span class="_ _9"></span>because <span class="_ _23"></span>the <span class="_ _9"></span>kernel <span class="_ _23"></span>sets <span class="_ _9"></span>the <span class="_ _9"></span>contents <span class="_ _23"></span>to <span class="_ _9"></span>0 <span class="_ _9"></span>befor<span class="ls870">et<span class="_ _b"></span><span class="ls0">he</span></span></div><div class="t m0 x32 h2a y1bdd ff19 fsf fc0 sc0 ls0 ws0">program <span class="_ _2"></span>starts <span class="_ _3"></span>running. <span class="_ _47"> </span>The<span class="_ _47"> </span>only <span class="_ _3"></span>portions <span class="_ _3"></span>of <span class="_ _3"></span>the <span class="_ _3"></span>program <span class="_ _2"></span>that <span class="_ _3"></span>need <span class="_ _3"></span>to <span class="_ _3"></span>be <span class="_ _3"></span>saved <span class="_ _3"></span>in <span class="_ _3"></span>the</div><div class="t m0 x32 h2a y1bde ff19 fsf fc0 sc0 ls0 ws0">program ﬁle ar<span class="_ _0"></span><span class="ls44">et<span class="_ _d"></span><span class="ls0">he text segment and the initialized data.</span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
