<div id="pf1cd" class="pf w4 h1f" data-page-no="1cd"><div class="pc pc1cd w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg1cd.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>12.3<span class="_ _28f"> </span>Thread <span class="_"> </span>Attributes<span class="_ _1fb"> </span><span class="ff18">427</span></div><div class="t m0 x3f h2a y12f ff19 fsf fc0 sc0 ls0 ws0">2. <span class="_ _51"> </span>An<span class="_"> </span>initialization function exists to set the attributes to their default values.</div><div class="t m0 x3f h2a y95d ff19 fsf fc0 sc0 ls0 ws0">3. <span class="_ _51"> </span>Another<span class="_ _46"> </span>function <span class="_ _66"> </span>exists <span class="_ _66"> </span>to <span class="_ _66"> </span>destroy <span class="_"> </span>the <span class="_ _66"> </span>attributes <span class="_ _66"> </span>object.<span class="_ _50"> </span>If <span class="_"> </span>the <span class="_ _47"> </span>initialization</div><div class="t m0 x41 h2a y3eb ff19 fsf fc0 sc0 ls0 ws0">function <span class="_ _35"> </span>allocated <span class="_ _35"> </span>any <span class="_ _35"> </span>resour<span class="_ _0"></span>ces <span class="_ _35"> </span>associated <span class="_ _35"> </span>with <span class="_ _35"> </span>the <span class="_ _35"> </span>attributes <span class="_ _35"> </span>object, <span class="_ _35"> </span>the</div><div class="t m0 x41 h2a y3ec ff19 fsf fc0 sc0 ls0 ws0">destroy function fr<span class="_ _0"></span>ees those r<span class="_ _0"></span>esources.</div><div class="t m0 x3f h2a y2861 ff19 fsf fc0 sc0 ls0 ws0">4. <span class="_ _51"> </span>Each<span class="_ _45"> </span>attribute <span class="_ _3"></span>has <span class="_ _3"></span>a <span class="_ _9"></span>function <span class="_ _3"></span>to <span class="_ _9"></span>get <span class="_ _3"></span>the <span class="_ _9"></span>value <span class="_ _3"></span>of <span class="_ _9"></span>the <span class="_ _3"></span>attribute <span class="_ _9"></span>from <span class="_ _3"></span>the <span class="_ _9"></span>attribute</div><div class="t m0 x41 h2a y735 ff19 fsf fc0 sc0 ls0 ws0">object. <span class="_ _47"> </span>Because<span class="_ _47"> </span>the <span class="_ _2"></span>function <span class="_ _3"></span>returns <span class="_ _2"></span>0 <span class="_ _2"></span>on <span class="_ _3"></span>success <span class="_ _3"></span>or <span class="_ _2"></span>an <span class="_ _3"></span>error <span class="_ _2"></span>number <span class="_ _3"></span>on <span class="_ _3"></span>failure,</div><div class="t m0 x41 h2a y736 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _2"></span>value <span class="_ _3"></span>is <span class="_ _3"></span>returned <span class="_ _3"></span>to <span class="_ _3"></span>the <span class="_ _2"></span>caller <span class="_ _3"></span>by <span class="_ _3"></span>storing <span class="_ _3"></span>it <span class="_ _3"></span>in <span class="_ _3"></span>the <span class="_ _3"></span>memory <span class="_ _3"></span>location <span class="_ _3"></span>speciﬁed</div><div class="t m0 x41 h2a y3ed ff19 fsf fc0 sc0 ls0 ws0">by one of the arguments.</div><div class="t m0 x3f h2a y138 ff19 fsf fc0 sc0 ls0 ws0">5. <span class="_ _51"> </span>Each<span class="_ _35"> </span>attribute <span class="_ _9"></span>has <span class="_ _23"></span>a <span class="_ _23"></span>function <span class="_ _9"></span>to <span class="_ _23"> </span>set <span class="_ _23"></span>the <span class="_ _23"></span>value <span class="_ _9"></span>of <span class="_ _23"> </span>the <span class="_ _23"></span>attribute.<span class="_ _5a"> </span>In <span class="_ _23"> </span>this <span class="_ _23"></span>case, <span class="_ _23"></span>the</div><div class="t m0 x41 h2b y139 ff19 fsf fc0 sc0 ls0 ws0">value is passed as an argument,<span class="_"> </span><span class="ff1b">by value</span>.</div><div class="t m0 x3f h26 y1d4 ff19 fsf fc0 sc0 ls0 ws0">In <span class="_ _2"></span>all <span class="_ _2"></span>the <span class="_ _2"></span>examples <span class="_ _3"></span>in <span class="_ _2"></span>which <span class="_ _2"></span>we <span class="_ _3"></span>called<span class="_ _66"> </span><span class="ff1a">pthread_create<span class="_ _47"> </span></span>in <span class="_ _2"></span>Chapter <span class="_ _2"></span>1<span class="_ _0"></span>1, <span class="_ _2"></span>we <span class="_ _2"></span>passed</div><div class="t m0 x32 h26 y38a ff19 fsf fc0 sc0 ls0 ws0">in <span class="_ _9"></span>a <span class="_ _23"></span>null <span class="_ _9"></span>pointer <span class="_ _23"></span>instead <span class="_ _9"></span>of <span class="_ _23"> </span>passing <span class="_ _23"></span>in <span class="_ _9"></span>a <span class="_ _23"></span>pointer <span class="_ _9"></span>to <span class="_ _23"></span>a<span class="_ _45"> </span><span class="ff1a">pthread_attr_t<span class="_ _35"> </span></span>structur<span class="_ _0"></span>e. <span class="_ _45"> </span>W<span class="_ _6"></span>e</div><div class="t m0 x32 h26 y3550 ff19 fsf fc0 sc0 ls0 ws0">can <span class="_ _3"></span>use <span class="_ _9"></span>the<span class="_ _47"> </span><span class="ff1a">pthread_attr_t<span class="_ _45"> </span></span>structur<span class="_ _0"></span>e<span class="_ _47"> </span>to<span class="_ _45"> </span>modify <span class="_ _3"></span>the <span class="_ _3"></span>default <span class="_ _9"></span>attributes, <span class="_ _3"></span>and <span class="_ _9"></span>associate</div><div class="t m0 x32 h26 y3551 ff19 fsf fc0 sc0 ls0 ws0">these attributes with threads that we create. <span class="_"> </span>W<span class="_ _6"></span><span class="lse68">eu<span class="_ _d"></span><span class="ls0">se the<span class="_"> </span><span class="ff1a">pthread_attr_init<span class="_ _66"> </span></span>function</span></span></div><div class="t m0 x32 h26 y3552 ff19 fsf fc0 sc0 ls0 ws0">to <span class="_ _23"></span>initialize <span class="_ _23"></span>the<span class="_ _45"> </span><span class="ff1a">pthread_attr_t<span class="_ _35"> </span></span>structure. <span class="_ _45"> </span>After<span class="_ _35"> </span>calling<span class="_ _45"> </span><span class="ff1a">pthread_attr_init</span><span class="lse69">,t<span class="_ _b"></span><span class="ls0">he</span></span></div><div class="t m0 x32 h26 y3553 ff1a fsf fc0 sc0 ls0 ws0">pthread_attr_t<span class="_ _4b"> </span><span class="ff19">structur<span class="lse6a">ec<span class="_ _4a"></span><span class="ls0">ontains <span class="_"> </span>the <span class="_ _e"> </span>default <span class="_"> </span>values <span class="_ _53"> </span>for <span class="_"> </span>all <span class="_ _e"> </span>the <span class="_ _e"> </span>thread <span class="_ _e"> </span>attributes</span></span></span></div><div class="t m0 x32 h2a y1d9 ff19 fsf fc0 sc0 ls0 ws0">supported by the implementation.</div><div class="t m0 x3f h57 y3554 ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;pthread.h&gt;</div><div class="t m0 x3f h57 y3555 ff1a fs2d fc0 sc0 ls0 ws0">int pthread_attr_init(pthread_attr_t *<span class="ff1b">attr</span>);</div><div class="t m0 x3f h57 y3556 ff1a fs2d fc0 sc0 ls0 ws0">int pthread_attr_destroy(pthread_attr_t *<span class="ff1b">attr</span>);</div><div class="t m0 xca h5f y3557 ff19 fs2d fc0 sc0 ls0 ws0">Both return: 0 if OK, err<span class="_ _0"></span>or number on failure</div><div class="t m0 x3f h4d y3558 ff19 fs26 fc0 sc0 ls164 ws0">To <span class="_ _53"> </span>d<span class="_ _9"></span><span class="ls0">einitialize <span class="_ _2"></span>a<span class="_"> </span><span class="ff1a">pthread_attr_t<span class="_ _66"> </span></span>structure, we call<span class="_"> </span><span class="ff1a">pthread_attr_destroy</span><span class="lse6b">.I<span class="_ _4a"></span><span class="ls0">f</span></span></span></div><div class="t m0 x32 h4d y3559 ff19 fs26 fc0 sc0 ls0 ws0">an <span class="_ _53"> </span>implementation <span class="_ _53"> </span>of<span class="_ _44"> </span><span class="ff1a">pthread_attr_init<span class="_ _4b"> </span></span>allocated <span class="_ _53"> </span>any <span class="_ _53"> </span>dynamic <span class="_ _53"> </span>memory <span class="_ _53"> </span>for <span class="_ _53"> </span>the</div><div class="t m0 x32 h4d y355a ff19 fs26 fc0 sc0 ls0 ws0">attribute <span class="_ _46"> </span>object,<span class="_ _50"> </span><span class="ff1a">pthread_attr_destroy<span class="_ _50"> </span></span>will <span class="_ _61"> </span>free <span class="_ _46"> </span>that <span class="_ _61"> </span>memory<span class="_ _4"></span><span class="lse6c">.I<span class="_ _4e"></span><span class="lse6d">na<span class="_ _49"></span><span class="ls0">ddition,</span></span></span></div><div class="t m0 x32 h4d y355b ff1a fs26 fc0 sc0 ls0 ws0">pthread_attr_destroy<span class="_ _47"> </span><span class="ff19">will <span class="_ _2"></span>initialize <span class="_ _2"></span>the <span class="_ _3"></span>attribute <span class="_ _2"></span>object <span class="_ _3"></span>with <span class="_ _2"></span>invalid <span class="_ _3"></span>values, <span class="_ _2"></span>so <span class="_ _3"></span>if <span class="_ _2"></span>it</span></div><div class="t m0 x32 h4d y355c ff19 fs26 fc0 sc0 ls0 ws0">is used by mistake,<span class="_"> </span><span class="ff1a">pthread_create<span class="_ _80"> </span></span>will return an error code.</div><div class="t m0 x3f h49 y355d ff19 fs26 fc0 sc0 ls0 ws0">The <span class="_ _9"></span>thread <span class="_ _3"></span>attributes <span class="_ _9"></span>deﬁned <span class="_ _23"></span>by <span class="_ _3"></span>POSIX.1 <span class="_ _23"></span>ar<span class="_ _0"></span><span class="ls8f2">es<span class="_ _b"></span><span class="ls0">ummarized <span class="_ _9"></span>in <span class="_ _9"></span>Figur<span class="ls8f2">e1<span class="_ _b"></span><span class="ls0">2.3. <span class="_ _45"> </span>POSIX.1</span></span></span></span></div><div class="t m0 x32 h49 y355e ff19 fs26 fc0 sc0 ls0 ws0">deﬁnes <span class="_ _53"> </span>additional <span class="_ _42"> </span>attributes <span class="_ _53"> </span>in <span class="_ _53"> </span>the <span class="_ _53"> </span>Thread <span class="_ _53"> </span>Execution <span class="_ _42"> </span>Scheduling <span class="_ _53"> </span>option, <span class="_ _53"> </span>intended <span class="_ _53"> </span>to</div><div class="t m0 x32 h49 y355f ff19 fs26 fc0 sc0 ls0 ws0">support <span class="_ _3"></span>real-time <span class="_ _2"></span>applications, <span class="_ _3"></span>but <span class="_ _9"></span>we <span class="_ _2"></span>don’t <span class="_ _9"></span>discuss <span class="_ _3"></span>them <span class="_ _3"></span>here. <span class="_ _47"> </span>In<span class="_ _47"> </span>Figur<span class="lse6e">e1<span class="_ _b"></span><span class="ls0">2.3, <span class="_ _9"></span>we <span class="_ _3"></span>also</span></span></div><div class="t m0 x32 h49 y3560 ff19 fs26 fc0 sc0 ls0 ws0">show which platforms support each thread attribute.</div><div class="t m0 x5d h2e y3561 ff19 fs11 fc0 sc0 ls0 ws0">FreeBSD <span class="_ _141"> </span>Linux<span class="_ _3a"> </span>Mac OS X<span class="_ _7f"> </span>Solaris</div><div class="t m0 x81 h2e y3562 ff19 fs11 fc0 sc0 ls0 ws0">8.0 <span class="_ _215"> </span>3.2.0<span class="_ _76"> </span>10.6.8 <span class="_ _bf"> </span>10</div><div class="t m0 x2b h2e y3563 ff19 fs11 fc0 sc0 ls0 ws0">Name<span class="_ _1e2"> </span>Description</div><div class="t m0 x1a6 hd1 y3564 ff1b fs12 fc0 sc0 ls0 ws0">detachstate<span class="_ _35"> </span><span class="ff19">detached thread attribute<span class="_ _cb"> </span><span class="ls7a2">••••</span></span></div><div class="t m0 x1a6 hd1 y3565 ff1b fs12 fc0 sc0 ls0 ws0">guardsize<span class="_ _1a3"> </span><span class="ff19">guar<span class="ls38a">db<span class="_ _84"></span><span class="ls0">uffer size in bytes at end of thread stack<span class="_ _17"> </span><span class="ls7a2">••••</span></span></span></span></div><div class="t m0 x1a6 hd1 y3566 ff1b fs12 fc0 sc0 ls0 ws0">stackaddr<span class="_ _98"> </span><span class="ff19">lowest address of thr<span class="_ _1"></span>ead stack<span class="_ _d0"> </span><span class="ls7a2">••••</span></span></div><div class="t m0 x1a6 hd1 y3567 ff1b fs12 fc0 sc0 ls0 ws0">stacksize<span class="_ _141"> </span><span class="ff19">minimum size in bytes of thread stack<span class="_ _7e"> </span><span class="ls7a2">••••</span></span></div><div class="t m0 x145 h30 y3568 ff18 fs13 fc0 sc0 ls0 ws0">Figure 12.3<span class="_ _5a"> </span><span class="ff19">POSIX.1 thread attributes</span></div><div class="t m0 x3f h6e y3569 ff19 fs31 fc0 sc0 ls0 ws0">In <span class="_ _2"></span>Section <span class="_ _3"></span>1<span class="_ _1"></span>1.5, <span class="_ _3"></span>we <span class="_ _3"></span>introduced <span class="_ _2"></span>the <span class="_ _2"></span>concept <span class="_ _3"></span>of <span class="_ _3"></span>detached <span class="_ _2"></span>threads. <span class="_ _47"> </span>If<span class="_ _47"> </span>we <span class="_ _2"></span>are<span class="_ _66"> </span>no<span class="_ _47"> </span>longer</div><div class="t m0 x32 h64 y356a ff19 fs31 fc0 sc0 ls0 ws0">interested <span class="_ _9"></span>in <span class="_ _23"></span>an <span class="_ _9"></span>existing <span class="_ _23"> </span>thread’s <span class="_ _9"></span>termination <span class="_ _23"> </span>status, <span class="_ _23"></span>we <span class="_ _23"></span>can <span class="_ _9"></span>use<span class="_ _35"> </span><span class="ff1a">pthread_detach<span class="_ _45"> </span></span>to</div><div class="t m0 x32 h6e y356b ff19 fs31 fc0 sc0 ls0 ws0">allow the operating system to reclaim the thr<span class="_ _0"></span>ead’s r<span class="_ _0"></span>esources when the thr<span class="_ _0"></span>ead exits.</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
