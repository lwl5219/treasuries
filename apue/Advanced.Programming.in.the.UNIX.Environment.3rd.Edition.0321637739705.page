<div id="pf2c1" class="pf w4 h1f" data-page-no="2c1"><div class="pc pc2c1 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg2c1.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x32 h47 y25f ff1e fsb fc0 sc0 ls0 ws0">18</div><div class="t m0 x32 h20 y8f ff15 fs2 fc0 sc0 ls1427 ws0">Te<span class="_ _23"></span><span class="ls1428">rm<span class="_ _1"></span><span class="ls0">inal <span class="_"> </span>I/O</span></span></div><div class="t m0 x35 h48 y116 ff16 fs1 fc0 sc0 ls0 ws0">18.1 <span class="_ _93"> </span>Introduction</div><div class="t m0 x32 h28 y118 ff19 fs5 fc0 sc0 ls0 ws0">The <span class="_ _3"></span>handling <span class="_ _9"></span>of <span class="_ _9"></span>terminal <span class="_ _9"></span>I/O <span class="_ _3"></span>is <span class="_ _9"></span>a <span class="_ _9"></span>messy <span class="_ _9"></span>area, <span class="_ _3"></span>regar<span class="_ _0"></span>dless <span class="_ _3"></span>of <span class="_ _9"></span>the <span class="_ _9"></span>operating <span class="_ _9"></span>system.<span class="_ _16"> </span>The</div><div class="t m0 x32 h28 y119 ff19 fs5 fc0 sc0 ls0 ws0">UNIX <span class="_ _3"></span>System <span class="_ _9"></span>is <span class="_ _3"></span>no <span class="_ _9"></span>exception.<span class="_ _5a"> </span>The <span class="_ _3"></span>manual <span class="_ _9"></span>page <span class="_ _3"></span>for <span class="_ _9"></span>terminal <span class="_ _3"></span>I/O <span class="_ _9"></span>is <span class="_ _9"></span>usually <span class="_ _3"></span>one <span class="_ _9"></span>of <span class="_ _3"></span>the</div><div class="t m0 x32 h28 y11a ff19 fs5 fc0 sc0 ls0 ws0">longest in most editions of the programmer <span class="_ _84"></span>’s<span class="_"> </span>manuals.</div><div class="t m0 x3f h28 y11b ff19 fs5 fc0 sc0 ls62e ws0">Wi<span class="_ _3"></span><span class="ls0">th <span class="_ _45"> </span>the <span class="_ _35"> </span>UNIX <span class="_ _45"> </span>System, <span class="_ _45"> </span>a <span class="_ _35"> </span>schism <span class="_ _45"> </span>formed <span class="_ _45"> </span>in <span class="_ _35"> </span>the <span class="_ _45"> </span>late <span class="_ _45"> </span>1970s <span class="_ _35"> </span>when <span class="_ _45"> </span>System <span class="_ _45"> </span>III</span></div><div class="t m0 x32 h28 y11c ff19 fs5 fc0 sc0 ls0 ws0">developed <span class="_ _9"></span>a <span class="_ _23"> </span>differ<span class="_ _0"></span>ent <span class="_ _9"></span>set <span class="_ _23"> </span>of <span class="_ _23"></span>terminal <span class="_ _9"></span>routines <span class="_ _9"></span>from <span class="_ _23"></span>those <span class="_ _9"></span>of <span class="_ _23"></span>V<span class="_ _4"></span>ersion <span class="_ _23"></span>7.<span class="_ _5a"> </span>The <span class="_ _23"></span>System <span class="_ _23"></span>III</div><div class="t m0 x32 h28 y11d ff19 fs5 fc0 sc0 ls0 ws0">style <span class="_ _9"></span>of <span class="_ _9"></span>terminal <span class="_ _23"></span>I/O <span class="_ _9"></span>continued <span class="_ _9"></span>through <span class="_ _9"></span>System <span class="_ _9"></span>V<span class="_ _4"></span><span class="lsd73">,a<span class="_ _b"></span><span class="ls0">nd <span class="_ _9"></span>the <span class="_ _9"></span>V<span class="_ _6"></span>ersion <span class="_ _9"></span>7 <span class="_ _9"></span>style <span class="_ _9"></span>became <span class="_ _23"></span>the</span></span></div><div class="t m0 x32 h28 y11e ff19 fs5 fc0 sc0 ls0 ws0">standar<span class="ls1429">df<span class="_ _8"></span><span class="ls0">or <span class="_ _2"></span>the <span class="_ _2"></span>BSD-derived <span class="_ _2"></span>systems.<span class="_ _61"> </span>As <span class="_ _2"></span>with <span class="_ _2"></span>signals, <span class="_ _2"></span>this <span class="_ _2"></span>difference between <span class="_ _2"></span>the <span class="_ _2"></span>two</span></span></div><div class="t m0 x32 h28 y11f ff19 fs5 fc0 sc0 ls0 ws0">worlds <span class="_ _53"> </span>has <span class="_ _53"> </span>been <span class="_ _53"> </span>conquered <span class="_ _42"> </span>by <span class="_ _e"> </span>POSIX.1.<span class="_ _54"> </span>In <span class="_ _e"> </span>this <span class="_ _53"> </span>chapter<span class="_ _1"></span>,<span class="_ _44"> </span>we<span class="_ _4b"> </span>look <span class="_ _53"> </span>at <span class="_ _53"> </span>all <span class="_ _53"> </span>the <span class="_ _53"> </span>POSIX.1</div><div class="t m0 x32 h28 y120 ff19 fs5 fc0 sc0 ls0 ws0">terminal functions and some of the platform-speciﬁc additions.</div><div class="t m0 x3f h28 y121 ff19 fs5 fc0 sc0 ls0 ws0">Part <span class="_ _47"> </span>of <span class="_ _66"> </span>the <span class="_ _47"> </span>complexity <span class="_ _47"> </span>of <span class="_ _47"> </span>the <span class="_ _47"> </span>terminal <span class="_ _66"> </span>I/O <span class="_ _47"> </span>system <span class="_ _47"> </span>occurs <span class="_ _47"> </span>because <span class="_ _47"> </span>people <span class="_ _66"> </span>use</div><div class="t m0 x32 h28 y122 ff19 fs5 fc0 sc0 ls0 ws0">terminal <span class="_ _44"> </span>I/O <span class="_ _44"> </span>for <span class="_ _44"> </span>so <span class="_ _4b"> </span>many <span class="_ _44"> </span>differ<span class="_ _0"></span>ent <span class="_ _44"> </span>things: <span class="_ _44"> </span>terminals, <span class="_ _4b"> </span>hard-wir<span class="_ _1"></span>ed <span class="_ _4b"> </span>lines <span class="_ _44"> </span>between</div><div class="t m0 x32 h28 y123 ff19 fs5 fc0 sc0 ls0 ws0">computers, modems, printers, and so on.</div><div class="t m0 x35 h48 y126 ff16 fs1 fc0 sc0 ls0 ws0">18.2 <span class="_ _93"> </span>Overview</div><div class="t m0 x32 h28 y128 ff19 fs5 fc0 sc0 ls72 ws0">Te<span class="_ _9"></span><span class="ls0">rminal I/O has two modes:</span></div><div class="t m0 x3f h28 y14c ff19 fs5 fc0 sc0 ls0 ws0">1. <span class="_ _51"> </span>Canonical<span class="_ _47"> </span>mode <span class="_ _9"></span>input <span class="_ _3"></span>processing. <span class="_ _47"> </span>In<span class="_ _45"> </span>this <span class="_ _3"></span>mode, <span class="_ _9"></span>terminal <span class="_ _3"></span>input <span class="_ _9"></span>is <span class="_ _3"></span>processed <span class="_ _3"></span>as</div><div class="t m0 x41 h28 y14d ff19 fs5 fc0 sc0 ls0 ws0">lines. <span class="_"> </span>The<span class="_"> </span>terminal driver returns at most one line per r<span class="_ _0"></span>ead r<span class="_ _0"></span>equest.</div><div class="t m0 x3f h28 y146d ff19 fs5 fc0 sc0 ls0 ws0">2. <span class="_ _51"> </span>Noncanonical<span class="_ _35"> </span>mode <span class="_ _9"></span>input <span class="_ _23"> </span>processing. <span class="_ _45"> </span>The<span class="_ _35"> </span>input <span class="_ _23"></span>characters <span class="_ _9"></span>ar<span class="ls142a">en<span class="_ _b"></span><span class="ls0">ot <span class="_ _9"></span>assembled</span></span></div><div class="t m0 x41 h28 y146e ff19 fs5 fc0 sc0 ls0 ws0">into lines.</div><div class="t m0 x1c0 h23 y12e ff18 fs0 fc0 sc0 ls0 ws0">671</div><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:156.492009px;bottom:976.466466px;width:147.983002px;height:134.415955px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.891993px;bottom:693.226788px;width:105.756005px;height:19.680023px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.892201px;bottom:290.026820px;width:89.303909px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
