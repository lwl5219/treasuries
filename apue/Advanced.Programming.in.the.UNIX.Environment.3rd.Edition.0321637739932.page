<div id="pf3a4" class="pf w4 h1f" data-page-no="3a4"><div class="pc pc3a4 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg3a4.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">898<span class="_ _1b"> </span><span class="ff19">Miscellaneous <span class="_"> </span>Source <span class="_"> </span>Code<span class="_ _2c"> </span>Appendix <span class="_"> </span>B</span></div><div class="t m0 x32 h57 y425 ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _68"> </span>log_open(const<span class="_"> </span>char *, int, int);</div><div class="t m0 x32 h57 y426 ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _68"> </span>log_quit(const<span class="_"> </span>char *, ...) __attribute__((noreturn));</div><div class="t m0 x32 h57 y800 ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _68"> </span>log_ret(const<span class="_"> </span>char *, ...);</div><div class="t m0 x32 h57 y801 ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _68"> </span>log_sys(const<span class="_"> </span>char *, ...) __attribute__((noreturn));</div><div class="t m0 x32 h57 y802 ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _68"> </span>log_exit(int,<span class="_"> </span>const char *, ...) __attribute__((noreturn));</div><div class="t m0 x32 h57 y5f5d ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _68"> </span>TELL_WAIT(void);<span class="_ _186"> </span>/* parent/child from Section 8.9 */</div><div class="t m0 x32 h57 y4208 ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _68"> </span>TELL_PARENT(pid_t);</div><div class="t m0 x32 h57 y13df ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _68"> </span>TELL_CHILD(pid_t);</div><div class="t m0 x32 h57 y13e0 ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _68"> </span>WAIT_PARENT(void);</div><div class="t m0 x32 h57 y41e9 ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _68"> </span>WAIT_CHILD(void);</div><div class="t m0 x32 h57 y8d9 ff1a fs2d fc0 sc0 ls0 ws0">#endif <span class="_"> </span>/*<span class="_"> </span>_APUE_H */</div><div class="t m0 x131 h5e y3c16 ff18 fs10 fc0 sc0 ls0 ws0">Figure B.1<span class="_ _5a"> </span><span class="ff19">Our header:<span class="_"> </span><span class="ff1a">apue.h</span></span></div><div class="t m0 x32 h49 y5f71 ff19 fs26 fc0 sc0 ls0 ws0">The reasons <span class="_ _2"></span>we include <span class="_ _2"></span>our <span class="_ _2"></span>header <span class="_ _2"></span>befor<span class="ls17eb">ea<span class="_ _4f"></span><span class="ls0">ll <span class="_ _2"></span>the normal <span class="_ _2"></span>system <span class="_ _2"></span>headers <span class="_ _2"></span>are<span class="_"> </span>to<span class="_ _66"> </span>allow <span class="_ _2"></span>us</span></span></div><div class="t m0 x32 h49 y5f72 ff19 fs26 fc0 sc0 ls0 ws0">to <span class="_"> </span>deﬁne <span class="_"> </span>anything <span class="_"> </span>that <span class="_"> </span>might <span class="_"> </span>be <span class="_"> </span>required <span class="_"> </span>by <span class="_"> </span>headers <span class="_"> </span>befor<span class="_ _0"></span><span class="ls17ec">et<span class="_ _4a"></span><span class="ls0">hey <span class="_"> </span>ar<span class="ls17ec">ei<span class="_ _5b"></span><span class="ls0">ncluded, <span class="_"> </span>to</span></span></span></span></div><div class="t m0 x32 h49 y5f73 ff19 fs26 fc0 sc0 ls0 ws0">control <span class="_"> </span>the <span class="_ _47"> </span>order <span class="_ _47"> </span>in <span class="_ _66"> </span>which <span class="_ _47"> </span>header <span class="_ _47"> </span>ﬁles <span class="_ _47"> </span>ar<span class="ls2e4">ei<span class="_ _62"></span><span class="ls0">ncluded, <span class="_ _47"> </span>and <span class="_ _47"> </span>to <span class="_ _47"> </span>allow <span class="_ _47"> </span>us <span class="_ _66"> </span>to <span class="_ _47"> </span>redeﬁne</span></span></div><div class="t m0 x32 h49 y5f74 ff19 fs26 fc0 sc0 ls0 ws0">anything that needs to be ﬁxed up to hide the differ<span class="_ _0"></span>ences between systems.</div><div class="t m0 x35 h4b y5f75 ff16 fs27 fc0 sc0 ls0 ws0">B.2 <span class="_ _1bb"> </span>Standar<span class="_ _0"></span><span class="ls5d5">dE<span class="_ _52"></span><span class="ls0">rr<span class="_ _0"></span>or <span class="_"> </span>Routines</span></span></div><div class="t m0 x32 h49 y5f76 ff19 fs26 fc0 sc0 lsf94 ws0">Tw<span class="_ _9"></span><span class="ls17ed">os<span class="_ _c"></span><span class="ls0">ets <span class="_ _53"> </span>of <span class="_ _53"> </span>error <span class="_ _42"> </span>functions <span class="_ _42"> </span>ar<span class="ls1778">eu<span class="_ _c"></span><span class="ls0">sed <span class="_ _53"> </span>in <span class="_ _53"> </span>most <span class="_ _42"> </span>of <span class="_ _53"> </span>the <span class="_ _53"> </span>examples <span class="_ _42"> </span>throughout <span class="_ _42"> </span>the <span class="_ _53"> </span>text <span class="_ _53"> </span>to</span></span></span></span></div><div class="t m0 x32 h4d y5f77 ff19 fs26 fc0 sc0 ls0 ws0">handle <span class="_ _42"> </span>error <span class="_ _23"> </span>conditions.<span class="_ _54"> </span>One <span class="_ _42"> </span>set <span class="_ _42"> </span>begins <span class="_ _42"> </span>with<span class="_ _35"> </span><span class="ff1a">err_<span class="_ _44"> </span></span>and <span class="_ _42"> </span>outputs <span class="_ _42"> </span>an <span class="_ _23"> </span>error <span class="_ _42"> </span>message <span class="_ _42"> </span>to</div><div class="t m0 x32 h4d y5f78 ff19 fs26 fc0 sc0 ls0 ws0">standar<span class="ls17ee">de<span class="_ _b"></span><span class="ls0">rr<span class="_ _1"></span>or<span class="_ _1"></span><span class="ls6ef">.T<span class="_ _62"></span><span class="ls0">he <span class="_ _9"></span>other <span class="_ _9"></span>set <span class="_ _23"></span>begins <span class="_ _9"></span>with<span class="_ _45"> </span><span class="ff1a">log_<span class="_ _45"> </span></span>and <span class="_ _9"></span>is <span class="_ _23"></span>intended <span class="_ _9"></span>for <span class="_ _9"></span>daemon <span class="_ _9"></span>processes</span></span></span></span></div><div class="t m0 x32 h49 y5f79 ff19 fs26 fc0 sc0 ls0 ws0">(Chapter 13) that probably have no contr<span class="_ _0"></span>olling terminal.</div><div class="t m0 x3f h49 y5f7a ff19 fs26 fc0 sc0 ls0 ws0">The reason for <span class="_ _2"></span>deﬁning <span class="_ _2"></span>our <span class="_ _2"></span>own error functions <span class="_ _2"></span>is <span class="_ _2"></span>to <span class="_ _2"></span>let us <span class="_ _2"></span>write <span class="_ _2"></span>our error handling</div><div class="t m0 x32 h49 y5f7b ff19 fs26 fc0 sc0 ls0 ws0">with a single line of C code, as in</div><div class="t m0 x3f h4e y5f7c ff1a fs28 fc0 sc0 ls0 ws0">if (<span class="ff1b">error condition</span>)</div><div class="t m0 x16e h4e y5f7d ff1a fs28 fc0 sc0 ls0 ws0">err_dump(<span class="ff1b">printf format with any number of arguments</span>);</div><div class="t m0 x32 h49 y5f7e ff19 fs26 fc0 sc0 ls0 ws0">instead of</div><div class="t m0 x3f h4e y5f7f ff1a fs28 fc0 sc0 ls0 ws0">if (<span class="ff1b">error condition</span><span class="ls1b6">){</span></div><div class="t m0 x16e h4e y5f80 ff1a fs28 fc0 sc0 ls0 ws0">char <span class="_"> </span>buf[200];</div><div class="t m0 x16e h4e y5f81 ff1a fs28 fc0 sc0 ls0 ws0">sprintf(buf,<span class="_"> </span><span class="ff1b">printf format with any number of arguments</span>);</div><div class="t m0 x16e h4e y5f82 ff1a fs28 fc0 sc0 ls0 ws0">perror(buf);</div><div class="t m0 x16e h4e y5f83 ff1a fs28 fc0 sc0 ls0 ws0">abort();</div><div class="t m0 x3f h4e y5f84 ff1a fs28 fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h49 y5f85 ff19 fs26 fc0 sc0 ls0 ws0">Our <span class="_"> </span>error <span class="_"> </span>functions <span class="_"> </span>use <span class="_ _66"> </span>the <span class="_"> </span>variable-length <span class="_ _66"> </span>argument <span class="_"> </span>list <span class="_"> </span>facility <span class="_ _66"> </span>from <span class="_"> </span>ISO <span class="_"> </span>C.<span class="_ _50"> </span>See</div><div class="t m0 x32 h49 y5f86 ff19 fs26 fc0 sc0 ls0 ws0">Section 7.3 of Kernighan and Ritchie</div><div class="t m0 x226 h49 y5f87 ff19 fs26 fc0 sc0 ls0 ws0">[</div><div class="t m0 x24 h49 y5f86 ff19 fs26 fc0 sc0 ls0 ws0">1988</div><div class="t m0 x1a4 h49 y5f87 ff19 fs26 fc0 sc0 ls0 ws0">]</div><div class="t m0 x114 h49 y5f86 ff19 fs26 fc0 sc0 ls0 ws0">for additional details.<span class="_ _59"> </span>Be <span class="_ _2"></span>awar<span class="ls166e">et<span class="_ _4f"></span><span class="ls0">hat this ISO</span></span></div><div class="t m0 x32 h4d y5f88 ff19 fs26 fc0 sc0 ls176e ws0">Cf<span class="_ _b"></span><span class="ls0">acility <span class="_ _9"></span>differs <span class="_ _3"></span>from <span class="_ _9"></span>the<span class="_ _45"> </span><span class="ff1a">varargs<span class="_ _45"> </span></span>facility <span class="_ _9"></span>provided <span class="_ _9"></span>by <span class="_ _9"></span>earlier <span class="_ _9"></span>systems <span class="_ _9"></span>(such <span class="_ _9"></span>as <span class="_ _9"></span>SVR3</span></div><div class="t m0 x32 h49 y5f89 ff19 fs26 fc0 sc0 ls0 ws0">and <span class="_ _3"></span>4.3BSD).<span class="_ _16"> </span>The <span class="_ _3"></span>names <span class="_ _9"></span>of <span class="_ _3"></span>the <span class="_ _3"></span>macros <span class="_ _3"></span>ar<span class="ls17ef">et<span class="_ _b"></span><span class="ls0">he <span class="_ _9"></span>same, <span class="_ _3"></span>but <span class="_ _3"></span>the <span class="_ _3"></span>arguments <span class="_ _3"></span>to <span class="_ _3"></span>some <span class="_ _9"></span>of <span class="_ _3"></span>the</span></span></div><div class="t m0 x32 h49 y5f8a ff19 fs26 fc0 sc0 ls0 ws0">macros have changed.</div><a class="l" href="#pf14" data-dest-detail='[20,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.892634px;bottom:713.470818px;width:181.547706px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
