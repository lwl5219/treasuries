<div id="pf14e" class="pf w4 h1f" data-page-no="14e"><div class="pc pc14e w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg14e.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">300<span class="_ _1b"> </span><span class="ff19">Process <span class="_"> </span>Relationships<span class="_ _18d"> </span>Chapter <span class="_"> </span>9</span></div><div class="t m0 x32 h2a y12f ff19 fsf fc0 sc0 ls0 ws0">if <span class="_"> </span>the <span class="_ _66"> </span>host <span class="_ _66"> </span>does.<span class="_ _50"> </span>The <span class="_"> </span>Bourne-again <span class="_ _66"> </span>shell <span class="_ _66"> </span>also <span class="_ _66"> </span>supports <span class="_ _66"> </span>job <span class="_ _66"> </span>control. <span class="_ _46"> </span>W<span class="_ _6"></span>e’ll <span class="_ _66"> </span>just <span class="_ _66"> </span>talk</div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">generically <span class="_ _23"> </span>about <span class="_ _42"> </span>a <span class="_ _42"> </span>shell <span class="_ _23"> </span>that <span class="_ _42"> </span>supports <span class="_ _42"> </span>job <span class="_ _23"> </span>control, <span class="_ _23"> </span>versus <span class="_ _42"> </span>one <span class="_ _42"> </span>that <span class="_ _23"> </span>doesn’t, <span class="_ _42"> </span>when <span class="_ _42"> </span>the</div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">differ<span class="_ _0"></span>ence between the various shells doesn’t matter<span class="_ _6"></span>.</div><div class="t m0 x3f h2a y132 ff19 fsf fc0 sc0 ls0 ws0">When <span class="_ _3"></span>we <span class="_ _9"></span>start <span class="_ _3"></span>a <span class="_ _9"></span>background <span class="_ _3"></span>job, <span class="_ _3"></span>the <span class="_ _9"></span>shell <span class="_ _3"></span>assigns <span class="_ _9"></span>it <span class="_ _3"></span>a <span class="_ _9"></span>job <span class="_ _3"></span>identiﬁer <span class="_ _9"></span>and <span class="_ _3"></span>prints <span class="_ _9"></span>one</div><div class="t m0 x32 h2a y133 ff19 fsf fc0 sc0 ls0 ws0">or more<span class="_"> </span>of<span class="_"> </span>the <span class="_ _2"></span>process IDs.<span class="_ _46"> </span>The following <span class="_ _2"></span>script shows <span class="_ _2"></span>how the Korn <span class="_ _2"></span>shell handles <span class="_ _2"></span>this:</div><div class="t m0 x3f h57 y2280 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">make all &gt; Make.out &amp;</span></div><div class="t m0 x3f h57 y26a6 ff1a fs2d fc0 sc0 ls0 ws0">[1] <span class="_ _15"> </span>1475</div><div class="t m0 x3f h57 y26a7 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">pr *.c | lpr &amp;</span></div><div class="t m0 x3f h57 y26a8 ff1a fs2d fc0 sc0 ls0 ws0">[2] <span class="_ _15"> </span>1490</div><div class="t m0 x3f h57 y26a9 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_ _168"> </span><span class="ff1b">just press RETURN</span></div><div class="t m0 x3f h57 y26aa ff1a fs2d fc0 sc0 ls0 ws0">[2] +<span class="_ _d9"> </span>Done <span class="_ _176"> </span>pr<span class="_"> </span>*.c | lpr &amp;</div><div class="t m0 x3f h57 y26ab ff1a fs2d fc0 sc0 ls0 ws0">[1] +<span class="_ _d9"> </span>Done <span class="_ _176"> </span>make<span class="_"> </span>all &gt; Make.out &amp;</div><div class="t m0 x32 h26 y11b9 ff19 fsf fc0 sc0 ls0 ws0">The<span class="_ _45"> </span><span class="ff1a">make<span class="_ _47"> </span></span>is <span class="_ _9"></span>job <span class="_ _9"></span>number <span class="_ _3"></span>1 <span class="_ _9"></span>and <span class="_ _9"></span>the <span class="_ _9"></span>starting <span class="_ _3"></span>process <span class="_ _9"></span>ID <span class="_ _3"></span>is <span class="_ _9"></span>1475.<span class="_ _5a"> </span>The <span class="_ _3"></span>next <span class="_ _9"></span>pipeline <span class="_ _9"></span>is <span class="_ _9"></span>job</div><div class="t m0 x32 h2a y26ac ff19 fsf fc0 sc0 ls0 ws0">number 2 and the <span class="_ _2"></span>process ID of the ﬁrst process is 1490.<span class="_ _46"> </span>When the <span class="_ _2"></span>jobs ar<span class="lsb3a">ed<span class="_ _4f"></span><span class="ls0">one <span class="_ _2"></span>and we</span></span></div><div class="t m0 x32 h2a y26ad ff19 fsf fc0 sc0 ls0 ws0">press RETURN, the shell tells us that the jobs ar<span class="_ _0"></span><span class="ls92d">ec<span class="_ _d"></span><span class="ls0">omplete. <span class="_"> </span>The<span class="_"> </span><span class="ls45">re</span>ason we have to press</span></span></div><div class="t m0 x32 h2a y26ae ff19 fsf fc0 sc0 ls0 ws0">RETURN <span class="_ _53"> </span>is <span class="_ _e"> </span>to <span class="_ _e"> </span>have <span class="_ _53"> </span>the <span class="_ _e"> </span>shell <span class="_ _e"> </span>print <span class="_ _53"> </span>its <span class="_ _e"> </span>prompt. <span class="_ _4b"> </span>The<span class="_ _4b"> </span>shell <span class="_ _53"> </span>doesn’t <span class="_ _e"> </span>print <span class="_ _e"> </span>the <span class="_ _53"> </span>changed</div><div class="t m0 x32 h2a y26af ff19 fsf fc0 sc0 ls0 ws0">status of <span class="_ _2"></span>background jobs at any <span class="_ _2"></span>random time<span class="_ _9"></span><span class="ls9d">—o<span class="_ _1"></span><span class="ls0">nly right before<span class="_"> </span>it<span class="_ _66"> </span>prints <span class="_ _2"></span>its prompt, to</span></span></div><div class="t m0 x32 h2a y26b0 ff19 fsf fc0 sc0 ls0 ws0">let <span class="_ _23"></span>us <span class="_ _23"> </span>enter <span class="_ _23"> </span>a <span class="_ _23"> </span>new <span class="_ _42"> </span>command <span class="_ _23"></span>line.<span class="_ _51"> </span>If <span class="_ _23"></span>the <span class="_ _23"> </span>shell <span class="_ _23"> </span>didn’t <span class="_ _23"> </span>do <span class="_ _23"> </span>this, <span class="_ _42"> </span>it <span class="_ _23"></span>could <span class="_ _23"></span>produce <span class="_ _23"></span>output</div><div class="t m0 x32 h2a y26b1 ff19 fsf fc0 sc0 ls0 ws0">while we wer<span class="ls44">ee<span class="_ _4f"></span><span class="ls0">ntering an input line.</span></span></div><div class="t m0 x3f h2a y26b2 ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _3"></span>interaction <span class="_ _9"></span>with <span class="_ _3"></span>the <span class="_ _9"></span>terminal <span class="_ _3"></span>driver <span class="_ _9"></span>arises <span class="_ _9"></span>because <span class="_ _3"></span>a <span class="_ _9"></span>special <span class="_ _3"></span>terminal <span class="_ _9"></span>character</div><div class="t m0 x32 h2a y26b3 ff19 fsf fc0 sc0 ls0 ws0">affects <span class="_ _35"> </span>the <span class="_ _44"> </span>foreground <span class="_ _35"> </span>job: <span class="_ _44"> </span>the <span class="_ _44"> </span>suspend <span class="_ _44"> </span>key <span class="_ _44"> </span>(typically <span class="_ _44"> </span>Control</div><div class="t m0 x1fd h2a y26b4 ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 xbc h2a y26b3 ff19 fsf fc0 sc0 ls0 ws0">Z). <span class="_ _54"> </span>Entering<span class="_ _54"> </span>this</div><div class="t m0 x32 h26 y26b5 ff19 fsf fc0 sc0 ls0 ws0">character <span class="_ _3"></span>causes <span class="_ _9"></span>the <span class="_ _9"></span>terminal <span class="_ _9"></span>driver <span class="_ _9"></span>to <span class="_ _3"></span>send <span class="_ _9"></span>the<span class="_ _45"> </span><span class="ff1a">SIGTSTP<span class="_ _45"> </span></span>signal <span class="_ _3"></span>to <span class="_ _9"></span>all <span class="_ _9"></span>processes <span class="_ _3"></span>in <span class="_ _9"></span>the</div><div class="t m0 x32 h2a y26b6 ff19 fsf fc0 sc0 ls0 ws0">foregr<span class="_ _0"></span>ound <span class="_ _3"></span>process <span class="_ _3"></span>group. <span class="_ _47"> </span>The<span class="_ _45"> </span>jobs <span class="_ _9"></span>in <span class="_ _3"></span>any <span class="_ _9"></span>background <span class="_ _3"></span>process <span class="_ _3"></span>groups <span class="_ _3"></span>aren’t <span class="_ _3"></span>affected.</div><div class="t m0 x32 h2a y26b7 ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _53"> </span>terminal <span class="_ _e"> </span>driver <span class="_ _53"> </span>looks <span class="_ _e"> </span>for <span class="_ _53"> </span>three <span class="_ _53"> </span>special <span class="_ _e"> </span>characters, <span class="_ _53"> </span>which <span class="_ _e"> </span>generate <span class="_ _e"> </span>signals <span class="_ _53"> </span>to <span class="_ _e"> </span>the</div><div class="t m0 x32 h2a y26b8 ff19 fsf fc0 sc0 ls0 ws0">foregr<span class="_ _0"></span>ound pr<span class="_ _0"></span>ocess group.</div><div class="t m0 x3f h2a y26b9 ff19 fsf fc0 sc0 ls49 ws0">•T<span class="_ _4d"></span><span class="ls0">he interrupt character (typically DELETE or Contr<span class="_ _0"></span>ol</span></div><div class="t m0 x20b h2a y26ba ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 x13e h26 y26b9 ff19 fsf fc0 sc0 ls0 ws0">C) generates<span class="_"> </span><span class="ff1a">SIGINT</span>.</div><div class="t m0 x3f h26 y26bb ff19 fsf fc0 sc0 ls49 ws0">•T<span class="_ _4d"></span><span class="ls0">he quit character (typically Control-backslash) generates<span class="_"> </span><span class="ff1a">SIGQUIT</span>.</span></div><div class="t m0 x3f h2a y26bc ff19 fsf fc0 sc0 ls49 ws0">•T<span class="_ _4d"></span><span class="ls0">he suspend character (typically Control</span></div><div class="t m0 x15d h2a y26bd ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 x1f9 h26 y26bc ff19 fsf fc0 sc0 ls0 ws0">Z) generates<span class="_"> </span><span class="ff1a">SIGTSTP</span>.</div><div class="t m0 x32 h2a y26be ff19 fsf fc0 sc0 ls0 ws0">In <span class="_ _3"></span>Chapter <span class="_ _3"></span>18, <span class="_ _9"></span>we’ll <span class="_ _3"></span>see <span class="_ _3"></span>how <span class="_ _3"></span>we <span class="_ _9"></span>can <span class="_ _3"></span>change <span class="_ _3"></span>these <span class="_ _9"></span>three <span class="_ _2"></span>characters <span class="_ _9"></span>to <span class="_ _3"></span>be <span class="_ _3"></span>any <span class="_ _9"></span>characters</div><div class="t m0 x32 h2a y26bf ff19 fsf fc0 sc0 ls0 ws0">we <span class="_ _42"> </span>choose <span class="_ _53"> </span>and <span class="_ _42"> </span>how <span class="_ _53"> </span>we <span class="_ _42"> </span>can <span class="_ _53"> </span>disable <span class="_ _53"> </span>the <span class="_ _42"> </span>terminal <span class="_ _53"> </span>driver<span class="_ _9"></span>’s <span class="_ _42"> </span>processing <span class="_ _42"> </span>of <span class="_ _53"> </span>these <span class="_ _42"> </span>special</div><div class="t m0 x32 h2a y26c0 ff19 fsf fc0 sc0 ls0 ws0">characters.</div><div class="t m0 x3f h2a y26c1 ff19 fsf fc0 sc0 ls0 ws0">Another job <span class="_ _2"></span>control condition can arise <span class="_ _2"></span>that must <span class="_ _2"></span>be handled <span class="_ _2"></span>by the <span class="_ _2"></span>terminal driver<span class="_ _1"></span>.</div><div class="t m0 x32 h2a y26c2 ff19 fsf fc0 sc0 ls0 ws0">Since <span class="_ _9"></span>we <span class="_ _9"></span>can <span class="_ _9"></span>have <span class="_ _23"></span>a <span class="_ _9"></span>foregr<span class="_ _1"></span>ound <span class="_ _23"></span>job <span class="_ _9"></span>and <span class="_ _9"></span>one <span class="_ _9"></span>or <span class="_ _9"></span>mor<span class="lsb3b">eb<span class="_ _b"></span><span class="ls0">ackground <span class="_ _3"></span>jobs, <span class="_ _23"></span>which <span class="_ _9"></span>of <span class="_ _9"></span>these</span></span></div><div class="t m0 x32 h2a y26c3 ff19 fsf fc0 sc0 ls45 ws0">re<span class="ls0">ceives <span class="_ _9"></span>the <span class="_ _3"></span>characters <span class="_ _9"></span>that <span class="_ _3"></span>we <span class="_ _9"></span>enter <span class="_ _3"></span>at <span class="_ _9"></span>the <span class="_ _3"></span>terminal?<span class="_ _5a"> </span>Only <span class="_ _3"></span>the <span class="_ _9"></span>foregr<span class="_ _0"></span>ound <span class="_ _3"></span>job <span class="_ _9"></span>receives</span></div><div class="t m0 x32 h2a y26c4 ff19 fsf fc0 sc0 ls0 ws0">terminal <span class="_ _3"></span>input.<span class="_ _16"> </span>It <span class="_ _3"></span>is <span class="_ _9"></span>not <span class="_ _3"></span>an <span class="_ _3"></span>error <span class="_ _3"></span>for <span class="_ _3"></span>a <span class="_ _9"></span>background <span class="_ _2"></span>job <span class="_ _3"></span>to <span class="_ _9"></span>try <span class="_ _3"></span>to <span class="_ _3"></span>read <span class="_ _3"></span>from <span class="_ _3"></span>the <span class="_ _3"></span>terminal,</div><div class="t m0 x32 h2a y26c5 ff19 fsf fc0 sc0 ls0 ws0">but <span class="_ _23"> </span>the <span class="_ _42"> </span>terminal <span class="_ _23"> </span>driver <span class="_ _23"> </span>detects <span class="_ _42"> </span>this <span class="_ _23"> </span>and <span class="_ _42"> </span>sends <span class="_ _23"> </span>a <span class="_ _42"> </span>special <span class="_ _23"></span>signal <span class="_ _23"> </span>to <span class="_ _42"> </span>the <span class="_ _23"> </span>background <span class="_ _23"> </span>job:</div><div class="t m0 x32 h26 y26c6 ff1a fsf fc0 sc0 ls0 ws0">SIGTTIN<span class="ff19 lsb3c">.T<span class="_ _52"></span><span class="ls0">his <span class="_ _42"> </span>signal <span class="_ _42"> </span>normally <span class="_ _42"> </span>stops <span class="_ _42"> </span>the <span class="_ _23"> </span>background <span class="_ _23"> </span>job; <span class="_ _42"> </span>by <span class="_ _42"> </span>using <span class="_ _42"> </span>the <span class="_ _42"> </span>shell, <span class="_ _23"> </span>we <span class="_ _42"> </span>are</span></span></div><div class="t m0 x32 h2a y26c7 ff19 fsf fc0 sc0 ls0 ws0">notiﬁed <span class="_ _3"></span>of <span class="_ _3"></span>this <span class="_ _3"></span>event <span class="_ _3"></span>and <span class="_ _3"></span>can <span class="_ _9"></span>bring <span class="_ _2"></span>the <span class="_ _9"></span>job <span class="_ _3"></span>into <span class="_ _3"></span>the <span class="_ _3"></span>foregr<span class="_ _0"></span>ound <span class="_ _3"></span>so <span class="_ _3"></span>that <span class="_ _3"></span>it <span class="_ _3"></span>can <span class="_ _3"></span>read <span class="_ _3"></span>from</div><div class="t m0 x32 h2a y26c8 ff19 fsf fc0 sc0 ls0 ws0">the terminal.<span class="_ _59"> </span>The following example demonstrates this:</div><div class="t m0 x3f h57 y26c9 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">cat &gt; temp.foo &amp;<span class="_ _182"> </span><span class="ff1b">start in background, but it’ll read fr<span class="_ _0"></span>om standard input</span></span></div><div class="t m0 x3f h57 y26ca ff1a fs2d fc0 sc0 ls0 ws0">[1] <span class="_ _15"> </span>1681</div><div class="t m0 x3f h57 y26cb ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_ _168"> </span><span class="ff1b">we press RETURN</span></div><div class="t m0 x3f h57 y26cc ff1a fs2d fc0 sc0 ls0 ws0">[1] + Stopped (SIGTTIN)<span class="_ _189"> </span>cat &gt; temp.foo &amp;</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
