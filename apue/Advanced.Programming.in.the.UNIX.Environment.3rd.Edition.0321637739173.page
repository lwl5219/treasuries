<div id="pfad" class="pf w4 h1f" data-page-no="ad"><div class="pc pcad w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bgad.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>4.24<span class="_ _9a"> </span>Device <span class="_"> </span>Special <span class="_"> </span>Files<span class="_ _1b"> </span><span class="ff18">139</span></div><div class="t m0 x9d h57 y425 ff1a fs2d fc0 sc0 ls0 ws0">if (S_ISCHR(buf.st_mode) || S_ISBLK(buf.st_mode)) {</div><div class="t m0 x1f h57 y426 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot; (%s) rdev = %d/%d&quot;,</div><div class="t m0 x36 h57 y800 ff1a fs2d fc0 sc0 ls0 ws0">(S_ISCHR(buf.st_mode)) ? &quot;character&quot; : &quot;block&quot;,</div><div class="t m0 x36 h57 y801 ff1a fs2d fc0 sc0 ls0 ws0">major(buf.st_rdev), minor(buf.st_rdev));</div><div class="t m0 x9d h57 y802 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x9d h57 y803 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\n&quot;);</div><div class="t m0 x8a h57 y804 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x8a h57 y13df ff1a fs2d fc0 sc0 ls0 ws0">exit(0);</div><div class="t m0 x32 h57 y13e0 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x8b h5e y13e1 ff18 fs10 fc0 sc0 ls0 ws0">Figure 4.25<span class="_ _5a"> </span><span class="ff19">Print<span class="_"> </span><span class="ff1a">st_dev<span class="_ _e"> </span></span>and<span class="_"> </span><span class="ff1a">st_rdev<span class="_ _e"> </span></span>values</span></div><div class="t m0 x32 h49 y13e2 ff19 fs26 fc0 sc0 ls0 ws0">Running this program on Linux gives us the following output:</div><div class="t m0 x3f h4e y13e3 ff1a fs28 fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">./a.out / /home/sar /dev/tty[01]</span></div><div class="t m0 x3f h4e y13e4 ff1a fs28 fc0 sc0 ls0 ws0">/: dev = 8/3</div><div class="t m0 x3f h4e y13e5 ff1a fs28 fc0 sc0 ls0 ws0">/home/sar: dev = 8/4</div><div class="t m0 x3f h4e y13e6 ff1a fs28 fc0 sc0 ls0 ws0">/dev/tty0: dev = 0/5 (character) rdev = 4/0</div><div class="t m0 x3f h4e y13e7 ff1a fs28 fc0 sc0 ls0 ws0">/dev/tty1: dev = 0/5 (character) rdev = 4/1</div><div class="t m0 x3f h4e y13e8 ff1a fs28 fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">mount<span class="_ _194"> </span><span class="ff1b">which directories ar<span class="_ _0"></span><span class="ls396">em<span class="_ _5"></span><span class="ls0">ounted on which devices?</span></span></span></span></div><div class="t m0 x3f h4e y13e9 ff1a fs28 fc0 sc0 ls0 ws0">/dev/sda3 on / type ext3 (rw,errors=remount-ro,commit=0)</div><div class="t m0 x3f h4e y13ea ff1a fs28 fc0 sc0 ls0 ws0">/dev/sda4 on /home type ext3 (rw,commit=0)</div><div class="t m0 x3f h4e y13eb ff1a fs28 fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">ls -l /dev/tty[01] /dev/sda[34]</span></div><div class="t m0 x3f h4e y13ec ff1a fs28 fc0 sc0 ls0 ws0">brw-rw---- <span class="_"> </span>1<span class="_"> </span>root <span class="_ _189"> </span>8,<span class="_"> </span><span class="ls1b6">32<span class="_ _5b"></span><span class="ls0">011-07-01 11:08 /dev/sda3</span></span></div><div class="t m0 x3f h4e y13ed ff1a fs28 fc0 sc0 ls0 ws0">brw-rw---- <span class="_"> </span>1<span class="_"> </span>root <span class="_ _189"> </span>8,<span class="_"> </span><span class="ls1b6">42<span class="_ _5b"></span><span class="ls0">011-07-01 11:08 /dev/sda4</span></span></div><div class="t m0 x3f h4e y13ee ff1a fs28 fc0 sc0 ls0 ws0">crw--w---- <span class="_"> </span>1<span class="_"> </span>root <span class="_ _189"> </span>4,<span class="_"> </span><span class="ls1b6">02<span class="_ _5b"></span><span class="ls0">011-07-01 11:08 /dev/tty0</span></span></div><div class="t m0 x3f h4e y13ef ff1a fs28 fc0 sc0 ls0 ws0">crw------- <span class="_"> </span>1<span class="_"> </span>root <span class="_ _189"> </span>4,<span class="_"> </span><span class="ls1b6">12<span class="_ _5b"></span><span class="ls0">011-07-01 11:08 /dev/tty1</span></span></div><div class="t m0 x32 h4d y13f0 ff19 fs26 fc0 sc0 ls0 ws0">The <span class="_ _42"> </span>ﬁrst <span class="_ _42"> </span>two <span class="_ _42"> </span>arguments <span class="_ _42"> </span>to <span class="_ _42"> </span>the <span class="_ _42"> </span>program <span class="_ _42"> </span>ar<span class="ls606">ed<span class="_ _c"></span><span class="ls0">irectories <span class="_ _42"> </span>(<span class="ff1a">/<span class="_ _35"> </span></span>and<span class="_ _44"> </span><span class="ff1a">/home/sar</span>), <span class="_ _42"> </span>and <span class="_ _53"> </span>the</span></span></div><div class="t m0 x32 h4d y13f1 ff19 fs26 fc0 sc0 ls0 ws0">next <span class="_ _3"></span>two <span class="_ _9"></span>ar<span class="ls607">et<span class="_ _b"></span><span class="ls0">he <span class="_ _9"></span>device <span class="_ _9"></span>names<span class="_ _47"> </span><span class="ff1a">/dev/tty[01]</span><span class="ls608">.(<span class="_ _1d"></span><span class="ls164">We <span class="_ _66"> </span>u<span class="_ _9"></span><span class="ls0">se <span class="_ _9"></span>the <span class="_ _3"></span>shell’s <span class="_ _9"></span>regular <span class="_ _3"></span>expression</span></span></span></span></span></div><div class="t m0 x32 h49 y13f2 ff19 fs26 fc0 sc0 ls0 ws0">language <span class="_ _42"> </span>to <span class="_ _23"> </span>shorten <span class="_ _42"> </span>the <span class="_ _42"> </span>amount <span class="_ _42"> </span>of <span class="_ _42"> </span>typing <span class="_ _42"> </span>we <span class="_ _42"> </span>need <span class="_ _23"> </span>to <span class="_ _42"> </span>do.<span class="_ _54"> </span>The <span class="_ _42"> </span>shell <span class="_ _42"> </span>will <span class="_ _42"> </span>expand <span class="_ _42"> </span>the</div><div class="t m0 x32 h4d y13f3 ff19 fs26 fc0 sc0 ls0 ws0">string<span class="_"> </span><span class="ff1a">/dev/tty[01]<span class="_ _80"> </span></span>to<span class="_"> </span><span class="ff1a">/dev/tty0 /dev/tty1</span>.)</div><div class="t m0 x3f h49 y13f4 ff19 fs26 fc0 sc0 ls164 ws0">We <span class="_ _47"> </span>e<span class="_ _9"></span><span class="ls0">xpect <span class="_ _42"> </span>the <span class="_ _23"> </span>devices <span class="_ _23"> </span>to <span class="_ _42"> </span>be <span class="_ _23"></span>character <span class="_ _23"> </span>special <span class="_ _23"> </span>ﬁles.<span class="_ _51"> </span>The <span class="_ _42"> </span>output <span class="_ _23"></span>from <span class="_ _23"></span>the <span class="_ _23"></span>program</span></div><div class="t m0 x32 h4d y13f5 ff19 fs26 fc0 sc0 ls0 ws0">shows <span class="_ _3"></span>that <span class="_ _9"></span>the <span class="_ _9"></span>root <span class="_ _3"></span>directory <span class="_ _3"></span>has <span class="_ _9"></span>a <span class="_ _9"></span>differ<span class="_ _0"></span>ent <span class="_ _9"></span>device <span class="_ _3"></span>number <span class="_ _9"></span>than <span class="_ _9"></span>does <span class="_ _9"></span>the<span class="_ _45"> </span><span class="ff1a">/home/sar</span></div><div class="t m0 x32 h4d y13f6 ff19 fs26 fc0 sc0 ls0 ws0">directory<span class="_ _4"></span><span class="ls609">,w<span class="_ _4f"></span><span class="ls0">hich <span class="_ _2"></span>indicates <span class="_ _2"></span>that <span class="_ _2"></span>they <span class="_ _3"></span>ar<span class="ls609">eo<span class="_ _8"></span><span class="ls13d">nd<span class="_ _4f"></span><span class="ls0">ifferent ﬁle <span class="_ _2"></span>systems.<span class="_ _61"> </span>Running <span class="_ _3"></span>the<span class="_ _66"> </span><span class="ff1a">mount</span></span></span></span></span></span></div><div class="t m0 x40 h49 y13f7 ff19 fs26 fc0 sc0 ls0 ws0">(</div><div class="t m0 x1b2 h49 y13f6 ff19 fs26 fc0 sc0 ls0 ws0">1</div><div class="t m0 x17e h49 y13f7 ff19 fs26 fc0 sc0 ls0 ws0">)</div><div class="t m0 x32 h49 y13f8 ff19 fs26 fc0 sc0 ls0 ws0">command veriﬁes this.</div><div class="t m0 x3f h4d y13f9 ff19 fs26 fc0 sc0 ls164 ws0">We <span class="_ _45"> </span>t<span class="_ _9"></span><span class="ls0">hen <span class="_ _42"> </span>use<span class="_ _44"> </span><span class="ff1a">ls<span class="_ _44"> </span></span>to <span class="_ _42"> </span>look <span class="_ _42"> </span>at <span class="_ _42"> </span>the <span class="_ _42"> </span>two <span class="_ _42"> </span>disk <span class="_ _42"> </span>devices <span class="_ _53"> </span>reported <span class="_ _23"> </span>by<span class="_ _44"> </span><span class="ff1a">mount<span class="_ _44"> </span></span>and <span class="_ _42"> </span>the <span class="_ _42"> </span>two</span></div><div class="t m0 x32 h49 y13fa ff19 fs26 fc0 sc0 ls0 ws0">terminal <span class="_ _42"> </span>devices.<span class="_ _65"> </span>The <span class="_ _53"> </span>two <span class="_ _53"> </span>disk <span class="_ _53"> </span>devices <span class="_ _53"> </span>ar<span class="ls60a">eb<span class="_ _55"></span><span class="ls0">lock <span class="_ _53"> </span>special <span class="_ _53"> </span>ﬁles, <span class="_ _53"> </span>and <span class="_ _53"> </span>the <span class="_ _53"> </span>two <span class="_ _42"> </span>terminal</span></span></div><div class="t m0 x32 h49 y13fb ff19 fs26 fc0 sc0 ls0 ws0">devices <span class="_ _23"></span>ar<span class="ls60b">ec<span class="_ _43"></span><span class="ls0">haracter <span class="_ _23"></span>special <span class="_ _23"></span>ﬁles.<span class="_ _51"> </span>(Normally<span class="_ _4"></span><span class="ls60b">,t<span class="_ _b"></span><span class="ls0">he <span class="_ _9"></span>only <span class="_ _23"> </span>types <span class="_ _23"> </span>of <span class="_ _23"> </span>devices <span class="_ _23"> </span>that <span class="_ _23"> </span>ar<span class="ls60c">eb<span class="_ _43"></span><span class="ls0">lock</span></span></span></span></span></span></div><div class="t m0 x32 h49 y13fc ff19 fs26 fc0 sc0 ls0 ws0">special <span class="_ _3"></span>ﬁles <span class="_ _9"></span>ar<span class="ls60d">et<span class="_ _b"></span><span class="ls0">hose <span class="_ _3"></span>that <span class="_ _9"></span>can <span class="_ _3"></span>contain <span class="_ _9"></span>random-access <span class="_ _3"></span>ﬁle <span class="_ _9"></span>systems<span class="_ _9"></span><span class="ls161">—d<span class="_ _6"></span><span class="ls0">isk <span class="_ _3"></span>drives, <span class="_ _9"></span>ﬂoppy</span></span></span></span></div><div class="t m0 x32 h49 y13fd ff19 fs26 fc0 sc0 ls0 ws0">disk <span class="_ _35"> </span>drives, <span class="_ _44"> </span>and <span class="_ _44"> </span>CD</div><div class="t m0 x108 h49 y13fe ff19 fs26 fc0 sc0 ls0 ws0">-</div><div class="t m0 x3c h49 y13fd ff19 fs26 fc0 sc0 ls0 ws0">ROMs, <span class="_ _35"> </span>for <span class="_ _44"> </span>example.<span class="_ _98"> </span>Some <span class="_ _44"> </span>older <span class="_ _35"> </span>UNIX <span class="_ _44"> </span>systems <span class="_ _44"> </span>supported</div><div class="t m0 x32 h49 y13ff ff19 fs26 fc0 sc0 ls0 ws0">magnetic tapes for ﬁle systems, but this was never widely used.)</div><div class="t m0 x3f h4d y1400 ff19 fs26 fc0 sc0 ls0 ws0">Note <span class="_ _9"></span>that <span class="_ _23"></span>the <span class="_ _9"></span>ﬁlenames <span class="_ _23"></span>and <span class="_ _9"></span>i-nodes <span class="_ _9"></span>for <span class="_ _23"></span>the <span class="_ _9"></span>two <span class="_ _23"></span>terminal <span class="_ _9"></span>devices <span class="_ _9"></span>(<span class="_ _2"></span><span class="ff1a">st_dev</span><span class="ls60e">)a<span class="_ _b"></span><span class="lscc">re <span class="_ _23"></span>o<span class="ls0">n</span></span></span></div><div class="t m0 x32 h4d y1401 ff19 fs26 fc0 sc0 ls0 ws0">device <span class="_ _3"></span>0/5<span class="_ _9"></span><span class="ls161">—t<span class="_ _1"></span><span class="ls0">he<span class="_ _47"> </span><span class="ff1a">devtmpfs<span class="_ _45"> </span></span>pseudo <span class="_ _3"></span>ﬁle <span class="_ _9"></span>system, <span class="_ _3"></span>which <span class="_ _9"></span>implements <span class="_ _9"></span>the<span class="_ _47"> </span><span class="ff1a">/dev</span>—but <span class="_ _9"></span>that</span></span></div><div class="t m0 x32 h49 y1402 ff19 fs26 fc0 sc0 ls0 ws0">their actual device numbers ar<span class="lsd3">e4<span class="_ _4f"></span><span class="ls0">/0 and 4/1.</span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
