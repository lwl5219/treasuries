<div id="pf165" class="pf w4 h1f" data-page-no="165"><div class="pc pc165 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg165.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h7a ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>10.3<span class="_ _23a"> </span><span class="ff1a">signal<span class="_ _4b"> </span></span>Function<span class="_ _1b"> </span><span class="ff18">323</span></div><div class="t m0 x35 h75 y12f ff16 fs2b fc0 sc0 ls0 ws0">10.3<span class="_ _6d"> </span><span class="ff1f">signal<span class="_ _54"> </span></span>Function</div><div class="t m0 x32 h26 y507 ff19 fsf fc0 sc0 ls0 ws0">The simplest interface <span class="_ _2"></span>to the signal <span class="_ _2"></span>features of the UNIX System <span class="_ _2"></span>is the<span class="_"> </span><span class="ff1a">signal<span class="_ _66"> </span></span>function.</div><div class="t m0 x3f h57 y1e69 ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;signal.h&gt;</div><div class="t m0 x3f h57 y2985 ff1a fs2d fc0 sc0 ls0 ws0">void (*signal(int<span class="_"> </span><span class="ff1b">signo</span><span class="ls15c">,v<span class="_ _1d"></span><span class="ls0">oid (*<span class="ff1b">func</span>)(int)))(int);</span></span></div><div class="t m0 x198 h57 y2986 ff19 fs2d fc0 sc0 ls0 ws0">Returns: previous disposition of signal (see following) if OK,<span class="_"> </span><span class="ff1a">SIG_ERR<span class="_ _e"> </span></span>on error</div><div class="t m0 x76 h5e y2987 ff19 fs10 fc0 sc0 ls0 ws0">The<span class="_ _66"> </span><span class="ff1a">signal<span class="_ _66"> </span></span>function <span class="_ _9"></span>is <span class="_ _3"></span>deﬁned <span class="_ _9"></span>by <span class="_ _9"></span>ISO <span class="_ _3"></span>C, <span class="_ _9"></span>which <span class="_ _3"></span>doesn’t <span class="_ _9"></span>involve <span class="_ _9"></span>multiple <span class="_ _3"></span>processes, <span class="_ _3"></span>process</div><div class="t m0 x76 h2d y2988 ff19 fs10 fc0 sc0 ls0 ws0">groups, <span class="_ _3"></span>terminal <span class="_ _9"></span>I/O, <span class="_ _9"></span>and <span class="_ _9"></span>the <span class="_ _3"></span>like.<span class="_ _46"> </span>Therefor<span class="_ _0"></span>e, <span class="_ _3"></span>its <span class="_ _9"> </span>deﬁnition <span class="_ _9"></span>of <span class="_ _9"></span>signals <span class="_ _9"></span>is <span class="_ _9"></span>vague <span class="_ _9"></span>enough <span class="_ _3"></span>to <span class="_ _9"> </span>be</div><div class="t m0 x76 h2d y2989 ff19 fs10 fc0 sc0 ls0 ws0">almost useless for UNIX systems.</div><div class="t m0 x76 h5e y298a ff19 fs10 fc0 sc0 ls0 ws0">Implementations <span class="_ _3"></span>derived <span class="_ _3"></span>from <span class="_ _3"></span>UNIX <span class="_ _3"></span>System <span class="_ _9"></span>V <span class="_ _3"></span>support <span class="_ _3"></span>the<span class="_ _66"> </span><span class="ff1a">signal<span class="_ _66"> </span></span>function, <span class="_ _9"></span>but <span class="_ _3"></span>it <span class="_ _3"></span>provides</div><div class="t m0 x76 h2d y298b ff19 fs10 fc0 sc0 ls0 ws0">the <span class="_ _9"></span>old <span class="_ _3"></span>unreliable-signal <span class="_ _9"></span>semantics.<span class="_ _59"> </span>(W<span class="_ _1"></span><span class="lsbd7">ed<span class="_ _4f"></span><span class="ls0">escribe <span class="_ _9"></span>these <span class="_ _9"></span>older <span class="_ _3"></span>semantics <span class="_ _9"> </span>in <span class="_ _9"></span>Section <span class="_ _9"></span>10.4.)<span class="_ _59"> </span>The</span></span></div><div class="t m0 x76 h5e y298c ff1a fs10 fc0 sc0 ls0 ws0">signal<span class="_ _44"> </span><span class="ff19">function <span class="_"> </span>provides <span class="_ _e"> </span>backwar<span class="lsbd8">dc<span class="_ _c"></span><span class="ls0">ompatibility <span class="_ _80"> </span>for <span class="_ _e"> </span>applications <span class="_ _80"> </span>that <span class="_ _e"> </span>requir<span class="lsbd8">et<span class="_ _c"></span><span class="ls0">he <span class="_ _e"> </span>older</span></span></span></span></span></div><div class="t m0 x76 h2d y298d ff19 fs10 fc0 sc0 ls0 ws0">semantics. <span class="_"> </span>New<span class="_"> </span>applications should not use these unreliable signals.</div><div class="t m0 x76 h5e y298e ff19 fs10 fc0 sc0 ls0 ws0">4.4BSD <span class="_"> </span>also <span class="_"> </span>provides <span class="_"> </span>the<span class="_ _35"> </span><span class="ff1a">signal<span class="_ _44"> </span></span>function, <span class="_"> </span>but <span class="_"> </span>it <span class="_"> </span>is <span class="_"> </span>deﬁned <span class="_"> </span>in <span class="_"> </span>terms <span class="_"> </span>of <span class="_"> </span>the<span class="_ _35"> </span><span class="ff1a">sigaction</span></div><div class="t m0 x76 h2d y298f ff19 fs10 fc0 sc0 ls0 ws0">function <span class="_ _23"> </span>(which <span class="_ _9"></span>we <span class="_ _23"> </span>describe <span class="_ _23"> </span>in <span class="_ _9"> </span>Section <span class="_ _23"> </span>10.14), <span class="_ _23"> </span>so <span class="_ _23"> </span>using <span class="_ _9"></span>it <span class="_ _23"> </span>under <span class="_ _23"> </span>4.4BSD <span class="_ _9"> </span>provides <span class="_ _23"> </span>the <span class="_ _9"> </span>newer</div><div class="t m0 x76 h2d y2990 ff19 fs10 fc0 sc0 ls21d ws0">re<span class="ls0">liable-signal <span class="_ _3"></span>semantics.<span class="_ _4b"> </span>Most <span class="_ _2"></span>current <span class="_ _3"></span>systems <span class="_ _2"></span>follow <span class="_ _3"></span>this <span class="_ _3"></span>strategy<span class="_ _6"></span><span class="lsbd9">,b<span class="_ _d"></span><span class="ls0">ut <span class="_ _3"></span>Solaris <span class="_ _3"></span>10 <span class="_ _3"></span>follows <span class="_ _2"></span>the</span></span></span></div><div class="t m0 x76 h5e y2991 ff19 fs10 fc0 sc0 ls0 ws0">System V semantics for the<span class="_"> </span><span class="ff1a">signal<span class="_ _53"> </span></span>function.</div><div class="t m0 x76 h5e y2992 ff19 fs10 fc0 sc0 ls0 ws0">Because the semantics <span class="_ _2"></span>of<span class="_"> </span><span class="ff1a">signal<span class="_ _80"> </span></span>differ among implementations, we <span class="_ _2"></span>must use the<span class="_ _80"> </span><span class="ff1a">sigaction</span></div><div class="t m0 x76 h5e y2993 ff19 fs10 fc0 sc0 ls0 ws0">function <span class="_ _47"> </span>instead.<span class="_ _60"> </span><span class="ls292">We <span class="_ _4b"> </span>p<span class="_ _9"></span><span class="ls21d">ro</span></span>vide <span class="_ _45"> </span>an <span class="_ _47"> </span>implementation <span class="_ _45"> </span>of<span class="_ _46"> </span><span class="ff1a">signal<span class="_ _61"> </span></span>that <span class="_ _45"> </span>uses<span class="_ _46"> </span><span class="ff1a">sigaction<span class="_ _46"> </span></span>in</div><div class="t m0 x76 h5e y2994 ff19 fs10 fc0 sc0 ls0 ws0">Section <span class="_ _2"></span>10.14.<span class="_ _4b"> </span>All <span class="_ _2"></span>the <span class="_ _3"></span>examples <span class="_ _2"></span>in <span class="_ _3"></span>this <span class="_ _2"></span>text <span class="_ _3"></span>use <span class="_ _2"></span>the<span class="_ _80"> </span><span class="ff1a">signal<span class="_ _80"> </span></span>function <span class="_ _3"></span>from <span class="_ _2"></span>Figur<span class="lsbda">e1<span class="_ _d"></span><span class="ls0">0.18 <span class="_ _3"></span>to <span class="_ _2"></span>give</span></span></div><div class="t m0 x76 h2d y2995 ff19 fs10 fc0 sc0 ls0 ws0">us consistent semantics regar<span class="_ _0"></span>dless of which particular platform we use.</div><div class="t m0 x3f h4a y2996 ff19 fs26 fc0 sc0 ls0 ws0">The<span class="_ _35"> </span><span class="ff1b">signo<span class="_ _35"> </span></span>argument <span class="_ _23"></span>is <span class="_ _23"> </span>just <span class="_ _42"> </span>the <span class="_ _23"> </span>name <span class="_ _42"> </span>of <span class="_ _23"> </span>the <span class="_ _23"> </span>signal <span class="_ _42"> </span>from <span class="_ _23"></span>Figur<span class="ls7b1">e1<span class="_ _43"></span><span class="ls0">0.1. <span class="_ _35"> </span>The<span class="_ _35"> </span>value <span class="_ _23"> </span>of</span></span></div><div class="t m0 x32 h4d y2997 ff1b fs26 fc0 sc0 ls0 ws0">func<span class="_ _4b"> </span><span class="ff19">is <span class="_ _53"> </span>(a) <span class="_ _e"> </span>the <span class="_ _e"> </span>constant<span class="_ _4b"> </span><span class="ff1a">SIG_IGN</span><span class="lsbdb">,(<span class="_ _55"></span><span class="ls0">b) <span class="_ _e"> </span>the <span class="_ _e"> </span>constant<span class="_ _4b"> </span><span class="ff1a">SIG_DFL</span>,<span class="_ _4b"> </span>or<span class="_ _4b"> </span>(c) <span class="_ _e"> </span>the <span class="_ _53"> </span>address <span class="_ _53"> </span>of <span class="_ _e"> </span>a</span></span></span></div><div class="t m0 x32 h4d y2998 ff19 fs26 fc0 sc0 ls0 ws0">function <span class="_ _2"></span>to <span class="_ _3"></span>be <span class="_ _3"></span>called <span class="_ _3"></span>when <span class="_ _3"></span>the <span class="_ _2"></span>signal <span class="_ _3"></span>occurs.<span class="_ _16"> </span>If <span class="_ _3"></span>we <span class="_ _3"></span>specify<span class="_ _47"> </span><span class="ff1a">SIG_IGN</span>,<span class="_ _47"> </span>we<span class="_ _47"> </span>a<span class="lscc">re <span class="_ _9"></span>t</span>elling <span class="_ _3"></span>the</div><div class="t m0 x32 h4d y2999 ff19 fs26 fc0 sc0 ls0 ws0">system to ignor<span class="lsbdc">et<span class="_ _4f"></span><span class="ls0">he <span class="_ _2"></span>signal.<span class="_ _46"> </span>(Remember that we cannot ignor<span class="lsbdc">et<span class="_ _d"></span><span class="ls0">he two signals<span class="_"> </span><span class="ff1a">SIGKILL</span></span></span></span></span></div><div class="t m0 x32 h4d y299a ff19 fs26 fc0 sc0 ls0 ws0">and<span class="_ _35"> </span><span class="ff1a">SIGSTOP</span>.) <span class="_ _45"> </span>When<span class="_ _35"> </span>we <span class="_ _23"> </span>specify<span class="_ _35"> </span><span class="ff1a">SIG_DFL</span>,<span class="_ _35"> </span>we<span class="_ _45"> </span>a<span class="lscc">re <span class="_ _42"> </span>s<span class="_ _2"></span></span>etting <span class="_ _23"> </span>the <span class="_ _23"> </span>action <span class="_ _23"></span>associated <span class="_ _23"></span>with</div><div class="t m0 x32 h49 y299b ff19 fs26 fc0 sc0 ls0 ws0">the signal <span class="_ _2"></span>to its <span class="_ _2"></span>default <span class="_ _2"></span>value (see <span class="_ _2"></span>the ﬁnal <span class="_ _2"></span>column <span class="_ _2"></span>in Figur<span class="lsbdd">e1<span class="_ _4f"></span><span class="ls0">0.1). <span class="_ _66"> </span>When<span class="_ _66"> </span>we <span class="_ _2"></span>specify <span class="_ _2"></span>the</span></span></div><div class="t m0 x32 h49 y299c ff19 fs26 fc0 sc0 ls0 ws0">address <span class="_ _3"></span>of <span class="_ _23"></span>a <span class="_ _9"></span>function <span class="_ _9"></span>to <span class="_ _9"></span>be <span class="_ _9"></span>called <span class="_ _23"></span>when <span class="_ _9"></span>the <span class="_ _9"></span>signal <span class="_ _9"></span>occurs, <span class="_ _9"></span>we <span class="_ _23"></span>ar<span class="lsbde">ea<span class="_ _b"></span><span class="ls0">rranging <span class="_ _3"></span>to <span class="_ _23"></span>‘<span class="_ _1"></span>‘catch’’</span></span></div><div class="t m0 x32 h4a y299d ff19 fs26 fc0 sc0 ls0 ws0">the signal.<span class="_ _59"> </span><span class="ls164">We <span class="_ _e"> </span>c<span class="_ _9"></span></span>all the function either the<span class="_"> </span><span class="ff1b">signal handler<span class="_"> </span></span>or the<span class="_"> </span><span class="ff1b">signal-catching function</span>.</div><div class="t m0 x3f h4d y299e ff19 fs26 fc0 sc0 ls0 ws0">The <span class="_ _45"> </span>prototype <span class="_ _45"> </span>for <span class="_ _45"> </span>the<span class="_ _5a"> </span><span class="ff1a">signal<span class="_"> </span></span>function <span class="_ _35"> </span>states <span class="_ _45"> </span>that <span class="_ _45"> </span>the <span class="_ _45"> </span>function <span class="_ _35"> </span>r<span class="_ _0"></span>equires <span class="_ _45"> </span>two</div><div class="t m0 x32 h4d y299f ff19 fs26 fc0 sc0 ls0 ws0">arguments and returns a pointer to a <span class="_ _2"></span>function that returns nothing (<span class="ff1a">void</span>). <span class="_ _66"> </span>The<span class="_"> </span><span class="ff1a">signal</span></div><div class="t m0 x32 h4a y29a0 ff19 fs26 fc0 sc0 ls0 ws0">function’s <span class="_ _42"> </span>ﬁrst <span class="_ _42"> </span>argument,<span class="_ _35"> </span><span class="ff1b">signo</span>,<span class="_ _44"> </span>is<span class="_ _35"> </span>an<span class="_ _44"> </span>integer<span class="_ _1"></span><span class="lsbdf">.T<span class="_ _52"></span><span class="ls0">he <span class="_ _42"> </span>second <span class="_ _42"> </span>argument <span class="_ _42"> </span>is <span class="_ _42"> </span>a <span class="_ _42"> </span>pointer <span class="_ _42"> </span>to <span class="_ _42"> </span>a</span></span></div><div class="t m0 x32 h49 y29a1 ff19 fs26 fc0 sc0 ls0 ws0">function <span class="_ _3"></span>that <span class="_ _3"></span>takes <span class="_ _3"></span>a <span class="_ _3"></span>single <span class="_ _3"></span>integer <span class="_ _3"></span>argument <span class="_ _2"></span>and <span class="_ _3"></span>returns <span class="_ _3"></span>nothing.<span class="_ _61"> </span>The <span class="_ _3"></span>function <span class="_ _9"></span>whose</div><div class="t m0 x32 h4d y29a2 ff19 fs26 fc0 sc0 ls0 ws0">address <span class="_ _9"></span>is <span class="_ _42"> </span>returned <span class="_ _9"></span>as <span class="_ _42"> </span>the <span class="_ _23"></span>value <span class="_ _23"></span>of<span class="_ _35"> </span><span class="ff1a">signal<span class="_ _35"> </span></span>takes <span class="_ _23"></span>a <span class="_ _23"> </span>single <span class="_ _23"> </span>integer <span class="_ _23"> </span>argument <span class="_ _23"> </span>(the <span class="_ _23"> </span>ﬁnal</div><div class="t m0 x32 h4d y29a3 ff1a fs26 fc0 sc0 ls0 ws0">(int)<span class="ff19">). <span class="_"> </span>In<span class="_ _47"> </span>plain English, <span class="_ _2"></span>this <span class="_ _2"></span>declaration <span class="_ _2"></span>says <span class="_ _2"></span>that <span class="_ _2"></span>the <span class="_ _2"></span>signal handler <span class="_ _2"></span>is <span class="_ _2"></span>passed <span class="_ _2"></span>a <span class="_ _2"></span>single</span></div><div class="t m0 x32 h49 y29a4 ff19 fs26 fc0 sc0 ls0 ws0">integer <span class="_ _47"> </span>argument <span class="_ _47"> </span>(the <span class="_ _47"> </span>signal <span class="_ _45"> </span>number) <span class="_ _47"> </span>and <span class="_ _47"> </span>that <span class="_ _47"> </span>it <span class="_ _45"> </span>r<span class="_ _0"></span>eturns <span class="_ _47"> </span>nothing.<span class="_ _5f"> </span>When <span class="_ _47"> </span>we <span class="_ _45"> </span>call</div><div class="t m0 x32 h4d y29a5 ff1a fs26 fc0 sc0 ls0 ws0">signal<span class="_ _80"> </span><span class="ff19">to <span class="_ _2"></span>establish the signal handler<span class="_ _1"></span><span class="lsa2f">,t<span class="_ _d"></span><span class="ls0">he second argument is a pointer <span class="_ _2"></span>to the function.</span></span></span></div><div class="t m0 x32 h4d y29a6 ff19 fs26 fc0 sc0 ls0 ws0">The return value fr<span class="_ _0"></span>om<span class="_"> </span><span class="ff1a">signal<span class="_ _80"> </span></span>is the pointer to the previous signal handler<span class="_ _6"></span>.</div><div class="t m0 x76 h2d y29a7 ff19 fs10 fc0 sc0 ls0 ws0">Many <span class="_ _3"></span>systems <span class="_ _3"></span>call <span class="_ _9"></span>the <span class="_ _3"></span>signal <span class="_ _3"></span>handler <span class="_ _3"></span>with <span class="_ _9"></span>additional, <span class="_ _3"></span>implementation-dependent <span class="_ _3"></span>arguments.</div><div class="t m0 x76 h2d y29a8 ff19 fs10 fc0 sc0 ls292 ws0">We <span class="_"> </span>d<span class="_ _9"></span><span class="ls0">iscuss this further in Section 10.14.</span></div><div class="t m0 x3f h4d y29a9 ff19 fs26 fc0 sc0 ls0 ws0">The <span class="_ _9"></span>perplexing<span class="_ _45"> </span><span class="ff1a">signal<span class="_ _35"> </span></span>function <span class="_ _9"></span>prototype <span class="_ _9"></span>shown <span class="_ _9"></span>at <span class="_ _23"></span>the <span class="_ _9"></span>beginning <span class="_ _9"></span>of <span class="_ _23"></span>this <span class="_ _9"></span>section</div><div class="t m0 x32 h4d y29aa ff19 fs26 fc0 sc0 ls0 ws0">can be made much simpler through the use of the following<span class="_"> </span><span class="ff1a">typedef</span></div><div class="t m0 x152 h49 y29ab ff19 fs26 fc0 sc0 ls0 ws0">[</div><div class="t m0 x11d h49 y29aa ff19 fs26 fc0 sc0 ls0 ws0">Plauger 1992</div><div class="t m0 x162 h49 y29ab ff19 fs26 fc0 sc0 ls0 ws0">]</div><div class="t m0 x42 h49 y29aa ff19 fs26 fc0 sc0 ls0 ws0">:</div><div class="t m0 x3f h4e y29ac ff1a fs28 fc0 sc0 ls0 ws0">typedef void Sigfunc(int);</div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.892409px;bottom:1236.288916px;width:136.535805px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
