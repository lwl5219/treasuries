<div id="pf1a2" class="pf w4 h1f" data-page-no="1a2"><div class="pc pc1a2 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg1a2.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">384<span class="_ _1b"> </span><span class="ff19">Threads <span class="_ _24b"> </span>Chapter<span class="_ _78"> </span><span class="ls7ed">11</span></span></div><div class="t m0 x15 h2a y12f ff19 fsf fc0 sc0 ls0 ws0">and <span class="_ _53"> </span>17.<span class="_ _65"> </span>Threads, <span class="_ _53"> </span>in <span class="_ _53"> </span>contrast, <span class="_ _53"> </span>automatically <span class="_ _e"> </span>have <span class="_ _53"> </span>access <span class="_ _53"> </span>to <span class="_ _e"> </span>the <span class="_ _53"> </span>same <span class="_ _53"> </span>memory</div><div class="t m0 x15 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">address space and ﬁle descriptors.</div><div class="t m0 x3f h2a y6f8 ff19 fsf fc0 sc0 ls49 ws0">•S<span class="_ _4d"></span><span class="ls0">ome <span class="_ _23"> </span>problems <span class="_ _42"> </span>can <span class="_ _23"> </span>be <span class="_ _42"> </span>partitioned <span class="_ _42"> </span>so <span class="_ _42"> </span>that <span class="_ _23"> </span>overall <span class="_ _42"> </span>program <span class="_ _23"> </span>throughput <span class="_ _23"> </span>can <span class="_ _42"> </span>be</span></div><div class="t m0 x15 h2a y2860 ff19 fsf fc0 sc0 ls0 ws0">improved. <span class="_ _47"> </span>A<span class="_ _45"> </span>single-threaded <span class="_ _9"></span>process <span class="_ _9"></span>with <span class="_ _9"></span>multiple <span class="_ _9"></span>tasks <span class="_ _9"></span>to <span class="_ _23"></span>perform <span class="_ _9"></span>implicitly</div><div class="t m0 x15 h2a y30e7 ff19 fsf fc0 sc0 ls0 ws0">serializes <span class="_ _2"></span>those <span class="_ _3"></span>tasks, <span class="_ _2"></span>because <span class="_ _3"></span>there<span class="_ _66"> </span>is<span class="_ _47"> </span>only <span class="_ _3"></span>one <span class="_ _2"></span>thread <span class="_ _2"></span>of <span class="_ _3"></span>control. <span class="_ _66"> </span>W<span class="_ _1"></span>ith <span class="_ _3"></span>multiple</div><div class="t m0 x15 h2a y30e8 ff19 fsf fc0 sc0 ls0 ws0">threads <span class="_ _42"> </span>of <span class="_ _42"> </span>control, <span class="_ _42"> </span>the <span class="_ _53"> </span>processing <span class="_ _42"> </span>of <span class="_ _53"> </span>independent <span class="_ _53"> </span>tasks <span class="_ _53"> </span>can <span class="_ _42"> </span>be <span class="_ _53"> </span>interleaved <span class="_ _53"> </span>by</div><div class="t m0 x15 h2a y30e9 ff19 fsf fc0 sc0 ls0 ws0">assigning <span class="_ _9"></span>a <span class="_ _9"></span>separate <span class="_ _9"></span>thread <span class="_ _9"></span>per <span class="_ _9"></span>task.<span class="_ _5a"> </span><span class="lsbc">Tw<span class="_ _9"></span><span class="ls144">ot<span class="_ _b"></span><span class="ls0">asks <span class="_ _9"></span>can <span class="_ _23"></span>be <span class="_ _9"></span>interleaved <span class="_ _9"></span>only <span class="_ _9"></span>if <span class="_ _9"></span>they</span></span></span></div><div class="t m0 x15 h2a y30ea ff19 fsf fc0 sc0 ls0 ws0">don’t depend on the processing performed by each other<span class="_ _6"></span>.</div><div class="t m0 x3f h2a y30eb ff19 fsf fc0 sc0 ls49 ws0">•S<span class="_ _4d"></span><span class="ls0">imilarly<span class="_ _4"></span><span class="ls660">,i<span class="_ _55"></span><span class="ls0">nteractive <span class="_"> </span>pr<span class="_ _1"></span>ograms <span class="_"> </span>can <span class="_"> </span>r<span class="_ _0"></span>ealize <span class="_"> </span>impr<span class="_ _0"></span>oved <span class="_ _e"> </span>response <span class="_"> </span>time <span class="_ _e"> </span>by <span class="_"> </span>using</span></span></span></div><div class="t m0 x15 h2a ya64 ff19 fsf fc0 sc0 ls0 ws0">multiple <span class="_ _53"> </span>threads <span class="_ _53"> </span>to <span class="_ _53"> </span>separate <span class="_ _e"> </span>the <span class="_ _53"> </span>portions <span class="_ _e"> </span>of <span class="_ _53"> </span>the <span class="_ _53"> </span>program <span class="_ _53"> </span>that <span class="_ _e"> </span>deal <span class="_ _53"> </span>with <span class="_ _e"> </span>user</div><div class="t m0 x15 h2a y30ec ff19 fsf fc0 sc0 ls0 ws0">input and output from the other parts of the pr<span class="_ _0"></span>ogram.</div><div class="t m0 x3f h2a y10ce ff19 fsf fc0 sc0 ls0 ws0">Some <span class="_ _16"> </span>people <span class="_ _16"> </span>associate <span class="_ _5a"> </span>multithreaded <span class="_ _61"> </span>programming <span class="_ _16"> </span>with <span class="_ _16"> </span>multiprocessor <span class="_ _16"> </span>or</div><div class="t m0 x32 h2a y1543 ff19 fsf fc0 sc0 ls0 ws0">multicor<span class="lsd7c">es<span class="_ _4f"></span><span class="ls0">ystems. <span class="_"> </span>The<span class="_"> </span>beneﬁts <span class="_ _2"></span>of a multithreaded programming model can be realized</span></span></div><div class="t m0 x32 h2a y643 ff19 fsf fc0 sc0 ls0 ws0">even <span class="_ _2"></span>if <span class="_ _3"></span>your <span class="_ _3"></span>program <span class="_ _2"></span>is <span class="_ _2"></span>running <span class="_ _3"></span>on <span class="_ _2"></span>a <span class="_ _3"></span>uniprocessor<span class="_ _6"></span><span class="lsd7d">.A<span class="_ _d"></span><span class="ls0">program <span class="_ _2"></span>can <span class="_ _3"></span>be <span class="_ _3"></span>simpliﬁed <span class="_ _2"></span>using</span></span></div><div class="t m0 x32 h2a y1544 ff19 fsf fc0 sc0 ls0 ws0">threads <span class="_"> </span>regar<span class="_ _0"></span>dless <span class="_"> </span>of <span class="_ _66"> </span>the <span class="_ _47"> </span>number <span class="_"> </span>of <span class="_ _66"> </span>processors, <span class="_"> </span>because <span class="_ _47"> </span>the <span class="_"> </span>number <span class="_ _66"> </span>of <span class="_ _47"> </span>processors</div><div class="t m0 x32 h2a y1545 ff19 fsf fc0 sc0 ls0 ws0">doesn’t <span class="_ _e"> </span>affect <span class="_ _e"> </span>the <span class="_ _e"> </span>program <span class="_ _e"> </span>structure. <span class="_ _4b"> </span>Furthermore, <span class="_ _e"> </span>as <span class="_ _e"> </span>long <span class="_"> </span>as <span class="_ _53"> </span>your <span class="_"> </span>pr<span class="_ _0"></span>ogram <span class="_ _e"> </span>has <span class="_"> </span>to</div><div class="t m0 x32 h2a y1546 ff19 fsf fc0 sc0 ls0 ws0">block <span class="_"> </span>when <span class="_"> </span>serializing <span class="_"> </span>tasks, <span class="_"> </span>you <span class="_ _e"> </span>can <span class="_"> </span>still <span class="_"> </span>see <span class="_"> </span>improvements <span class="_ _e"> </span>in <span class="_"> </span>response <span class="_"> </span>time <span class="_"> </span>and</div><div class="t m0 x32 h2a y1547 ff19 fsf fc0 sc0 ls0 ws0">throughput when running on a unipr<span class="_ _0"></span>ocessor<span class="_ _6"></span><span class="lsd7e">,b<span class="_ _d"></span><span class="ls0">ecause some threads might be able to run</span></span></div><div class="t m0 x32 h2a y1548 ff19 fsf fc0 sc0 ls0 ws0">while others ar<span class="ls44">eb<span class="_ _4f"></span><span class="ls0">locked.</span></span></div><div class="t m0 x3f h2a y14b2 ff19 fsf fc0 sc0 lsd7f ws0">At<span class="_ _c"></span><span class="ls0">hread <span class="_ _42"> </span>consists <span class="_ _53"> </span>of <span class="_ _53"> </span>the <span class="_ _53"> </span>information <span class="_ _53"> </span>necessary <span class="_ _42"> </span>to <span class="_ _53"> </span>represent <span class="_ _42"> </span>an <span class="_ _53"> </span>execution <span class="_ _53"> </span>context</span></div><div class="t m0 x32 h2b y259 ff19 fsf fc0 sc0 ls0 ws0">within <span class="_ _2"></span>a <span class="_ _3"></span>process. <span class="_ _47"> </span>This<span class="_ _47"> </span>includes <span class="_ _2"></span>a<span class="_ _47"> </span><span class="ff1b">thread <span class="_ _3"></span>ID<span class="_ _47"> </span></span>that <span class="_ _2"></span>identiﬁes <span class="_ _3"></span>the <span class="_ _3"></span>thread <span class="_ _2"></span>within <span class="_ _3"></span>a <span class="_ _3"></span>process, <span class="_ _2"></span>a</div><div class="t m0 x32 h26 y14b3 ff19 fsf fc0 sc0 ls0 ws0">set <span class="_ _2"></span>of <span class="_ _2"></span>register <span class="_ _2"></span>values, <span class="_ _2"></span>a <span class="_ _3"></span>stack, <span class="_ _2"></span>a <span class="_ _2"></span>scheduling <span class="_ _3"></span>priority <span class="_ _2"></span>and <span class="_ _3"></span>policy<span class="_ _4"></span><span class="lsd80">,as<span class="_ _4f"></span><span class="ls0">ignal <span class="_ _2"></span>mask, <span class="_ _3"></span>an<span class="_ _47"> </span><span class="ff1a">errno</span></span></span></div><div class="t m0 x32 h2a y14b4 ff19 fsf fc0 sc0 ls0 ws0">variable <span class="_ _2"></span>(recall Section <span class="_ _3"></span>1.7), <span class="_ _2"></span>and <span class="_ _2"></span>thread-speciﬁc data <span class="_ _3"></span>(Section <span class="_ _2"></span>12.6).<span class="_ _61"> </span>Everything <span class="_ _2"></span>within <span class="_ _2"></span>a</div><div class="t m0 x32 h2a y30ed ff19 fsf fc0 sc0 ls0 ws0">process <span class="_ _2"></span>is <span class="_ _9"></span>sharable <span class="_ _3"></span>among <span class="_ _3"></span>the <span class="_ _3"></span>threads <span class="_ _3"></span>in <span class="_ _9"></span>a <span class="_ _3"></span>process, <span class="_ _2"></span>including <span class="_ _9"></span>the <span class="_ _3"></span>text <span class="_ _3"></span>of <span class="_ _9"></span>the <span class="_ _3"></span>executable</div><div class="t m0 x32 h2a y1803 ff19 fsf fc0 sc0 ls0 ws0">program, the pr<span class="_ _0"></span>ogram’s global and heap memory<span class="_ _4"></span><span class="ls44">,t<span class="_ _d"></span><span class="ls0">he stacks, and the ﬁle descriptors.</span></span></div><div class="t m0 x3f h2a y30ee ff19 fsf fc0 sc0 ls0 ws0">The <span class="_"> </span>threads <span class="_ _66"> </span>interfaces <span class="_ _47"> </span>we’r<span class="_ _0"></span><span class="ls2fa">ea<span class="_ _5b"></span><span class="ls0">bout <span class="_ _66"> </span>to <span class="_ _47"> </span>see <span class="_"> </span>ar<span class="ls2fa">ef<span class="_ _5b"></span><span class="ls45">ro<span class="ls2fa">mP<span class="_ _4a"></span><span class="ls0">OSIX.1</span></span></span></span></span></span></div><div class="t m0 xd3 h2a y30ef ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 x1b1 h2a y30ee ff19 fsf fc0 sc0 ls0 ws0">2001. <span class="_ _46"> </span>The<span class="_ _61"> </span>threads</div><div class="t m0 x32 h2a y30f0 ff19 fsf fc0 sc0 ls0 ws0">interfaces, <span class="_ _23"></span>also <span class="_ _9"></span>known <span class="_ _23"> </span>as <span class="_ _23"></span>‘<span class="_ _0"></span>‘pthr<span class="_ _0"></span>eads’<span class="_ _0"></span><span class="lsd81">’f<span class="_ _43"></span><span class="ls0">or <span class="_ _23"> </span>‘‘POSIX <span class="_ _9"></span>threads,’<span class="_ _1"></span><span class="lsd81">’o<span class="_ _b"></span><span class="ls0">riginally <span class="_ _9"></span>wer<span class="lsd81">eo<span class="_ _b"></span><span class="ls0">ptional <span class="_ _9"></span>in</span></span></span></span></span></span></div><div class="t m0 x32 h2a y30f1 ff19 fsf fc0 sc0 ls0 ws0">POSIX.1</div><div class="t m0 x135 h2a y30f2 ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 x2d h2a y30f1 ff19 fsf fc0 sc0 ls0 ws0">2001, <span class="_ _23"> </span>but <span class="_ _42"> </span>SUSv4 <span class="_ _23"> </span>moved <span class="_ _42"> </span>them <span class="_ _23"> </span>to <span class="_ _42"> </span>the <span class="_ _23"> </span>base.<span class="_ _54"> </span>The <span class="_ _23"> </span>featur<span class="lsd82">et<span class="_ _43"></span><span class="ls0">est <span class="_ _23"> </span>macr<span class="lsd82">of<span class="_ _43"></span><span class="ls0">or <span class="_ _23"> </span>POSIX</span></span></span></span></div><div class="t m0 x32 h26 y30f3 ff19 fsf fc0 sc0 ls0 ws0">threads <span class="_ _42"> </span>is<span class="_ _4b"> </span><span class="ff1a">_POSIX_THREADS</span><span class="lsd83">.A<span class="_ _52"></span><span class="ls0">pplications <span class="_ _42"> </span>can <span class="_ _53"> </span>either <span class="_ _e"> </span>use <span class="_ _53"> </span>this <span class="_ _53"> </span>in <span class="_ _53"> </span>an<span class="_ _4b"> </span><span class="ff1a">#ifdef<span class="_ _44"> </span></span>test <span class="_ _e"> </span>to</span></span></div><div class="t m0 x32 h26 y30f4 ff19 fsf fc0 sc0 ls0 ws0">determine <span class="_ _42"> </span>at <span class="_ _53"> </span>compile <span class="_ _53"> </span>time <span class="_ _53"> </span>whether <span class="_ _53"> </span>threads <span class="_ _42"> </span>ar<span class="ls86e">es<span class="_ _c"></span><span class="ls0">upported <span class="_ _53"> </span>or <span class="_ _53"> </span>call<span class="_ _44"> </span><span class="ff1a">sysconf<span class="_ _44"> </span></span>with <span class="_ _53"> </span>the</span></span></div><div class="t m0 x32 h26 y30f5 ff1a fsf fc0 sc0 ls0 ws0">_SC_THREADS<span class="_ _44"> </span><span class="ff19">constant <span class="_ _53"> </span>to <span class="_ _42"> </span>determine <span class="_ _53"> </span>this <span class="_ _53"> </span>at <span class="_ _42"> </span>runtime. <span class="_ _44"> </span>Systems<span class="_ _4b"> </span>conforming <span class="_ _42"> </span>to <span class="_ _53"> </span>SUSv4</span></div><div class="t m0 x32 h26 yead ff19 fsf fc0 sc0 ls0 ws0">deﬁne the symbol<span class="_"> </span><span class="ff1a">_POSIX_THREADS<span class="_ _80"> </span></span>to have the value 200809L.</div><div class="t m0 x35 h53 y30f6 ff16 fs2b fc0 sc0 ls0 ws0">11.3 <span class="_ _93"> </span>Thread<span class="_ _54"> </span>Identiﬁcation</div><div class="t m0 x32 h2a y30f7 ff19 fsf fc0 sc0 ls0 ws0">Just <span class="_ _2"></span>as <span class="_ _2"></span>every <span class="_ _2"></span>process has <span class="_ _2"></span>a <span class="_ _2"></span>process <span class="_ _2"></span>ID, <span class="_ _2"></span>every <span class="_ _2"></span>thread has <span class="_ _3"></span>a <span class="_ _2"></span>thread ID.<span class="_ _61"> </span>Unlike <span class="_ _2"></span>the <span class="_ _2"></span>process</div><div class="t m0 x32 h2a y30f8 ff19 fsf fc0 sc0 ls0 ws0">ID, which is <span class="_ _2"></span>unique in the <span class="_ _2"></span>system, the <span class="_ _2"></span>thread ID has signiﬁcance <span class="_ _2"></span>only within the <span class="_ _2"></span>context</div><div class="t m0 x32 h2a y30f9 ff19 fsf fc0 sc0 ls0 ws0">of the process to which it belongs.</div><div class="t m0 x3f h26 y30fa ff19 fsf fc0 sc0 ls0 ws0">Recall <span class="_ _53"> </span>that <span class="_ _53"> </span>a <span class="_ _e"> </span>process <span class="_ _53"> </span>ID, <span class="_ _53"> </span>represented <span class="_ _42"> </span>by <span class="_ _e"> </span>the<span class="_ _4b"> </span><span class="ff1a">pid_t<span class="_ _44"> </span></span>data <span class="_ _e"> </span>type, <span class="_ _53"> </span>is <span class="_ _e"> </span>a <span class="_ _53"> </span>non-negative</div><div class="t m0 x32 h26 y30fb ff19 fsf fc0 sc0 ls0 ws0">integer<span class="_ _6"></span><span class="ls915">.A<span class="_ _5"></span><span class="ls0">thread <span class="_ _2"></span>ID <span class="_ _2"></span>is <span class="_ _3"></span>represented <span class="_ _2"></span>by <span class="_ _3"></span>the<span class="_ _47"> </span><span class="ff1a">pthread_t<span class="_ _47"> </span></span>data <span class="_ _3"></span>type.<span class="_ _61"> </span>Implementations <span class="_ _3"></span>are</span></span></div><div class="t m0 x32 h26 y30fc ff19 fsf fc0 sc0 ls0 ws0">allowed <span class="_ _44"> </span>to <span class="_ _44"> </span>use <span class="_ _44"> </span>a <span class="_ _44"> </span>structure<span class="_ _51"> </span>to<span class="_ _65"> </span>repr<span class="_ _0"></span>esent <span class="_ _44"> </span>the<span class="_ _54"> </span><span class="ff1a">pthread_t<span class="_ _54"> </span></span>data <span class="_ _44"> </span>type, <span class="_ _44"> </span>so <span class="_ _44"> </span>portable</div><div class="t m0 x32 h2a y30fd ff19 fsf fc0 sc0 ls0 ws0">implementations <span class="_ _53"> </span>can’t <span class="_ _53"> </span>treat <span class="_ _42"> </span>them <span class="_ _53"> </span>as <span class="_ _53"> </span>integers.<span class="_ _65"> </span>Therefor<span class="_ _0"></span>e, <span class="_ _53"> </span>a <span class="_ _53"> </span>function <span class="_ _53"> </span>must <span class="_ _53"> </span>be <span class="_ _53"> </span>used <span class="_ _53"> </span>to</div><div class="t m0 x32 h2a y30fe ff19 fsf fc0 sc0 ls0 ws0">compar<span class="ls44">et<span class="_ _4f"></span><span class="ls0">wo thread IDs.</span></span></div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.889061px;bottom:355.128903px;width:157.355393px;height:19.679016px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
