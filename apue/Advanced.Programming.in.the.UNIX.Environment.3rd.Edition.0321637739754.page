<div id="pf2f2" class="pf w4 h1f" data-page-no="2f2"><div class="pc pc2f2 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg2f2.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">720<span class="_ _1b"> </span><span class="ff19">Pseudo <span class="_"> </span>T<span class="_ _6"></span>erminals <span class="_ _23a"> </span>Chapter<span class="_ _4b"> </span>19</span></div><div class="t m0 xb7 h51 y5320 ff19 fs2a fc0 sc0 ls0 ws0">terminal</div><div class="t m0 x39 h51 y5321 ff19 fs2a fc0 sc0 ls0 ws0">device driver</div><div class="t m0 x74 h2d y5322 ff19 fs10 fc0 sc0 ls0 ws0">PTY master</div><div class="t m0 xbb h2e y5323 ff19 fs11 fc0 sc0 ls0 ws0">PTY slave</div><div class="t m0 x63 h2f y5324 ff19 fs12 fc0 sc0 ls0 ws0">terminal</div><div class="t m0 x1d2 h2f y5325 ff19 fs12 fc0 sc0 ls0 ws0">line discipline</div><div class="t m0 x5e h30 y5326 ff19 fs13 fc0 sc0 ls0 ws0">terminal</div><div class="t m0 x158 h30 y5327 ff19 fs13 fc0 sc0 ls0 ws0">line discipline</div><div class="t m0 x69 h31 y5328 ff19 fs14 fc0 sc0 ls0 ws0">kernel</div><div class="t m0 xc1 h66 y5329 ff1a fs15 fc0 sc0 ls0 ws0">script<span class="_ _53"> </span><span class="ff19">process</span></div><div class="t m0 xc5 h33 y532a ff19 fs16 fc0 sc0 ls0 ws0">script</div><div class="t m0 xde h33 y532b ff19 fs16 fc0 sc0 ls0 ws0">ﬁle</div><div class="t m0 x171 h71 y532c ff1a fs36 fc0 sc0 ls0 ws0">fork</div><div class="t m0 x171 h71 y532d ff1a fs36 fc0 sc0 ls0 ws0">exec</div><div class="t m0 x197 h34 y532e ff19 fs17 fc0 sc0 ls0 ws0">login</div><div class="t m0 x198 h34 y532f ff19 fs17 fc0 sc0 ls0 ws0">shell</div><div class="t m0 xc4 h34 y5330 ff19 fs17 fc0 sc0 ls0 ws0">(sleeping)</div><div class="t m0 x68 h35 y5331 ff19 fs18 fc0 sc0 ls0 ws0">shell</div><div class="t m0 x1a3 hd5 y5332 ff1a fs19 fc0 sc0 ls0 ws0">fork</div><div class="t m0 x1a3 hd5 y5333 ff1a fs19 fc0 sc0 ls0 ws0">exec</div><div class="t m0 x21d h15a y5334 ff1b fs1f fc0 sc0 ls0 ws0">stdout</div><div class="t m0 x12d h15a y5335 ff1b fs1f fc0 sc0 ls0 ws0">stderr</div><div class="t m0 x169 h15a y5334 ff1b fs1f fc0 sc0 ls0 ws0">stdin</div><div class="t m0 xee h181 y5336 ff19 fsa6 fc0 sc0 ls0 ws0">user at a</div><div class="t m0 xee h181 y5337 ff19 fsa6 fc0 sc0 ls0 ws0">terminal</div><div class="t m0 x66 h130 y5338 ff18 fsa6 fc0 sc0 ls0 ws0">Figure 19.5<span class="_ _5a"> </span><span class="ff19">The<span class="_"> </span><span class="ff1a">script<span class="_ _e"> </span></span>program</span></div><div class="t m0 x3f h182 y5339 ff19 fsc7 fc0 sc0 ls0 ws0">After <span class="_ _23"> </span>developing <span class="_ _42"> </span>the <span class="_ _23"> </span>general<span class="_ _44"> </span><span class="ff1a">pty<span class="_ _35"> </span></span>program <span class="_ _23"></span>in <span class="_ _23"> </span>Section <span class="_ _42"> </span>19.5, <span class="_ _23"> </span>we’ll <span class="_ _42"> </span>see <span class="_ _23"> </span>that <span class="_ _42"> </span>a <span class="_ _23"> </span>trivial</div><div class="t m0 x32 h182 y533a ff19 fsc7 fc0 sc0 ls0 ws0">shell script turns it into a version of the<span class="_"> </span><span class="ff1a">script<span class="_ _80"> </span></span>program.</div><div class="t m0 x35 h182 y533b ff1f fsc7 fc0 sc0 ls0 ws0">expect<span class="_ _66"> </span><span class="ff16">Program</span></div><div class="t m0 x32 h183 y533c ff19 fsc7 fc0 sc0 ls0 ws0">Pseudo <span class="_ _23"> </span>terminals <span class="_ _42"> </span>can <span class="_ _23"> </span>be <span class="_ _42"> </span>used <span class="_ _23"> </span>to <span class="_ _42"> </span>drive <span class="_ _23"> </span>interactive <span class="_ _42"> </span>programs <span class="_ _23"></span>in <span class="_ _23"> </span>noninteractive <span class="_ _42"> </span>modes.</div><div class="t m0 x32 h183 y533d ff19 fsc7 fc0 sc0 ls0 ws0">Numerous <span class="_ _9"></span>programs <span class="_ _9"></span>ar<span class="ls1578">eh<span class="_ _b"></span><span class="ls0">ar<span class="_ _1"></span>d-wired <span class="_ _23"></span>to <span class="_ _9"></span>requir<span class="ls1579">eat<span class="_ _43"></span><span class="ls0">erminal <span class="_ _23"> </span>to <span class="_ _23"></span>run. <span class="_ _45"> </span>One<span class="_ _35"> </span>example <span class="_ _9"></span>is <span class="_ _23"> </span>the</span></span></span></span></div><div class="t m0 x32 h182 y533e ff1a fsc7 fc0 sc0 ls0 ws0">passwd</div><div class="t m0 xf1 h183 y533f ff19 fsc7 fc0 sc0 ls0 ws0">(</div><div class="t m0 xc2 h183 y533e ff19 fsc7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x1a7 h183 y533f ff19 fsc7 fc0 sc0 ls0 ws0">)</div><div class="t m0 x1aa h183 y533e ff19 fsc7 fc0 sc0 ls0 ws0">command, <span class="_ _23"> </span>which <span class="_ _23"> </span>requires <span class="_ _23"></span>that <span class="_ _23"> </span>the <span class="_ _23"> </span>user <span class="_ _42"> </span>enter <span class="_ _23"> </span>a <span class="_ _23"> </span>password<span class="_ _35"> </span>in<span class="_ _35"> </span>response <span class="_ _23"></span>to <span class="_ _23"></span>a</div><div class="t m0 x32 h183 y5340 ff19 fsc7 fc0 sc0 ls0 ws0">prompt.</div><div class="t m0 x3f h183 y5341 ff19 fsc7 fc0 sc0 ls0 ws0">Rather <span class="_ _45"> </span>than <span class="_ _47"> </span>modify <span class="_ _45"> </span>all <span class="_ _45"> </span>the <span class="_ _47"> </span>interactive <span class="_ _45"> </span>programs <span class="_ _47"> </span>to <span class="_ _45"> </span>support <span class="_ _45"> </span>a <span class="_ _47"> </span>batch <span class="_ _45"> </span>mode <span class="_ _45"> </span>of</div><div class="t m0 x32 h183 y5342 ff19 fsc7 fc0 sc0 ls0 ws0">operation, <span class="_ _2"></span>a <span class="_ _3"></span>better <span class="_ _2"></span>solution <span class="_ _3"></span>is <span class="_ _2"></span>to <span class="_ _3"></span>provide a <span class="_ _3"></span>way <span class="_ _2"></span>to <span class="_ _3"></span>drive <span class="_ _3"></span>any <span class="_ _2"></span>interactive <span class="_ _3"></span>program from <span class="_ _2"></span>a</div><div class="t m0 x32 h182 y5343 ff19 fsc7 fc0 sc0 ls0 ws0">script. <span class="_ _66"> </span>The<span class="_ _47"> </span><span class="ff1a">expect<span class="_ _47"> </span></span>program</div><div class="t m0 x186 h183 y5344 ff19 fsc7 fc0 sc0 ls0 ws0">[</div><div class="t m0 x11b h183 y5343 ff19 fsc7 fc0 sc0 ls0 ws0">Libes <span class="_ _2"></span>1990, <span class="_ _3"></span>1991, <span class="_ _2"></span>1994</div><div class="t m0 x17b h183 y5344 ff19 fsc7 fc0 sc0 ls0 ws0">]</div><div class="t m0 x73 h183 y5343 ff19 fsc7 fc0 sc0 ls0 ws0">provides a <span class="_ _3"></span>way <span class="_ _2"></span>to <span class="_ _3"></span>do <span class="_ _2"></span>this.<span class="_ _16"> </span>It <span class="_ _2"></span>uses</div><div class="t m0 x32 h182 y5345 ff19 fsc7 fc0 sc0 ls0 ws0">pseudo <span class="_ _42"> </span>terminals <span class="_ _42"> </span>to <span class="_ _23"> </span>run <span class="_ _42"> </span>other <span class="_ _42"> </span>programs, <span class="_ _23"> </span>similar <span class="_ _42"> </span>to <span class="_ _42"> </span>the<span class="_ _44"> </span><span class="ff1a">pty<span class="_ _35"> </span></span>program <span class="_ _42"> </span>in <span class="_ _23"> </span>Section <span class="_ _42"> </span>19.5.</div><div class="t m0 x32 h182 y5346 ff19 fsc7 fc0 sc0 ls0 ws0">But<span class="_ _46"> </span><span class="ff1a">expect<span class="_ _46"> </span></span>also <span class="_ _66"> </span>provides <span class="_"> </span>a <span class="_ _66"> </span>programming <span class="_"> </span>language <span class="_ _47"> </span>to <span class="_"> </span>examine <span class="_ _66"> </span>the <span class="_ _66"> </span>output <span class="_ _66"> </span>of <span class="_ _66"> </span>the</div><div class="t m0 x32 h183 y5347 ff19 fsc7 fc0 sc0 ls0 ws0">program <span class="_ _2"></span>being <span class="_ _3"></span>run <span class="_ _3"></span>to <span class="_ _3"></span>make <span class="_ _3"></span>decisions <span class="_ _3"></span>about <span class="_ _3"></span>what <span class="_ _3"></span>to <span class="_ _3"></span>send <span class="_ _3"></span>the <span class="_ _3"></span>program <span class="_ _3"></span>as <span class="_ _3"></span>input.<span class="_ _16"> </span>When</div><div class="t m0 x32 h183 y5348 ff19 fsc7 fc0 sc0 ls0 ws0">an interactive program is being r<span class="_ _0"></span>un from a script, we can’t just copy everything fr<span class="_ _0"></span>om the</div><div class="t m0 x32 h183 y5349 ff19 fsc7 fc0 sc0 ls0 ws0">script <span class="_ _53"> </span>to <span class="_ _e"> </span>the <span class="_ _e"> </span>program, <span class="_ _53"> </span>and <span class="_ _e"> </span>vice <span class="_ _e"> </span>versa.<span class="_ _65"> </span>Instead, <span class="_ _e"> </span>we <span class="_ _e"> </span>have <span class="_ _e"> </span>to <span class="_ _e"> </span>send <span class="_ _e"> </span>the <span class="_ _53"> </span>program <span class="_ _e"> </span>some</div><div class="t m0 x32 h183 y534a ff19 fsc7 fc0 sc0 ls0 ws0">input, look at its output, and decide what to send it next.</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
