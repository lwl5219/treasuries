<div id="pf50" class="pf w4 h1f" data-page-no="50"><div class="pc pc50 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg50.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">46<span class="_ _1b"> </span><span class="ff19">UNIX <span class="_"> </span>Standardization <span class="_"> </span>and <span class="_"> </span>Implementations<span class="_ _99"> </span>Chapter <span class="_"> </span>2</span></div><div class="t m0 x8a h57 y425 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\t\t}\n&quot;)</div><div class="t m0 x8a h57 y426 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\t} else {\n&quot;)</div><div class="t m0 x8a h57 y800 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\t\tprintf(\&quot; %%ld\\n\&quot;, val);\n&quot;)</div><div class="t m0 x8a h57 y801 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\t}\n&quot;)</div><div class="t m0 x8a h57 y802 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;}\n\n&quot;)</div><div class="t m0 x8a h57 y803 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;static void\n&quot;)</div><div class="t m0 x8a h57 y804 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;pr_pathconf(char *mesg, char *path, int name)\n&quot;)</div><div class="t m0 x8a h57 y805 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;{\n&quot;)</div><div class="t m0 x8a h57 y806 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\tlong <span class="_"> </span>val;\n&quot;)</div><div class="t m0 x8a h57 y807 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\n&quot;)</div><div class="t m0 x8a h57 y808 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\tfputs(mesg, stdout);\n&quot;)</div><div class="t m0 x8a h57 y809 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\terrno = 0;\n&quot;)</div><div class="t m0 x8a h57 y80a ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\tif ((val = pathconf(path, name)) &lt; 0) {\n&quot;)</div><div class="t m0 x8a h57 y80b ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\t\tif (errno != 0) {\n&quot;)</div><div class="t m0 x8a h57 y80c ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\t\t\tif (errno == EINVAL)\n&quot;)</div><div class="t m0 x8a h57 y80d ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\t\t\t\tfputs(\&quot; (not supported)\\n\&quot;, stdout);\n&quot;)</div><div class="t m0 x8a h57 y80e ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\t\t\telse\n&quot;)</div><div class="t m0 x8a h57 y80f ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\t\t\t\terr_sys(\&quot;pathconf error, path = %%s\&quot;, path);\n&quot;)</div><div class="t m0 x8a h57 y810 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\t\t} else {\n&quot;)</div><div class="t m0 x8a h57 y811 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\t\t\tfputs(\&quot; (no limit)\\n\&quot;, stdout);\n&quot;)</div><div class="t m0 x8a h57 y812 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\t\t}\n&quot;)</div><div class="t m0 x8a h57 y813 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\t} else {\n&quot;)</div><div class="t m0 x8a h57 y814 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\t\tprintf(\&quot; %%ld\\n\&quot;, val);\n&quot;)</div><div class="t m0 x8a h57 y815 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\t}\n&quot;)</div><div class="t m0 x8a h57 y816 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;}\n&quot;)</div><div class="t m0 x32 h57 y817 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x13a h2d y831 ff18 fs10 fc0 sc0 ls0 ws0">Figure 2.13<span class="_ _5a"> </span><span class="ff19">Build C program to print all supported conﬁguration limits</span></div><div class="t m0 x3f h4d y832 ff19 fs26 fc0 sc0 ls0 ws0">The<span class="_ _47"> </span><span class="ff1a">awk<span class="_ _66"> </span></span>program <span class="_ _2"></span>reads <span class="_ _2"></span>two <span class="_ _3"></span>input <span class="_ _3"></span>ﬁles—<span class="ff1a">pathconf.sym<span class="_ _47"> </span></span>and<span class="_ _66"> </span><span class="ff1a">sysconf.sym</span>—that</div><div class="t m0 x32 h49 y833 ff19 fs26 fc0 sc0 ls0 ws0">contain <span class="_ _e"> </span>lists <span class="_ _e"> </span>of <span class="_ _e"> </span>the <span class="_ _e"> </span>limit <span class="_ _e"> </span>name <span class="_ _e"> </span>and <span class="_ _e"> </span>symbol, <span class="_"> </span>separated <span class="_ _53"> </span>by <span class="_ _e"> </span>tabs.<span class="_ _48"> </span>All <span class="_ _e"> </span>symbols <span class="_ _e"> </span>ar<span class="ls2c5">en<span class="_ _4a"></span><span class="ls0">ot</span></span></div><div class="t m0 x32 h4d y834 ff19 fs26 fc0 sc0 ls0 ws0">deﬁned <span class="_ _9"></span>on <span class="_ _9"></span>every <span class="_ _9"></span>platform, <span class="_ _23"></span>so <span class="_ _9"></span>the<span class="_ _45"> </span><span class="ff1a">awk<span class="_ _45"> </span></span>program <span class="_ _3"></span>surrounds <span class="_ _9"></span>each <span class="_ _9"></span>call <span class="_ _9"></span>to<span class="_ _45"> </span><span class="ff1a">pathconf<span class="_ _35"> </span></span>and</div><div class="t m0 x32 h4d y835 ff1a fs26 fc0 sc0 ls0 ws0">sysconf<span class="_ _80"> </span><span class="ff19">with the necessary<span class="_"> </span></span>#ifdef<span class="_ _66"> </span><span class="ff19">statements.</span></div><div class="t m0 x3f h4d y836 ff19 fs26 fc0 sc0 ls0 ws0">For example, the<span class="_"> </span><span class="ff1a">awk<span class="_ _80"> </span></span>program transforms a line in the input ﬁle that looks like</div><div class="t m0 x3f h4e y837 ff1a fs28 fc0 sc0 ls0 ws0">NAME_MAX <span class="_ _6c"> </span>_PC_NAME_MAX</div><div class="t m0 x32 h49 y838 ff19 fs26 fc0 sc0 ls0 ws0">into the following C code:</div><div class="t m0 x3f h4e y839 ff1a fs28 fc0 sc0 ls0 ws0">#ifdef NAME_MAX</div><div class="t m0 x9d h4e y83a ff1a fs28 fc0 sc0 ls0 ws0">printf(&quot;NAME_MAX is defined to be %d\n&quot;, NAME_MAX+0);</div><div class="t m0 x3f h4e y83b ff1a fs28 fc0 sc0 ls0 ws0">#else</div><div class="t m0 x9d h4e y83c ff1a fs28 fc0 sc0 ls0 ws0">printf(&quot;no symbol for NAME_MAX\n&quot;);</div><div class="t m0 x3f h4e y83d ff1a fs28 fc0 sc0 ls0 ws0">#endif</div><div class="t m0 x3f h4e y83e ff1a fs28 fc0 sc0 ls0 ws0">#ifdef _PC_NAME_MAX</div><div class="t m0 x9d h4e y83f ff1a fs28 fc0 sc0 ls0 ws0">pr_pathconf(&quot;NAME_MAX =&quot;, argv[1], _PC_NAME_MAX);</div><div class="t m0 x3f h4e y840 ff1a fs28 fc0 sc0 ls0 ws0">#else</div><div class="t m0 x9d h4e y841 ff1a fs28 fc0 sc0 ls0 ws0">printf(&quot;no symbol for _PC_NAME_MAX\n&quot;);</div><div class="t m0 x3f h4e y842 ff1a fs28 fc0 sc0 ls0 ws0">#endif</div><div class="t m0 x32 h4d y843 ff19 fs26 fc0 sc0 ls0 ws0">The <span class="_"> </span>pr<span class="_ _1"></span>ogram <span class="_"> </span>in <span class="_ _e"> </span>Figur<span class="ls2c6">e2<span class="_ _4a"></span><span class="ls0">.14, <span class="_"> </span>generated <span class="_ _e"> </span>by <span class="_"> </span>the<span class="_ _4b"> </span><span class="ff1a">awk<span class="_ _59"> </span></span>program, <span class="_ _e"> </span>prints <span class="_"> </span>all <span class="_ _e"> </span>these <span class="_"> </span>limits,</span></span></div><div class="t m0 x32 h49 y844 ff19 fs26 fc0 sc0 ls0 ws0">handling the case in which a limit is not deﬁned.</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
