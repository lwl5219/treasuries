<div id="pfeb" class="pf w4 h1f" data-page-no="eb"><div class="pc pceb w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bgeb.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>7.3<span class="_ _20d"> </span>Process <span class="_"> </span>T<span class="_ _6"></span>ermination<span class="_ _1b"> </span><span class="ff18">201</span></div><div class="t m0 x76 h51 y2a3 ff19 fs2a fc0 sc0 ls0 ws0">These exit <span class="_ _2"></span>handlers ﬁrst <span class="_ _2"></span>appeared in the <span class="_ _2"></span>ANSI C <span class="_ _2"></span>Standard<span class="_"> </span>in<span class="_"> </span>1989. <span class="_ _e"> </span>Systems<span class="_ _80"> </span>that predate ANSI</div><div class="t m0 x76 h51 y2a4 ff19 fs2a fc0 sc0 ls0 ws0">C, such as SVR3 and 4.3BSD, did not provide these exit handlers.</div><div class="t m0 x76 h51 y2a6 ff19 fs2a fc0 sc0 ls0 ws0">ISO <span class="_"> </span>C <span class="_"> </span>requir<span class="_ _0"></span>es <span class="_"> </span>that <span class="_"> </span>systems <span class="_"> </span>support <span class="_"> </span>at <span class="_"> </span>least <span class="_"> </span>32 <span class="_"> </span>exit <span class="_"> </span>handlers, <span class="_"> </span>but <span class="_"> </span>implementations <span class="_"> </span>often</div><div class="t m0 x76 h52 y2a7 ff19 fs2a fc0 sc0 ls0 ws0">support <span class="_ _47"> </span>mor<span class="ls845">e(<span class="_ _5b"></span><span class="ls0">see <span class="_ _47"> </span>Figur<span class="ls845">e2<span class="_ _4a"></span><span class="ls0">.15). <span class="_ _59"> </span>The<span class="_ _46"> </span><span class="ff1a">sysconf<span class="_"> </span></span>function <span class="_ _47"> </span>can <span class="_ _47"> </span>be <span class="_ _47"> </span>used <span class="_ _47"> </span>to <span class="_ _66"> </span>determine <span class="_ _47"> </span>the</span></span></span></span></div><div class="t m0 x76 h51 y2a8 ff19 fs2a fc0 sc0 ls0 ws0">maximum number of exit handlers <span class="_ _2"></span>supported by a given platform, <span class="_ _2"></span>as illustrated in Figur<span class="ls846">e2<span class="_ _84"></span><span class="ls0">.14.</span></span></div><div class="t m0 x3f h26 y1b24 ff19 fsf fc0 sc0 ls65 ws0">Wi<span class="_ _3"></span><span class="ls0">th <span class="_ _53"> </span>ISO <span class="_ _53"> </span>C <span class="_ _e"> </span>and <span class="_ _53"> </span>POSIX.1,<span class="_ _4b"> </span><span class="ff1a">exit<span class="_ _4b"> </span></span>ﬁrst <span class="_ _53"> </span>calls <span class="_ _53"> </span>the <span class="_ _e"> </span>exit <span class="_ _53"> </span>handlers <span class="_ _e"> </span>and <span class="_ _53"> </span>then <span class="_ _53"> </span>closes <span class="_ _e"> </span>(via</span></div><div class="t m0 x32 h26 y1b25 ff1a fsf fc0 sc0 ls0 ws0">fclose<span class="ff19 ls847">)a<span class="_ _8"></span><span class="ls0">ll <span class="_ _3"></span>open <span class="_ _3"></span>streams. <span class="_ _47"> </span>POSIX.1<span class="_ _45"> </span>extends <span class="_ _2"></span>the <span class="_ _9"></span>ISO <span class="_ _3"></span>C <span class="_ _3"></span>standard<span class="_ _47"> </span>by<span class="_ _45"> </span>specifying <span class="_ _3"></span>that <span class="_ _3"></span>any</span></span></div><div class="t m0 x32 h26 y1b26 ff19 fsf fc0 sc0 ls0 ws0">exit <span class="_ _42"> </span>handlers <span class="_ _23"> </span>installed <span class="_ _42"> </span>will <span class="_ _42"> </span>be <span class="_ _42"> </span>cleared <span class="_ _23"> </span>if <span class="_ _42"> </span>the <span class="_ _42"> </span>program <span class="_ _23"></span>calls <span class="_ _42"> </span>any <span class="_ _42"> </span>of <span class="_ _23"> </span>the<span class="_ _44"> </span><span class="ff1a">exec<span class="_ _35"> </span></span>family <span class="_ _42"> </span>of</div><div class="t m0 x32 h2a y1b27 ff19 fsf fc0 sc0 ls0 ws0">functions. <span class="_ _45"> </span>Figur<span class="ls848">e7<span class="_ _b"></span><span class="ls0">.2 <span class="_ _3"></span>summarizes <span class="_ _9"></span>how <span class="_ _23"></span>a <span class="_ _3"></span>C <span class="_ _23"></span>pr<span class="_ _0"></span>ogram <span class="_ _9"></span>is <span class="_ _9"></span>started <span class="_ _9"></span>and <span class="_ _9"></span>the <span class="_ _23"></span>various <span class="_ _3"></span>ways <span class="_ _23"></span>it</span></span></div><div class="t m0 x32 h2a y1b28 ff19 fsf fc0 sc0 ls0 ws0">can terminate.</div><div class="t m0 x1ca h2d y1b29 ff19 fs10 fc0 sc0 ls0 ws0">user</div><div class="t m0 x1e5 h2d y1b2a ff19 fs10 fc0 sc0 ls0 ws0">functions</div><div class="t m0 x1b h4f y1b2b ff1a fs11 fc0 sc0 ls0 ws0">main</div><div class="t m0 x1e4 h2e y1b2c ff19 fs11 fc0 sc0 ls0 ws0">function</div><div class="t m0 x143 h2f y1b2d ff19 fs12 fc0 sc0 ls38a ws0">Cs<span class="_ _84"></span><span class="ls0">tart-up</span></div><div class="t m0 x144 h2f y1b2e ff19 fs12 fc0 sc0 ls222 ws0">ro<span class="ls0">utine</span></div><div class="t m0 x45 h63 y1b2f ff1a fs13 fc0 sc0 ls0 ws0">exit</div><div class="t m0 x154 h30 y1b30 ff19 fs13 fc0 sc0 ls0 ws0">function</div><div class="t m0 x118 h31 y1b31 ff19 fs14 fc0 sc0 ls0 ws0">exit handler</div><div class="t m0 x12d h9b y1b32 ff1a fs49 fc0 sc0 ls849 ws0">...</div><div class="t m0 x118 h32 y1b33 ff19 fs15 fc0 sc0 ls0 ws0">exit handler</div><div class="t m0 x170 h33 y1b34 ff19 fs16 fc0 sc0 ls0 ws0">standar<span class="ls84a">dI<span class="_ _5"></span><span class="ls0">/O</span></span></div><div class="t m0 x98 h33 y1b35 ff19 fs16 fc0 sc0 ls0 ws0">cleanup</div><div class="t m7 xe7 hb1 y1b36 ff19 fs5b fc0 sc0 ls84b ws0">re<span class="ls0">turn</span></div><div class="t m7 xe7 h84 y1b37 ff19 fs41 fc0 sc0 ls84c ws0">re<span class="ls0">turn</span></div><div class="t m7 x36 ha1 y1b38 ff19 fs4d fc0 sc0 ls0 ws0">call</div><div class="t m7 x36 ha2 y1b39 ff19 fs4e fc0 sc0 ls0 ws0">call</div><div class="t m0 x14e h8d y1b3a ff1a fs1a fc0 sc0 ls0 ws0">exec</div><div class="t m0 xca hd6 y1b3b ff1a fs1b fc0 sc0 ls0 ws0">_exit</div><div class="t m0 x74 h38 y1b3c ff19 fs1b fc0 sc0 ls0 ws0">or</div><div class="t m0 xca hd6 y1b3d ff1a fs1b fc0 sc0 ls0 ws0">_Exit</div><div class="t m0 x183 hd7 y1b3e ff1a fs1c fc0 sc0 ls0 ws0">_exit</div><div class="t m0 x138 h39 y1b3f ff19 fs1c fc0 sc0 ls0 ws0">or</div><div class="t m0 x183 hd7 y1b40 ff1a fs1c fc0 sc0 ls0 ws0">_Exit</div><div class="t m0 x183 hd7 y1b41 ff1a fs1c fc0 sc0 ls0 ws0">_exit</div><div class="t m0 x138 h39 y1b42 ff19 fs1c fc0 sc0 ls0 ws0">or</div><div class="t m0 x183 hd7 y1b43 ff1a fs1c fc0 sc0 ls0 ws0">_Exit</div><div class="t ma x17f hdf y1b44 ff1a fs75 fc0 sc0 ls0 ws0">exit</div><div class="t mb x7 he0 y1b45 ff19 fs76 fc0 sc0 ls0 ws0">(does not return)</div><div class="t m0 x5a he1 y1b46 ff1a fs21 fc0 sc0 ls0 ws0">exit</div><div class="t m0 x7 hb9 y1b47 ff19 fs63 fc0 sc0 ls0 ws0">(does not return)</div><div class="t mc x5a he2 y1b48 ff1a fs77 fc0 sc0 ls0 ws0">exit</div><div class="t md x59 he3 y1b49 ff19 fs78 fc0 sc0 ls0 ws0">(does not return)</div><div class="t me x109 he4 y1b4a ff19 fs79 fc0 sc0 ls0 ws0">call</div><div class="t mf x1a8 he5 y1b4b ff19 fs7a fc0 sc0 ls84d ws0">re<span class="ls0">turn</span></div><div class="t m10 x1d9 he6 y1b4c ff19 fs7b fc0 sc0 ls0 ws0">call</div><div class="t m11 x80 he7 y1b4d ff19 fs7c fc0 sc0 ls84e ws0">re<span class="ls0">turn</span></div><div class="t m12 x81 he8 y1b4e ff19 fs7d fc0 sc0 ls0 ws0">call</div><div class="t m13 x187 he9 y1b4f ff19 fs7e fc0 sc0 ls84f ws0">re<span class="ls0">turn</span></div><div class="t m0 x9c hea y1b50 ff19 fs7f fc0 sc0 ls0 ws0">kernel</div><div class="t m0 x1e6 heb y1b51 ff19 fs67 fc0 sc0 ls0 ws0">user process</div><div class="t m0 x1b heb y1b52 ff18 fs67 fc0 sc0 ls0 ws0">Figure 7.2<span class="_ _5a"> </span><span class="ff19">How a C program is started and how it terminates</span></div><div class="t m0 x32 hbf y1b53 ff19 fs68 fc0 sc0 ls0 ws0">The only <span class="_ _2"></span>way <span class="_ _2"></span>a <span class="_ _2"></span>program can <span class="_ _2"></span>be executed <span class="_ _2"></span>by <span class="_ _2"></span>the <span class="_ _2"></span>kernel <span class="_ _2"></span>is if <span class="_ _2"></span>one <span class="_ _2"></span>of <span class="_ _2"></span>the<span class="_"> </span><span class="ff1a">exec<span class="_ _47"> </span></span>functions is</div><div class="t m0 x32 hbf y1b54 ff19 fs68 fc0 sc0 ls0 ws0">called. <span class="_"> </span>The<span class="_ _66"> </span>only <span class="_ _2"></span>way a <span class="_ _2"></span>process can voluntarily terminate <span class="_ _2"></span>is <span class="_ _2"></span>if<span class="_"> </span><span class="ff1a">_exit<span class="_ _66"> </span></span>or<span class="_"> </span><span class="ff1a">_Exit<span class="_ _66"> </span></span>is <span class="_ _2"></span>called,</div><div class="t m0 x32 hbf y1293 ff19 fs68 fc0 sc0 ls0 ws0">either <span class="_ _53"> </span>explicitly <span class="_ _53"> </span>or <span class="_ _e"> </span>implicitly <span class="_ _53"> </span>(by <span class="_ _e"> </span>calling<span class="_ _4b"> </span><span class="ff1a">exit</span>). <span class="_ _4b"> </span>A<span class="_ _4b"> </span>process <span class="_ _42"> </span>can <span class="_ _e"> </span>also <span class="_ _53"> </span>be <span class="_ _e"> </span>involuntarily</div><div class="t m0 x32 hbe y1b55 ff19 fs68 fc0 sc0 ls0 ws0">terminated by a signal (not shown in Figur<span class="ls850">e7<span class="_ _4f"></span><span class="ls0">.2).</span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
