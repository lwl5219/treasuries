<div id="pf2f0" class="pf w4 h1f" data-page-no="2f0"><div class="pc pc2f0 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg2f0.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">718<span class="_ _1b"> </span><span class="ff19">Pseudo <span class="_"> </span>T<span class="_ _6"></span>erminals <span class="_ _23a"> </span>Chapter<span class="_ _4b"> </span>19</span></div><div class="t m0 xa0 h51 y52d5 ff19 fs2a fc0 sc0 ls0 ws0">network</div><div class="t m0 x25 h51 y52d6 ff19 fs2a fc0 sc0 ls0 ws0">device driver</div><div class="t m0 xcc h2d y52d7 ff19 fs10 fc0 sc0 ls0 ws0">PTY master</div><div class="t m0 x75 h2e y52d8 ff19 fs11 fc0 sc0 ls0 ws0">PTY slave</div><div class="t m0 x171 h2f y52d9 ff19 fs12 fc0 sc0 ls0 ws0">TCP/IP</div><div class="t m0 x48 h30 y5290 ff19 fs13 fc0 sc0 ls0 ws0">terminal</div><div class="t m0 x104 h30 y5291 ff19 fs13 fc0 sc0 ls0 ws0">line discipline</div><div class="t m0 x120 h31 y52da ff19 fs14 fc0 sc0 ls0 ws0">kernel</div><div class="t m0 x17f h66 y5294 ff1a fs15 fc0 sc0 ls0 ws0">rlogind</div><div class="t m0 x4b h32 y5295 ff19 fs15 fc0 sc0 ls0 ws0">server</div><div class="t m0 x170 h33 y5296 ff19 fs16 fc0 sc0 ls0 ws0">login</div><div class="t m0 x1a9 h33 y5297 ff19 fs16 fc0 sc0 ls0 ws0">shell</div><div class="t m0 x1ff h71 y52be ff1a fs36 fc0 sc0 ls0 ws0">fork</div><div class="t m0 xaf h71 y52bf ff1a fs36 fc0 sc0 ls0 ws0">exec<span class="ff19">,<span class="_"> </span></span>exec</div><div class="t m0 x1a8 h15b y52db ff1b fs1c fc0 sc0 ls0 ws0">stdout</div><div class="t m0 xa1 h15b y52dc ff1b fs1c fc0 sc0 ls0 ws0">stderr</div><div class="t m0 x6e h15b y52db ff1b fs1c fc0 sc0 ls0 ws0">stdin</div><div class="t m0 x108 hab y52dd ff19 fs57 fc0 sc0 ls0 ws0">network</div><div class="t m0 x38 h12e y52de ff18 fs57 fc0 sc0 ls0 ws0">Figure 19.3<span class="_ _5a"> </span><span class="ff19">Arrangement of processes for<span class="_"> </span><span class="ff1a">rlogind<span class="_ _53"> </span></span>server</span></div><div class="t m0 x3f hac y52df ff19 fs58 fc0 sc0 ls1567 ws0">Ak<span class="_ _43"></span><span class="ls0">ey <span class="_ _23"> </span>point <span class="_ _23"> </span>in <span class="_ _23"> </span>Figur<span class="ls1567">e1<span class="_ _43"></span><span class="ls0">9.3 <span class="_ _23"> </span>is <span class="_ _23"> </span>that <span class="_ _23"> </span>the <span class="_ _23"> </span>process <span class="_ _23"></span>driving <span class="_ _23"></span>the <span class="_ _23"></span>PTY <span class="_ _23"></span>master <span class="_ _23"></span>is <span class="_ _23"></span>normally</span></span></span></div><div class="t m0 x32 hac y52e0 ff19 fs58 fc0 sc0 ls523 ws0">re<span class="ls0">ading <span class="_ _23"> </span>and <span class="_ _42"> </span>writing <span class="_ _23"></span>another <span class="_ _23"> </span>I/O <span class="_ _23"> </span>stream <span class="_ _23"> </span>at <span class="_ _23"> </span>the <span class="_ _23"> </span>same <span class="_ _42"> </span>time.<span class="_ _51"> </span>In <span class="_ _23"></span>this <span class="_ _23"> </span>example, <span class="_ _23"> </span>the <span class="_ _23"> </span>other</span></div><div class="t m0 x32 hac y52e1 ff19 fs58 fc0 sc0 ls0 ws0">I/O <span class="_ _3"></span>stream <span class="_ _3"></span>is <span class="_ _9"></span>the <span class="_ _3"></span>TCP/IP <span class="_ _9"></span>box.<span class="_ _16"> </span>This <span class="_ _9"></span>implies <span class="_ _3"></span>that <span class="_ _9"></span>the <span class="_ _3"></span>process <span class="_ _3"></span>must <span class="_ _9"></span>be <span class="_ _3"></span>using <span class="_ _9"></span>some <span class="_ _9"></span>form</div><div class="t m0 x32 had y52e2 ff19 fs58 fc0 sc0 ls0 ws0">of <span class="_ _23"></span>I/O <span class="_ _23"> </span>multiplexing <span class="_ _23"> </span>(Section <span class="_ _23"> </span>14.4), <span class="_ _23"> </span>such <span class="_ _23"> </span>as<span class="_ _35"> </span><span class="ff1a">select<span class="_ _35"> </span></span>or<span class="_ _35"> </span><span class="ff1a">poll</span>,<span class="_ _35"> </span>or<span class="_ _35"> </span>must <span class="_ _23"></span>be <span class="_ _23"></span>divided <span class="_ _23"> </span>into</div><div class="t m0 x32 hac y52e3 ff19 fs58 fc0 sc0 ls0 ws0">two processes or thr<span class="_ _0"></span>eads.</div><div class="t m0 x35 h17b y52e4 ff16 fs58 fc0 sc0 ls0 ws0">Windowing System T<span class="_ _6"></span>erminal Emulation</div><div class="t m0 x32 hac y52e5 ff19 fs58 fc0 sc0 ls1568 ws0">Wi<span class="_ _3"></span><span class="ls0">ndowing <span class="_ _2"></span>systems <span class="_ _3"></span>typically <span class="_ _3"></span>provide <span class="_ _2"></span>a <span class="_ _3"></span>terminal <span class="_ _3"></span>emulator <span class="_ _2"></span>so <span class="_ _3"></span>that <span class="_ _3"></span>we <span class="_ _3"></span>can <span class="_ _3"></span>use <span class="_ _2"></span>a <span class="_ _3"></span>shell <span class="_ _3"></span>to</span></div><div class="t m0 x32 hac y52e6 ff19 fs58 fc0 sc0 ls1569 ws0">ru<span class="ls156a">no<span class="_ _b"></span><span class="ls0">ur <span class="_ _9"></span>programs <span class="_ _9"></span>from <span class="_ _9"></span>a <span class="_ _9"></span>familiar <span class="_ _9"></span>command</span></span></div><div class="t m0 xeb hac y52e7 ff19 fs58 fc0 sc0 ls0 ws0">-</div><div class="t m0 xec hac y52e6 ff19 fs58 fc0 sc0 ls0 ws0">line <span class="_ _9"></span>environment. <span class="_ _45"> </span>The<span class="_ _45"> </span>terminal <span class="_ _9"></span>emulator</div><div class="t m0 x32 hac y52e8 ff19 fs58 fc0 sc0 ls0 ws0">acts <span class="_ _3"></span>as <span class="_ _9"></span>an <span class="_ _3"></span>intermediary <span class="_ _9"></span>between <span class="_ _3"></span>a <span class="_ _9"></span>shell <span class="_ _9"></span>and <span class="_ _3"></span>the <span class="_ _9"></span>window <span class="_ _3"></span>manager<span class="_ _1"></span><span class="ls156b">.E<span class="_ _62"></span><span class="ls0">ach <span class="_ _9"></span>shell <span class="_ _3"></span>executes</span></span></div><div class="t m0 x32 hac y52e9 ff19 fs58 fc0 sc0 ls0 ws0">in its <span class="_ _2"></span>own window<span class="_ _6"></span><span class="ls156c">.T<span class="_ _4a"></span><span class="ls0">his arrangement <span class="_ _2"></span>(with two <span class="_ _2"></span>shells running <span class="_ _2"></span>in different windows) is</span></span></div><div class="t m0 x32 hac y52ea ff19 fs58 fc0 sc0 ls0 ws0">shown in Figur<span class="ls514">e1<span class="_ _4f"></span><span class="ls0">9.4.</span></span></div><div class="t m0 x3f hac y52eb ff19 fs58 fc0 sc0 ls0 ws0">The shell runs with its standar<span class="ls156d">di<span class="_ _4f"></span><span class="ls0">nput, <span class="_ _2"></span>standar<span class="ls156d">do<span class="_ _4f"></span><span class="ls0">utput, and standar<span class="ls156e">de<span class="_ _d"></span><span class="ls0">rror attached</span></span></span></span></span></span></div><div class="t m0 x32 hac y52ec ff19 fs58 fc0 sc0 ls0 ws0">to <span class="_ _9"></span>the <span class="_ _9"></span>slave <span class="_ _9"></span>side <span class="_ _23"></span>of <span class="_ _9"></span>the <span class="_ _9"></span>PTY<span class="_ _6"></span><span class="ls156f">.T<span class="_ _26"></span><span class="ls0">he <span class="_ _9"></span>terminal <span class="_ _23"></span>emulator <span class="_ _9"></span>program <span class="_ _3"></span>opens <span class="_ _23"></span>the <span class="_ _9"></span>master <span class="_ _9"></span>side <span class="_ _9"></span>of</span></span></div><div class="t m0 x32 hac y52ed ff19 fs58 fc0 sc0 ls0 ws0">the <span class="_"> </span>PTY<span class="_ _4"></span><span class="ls1570">.B<span class="_ _5d"></span><span class="ls0">esides <span class="_"> </span>acting <span class="_"> </span>as <span class="_"> </span>an <span class="_ _66"> </span>interface <span class="_"> </span>to <span class="_"> </span>the <span class="_ _66"> </span>windowing <span class="_"> </span>subsystem, <span class="_"> </span>the <span class="_"> </span>terminal</span></span></div><div class="t m0 x32 hac y52ee ff19 fs58 fc0 sc0 ls0 ws0">emulator <span class="_ _e"> </span>is <span class="_ _e"> </span>responsible <span class="_ _53"> </span>for <span class="_"> </span>emulating <span class="_ _53"> </span>a <span class="_ _e"> </span>particular <span class="_"> </span>type <span class="_ _53"> </span>of <span class="_ _e"> </span>terminal, <span class="_"> </span>which <span class="_ _53"> </span>means <span class="_ _e"> </span>it</div><div class="t m0 x32 hac y52ef ff19 fs58 fc0 sc0 ls0 ws0">needs <span class="_ _2"></span>to <span class="_ _3"></span>respond <span class="_ _2"></span>to <span class="_ _3"></span>the <span class="_ _3"></span>escape <span class="_ _3"></span>codes <span class="_ _3"></span>associated <span class="_ _2"></span>with <span class="_ _3"></span>the <span class="_ _3"></span>type <span class="_ _3"></span>of <span class="_ _3"></span>device <span class="_ _2"></span>it <span class="_ _3"></span>is <span class="_ _3"></span>emulating.</div><div class="t m0 x32 had y52f0 ff19 fs58 fc0 sc0 ls0 ws0">These codes ar<span class="ls514">el<span class="_ _4f"></span><span class="ls0">isted in the<span class="_"> </span><span class="ff1a">termcap<span class="_ _66"> </span></span>and<span class="_"> </span><span class="ff1a">terminfo<span class="_ _80"> </span></span>databases.</span></span></div><div class="t m0 x3f hac y52f1 ff19 fs58 fc0 sc0 ls0 ws0">When a <span class="_ _2"></span>user <span class="_ _2"></span>resizes a <span class="_ _2"></span>terminal emulator <span class="_ _2"></span>window<span class="_ _6"></span><span class="ls1571">,t<span class="_ _d"></span><span class="ls0">he <span class="_ _2"></span>window manager <span class="_ _2"></span>informs <span class="_ _2"></span>the</span></span></div><div class="t m0 x32 had y52f2 ff19 fs58 fc0 sc0 ls0 ws0">terminal <span class="_ _23"></span>emulator<span class="_ _6"></span><span class="ls1572">.T<span class="_ _26"></span><span class="ls0">he <span class="_ _23"></span>terminal <span class="_ _23"></span>emulator <span class="_ _23"></span>issues <span class="_ _9"></span>a<span class="_ _35"> </span><span class="ff1a">TIOCSWINSZ <span class="_ _5"></span>ioctl<span class="_ _45"> </span><span class="ff19">command <span class="_ _23"> </span>on</span></span></span></span></div><div class="t m0 x32 hac y52f3 ff19 fs58 fc0 sc0 ls0 ws0">the <span class="_ _23"> </span>master <span class="_ _42"> </span>side <span class="_ _23"></span>of <span class="_ _23"> </span>the <span class="_ _42"> </span>PTY <span class="_ _23"> </span>to <span class="_ _23"> </span>set <span class="_ _42"> </span>the <span class="_ _23"> </span>window <span class="_ _42"> </span>size <span class="_ _23"> </span>for <span class="_ _23"> </span>the <span class="_ _42"> </span>slave <span class="_ _23"> </span>side.<span class="_ _51"> </span>If <span class="_ _42"> </span>the <span class="_ _23"> </span>new <span class="_ _23"> </span>size</div><div class="t m0 x32 had y52f4 ff19 fs58 fc0 sc0 ls0 ws0">differs <span class="_ _42"> </span>from <span class="_ _42"> </span>the <span class="_ _53"> </span>current <span class="_ _42"> </span>size, <span class="_ _53"> </span>the <span class="_ _53"> </span>kernel <span class="_ _53"> </span>sends <span class="_ _53"> </span>a<span class="_ _44"> </span><span class="ff1a">SIGWINCH<span class="_ _4b"> </span></span>signal <span class="_ _53"> </span>to <span class="_ _53"> </span>the <span class="_ _53"> </span>foregr<span class="_ _1"></span>ound</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
