<div id="pf60" class="pf w4 h1f" data-page-no="60"><div class="pc pc60 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg60.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">62<span class="_ _1b"> </span><span class="ff19">File <span class="_"> </span>I/O<span class="_ _169"> </span>Chapter <span class="_"> </span>3</span></div><div class="t m0 x3f h2a y12f ff19 fsf fc0 sc0 ls0 ws0">By <span class="_ _53"> </span>convention, <span class="_ _e"> </span>UNIX <span class="_ _53"> </span>System <span class="_ _e"> </span>shells <span class="_ _53"> </span>associate <span class="_ _e"> </span>ﬁle <span class="_ _53"> </span>descriptor <span class="_ _e"> </span>0 <span class="_ _53"> </span>with <span class="_ _e"> </span>the <span class="_ _53"> </span>standard</div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">input <span class="_ _3"></span>of <span class="_ _3"></span>a <span class="_ _3"></span>process, <span class="_ _2"></span>ﬁle <span class="_ _3"></span>descriptor <span class="_ _3"></span>1 <span class="_ _3"></span>with <span class="_ _3"></span>the <span class="_ _3"></span>standar<span class="ls33a">do<span class="_ _8"></span><span class="ls0">utput, <span class="_ _3"></span>and <span class="_ _3"></span>ﬁle <span class="_ _3"></span>descriptor <span class="_ _3"></span>2 <span class="_ _3"></span>with</span></span></div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _23"></span>standar<span class="ls33b">de<span class="_ _43"></span><span class="ls0">rror<span class="_ _6"></span><span class="ls33c">.T<span class="_ _7"></span><span class="ls0">his <span class="_ _23"> </span>convention <span class="_ _23"> </span>is <span class="_ _23"> </span>used <span class="_ _23"> </span>by <span class="_ _42"> </span>the <span class="_ _23"></span>shells <span class="_ _23"></span>and <span class="_ _23"></span>many <span class="_ _23"></span>applications; <span class="_ _23"></span>it <span class="_ _23"></span>is</span></span></span></span></div><div class="t m0 x32 h2a y132 ff19 fsf fc0 sc0 ls0 ws0">not <span class="_ _2"></span>a <span class="_ _2"></span>feature<span class="_"> </span>of<span class="_ _66"> </span>the <span class="_ _2"></span>UNIX <span class="_ _2"></span>kernel.<span class="_ _61"> </span>Nevertheless, <span class="_ _2"></span>many <span class="_ _2"></span>applications <span class="_ _2"></span>would <span class="_ _2"></span>break <span class="_ _2"></span>if <span class="_ _2"></span>these</div><div class="t m0 x32 h2a y133 ff19 fsf fc0 sc0 ls0 ws0">associations weren’t followed.</div><div class="t m0 x3f h2a y134 ff19 fsf fc0 sc0 ls0 ws0">Although <span class="_ _3"></span>their <span class="_ _9"></span>values <span class="_ _3"></span>ar<span class="ls33d">es<span class="_ _b"></span><span class="ls0">tandardized <span class="_ _3"></span>by <span class="_ _9"></span>POSIX.1, <span class="_ _3"></span>the <span class="_ _9"></span>magic <span class="_ _3"></span>numbers <span class="_ _9"></span>0, <span class="_ _3"></span>1, <span class="_ _9"></span>and <span class="_ _3"></span>2</span></span></div><div class="t m0 x32 h2a y135 ff19 fsf fc0 sc0 ls0 ws0">should <span class="_ _35"> </span>be <span class="_ _45"> </span>replaced <span class="_ _35"> </span>in <span class="_ _45"> </span>POSIX-compliant <span class="_ _35"> </span>applications <span class="_ _35"> </span>with <span class="_ _35"> </span>the <span class="_ _45"> </span>symbolic <span class="_ _35"> </span>constants</div><div class="t m0 x32 h26 y136 ff1a fsf fc0 sc0 ls0 ws0">STDIN_FILENO<span class="ff19">,<span class="_ _60"> </span></span>STDOUT_FILENO<span class="ff19 ls33e">,a<span class="_ _49"></span><span class="ls0">nd<span class="_ _60"> </span><span class="ff1a">STDERR_FILENO<span class="_ _60"> </span></span>to <span class="_ _46"> </span>improve <span class="_ _59"> </span>readability<span class="_ _4"></span>.</span></span></div><div class="t m0 x32 h26 y137 ff19 fsf fc0 sc0 ls0 ws0">These constants ar<span class="ls44">ed<span class="_ _4f"></span><span class="ls0">eﬁned in the<span class="_"> </span><span class="ff1a">&lt;unistd.h&gt;<span class="_ _66"> </span></span>header<span class="_ _6"></span>.</span></span></div><div class="t m0 x3f h26 y138 ff19 fsf fc0 sc0 ls0 ws0">File <span class="_ _e"> </span>descriptors <span class="_"> </span>range <span class="_ _e"> </span>from <span class="_ _e"> </span>0 <span class="_"> </span>thr<span class="_ _1"></span>ough<span class="_ _59"> </span><span class="ff1a">OPEN_MAX<span class="ff20">−</span>1</span><span class="ls33f">.(<span class="_ _64"></span><span class="ls0">Recall <span class="_"> </span>Figur<span class="_ _1"></span><span class="ls340">e2<span class="_ _55"></span><span class="ls0">.1<span class="_ _1"></span>1.) <span class="_ _59"> </span>Early</span></span></span></span></div><div class="t m0 x32 h2a y139 ff19 fsf fc0 sc0 ls0 ws0">historical <span class="_ _42"> </span>implementations <span class="_ _42"> </span>of <span class="_ _42"> </span>the <span class="_ _42"> </span>UNIX <span class="_ _42"> </span>System <span class="_ _42"> </span>had <span class="_ _42"> </span>an <span class="_ _53"> </span>upper <span class="_ _42"> </span>limit <span class="_ _42"> </span>of <span class="_ _42"> </span>19, <span class="_ _42"> </span>allowing <span class="_ _42"> </span>a</div><div class="t m0 x32 h2a y13a ff19 fsf fc0 sc0 ls0 ws0">maximum <span class="_ _23"></span>of <span class="_ _9"></span>20 <span class="_ _23"> </span>open <span class="_ _23"></span>ﬁles <span class="_ _9"></span>per <span class="_ _23"> </span>process, <span class="_ _9"></span>but <span class="_ _23"> </span>many <span class="_ _23"></span>systems <span class="_ _23"></span>subsequently <span class="_ _9"></span>increased <span class="_ _23"></span>this</div><div class="t m0 x32 h2a y254 ff19 fsf fc0 sc0 ls0 ws0">limit to 63.</div><div class="t m0 x76 h51 ya07 ff19 fs2a fc0 sc0 ls341 ws0">Wi<span class="_ _2"></span><span class="ls0">th <span class="_ _3"></span>FreeBSD <span class="_ _2"></span>8.0, <span class="_ _3"></span>Linux <span class="_ _3"></span>3.2.0, <span class="_ _2"></span>Mac <span class="_ _3"></span>OS <span class="_ _3"></span>X <span class="_ _3"></span>10.6.8, <span class="_ _2"></span>and <span class="_ _3"></span>Solaris <span class="_ _3"></span>10, <span class="_ _3"></span>the <span class="_ _3"></span>limit <span class="_ _2"></span>is <span class="_ _3"></span>essentially <span class="_ _3"></span>inﬁnite,</span></div><div class="t m0 x76 h51 ya08 ff19 fs2a fc0 sc0 ls0 ws0">bounded by the amount of memory on the system, the size <span class="_ _2"></span>of an integer<span class="_ _1"></span><span class="ls342">,a<span class="_ _84"></span><span class="ls0">nd any har<span class="ls342">da<span class="_ _5"></span><span class="ls0">nd soft</span></span></span></span></div><div class="t m0 x76 h51 ya09 ff19 fs2a fc0 sc0 ls0 ws0">limits conﬁgured by the system administrator<span class="_ _6"></span>.</div><div class="t m0 x35 h75 ya0a ff16 fs2b fc0 sc0 ls0 ws0">3.3<span class="_ _72"> </span><span class="ff1f">open<span class="_ _54"> </span></span>and<span class="_ _54"> </span><span class="ff1f">openat<span class="_ _65"> </span></span>Functions</div><div class="t m0 x32 h26 ya0b ff19 fsf fc0 sc0 ls44 ws0">Aﬁ<span class="_ _d"></span><span class="ls0">le is opened or created by calling either the<span class="_"> </span><span class="ff1a">open<span class="_ _80"> </span></span>function or the<span class="_"> </span><span class="ff1a">openat<span class="_ _80"> </span></span>function.</span></div><div class="t m0 x3f h57 ya0c ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;fcntl.h&gt;</div><div class="t m0 x3f h57 ya0d ff1a fs2d fc0 sc0 ls0 ws0">int open(const char *<span class="ff1b">path</span><span class="ls15c">,i<span class="_ _1d"></span><span class="ls0">nt<span class="_"> </span><span class="ff1b">oﬂag</span><span class="ls15c">,.<span class="_ _5b"></span><span class="ls0">.. /* mode_t<span class="_"> </span><span class="ff1b">mode<span class="_ _61"> </span></span>*/ );</span></span></span></span></div><div class="t m0 x3f h57 ya0e ff1a fs2d fc0 sc0 ls0 ws0">int openat(int<span class="_"> </span><span class="ff1b">fd</span><span class="ls15c">,c<span class="_ _1d"></span><span class="ls0">onst char *<span class="ff1b">path</span><span class="ls15c">,i<span class="_ _5b"></span><span class="ls0">nt<span class="_"> </span><span class="ff1b">oﬂag</span><span class="ls15c">,.<span class="_ _1d"></span><span class="ls0">.. /* mode_t<span class="_"> </span><span class="ff1b">mode<span class="_ _16"> </span></span>*/ );</span></span></span></span></span></span></div><div class="t m0 x113 h5f ya0f ff19 fs2d fc0 sc0 ls0 ws0">Both return: ﬁle descriptor if OK,<span class="_"> </span><span class="ff20">−</span>1<span class="_"> </span>on<span class="_"> </span>err<span class="_ _0"></span>or</div><div class="t m0 x32 h4d ya10 ff19 fs26 fc0 sc0 ls164 ws0">We <span class="_ _80"> </span>s<span class="_ _9"></span><span class="ls0">how <span class="_ _9"></span>the <span class="_ _3"></span>last <span class="_ _3"></span>argument <span class="_ _3"></span>as<span class="_ _45"> </span><span class="ff1a">...</span><span class="ls343">,w<span class="_ _b"></span><span class="ls0">hich <span class="_ _3"></span>is <span class="_ _9"></span>the <span class="_ _3"></span>ISO <span class="_ _3"></span>C <span class="_ _9"></span>way <span class="_ _3"></span>to <span class="_ _3"></span>specify <span class="_ _9"></span>that <span class="_ _3"></span>the <span class="_ _3"></span>number</span></span></span></div><div class="t m0 x32 h49 ya11 ff19 fs26 fc0 sc0 ls0 ws0">and <span class="_ _2"></span>types <span class="_ _2"></span>of <span class="_ _2"></span>the <span class="_ _2"></span>remaining <span class="_ _2"></span>arguments may <span class="_ _2"></span>vary<span class="_ _6"></span><span class="ls344">.F<span class="_ _1d"></span><span class="ls0">or <span class="_ _3"></span>these <span class="_ _2"></span>functions, <span class="_ _2"></span>the <span class="_ _2"></span>last <span class="_ _2"></span>argument</span></span></div><div class="t m0 x32 h49 ya12 ff19 fs26 fc0 sc0 ls0 ws0">is <span class="_ _e"> </span>used <span class="_"> </span>only <span class="_ _e"> </span>when <span class="_"> </span>a <span class="_ _e"> </span>new <span class="_"> </span>ﬁle <span class="_ _53"> </span>is <span class="_"> </span>being <span class="_ _e"> </span>created, <span class="_ _e"> </span>as <span class="_"> </span>we <span class="_ _e"> </span>describe <span class="_"> </span>later<span class="_ _6"></span><span class="ls345">.W<span class="_ _56"></span><span class="ls346">es<span class="_ _4a"></span><span class="ls0">how <span class="_"> </span>this</span></span></span></div><div class="t m0 x32 h49 ya13 ff19 fs26 fc0 sc0 ls0 ws0">argument as a comment in the pr<span class="_ _0"></span>ototype.</div><div class="t m0 x3f h4a ya14 ff19 fs26 fc0 sc0 ls0 ws0">The<span class="_ _35"> </span><span class="ff1b">path<span class="_ _35"> </span></span>parameter <span class="_ _42"> </span>is <span class="_ _42"> </span>the <span class="_ _23"> </span>name <span class="_ _42"> </span>of <span class="_ _42"> </span>the <span class="_ _23"> </span>ﬁle <span class="_ _42"> </span>to <span class="_ _23"> </span>open <span class="_ _42"> </span>or <span class="_ _42"> </span>create. <span class="_ _35"> </span>This<span class="_ _35"> </span>function <span class="_ _23"> </span>has <span class="_ _42"> </span>a</div><div class="t m0 x32 h4a ya15 ff19 fs26 fc0 sc0 ls0 ws0">multitude <span class="_"> </span>of <span class="_"> </span>options, <span class="_"> </span>which <span class="_"> </span>ar<span class="_ _0"></span><span class="ls347">es<span class="_ _4a"></span><span class="ls0">peciﬁed <span class="_"> </span>by <span class="_"> </span>the<span class="_ _59"> </span><span class="ff1b">oﬂag<span class="_ _59"> </span></span>argument. <span class="_ _59"> </span>This<span class="_ _46"> </span>argument <span class="_"> </span>is</span></span></div><div class="t m0 x32 h4d ya16 ff19 fs26 fc0 sc0 ls0 ws0">formed <span class="_ _2"></span>by <span class="_ _2"></span>ORing <span class="_ _2"></span>together <span class="_ _2"></span>one <span class="_ _2"></span>or <span class="_ _2"></span>more<span class="_"> </span>of<span class="_ _47"> </span>the <span class="_ _2"></span>following <span class="_ _2"></span>constants <span class="_ _2"></span>from the<span class="_ _47"> </span><span class="ff1a">&lt;fcntl.h&gt;</span></div><div class="t m0 x32 h49 ya17 ff19 fs26 fc0 sc0 ls0 ws0">header:</div><div class="t m0 x32 h4d ya18 ff1a fs26 fc0 sc0 ls0 ws0">O_RDONLY<span class="_ _78"> </span><span class="ff19">Open for reading only<span class="_ _4"></span>.</span></div><div class="t m0 x32 h4d ya19 ff1a fs26 fc0 sc0 ls0 ws0">O_WRONLY<span class="_ _78"> </span><span class="ff19">Open for writing only<span class="_ _4"></span>.</span></div><div class="t m0 x32 h4d ya1a ff1a fs26 fc0 sc0 ls0 ws0">O_RDWR<span class="_ _9f"> </span><span class="ff19">Open for reading and writing.</span></div><div class="t m0 x38 h5e ya1b ff19 fs10 fc0 sc0 ls0 ws0">Most <span class="_ _2"></span>implementations <span class="_ _2"></span>deﬁne<span class="_ _80"> </span><span class="ff1a">O_RDONLY<span class="_ _80"> </span></span>as <span class="_ _3"></span>0,<span class="_ _80"> </span><span class="ff1a">O_WRONLY<span class="_ _80"> </span></span>as <span class="_ _2"></span>1, <span class="_ _2"></span>and<span class="_ _80"> </span><span class="ff1a">O_RDWR<span class="_ _80"> </span></span>as <span class="_ _3"></span>2, <span class="_ _2"></span>for</div><div class="t m0 x38 h2d ya1c ff19 fs10 fc0 sc0 ls0 ws0">compatibility with older programs.</div><div class="t m0 x32 h4d ya1d ff1a fs26 fc0 sc0 ls0 ws0">O_EXEC<span class="_ _9f"> </span><span class="ff19">Open for execute only<span class="_ _4"></span>.</span></div><div class="t m0 x32 h4d ya1e ff1a fs26 fc0 sc0 ls0 ws0">O_SEARCH<span class="_ _78"> </span><span class="ff19">Open for search only (applies to dir<span class="_ _1"></span>ectories).</span></div><a class="l" href="#pfc" data-dest-detail='[12,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.890952px;bottom:778.488916px;width:206.687484px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
