<div id="pf3ae" class="pf w4 h1f" data-page-no="3ae"><div class="pc pc3ae w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg3ae.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">908<span class="_ _1b"> </span><span class="ff19">Solutions <span class="_"> </span>to <span class="_"> </span>Selected <span class="_"> </span>Exercises <span class="_ _2eb"> </span>Appendix<span class="_ _4b"> </span>C</span></div><div class="t m0 x8a h51 y1ed4 ff19 fs2a fc0 sc0 ls0 ws0">process table entry</div><div class="t m0 x139 hee y1ed5 ff19 fs82 fc0 sc0 ls945 ws0">...</div><div class="t m0 x1fa h9f y1ed6 ff19 fs39 fc0 sc0 ls0 ws0">fd1:</div><div class="t m0 x1fa h9f y1ed7 ff19 fs39 fc0 sc0 ls0 ws0">fd2:</div><div class="t m0 x1fa h9f y1ed8 ff19 fs39 fc0 sc0 ls0 ws0">fd3:</div><div class="t m0 x167 h81 y1ed9 ff19 fs3f fc0 sc0 ls0 ws0">fd</div><div class="t m0 x135 h81 y1eda ff19 fs3f fc0 sc0 ls0 ws0">ﬂags</div><div class="t m0 x21c h81 y1ed9 ff19 fs3f fc0 sc0 ls0 ws0">ﬁle</div><div class="t m0 x16e h81 y1eda ff19 fs3f fc0 sc0 ls0 ws0">pointer</div><div class="t m0 x1f5 h2f y600d ff19 fs12 fc0 sc0 ls0 ws0">ﬁle status ﬂags</div><div class="t m0 x10f h30 y600e ff19 fs13 fc0 sc0 ls0 ws0">current ﬁle of<span class="_ _0"></span>fset</div><div class="t m0 x1f5 h31 y600f ff19 fs14 fc0 sc0 ls0 ws0">v-node pointer</div><div class="t m0 x1f5 h32 y6010 ff19 fs15 fc0 sc0 ls0 ws0">ﬁle status ﬂags</div><div class="t m0 x10f h33 y6011 ff19 fs16 fc0 sc0 ls0 ws0">current ﬁle of<span class="_ _0"></span>fset</div><div class="t m0 x1f5 h83 y6012 ff19 fs36 fc0 sc0 ls0 ws0">v-node pointer</div><div class="t m0 x207 h83 y6013 ff19 fs36 fc0 sc0 ls0 ws0">ﬁle table</div><div class="t m0 x168 hb1 y6014 ff19 fs5b fc0 sc0 ls0 ws0">v-node information</div><div class="t m0 x11f h16d y6015 ff1a fs5b fc0 sc0 ls0 ws0">v_data</div><div class="t m0 x13b hb1 y6016 ff19 fs5b fc0 sc0 ls0 ws0">i-node information</div><div class="t m0 xd4 hb1 y6017 ff19 fs5b fc0 sc0 ls0 ws0">current ﬁle size</div><div class="t m0 x169 h16d y6018 ff1a fs5b fc0 sc0 ls0 ws0">i_vnode</div><div class="t m0 x16f h36 y6019 ff19 fs19 fc0 sc0 ls0 ws0">v-node table</div><div class="t m0 x19b h103 y601a ff18 fs1e fc0 sc0 ls0 ws0">Figure C.2<span class="_ _5a"> </span><span class="ff19">Result of<span class="_"> </span><span class="ff1a">dup<span class="_ _e"> </span></span>and<span class="_"> </span><span class="ff1a">open</span></span></div><div class="t m0 x215 h1cc y601b ff19 fs4b fc0 sc0 ls0 ws0">If<span class="_ _45"> </span><span class="ff1a">fd<span class="_ _45"> </span></span>is <span class="_ _9"></span>3, <span class="_ _9"></span>however<span class="_ _6"></span><span class="ls1801">,a<span class="_ _b"></span><span class="ls0">fter <span class="_ _9"></span>the <span class="_ _23"></span>thr<span class="_ _0"></span>ee <span class="_ _9"></span>calls <span class="_ _9"></span>to<span class="_ _45"> </span><span class="ff1a">dup2</span><span class="ls1802">,f<span class="_ _b"></span><span class="ls0">our <span class="_ _9"></span>descriptors <span class="_ _9"></span>ar<span class="ls1802">ep<span class="_ _b"></span><span class="ls0">ointing <span class="_ _9"></span>to</span></span></span></span></span></span></div><div class="t m0 x215 h16b y601c ff19 fs4b fc0 sc0 ls0 ws0">the same ﬁle table entry<span class="_ _4"></span><span class="ls1803">.I<span class="_ _4a"></span><span class="ls510">nt<span class="_ _d"></span><span class="ls0">his case, we need to close descriptor 3.</span></span></span></div><div class="t m0 x32 h16b y601d ff18 fs4b fc0 sc0 ls0 ws0">3.5<span class="_ _9b"> </span><span class="ff19">Since the shells pr<span class="_ _1"></span>ocess their command line from left to right, the command</span></div><div class="t m0 x1a7 hb6 y601e ff1a fs60 fc0 sc0 ls0 ws0">./a.out &gt; outfile 2&gt;&amp;1</div><div class="t m0 x215 h1cc y601f ff19 fs4b fc0 sc0 ls0 ws0">ﬁrst <span class="_ _47"> </span>sets <span class="_ _47"> </span>standar<span class="ls1804">do<span class="_ _1d"></span><span class="ls0">utput <span class="_ _47"> </span>to<span class="_ _16"> </span><span class="ff1a">outfile<span class="_"> </span></span>and <span class="_ _66"> </span>then<span class="_ _5a"> </span><span class="ff1a">dup</span><span class="ls1805">ss<span class="_ _62"></span><span class="ls0">tandar<span class="ls1805">do<span class="_ _62"></span><span class="ls0">utput <span class="_ _45"> </span>onto</span></span></span></span></span></span></div><div class="t m0 x215 h16b y6020 ff19 fs4b fc0 sc0 ls0 ws0">descriptor <span class="_ _53"> </span>2 <span class="_ _e"> </span>(standar<span class="ls1806">de<span class="_ _55"></span><span class="ls0">rror). <span class="_ _44"> </span>The<span class="_ _4b"> </span><span class="ls1807">re<span class="_ _2"></span></span>sult <span class="_ _e"> </span>is <span class="_ _53"> </span>that <span class="_ _e"> </span>standar<span class="ls1808">do<span class="_ _55"></span><span class="ls0">utput <span class="_ _53"> </span>and <span class="_ _e"> </span>standard</span></span></span></span></div><div class="t m0 x215 h16b y6021 ff19 fs4b fc0 sc0 ls0 ws0">error ar<span class="ls1809">es<span class="_ _4f"></span><span class="ls0">et <span class="_ _2"></span>to <span class="_ _3"></span>the <span class="_ _2"></span>same <span class="_ _3"></span>ﬁle.<span class="_ _16"> </span>Descriptors <span class="_ _2"></span>1 <span class="_ _3"></span>and <span class="_ _2"></span>2 <span class="_ _3"></span>both <span class="_ _3"></span>point <span class="_ _2"></span>to <span class="_ _3"></span>the <span class="_ _3"></span>same <span class="_ _2"></span>ﬁle <span class="_ _3"></span>table</span></span></div><div class="t m0 x215 h16b y6022 ff19 fs4b fc0 sc0 ls0 ws0">entry<span class="_ _4"></span><span class="ls1803">.W<span class="_ _1d"></span><span class="ls0">ith</span></span></div><div class="t m0 x1a7 hb6 y6023 ff1a fs60 fc0 sc0 ls0 ws0">./a.out 2&gt;&amp;1 &gt; outfile</div><div class="t m0 x215 h1cc y6024 ff19 fs4b fc0 sc0 ls0 ws0">however<span class="_ _6"></span><span class="ls180a">,t<span class="_ _62"></span><span class="ls0">he<span class="_ _5a"> </span><span class="ff1a">dup<span class="_"> </span></span>is <span class="_ _45"> </span>executed <span class="_ _45"> </span>ﬁrst, <span class="_ _45"> </span>causing <span class="_ _45"> </span>descriptor <span class="_ _45"> </span>2 <span class="_ _45"> </span>to <span class="_ _45"> </span>be <span class="_ _47"> </span>the <span class="_ _45"> </span>terminal</span></span></div><div class="t m0 x215 h16b y6025 ff19 fs4b fc0 sc0 ls0 ws0">(assuming <span class="_ _47"> </span>that <span class="_ _45"> </span>the <span class="_ _47"> </span>command <span class="_ _45"> </span>is <span class="_ _47"> </span>run <span class="_ _47"> </span>interactively).<span class="_ _1a3"> </span>Then <span class="_ _47"> </span>standar<span class="ls180b">do<span class="_ _62"></span><span class="ls0">utput <span class="_ _45"> </span>is</span></span></div><div class="t m0 x215 h1cc y6026 ff19 fs4b fc0 sc0 ls1807 ws0">re<span class="ls0">directed <span class="_ _42"> </span>to <span class="_ _23"> </span>the <span class="_ _42"> </span>ﬁle<span class="_ _44"> </span><span class="ff1a">outfile</span><span class="ls180c">.T<span class="_ _52"></span><span class="ls0">he <span class="_ _42"> </span>result <span class="_ _23"> </span>is <span class="_ _42"> </span>that <span class="_ _42"> </span>descriptor <span class="_ _23"> </span>1 <span class="_ _42"> </span>points <span class="_ _42"> </span>to <span class="_ _42"> </span>the <span class="_ _42"> </span>ﬁle</span></span></span></div><div class="t m0 x215 h1cc y6027 ff19 fs4b fc0 sc0 ls0 ws0">table <span class="_ _42"> </span>entry <span class="_ _53"> </span>for<span class="_ _44"> </span><span class="ff1a">outfile</span><span class="ls180d">,a<span class="_ _43"></span><span class="ls0">nd <span class="_ _42"> </span>descriptor <span class="_ _53"> </span>2 <span class="_ _42"> </span>points <span class="_ _53"> </span>to <span class="_ _53"> </span>the <span class="_ _53"> </span>ﬁle <span class="_ _42"> </span>table <span class="_ _53"> </span>entry <span class="_ _53"> </span>for <span class="_ _53"> </span>the</span></span></div><div class="t m0 x215 h16b y6028 ff19 fs4b fc0 sc0 ls0 ws0">terminal.</div><div class="t m0 x32 h1cc y6029 ff18 fs4b fc0 sc0 ls0 ws0">3.6<span class="_ _9b"> </span><span class="ff19 ls13b2">Yo<span class="_ _3"></span><span class="ls180e">uc<span class="_ _43"></span><span class="ls0">an <span class="_ _42"> </span>still<span class="_ _35"> </span><span class="ff1a">lseek<span class="_ _44"> </span></span>and<span class="_ _35"> </span><span class="ff1a">read<span class="_ _35"> </span></span>anywhere<span class="_ _35"> </span>in<span class="_ _44"> </span>the <span class="_ _23"> </span>ﬁle, <span class="_ _42"> </span>but <span class="_ _42"> </span>a<span class="_ _35"> </span><span class="ff1a">write<span class="_ _35"> </span></span>automatically</span></span></span></div><div class="t m0 x215 h16b y602a ff19 fs4b fc0 sc0 ls1807 ws0">re<span class="ls0">sets <span class="_ _53"> </span>the <span class="_ _42"> </span>ﬁle <span class="_ _42"> </span>offset <span class="_ _42"> </span>to <span class="_ _42"> </span>the <span class="_ _53"> </span>end <span class="_ _42"> </span>of <span class="_ _42"> </span>ﬁle <span class="_ _53"> </span>befor<span class="ls180f">et<span class="_ _c"></span><span class="ls0">he <span class="_ _42"> </span>data <span class="_ _53"> </span>is <span class="_ _42"> </span>written.<span class="_ _54"> </span>This <span class="_ _42"> </span>makes <span class="_ _53"> </span>it</span></span></span></div><div class="t m0 x215 h1cc y602b ff19 fs4b fc0 sc0 ls0 ws0">impossible to<span class="_"> </span><span class="ff1a">write<span class="_ _80"> </span></span>anywher<span class="ls510">eo<span class="_ _d"></span><span class="ls0">ther than at the end of ﬁle.</span></span></div><div class="t m0 x35 h1cd y602c ff16 fs4b fc0 sc0 ls0 ws0">Chapter <span class="_"> </span>4</div><div class="t m0 x32 h1cc y602d ff18 fs4b fc0 sc0 ls0 ws0">4.1<span class="_ _9b"> </span><span class="ff19">If<span class="_ _35"> </span><span class="ff1a">stat<span class="_ _44"> </span></span>is <span class="_ _53"> </span>called, <span class="_ _53"> </span>it <span class="_ _42"> </span>always <span class="_ _53"> </span>tries <span class="_ _42"> </span>to <span class="_ _53"> </span>follow <span class="_ _53"> </span>a <span class="_ _42"> </span>symbolic <span class="_ _53"> </span>link <span class="_ _42"> </span>(Figur<span class="ls1810">e4<span class="_ _c"></span><span class="ls0">.17), <span class="_ _53"> </span>so <span class="_ _53"> </span>the</span></span></span></div><div class="t m0 x215 h16b y602e ff19 fs4b fc0 sc0 ls0 ws0">program will never print <span class="_ _2"></span>a <span class="_ _2"></span>ﬁle type <span class="_ _2"></span>of ‘‘symbolic link.’<span class="_ _1"></span><span class="ls1811">’F<span class="_ _4a"></span><span class="ls0">or the <span class="_ _2"></span>example shown <span class="_ _2"></span>in</span></span></div><div class="t m0 x215 h1cc y602f ff19 fs4b fc0 sc0 ls0 ws0">the <span class="_ _9"></span>text, <span class="_ _23"></span>where<span class="_ _45"> </span><span class="ff1a">/dev/cdrom<span class="_ _45"> </span></span>is <span class="_ _23"></span>a <span class="_ _9"></span>symbolic <span class="_ _23"></span>link <span class="_ _9"></span>to<span class="_ _35"> </span><span class="ff1a">/dev/sr0</span>,<span class="_ _45"> </span><span class="ff1a">stat<span class="_ _45"> </span></span><span class="ls1807">re<span class="_ _2"></span></span>ports <span class="_ _9"></span>that</div><div class="t m0 x215 h1cc y6030 ff1a fs4b fc0 sc0 ls0 ws0">/dev/cdrom<span class="_ _59"> </span><span class="ff19">is <span class="_"> </span>a <span class="_ _53"> </span>block <span class="_"> </span>special <span class="_"> </span>ﬁle, <span class="_ _e"> </span>not <span class="_"> </span>a <span class="_ _e"> </span>symbolic <span class="_"> </span>link.<span class="_ _65"> </span>If <span class="_"> </span>the <span class="_"> </span>symbolic <span class="_ _53"> </span>link</span></div><div class="t m0 x215 h1cc y6031 ff19 fs4b fc0 sc0 ls0 ws0">points to a nonexistent ﬁle,<span class="_"> </span><span class="ff1a">stat<span class="_ _80"> </span></span><span class="ls1807">re<span class="_ _2"></span></span>turns an error<span class="_ _6"></span>.</div><div class="t m0 x32 h16b y6032 ff18 fs4b fc0 sc0 ls0 ws0">4.2<span class="_ _9b"> </span><span class="ff19">All permissions ar<span class="_ _1"></span><span class="ls510">et<span class="_ _5"></span><span class="ls0">urned off:</span></span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
