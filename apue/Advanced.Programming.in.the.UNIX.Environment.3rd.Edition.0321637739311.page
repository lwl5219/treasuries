<div id="pf137" class="pf w4 h1f" data-page-no="137"><div class="pc pc137 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg137.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>8.16<span class="_ _245"> </span>Process <span class="_"> </span>Scheduling<span class="_ _1fb"> </span><span class="ff18">277</span></div><div class="t m0 x32 h2b y12f ff19 fsf fc0 sc0 ls0 ws0">The<span class="_ _47"> </span><span class="ff1b">incr<span class="_ _45"> </span></span>argument <span class="_ _3"></span>is <span class="_ _9"></span>added <span class="_ _3"></span>to <span class="_ _9"></span>the <span class="_ _3"></span>nice <span class="_ _9"></span>value <span class="_ _9"></span>of <span class="_ _3"></span>the <span class="_ _9"></span>calling <span class="_ _3"></span>process. <span class="_ _45"> </span>If<span class="_ _47"> </span><span class="ff1b">incr<span class="_ _45"> </span></span>is <span class="_ _3"></span>too <span class="_ _9"></span>large,</div><div class="t m0 x32 h2b y130 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _2"></span>system <span class="_ _2"></span>silently <span class="_ _2"></span>reduces it <span class="_ _2"></span>to <span class="_ _2"></span>the <span class="_ _3"></span>maximum <span class="_ _2"></span>legal <span class="_ _2"></span>value.<span class="_ _61"> </span>Similarly<span class="_ _4"></span><span class="ls9e9">,i<span class="_ _d"></span><span class="ls0">f<span class="_ _66"> </span><span class="ff1b">incr<span class="_ _47"> </span></span>is <span class="_ _2"></span>too <span class="_ _2"></span>small,</span></span></div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_"> </span>system <span class="_"> </span>silently <span class="_"> </span>increases <span class="_"> </span>it <span class="_"> </span>to <span class="_"> </span>the <span class="_"> </span>minimum <span class="_"> </span>legal <span class="_"> </span>value.<span class="_ _60"> </span>Because<span class="_ _59"> </span><span class="ff20">−</span>1<span class="_ _46"> </span>is<span class="_ _46"> </span>a<span class="_ _46"> </span>legal</div><div class="t m0 x32 h26 y132 ff19 fsf fc0 sc0 ls0 ws0">successful return <span class="_ _2"></span>value, <span class="_ _2"></span>we <span class="_ _2"></span>need to <span class="_ _2"></span>clear<span class="_ _47"> </span><span class="ff1a">errno<span class="_ _66"> </span></span>befor<span class="lsa96">ec<span class="_ _4f"></span><span class="ls0">alling<span class="_"> </span><span class="ff1a">nice<span class="_ _47"> </span></span>and check <span class="_ _2"></span>its <span class="_ _2"></span>value</span></span></div><div class="t m0 x32 h26 y133 ff19 fsf fc0 sc0 ls0 ws0">if<span class="_ _47"> </span><span class="ff1a">nice<span class="_ _47"> </span></span><span class="ls45">re<span class="_ _2"></span></span>turns<span class="_ _47"> </span><span class="ff20">−</span>1. <span class="_ _47"> </span>If<span class="_ _45"> </span>the <span class="_ _2"></span>call <span class="_ _9"></span>to<span class="_ _47"> </span><span class="ff1a">nice<span class="_ _47"> </span></span>succeeds <span class="_ _3"></span>and <span class="_ _3"></span>the <span class="_ _3"></span>return <span class="_ _3"></span>value <span class="_ _3"></span>is<span class="_ _47"> </span><span class="ff20">−</span>1, <span class="_ _3"></span>then<span class="_ _45"> </span><span class="ff1a">errno</span></div><div class="t m0 x32 h26 y134 ff19 fsf fc0 sc0 ls0 ws0">will still be zero. <span class="_"> </span>If<span class="_"> </span><span class="ff1a">errno<span class="_ _80"> </span></span>is nonzero, it means that the call to<span class="_"> </span><span class="ff1a">nice<span class="_ _e"> </span></span>failed.</div><div class="t m0 x3f h26 y135 ff19 fsf fc0 sc0 ls0 ws0">The<span class="_ _66"> </span><span class="ff1a">getpriority<span class="_ _47"> </span></span>function can <span class="_ _2"></span>be <span class="_ _2"></span>used <span class="_ _2"></span>to <span class="_ _3"></span>get <span class="_ _2"></span>the <span class="_ _2"></span>nice <span class="_ _2"></span>value <span class="_ _2"></span>for <span class="_ _2"></span>a <span class="_ _2"></span>process, just <span class="_ _2"></span>like</div><div class="t m0 x32 h26 y136 ff19 fsf fc0 sc0 ls0 ws0">the<span class="_ _47"> </span><span class="ff1a">nice<span class="_ _45"> </span></span>function. <span class="_ _47"> </span>However<span class="_ _1"></span>,<span class="_ _45"> </span><span class="ff1a">getpriority<span class="_ _47"> </span></span>can <span class="_ _9"></span>also <span class="_ _3"></span>get <span class="_ _9"></span>the <span class="_ _9"></span>nice <span class="_ _3"></span>value <span class="_ _9"></span>for <span class="_ _3"></span>a <span class="_ _9"></span>group <span class="_ _3"></span>of</div><div class="t m0 x32 h2a y137 ff19 fsf fc0 sc0 ls45 ws0">re<span class="ls0">lated processes.</span></div><div class="t m0 x3f h57 y146f ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;sys/resource.h&gt;</div><div class="t m0 x3f h57 y2441 ff1a fs2d fc0 sc0 ls0 ws0">int getpriority(int<span class="_"> </span><span class="ff1b">which</span><span class="ls15c">,i<span class="_ _1d"></span><span class="ls0">d_t<span class="_"> </span><span class="ff1b">who</span>);</span></span></div><div class="t m0 x30 h57 y2442 ff19 fs2d fc0 sc0 ls0 ws0">Returns: nice value between<span class="_"> </span><span class="ff20">−<span class="ff1a">NZERO<span class="_ _e"> </span></span></span>and<span class="_"> </span><span class="ff1a">NZERO<span class="ff20">−</span>1<span class="_ _80"> </span></span>if OK,<span class="_"> </span><span class="ff20">−</span>1<span class="_"> </span>on<span class="_"> </span>error</div><div class="t m0 x3f h4d y2443 ff19 fs26 fc0 sc0 ls0 ws0">The<span class="_ _45"> </span><span class="ff1b">which<span class="_ _45"> </span></span>ar<span class="_ _0"></span>gument <span class="_ _9"></span>can <span class="_ _9"></span>take <span class="_ _9"></span>on <span class="_ _9"></span>one <span class="_ _9"></span>of <span class="_ _9"></span>three <span class="_ _3"></span>values:<span class="_ _45"> </span><span class="ff1a">PRIO_PROCESS<span class="_ _45"> </span></span>to <span class="_ _9"></span>indicate <span class="_ _9"></span>a</div><div class="t m0 x32 h4d y2444 ff19 fs26 fc0 sc0 ls0 ws0">process,<span class="_"> </span><span class="ff1a">PRIO_PGRP<span class="_ _47"> </span></span>to <span class="_ _2"></span>indicate <span class="_ _2"></span>a <span class="_ _2"></span>process <span class="_ _2"></span>group, and<span class="_ _47"> </span><span class="ff1a">PRIO_USER<span class="_ _47"> </span></span>to indicate <span class="_ _3"></span>a <span class="_ _2"></span>user <span class="_ _2"></span>ID.</div><div class="t m0 x32 h4a y2445 ff19 fs26 fc0 sc0 ls0 ws0">The<span class="_ _5a"> </span><span class="ff1b">which<span class="_ _51"> </span></span>argument <span class="_ _45"> </span>controls <span class="_ _45"> </span>how <span class="_ _35"> </span>the<span class="_ _51"> </span><span class="ff1b">who<span class="_ _5a"> </span></span>argument <span class="_ _45"> </span>is <span class="_ _35"> </span>interpreted <span class="_ _45"> </span>and <span class="_ _45"> </span>the<span class="_ _51"> </span><span class="ff1b">who</span></div><div class="t m0 x32 h4a y2446 ff19 fs26 fc0 sc0 ls0 ws0">argument <span class="_ _9"></span>selects <span class="_ _9"></span>the <span class="_ _23"></span>process <span class="_ _9"></span>or <span class="_ _9"></span>processes <span class="_ _9"></span>of <span class="_ _23"></span>interest. <span class="_ _45"> </span>If<span class="_ _45"> </span>the<span class="_ _45"> </span><span class="ff1b">who<span class="_ _45"> </span></span>argument <span class="_ _9"></span>is <span class="_ _23"></span>0, <span class="_ _9"></span>then <span class="_ _23"></span>it</div><div class="t m0 x32 h49 y2447 ff19 fs26 fc0 sc0 ls0 ws0">indicates <span class="_ _53"> </span>the <span class="_ _53"> </span>calling <span class="_ _e"> </span>process, <span class="_ _53"> </span>process <span class="_ _42"> </span>group, <span class="_ _53"> </span>or <span class="_ _e"> </span>user <span class="_ _53"> </span>(depending <span class="_ _e"> </span>on <span class="_ _53"> </span>the <span class="_ _e"> </span>value <span class="_ _53"> </span>of <span class="_ _53"> </span>the</div><div class="t m0 x32 h4d y2448 ff1b fs26 fc0 sc0 ls0 ws0">which<span class="_ _47"> </span><span class="ff19">argument). <span class="_ _66"> </span>When<span class="_ _47"> </span></span>which<span class="_ _47"> </span><span class="ff19">is <span class="_ _3"></span>set <span class="_ _2"></span>to<span class="_ _47"> </span><span class="ff1a">PRIO_USER<span class="_ _47"> </span></span>and<span class="_ _47"> </span></span>who<span class="_ _47"> </span><span class="ff19">is <span class="_ _3"></span>0, <span class="_ _3"></span>the <span class="_ _2"></span>real <span class="_ _3"></span>user <span class="_ _2"></span>ID <span class="_ _3"></span>of <span class="_ _3"></span>the</span></div><div class="t m0 x32 h4a y2449 ff19 fs26 fc0 sc0 ls0 ws0">calling process is <span class="_ _2"></span>used.<span class="_ _61"> </span>When <span class="_ _2"></span>the<span class="_ _66"> </span><span class="ff1b">which<span class="_ _66"> </span></span>argument applies <span class="_ _2"></span>to <span class="_ _2"></span>mor<span class="lsa97">et<span class="_ _4f"></span><span class="ls0">han <span class="_ _2"></span>one <span class="_ _2"></span>process, the</span></span></div><div class="t m0 x32 h49 y244a ff19 fs26 fc0 sc0 ls0 ws0">highest priority (lowest value) of all the applicable processes is r<span class="_ _0"></span>eturned.</div><div class="t m0 x3f h4d y244b ff19 fs26 fc0 sc0 ls0 ws0">The<span class="_ _45"> </span><span class="ff1a">setpriority<span class="_ _35"> </span></span>function <span class="_ _9"></span>can <span class="_ _9"></span>be <span class="_ _23"> </span>used <span class="_ _23"></span>to <span class="_ _9"></span>set <span class="_ _23"></span>the <span class="_ _9"></span>priority <span class="_ _23"></span>of <span class="_ _9"></span>a <span class="_ _23"></span>process, <span class="_ _9"></span>a <span class="_ _9"></span>process</div><div class="t m0 x32 h49 y244c ff19 fs26 fc0 sc0 ls0 ws0">group, or all the pr<span class="_ _0"></span>ocesses belonging to a particular user ID.</div><div class="t m0 x3f h4e y244d ff1a fs28 fc0 sc0 ls0 ws0">#include &lt;sys/resource.h&gt;</div><div class="t m0 x3f h4e y244e ff1a fs28 fc0 sc0 ls0 ws0">int setpriority(int<span class="_"> </span><span class="ff1b">which</span><span class="ls1b6">,i<span class="_ _1d"></span><span class="ls0">d_t<span class="_"> </span><span class="ff1b">who</span><span class="ls1b6">,i<span class="_ _5b"></span><span class="ls0">nt<span class="_"> </span><span class="ff1b">value</span>);</span></span></span></span></div><div class="t m0 x153 h7c y244f ff19 fs28 fc0 sc0 ls0 ws0">Returns: 0 if OK,<span class="_"> </span><span class="ff20">−</span>1<span class="_"> </span>on<span class="_"> </span>error</div><div class="t m0 x32 h54 y2450 ff19 fs2c fc0 sc0 ls0 ws0">The<span class="_ _66"> </span><span class="ff1b">which<span class="_ _47"> </span></span>and<span class="_ _66"> </span><span class="ff1b">who<span class="_ _47"> </span></span>arguments ar<span class="lsa98">et<span class="_ _4f"></span><span class="ls0">he <span class="_ _2"></span>same <span class="_ _2"></span>as <span class="_ _3"></span>in <span class="_ _2"></span>the<span class="_ _47"> </span><span class="ff1a">getpriority<span class="_ _66"> </span></span>function. <span class="_ _47"> </span>The<span class="_ _66"> </span><span class="ff1b">value</span></span></span></div><div class="t m0 x32 h54 y2451 ff19 fs2c fc0 sc0 ls0 ws0">is added to<span class="_"> </span><span class="ff1a">NZERO<span class="_ _80"> </span></span>and this becomes the new nice value.</div><div class="t m0 x76 h4f y2452 ff19 fs11 fc0 sc0 ls0 ws0">The<span class="_ _66"> </span><span class="ff1a">nice<span class="_ _80"> </span></span>system <span class="_ _9"></span>call <span class="_ _3"></span>originated <span class="_ _3"></span>with <span class="_ _9"></span>an <span class="_ _3"></span>early <span class="_ _3"></span>PDP</div><div class="t m0 x172 h2e y2453 ff19 fs11 fc0 sc0 ls0 ws0">-</div><div class="t m0 x1a8 h2e y2452 ff19 fs11 fc0 sc0 ls449 ws0">11 <span class="_"> </span>v<span class="_ _2"></span><span class="ls0">ersion <span class="_ _3"></span>of <span class="_ _9"></span>the <span class="_ _3"></span>Research <span class="_ _3"></span>UNIX <span class="_ _3"></span>System.</span></div><div class="t m0 x76 h4f y2454 ff19 fs11 fc0 sc0 ls0 ws0">The<span class="_"> </span><span class="ff1a">getpriority<span class="_ _53"> </span></span>and<span class="_"> </span><span class="ff1a">setpriority<span class="_ _e"> </span></span>functions originated with 4.2BSD.</div><div class="t m0 x3f h55 y2455 ff19 fs2c fc0 sc0 ls0 ws0">The <span class="_ _3"></span>Single <span class="_ _9"></span>UNIX <span class="_ _3"></span>Speciﬁcation <span class="_ _9"></span>leaves <span class="_ _3"></span>it <span class="_ _9"></span>up <span class="_ _3"></span>to <span class="_ _9"></span>the <span class="_ _3"></span>implementation <span class="_ _9"></span>whether <span class="_ _3"></span>the <span class="_ _9"></span>nice</div><div class="t m0 x32 h54 y2456 ff19 fs2c fc0 sc0 ls0 ws0">value <span class="_ _2"></span>is <span class="_ _3"></span>inherited <span class="_ _2"></span>by <span class="_ _2"></span>a <span class="_ _3"></span>child <span class="_ _2"></span>process <span class="_ _2"></span>after <span class="_ _3"></span>a<span class="_ _66"> </span><span class="ff1a">fork</span><span class="lsa99">.H<span class="_ _5b"></span><span class="ls0">owever<span class="_ _1"></span><span class="lsa9a">,X<span class="_ _4f"></span><span class="ls0">SI-compliant <span class="_ _2"></span>systems <span class="_ _2"></span>are</span></span></span></span></div><div class="t m0 x32 h54 y2457 ff19 fs2c fc0 sc0 ls150 ws0">re<span class="ls0">quired to preserve the nice value acr<span class="_ _0"></span>oss a call to<span class="_"> </span><span class="ff1a">exec</span>.</span></div><div class="t m0 x76 h2e y2458 ff19 fs11 fc0 sc0 lsa9b ws0">Ac<span class="_ _5"></span><span class="ls0">hild <span class="_ _2"></span>process inherits <span class="_ _2"></span>the <span class="_ _2"></span>nice <span class="_ _2"></span>value from <span class="_ _2"></span>its <span class="_ _2"></span>parent process in <span class="_ _2"></span>FreeBSD <span class="_ _2"></span>8.0, Linux <span class="_ _2"></span>3.2.0, <span class="_ _2"></span>Mac</span></div><div class="t m0 x76 h2e y2459 ff19 fs11 fc0 sc0 ls0 ws0">OS X 10.6.8, and Solaris 10.</div><div class="t m0 x35 h61 y245a ff16 fs2c fc0 sc0 ls0 ws0">Example</div><div class="t m0 x32 h55 y245b ff19 fs2c fc0 sc0 ls0 ws0">The <span class="_ _2"></span>program <span class="_ _3"></span>in <span class="_ _3"></span>Figur<span class="lsa9c">e8<span class="_ _b"></span><span class="ls0">.30 <span class="_ _3"></span>measures <span class="_ _2"></span>the <span class="_ _3"></span>effect <span class="_ _3"></span>of <span class="_ _2"></span>adjusting <span class="_ _3"></span>the <span class="_ _3"></span>nice <span class="_ _3"></span>value <span class="_ _3"></span>of <span class="_ _3"></span>a <span class="_ _3"></span>process.</span></span></div><div class="t m0 x32 h55 y245c ff19 fs2c fc0 sc0 lsa9d ws0">Tw<span class="_ _9"></span><span class="lsa9e">op<span class="_ _4f"></span><span class="ls150">ro<span class="_ _2"></span><span class="ls0">cesses <span class="_ _2"></span>run <span class="_ _2"></span>in <span class="_ _2"></span>parallel, <span class="_ _2"></span>each <span class="_ _2"></span>incrementing its <span class="_ _2"></span>own <span class="_ _2"></span>counter<span class="_ _1"></span><span class="lsa9f">.T<span class="_ _5b"></span><span class="ls0">he <span class="_ _2"></span>parent runs <span class="_ _2"></span>with</span></span></span></span></span></div><div class="t m0 x32 h55 y245d ff19 fs2c fc0 sc0 ls0 ws0">the default nice <span class="_ _2"></span>value, and <span class="_ _2"></span>the child <span class="_ _2"></span>runs with an <span class="_ _2"></span>adjusted nice <span class="_ _2"></span>value as <span class="_ _2"></span>speciﬁed by <span class="_ _2"></span>the</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
