<div id="pf19e" class="pf w4 h1f" data-page-no="19e"><div class="pc pc19e w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg19e.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">380<span class="_ _1b"> </span><span class="ff19">Signals <span class="_ _24b"> </span>Chapter<span class="_ _21"> </span>10</span></div><div class="t m0 x32 h26 y12f ff19 fsf fc0 sc0 ls0 ws0">It <span class="_ _23"> </span>operates <span class="_ _23"> </span>in <span class="_ _42"> </span>a <span class="_ _23"> </span>similar <span class="_ _23"> </span>manner <span class="_ _42"> </span>to <span class="_ _23"> </span>the<span class="_ _35"> </span><span class="ff1a">psignal<span class="_ _35"> </span></span>function. <span class="_ _35"> </span>Although<span class="_ _35"> </span>this <span class="_ _23"> </span>function <span class="_ _42"> </span>has</div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">access <span class="_ _3"></span>to <span class="_ _3"></span>mor<span class="lsd59">ei<span class="_ _8"></span><span class="ls0">nformation <span class="_ _3"></span>than <span class="_ _3"></span>just <span class="_ _3"></span>the <span class="_ _9"></span>signal <span class="_ _3"></span>number<span class="_ _6"></span><span class="lsd45">,p<span class="_ _4f"></span><span class="ls0">latforms <span class="_ _3"></span>vary <span class="_ _3"></span>in <span class="_ _3"></span>exactly <span class="_ _9"></span>what</span></span></span></span></div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">additional information is printed.</div><div class="t m0 x3f h2a y132 ff19 fsf fc0 sc0 ls0 ws0">If <span class="_ _9"></span>you <span class="_ _9"></span>only <span class="_ _23"></span>need <span class="_ _9"></span>the <span class="_ _9"></span>string <span class="_ _23"></span>description <span class="_ _9"></span>of <span class="_ _9"></span>the <span class="_ _9"></span>signal <span class="_ _23"></span>and <span class="_ _9"></span>don’t <span class="_ _9"></span>necessarily <span class="_ _23"></span>want <span class="_ _9"></span>to</div><div class="t m0 x32 h2a y133 ff19 fsf fc0 sc0 ls0 ws0">write <span class="_ _2"></span>it <span class="_ _2"></span>to <span class="_ _2"></span>standar<span class="lsd5a">de<span class="_ _4f"></span><span class="ls0">rror (you <span class="_ _3"></span>might <span class="_ _2"></span>want <span class="_ _2"></span>to <span class="_ _3"></span>write <span class="_ _2"></span>it <span class="_ _2"></span>to <span class="_ _2"></span>a <span class="_ _3"></span>log <span class="_ _2"></span>ﬁle, <span class="_ _2"></span>for <span class="_ _3"></span>example), <span class="_ _2"></span>you <span class="_ _2"></span>can</span></span></div><div class="t m0 x32 h26 y134 ff19 fsf fc0 sc0 ls0 ws0">use <span class="_ _9"></span>the<span class="_ _45"> </span><span class="ff1a">strsignal<span class="_ _35"> </span></span>function. <span class="_ _45"> </span>This<span class="_ _45"> </span>function <span class="_ _9"></span>is <span class="_ _23"></span>similar <span class="_ _9"></span>to<span class="_ _45"> </span><span class="ff1a">strerror<span class="_ _45"> </span></span>(also <span class="_ _23"></span>described <span class="_ _9"></span>in</div><div class="t m0 x32 h2a y135 ff19 fsf fc0 sc0 ls0 ws0">Section 1.7).</div><div class="t m0 x3f h57 y3093 ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;string.h&gt;</div><div class="t m0 x3f h57 y3094 ff1a fs2d fc0 sc0 ls0 ws0">char *strsignal(int<span class="_"> </span><span class="ff1b">signo</span>);</div><div class="t m0 x86 h5f y3095 ff19 fs2d fc0 sc0 ls0 ws0">Returns: a pointer to a string describing the signal</div><div class="t m0 x32 h4d y3096 ff19 fs26 fc0 sc0 ls0 ws0">Given <span class="_ _9"></span>a <span class="_ _3"></span>signal <span class="_ _9"></span>number<span class="_ _1"></span>,<span class="_ _45"> </span><span class="ff1a">strsignal<span class="_ _45"> </span></span>will <span class="_ _3"></span>return <span class="_ _3"></span>a <span class="_ _9"></span>string <span class="_ _9"></span>that <span class="_ _9"></span>describes <span class="_ _9"></span>the <span class="_ _9"></span>signal.<span class="_ _5a"> </span>This</div><div class="t m0 x32 h49 y3097 ff19 fs26 fc0 sc0 ls0 ws0">string can be used by applications to print error messages about signals r<span class="_ _0"></span>eceived.</div><div class="t m0 x76 h5e y3098 ff19 fs10 fc0 sc0 ls0 ws0">All <span class="_ _2"></span>the <span class="_ _3"></span>platforms <span class="_ _2"></span>discussed <span class="_ _3"></span>in <span class="_ _3"></span>this <span class="_ _2"></span>book <span class="_ _3"></span>provide <span class="_ _2"></span>the<span class="_ _80"> </span><span class="ff1a">psignal<span class="_ _80"> </span></span>and<span class="_ _66"> </span><span class="ff1a">strsignal<span class="_ _80"> </span></span>functions, <span class="_ _2"></span>but</div><div class="t m0 x76 h5e y3099 ff19 fs10 fc0 sc0 ls0 ws0">differ<span class="_ _0"></span>ences do <span class="_ _2"></span>occur<span class="_ _1"></span><span class="lsd5b">.O<span class="_ _43"></span><span class="lsd5c">nS<span class="_ _5"></span><span class="ls0">olaris 10,<span class="_ _e"> </span><span class="ff1a">strsignal<span class="_ _80"> </span></span>will return <span class="_ _2"></span>a null <span class="_ _2"></span>pointer <span class="_ _2"></span>if the <span class="_ _2"></span>signal <span class="_ _2"></span>number</span></span></span></div><div class="t m0 x76 h2d y309a ff19 fs10 fc0 sc0 ls0 ws0">is <span class="_ _9"> </span>invalid, <span class="_ _23"> </span>whereas <span class="_ _9"></span>FreeBSD <span class="_ _9"></span>8.0, <span class="_ _23"> </span>Linux <span class="_ _9"> </span>3.2.0, <span class="_ _23"> </span>and <span class="_ _23"> </span>Mac <span class="_ _9"></span>OS <span class="_ _23"> </span>X <span class="_ _9"></span>10.6.8 <span class="_ _23"> </span>return <span class="_ _9"></span>a <span class="_ _23"> </span>string <span class="_ _9"></span>indicating</div><div class="t m0 x76 h2d y309b ff19 fs10 fc0 sc0 ls0 ws0">that the signal number is unrecognized.</div><div class="t m0 x76 h5e y309c ff19 fs10 fc0 sc0 ls0 ws0">Only Linux 3.2.0 and Solaris 10 support the<span class="_"> </span><span class="ff1a">psiginfo<span class="_ _53"> </span></span>function.</div><div class="t m0 x3f h49 y309d ff19 fs26 fc0 sc0 ls0 ws0">Solaris provides a couple <span class="_ _2"></span>of <span class="_ _2"></span>functions to <span class="_ _2"></span>map a <span class="_ _2"></span>signal number <span class="_ _2"></span>to a <span class="_ _2"></span>signal name, <span class="_ _2"></span>and</div><div class="t m0 x32 h49 y309e ff19 fs26 fc0 sc0 ls0 ws0">vice versa.</div><div class="t m0 x3f h4e y309f ff1a fs28 fc0 sc0 ls0 ws0">#include &lt;signal.h&gt;</div><div class="t m0 x3f h4e y30a0 ff1a fs28 fc0 sc0 ls0 ws0">int sig2str(int<span class="_"> </span><span class="ff1b">signo</span><span class="ls1b6">,c<span class="_ _1d"></span><span class="ls0">har *<span class="ff1b">str</span>);</span></span></div><div class="t m0 x3f h4e y30a1 ff1a fs28 fc0 sc0 ls0 ws0">int str2sig(const char *<span class="ff1b">str</span><span class="ls1b6">,i<span class="_ _1d"></span><span class="ls0">nt *<span class="ff1b">signop</span>);</span></span></div><div class="t m0 x1af h7c y30a2 ff19 fs28 fc0 sc0 ls0 ws0">Both return: 0 if OK,<span class="_"> </span><span class="ff20">−</span>1<span class="_"> </span>on<span class="_"> </span>err<span class="_ _0"></span>or</div><div class="t m0 x32 h55 y30a3 ff19 fs2c fc0 sc0 ls0 ws0">These <span class="_ _9"></span>functions <span class="_ _23"></span>ar<span class="lsd5d">eu<span class="_ _43"></span><span class="ls0">seful <span class="_ _23"> </span>when <span class="_ _23"></span>writing <span class="_ _9"></span>interactive <span class="_ _23"></span>programs <span class="_ _9"></span>that <span class="_ _9"></span>need <span class="_ _23"></span>to <span class="_ _9"></span>accept <span class="_ _23"> </span>and</span></span></div><div class="t m0 x32 h55 y30a4 ff19 fs2c fc0 sc0 ls0 ws0">print signal names and numbers.</div><div class="t m0 x3f h54 y30a5 ff19 fs2c fc0 sc0 ls0 ws0">The<span class="_ _45"> </span><span class="ff1a">sig2str<span class="_ _35"> </span></span>function <span class="_ _9"></span>translates <span class="_ _23"></span>the <span class="_ _23"></span>given <span class="_ _9"></span>signal <span class="_ _23"></span>number <span class="_ _23"></span>into <span class="_ _9"></span>a <span class="_ _23"></span>string <span class="_ _9"></span>and <span class="_ _23"> </span>stores</div><div class="t m0 x32 h60 y30a6 ff19 fs2c fc0 sc0 ls0 ws0">the <span class="_ _9"></span>result <span class="_ _3"></span>in <span class="_ _9"></span>the <span class="_ _3"></span>memory <span class="_ _9"></span>pointed <span class="_ _9"></span>to <span class="_ _9"></span>by<span class="_ _45"> </span><span class="ff1b">str</span><span class="lsd5e">.T<span class="_ _62"></span><span class="ls0">he <span class="_ _3"></span>caller <span class="_ _9"></span>must <span class="_ _9"></span>ensur<span class="lsd5f">et<span class="_ _b"></span><span class="ls0">hat <span class="_ _9"></span>the <span class="_ _9"></span>memory <span class="_ _3"></span>is</span></span></span></span></div><div class="t m0 x32 h55 y30a7 ff19 fs2c fc0 sc0 ls0 ws0">large <span class="_ _42"> </span>enough <span class="_ _53"> </span>to <span class="_ _42"> </span>hold <span class="_ _53"> </span>the <span class="_ _53"> </span>longest <span class="_ _53"> </span>string, <span class="_ _53"> </span>including <span class="_ _53"> </span>the <span class="_ _53"> </span>terminating <span class="_ _53"> </span>null <span class="_ _42"> </span>byte.<span class="_ _65"> </span>Solaris</div><div class="t m0 x32 h54 y30a8 ff19 fs2c fc0 sc0 ls0 ws0">provides <span class="_ _42"> </span>the <span class="_ _53"> </span>constant<span class="_ _4b"> </span><span class="ff1a">SIG2STR_MAX<span class="_ _4b"> </span></span>in<span class="_ _44"> </span><span class="ff1a">&lt;signal.h&gt;<span class="_ _4b"> </span></span>to <span class="_ _53"> </span>deﬁne <span class="_ _e"> </span>the <span class="_ _53"> </span>maximum <span class="_ _53"> </span>string</div><div class="t m0 x32 h55 y30a9 ff19 fs2c fc0 sc0 ls0 ws0">length. <span class="_ _45"> </span>The<span class="_ _45"> </span>string <span class="_ _9"></span>consists <span class="_ _23"></span>of <span class="_ _9"></span>the <span class="_ _9"></span>signal <span class="_ _23"></span>name <span class="_ _9"></span>without <span class="_ _9"></span>the <span class="_ _23"></span>‘<span class="_ _1"></span>‘SIG’<span class="lsd60">’p<span class="_ _b"></span><span class="ls150">re<span class="ls0">ﬁx. <span class="_ _45"> </span>For<span class="_ _45"> </span>example,</span></span></span></div><div class="t m0 x32 h54 y30aa ff19 fs2c fc0 sc0 ls0 ws0">translating<span class="_ _45"> </span><span class="ff1a">SIGKILL<span class="_ _47"> </span></span>would <span class="_ _9"></span>result <span class="_ _3"></span>in <span class="_ _9"></span>the <span class="_ _3"></span>string <span class="_ _9"></span>‘<span class="_ _0"></span>‘KILL<span class="_ _6"></span><span class="lsd61">’’ <span class="_ _42"> </span>b<span class="_ _3"></span><span class="ls0">eing <span class="_ _3"></span>stored <span class="_ _9"></span>in <span class="_ _3"></span>the<span class="_ _45"> </span><span class="ff1b">str<span class="_ _45"> </span></span>memory</span></span></div><div class="t m0 x32 h55 y30ab ff19 fs2c fc0 sc0 ls0 ws0">buffer<span class="_ _6"></span>.</div><div class="t m0 x3f h54 y30ac ff19 fs2c fc0 sc0 ls0 ws0">The<span class="_ _45"> </span><span class="ff1a">str2sig<span class="_ _47"> </span></span>function <span class="_ _9"></span>translates <span class="_ _9"></span>the <span class="_ _9"></span>given <span class="_ _9"></span>name <span class="_ _3"></span>into <span class="_ _9"></span>a <span class="_ _9"></span>signal <span class="_ _9"></span>number<span class="_ _6"></span><span class="lsd62">.T<span class="_ _1d"></span><span class="ls0">he <span class="_ _3"></span>signal</span></span></div><div class="t m0 x32 h60 y30ad ff19 fs2c fc0 sc0 ls0 ws0">number <span class="_ _2"></span>is <span class="_ _3"></span>stored <span class="_ _3"></span>in <span class="_ _3"></span>the <span class="_ _3"></span>integer <span class="_ _2"></span>pointed <span class="_ _3"></span>to <span class="_ _3"></span>by<span class="_ _47"> </span><span class="ff1b">signop</span><span class="lsd63">.T<span class="_ _5b"></span><span class="ls0">he <span class="_ _3"></span>name <span class="_ _2"></span>can <span class="_ _3"></span>be <span class="_ _3"></span>either <span class="_ _3"></span>the <span class="_ _3"></span>signal</span></span></div><div class="t m0 x32 h55 y30ae ff19 fs2c fc0 sc0 ls0 ws0">name <span class="_ _3"></span>without <span class="_ _9"></span>the <span class="_ _3"></span>‘‘SIG’<span class="_ _1"></span><span class="lsd64">’p<span class="_ _b"></span><span class="ls150">re<span class="_ _2"></span><span class="ls0">ﬁx <span class="_ _9"></span>or <span class="_ _3"></span>a <span class="_ _9"></span>string <span class="_ _3"></span>representation <span class="_ _2"></span>of <span class="_ _9"></span>the <span class="_ _3"></span>decimal <span class="_ _9"></span>signal <span class="_ _3"></span>number</span></span></span></div><div class="t m0 x32 h55 y30af ff19 fs2c fc0 sc0 ls0 ws0">(i.e., ‘<span class="_ _0"></span>‘9’<span class="_ _1"></span>’).</div><div class="t m0 x3f h54 y30b0 ff19 fs2c fc0 sc0 ls0 ws0">Note <span class="_"> </span>that<span class="_ _59"> </span><span class="ff1a">sig2str<span class="_ _46"> </span></span>and<span class="_ _46"> </span><span class="ff1a">str2sig<span class="_ _46"> </span></span>depart <span class="_"> </span>from <span class="_"> </span>common <span class="_"> </span>practice <span class="_"> </span>and <span class="_"> </span>don’t <span class="_"> </span>set</div><div class="t m0 x32 h54 y30b1 ff1a fs2c fc0 sc0 ls0 ws0">errno<span class="_ _80"> </span><span class="ff19">when they fail.</span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
