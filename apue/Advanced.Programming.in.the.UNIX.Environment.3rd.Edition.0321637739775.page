<div id="pf307" class="pf w4 h1f" data-page-no="307"><div class="pc pc307 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg307.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>19.8<span class="_ _221"> </span>Summary<span class="_ _1b"> </span><span class="ff18">741</span></div><div class="t m0 x3f h2a y12f ff19 fsf fc0 sc0 ls0 ws0">Regardless <span class="_ _3"></span>of <span class="_ _9"></span>the <span class="_ _9"></span>implementation <span class="_ _3"></span>details, <span class="_ _9"></span>the <span class="_ _9"></span>purpose <span class="_ _9"></span>of <span class="_ _9"></span>packet <span class="_ _3"></span>mode <span class="_ _9"></span>is <span class="_ _9"></span>to <span class="_ _9"></span>inform</div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _47"> </span>process <span class="_ _47"> </span>reading <span class="_ _47"> </span>the <span class="_ _45"> </span>PTY <span class="_ _47"> </span>master <span class="_ _45"> </span>when <span class="_ _47"> </span>the <span class="_ _45"> </span>following <span class="_ _47"> </span>events <span class="_ _47"> </span>occur <span class="_ _45"> </span>at <span class="_ _47"> </span>the <span class="_ _45"> </span>line</div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">discipline module <span class="_ _2"></span>above <span class="_ _2"></span>the <span class="_ _2"></span>PTY <span class="_ _2"></span>slave: <span class="_ _2"></span>when <span class="_ _2"></span>the <span class="_ _2"></span>read queue <span class="_ _2"></span>is <span class="_ _2"></span>ﬂushed, <span class="_ _2"></span>when <span class="_ _2"></span>the <span class="_ _2"></span>write</div><div class="t m0 x32 h2a y132 ff19 fsf fc0 sc0 ls0 ws0">queue <span class="_ _42"> </span>is <span class="_ _42"> </span>ﬂushed, <span class="_ _42"> </span>when <span class="_ _42"> </span>output <span class="_ _53"> </span>is <span class="_ _42"> </span>stopped <span class="_ _42"> </span>(e.g., <span class="_ _42"> </span>Control</div><div class="t m0 xa3 h2a y1dc2 ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 x48 h2a y132 ff19 fsf fc0 sc0 ls0 ws0">S), <span class="_ _42"> </span>when <span class="_ _42"> </span>output <span class="_ _42"> </span>is <span class="_ _42"> </span>restarted,</div><div class="t m0 x32 h2a y133 ff19 fsf fc0 sc0 ls0 ws0">when <span class="_ _9"></span>XON/XOFF <span class="_ _3"></span>ﬂow <span class="_ _9"></span>control <span class="_ _9"></span>is <span class="_ _9"></span>enabled <span class="_ _3"></span>after <span class="_ _9"></span>being <span class="_ _9"></span>disabled, <span class="_ _9"></span>and <span class="_ _9"></span>when <span class="_ _9"></span>XON/XOFF</div><div class="t m0 x32 h2a y134 ff19 fsf fc0 sc0 ls0 ws0">ﬂow <span class="_ _2"></span>control <span class="_ _2"></span>is <span class="_ _2"></span>disabled <span class="_ _2"></span>after <span class="_ _3"></span>being <span class="_ _2"></span>enabled.<span class="_ _61"> </span>These <span class="_ _3"></span>events <span class="_ _2"></span>ar<span class="ls146">eu<span class="_ _8"></span><span class="ls0">sed, <span class="_ _3"></span>for <span class="_ _2"></span>example, <span class="_ _3"></span>by <span class="_ _2"></span>the</span></span></div><div class="t m0 x32 h26 y135 ff1a fsf fc0 sc0 ls0 ws0">rlogin<span class="_ _80"> </span><span class="ff19">client and the<span class="_"> </span></span>rlogind<span class="_ _66"> </span><span class="ff19">server<span class="_ _6"></span>.</span></div><div class="t m0 x35 h27 y321 ff16 fsf fc0 sc0 ls0 ws0">Remote Mode</div><div class="t m0 x32 h26 y4890 ff19 fsf fc0 sc0 lsf5 ws0">AP<span class="_ _d"></span><span class="ls0">TY master can <span class="_ _2"></span>set the PTY <span class="_ _2"></span>slave to <span class="_ _2"></span>remote mode by issuing the<span class="_ _66"> </span><span class="ff1a">TIOCREMOTE <span class="_ _b"></span>ioctl</span></span></div><div class="t m0 x32 h2a y17f8 ff19 fsf fc0 sc0 ls0 ws0">command. <span class="_ _47"> </span>Although<span class="_ _45"> </span>Mac <span class="_ _2"></span>OS <span class="_ _9"></span>X <span class="_ _3"></span>10.6.8 <span class="_ _3"></span>and <span class="_ _9"></span>Solaris <span class="_ _3"></span>10 <span class="_ _3"></span>use <span class="_ _3"></span>the <span class="_ _9"></span>same <span class="_ _3"></span>command <span class="_ _3"></span>to <span class="_ _9"></span>enable</div><div class="t m0 x32 h26 y17f9 ff19 fsf fc0 sc0 ls0 ws0">and <span class="_"> </span>disable <span class="_ _66"> </span>this <span class="_ _66"> </span>feature, <span class="_"> </span>under <span class="_ _66"> </span>Solaris <span class="_ _66"> </span>the <span class="_ _66"> </span>thir<span class="lsa93">da<span class="_ _5b"></span><span class="ls45">rg<span class="_ _2"></span><span class="ls0">ument <span class="_"> </span>to<span class="_ _61"> </span><span class="ff1a">ioctl<span class="_ _46"> </span></span>is <span class="_ _66"> </span>an <span class="_ _66"> </span>integer<span class="_ _1"></span>,</span></span></span></div><div class="t m0 x32 h2a y17fa ff19 fsf fc0 sc0 ls0 ws0">whereas with Mac <span class="_ _2"></span>OS <span class="_ _2"></span>X, <span class="_ _2"></span>it <span class="_ _2"></span>is a <span class="_ _2"></span>pointer <span class="_ _2"></span>to <span class="_ _2"></span>an <span class="_ _2"></span>integer<span class="_ _6"></span><span class="ls15e5">.(<span class="_ _4a"></span><span class="ls0">FreeBSD 8.0 and <span class="_ _2"></span>Linux <span class="_ _2"></span>3.2.0 <span class="_ _2"></span>don’t</span></span></div><div class="t m0 x32 h2a y17fb ff19 fsf fc0 sc0 ls0 ws0">support this command.)</div><div class="t m0 x3f h2a y17fc ff19 fsf fc0 sc0 ls0 ws0">When <span class="_ _2"></span>it <span class="_ _3"></span>sets <span class="_ _3"></span>this <span class="_ _3"></span>mode, <span class="_ _2"></span>the <span class="_ _3"></span>PTY <span class="_ _3"></span>master <span class="_ _3"></span>is <span class="_ _3"></span>telling <span class="_ _2"></span>the <span class="_ _3"></span>PTY <span class="_ _3"></span>slave’s <span class="_ _3"></span>line <span class="_ _2"></span>discipline <span class="_ _3"></span>not</div><div class="t m0 x32 h2a y17fd ff19 fsf fc0 sc0 ls0 ws0">to perform <span class="_ _2"></span>any <span class="_ _2"></span>processing of <span class="_ _2"></span>the data <span class="_ _2"></span>that <span class="_ _2"></span>it <span class="_ _2"></span>receives from the <span class="_ _2"></span>PTY master<span class="_ _1"></span><span class="ls8c1">,r<span class="_ _4f"></span><span class="ls0">egardless of</span></span></div><div class="t m0 x32 h26 y17fe ff19 fsf fc0 sc0 ls0 ws0">the <span class="_"> </span>canonical/noncanonical <span class="_ _53"> </span>ﬂag <span class="_"> </span>in <span class="_"> </span>the <span class="_ _53"> </span>slave’s<span class="_ _59"> </span><span class="ff1a">termios<span class="_ _59"> </span></span>structure. <span class="_ _59"> </span>Remote<span class="_ _4b"> </span>mode <span class="_"> </span>is</div><div class="t m0 x32 h2a y17ff ff19 fsf fc0 sc0 ls0 ws0">intended for an application, such as a window manager<span class="_ _6"></span><span class="ls44">,t<span class="_ _5"></span><span class="ls0">hat does its own line editing.</span></span></div><div class="t m0 x35 h27 yea3 ff16 fsf fc0 sc0 ls0 ws0">Windo<span class="ls12e">wS<span class="_ _8"></span><span class="ls0">iz <span class="_ _d"></span>e<span class="_"> </span>Chang <span class="_ _d"></span>es</span></span></div><div class="t m0 x32 h26 y5532 ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _9"></span>process <span class="_ _9"></span>above <span class="_ _9"></span>the <span class="_ _9"></span>PTY <span class="_ _9"></span>master <span class="_ _9"></span>can <span class="_ _23"></span>issue <span class="_ _9"></span>the<span class="_ _45"> </span><span class="ff1a">TIOCSWINSZ <span class="_ _d"></span>ioctl<span class="_ _45"> </span><span class="ff19">command <span class="_ _9"></span>to <span class="_ _9"></span>set</span></span></div><div class="t m0 x32 h26 y5533 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _2"></span>window <span class="_ _3"></span>size <span class="_ _3"></span>of <span class="_ _2"></span>the <span class="_ _3"></span>slave.<span class="_ _16"> </span>If <span class="_ _2"></span>the <span class="_ _3"></span>new <span class="_ _3"></span>size <span class="_ _2"></span>differs <span class="_ _2"></span>from <span class="_ _3"></span>the <span class="_ _2"></span>current <span class="_ _2"></span>size, <span class="_ _3"></span>a<span class="_ _47"> </span><span class="ff1a">SIGWINCH</span></div><div class="t m0 x32 h2a y96a ff19 fsf fc0 sc0 ls0 ws0">signal is sent to the foregr<span class="_ _0"></span>ound pr<span class="_ _0"></span>ocess group of the PTY slave.</div><div class="t m0 x35 h27 y5534 ff16 fsf fc0 sc0 ls0 ws0">Signal Generation</div><div class="t m0 x32 h2a y5e5 ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _3"></span>process <span class="_ _3"></span>reading <span class="_ _3"></span>and <span class="_ _9"></span>writing <span class="_ _3"></span>the <span class="_ _9"></span>PTY <span class="_ _3"></span>master <span class="_ _9"></span>can <span class="_ _3"></span>send <span class="_ _9"></span>signals <span class="_ _3"></span>to <span class="_ _9"></span>the <span class="_ _3"></span>process <span class="_ _3"></span>group</div><div class="t m0 x32 h26 y5e6 ff19 fsf fc0 sc0 ls0 ws0">of <span class="_ _45"> </span>the <span class="_ _45"> </span>PTY <span class="_ _45"> </span>slave.<span class="_ _5f"> </span>Under <span class="_ _45"> </span>Solaris <span class="_ _45"> </span>10, <span class="_ _45"> </span>this <span class="_ _45"> </span>is <span class="_ _45"> </span>done <span class="_ _45"> </span>using <span class="_ _45"> </span>the<span class="_ _16"> </span><span class="ff1a">TIOCSIGNAL ioctl</span></div><div class="t m0 x32 h26 y5e7 ff19 fsf fc0 sc0 ls0 ws0">command. <span class="_ _66"> </span>W<span class="_ _1"></span>ith <span class="_ _2"></span>FreeBSD <span class="_ _2"></span>8.0, <span class="_ _2"></span>Linux <span class="_ _2"></span>3.2.0, <span class="_ _2"></span>and <span class="_ _2"></span>Mac <span class="_ _2"></span>OS <span class="_ _2"></span>X <span class="_ _2"></span>10.6.8, <span class="_ _2"></span>the<span class="_ _47"> </span><span class="ff1a">ioctl<span class="_ _66"> </span></span>command <span class="_ _2"></span>is</div><div class="t m0 x32 h26 y5e8 ff1a fsf fc0 sc0 ls0 ws0">TIOCSIG<span class="ff19 ls86">.I<span class="_ _4a"></span><span class="ls44">nb<span class="_ _d"></span><span class="ls0">oth cases, the thir<span class="ls44">da<span class="_ _4f"></span><span class="ls45">rg<span class="_ _2"></span><span class="ls0">ument is set to the signal number<span class="_ _1"></span>.</span></span></span></span></span></span></div><div class="t m0 x35 h53 y5535 ff16 fs2b fc0 sc0 ls0 ws0">19.8 <span class="_ _93"> </span>Summary</div><div class="t m0 x32 h2a y243b ff19 fsf fc0 sc0 ls5f ws0">We <span class="_ _e"> </span>s<span class="_ _23"></span><span class="ls0">tarted <span class="_ _2"></span>this <span class="_ _3"></span>chapter <span class="_ _3"></span>with <span class="_ _2"></span>an <span class="_ _3"></span>overview <span class="_ _3"></span>of <span class="_ _2"></span>how <span class="_ _3"></span>to <span class="_ _3"></span>use <span class="_ _2"></span>pseudo <span class="_ _3"></span>terminals <span class="_ _3"></span>and <span class="_ _3"></span>a <span class="_ _2"></span>look <span class="_ _3"></span>at</span></div><div class="t m0 x32 h2a y243c ff19 fsf fc0 sc0 ls0 ws0">some <span class="_ _e"> </span>use <span class="_ _e"> </span>cases.<span class="_ _48"> </span><span class="ls5f">We <span class="_ _35"> </span>c<span class="_ _23"></span></span>ontinued <span class="_ _53"> </span>by <span class="_"> </span>examining <span class="_ _53"> </span>the <span class="_ _e"> </span>code <span class="_ _e"> </span>required <span class="_ _53"> </span>to <span class="_ _e"> </span>set <span class="_"> </span>up <span class="_ _53"> </span>a <span class="_ _e"> </span>pseudo</div><div class="t m0 x32 h2a y243d ff19 fsf fc0 sc0 ls0 ws0">terminal <span class="_ _53"> </span>under <span class="_ _53"> </span>the <span class="_ _53"> </span>four <span class="_ _42"> </span>platforms <span class="_ _53"> </span>discussed <span class="_ _53"> </span>in <span class="_ _53"> </span>this <span class="_ _53"> </span>text.<span class="_ _65"> </span><span class="ls5f">We <span class="_ _35"> </span>t<span class="_ _9"></span></span>hen <span class="_ _53"> </span>used <span class="_ _53"> </span>this <span class="_ _53"> </span>code <span class="_ _53"> </span>to</div><div class="t m0 x32 h26 y5536 ff19 fsf fc0 sc0 ls0 ws0">provide <span class="_ _46"> </span>the <span class="_ _61"> </span>generic<span class="_ _50"> </span><span class="ff1a">pty_fork<span class="_ _50"> </span></span>function <span class="_ _61"> </span>that <span class="_ _61"> </span>can <span class="_ _61"> </span>be <span class="_ _61"> </span>used <span class="_ _61"> </span>by <span class="_ _61"> </span>many <span class="_ _61"> </span>differ<span class="_ _0"></span>ent</div><div class="t m0 x32 h26 y5537 ff19 fsf fc0 sc0 ls0 ws0">applications. <span class="_ _45"> </span>W<span class="_ _6"></span><span class="ls14cf">eu<span class="_ _b"></span><span class="ls0">sed <span class="_ _9"></span>this <span class="_ _23"> </span>function <span class="_ _23"></span>as <span class="_ _9"></span>the <span class="_ _23"></span>basis <span class="_ _23"></span>for <span class="_ _9"></span>a <span class="_ _23"></span>small <span class="_ _9"></span>program <span class="_ _9"></span>(<span class="ff1a">pty</span>), <span class="_ _23"> </span>which <span class="_ _23"></span>we</span></span></div><div class="t m0 x32 h2a y4fbb ff19 fsf fc0 sc0 ls0 ws0">then used to explor<span class="ls44">em<span class="_ _4f"></span><span class="ls0">any of the properties of pseudo terminals.</span></span></div><div class="t m0 x3f h2a y4fbc ff19 fsf fc0 sc0 ls0 ws0">Pseudo <span class="_ _2"></span>terminals <span class="_ _3"></span>ar<span class="ls989">eu<span class="_ _8"></span><span class="ls0">sed <span class="_ _3"></span>daily <span class="_ _3"></span>on <span class="_ _3"></span>most <span class="_ _3"></span>UNIX <span class="_ _3"></span>systems <span class="_ _3"></span>to <span class="_ _2"></span>provide <span class="_ _3"></span>network <span class="_ _3"></span>logins.</span></span></div><div class="t m0 x32 h26 y4fbd ff19 fsf fc0 sc0 ls5f ws0">We<span class="_ _9"></span><span class="ls0">’ve <span class="_ _53"> </span>examined <span class="_ _e"> </span>other <span class="_ _53"> </span>uses <span class="_ _e"> </span>for <span class="_ _e"> </span>pseudo <span class="_ _53"> </span>terminals <span class="_ _e"> </span>as <span class="_ _53"> </span>well, <span class="_ _e"> </span>ranging <span class="_ _53"> </span>from <span class="_ _53"> </span>the<span class="_ _4b"> </span><span class="ff1a">script</span></span></div><div class="t m0 x32 h2a y4fbe ff19 fsf fc0 sc0 ls0 ws0">program to driving interactive pr<span class="_ _0"></span>ograms fr<span class="_ _0"></span>om a batch script.</div><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.892842px;bottom:356.808909px;width:90.804596px;height:19.679001px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
