<div id="pf33b" class="pf w4 h1f" data-page-no="33b"><div class="pc pc33b w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg33b.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>21.4<span class="_ _8e"> </span>Printer <span class="_"> </span>Spooling<span class="_ _1fb"> </span><span class="ff18">793</span></div><div class="t m0 x3f h2a y12f ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _47"> </span>following <span class="_ _47"> </span>is <span class="_ _47"> </span>a <span class="_ _47"> </span>sample <span class="_ _47"> </span>HTTP <span class="_ _47"> </span>header <span class="_ _45"> </span>for <span class="_ _66"> </span>a <span class="_ _45"> </span>print <span class="_ _47"> </span>r<span class="_ _0"></span>equest <span class="_ _47"> </span>submitted <span class="_ _47"> </span>to <span class="_ _47"> </span>the</div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">author <span class="_ _a"></span>’s<span class="_"> </span>Xerox Phaser 8560 printer:</div><div class="t m0 x3f h57 y59ad ff1a fs2d fc0 sc0 ls0 ws0">POST /ipp HTTP/1.1ˆM</div><div class="t m0 x3f h57 y59ae ff1a fs2d fc0 sc0 ls0 ws0">Content-Length: 21931ˆM</div><div class="t m0 x3f h57 y59af ff1a fs2d fc0 sc0 ls0 ws0">Content-Type: application/ippˆM</div><div class="t m0 x3f h57 y59b0 ff1a fs2d fc0 sc0 ls0 ws0">Host: phaser8560:631ˆM</div><div class="t m0 x3f h57 y59b1 ff1a fs2d fc0 sc0 ls0 ws0">ˆM</div><div class="t m0 x32 h26 y59b2 ff19 fsf fc0 sc0 ls0 ws0">The<span class="_"> </span><span class="ff1a">Content-Length<span class="_ _80"> </span></span>line speciﬁes <span class="_ _2"></span>the size in bytes of the amount of data <span class="_ _2"></span>in the HTTP</div><div class="t m0 x32 h2a y59b3 ff19 fsf fc0 sc0 ls0 ws0">message. <span class="_ _35"> </span>This<span class="_ _35"> </span>excludes <span class="_ _23"></span>the <span class="_ _23"> </span>size <span class="_ _23"> </span>of <span class="_ _42"> </span>the <span class="_ _23"></span>HTTP <span class="_ _23"> </span>header<span class="_ _1"></span><span class="ls651">,b<span class="_ _43"></span><span class="ls0">ut <span class="_ _23"> </span>includes <span class="_ _42"> </span>the <span class="_ _23"></span>size <span class="_ _23"> </span>of <span class="_ _23"> </span>the <span class="_ _42"> </span>IPP</span></span></div><div class="t m0 x32 h26 y59b4 ff19 fsf fc0 sc0 ls0 ws0">header<span class="_ _6"></span><span class="lsc79">.T<span class="_ _1d"></span><span class="ls0">he<span class="_ _45"> </span><span class="ff1a">Host<span class="_ _47"> </span></span>line <span class="_ _3"></span>speciﬁes <span class="_ _3"></span>the <span class="_ _9"></span>host <span class="_ _3"></span>name <span class="_ _3"></span>and <span class="_ _9"></span>port <span class="_ _3"></span>number <span class="_ _3"></span>of <span class="_ _9"></span>the <span class="_ _3"></span>server <span class="_ _3"></span>to <span class="_ _9"></span>which</span></span></div><div class="t m0 x32 h2a y59b5 ff19 fsf fc0 sc0 ls0 ws0">the message is being sent.</div><div class="t m0 x3f h26 y59b6 ff19 fsf fc0 sc0 ls0 ws0">The<span class="_ _47"> </span><span class="ff1a">ˆM<span class="_ _47"> </span></span>at <span class="_ _9"></span>the <span class="_ _3"></span>end <span class="_ _3"></span>of <span class="_ _9"></span>the <span class="_ _3"></span>each <span class="_ _3"></span>line <span class="_ _3"></span>is <span class="_ _9"></span>the <span class="_ _3"></span>carriage <span class="_ _3"></span>return <span class="_ _3"></span>that <span class="_ _3"></span>precedes <span class="_ _3"></span>the <span class="_ _3"></span>line <span class="_ _3"></span>feed.</div><div class="t m0 x32 h2a y59b7 ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _23"> </span>line <span class="_ _42"> </span>feed <span class="_ _42"> </span>doesn’t <span class="_ _23"> </span>show <span class="_ _42"> </span>up <span class="_ _42"> </span>as <span class="_ _23"> </span>a <span class="_ _42"> </span>printable <span class="_ _23"> </span>character<span class="_ _1"></span><span class="ls172b">.N<span class="_ _7"></span><span class="ls0">ote <span class="_ _42"> </span>that <span class="_ _23"> </span>the <span class="_ _42"> </span>last <span class="_ _42"> </span>line <span class="_ _23"> </span>of <span class="_ _42"> </span>the</span></span></div><div class="t m0 x32 h2a y59b8 ff19 fsf fc0 sc0 ls0 ws0">header is empty<span class="_ _4"></span><span class="ls44">,e<span class="_ _5"></span><span class="ls0">xcept for the carriage return and line feed.</span></span></div><div class="t m0 x3f h2a y59b9 ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _2"></span>start <span class="_ _3"></span>line <span class="_ _2"></span>in <span class="_ _2"></span>an <span class="_ _3"></span>HTTP <span class="_ _2"></span>response <span class="_ _2"></span>message <span class="_ _3"></span>contains <span class="_ _2"></span>a <span class="_ _3"></span>version <span class="_ _2"></span>string <span class="_ _3"></span>followed <span class="_ _2"></span>by <span class="_ _3"></span>a</div><div class="t m0 x32 h2a y59ba ff19 fsf fc0 sc0 ls0 ws0">numeric <span class="_ _23"></span>status <span class="_ _23"></span>code <span class="_ _23"> </span>and <span class="_ _23"> </span>a <span class="_ _23"> </span>status <span class="_ _23"> </span>message, <span class="_ _23"> </span>terminated <span class="_ _23"> </span>by <span class="_ _23"> </span>a <span class="_ _23"> </span>carriage <span class="_ _23"> </span>return <span class="_ _23"> </span>and <span class="_ _23"> </span>a <span class="_ _23"> </span>line</div><div class="t m0 x32 h2a y59bb ff19 fsf fc0 sc0 ls0 ws0">feed. <span class="_ _66"> </span>The<span class="_ _47"> </span><span class="ls45">re<span class="_ _2"></span></span>mainder <span class="_ _2"></span>of <span class="_ _2"></span>the <span class="_ _3"></span>HTTP <span class="_ _2"></span>response <span class="_ _2"></span>message <span class="_ _2"></span>has <span class="_ _3"></span>the <span class="_ _2"></span>same <span class="_ _3"></span>format <span class="_ _2"></span>as <span class="_ _2"></span>the <span class="_ _3"></span>request</div><div class="t m0 x32 h2a y59bc ff19 fsf fc0 sc0 ls0 ws0">message: headers followed by a blank line and an optional entity body<span class="_ _4"></span>.</div><div class="t m0 x3f h2a y59bd ff19 fsf fc0 sc0 ls0 ws0">In response to a print r<span class="_ _0"></span>equest, the printer might send us the following message:</div><div class="t m0 x3f h57 y59be ff1a fs2d fc0 sc0 ls0 ws0">HTTP/1.1 200 OKˆM</div><div class="t m0 x3f h57 y59bf ff1a fs2d fc0 sc0 ls0 ws0">Content-Type: application/ippˆM</div><div class="t m0 x3f h57 y59c0 ff1a fs2d fc0 sc0 ls0 ws0">Cache-Control: no-cache, no-store, must-revalidateˆM</div><div class="t m0 x3f h57 y59c1 ff1a fs2d fc0 sc0 ls0 ws0">Expires: THU, 26 OCT 1995 00:00:00 GMTˆM</div><div class="t m0 x3f h57 y59c2 ff1a fs2d fc0 sc0 ls0 ws0">Content-Length: 215ˆM</div><div class="t m0 x3f h57 y59c3 ff1a fs2d fc0 sc0 ls0 ws0">Server: Allegro-Software-RomPager/4.34ˆM</div><div class="t m0 x3f h57 y59c4 ff1a fs2d fc0 sc0 ls0 ws0">ˆM</div><div class="t m0 x32 h2a y59c5 ff19 fsf fc0 sc0 ls0 ws0">As <span class="_ _23"></span>far <span class="_ _23"></span>as <span class="_ _23"></span>our <span class="_ _23"></span>print <span class="_ _23"></span>spooler <span class="_ _23"></span>is <span class="_ _23"></span>concerned, <span class="_ _23"></span>all <span class="_ _23"></span>we <span class="_ _23"></span>car<span class="ls172c">ea<span class="_ _43"></span><span class="ls0">bout <span class="_ _23"></span>in <span class="_ _23"></span>this <span class="_ _23"></span>message <span class="_ _23"></span>is <span class="_ _23"></span>the <span class="_ _23"></span>ﬁrst</span></span></div><div class="t m0 x32 h2a y59c6 ff19 fsf fc0 sc0 ls0 ws0">line: it <span class="_ _2"></span>tells us <span class="_ _2"></span>whether the <span class="_ _2"></span>request succeeded or <span class="_ _2"></span>failed using <span class="_ _2"></span>a numeric <span class="_ _2"></span>error code and <span class="_ _2"></span>a</div><div class="t m0 x32 h2a y59c7 ff19 fsf fc0 sc0 ls0 ws0">short <span class="_ _9"></span>string.<span class="_ _51"> </span>The <span class="_ _9"></span>remainder <span class="_ _9"></span>of <span class="_ _23"></span>the <span class="_ _9"></span>message <span class="_ _23"></span>contains <span class="_ _9"></span>additional <span class="_ _23"></span>information <span class="_ _9"></span>to <span class="_ _23"></span>contr<span class="_ _0"></span>ol</div><div class="t m0 x32 h2a y59c8 ff19 fsf fc0 sc0 ls0 ws0">caching <span class="_ _2"></span>by <span class="_ _3"></span>nodes <span class="_ _3"></span>that <span class="_ _3"></span>might <span class="_ _2"></span>sit <span class="_ _3"></span>in <span class="_ _3"></span>between <span class="_ _2"></span>the <span class="_ _3"></span>client <span class="_ _3"></span>and <span class="_ _3"></span>the <span class="_ _2"></span>server <span class="_ _3"></span>and <span class="_ _3"></span>to <span class="_ _3"></span>indicate <span class="_ _2"></span>the</div><div class="t m0 x32 h2a y59c9 ff19 fsf fc0 sc0 ls0 ws0">softwar<span class="ls44">ev<span class="_ _4f"></span><span class="ls0">ersion running on the server<span class="_ _1"></span>.</span></span></div><div class="t m0 x35 h53 y59ca ff16 fs2b fc0 sc0 ls0 ws0">21.4 <span class="_ _93"> </span>Printer<span class="_ _54"> </span>Spooling</div><div class="t m0 x32 h2a y59cb ff19 fsf fc0 sc0 ls0 ws0">The programs that <span class="_ _2"></span>we develop <span class="_ _2"></span>in <span class="_ _2"></span>this chapter <span class="_ _2"></span>form the <span class="_ _2"></span>basis <span class="_ _2"></span>of a <span class="_ _2"></span>simple printer <span class="_ _2"></span>spooler<span class="_ _1"></span>.</div><div class="t m0 x32 h2a y59cc ff19 fsf fc0 sc0 lscb9 ws0">As<span class="_ _8"></span><span class="ls0">imple <span class="_ _3"></span>user <span class="_ _3"></span>command <span class="_ _3"></span>sends <span class="_ _9"></span>a <span class="_ _3"></span>ﬁle <span class="_ _3"></span>to <span class="_ _3"></span>the <span class="_ _9"></span>printer <span class="_ _3"></span>spooler; <span class="_ _3"></span>the <span class="_ _3"></span>spooler <span class="_ _9"></span>saves <span class="_ _3"></span>it <span class="_ _3"></span>to <span class="_ _3"></span>disk,</span></div><div class="t m0 x32 h2a y59cd ff19 fsf fc0 sc0 ls0 ws0">queues the request, and ultimately sends the ﬁle to the printer<span class="_ _6"></span>.</div><div class="t m0 x3f h2a y59ce ff19 fsf fc0 sc0 ls0 ws0">All <span class="_ _3"></span>UNIX <span class="_ _3"></span>Systems <span class="_ _3"></span>provide <span class="_ _3"></span>at <span class="_ _3"></span>least <span class="_ _3"></span>one <span class="_ _3"></span>print <span class="_ _3"></span>spooling <span class="_ _9"></span>system.<span class="_ _16"> </span>FreeBSD <span class="_ _2"></span>ships <span class="_ _3"></span>LPD,</div><div class="t m0 x32 h26 y59cf ff19 fsf fc0 sc0 ls0 ws0">the BSD print spooling system (see<span class="_"> </span><span class="ff1a">lpd</span></div><div class="t m0 xcc h2a y59d0 ff19 fsf fc0 sc0 ls0 ws0">(</div><div class="t m0 x9c h2a y59cf ff19 fsf fc0 sc0 ls0 ws0">8</div><div class="t m0 x10a h2a y59d0 ff19 fsf fc0 sc0 ls0 ws0">)</div><div class="t m0 x46 h2a y59cf ff19 fsf fc0 sc0 ls0 ws0">and Chapter 13 of Stevens</div><div class="t m0 xbc h2a y59d0 ff19 fsf fc0 sc0 ls0 ws0">[</div><div class="t m0 xbd h2a y59cf ff19 fsf fc0 sc0 ls0 ws0">1990</div><div class="t m0 x236 h2a y59d0 ff19 fsf fc0 sc0 ls0 ws0">]</div><div class="t m0 x237 h2a y59cf ff19 fsf fc0 sc0 ls0 ws0">). <span class="_"> </span>Linux<span class="_"> </span>and</div><div class="t m0 x32 h26 y59d1 ff19 fsf fc0 sc0 ls0 ws0">Mac <span class="_ _23"></span>OS <span class="_ _9"></span>X <span class="_ _23"></span>include <span class="_ _23"></span>CUPS, <span class="_ _9"></span>the <span class="_ _23"> </span>Common <span class="_ _23"></span>UNIX <span class="_ _9"></span>Printing <span class="_ _23"> </span>System <span class="_ _23"></span>(see<span class="_ _45"> </span><span class="ff1a">cupsd</span></div><div class="t m0 x4c h2a y59d2 ff19 fsf fc0 sc0 ls0 ws0">(</div><div class="t m0 x4d h2a y59d1 ff19 fsf fc0 sc0 ls0 ws0">8</div><div class="t m0 xd5 h2a y59d2 ff19 fsf fc0 sc0 ls0 ws0">)</div><div class="t m0 x69 h2a y59d1 ff19 fsf fc0 sc0 ls0 ws0">). <span class="_ _45"> </span>Solaris</div><div class="t m0 x32 h26 y59d3 ff19 fsf fc0 sc0 ls0 ws0">ships <span class="_ _2"></span>with <span class="_ _2"></span>the <span class="_ _2"></span>standar<span class="lsb8f">dS<span class="_ _8"></span><span class="ls0">ystem <span class="_ _2"></span>V <span class="_ _2"></span>printer <span class="_ _2"></span>spooler <span class="_ _2"></span>(see<span class="_ _47"> </span><span class="ff1a">lp</span></span></span></div><div class="t m0 x1b4 h2a y59d4 ff19 fsf fc0 sc0 ls0 ws0">(</div><div class="t m0 x75 h2a y59d3 ff19 fsf fc0 sc0 ls0 ws0">1</div><div class="t m0 xad h2a y59d4 ff19 fsf fc0 sc0 ls0 ws0">)</div><div class="t m0 x196 h26 y59d3 ff19 fsf fc0 sc0 ls0 ws0">and<span class="_ _66"> </span><span class="ff1a">lpsched</span></div><div class="t m0 x1e6 h2a y59d4 ff19 fsf fc0 sc0 ls0 ws0">(</div><div class="t m0 x56 h2a y59d3 ff19 fsf fc0 sc0 ls0 ws0">1M</div><div class="t m0 xd1 h2a y59d4 ff19 fsf fc0 sc0 ls0 ws0">)</div><div class="t m0 x241 h2a y59d3 ff19 fsf fc0 sc0 ls0 ws0">). <span class="_ _66"> </span>In<span class="_ _66"> </span>this</div><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.891993px;bottom:335.974799px;width:132.683999px;height:19.680008px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
