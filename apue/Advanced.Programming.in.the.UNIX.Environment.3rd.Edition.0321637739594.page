<div id="pf252" class="pf w4 h1f" data-page-no="252"><div class="pc pc252 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg252.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">560<span class="_ _1b"> </span><span class="ff19">Interprocess <span class="_"> </span>Communication<span class="_ _2c"> </span>Chapter <span class="_"> </span>15</span></div><div class="t m0 x3f h2a y12f ff19 fsf fc0 sc0 ls0 ws0">Since these forms <span class="_ _2"></span>of IPC don’t <span class="_ _2"></span>use ﬁle descriptors, <span class="_ _2"></span>we can’t use <span class="_ _2"></span>the multiplexed I/O</div><div class="t m0 x32 h26 y130 ff19 fsf fc0 sc0 ls0 ws0">functions <span class="_ _2"></span>(<span class="ff1a">select<span class="_ _47"> </span></span>and<span class="_ _66"> </span><span class="ff1a">poll</span><span class="ls265">)w<span class="_ _4f"></span><span class="ls0">ith <span class="_ _2"></span>them.<span class="_ _61"> </span>This <span class="_ _3"></span>makes <span class="_ _2"></span>it <span class="_ _2"></span>harder <span class="_ _2"></span>to <span class="_ _2"></span>use <span class="_ _2"></span>mor<span class="ls1203">et<span class="_ _4f"></span><span class="ls0">han <span class="_ _2"></span>one <span class="_ _2"></span>of</span></span></span></span></div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">these <span class="_ _9"></span>IPC <span class="_ _23"></span>structur<span class="_ _0"></span>es <span class="_ _9"></span>at <span class="_ _23"></span>a <span class="_ _9"></span>time <span class="_ _23"></span>or <span class="_ _9"></span>to <span class="_ _23"></span>use <span class="_ _9"></span>any <span class="_ _23"></span>of <span class="_ _9"></span>these <span class="_ _23"></span>IPC <span class="_ _9"></span>structures <span class="_ _9"></span>with <span class="_ _23"></span>ﬁle <span class="_ _9"></span>or <span class="_ _9"></span>device</div><div class="t m0 x32 h2a y132 ff19 fsf fc0 sc0 ls0 ws0">I/O. <span class="_"> </span>For<span class="_ _66"> </span>example, <span class="_ _2"></span>we <span class="_ _2"></span>can’t <span class="_ _2"></span>have a <span class="_ _2"></span>server <span class="_ _2"></span>wait for <span class="_ _2"></span>a <span class="_ _2"></span>message <span class="_ _2"></span>to be <span class="_ _2"></span>placed <span class="_ _2"></span>on <span class="_ _2"></span>one of <span class="_ _2"></span>two</div><div class="t m0 x32 h2a y133 ff19 fsf fc0 sc0 ls0 ws0">message queues without some form of busy–wait loop.</div><div class="t m0 x3f h2a y134 ff19 fsf fc0 sc0 ls0 ws0">An <span class="_ _9"></span>overview <span class="_ _9"></span>of <span class="_ _3"></span>a <span class="_ _9"></span>transaction <span class="_ _9"></span>processing <span class="_ _9"></span>system <span class="_ _9"></span>built <span class="_ _3"></span>using <span class="_ _9"></span>System <span class="_ _9"></span>V <span class="_ _9"></span>IPC <span class="_ _9"></span>is <span class="_ _9"></span>given</div><div class="t m0 x32 h2a y135 ff19 fsf fc0 sc0 ls0 ws0">in <span class="_ _47"> </span>Andrade, <span class="_ _66"> </span>Carges, <span class="_ _47"> </span>and <span class="_ _47"> </span>Kovach</div><div class="t m0 xb5 h2a y2593 ff19 fsf fc0 sc0 ls0 ws0">[</div><div class="t m0 xc6 h2a y135 ff19 fsf fc0 sc0 ls0 ws0">1989</div><div class="t m0 x1f3 h2a y2593 ff19 fsf fc0 sc0 ls0 ws0">]</div><div class="t m0 x1ac h2a y135 ff19 fsf fc0 sc0 ls1204 ws0">.T<span class="_ _49"></span><span class="ls0">hey <span class="_"> </span>claim <span class="_ _47"> </span>that <span class="_ _47"> </span>the <span class="_ _47"> </span>namespace <span class="_ _47"> </span>used <span class="_ _47"> </span>by</span></div><div class="t m0 x32 h2a y136 ff19 fsf fc0 sc0 ls0 ws0">System V <span class="_ _2"></span>IPC (the <span class="_ _2"></span>identiﬁers) <span class="_ _2"></span>is an <span class="_ _2"></span>advantage, <span class="_ _2"></span>not a <span class="_ _2"></span>problem as we <span class="_ _2"></span>said <span class="_ _2"></span>earlier<span class="_ _6"></span><span class="lsb68">,b<span class="_ _d"></span><span class="ls0">ecause</span></span></div><div class="t m0 x32 h2a y137 ff19 fsf fc0 sc0 ls0 ws0">using <span class="_ _9"></span>identiﬁers <span class="_ _9"></span>allows <span class="_ _23"></span>a <span class="_ _9"></span>process <span class="_ _9"></span>to <span class="_ _9"></span>send <span class="_ _9"></span>a <span class="_ _23"></span>message <span class="_ _9"></span>to <span class="_ _9"></span>a <span class="_ _23"></span>message <span class="_ _9"></span>queue <span class="_ _9"></span>with <span class="_ _23"></span>a <span class="_ _9"></span>single</div><div class="t m0 x32 h26 y138 ff19 fsf fc0 sc0 ls0 ws0">function <span class="_ _9"></span>call <span class="_ _3"></span>(<span class="ff1a">msgsnd</span>), <span class="_ _9"></span>whereas <span class="_ _9"></span>other <span class="_ _3"></span>forms <span class="_ _9"></span>of <span class="_ _9"></span>IPC <span class="_ _9"></span>normally <span class="_ _9"></span>requir<span class="_ _0"></span><span class="ls1b0">ea<span class="_ _b"></span><span class="ls0">n<span class="_ _45"> </span><span class="ff1a">open</span>,<span class="_ _47"> </span><span class="ff1a">write</span>,</span></span></div><div class="t m0 x32 h26 y139 ff19 fsf fc0 sc0 ls0 ws0">and<span class="_ _44"> </span><span class="ff1a">close</span><span class="ls1205">.T<span class="_ _52"></span><span class="ls0">his <span class="_ _42"> </span>argument <span class="_ _42"> </span>is <span class="_ _42"> </span>false.<span class="_ _54"> </span>Clients <span class="_ _42"> </span>still <span class="_ _42"> </span>have <span class="_ _42"> </span>to <span class="_ _42"> </span>obtain <span class="_ _42"> </span>the <span class="_ _53"> </span>identiﬁer <span class="_ _42"> </span>for <span class="_ _42"> </span>the</span></span></div><div class="t m0 x32 h26 y13a ff19 fsf fc0 sc0 ls0 ws0">server <span class="_ _a"></span>’s<span class="_ _59"> </span>queue <span class="_"> </span>somehow<span class="_ _6"></span>,<span class="_ _59"> </span>to<span class="_ _46"> </span>avoid <span class="_"> </span>using <span class="_"> </span>a <span class="_"> </span>key <span class="_ _e"> </span>and <span class="_"> </span>calling<span class="_ _59"> </span><span class="ff1a">msgget</span><span class="ls1206">.T<span class="_ _5d"></span><span class="ls0">he <span class="_"> </span>identiﬁer</span></span></div><div class="t m0 x32 h2a y254 ff19 fsf fc0 sc0 ls0 ws0">assigned to <span class="_ _2"></span>a <span class="_ _2"></span>particular <span class="_ _2"></span>queue <span class="_ _2"></span>depends <span class="_ _2"></span>on <span class="_ _2"></span>how <span class="_ _2"></span>many <span class="_ _2"></span>other <span class="_ _2"></span>message <span class="_ _2"></span>queues exist <span class="_ _2"></span>when</div><div class="t m0 x32 h2a y255 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _23"></span>queue <span class="_ _9"></span>is <span class="_ _23"> </span>created <span class="_ _9"></span>and <span class="_ _23"> </span>how <span class="_ _23"></span>many <span class="_ _23"></span>times <span class="_ _9"></span>the <span class="_ _23"> </span>table <span class="_ _23"></span>in <span class="_ _23"></span>the <span class="_ _9"></span>kernel <span class="_ _23"> </span>assigned <span class="_ _23"></span>to <span class="_ _23"></span>the <span class="_ _9"></span>new</div><div class="t m0 x32 h2a y13b ff19 fsf fc0 sc0 ls0 ws0">queue <span class="_ _9"></span>has <span class="_ _9"></span>been <span class="_ _23"></span>used <span class="_ _9"></span>since <span class="_ _23"></span>the <span class="_ _9"></span>kernel <span class="_ _9"></span>was <span class="_ _23"></span>bootstrapped.<span class="_ _5a"> </span>This <span class="_ _9"></span>is <span class="_ _9"></span>a <span class="_ _23"></span>dynamic <span class="_ _9"></span>value <span class="_ _9"></span>that</div><div class="t m0 x32 h2a y13c ff19 fsf fc0 sc0 ls0 ws0">can’t <span class="_ _3"></span>be <span class="_ _2"></span>guessed <span class="_ _3"></span>or <span class="_ _3"></span>stored <span class="_ _3"></span>in <span class="_ _3"></span>a <span class="_ _3"></span>header<span class="_ _6"></span><span class="ls1207">.A<span class="_ _5b"></span><span class="ls0">s<span class="_ _47"> </span>we<span class="_ _47"> </span>mentioned <span class="_ _3"></span>in <span class="_ _3"></span>Section <span class="_ _3"></span>15.6.1, <span class="_ _3"></span>minimally <span class="_ _3"></span>a</span></span></div><div class="t m0 x32 h2a y256 ff19 fsf fc0 sc0 ls0 ws0">server has to write the assigned queue identiﬁer to a ﬁle for its clients to read.</div><div class="t m0 x3f h2a y257 ff19 fsf fc0 sc0 ls0 ws0">Other <span class="_ _47"> </span>advantages <span class="_ _47"> </span>listed <span class="_ _47"> </span>by <span class="_ _47"> </span>these <span class="_ _47"> </span>authors <span class="_ _47"> </span>for <span class="_ _47"> </span>message <span class="_ _47"> </span>queues <span class="_ _47"> </span>ar<span class="ls1208">et<span class="_ _1d"></span><span class="ls0">hat <span class="_ _47"> </span>they’re</span></span></div><div class="t m0 x32 h2a y258 ff19 fsf fc0 sc0 ls45 ws0">re<span class="ls0">liable, <span class="_ _23"> </span>ﬂow <span class="_ _23"> </span>controlled, <span class="_ _9"></span>and <span class="_ _23"> </span>recor<span class="ls1209">do<span class="_ _43"></span><span class="ls0">riented, <span class="_ _23"></span>and <span class="_ _23"></span>that <span class="_ _23"></span>they <span class="_ _23"></span>can <span class="_ _23"></span>be <span class="_ _9"></span>processed <span class="_ _23"></span>in <span class="_ _23"></span>other</span></span></span></div><div class="t m0 x32 h2a y161 ff19 fsf fc0 sc0 ls0 ws0">than ﬁrst-in, <span class="_ _2"></span>ﬁrst-out order<span class="_ _6"></span><span class="lsded">.F<span class="_ _4a"></span><span class="ls0">igur<span class="lsdee">e1<span class="_ _4f"></span><span class="ls0">5.25 compares some of <span class="_ _2"></span>the <span class="_ _2"></span>features of these various</span></span></span></span></div><div class="t m0 x32 h2a y162 ff19 fsf fc0 sc0 ls0 ws0">forms of IPC.</div><div class="t m0 x37 h2d y43bc ff19 fs10 fc0 sc0 ls0 ws0">Message types</div><div class="t m0 x19e h2d y43bd ff19 fs10 fc0 sc0 ls0 ws0">or priorities?</div><div class="t m0 xd8 h2d y43be ff19 fs10 fc0 sc0 ls0 ws0">IPC type<span class="_ _173"> </span>Connectionless?<span class="_ _50"> </span>Reliable?<span class="_ _5f"> </span>Flow control?<span class="_ _50"> </span>Records?</div><div class="t m0 x1c1 h2e y43bf ff19 fs11 fc0 sc0 ls0 ws0">message queues<span class="_ _2ba"> </span>no <span class="_ _13a"> </span>yes<span class="_ _130"> </span>yes <span class="_ _1c7"> </span>yes<span class="_ _90"> </span>yes</div><div class="t m0 x1c1 h2e y43c0 ff19 fs11 fc0 sc0 ls0 ws0">STREAMS <span class="_ _d5"> </span>no<span class="_ _1e"> </span>yes <span class="_ _2e"> </span>yes<span class="_ _130"> </span>yes <span class="_ _130"> </span>yes</div><div class="t m0 x1c1 h2e y43c1 ff19 fs11 fc0 sc0 ls0 ws0">UNIX domain stream socket<span class="_ _133"> </span>no <span class="_ _13a"> </span>yes<span class="_ _130"> </span>yes <span class="_ _9f"> </span>no<span class="_ _7d"> </span>no</div><div class="t m0 x1c1 h2e y43c2 ff19 fs11 fc0 sc0 ls0 ws0">UNIX domain datagram socket<span class="_ _10b"> </span>yes <span class="_ _2bb"> </span>yes<span class="_ _b7"> </span>no <span class="_ _9f"> </span>yes<span class="_ _17a"> </span>no</div><div class="t m0 x1c1 h2e y43c3 ff19 fs11 fc0 sc0 ls0 ws0">FIFOs (non-STREAMS)<span class="_ _25f"> </span>no <span class="_ _13a"> </span>yes<span class="_ _130"> </span>yes <span class="_ _9f"> </span>no<span class="_ _7d"> </span>no</div><div class="t m0 x1ca h2f y43c4 ff18 fs12 fc0 sc0 ls0 ws0">Figure 15.25<span class="_ _5a"> </span><span class="ff19">Comparison of features of various forms of IPC</span></div><div class="t m0 x32 h50 y43c5 ff19 fs29 fc0 sc0 ls0 ws0">(W<span class="_ _6"></span><span class="ls120a">ed<span class="_ _43"></span><span class="ls0">escribe <span class="_ _23"> </span>stream <span class="_ _23"></span>and <span class="_ _23"></span>datagram <span class="_ _23"></span>sockets <span class="_ _9"></span>in <span class="_ _23"> </span>Chapter <span class="_ _23"> </span>16.<span class="_ _51"> </span><span class="lse2">We <span class="_ _47"> </span>d<span class="_ _9"></span></span>escribe <span class="_ _23"> </span>UNIX <span class="_ _23"> </span>domain</span></span></div><div class="t m0 x32 h50 y43c6 ff19 fs29 fc0 sc0 ls0 ws0">sockets <span class="_ _23"> </span>in <span class="_ _42"> </span>Section <span class="_ _42"> </span>17.2.)<span class="_ _51"> </span>By <span class="_ _42"> </span>‘<span class="_ _0"></span>‘connectionless,’<span class="_ _1"></span>’<span class="_ _44"> </span>we<span class="_ _35"> </span>mean <span class="_ _42"> </span>the <span class="_ _23"> </span>ability <span class="_ _42"> </span>to <span class="_ _42"> </span>send <span class="_ _23"> </span>a <span class="_ _42"> </span>message</div><div class="t m0 x32 h50 y43c7 ff19 fs29 fc0 sc0 ls0 ws0">without having <span class="_ _2"></span>to call <span class="_ _2"></span>some <span class="_ _2"></span>form of <span class="_ _2"></span>an open <span class="_ _2"></span>function <span class="_ _2"></span>ﬁrst.<span class="_ _46"> </span>As <span class="_ _2"></span>described previously<span class="_ _4"></span><span class="ls120b">,w<span class="_ _d"></span><span class="ls0">e</span></span></div><div class="t m0 x32 h50 y43c8 ff19 fs29 fc0 sc0 ls0 ws0">don’t <span class="_"> </span>consider <span class="_"> </span>message <span class="_"> </span>queues <span class="_"> </span>connectionless, <span class="_"> </span>since <span class="_"> </span>some <span class="_ _66"> </span>technique <span class="_"> </span>is <span class="_"> </span>required <span class="_"> </span>to</div><div class="t m0 x32 h50 y43c9 ff19 fs29 fc0 sc0 ls0 ws0">obtain <span class="_ _9"></span>the <span class="_ _9"></span>identiﬁer <span class="_ _9"></span>for <span class="_ _23"></span>a <span class="_ _9"></span>queue.<span class="_ _5a"> </span>Since <span class="_ _9"></span>all <span class="_ _9"></span>these <span class="_ _9"></span>forms <span class="_ _23"></span>of <span class="_ _9"></span>IPC <span class="_ _9"></span>ar<span class="ls120c">er<span class="_ _43"></span><span class="ls0">estricted <span class="_ _23"></span>to <span class="_ _9"></span>a <span class="_ _9"></span>single</span></span></div><div class="t m0 x32 h50 y43ca ff19 fs29 fc0 sc0 ls0 ws0">host, <span class="_ _23"></span>all <span class="_ _23"> </span>ar<span class="ls120d">er<span class="_ _43"></span><span class="ls0">eliable. <span class="_ _35"> </span>When<span class="_ _45"> </span>the <span class="_ _42"> </span>messages <span class="_ _23"></span>ar<span class="ls120d">es<span class="_ _43"></span><span class="ls0">ent <span class="_ _23"></span>across <span class="_ _23"></span>a <span class="_ _23"></span>network, <span class="_ _23"></span>the <span class="_ _23"> </span>possibility <span class="_ _23"> </span>of</span></span></span></span></div><div class="t m0 x32 h50 y43cb ff19 fs29 fc0 sc0 ls0 ws0">messages <span class="_ _2"></span>being <span class="_ _3"></span>lost <span class="_ _2"></span>becomes <span class="_ _2"></span>a <span class="_ _3"></span>concern.<span class="_ _61"> </span><span class="ls120e">‘‘<span class="_ _3"></span></span>Flow <span class="_ _2"></span>control’<span class="_ _1"></span><span class="ls120f">’m<span class="_ _4f"></span><span class="ls0">eans <span class="_ _3"></span>that <span class="_ _2"></span>the <span class="_ _3"></span>sender <span class="_ _2"></span>is <span class="_ _3"></span>put <span class="_ _2"></span>to</span></span></div><div class="t m0 x32 h50 y43cc ff19 fs29 fc0 sc0 ls0 ws0">sleep <span class="_ _23"></span>if <span class="_ _23"></span>there<span class="_ _45"> </span>is<span class="_ _35"> </span>a<span class="_ _35"> </span>shortage <span class="_ _23"></span>of <span class="_ _23"></span>system <span class="_ _23"></span>resour<span class="_ _1"></span>ces <span class="_ _42"> </span>(buf<span class="_ _0"></span>fers) <span class="_ _23"></span>or <span class="_ _23"></span>if <span class="_ _23"></span>the <span class="_ _23"> </span>receiver <span class="_ _23"></span>can’t <span class="_ _23"></span>accept</div><div class="t m0 x32 h50 y43cd ff19 fs29 fc0 sc0 ls0 ws0">any <span class="_ _2"></span>mor<span class="ls1210">em<span class="_ _8"></span><span class="ls0">essages. <span class="_ _47"> </span>When<span class="_ _66"> </span>the <span class="_ _2"></span>ﬂow <span class="_ _2"></span>control condition <span class="_ _2"></span>subsides <span class="_ _3"></span>(i.e., <span class="_ _2"></span>when <span class="_ _2"></span>ther<span class="ls1210">ei<span class="_ _8"></span><span class="ls1211">sr<span class="_ _4f"></span><span class="ls0">oom</span></span></span></span></span></div><div class="t m0 x32 h50 y43ce ff19 fs29 fc0 sc0 ls0 ws0">in the queue), the sender should automatically be awakened.</div><div class="t m0 x3f h50 y43cf ff19 fs29 fc0 sc0 ls0 ws0">One <span class="_ _e"> </span>featur<span class="ls1212">et<span class="_ _4a"></span><span class="ls0">hat <span class="_"> </span>we <span class="_ _53"> </span>don’t <span class="_"> </span>show <span class="_ _53"> </span>in <span class="_"> </span>Figur<span class="_ _0"></span><span class="ls1213">e1<span class="_ _55"></span><span class="ls0">5.25 <span class="_ _e"> </span>is <span class="_ _e"> </span>whether <span class="_"> </span>the <span class="_ _53"> </span>IPC <span class="_"> </span>facility <span class="_ _53"> </span>can</span></span></span></span></div><div class="t m0 x32 h50 y43d0 ff19 fs29 fc0 sc0 ls0 ws0">automatically <span class="_ _47"> </span>create <span class="_"> </span>a <span class="_ _47"> </span>unique <span class="_ _47"> </span>connection <span class="_ _47"> </span>to <span class="_ _47"> </span>a <span class="_ _47"> </span>server <span class="_ _47"> </span>for <span class="_ _47"> </span>each <span class="_ _47"> </span>client.<span class="_ _50"> </span><span class="lse2">We<span class="_ _9"></span></span>’ll <span class="_ _47"> </span>see <span class="_ _47"> </span>in</div><div class="t m0 x32 h50 y43d1 ff19 fs29 fc0 sc0 ls0 ws0">Chapter <span class="_ _23"> </span>17 <span class="_ _42"> </span>that <span class="_ _42"> </span>UNIX <span class="_ _23"> </span>stream <span class="_ _23"> </span>sockets <span class="_ _42"> </span>provide <span class="_ _23"> </span>this <span class="_ _42"> </span>capability<span class="_ _4"></span><span class="ls1214">.T<span class="_ _7"></span><span class="ls0">he <span class="_ _42"> </span>next <span class="_ _42"> </span>three <span class="_ _23"></span>sections</span></span></div><div class="t m0 x32 h50 y43d2 ff19 fs29 fc0 sc0 ls0 ws0">describe each of the three forms of XSI IPC in detail.</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
