<div id="pfac" class="pf w4 h1f" data-page-no="ac"><div class="pc pcac w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bgac.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">138<span class="_ _1b"> </span><span class="ff19">Files <span class="_"> </span>and <span class="_"> </span>Directories <span class="_ _18d"> </span>Chapter<span class="_ _4b"> </span>4</span></div><div class="t m0 x3f h2a y12f ff19 fsf fc0 sc0 ls49 ws0">•W<span class="_ _4e"></span><span class="ls5f4">ec<span class="_ _d"></span><span class="ls0">an <span class="_ _2"></span>usually access <span class="_ _2"></span>the <span class="_ _2"></span>major <span class="_ _2"></span>and minor <span class="_ _2"></span>device <span class="_ _2"></span>numbers <span class="_ _2"></span>through two <span class="_ _2"></span>macros</span></span></div><div class="t m0 x15 h26 y130 ff19 fsf fc0 sc0 ls0 ws0">deﬁned <span class="_ _9"></span>by <span class="_ _23"></span>most <span class="_ _23"></span>implementations:<span class="_ _45"> </span><span class="ff1a">major<span class="_ _45"> </span></span>and<span class="_ _35"> </span><span class="ff1a">minor</span><span class="ls5f5">.C<span class="_ _26"></span><span class="ls0">onsequently<span class="_ _4"></span>,<span class="_ _35"> </span>we<span class="_ _45"> </span>don’t</span></span></div><div class="t m0 x15 h26 y131 ff19 fsf fc0 sc0 ls0 ws0">car<span class="ls44">eh<span class="_ _4f"></span><span class="ls0">ow the two numbers ar<span class="ls44">es<span class="_ _d"></span><span class="ls0">tored in a<span class="_"> </span><span class="ff1a">dev_t<span class="_ _80"> </span></span>object.</span></span></span></span></div><div class="t m0 xf6 h51 yba0 ff19 fs2a fc0 sc0 ls0 ws0">Early <span class="_ _42"> </span>systems <span class="_"> </span>stor<span class="_ _0"></span>ed <span class="_ _42"> </span>the <span class="_ _42"> </span>device <span class="_"> </span>number <span class="_ _42"> </span>in <span class="_ _42"> </span>a <span class="_ _42"> </span>16</div><div class="t m0 x47 h51 y13bc ff19 fs2a fc0 sc0 ls0 ws0">-</div><div class="t m0 x101 h51 yba0 ff19 fs2a fc0 sc0 ls0 ws0">bit <span class="_ _42"> </span>integer<span class="_ _1"></span><span class="ls5f6">,w<span class="_ _b"></span><span class="ls0">ith <span class="_ _42"> </span>8 <span class="_ _42"> </span>bits <span class="_"> </span>for <span class="_ _23"> </span>the <span class="_"> </span>major</span></span></div><div class="t m0 xf6 h51 yba1 ff19 fs2a fc0 sc0 ls0 ws0">number <span class="_ _3"></span>and <span class="_ _3"></span>8 <span class="_ _9"></span>bits <span class="_ _3"></span>for <span class="_ _3"></span>the <span class="_ _9"></span>minor <span class="_ _3"></span>number<span class="_ _1"></span><span class="ls5f7">.F<span class="_ _55"></span><span class="ls34e">re<span class="ls0">eBSD <span class="_ _9"></span>8.0 <span class="_ _3"></span>and <span class="_ _3"></span>Mac <span class="_ _9"></span>OS <span class="_ _3"></span>X <span class="_ _3"></span>10.6.8 <span class="_ _3"></span>use <span class="_ _9"></span>a <span class="_ _3"></span>32</span></span></span></div><div class="t m0 x40 h51 y13bd ff19 fs2a fc0 sc0 ls0 ws0">-</div><div class="t m0 xcf h51 yba1 ff19 fs2a fc0 sc0 ls0 ws0">bit</div><div class="t m0 xf6 h51 yba2 ff19 fs2a fc0 sc0 ls0 ws0">integer<span class="_ _1"></span><span class="ls5f8">,w<span class="_ _8"></span><span class="ls0">ith <span class="_ _23"> </span>8 <span class="_ _9"> </span>bits <span class="_ _23"> </span>for <span class="_ _23"> </span>the <span class="_ _23"> </span>major <span class="_ _9"> </span>number <span class="_ _23"> </span>and <span class="_ _23"> </span>24 <span class="_ _9"> </span>bits <span class="_ _23"> </span>for <span class="_ _23"> </span>the <span class="_ _23"> </span>minor <span class="_ _9"> </span>number<span class="_ _1"></span><span class="ls5f9">.O<span class="_ _4a"></span><span class="ls5f8">n3<span class="_ _8"></span><span class="ls0">2</span></span></span></span></span></div><div class="t m0 x40 h51 y13be ff19 fs2a fc0 sc0 ls0 ws0">-</div><div class="t m0 xcf h51 yba2 ff19 fs2a fc0 sc0 ls0 ws0">bit</div><div class="t m0 xf6 h51 yba3 ff19 fs2a fc0 sc0 ls0 ws0">systems, <span class="_ _3"></span>Solaris <span class="_ _9"></span>10 <span class="_ _3"></span>uses <span class="_ _9"></span>a <span class="_ _9"></span>32</div><div class="t m0 xc5 h51 y13bf ff19 fs2a fc0 sc0 ls0 ws0">-</div><div class="t m0 x9c h52 yba3 ff19 fs2a fc0 sc0 ls0 ws0">bit <span class="_ _3"></span>integer <span class="_ _9"></span>for<span class="_ _66"> </span><span class="ff1a">dev_t</span><span class="ls5fa">,w<span class="_ _d"></span><span class="ls0">ith <span class="_ _3"></span>14 <span class="_ _9"></span>bits <span class="_ _9"></span>designated <span class="_ _3"></span>as <span class="_ _9"></span>the <span class="_ _3"></span>major</span></span></div><div class="t m0 xf6 h51 yba4 ff19 fs2a fc0 sc0 ls0 ws0">number <span class="_"> </span>and <span class="_"> </span>18 <span class="_"> </span>bits <span class="_"> </span>designated <span class="_"> </span>as <span class="_"> </span>the <span class="_ _e"> </span>minor <span class="_ _e"> </span>number<span class="_ _0"></span><span class="ls5fb">.O<span class="_ _26"></span><span class="ls5fc">n6<span class="_ _43"></span><span class="ls0">4</span></span></span></div><div class="t m0 xd4 h51 y13c0 ff19 fs2a fc0 sc0 ls0 ws0">-</div><div class="t m0 x16f h51 yba4 ff19 fs2a fc0 sc0 ls0 ws0">bit <span class="_"> </span>systems, <span class="_"> </span>Solaris <span class="_"> </span>10</div><div class="t m0 xf6 h52 yba5 ff19 fs2a fc0 sc0 ls34e ws0">re<span class="ls0">presents<span class="_ _35"> </span><span class="ff1a">dev_t<span class="_ _44"> </span></span>as <span class="_"> </span>a <span class="_"> </span>64</span></div><div class="t m0 x84 h51 y13c1 ff19 fs2a fc0 sc0 ls0 ws0">-</div><div class="t m0 x1bb h51 yba5 ff19 fs2a fc0 sc0 ls0 ws0">bit <span class="_"> </span>integer<span class="_ _1"></span><span class="ls5fd">,w<span class="_ _43"></span><span class="ls0">ith <span class="_"> </span>32 <span class="_"> </span>bits <span class="_"> </span>for <span class="_"> </span>each <span class="_"> </span>number<span class="_ _6"></span><span class="ls5fe">.O<span class="_ _26"></span><span class="ls5ff">nL<span class="_ _43"></span><span class="ls0">inux <span class="_"> </span>3.2.0,</span></span></span></span></span></div><div class="t m0 xf6 h52 yba6 ff19 fs2a fc0 sc0 ls0 ws0">although<span class="_"> </span><span class="ff1a">dev_t<span class="_ _80"> </span></span>is <span class="_ _2"></span>a 64</div><div class="t m0 x5c h51 y13c2 ff19 fs2a fc0 sc0 ls0 ws0">-</div><div class="t m0 x23 h51 yba6 ff19 fs2a fc0 sc0 ls0 ws0">bit integer<span class="_ _1"></span><span class="ls600">,o<span class="_ _84"></span><span class="ls0">nly <span class="_ _2"></span>12 bits <span class="_ _2"></span>ar<span class="ls600">eu<span class="_ _5"></span><span class="ls0">sed <span class="_ _2"></span>for <span class="_ _2"></span>the major <span class="_ _2"></span>number <span class="_ _2"></span>and <span class="_ _2"></span>20 <span class="_ _2"></span>bits</span></span></span></span></div><div class="t m0 xf6 h51 yba7 ff19 fs2a fc0 sc0 ls0 ws0">ar<span class="lse9">eu<span class="_ _5"></span><span class="ls0">sed for the minor number<span class="_ _1"></span>.</span></span></div><div class="t m0 xf6 h52 yba8 ff19 fs2a fc0 sc0 ls0 ws0">POSIX.1 <span class="_ _3"></span>states <span class="_ _9"></span>that <span class="_ _3"></span>the<span class="_ _66"> </span><span class="ff1a">dev_t<span class="_ _66"> </span></span>type <span class="_ _9"></span>exists, <span class="_ _3"></span>but <span class="_ _3"></span>doesn’t <span class="_ _9"></span>deﬁne <span class="_ _3"></span>what <span class="_ _9"></span>it <span class="_ _3"></span>contains <span class="_ _9"></span>or <span class="_ _3"></span>how <span class="_ _9"></span>to</div><div class="t m0 xf6 h52 yba9 ff19 fs2a fc0 sc0 ls0 ws0">get <span class="_ _2"></span>at <span class="_ _3"></span>its <span class="_ _3"></span>contents.<span class="_ _4b"> </span>The <span class="_ _3"></span>macros<span class="_ _80"> </span><span class="ff1a">major<span class="_ _80"> </span></span>and<span class="_ _66"> </span><span class="ff1a">minor<span class="_ _80"> </span></span>ar<span class="ls601">ed<span class="_ _d"></span><span class="ls0">eﬁned <span class="_ _3"></span>by <span class="_ _3"></span>most <span class="_ _3"></span>implementations.</span></span></div><div class="t m0 xf6 h51 ybaa ff19 fs2a fc0 sc0 ls0 ws0">Which <span class="_ _80"> </span>header <span class="_ _66"> </span>they <span class="_ _66"> </span>ar<span class="ls602">ed<span class="_ _55"></span><span class="ls0">eﬁned <span class="_ _66"> </span>in <span class="_ _80"> </span>depends <span class="_ _66"> </span>on <span class="_ _66"> </span>the <span class="_ _66"> </span>system.<span class="_ _54"> </span>They <span class="_ _80"> </span>can <span class="_ _66"> </span>be <span class="_ _66"> </span>found <span class="_ _66"> </span>in</span></span></div><div class="t m0 xf6 h52 ybab ff1a fs2a fc0 sc0 ls0 ws0">&lt;sys/types.h&gt;<span class="_ _35"> </span><span class="ff19">on <span class="_"> </span>BSD</span></div><div class="t m0 x9a h51 y13c3 ff19 fs2a fc0 sc0 ls0 ws0">-</div><div class="t m0 x10f h51 ybab ff19 fs2a fc0 sc0 ls0 ws0">based <span class="_"> </span>systems.<span class="_ _5a"> </span>Solaris <span class="_"> </span>deﬁnes <span class="_"> </span>their <span class="_ _42"> </span>function <span class="_"> </span>prototypes <span class="_"> </span>in</div><div class="t m0 xf6 h52 y13c4 ff1a fs2a fc0 sc0 ls0 ws0">&lt;sys/mkdev.h&gt;<span class="ff19 ls603">,b<span class="_ _5"></span><span class="ls0">ecause <span class="_ _2"></span>the macr<span class="ls603">od<span class="_ _5"></span><span class="ls0">eﬁnitions in<span class="_ _e"> </span><span class="ff1a">&lt;sys/sysmacros.h&gt;<span class="_ _80"> </span></span>ar<span class="ls603">ec<span class="_ _5"></span><span class="ls0">onsidered</span></span></span></span></span></span></div><div class="t m0 xf6 h52 y13c5 ff19 fs2a fc0 sc0 ls0 ws0">obsolete <span class="_ _80"> </span>in <span class="_ _66"> </span>Solaris.<span class="_ _54"> </span>Linux <span class="_ _66"> </span>deﬁnes <span class="_ _66"> </span>these <span class="_ _66"> </span>macros <span class="_ _80"> </span>in<span class="_ _4b"> </span><span class="ff1a">&lt;sys/sysmacros.h&gt;</span><span class="ls604">,w<span class="_ _c"></span><span class="ls0">hich <span class="_ _80"> </span>is</span></span></div><div class="t m0 xf6 h52 y13c6 ff19 fs2a fc0 sc0 ls0 ws0">included by<span class="_"> </span><span class="ff1a">&lt;sys/types.h&gt;</span>.</div><div class="t m0 x3f h26 ydc1 ff19 fsf fc0 sc0 ls49 ws0">•T<span class="_ _4d"></span><span class="ls0">he<span class="_ _45"> </span><span class="ff1a">st_dev<span class="_ _35"> </span></span>value <span class="_ _9"></span>for <span class="_ _23"></span>every <span class="_ _9"></span>ﬁlename <span class="_ _23"> </span>on <span class="_ _23"></span>a <span class="_ _9"></span>system <span class="_ _23"></span>is <span class="_ _23"></span>the <span class="_ _9"></span>device <span class="_ _23"></span>number <span class="_ _9"></span>of <span class="_ _23"> </span>the</span></div><div class="t m0 x15 h2a y13c7 ff19 fsf fc0 sc0 ls0 ws0">ﬁle system containing that ﬁlename and its corresponding i-node.</div><div class="t m0 x3f h26 y13c8 ff19 fsf fc0 sc0 ls49 ws0">•O<span class="_ _4d"></span><span class="ls0">nly <span class="_ _2"></span>character <span class="_ _2"></span>special <span class="_ _3"></span>ﬁles <span class="_ _2"></span>and <span class="_ _2"></span>block <span class="_ _3"></span>special <span class="_ _2"></span>ﬁles <span class="_ _2"></span>have <span class="_ _3"></span>an<span class="_ _47"> </span><span class="ff1a">st_rdev<span class="_ _66"> </span></span>value. <span class="_ _47"> </span>This</span></div><div class="t m0 x15 h2a y13c9 ff19 fsf fc0 sc0 ls0 ws0">value contains the device number for the actual device.</div><div class="t m0 x35 h27 y13ca ff16 fsf fc0 sc0 ls0 ws0">Example</div><div class="t m0 x32 h2a y13cb ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _2"></span>program in <span class="_ _2"></span>Figur<span class="ls605">e4<span class="_ _4f"></span><span class="ls0">.25 <span class="_ _2"></span>prints <span class="_ _2"></span>the <span class="_ _2"></span>device <span class="_ _2"></span>number <span class="_ _2"></span>for <span class="_ _2"></span>each <span class="_ _2"></span>command</span></span></div><div class="t m0 x11c h2a y13cc ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 x51 h2a y13cb ff19 fsf fc0 sc0 ls0 ws0">line <span class="_ _2"></span>argument.</div><div class="t m0 x32 h2a y13cd ff19 fsf fc0 sc0 ls0 ws0">Additionally<span class="_ _4"></span>,<span class="_ _45"> </span>if<span class="_ _47"> </span>the <span class="_ _3"></span>argument <span class="_ _2"></span>refers <span class="_ _3"></span>to <span class="_ _3"></span>a <span class="_ _9"></span>character <span class="_ _3"></span>special <span class="_ _3"></span>ﬁle <span class="_ _3"></span>or <span class="_ _9"></span>a <span class="_ _3"></span>block <span class="_ _3"></span>special <span class="_ _9"></span>ﬁle, <span class="_ _3"></span>the</div><div class="t m0 x32 h26 y13ce ff1a fsf fc0 sc0 ls0 ws0">st_rdev<span class="_ _80"> </span><span class="ff19">value for the special ﬁle is printed.</span></div><div class="t m0 x32 h4e y13cf ff1a fs28 fc0 sc0 ls0 ws0">#include &quot;apue.h&quot;</div><div class="t m0 x32 h4e y13d0 ff1a fs28 fc0 sc0 ls0 ws0">#ifdef SOLARIS</div><div class="t m0 x32 h4e y13d1 ff1a fs28 fc0 sc0 ls0 ws0">#include &lt;sys/mkdev.h&gt;</div><div class="t m0 x32 h4e y13d2 ff1a fs28 fc0 sc0 ls0 ws0">#endif</div><div class="t m0 x32 h4e y13d3 ff1a fs28 fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 h4e y13d4 ff1a fs28 fc0 sc0 ls0 ws0">main(int argc, char *argv[])</div><div class="t m0 x32 h4e y13d5 ff1a fs28 fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h4e y13d6 ff1a fs28 fc0 sc0 ls0 ws0">int <span class="_ _186"> </span>i;</div><div class="t m0 x8a h4e y13d7 ff1a fs28 fc0 sc0 ls0 ws0">struct stat buf;</div><div class="t m0 x8a h4e y13d8 ff1a fs28 fc0 sc0 ls0 ws0">for (i = 1; i &lt; argc; i++) {</div><div class="t m0 x9d h4e y13d9 ff1a fs28 fc0 sc0 ls0 ws0">printf(&quot;%s: &quot;, argv[i]);</div><div class="t m0 x9d h4e y13da ff1a fs28 fc0 sc0 ls0 ws0">if (stat(argv[i], &amp;buf) &lt; 0) {</div><div class="t m0 x1f h4e y13db ff1a fs28 fc0 sc0 ls0 ws0">err_ret(&quot;stat error&quot;);</div><div class="t m0 x1f h4e y13dc ff1a fs28 fc0 sc0 ls0 ws0">continue;</div><div class="t m0 x9d h4e y13dd ff1a fs28 fc0 sc0 ls0 ws0">}</div><div class="t m0 x9d h4e y13de ff1a fs28 fc0 sc0 ls0 ws0">printf(&quot;dev = %d/%d&quot;, major(buf.st_dev),<span class="_ _d9"> </span>minor(buf.st_dev));</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
