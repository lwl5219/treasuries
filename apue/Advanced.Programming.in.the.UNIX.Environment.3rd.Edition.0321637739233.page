<div id="pfe9" class="pf w4 h1f" data-page-no="e9"><div class="pc pce9 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bge9.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>7.3<span class="_ _20d"> </span>Process <span class="_"> </span>T<span class="_ _6"></span>ermination<span class="_ _1b"> </span><span class="ff18">199</span></div><div class="t m0 x3f h26 y12f ff19 fsf fc0 sc0 ls0 ws0">Historically<span class="_ _4"></span><span class="ls833">,t<span class="_ _4a"></span><span class="ls0">he<span class="_ _46"> </span><span class="ff1a">exit<span class="_ _46"> </span></span>function <span class="_"> </span>has <span class="_"> </span>always <span class="_"> </span>performed <span class="_"> </span>a <span class="_"> </span>clean <span class="_"> </span>shutdown <span class="_"> </span>of <span class="_"> </span>the</span></span></div><div class="t m0 x32 h26 y130 ff19 fsf fc0 sc0 ls0 ws0">standar<span class="ls834">dI<span class="_ _43"></span><span class="ls0">/O <span class="_ _23"></span>library: <span class="_ _23"></span>the<span class="_ _35"> </span><span class="ff1a">fclose<span class="_ _45"> </span></span>function <span class="_ _23"> </span>is <span class="_ _23"> </span>called <span class="_ _23"> </span>for <span class="_ _23"> </span>all <span class="_ _23"> </span>open <span class="_ _23"> </span>streams. <span class="_ _45"> </span>Recall<span class="_ _35"> </span>from</span></span></div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">Section 5.5 that this causes all buffer<span class="_ _0"></span>ed output data to be ﬂushed (written to the ﬁle).</div><div class="t m0 x3f h2b y132 ff19 fsf fc0 sc0 ls0 ws0">All <span class="_ _53"> </span>three <span class="_ _53"> </span>exit <span class="_ _53"> </span>functions <span class="_ _e"> </span>expect <span class="_ _53"> </span>a <span class="_ _e"> </span>single <span class="_ _53"> </span>integer <span class="_ _e"> </span>argument, <span class="_ _53"> </span>which <span class="_ _53"> </span>we <span class="_ _e"> </span>call <span class="_ _53"> </span>the<span class="_ _4b"> </span><span class="ff1b">exit</span></div><div class="t m0 x32 h2b y133 ff1b fsf fc0 sc0 ls0 ws0">status<span class="ff19 ls835">.M<span class="_ _1d"></span><span class="ls0">ost <span class="_ _3"></span>UNIX <span class="_ _3"></span>System <span class="_ _3"></span>shells <span class="_ _3"></span>provide <span class="_ _2"></span>a <span class="_ _3"></span>way <span class="_ _3"></span>to <span class="_ _3"></span>examine <span class="_ _3"></span>the <span class="_ _3"></span>exit <span class="_ _3"></span>status <span class="_ _3"></span>of <span class="_ _3"></span>a <span class="_ _3"></span>process.</span></span></div><div class="t m0 x32 h26 y134 ff19 fsf fc0 sc0 ls0 ws0">If <span class="_ _23"> </span>(a) <span class="_ _23"> </span>any <span class="_ _42"> </span>of <span class="_ _23"></span>these <span class="_ _23"> </span>functions <span class="_ _23"> </span>is <span class="_ _42"> </span>called <span class="_ _23"></span>without <span class="_ _23"> </span>an <span class="_ _23"> </span>exit <span class="_ _42"> </span>status, <span class="_ _23"> </span>(b)<span class="_ _35"> </span><span class="ff1a">main<span class="_ _35"> </span></span>does <span class="_ _23"> </span>a<span class="_ _35"> </span><span class="ff1a">return</span></div><div class="t m0 x32 h26 y135 ff19 fsf fc0 sc0 ls0 ws0">without <span class="_ _2"></span>a <span class="_ _3"></span>return <span class="_ _2"></span>value, <span class="_ _2"></span>or <span class="_ _3"></span>(c) <span class="_ _2"></span>the<span class="_ _47"> </span><span class="ff1a">main<span class="_ _47"> </span></span>function <span class="_ _2"></span>is <span class="_ _3"></span>not <span class="_ _2"></span>declared <span class="_ _2"></span>to <span class="_ _2"></span>return <span class="_ _2"></span>an <span class="_ _3"></span>integer<span class="_ _1"></span><span class="ls290">,t<span class="_ _8"></span><span class="ls0">he</span></span></div><div class="t m0 x32 h26 y136 ff19 fsf fc0 sc0 ls0 ws0">exit status <span class="_ _2"></span>of the <span class="_ _2"></span>process is undeﬁned.<span class="_ _61"> </span>However<span class="_ _6"></span>,<span class="_ _66"> </span>if<span class="_ _66"> </span>the <span class="_ _2"></span>return type of<span class="_ _66"> </span><span class="ff1a">main<span class="_ _66"> </span></span>is <span class="_ _2"></span>an integer</div><div class="t m0 x32 h26 y137 ff19 fsf fc0 sc0 ls0 ws0">and<span class="_"> </span><span class="ff1a">main<span class="_ _80"> </span></span><span class="ls124">‘‘<span class="_ _3"></span></span>falls of<span class="ls44">ft<span class="_ _4f"></span><span class="ls0">he end’<span class="ls44">’(<span class="_ _4f"></span><span class="ls0">an implicit return), the exit status of the process is 0.</span></span></span></span></div><div class="t m0 x76 h51 y1571 ff19 fs2a fc0 sc0 ls0 ws0">This <span class="_ _2"></span>behavior <span class="_ _3"></span>is <span class="_ _3"></span>new <span class="_ _2"></span>with <span class="_ _3"></span>the <span class="_ _3"></span>1999 <span class="_ _2"></span>version <span class="_ _3"></span>of <span class="_ _3"></span>the <span class="_ _2"></span>ISO <span class="_ _3"></span>C <span class="_ _3"></span>standard. <span class="_ _80"> </span>Historically<span class="_ _6"></span><span class="ls836">,t<span class="_ _d"></span><span class="ls0">he <span class="_ _3"></span>exit <span class="_ _3"></span>status</span></span></div><div class="t m0 x76 h52 y1572 ff19 fs2a fc0 sc0 ls0 ws0">was <span class="_"> </span>undeﬁned <span class="_"> </span>if <span class="_"> </span>the <span class="_"> </span>end <span class="_"> </span>of <span class="_"> </span>the<span class="_ _35"> </span><span class="ff1a">main<span class="_ _44"> </span></span>function <span class="_"> </span>was <span class="_"> </span>r<span class="_ _0"></span>eached <span class="_"> </span>without <span class="_"> </span>an <span class="_"> </span>explicit<span class="_ _35"> </span><span class="ff1a">return</span></div><div class="t m0 x76 h52 y1574 ff19 fs2a fc0 sc0 ls0 ws0">statement or a call to the<span class="_"> </span><span class="ff1a">exit<span class="_ _53"> </span></span>function.</div><div class="t m0 x3f h26 y1aed ff19 fsf fc0 sc0 ls0 ws0">Returning <span class="_ _42"> </span>an <span class="_ _42"> </span>integer <span class="_ _42"> </span>value <span class="_ _42"> </span>from <span class="_ _23"> </span>the<span class="_ _44"> </span><span class="ff1a">main<span class="_ _35"> </span></span>function <span class="_ _42"> </span>is <span class="_ _42"> </span>equivalent <span class="_ _42"> </span>to <span class="_ _42"> </span>calling<span class="_ _44"> </span><span class="ff1a">exit</span></div><div class="t m0 x32 h2a y1aee ff19 fsf fc0 sc0 ls0 ws0">with the same value.<span class="_ _59"> </span>Thus</div><div class="t m0 x3f h57 y1aef ff1a fs2d fc0 sc0 ls0 ws0">exit(0);</div><div class="t m0 x32 h2a y1af0 ff19 fsf fc0 sc0 ls0 ws0">is the same as</div><div class="t m0 x3f h57 y1af1 ff1a fs2d fc0 sc0 ls0 ws0">return(0);</div><div class="t m0 x32 h26 y1af2 ff19 fsf fc0 sc0 ls0 ws0">from the<span class="_"> </span><span class="ff1a">main<span class="_ _80"> </span></span>function.</div><div class="t m0 x35 h27 y1af3 ff16 fsf fc0 sc0 ls0 ws0">Example</div><div class="t m0 x32 h2a y1af4 ff19 fsf fc0 sc0 ls0 ws0">The program in Figur<span class="_ _0"></span><span class="ls44">e7<span class="_ _d"></span><span class="ls0">.1 is the classic ‘<span class="_ _0"></span>‘hello, world’<span class="_ _1"></span><span class="ls44">’e<span class="_ _5"></span><span class="ls0">xample.</span></span></span></span></div><div class="t m0 x32 h4e y1af5 ff1a fs28 fc0 sc0 ls0 ws0">#include <span class="_ _68"> </span>&lt;stdio.h&gt;</div><div class="t m0 x32 h4e y1af6 ff1a fs28 fc0 sc0 ls0 ws0">main()</div><div class="t m0 x32 h4e y1af7 ff1a fs28 fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h4e y1af8 ff1a fs28 fc0 sc0 ls0 ws0">printf(&quot;hello, world\n&quot;);</div><div class="t m0 x32 h4e y1af9 ff1a fs28 fc0 sc0 ls0 ws0">}</div><div class="t m0 x4a h2e y1afa ff18 fs11 fc0 sc0 ls0 ws0">Figure 7.1<span class="_ _5a"> </span><span class="ff19">Classic C program</span></div><div class="t m0 x32 h55 y1afb ff19 fs2c fc0 sc0 ls0 ws0">When <span class="_ _e"> </span>we <span class="_"> </span>compile <span class="_ _e"> </span>and <span class="_ _e"> </span>run <span class="_"> </span>the <span class="_ _53"> </span>program <span class="_ _e"> </span>in <span class="_"> </span>Figur<span class="_ _0"></span><span class="ls837">e7<span class="_ _55"></span><span class="ls0">.1, <span class="_ _e"> </span>we <span class="_"> </span>see <span class="_ _53"> </span>that <span class="_"> </span>the <span class="_ _e"> </span>exit <span class="_"> </span>code <span class="_ _53"> </span>is</span></span></div><div class="t m0 x32 h55 y1afc ff19 fs2c fc0 sc0 ls0 ws0">random. <span class="_ _44"> </span>If<span class="_ _44"> </span>we <span class="_ _42"> </span>compile <span class="_ _53"> </span>the <span class="_ _53"> </span>same <span class="_ _42"> </span>program <span class="_ _42"> </span>on <span class="_ _53"> </span>differ<span class="_ _0"></span>ent <span class="_ _42"> </span>systems, <span class="_ _53"> </span>we <span class="_ _42"> </span>ar<span class="ls838">el<span class="_ _c"></span><span class="ls0">ikely <span class="_ _53"> </span>to <span class="_ _53"> </span>get</span></span></div><div class="t m0 x32 h55 y1afd ff19 fs2c fc0 sc0 ls0 ws0">differ<span class="_ _0"></span>ent <span class="_ _3"></span>exit <span class="_ _3"></span>codes, <span class="_ _3"></span>depending <span class="_ _9"></span>on <span class="_ _3"></span>the <span class="_ _3"></span>contents <span class="_ _9"></span>of <span class="_ _3"></span>the <span class="_ _3"></span>stack <span class="_ _3"></span>and <span class="_ _9"></span>register <span class="_ _2"></span>contents <span class="_ _9"></span>at <span class="_ _3"></span>the</div><div class="t m0 x32 h54 y1afe ff19 fs2c fc0 sc0 ls0 ws0">time that the<span class="_"> </span><span class="ff1a">main<span class="_ _80"> </span></span>function returns:</div><div class="t m0 x3f h5d y1aff ff1a fs2f fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">gcc hello.c</span></div><div class="t m0 x3f h5d y1b00 ff1a fs2f fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">./a.out</span></div><div class="t m0 x3f h5d y1b01 ff1a fs2f fc0 sc0 ls0 ws0">hello, world</div><div class="t m0 x3f h5d y1b02 ff1a fs2f fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">echo $?<span class="_ _af"> </span><span class="ff1b">print the exit status</span></span></div><div class="t m0 x3f h5d y1b03 ff1a fs2f fc0 sc0 ls0 ws0">13</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
