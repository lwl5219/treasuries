<div id="pf3cc" class="pf w4 h1f" data-page-no="3cc"><div class="pc pc3cc w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg3cc.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">938<span class="_ _1b"> </span><span class="ff19">Solutions <span class="_"> </span>to <span class="_"> </span>Selected <span class="_"> </span>Exercises <span class="_ _2eb"> </span>Appendix<span class="_ _4b"> </span>C</span></div><div class="t m0 xe2 h2a y12f ff19 fsf fc0 sc0 ls0 ws0">Instead, <span class="_ _2"></span>when <span class="_ _3"></span>a <span class="_ _2"></span>linked <span class="_ _3"></span>list <span class="_ _3"></span>is <span class="_ _2"></span>built <span class="_ _3"></span>in <span class="_ _3"></span>a <span class="_ _2"></span>shared <span class="_ _2"></span>memory <span class="_ _3"></span>segment, <span class="_ _2"></span>the <span class="_ _3"></span>list <span class="_ _3"></span>pointers</div><div class="t m0 xe2 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">should be stored as offsets to other objects in the shared memory segment.<span class="_ _46"> </span>These</div><div class="t m0 xe2 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">offsets <span class="_ _9"></span>ar<span class="lsf06">ef<span class="_ _43"></span><span class="ls0">ormed <span class="_ _23"></span>by <span class="_ _9"></span>subtracting <span class="_ _9"></span>the <span class="_ _23"></span>start <span class="_ _9"></span>of <span class="_ _23"></span>the <span class="_ _9"></span>shared <span class="_ _9"></span>memory <span class="_ _9"></span>segment <span class="_ _23"></span>from</span></span></div><div class="t m0 xe2 h2a y132 ff19 fsf fc0 sc0 ls0 ws0">the actual address of the object.</div><div class="t m0 x32 h2a y2936 ff18 fsf fc0 sc0 ls0 ws0">15.14<span class="_ _5f"> </span><span class="ff19">Figur<span class="ls44">eC<span class="_ _4f"></span><span class="ls0">.21 shows the relevant events.</span></span></span></div><div class="t m0 x53 h5e y62a0 ff19 fs10 fc0 sc0 ls0 ws0">Parent<span class="_"> </span><span class="ff1a">i<span class="_ _288"> </span></span>Child<span class="_"> </span><span class="ff1a">i<span class="_ _6e"> </span></span>Shared value<span class="_ _6e"> </span><span class="ff1a">update</span></div><div class="t m0 xf6 h2d y62a1 ff19 fs10 fc0 sc0 ls0 ws0">set to<span class="_ _2a8"> </span>set to<span class="_ _171"> </span>set to<span class="_ _21"> </span><span class="ls21d">re</span>turns</div><div class="t m0 x208 h2d y62a2 ff19 fs10 fc0 sc0 ls0 ws0">Comment</div><div class="t m0 x84 h4f y62a3 ff19 fs11 fc0 sc0 ls187a ws0">0i<span class="_ _325"></span><span class="ls0">nitialized by<span class="_"> </span><span class="ff1a">mmap</span></span></div><div class="t m0 xa7 h2e y62a4 ff19 fs11 fc0 sc0 ls187b ws0">1c<span class="_ _326"></span><span class="ls0">hild runs ﬁrst, then is blocked</span></div><div class="t m0 x50 h2e y62a5 ff19 fs11 fc0 sc0 ls187c ws0">0p<span class="_ _327"></span><span class="ls0">arent runs</span></div><div class="t m0 x84 h2e y62a6 ff19 fs11 fc0 sc0 ls0 ws0">1</div><div class="t m0 xdb h2e y62a7 ff19 fs11 fc0 sc0 ls187d ws0">0t<span class="_ _9d"></span><span class="ls0">hen parent is blocked</span></div><div class="t m0 x84 h2e y62a8 ff19 fs11 fc0 sc0 ls187a ws0">2c<span class="_ _325"></span><span class="ls0">hild resumes</span></div><div class="t m0 xdb h2e y62a9 ff19 fs11 fc0 sc0 ls0 ws0">1</div><div class="t m0 xa7 h2e y62aa ff19 fs11 fc0 sc0 ls187b ws0">3t<span class="_ _326"></span><span class="ls0">hen child is blocked</span></div><div class="t m0 x50 h2e y62ab ff19 fs11 fc0 sc0 ls187c ws0">2p<span class="_ _327"></span><span class="ls0">arent r<span class="_ _0"></span>esumes</span></div><div class="t m0 x84 h2e y62ac ff19 fs11 fc0 sc0 ls0 ws0">3</div><div class="t m0 xdb h2e y62ad ff19 fs11 fc0 sc0 ls187d ws0">2t<span class="_ _9d"></span><span class="ls0">hen parent is blocked</span></div><div class="t m0 x84 h2e y62ae ff19 fs11 fc0 sc0 ls0 ws0">4</div><div class="t m0 xdb h2e y62af ff19 fs11 fc0 sc0 ls0 ws0">3</div><div class="t m0 xa7 h2e y62b0 ff19 fs11 fc0 sc0 ls187b ws0">5t<span class="_ _326"></span><span class="ls0">hen child is blocked</span></div><div class="t m0 x50 h2e y62b1 ff19 fs11 fc0 sc0 ls187c ws0">4p<span class="_ _327"></span><span class="ls0">arent r<span class="_ _0"></span>esumes</span></div><div class="t m0 x161 h2f y62b2 ff18 fs12 fc0 sc0 ls0 ws0">Figure C.21<span class="_ _5a"> </span><span class="ff19">Alternation between parent and child in Figur<span class="ls38a">e1<span class="_ _5"></span><span class="ls0">5.33</span></span></span></div><div class="t m0 x35 h5a y62b3 ff16 fs29 fc0 sc0 ls0 ws0">Chapter <span class="_"> </span>16</div><div class="t m0 x32 h50 y62b4 ff18 fs29 fc0 sc0 ls0 ws0">16.1<span class="_ _210"> </span><span class="ff19">Figur<span class="lsdd">eC<span class="_ _d"></span><span class="ls0">.22 shows a program that prints the system’s byte order<span class="_ _6"></span>.</span></span></span></div><div class="t m0 xe2 h65 y62b5 ff1a fs32 fc0 sc0 ls0 ws0">#include &lt;stdio.h&gt;</div><div class="t m0 xe2 h65 y62b6 ff1a fs32 fc0 sc0 ls0 ws0">#include &lt;stdlib.h&gt;</div><div class="t m0 xe2 h65 y62b7 ff1a fs32 fc0 sc0 ls0 ws0">#include &lt;inttypes.h&gt;</div><div class="t m0 xe2 h65 y62b8 ff1a fs32 fc0 sc0 ls0 ws0">int</div><div class="t m0 xe2 h65 y62b9 ff1a fs32 fc0 sc0 ls0 ws0">main(void)</div><div class="t m0 xe2 h65 y62ba ff1a fs32 fc0 sc0 ls0 ws0">{</div><div class="t m0 x60 h65 y62bb ff1a fs32 fc0 sc0 ls0 ws0">uint32_t <span class="_ _b7"> </span>i<span class="_"> </span><span class="ls441">=0<span class="_ _5b"></span><span class="ls0">x04030201;</span></span></div><div class="t m0 x60 h65 y62bc ff1a fs32 fc0 sc0 ls0 ws0">unsigned char<span class="_ _68"> </span>*cp = (unsigned char *)&amp;i;</div><div class="t m0 x60 h65 y62bd ff1a fs32 fc0 sc0 ls0 ws0">if (*cp == 1)</div><div class="t m0 xb9 h65 y62be ff1a fs32 fc0 sc0 ls0 ws0">printf(&quot;little-endian\n&quot;);</div><div class="t m0 x60 h65 y62bf ff1a fs32 fc0 sc0 ls0 ws0">else if (*cp == 4)</div><div class="t m0 xb9 h65 y62c0 ff1a fs32 fc0 sc0 ls0 ws0">printf(&quot;big-endian\n&quot;);</div><div class="t m0 x60 h65 y62c1 ff1a fs32 fc0 sc0 ls0 ws0">else</div><div class="t m0 xb9 h65 y62c2 ff1a fs32 fc0 sc0 ls0 ws0">printf(&quot;who knows?\n&quot;);</div><div class="t m0 x60 h65 y62c3 ff1a fs32 fc0 sc0 ls0 ws0">exit(0);</div><div class="t m0 xe2 h65 y62c4 ff1a fs32 fc0 sc0 ls0 ws0">}</div><div class="t m0 xee h31 y62c5 ff18 fs14 fc0 sc0 ls0 ws0">Figure C.22<span class="_ _5a"> </span><span class="ff19">Determine byte order on system</span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
