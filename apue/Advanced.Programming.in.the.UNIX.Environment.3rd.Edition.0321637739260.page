<div id="pf104" class="pf w4 h1f" data-page-no="104"><div class="pc pc104 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg104.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">226<span class="_ _1b"> </span><span class="ff19">Process <span class="_"> </span>Envir<span class="_ _0"></span>onment <span class="_ _1c1"> </span>Chapter<span class="_ _44"> </span>7</span></div><div class="t m0 x32 h53 y12f ff16 fs2b fc0 sc0 ls0 ws0">Exer<span class="_ _0"></span>cises</div><div class="t m0 x32 h5f y1e2d ff18 fs2d fc0 sc0 ls0 ws0">7.1<span class="_ _6e"> </span><span class="ff19">On <span class="_ _9"></span>an <span class="_ _9"></span>Intel <span class="_ _9"></span>x86 <span class="_ _9"></span>system <span class="_ _9"></span>under <span class="_ _9"></span>Linux, <span class="_ _9"></span>if <span class="_ _9"></span>we <span class="_ _9"></span>execute <span class="_ _9"></span>the <span class="_ _9"></span>program <span class="_ _3"></span>that <span class="_ _9"></span>prints <span class="_ _9"></span>‘<span class="_ _0"></span>‘hello, <span class="_ _9"></span>world’<span class="_ _0"></span>’</span></div><div class="t m0 x90 h57 y1e2e ff19 fs2d fc0 sc0 ls0 ws0">and <span class="_ _23"> </span>do <span class="_ _42"> </span>not <span class="_ _23"> </span>call<span class="_ _35"> </span><span class="ff1a">exit<span class="_ _35"> </span></span>or<span class="_ _45"> </span><span class="ff1a">return</span><span class="ls907">,t<span class="_ _b"></span><span class="ls0">he <span class="_ _23"> </span>termination <span class="_ _42"> </span>status <span class="_ _23"> </span>of <span class="_ _42"> </span>the <span class="_ _23"> </span>program <span class="_ _4"></span>— <span class="_ _a"></span>which<span class="_ _35"> </span>we <span class="_ _23"> </span>can</span></span></div><div class="t m0 x90 h5f y1e2f ff19 fs2d fc0 sc0 ls0 ws0">examine with the shell<span class="_ _3"></span><span class="ls908">—i<span class="_ _1"></span><span class="ls110">s1<span class="_ _5"></span><span class="ls0">3. <span class="_"> </span>Why?</span></span></span></div><div class="t m0 x32 h57 y1e30 ff18 fs2d fc0 sc0 ls0 ws0">7.2<span class="_ _6e"> </span><span class="ff19">When is the output from the<span class="_"> </span><span class="ff1a">printf</span>s<span class="_"> </span>in<span class="_"> </span>Figur<span class="ls110">e7<span class="_ _d"></span><span class="ls0">.3 actually output?</span></span></span></div><div class="t m0 x32 h57 y1e31 ff18 fs2d fc0 sc0 ls0 ws0">7.3<span class="_ _6e"> </span><span class="ff19">Is <span class="_ _80"> </span>ther<span class="ls909">ea<span class="_ _55"></span><span class="ls0">ny <span class="_"> </span>way <span class="_ _80"> </span>for <span class="_ _80"> </span>a <span class="_ _66"> </span>function <span class="_"> </span>that <span class="_"> </span>is <span class="_ _66"> </span>called <span class="_"> </span>by<span class="_ _59"> </span><span class="ff1a">main<span class="_ _4b"> </span></span>to <span class="_ _80"> </span>examine <span class="_ _80"> </span>the <span class="_ _66"> </span>command</span></span></span></div><div class="t m0 x1f1 h5f y1e32 ff19 fs2d fc0 sc0 ls0 ws0">-</div><div class="t m0 x42 h5f y1e31 ff19 fs2d fc0 sc0 ls0 ws0">line</div><div class="t m0 x90 h57 y1e33 ff19 fs2d fc0 sc0 ls0 ws0">arguments <span class="_ _2"></span>without <span class="_ _3"></span>(a) <span class="_ _3"></span>passing<span class="_ _47"> </span><span class="ff1a">argc<span class="_ _66"> </span></span>and<span class="_ _47"> </span><span class="ff1a">argv<span class="_ _66"> </span></span>as <span class="_ _3"></span>arguments <span class="_ _2"></span>from<span class="_ _66"> </span><span class="ff1a">main<span class="_ _47"> </span></span>to <span class="_ _3"></span>the <span class="_ _3"></span>function <span class="_ _3"></span>or</div><div class="t m0 x90 h57 y1e34 ff19 fs2d fc0 sc0 ls0 ws0">(b) having<span class="_"> </span><span class="ff1a">main<span class="_ _e"> </span></span>copy<span class="_"> </span><span class="ff1a">argc<span class="_ _80"> </span></span>and<span class="_"> </span><span class="ff1a">argv<span class="_ _80"> </span></span>into global variables?</div><div class="t m0 x32 h5f y1e35 ff18 fs2d fc0 sc0 ls0 ws0">7.4<span class="_ _6e"> </span><span class="ff19">Some <span class="_ _3"></span>UNIX <span class="_ _9"></span>system <span class="_ _3"></span>implementations <span class="_ _3"></span>purposely <span class="_ _3"></span>arrange <span class="_ _9"></span>that, <span class="_ _3"></span>when <span class="_ _3"></span>a <span class="_ _3"></span>program <span class="_ _3"></span>is <span class="_ _3"></span>executed,</span></div><div class="t m0 x90 h5f y1e36 ff19 fs2d fc0 sc0 ls0 ws0">location 0 in the data segment is not accessible.<span class="_ _4b"> </span>Why?</div><div class="t m0 x32 h57 y1e37 ff18 fs2d fc0 sc0 ls0 ws0">7.5<span class="_ _6e"> </span><span class="ff19">Use <span class="_ _42"> </span>the<span class="_ _35"> </span><span class="ff1a">typedef<span class="_ _45"> </span></span>facility <span class="_ _42"> </span>of <span class="_ _42"> </span>C <span class="_ _23"> </span>to <span class="_ _42"> </span>deﬁne <span class="_ _42"> </span>a <span class="_ _42"> </span>new <span class="_ _23"> </span>data <span class="_ _42"> </span>type<span class="_ _35"> </span><span class="ff1a">Exitfunc<span class="_ _45"> </span></span>for <span class="_ _42"> </span>an <span class="_ _42"> </span>exit <span class="_ _23"> </span>handler<span class="_ _1"></span>.</span></div><div class="t m0 x90 h57 y1e38 ff19 fs2d fc0 sc0 ls0 ws0">Redo the prototype for<span class="_"> </span><span class="ff1a">atexit<span class="_ _e"> </span></span>using this data type.</div><div class="t m0 x32 h57 y1e39 ff18 fs2d fc0 sc0 ls0 ws0">7.6<span class="_ _6e"> </span><span class="ff19">If we allocate an array of<span class="_"> </span><span class="ff1a">long</span><span class="ls90a">su<span class="_ _84"></span><span class="ls0">sing<span class="_"> </span><span class="ff1a">calloc</span>,<span class="_"> </span>is<span class="_"> </span>the array initialized to 0?<span class="_ _4b"> </span>If we allocate an</span></span></span></div><div class="t m0 x90 h57 y1e3a ff19 fs2d fc0 sc0 ls0 ws0">array of pointers using<span class="_"> </span><span class="ff1a">calloc</span>,<span class="_"> </span>is<span class="_"> </span>the array initialized to null pointers?</div><div class="t m0 x32 h57 y1e3b ff18 fs2d fc0 sc0 ls0 ws0">7.7<span class="_ _6e"> </span><span class="ff19">In <span class="_ _2"></span>the <span class="_ _3"></span>output <span class="_ _2"></span>from the<span class="_ _66"> </span><span class="ff1a">size<span class="_ _66"> </span></span>command <span class="_ _2"></span>at <span class="_ _2"></span>the <span class="_ _2"></span>end <span class="_ _2"></span>of <span class="_ _3"></span>Section <span class="_ _2"></span>7.6, <span class="_ _2"></span>why <span class="_ _2"></span>aren’t <span class="_ _2"></span>any <span class="_ _2"></span>sizes <span class="_ _2"></span>given</span></div><div class="t m0 x90 h5f y1e3c ff19 fs2d fc0 sc0 ls0 ws0">for the heap and the stack?</div><div class="t m0 x32 h5f y1e3d ff18 fs2d fc0 sc0 ls0 ws0">7.8<span class="_ _6e"> </span><span class="ff19">In <span class="_ _9"></span>Section <span class="_ _3"></span>7.7, <span class="_ _9"></span>the <span class="_ _9"></span>two <span class="_ _3"></span>ﬁle <span class="_ _9"></span>sizes</span></div><div class="t m0 xed h5f y1e3e ff19 fs2d fc0 sc0 ls0 ws0">(</div><div class="t m0 xd h5f y1e3d ff19 fs2d fc0 sc0 ls0 ws0">879443 <span class="_ _3"></span>and <span class="_ _9"></span>8378</div><div class="t m0 x1d3 h5f y1e3e ff19 fs2d fc0 sc0 ls0 ws0">)</div><div class="t m0 x187 h5f y1e3d ff19 fs2d fc0 sc0 ls0 ws0">don’t <span class="_ _3"></span>equal <span class="_ _9"></span>the <span class="_ _3"></span>sums <span class="_ _9"></span>of <span class="_ _9"></span>their <span class="_ _3"></span>respective</div><div class="t m0 x90 h5f y1e3f ff19 fs2d fc0 sc0 ls0 ws0">text and data sizes.<span class="_ _4b"> </span>Why?</div><div class="t m0 x32 h5f y1e40 ff18 fs2d fc0 sc0 ls0 ws0">7.9<span class="_ _6e"> </span><span class="ff19">In <span class="_ _9"></span>Section <span class="_ _9"></span>7.7, <span class="_ _9"></span>why <span class="_ _9"></span>does <span class="_ _9"></span>the <span class="_ _9"></span>size <span class="_ _3"></span>of <span class="_ _9"></span>the <span class="_ _9"></span>executable <span class="_ _9"></span>ﬁle <span class="_ _9"></span>differ <span class="_ _3"></span>so <span class="_ _9"></span>dramatically <span class="_ _9"></span>when <span class="_ _9"></span>we <span class="_ _9"></span>use</span></div><div class="t m0 x90 h5f y1e41 ff19 fs2d fc0 sc0 ls0 ws0">shared libraries for such a trivial pr<span class="_ _0"></span>ogram?</div><div class="t m0 x32 h5f y1e42 ff18 fs2d fc0 sc0 ls0 ws0">7.10<span class="_ _60"> </span><span class="ff19">At <span class="_ _2"></span>the end <span class="_ _2"></span>of <span class="_ _2"></span>Section 7.10, <span class="_ _2"></span>we showed <span class="_ _2"></span>how <span class="_ _2"></span>a function <span class="_ _2"></span>can’t <span class="_ _2"></span>return a pointer <span class="_ _2"></span>to an <span class="_ _2"></span>automatic</span></div><div class="t m0 x90 h5f y1e43 ff19 fs2d fc0 sc0 ls0 ws0">variable. <span class="_"> </span>Is<span class="_"> </span>the following code correct?</div><div class="t m0 x90 h4e y1e44 ff1a fs28 fc0 sc0 ls0 ws0">int</div><div class="t m0 x90 h4e y1e45 ff1a fs28 fc0 sc0 ls0 ws0">f1(int val)</div><div class="t m0 x90 h4e y1e46 ff1a fs28 fc0 sc0 ls0 ws0">{</div><div class="t m0 x1c h4e y1e47 ff1a fs28 fc0 sc0 ls0 ws0">int <span class="_ _15"> </span>num<span class="_"> </span><span class="ls1b6">=0<span class="_ _1d"></span><span class="ls0">;</span></span></div><div class="t m0 x1c h4e y1e48 ff1a fs28 fc0 sc0 ls0 ws0">int <span class="_ _15"> </span>*ptr<span class="_"> </span><span class="ls1b6">=&amp;<span class="_ _1d"></span><span class="ls0">num;</span></span></div><div class="t m0 x1c h4e y1e49 ff1a fs28 fc0 sc0 ls0 ws0">if (val == 0) {</div><div class="t m0 xb0 h4e y1e4a ff1a fs28 fc0 sc0 ls0 ws0">int <span class="_ _15"> </span>val;</div><div class="t m0 xb0 h4e y1e4b ff1a fs28 fc0 sc0 ls0 ws0">val = 5;</div><div class="t m0 xb0 h4e y1e4c ff1a fs28 fc0 sc0 ls0 ws0">ptr = &amp;val;</div><div class="t m0 x1c h4e y1e4d ff1a fs28 fc0 sc0 ls0 ws0">}</div><div class="t m0 x1c h4e y1e4e ff1a fs28 fc0 sc0 ls0 ws0">return(*ptr + 1);</div><div class="t m0 x90 h4e y1e4f ff1a fs28 fc0 sc0 ls0 ws0">}</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
