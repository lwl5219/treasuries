<div id="pf111" class="pf w4 h1f" data-page-no="111"><div class="pc pc111 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg111.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h7a ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>8.6<span class="_ _225"> </span><span class="ff1a">wait<span class="_ _4b"> </span></span>and<span class="_ _4b"> </span><span class="ff1a">waitpid<span class="_ _4b"> </span></span>Functions<span class="_ _1b"> </span><span class="ff18">239</span></div><div class="t m0 x3f h2b y12f ff19 fsf fc0 sc0 ls0 ws0">For both functions, the argument<span class="_"> </span><span class="ff1b">statloc<span class="_"> </span></span>is a pointer to an integer<span class="_ _6"></span><span class="ls992">.I<span class="_ _4a"></span><span class="ls993">ft<span class="_ _d"></span><span class="ls0">his argument is</span></span></span></div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">not <span class="_ _e"> </span>a <span class="_"> </span>null <span class="_ _53"> </span>pointer<span class="_ _1"></span><span class="ls994">,t<span class="_ _55"></span><span class="ls0">he <span class="_ _e"> </span>termination <span class="_ _e"> </span>status <span class="_"> </span>of <span class="_ _53"> </span>the <span class="_"> </span>terminated <span class="_ _53"> </span>process <span class="_ _e"> </span>is <span class="_"> </span>stor<span class="_ _1"></span>ed <span class="_"> </span>in <span class="_ _53"> </span>the</span></span></div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">location <span class="_ _3"></span>pointed <span class="_ _9"></span>to <span class="_ _3"></span>by <span class="_ _9"></span>the <span class="_ _3"></span>argument. <span class="_ _47"> </span>If<span class="_ _45"> </span>we <span class="_ _3"></span>don’t <span class="_ _9"></span>car<span class="ls92b">ea<span class="_ _b"></span><span class="ls0">bout <span class="_ _3"></span>the <span class="_ _9"></span>termination <span class="_ _3"></span>status, <span class="_ _9"></span>we</span></span></div><div class="t m0 x32 h2a y132 ff19 fsf fc0 sc0 ls0 ws0">simply pass a null pointer as this argument.</div><div class="t m0 x3f h2a y133 ff19 fsf fc0 sc0 lsbc ws0">Tr<span class="_ _9"></span><span class="ls0">aditionally<span class="_ _4"></span><span class="ls995">,t<span class="_ _4f"></span><span class="ls0">he <span class="_ _3"></span>integer <span class="_ _3"></span>status <span class="_ _2"></span>that <span class="_ _3"></span>these <span class="_ _3"></span>two <span class="_ _3"></span>functions <span class="_ _2"></span>return <span class="_ _3"></span>has <span class="_ _2"></span>been <span class="_ _3"></span>deﬁned <span class="_ _3"></span>by</span></span></span></div><div class="t m0 x32 h2a y134 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _42"> </span>implementation, <span class="_ _42"> </span>with <span class="_ _42"> </span>certain <span class="_ _53"> </span>bits <span class="_ _42"> </span>indicating <span class="_ _42"> </span>the <span class="_ _42"> </span>exit <span class="_ _53"> </span>status <span class="_ _42"> </span>(for <span class="_ _42"> </span>a <span class="_ _53"> </span>normal <span class="_ _42"> </span>return),</div><div class="t m0 x32 h2a y135 ff19 fsf fc0 sc0 ls0 ws0">other <span class="_ _e"> </span>bits <span class="_ _e"> </span>indicating <span class="_ _e"> </span>the <span class="_"> </span>signal <span class="_ _53"> </span>number <span class="_ _e"> </span>(for <span class="_"> </span>an <span class="_ _53"> </span>abnormal <span class="_ _e"> </span>return), <span class="_ _e"> </span>one <span class="_ _e"> </span>bit <span class="_"> </span>indicating</div><div class="t m0 x32 h2a y136 ff19 fsf fc0 sc0 ls0 ws0">whether <span class="_ _42"> </span>a <span class="_ _23"> </span>cor<span class="ls996">eﬁ<span class="_ _43"></span><span class="ls0">le <span class="_ _23"> </span>was <span class="_ _42"> </span>generated, <span class="_ _42"> </span>and <span class="_ _42"> </span>so <span class="_ _42"> </span>on.<span class="_ _51"> </span>POSIX.1 <span class="_ _42"> </span>speciﬁes <span class="_ _42"> </span>that <span class="_ _42"> </span>the <span class="_ _23"> </span>termination</span></span></div><div class="t m0 x32 h26 y137 ff19 fsf fc0 sc0 ls0 ws0">status is <span class="_ _2"></span>to <span class="_ _2"></span>be <span class="_ _2"></span>looked <span class="_ _2"></span>at <span class="_ _2"></span>using <span class="_ _2"></span>various <span class="_ _2"></span>macros that <span class="_ _2"></span>ar<span class="ls47d">ed<span class="_ _4f"></span><span class="ls0">eﬁned <span class="_ _2"></span>in<span class="_ _66"> </span><span class="ff1a">&lt;sys/wait.h&gt;</span><span class="ls367">.F<span class="_ _5b"></span><span class="ls0">our</span></span></span></span></div><div class="t m0 x32 h2a y138 ff19 fsf fc0 sc0 ls0 ws0">mutually <span class="_ _9"></span>exclusive <span class="_ _3"></span>macros <span class="_ _9"></span>tell <span class="_ _9"></span>us <span class="_ _9"></span>how <span class="_ _3"></span>the <span class="_ _9"></span>process <span class="_ _9"></span>terminated, <span class="_ _3"></span>and <span class="_ _9"></span>they <span class="_ _9"></span>all <span class="_ _9"></span>begin <span class="_ _9"></span>with</div><div class="t m0 x32 h26 y139 ff1a fsf fc0 sc0 ls0 ws0">WIF<span class="ff19 ls997">.B<span class="_ _62"></span><span class="ls0">ased <span class="_ _9"></span>on <span class="_ _3"></span>which <span class="_ _9"></span>of <span class="_ _9"></span>these <span class="_ _9"></span>four <span class="_ _3"></span>macros <span class="_ _3"></span>is <span class="_ _9"></span>true, <span class="_ _9"></span>other <span class="_ _3"></span>macros <span class="_ _3"></span>ar<span class="ls87e">eu<span class="_ _b"></span><span class="ls0">sed <span class="_ _9"></span>to <span class="_ _9"></span>obtain <span class="_ _9"></span>the</span></span></span></span></div><div class="t m0 x32 h2a y13a ff19 fsf fc0 sc0 ls0 ws0">exit <span class="_ _2"></span>status, <span class="_ _3"></span>signal <span class="_ _3"></span>number<span class="_ _6"></span><span class="ls8c3">,a<span class="_ _4f"></span><span class="ls0">nd <span class="_ _3"></span>the <span class="_ _2"></span>like.<span class="_ _16"> </span>The <span class="_ _3"></span>four <span class="_ _2"></span>mutually <span class="_ _3"></span>exclusive <span class="_ _3"></span>macros <span class="_ _2"></span>ar<span class="ls77">es<span class="_ _8"></span><span class="ls0">hown</span></span></span></span></div><div class="t m0 x32 h2a y254 ff19 fsf fc0 sc0 ls0 ws0">in Figur<span class="ls44">e8<span class="_ _4f"></span><span class="ls0">.4.</span></span></div><div class="t m0 x60 h2d y1f9e ff19 fs10 fc0 sc0 ls0 ws0">Macr<span class="ls998">oD<span class="_ _226"></span><span class="ls0">escription</span></span></div><div class="t m0 xf7 h4f y1f9f ff1a fs11 fc0 sc0 ls0 ws0">WIFEXITED(<span class="ff1b">status</span>)<span class="_ _6c"> </span><span class="ff19 ls999">Tr <span class="_ _1"></span>u<span class="_ _9"></span><span class="ls0">e<span class="_"> </span>if<span class="_"> </span>status was returned for a child that terminated normally<span class="_ _4"></span><span class="ls99a">.I<span class="_ _43"></span><span class="lsdb">nt<span class="_ _84"></span><span class="ls0">his</span></span></span></span></span></div><div class="t m0 x1f7 h2e y1fa0 ff19 fs11 fc0 sc0 ls0 ws0">case, we can execute</div><div class="t m0 x146 h4f y1fa1 ff1a fs11 fc0 sc0 ls0 ws0">WEXITSTATUS(<span class="ff1b">status</span>)</div><div class="t m0 x1f7 h2e y1fa2 ff19 fs11 fc0 sc0 ls0 ws0">to fetch the low-order 8 bits of the ar<span class="_ _0"></span>gument that the child passed to</div><div class="t m0 x1f7 h4f y1fa3 ff1a fs11 fc0 sc0 ls0 ws0">exit<span class="ff19">,<span class="_"> </span></span>_exit<span class="ff19 lsdb">,o<span class="_ _84"></span><span class="ls0">r<span class="_"> </span><span class="ff1a">_Exit</span>.</span></span></div><div class="t m0 xf7 h6d y1fa4 ff1a fs12 fc0 sc0 ls0 ws0">WIFSIGNALED(<span class="ff1b">status</span>)<span class="_ _75"> </span><span class="ff19 ls425">Tr <span class="_ _1"></span>u<span class="_ _3"></span><span class="ls0">e<span class="_"> </span>if<span class="_"> </span>status was returned for a child that terminated abnormally<span class="_ _6"></span><span class="ls38a">,b<span class="_ _84"></span><span class="ls0">y</span></span></span></span></div><div class="t m0 x1f7 h2f y1fa5 ff19 fs12 fc0 sc0 ls222 ws0">re<span class="ls0">ceipt of a signal that it didn’t catch.<span class="_ _44"> </span>In this case, we can execute</span></div><div class="t m0 x146 h6d y1fa6 ff1a fs12 fc0 sc0 ls0 ws0">WTERMSIG(<span class="ff1b">status</span>)</div><div class="t m0 x1f7 h2f y1fa7 ff19 fs12 fc0 sc0 ls0 ws0">to fetch the signal number that caused the termination.</div><div class="t m0 x1f7 h2f y1fa8 ff19 fs12 fc0 sc0 ls0 ws0">Additionally<span class="_ _6"></span><span class="ls38a">,s<span class="_ _84"></span><span class="ls0">ome implementations (but not the Single UNIX</span></span></div><div class="t m0 x1f7 h2f y1fa9 ff19 fs12 fc0 sc0 ls0 ws0">Speciﬁcation) deﬁne the macro</div><div class="t m0 x146 h6d y1faa ff1a fs12 fc0 sc0 ls0 ws0">WCOREDUMP(<span class="ff1b">status</span>)</div><div class="t m0 x1f7 h2f y1fab ff19 fs12 fc0 sc0 ls0 ws0">that returns true if a cor<span class="_ _0"></span><span class="ls38a">eﬁ<span class="_ _5"></span><span class="ls0">le of the terminated process was generated.</span></span></div><div class="t m0 xf7 h63 y1fac ff1a fs13 fc0 sc0 ls0 ws0">WIFSTOPPED(<span class="ff1b">status</span>)<span class="_ _15"> </span><span class="ff19 ls30e">Tr <span class="_ _1"></span>u<span class="_ _3"></span><span class="ls0">e<span class="_"> </span>if<span class="_"> </span>status was returned for a child that is currently stopped.<span class="_ _35"> </span>In this</span></span></div><div class="t m0 x1f7 h30 y1fad ff19 fs13 fc0 sc0 ls0 ws0">case, we can execute</div><div class="t m0 x146 h63 y1fae ff1a fs13 fc0 sc0 ls0 ws0">WSTOPSIG(<span class="ff1b">status</span>)</div><div class="t m0 x1f7 h30 y1faf ff19 fs13 fc0 sc0 ls0 ws0">to fetch the signal number that caused the child to stop.</div><div class="t m0 xf7 h6f y1fb0 ff1a fs14 fc0 sc0 ls0 ws0">WIFCONTINUED(<span class="ff1b">status</span>)<span class="_ _6e"> </span><span class="ff19 ls99b">Tr <span class="_ _1"></span>u<span class="_ _3"></span><span class="ls0">e<span class="_"> </span>if<span class="_"> </span>status was returned for a child that has been continued after a</span></span></div><div class="t m0 x1f7 h6f y1fb1 ff19 fs14 fc0 sc0 ls0 ws0">job control stop (XSI option;<span class="_"> </span><span class="ff1a">waitpid<span class="_ _53"> </span></span>only).</div><div class="t m0 x9d h66 y1fb2 ff18 fs15 fc0 sc0 ls0 ws0">Figure 8.4<span class="_ _5a"> </span><span class="ff19">Macros to examine the termination status returned by<span class="_"> </span><span class="ff1a">wait<span class="_ _53"> </span></span>and<span class="_"> </span><span class="ff1a">waitpid</span></span></div><div class="t m0 x32 h67 y1fb3 ff19 fs33 fc0 sc0 ls1d9 ws0">We<span class="_ _9"></span><span class="ls0">’ll discuss how a process can be stopped in Section 9.8 when we discuss job contr<span class="_ _0"></span>ol.</span></div><div class="t m0 x35 hf8 y1fb4 ff16 fs33 fc0 sc0 ls0 ws0">Example</div><div class="t m0 x32 h68 y1fb5 ff19 fs33 fc0 sc0 ls0 ws0">The <span class="_ _45"> </span>function<span class="_ _16"> </span><span class="ff1a">pr_exit<span class="_"> </span></span>in <span class="_ _45"> </span>Figur<span class="_ _0"></span><span class="ls99c">e8<span class="_ _62"></span><span class="ls0">.5 <span class="_ _45"> </span>uses <span class="_ _47"> </span>the <span class="_ _45"> </span>macros <span class="_ _47"> </span>from <span class="_ _45"> </span>Figur<span class="ls99d">e8<span class="_ _26"></span><span class="ls0">.4 <span class="_ _45"> </span>to <span class="_ _45"> </span>print <span class="_ _47"> </span>a</span></span></span></span></div><div class="t m0 x32 h67 y1fb6 ff19 fs33 fc0 sc0 ls0 ws0">description <span class="_ _3"></span>of <span class="_ _3"></span>the <span class="_ _3"></span>termination <span class="_ _9"></span>status.<span class="_ _16"> </span><span class="ls1d9">We<span class="_ _9"></span></span>’ll <span class="_ _3"></span>call <span class="_ _9"></span>this <span class="_ _3"></span>function <span class="_ _3"></span>from <span class="_ _3"></span>numerous <span class="_ _2"></span>programs</div><div class="t m0 x32 h68 y1fb7 ff19 fs33 fc0 sc0 ls0 ws0">in the text.<span class="_ _59"> </span>Note that this function handles the<span class="_"> </span><span class="ff1a">WCOREDUMP<span class="_ _66"> </span></span>macro, if it is deﬁned.</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
