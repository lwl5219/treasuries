<div id="pf102" class="pf w4 h1f" data-page-no="102"><div class="pc pc102 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg102.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">224<span class="_ _1b"> </span><span class="ff19">Process <span class="_"> </span>Envir<span class="_ _0"></span>onment <span class="_ _1c1"> </span>Chapter<span class="_ _44"> </span>7</span></div><div class="t m0 x32 h57 y425 ff1a fs2d fc0 sc0 ls0 ws0">#endif</div><div class="t m0 x32 h57 y1334 ff1a fs2d fc0 sc0 ls0 ws0">#ifdef RLIMIT_SIGPENDING</div><div class="t m0 x8a h57 y1307 ff1a fs2d fc0 sc0 ls0 ws0">doit(RLIMIT_SIGPENDING);</div><div class="t m0 x32 h57 y1308 ff1a fs2d fc0 sc0 ls0 ws0">#endif</div><div class="t m0 x8a h57 y1309 ff1a fs2d fc0 sc0 ls0 ws0">doit(RLIMIT_STACK);</div><div class="t m0 x32 h57 y1de3 ff1a fs2d fc0 sc0 ls0 ws0">#ifdef RLIMIT_SWAP</div><div class="t m0 x8a h57 y1de4 ff1a fs2d fc0 sc0 ls0 ws0">doit(RLIMIT_SWAP);</div><div class="t m0 x32 h57 y1de5 ff1a fs2d fc0 sc0 ls0 ws0">#endif</div><div class="t m0 x32 h57 y1de6 ff1a fs2d fc0 sc0 ls0 ws0">#ifdef <span class="_"> </span>RLIMIT_VMEM</div><div class="t m0 x8a h57 y1de7 ff1a fs2d fc0 sc0 ls0 ws0">doit(RLIMIT_VMEM);</div><div class="t m0 x32 h57 y1de8 ff1a fs2d fc0 sc0 ls0 ws0">#endif</div><div class="t m0 x8a h57 y1de9 ff1a fs2d fc0 sc0 ls0 ws0">exit(0);</div><div class="t m0 x32 h57 y1dea ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y1deb ff1a fs2d fc0 sc0 ls0 ws0">static void</div><div class="t m0 x32 h57 y1dec ff1a fs2d fc0 sc0 ls0 ws0">pr_limits(char *name, int resource)</div><div class="t m0 x32 h57 y1ded ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y1dee ff1a fs2d fc0 sc0 ls0 ws0">struct rlimit<span class="_ _b7"> </span>limit;</div><div class="t m0 x8a h57 y1def ff1a fs2d fc0 sc0 ls0 ws0">unsigned long long<span class="_ _d9"> </span>lim;</div><div class="t m0 x8a h57 y1df0 ff1a fs2d fc0 sc0 ls0 ws0">if (getrlimit(resource, &amp;limit) &lt; 0)</div><div class="t m0 x9d h57 y1df1 ff1a fs2d fc0 sc0 ls0 ws0">err_sys(&quot;getrlimit error for %s&quot;, name);</div><div class="t m0 x8a h57 y1df2 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;%-14s <span class="_"> </span>&quot;,<span class="_"> </span>name);</div><div class="t m0 x8a h57 y1df3 ff1a fs2d fc0 sc0 ls0 ws0">if (limit.rlim_cur == RLIM_INFINITY) {</div><div class="t m0 x9d h57 y1df4 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;(infinite) <span class="_"> </span>&quot;);</div><div class="t m0 x8a h57 y1df5 ff1a fs2d fc0 sc0 ls15c ws0">}e<span class="_ _1d"></span><span class="ls0">lse {</span></div><div class="t m0 x9d h57 y1df6 ff1a fs2d fc0 sc0 ls0 ws0">lim = limit.rlim_cur;</div><div class="t m0 x9d h57 y1df7 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;%10lld <span class="_"> </span>&quot;,<span class="_"> </span>lim);</div><div class="t m0 x8a h57 y1df8 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x8a h57 y1df9 ff1a fs2d fc0 sc0 ls0 ws0">if (limit.rlim_max == RLIM_INFINITY) {</div><div class="t m0 x9d h57 y1dfa ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;(infinite)&quot;);</div><div class="t m0 x8a h57 y1dfb ff1a fs2d fc0 sc0 ls15c ws0">}e<span class="_ _1d"></span><span class="ls0">lse {</span></div><div class="t m0 x9d h57 y1dfc ff1a fs2d fc0 sc0 ls0 ws0">lim = limit.rlim_max;</div><div class="t m0 x9d h57 y1dfd ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;%10lld&quot;, lim);</div><div class="t m0 x8a h57 y1dfe ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x8a h57 y1dff ff1a fs2d fc0 sc0 ls0 ws0">putchar((int)’\n’);</div><div class="t m0 x32 h57 y1e00 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x27 h2d y1e01 ff18 fs10 fc0 sc0 ls0 ws0">Figure 7.16<span class="_ _5a"> </span><span class="ff19">Print the current resour<span class="_ _0"></span>ce limits</span></div><div class="t m0 x3f h4d y1e02 ff19 fs26 fc0 sc0 ls0 ws0">Note <span class="_ _9"></span>that <span class="_ _9"></span>we’ve <span class="_ _9"></span>used <span class="_ _9"></span>the <span class="_ _23"></span>ISO <span class="_ _9"></span>C <span class="_ _9"></span>string-creation <span class="_ _3"></span>operator <span class="_ _9"></span>(<span class="_ _2"></span><span class="ff1a">#</span>)<span class="_ _45"> </span>in<span class="_ _45"> </span>the<span class="_ _45"> </span><span class="ff1a">doit<span class="_ _45"> </span></span>macro, <span class="_ _3"></span>to</div><div class="t m0 x32 h49 y1e03 ff19 fs26 fc0 sc0 ls0 ws0">generate the string value for each resour<span class="_ _0"></span>ce name.<span class="_ _59"> </span>When we say</div><div class="t m0 x3f h4e y1e04 ff1a fs28 fc0 sc0 ls0 ws0">doit(RLIMIT_CORE);</div><div class="t m0 x32 h49 y1e05 ff19 fs26 fc0 sc0 ls0 ws0">the C prepr<span class="_ _0"></span>ocessor expands this into</div><div class="t m0 x3f h4e y1e06 ff1a fs28 fc0 sc0 ls0 ws0">pr_limits(&quot;RLIMIT_CORE&quot;, RLIMIT_CORE);</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
