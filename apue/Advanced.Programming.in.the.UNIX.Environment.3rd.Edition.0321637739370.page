<div id="pf172" class="pf w4 h1f" data-page-no="172"><div class="pc pc172 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg172.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">336<span class="_ _1b"> </span><span class="ff19">Signals <span class="_ _24b"> </span>Chapter<span class="_ _21"> </span>10</span></div><div class="t m0 x3f h2a y12f ff19 fsf fc0 sc0 ls0 ws0">What <span class="_ _23"></span>happens <span class="_ _23"> </span>if <span class="_ _23"> </span>a <span class="_ _23"> </span>blocked <span class="_ _42"> </span>signal <span class="_ _23"></span>is <span class="_ _23"></span>generated <span class="_ _23"> </span>mor<span class="lsc4e">et<span class="_ _43"></span><span class="ls0">han <span class="_ _23"> </span>once <span class="_ _23"> </span>befor<span class="lsc4f">et<span class="_ _43"></span><span class="ls0">he <span class="_ _23"> </span>process</span></span></span></span></div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">unblocks <span class="_ _53"> </span>the <span class="_ _53"> </span>signal?<span class="_ _65"> </span>POSIX.1 <span class="_ _53"> </span>allows <span class="_ _e"> </span>the <span class="_ _53"> </span>system <span class="_ _53"> </span>to <span class="_ _53"> </span>deliver <span class="_ _e"> </span>the <span class="_ _53"> </span>signal <span class="_ _53"> </span>either <span class="_ _53"> </span>once <span class="_ _e"> </span>or</div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">mor<span class="lsc50">et<span class="_ _4a"></span><span class="ls0">han <span class="_"> </span>once.<span class="_ _65"> </span>If <span class="_ _e"> </span>the <span class="_"> </span>system <span class="_ _53"> </span>delivers <span class="_"> </span>the <span class="_ _53"> </span>signal <span class="_"> </span>mor<span class="_ _1"></span><span class="lsc50">et<span class="_ _55"></span><span class="ls0">han <span class="_"> </span>once, <span class="_ _53"> </span>we <span class="_"> </span>say <span class="_ _53"> </span>that <span class="_"> </span>the</span></span></span></span></div><div class="t m0 x32 h2b y132 ff19 fsf fc0 sc0 ls0 ws0">signals <span class="_ _42"> </span>ar<span class="lsc51">eq<span class="_ _c"></span><span class="ls0">ueued. <span class="_ _44"> </span>Most<span class="_ _44"> </span>UNIX <span class="_ _53"> </span>systems, <span class="_ _53"> </span>however<span class="_ _6"></span><span class="lsc51">,d<span class="_ _43"></span><span class="ls0">o<span class="_ _44"> </span><span class="ff1b">not<span class="_ _44"> </span></span>queue <span class="_ _42"> </span>signals <span class="_ _53"> </span>unless <span class="_ _42"> </span>they</span></span></span></span></div><div class="t m0 x32 h2a y133 ff19 fsf fc0 sc0 ls0 ws0">support <span class="_ _3"></span>the <span class="_ _9"></span>real-time <span class="_ _3"></span>extensions <span class="_ _9"></span>to <span class="_ _9"></span>POSIX.1.<span class="_ _5a"> </span>Instead, <span class="_ _3"></span>the <span class="_ _9"></span>UNIX <span class="_ _9"></span>kernel <span class="_ _9"></span>simply <span class="_ _9"></span>delivers</div><div class="t m0 x32 h2a y134 ff19 fsf fc0 sc0 ls0 ws0">the signal once.</div><div class="t m0 x76 h51 y736 ff19 fs2a fc0 sc0 ls341 ws0">Wi<span class="_ _2"></span><span class="ls0">th <span class="_ _2"></span>SUSv4, <span class="_ _2"></span>the <span class="_ _2"></span>real-time signal <span class="_ _2"></span>functionality <span class="_ _2"></span>moved <span class="_ _2"></span>from the <span class="_ _2"></span>real-time extensions <span class="_ _2"></span>to <span class="_ _2"></span>the <span class="_ _2"></span>base</span></div><div class="t m0 x76 h51 ybc5 ff19 fs2a fc0 sc0 ls0 ws0">speciﬁcation. <span class="_ _80"> </span>As<span class="_ _80"> </span>time <span class="_ _2"></span>goes <span class="_ _3"></span>on, <span class="_ _2"></span>mor<span class="lsc52">es<span class="_ _d"></span><span class="ls0">ystems <span class="_ _3"></span>will <span class="_ _2"></span>support <span class="_ _3"></span>queueing <span class="_ _2"></span>signals <span class="_ _3"></span>even <span class="_ _2"></span>if <span class="_ _2"></span>they <span class="_ _3"></span>don’t</span></span></div><div class="t m0 x76 h51 ybc6 ff19 fs2a fc0 sc0 ls0 ws0">support the real-time extensions.<span class="_ _35"> </span><span class="lsed">We <span class="_ _42"> </span>d<span class="_ _3"></span></span>iscuss queueing signals further in Section 10.20.</div><div class="t m0 x76 h52 y2b0c ff19 fs2a fc0 sc0 ls0 ws0">The manual pages for SVR2 claimed <span class="_ _2"></span>that the<span class="_"> </span><span class="ff1a">SIGCLD<span class="_ _e"> </span></span>signal was queued <span class="_ _2"></span>while the process was</div><div class="t m0 x76 h52 y2b0d ff19 fs2a fc0 sc0 ls0 ws0">executing <span class="_ _23"> </span>its<span class="_ _35"> </span><span class="ff1a">SIGCLD<span class="_ _45"> </span></span>signal <span class="_ _23"> </span>handler<span class="_ _1"></span><span class="lsc53">.A<span class="_ _5b"></span><span class="ls0">lthough <span class="_ _42"> </span>this <span class="_ _23"> </span>might <span class="_ _42"> </span>have <span class="_ _42"> </span>been <span class="_ _23"> </span>true <span class="_ _42"> </span>on <span class="_ _42"> </span>a <span class="_ _23"> </span>conceptual</span></span></div><div class="t m0 x76 h51 y2b0e ff19 fs2a fc0 sc0 ls0 ws0">level, <span class="_ _42"> </span>the <span class="_ _42"> </span>actual <span class="_"> </span>implementation <span class="_ _23"> </span>was <span class="_"> </span>dif<span class="_ _0"></span>ferent. <span class="_ _45"> </span>Instead,<span class="_ _45"> </span>the <span class="_"> </span>signal <span class="_ _42"> </span>was <span class="_ _42"> </span>regenerated <span class="_ _42"> </span>by <span class="_ _42"> </span>the</div><div class="t m0 x76 h51 y2b0f ff19 fs2a fc0 sc0 ls0 ws0">kernel <span class="_ _2"></span>as <span class="_ _3"></span>we <span class="_ _3"></span>described <span class="_ _3"></span>in <span class="_ _3"></span>Section <span class="_ _3"></span>10.7.<span class="_ _4b"> </span>In <span class="_ _3"></span>SVR3, <span class="_ _3"></span>the <span class="_ _3"></span>manual <span class="_ _3"></span>was <span class="_ _3"></span>changed <span class="_ _3"></span>to <span class="_ _3"></span>indicate <span class="_ _3"></span>that <span class="_ _3"></span>the</div><div class="t m0 x76 h52 y2b10 ff1a fs2a fc0 sc0 ls0 ws0">SIGCLD<span class="_ _47"> </span><span class="ff19">signal <span class="_ _23"> </span>was <span class="_ _23"> </span>ignored <span class="_ _9"> </span>while <span class="_ _23"> </span>the <span class="_ _23"> </span>process <span class="_ _23"> </span>was <span class="_ _9"> </span>executing <span class="_ _23"> </span>its <span class="_ _23"> </span>signal <span class="_ _23"> </span>handler <span class="_ _23"> </span>for<span class="_ _47"> </span></span>SIGCLD<span class="ff19">.</span></div><div class="t m0 x76 h52 y2b11 ff19 fs2a fc0 sc0 ls0 ws0">The <span class="_ _66"> </span>SVR4 <span class="_ _47"> </span>manual <span class="_ _66"> </span>removed <span class="_ _66"> </span>any <span class="_ _66"> </span>mention <span class="_ _47"> </span>of <span class="_ _66"> </span>what <span class="_ _66"> </span>happens <span class="_ _47"> </span>to<span class="_ _59"> </span><span class="ff1a">SIGCLD<span class="_"> </span></span>signals <span class="_ _66"> </span>that <span class="_ _66"> </span>are</div><div class="t m0 x76 h52 y2b12 ff19 fs2a fc0 sc0 ls0 ws0">generated while a process is executing its<span class="_"> </span><span class="ff1a">SIGCLD<span class="_ _53"> </span></span>signal handler<span class="_ _1"></span>.</div><div class="t m0 x76 h52 y2b13 ff19 fs2a fc0 sc0 ls0 ws0">The <span class="_ _42"> </span>SVR4<span class="_ _35"> </span><span class="ff1a">sigaction</span></div><div class="t m0 x131 h51 y2b14 ff19 fs2a fc0 sc0 ls0 ws0">(</div><div class="t m0 x136 h51 y2b13 ff19 fs2a fc0 sc0 ls0 ws0">2</div><div class="t m0 x19b h51 y2b14 ff19 fs2a fc0 sc0 ls0 ws0">)</div><div class="t m0 xf h52 y2b13 ff19 fs2a fc0 sc0 ls0 ws0">manual <span class="_ _42"> </span>page <span class="_"> </span>in <span class="_ _42"> </span>A<span class="_ _1"></span>T&amp;T <span class="_ _42"> </span>[1990e] <span class="_"> </span>claims <span class="_ _42"> </span>that <span class="_ _42"> </span>the<span class="_ _35"> </span><span class="ff1a">SA_SIGINFO<span class="_ _45"> </span></span>ﬂag</div><div class="t m0 x76 h51 y2b15 ff19 fs2a fc0 sc0 ls0 ws0">(Figur<span class="lsc54">e1<span class="_ _b"></span><span class="ls0">0.16) <span class="_ _23"> </span>causes <span class="_ _23"> </span>signals <span class="_ _23"> </span>to <span class="_ _23"> </span>be <span class="_ _23"> </span>reliably <span class="_ _23"> </span>queued.<span class="_ _46"> </span>This <span class="_ _23"> </span>is <span class="_ _23"> </span>wrong. <span class="_ _45"> </span>Apparently<span class="_ _4"></span><span class="lsc55">,t<span class="_ _8"></span><span class="ls0">his <span class="_ _23"> </span>feature</span></span></span></span></div><div class="t m0 x76 h51 y2b16 ff19 fs2a fc0 sc0 ls0 ws0">was <span class="_ _23"> </span>partially <span class="_ _23"> </span>implemented <span class="_ _42"> </span>within <span class="_ _23"> </span>the <span class="_ _23"> </span>kernel, <span class="_ _23"> </span>but <span class="_ _42"> </span>it <span class="_ _23"> </span>is <span class="_ _23"> </span>not <span class="_ _42"> </span>enabled <span class="_ _23"> </span>in <span class="_ _23"> </span>SVR4.<span class="_ _61"> </span>Curiously<span class="_ _6"></span><span class="lsbfe">,t<span class="_ _8"></span><span class="ls0">he</span></span></div><div class="t m0 x76 h51 y2b17 ff19 fs2a fc0 sc0 ls0 ws0">SVID didn’t make the same claims of reliable queuing.</div><div class="t m0 x3f h2a y2b18 ff19 fsf fc0 sc0 ls0 ws0">What <span class="_ _66"> </span>happens <span class="_ _47"> </span>if <span class="_ _66"> </span>mor<span class="lsc56">et<span class="_ _1d"></span><span class="ls0">han <span class="_ _47"> </span>one <span class="_ _66"> </span>signal <span class="_ _47"> </span>is <span class="_ _66"> </span>ready <span class="_ _66"> </span>to <span class="_ _47"> </span>be <span class="_ _66"> </span>delivered <span class="_ _66"> </span>to <span class="_ _47"> </span>a <span class="_ _66"> </span>process?</span></span></div><div class="t m0 x32 h2a y2b19 ff19 fsf fc0 sc0 ls0 ws0">POSIX.1 <span class="_ _23"> </span>does <span class="_ _42"> </span>not <span class="_ _42"> </span>specify <span class="_ _23"> </span>the <span class="_ _42"> </span>order <span class="_ _23"> </span>in <span class="_ _42"> </span>which <span class="_ _23"> </span>the <span class="_ _42"> </span>signals <span class="_ _42"> </span>ar<span class="ls2f0">ed<span class="_ _43"></span><span class="ls0">eliver<span class="_ _0"></span>ed <span class="_ _23"> </span>to <span class="_ _42"> </span>the <span class="_ _42"> </span>pr<span class="_ _0"></span>ocess.</span></span></div><div class="t m0 x32 h2a y2b1a ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _42"> </span>Rationale <span class="_ _53"> </span>for <span class="_ _53"> </span>POSIX.1 <span class="_ _53"> </span>does <span class="_ _53"> </span>suggest, <span class="_ _53"> </span>however<span class="_ _1"></span><span class="lsb8e">,t<span class="_ _c"></span><span class="ls0">hat <span class="_ _53"> </span>signals <span class="_ _53"> </span>related <span class="_ _42"> </span>to <span class="_ _53"> </span>the <span class="_ _53"> </span>current</span></span></div><div class="t m0 x32 h26 y2b1b ff19 fsf fc0 sc0 ls0 ws0">state of the process be deliver<span class="_ _0"></span>ed befor<span class="_ _0"></span><span class="ls44">eo<span class="_ _d"></span><span class="ls0">ther signals.<span class="_ _46"> </span>(<span class="ff1a">SIGSEGV<span class="_ _80"> </span></span>is one such signal.)</span></span></div><div class="t m0 x3f h2b y2b1c ff19 fsf fc0 sc0 ls0 ws0">Each <span class="_ _2"></span>process <span class="_ _2"></span>has <span class="_ _3"></span>a<span class="_ _47"> </span><span class="ff1b">signal <span class="_ _2"></span>mask<span class="_ _47"> </span></span>that <span class="_ _3"></span>deﬁnes <span class="_ _2"></span>the <span class="_ _3"></span>set <span class="_ _3"></span>of <span class="_ _2"></span>signals <span class="_ _3"></span>currently <span class="_ _2"></span>blocked <span class="_ _3"></span>from</div><div class="t m0 x32 h2a y2b1d ff19 fsf fc0 sc0 ls0 ws0">delivery <span class="_ _3"></span>to <span class="_ _9"></span>that <span class="_ _9"></span>process. <span class="_ _47"> </span>W<span class="_ _6"></span><span class="lsc57">ec<span class="_ _b"></span><span class="ls0">an <span class="_ _9"></span>think <span class="_ _9"></span>of <span class="_ _3"></span>this <span class="_ _9"></span>mask <span class="_ _3"></span>as <span class="_ _9"></span>having <span class="_ _9"></span>one <span class="_ _3"></span>bit <span class="_ _9"></span>for <span class="_ _9"></span>each <span class="_ _3"></span>possible</span></span></div><div class="t m0 x32 h2a y2b1e ff19 fsf fc0 sc0 ls0 ws0">signal. <span class="_ _66"> </span>If<span class="_ _47"> </span>the <span class="_ _3"></span>bit <span class="_ _2"></span>is <span class="_ _3"></span>on <span class="_ _2"></span>for <span class="_ _3"></span>a <span class="_ _2"></span>given <span class="_ _2"></span>signal, <span class="_ _3"></span>that <span class="_ _2"></span>signal <span class="_ _3"></span>is <span class="_ _2"></span>currently <span class="_ _2"></span>blocked.<span class="_ _16"> </span><span class="lsbf9">Ap<span class="_ _4f"></span><span class="ls45">ro<span class="ls0">cess <span class="_ _3"></span>can</span></span></span></div><div class="t m0 x32 h26 y2b1f ff19 fsf fc0 sc0 ls0 ws0">examine <span class="_ _47"> </span>and <span class="_ _45"> </span>change <span class="_ _47"> </span>its <span class="_ _47"> </span>current <span class="_ _47"> </span>signal <span class="_ _45"> </span>mask <span class="_ _47"> </span>by <span class="_ _45"> </span>calling<span class="_ _61"> </span><span class="ff1a">sigprocmask</span><span class="lsc58">,w<span class="_ _1d"></span><span class="ls0">hich <span class="_ _45"> </span>we</span></span></div><div class="t m0 x32 h2a y2b20 ff19 fsf fc0 sc0 ls0 ws0">describe in Section 10.12.</div><div class="t m0 x3f h2a y2b21 ff19 fsf fc0 sc0 ls0 ws0">Since <span class="_ _42"> </span>it <span class="_ _42"> </span>is <span class="_ _53"> </span>possible <span class="_ _42"> </span>for <span class="_ _53"> </span>the <span class="_ _42"> </span>number <span class="_ _42"> </span>of <span class="_ _53"> </span>signals <span class="_ _42"> </span>to <span class="_ _53"> </span>exceed <span class="_ _42"> </span>the <span class="_ _53"> </span>number <span class="_ _42"> </span>of <span class="_ _42"> </span>bits <span class="_ _53"> </span>in <span class="_ _42"> </span>an</div><div class="t m0 x32 h26 y66e ff19 fsf fc0 sc0 ls0 ws0">integer<span class="_ _6"></span><span class="lsc59">,P<span class="_ _55"></span><span class="ls0">OSIX.1 <span class="_"> </span>deﬁnes <span class="_ _53"> </span>a <span class="_"> </span>data <span class="_ _e"> </span>type, <span class="_"> </span>called<span class="_ _4b"> </span><span class="ff1a">sigset_t</span><span class="lsc5a">,t<span class="_ _55"></span><span class="ls0">hat <span class="_ _e"> </span>holds <span class="_"> </span>a<span class="_ _4b"> </span><span class="ff1b">signal <span class="_"> </span>set</span><span class="lsc5b">.T<span class="_ _5d"></span><span class="ls0">he</span></span></span></span></span></span></div><div class="t m0 x32 h2a y670 ff19 fsf fc0 sc0 ls0 ws0">signal <span class="_ _47"> </span>mask, <span class="_ _47"> </span>for <span class="_ _45"> </span>example, <span class="_ _47"> </span>is <span class="_ _47"> </span>stored <span class="_ _47"> </span>in <span class="_ _47"> </span>one <span class="_ _45"> </span>of <span class="_ _47"> </span>these <span class="_ _47"> </span>signal <span class="_ _47"> </span>sets.<span class="_ _5f"> </span><span class="ls5f">We <span class="_ _46"> </span>d<span class="_ _9"></span></span>escribe <span class="_ _47"> </span>ﬁve</div><div class="t m0 x32 h2a y671 ff19 fsf fc0 sc0 ls0 ws0">functions that operate on signal sets in Section 10.1<span class="_ _1"></span>1.</div><div class="t m0 x35 h75 y675 ff16 fs2b fc0 sc0 ls0 ws0">10.9<span class="_ _6d"> </span><span class="ff1f">kill<span class="_ _54"> </span></span>and<span class="_ _54"> </span><span class="ff1f">raise<span class="_ _54"> </span></span>Functions</div><div class="t m0 x32 h26 y2b22 ff19 fsf fc0 sc0 ls0 ws0">The<span class="_ _44"> </span><span class="ff1a">kill<span class="_ _4b"> </span></span>function <span class="_ _53"> </span>sends <span class="_ _53"> </span>a <span class="_ _53"> </span>signal <span class="_ _53"> </span>to <span class="_ _53"> </span>a <span class="_ _e"> </span>process <span class="_ _42"> </span>or <span class="_ _53"> </span>a <span class="_ _53"> </span>group <span class="_ _53"> </span>of <span class="_ _53"> </span>processes. <span class="_ _44"> </span>The<span class="_ _4b"> </span><span class="ff1a">raise</span></div><div class="t m0 x32 h2a y2b23 ff19 fsf fc0 sc0 ls0 ws0">function allows a process to send a signal to itself.</div><div class="t m0 x76 h52 y2b24 ff19 fs2a fc0 sc0 ls0 ws0">The<span class="_ _66"> </span><span class="ff1a">raise<span class="_ _66"> </span></span>function <span class="_ _3"></span>was <span class="_ _3"></span>originally <span class="_ _9"></span>deﬁned <span class="_ _3"></span>by <span class="_ _3"></span>ISO <span class="_ _9"></span>C.<span class="_ _4b"> </span>POSIX.1 <span class="_ _9"></span>includes <span class="_ _3"></span>it <span class="_ _3"></span>to <span class="_ _9"></span>align <span class="_ _3"></span>itself <span class="_ _9"></span>with</div><div class="t m0 x76 h52 y2b25 ff19 fs2a fc0 sc0 ls0 ws0">the <span class="_ _3"></span>ISO <span class="_ _9"></span>C <span class="_ _3"></span>standard, <span class="_ _3"></span>but <span class="_ _3"></span>POSIX.1 <span class="_ _9"></span>extends <span class="_ _3"></span>the <span class="_ _9"></span>speciﬁcation <span class="_ _3"></span>of<span class="_ _66"> </span><span class="ff1a">raise<span class="_ _66"> </span></span>to <span class="_ _3"></span>deal <span class="_ _9"></span>with <span class="_ _3"></span>threads <span class="_ _3"></span>(we</div><div class="t m0 x76 h51 y2b26 ff19 fs2a fc0 sc0 ls0 ws0">discuss <span class="_ _23"> </span>how <span class="_ _42"> </span>threads <span class="_ _23"> </span>interact <span class="_ _23"> </span>with <span class="_ _42"> </span>signals <span class="_ _23"> </span>in <span class="_ _42"> </span>Section <span class="_ _23"> </span>12.8).<span class="_ _16"> </span>Since <span class="_ _23"> </span>ISO <span class="_ _42"> </span>C <span class="_ _23"> </span>does <span class="_ _42"> </span>not <span class="_ _23"> </span>deal <span class="_ _42"> </span>with</div><div class="t m0 x76 h52 y2b27 ff19 fs2a fc0 sc0 ls0 ws0">multiple <span class="_ _23"> </span>processes, <span class="_ _23"> </span>it <span class="_ _23"> </span>could <span class="_ _23"> </span>not <span class="_ _42"> </span>deﬁne <span class="_ _23"> </span>a <span class="_ _23"> </span>function, <span class="_ _23"> </span>such <span class="_ _42"> </span>as<span class="_ _47"> </span><span class="ff1a">kill</span><span class="lsc5c">,t<span class="_ _8"></span><span class="ls0">hat <span class="_ _23"> </span>requires <span class="_ _23"> </span>a <span class="_ _23"> </span>process <span class="_ _23"> </span>ID</span></span></div><div class="t m0 x76 h51 y2b28 ff19 fs2a fc0 sc0 ls0 ws0">argument.</div><a class="l" href="#pf10" data-dest-detail='[16,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.892842px;bottom:337.488916px;width:199.487610px;height:19.679001px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
