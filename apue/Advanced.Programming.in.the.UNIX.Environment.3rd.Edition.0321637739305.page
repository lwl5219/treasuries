<div id="pf131" class="pf w4 h1f" data-page-no="131"><div class="pc pc131 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg131.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>8.14<span class="_ _18d"> </span>Process <span class="_"> </span>Accounting<span class="_ _1b"> </span><span class="ff18">271</span></div><div class="t m0 x1af h51 y597 ff19 fs2a fc0 sc0 ls0 ws0">FreeBSD <span class="_ _141"> </span>Linux<span class="_ _3a"> </span>Mac OS X<span class="_ _7f"> </span>Solaris</div><div class="t m0 xa3 h51 y598 ff19 fs2a fc0 sc0 ls0 ws0">8.0 <span class="_ _215"> </span>3.2.0<span class="_ _76"> </span>10.6.8 <span class="_ _bf"> </span>10</div><div class="t m0 x21 h52 y599 ff1a fs2a fc0 sc0 ls0 ws0">ac_flag<span class="_ _23e"> </span><span class="ff19">Description</span></div><div class="t m0 x21 h5e y59a ff1a fs10 fc0 sc0 ls0 ws0">AFORK<span class="_ _15"> </span><span class="ff19">process is the r<span class="_ _0"></span>esult of<span class="_"> </span><span class="ff1a">fork</span><span class="ls136">,b<span class="_ _84"></span><span class="ls0">ut never called<span class="_"> </span><span class="ff1a">exec<span class="_ _8a"> </span></span><span class="ls76e">••••</span></span></span></span></div><div class="t m0 x21 h5e y59b ff1a fs10 fc0 sc0 ls0 ws0">ASU<span class="_ _10b"> </span><span class="ff19">process used superuser privileges<span class="_ _23f"> </span><span class="ls76e">•••</span></span></div><div class="t m0 x21 h5e y59c ff1a fs10 fc0 sc0 ls0 ws0">ACORE<span class="_ _15"> </span><span class="ff19">process dumped cor<span class="_ _0"></span><span class="lsa69">e•<span class="_ _240"></span><span class="ls76e">••</span></span></span></div><div class="t m0 x21 h5e y59d ff1a fs10 fc0 sc0 ls0 ws0">AXSIG<span class="_ _15"> </span><span class="ff19">process was killed by a signal<span class="_ _ca"> </span><span class="ls76e">•••</span></span></div><div class="t m0 x21 h5e y59e ff1a fs10 fc0 sc0 ls0 ws0">AEXPND<span class="_ _75"> </span><span class="ff19">expanded accounting entry<span class="_ _241"> </span>•</span></div><div class="t m0 x21 h5e y59f ff1a fs10 fc0 sc0 ls0 ws0">ANVER<span class="_ _15"> </span><span class="ff19">new recor<span class="_ _0"></span><span class="ls136">df<span class="_ _84"></span><span class="ls0">ormat <span class="_ _242"> </span>•</span></span></span></div><div class="t m0 xea h4f y60c ff18 fs11 fc0 sc0 ls0 ws0">Figure 8.26<span class="_ _5a"> </span><span class="ff19 ls39f">Va<span class="_ _9"></span><span class="ls0">lues for<span class="_"> </span><span class="ff1a">ac_flag<span class="_ _53"> </span></span>from accounting record</span></span></div><div class="t m0 x32 h54 y239f ff1a fs2c fc0 sc0 ls0 ws0">exec<span class="ff19">s<span class="_ _35"> </span>B,<span class="_ _44"> </span>then <span class="_ _42"> </span>B<span class="_ _35"> </span></span>exec<span class="ff19">s<span class="_ _35"> </span>C,<span class="_ _44"> </span>and <span class="_ _42"> </span>C<span class="_ _35"> </span></span>exit<span class="ff19 ls6bf">s—o<span class="_ _6"></span><span class="ls0">nly <span class="_ _42"> </span>a <span class="_ _42"> </span>single <span class="_ _42"> </span>accounting <span class="_ _42"> </span>recor<span class="_ _1"></span>d<span class="_ _44"> </span>is<span class="_ _35"> </span>written.</span></span></div><div class="t m0 x32 h55 y23a0 ff19 fs2c fc0 sc0 ls0 ws0">The <span class="_ _23"> </span>command <span class="_ _23"> </span>name <span class="_ _42"> </span>in <span class="_ _23"> </span>the <span class="_ _23"> </span>recor<span class="lsa6a">dc<span class="_ _43"></span><span class="ls0">orresponds <span class="_ _9"></span>to <span class="_ _42"> </span>program <span class="_ _23"></span>C, <span class="_ _23"></span>but <span class="_ _23"> </span>the <span class="_ _42"> </span>CPU <span class="_ _23"></span>times, <span class="_ _23"> </span>for</span></span></div><div class="t m0 x32 h55 y23a1 ff19 fs2c fc0 sc0 ls0 ws0">example, ar<span class="ls142">et<span class="_ _4f"></span><span class="ls0">he sum for programs A, B, and C.</span></span></div><div class="t m0 x35 h61 y23a2 ff16 fs2c fc0 sc0 ls0 ws0">Example</div><div class="t m0 x32 h55 y23a3 ff19 fs2c fc0 sc0 ls155 ws0">To <span class="_ _e"> </span>h<span class="_ _23"></span><span class="ls0">ave <span class="_ _2"></span>some <span class="_ _2"></span>accounting <span class="_ _3"></span>data <span class="_ _2"></span>to <span class="_ _3"></span>examine, <span class="_ _2"></span>we’ll <span class="_ _3"></span>create a <span class="_ _3"></span>test <span class="_ _2"></span>program <span class="_ _2"></span>to <span class="_ _3"></span>implement <span class="_ _2"></span>the</span></div><div class="t m0 x32 h55 y23a4 ff19 fs2c fc0 sc0 ls0 ws0">diagram shown in Figur<span class="ls142">e8<span class="_ _4f"></span><span class="ls0">.27.</span></span></div><div class="t m0 x12a h6d y23a5 ff1a fs12 fc0 sc0 ls0 ws0">sleep</div><div class="t m0 x138 h6d y23a6 ff1a fs12 fc0 sc0 ls0 ws0">(</div><div class="t m0 x8f h6d y23a5 ff1a fs12 fc0 sc0 ls0 ws0">2</div><div class="t m0 x1aa h6d y23a6 ff1a fs12 fc0 sc0 ls0 ws0">)</div><div class="t m0 x12a h6d y23a7 ff1a fs12 fc0 sc0 ls0 ws0">exit</div><div class="t m0 x52 h6d y23a8 ff1a fs12 fc0 sc0 ls0 ws0">(</div><div class="t m0 x138 h6d y23a7 ff1a fs12 fc0 sc0 ls0 ws0">2</div><div class="t m0 x8f h6d y23a8 ff1a fs12 fc0 sc0 ls0 ws0">)</div><div class="t m0 x30 h63 y23a9 ff1a fs13 fc0 sc0 ls0 ws0">sleep</div><div class="t m0 x1d2 h63 y23aa ff1a fs13 fc0 sc0 ls0 ws0">(</div><div class="t m0 xc0 h63 y23a9 ff1a fs13 fc0 sc0 ls0 ws0">4</div><div class="t m0 xee h63 y23aa ff1a fs13 fc0 sc0 ls0 ws0">)</div><div class="t m0 x30 h63 y23ab ff1a fs13 fc0 sc0 ls0 ws0">abort()</div><div class="t m0 x1bf h6f y23ac ff1a fs14 fc0 sc0 ls0 ws0">sleep</div><div class="t m0 x158 h6f y23ad ff1a fs14 fc0 sc0 ls0 ws0">(</div><div class="t m0 x164 h6f y23ac ff1a fs14 fc0 sc0 ls0 ws0">8</div><div class="t m0 x5e h6f y23ad ff1a fs14 fc0 sc0 ls0 ws0">)</div><div class="t m0 x1bf h6f y23ae ff1a fs14 fc0 sc0 ls0 ws0">exit</div><div class="t m0 x98 h6f y23af ff1a fs14 fc0 sc0 ls0 ws0">(</div><div class="t m0 x158 h6f y23ae ff1a fs14 fc0 sc0 ls0 ws0">0</div><div class="t m0 x164 h6f y23af ff1a fs14 fc0 sc0 ls0 ws0">)</div><div class="t m0 x189 h66 y23b0 ff1a fs15 fc0 sc0 ls0 ws0">sleep</div><div class="t m0 x200 h66 y23b1 ff1a fs15 fc0 sc0 ls0 ws0">(</div><div class="t m0 x57 h66 y23b0 ff1a fs15 fc0 sc0 ls0 ws0">6</div><div class="t m0 xe6 h66 y23b1 ff1a fs15 fc0 sc0 ls0 ws0">)</div><div class="t m0 x189 h66 y23b2 ff1a fs15 fc0 sc0 ls0 ws0">kill()</div><div class="t m0 x33 h33 y23b3 ff19 fs16 fc0 sc0 ls0 ws0">parent</div><div class="t m0 x12b h33 y23b4 ff19 fs16 fc0 sc0 ls0 ws0">ﬁrst child</div><div class="t m0 x1f5 h33 y23b5 ff19 fs16 fc0 sc0 ls0 ws0">second child</div><div class="t m0 xa3 h33 y23b6 ff19 fs16 fc0 sc0 ls0 ws0">thir<span class="ls84a">dc<span class="_ _5"></span><span class="ls0">hild</span></span></div><div class="t m0 x19e h33 y23b7 ff19 fs16 fc0 sc0 ls0 ws0">fourth child</div><div class="t m0 x9c h70 y23b8 ff1a fs16 fc0 sc0 ls0 ws0">/bin/dd</div><div class="t m17 x54 h106 y23b9 ff1a fs8c fc0 sc0 ls0 ws0">fork</div><div class="t m18 x1b7 h107 y23ba ff1a fs8d fc0 sc0 ls0 ws0">fork</div><div class="t m17 x177 h108 y23bb ff1a fs8e fc0 sc0 ls0 ws0">fork</div><div class="t m19 xbc h109 y23bc ff1a fs8f fc0 sc0 ls0 ws0">fork</div><div class="t m0 xeb h8d y23bd ff1a fs1a fc0 sc0 ls0 ws0">execl</div><div class="t m0 x12b h37 y23be ff18 fs1a fc0 sc0 ls0 ws0">Figure 8.27<span class="_ _5a"> </span><span class="ff19">Process structur<span class="lsa6b">ef<span class="_ _5"></span><span class="ls0">or accounting example</span></span></span></div><div class="t m0 x32 h90 y23bf ff19 fs47 fc0 sc0 ls0 ws0">The <span class="_ _2"></span>source <span class="_ _3"></span>for <span class="_ _2"></span>the <span class="_ _3"></span>test <span class="_ _3"></span>program <span class="_ _2"></span>is <span class="_ _3"></span>shown <span class="_ _3"></span>in <span class="_ _3"></span>Figur<span class="lsa6c">e8<span class="_ _8"></span><span class="ls0">.28. <span class="_ _47"> </span>It<span class="_ _47"> </span>calls<span class="_ _47"> </span><span class="ff1a">fork<span class="_ _47"> </span></span>four <span class="_ _2"></span>times.<span class="_ _16"> </span>Each</span></span></div><div class="t m0 x32 h8e y23c0 ff19 fs47 fc0 sc0 ls0 ws0">child does something differ<span class="_ _0"></span>ent and then terminates.</div><div class="t m0 x32 h10a y23c1 ff1a fs90 fc0 sc0 ls0 ws0">#include &quot;apue.h&quot;</div><div class="t m0 x32 h10a y23c2 ff1a fs90 fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 h10a y23c3 ff1a fs90 fc0 sc0 ls0 ws0">main(void)</div><div class="t m0 x32 h10a y23c4 ff1a fs90 fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h10a y23c5 ff1a fs90 fc0 sc0 ls0 ws0">pid_t <span class="_ _d9"> </span>pid;</div><div class="t m0 x8a h10a y23c6 ff1a fs90 fc0 sc0 ls0 ws0">if ((pid = fork()) &lt; 0)</div><div class="t m0 x9d h10a y23c7 ff1a fs90 fc0 sc0 ls0 ws0">err_sys(&quot;fork error&quot;);</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
