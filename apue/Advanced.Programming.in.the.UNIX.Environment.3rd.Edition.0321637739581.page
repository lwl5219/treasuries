<div id="pf245" class="pf w4 h1f" data-page-no="245"><div class="pc pc245 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg245.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h7a ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>15.3<span class="_ _2ae"> </span><span class="ff1a">popen<span class="_ _4b"> </span></span>and<span class="_ _4b"> </span><span class="ff1a">pclose<span class="_ _4b"> </span></span>Functions<span class="_ _1b"> </span><span class="ff18">547</span></div><div class="t m0 x1f7 h51 y1ed4 ff19 fs2a fc0 sc0 ls0 ws0">parent<span class="_ _178"> </span>ﬁlter program</div><div class="t m0 x154 h2d y4248 ff19 fs10 fc0 sc0 ls0 ws0">user at a</div><div class="t m0 x154 h2d y4249 ff19 fs10 fc0 sc0 ls0 ws0">terminal</div><div class="t m0 xcc h4f y424a ff1a fs11 fc0 sc0 ls0 ws0">popen<span class="_ _53"> </span><span class="ff19">pipe</span></div><div class="t m0 x17b h56 y424b ff1b fs11 fc0 sc0 ls0 ws0">stdout</div><div class="t m2b x13 h15e y424c ff19 fsb7 fc0 sc0 ls0 ws0">prompt</div><div class="t m0 xf3 hd1 y424d ff1b fs12 fc0 sc0 ls0 ws0">stdout</div><div class="t m2c x1e1 h15f y424e ff19 fsb8 fc0 sc0 ls0 ws0">user</div><div class="t m2c x187 h15f y424f ff19 fsb8 fc0 sc0 ls0 ws0">input</div><div class="t m0 x47 hca y4250 ff1b fs13 fc0 sc0 ls0 ws0">stdin</div><div class="t m0 x2f h63 y4251 ff18 fs13 fc0 sc0 ls0 ws0">Figure 15.13<span class="_ _5a"> </span><span class="ff19 ls30e">Tr<span class="_ _9"></span><span class="ls0">ansforming input using<span class="_"> </span><span class="ff1a">popen</span></span></span></div><div class="t m0 x32 h6e y4252 ff19 fs31 fc0 sc0 ls0 ws0">The <span class="_ _9"></span>transformation <span class="_ _9"></span>could <span class="_ _9"></span>be <span class="_ _9"></span>pathname <span class="_ _9"></span>expansion, <span class="_ _9"></span>for <span class="_ _9"></span>example, <span class="_ _9"></span>or <span class="_ _9"></span>providing <span class="_ _9"></span>a <span class="_ _9"></span>history</div><div class="t m0 x32 h6e y4253 ff19 fs31 fc0 sc0 ls0 ws0">mechanism (remembering pr<span class="_ _0"></span>eviously enter<span class="_ _0"></span>ed commands).</div><div class="t m0 x3f h6e y4254 ff19 fs31 fc0 sc0 ls0 ws0">Figur<span class="ls1198">e1<span class="_ _43"></span><span class="ls0">5.14 <span class="_ _23"></span>shows <span class="_ _23"></span>a <span class="_ _9"></span>simple <span class="_ _23"> </span>ﬁlter <span class="_ _23"> </span>to <span class="_ _23"></span>demonstrate <span class="_ _23"></span>this <span class="_ _9"></span>operation.<span class="_ _51"> </span>The <span class="_ _23"></span>ﬁlter <span class="_ _23"></span>copies</span></span></div><div class="t m0 x32 h6e y4255 ff19 fs31 fc0 sc0 ls0 ws0">standar<span class="ls1199">di<span class="_ _c"></span><span class="ls0">nput <span class="_ _42"> </span>to <span class="_ _42"> </span>standar<span class="ls1199">do<span class="_ _43"></span><span class="ls0">utput, <span class="_ _42"> </span>converting <span class="_ _42"> </span>any <span class="_ _42"> </span>uppercase <span class="_ _42"> </span>character <span class="_ _42"> </span>to <span class="_ _42"> </span>lowercase.</span></span></span></span></div><div class="t m0 x32 h64 y4256 ff19 fs31 fc0 sc0 ls0 ws0">The <span class="_ _35"> </span>r<span class="_ _0"></span>eason <span class="_ _35"> </span>we’r<span class="ls119a">ec<span class="_ _52"></span><span class="ls0">areful <span class="_ _35"> </span>to<span class="_ _51"> </span><span class="ff1a">fflush<span class="_"> </span></span>standar<span class="ls119a">do<span class="_ _7"></span><span class="ls0">utput <span class="_ _35"> </span>after <span class="_ _35"> </span>writing <span class="_ _35"> </span>a <span class="_ _35"> </span>newline <span class="_ _45"> </span>is</span></span></span></span></div><div class="t m0 x32 h6e y4257 ff19 fs31 fc0 sc0 ls0 ws0">discussed in the next section when we talk about coprocesses.</div><div class="t m0 x32 hc1 y4258 ff1a fs69 fc0 sc0 ls0 ws0">#include &quot;apue.h&quot;</div><div class="t m0 x32 hc1 y4259 ff1a fs69 fc0 sc0 ls0 ws0">#include &lt;ctype.h&gt;</div><div class="t m0 x32 hc1 y425a ff1a fs69 fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 hc1 y425b ff1a fs69 fc0 sc0 ls0 ws0">main(void)</div><div class="t m0 x32 hc1 y425c ff1a fs69 fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a hc1 y425d ff1a fs69 fc0 sc0 ls0 ws0">int <span class="_ _15"> </span>c;</div><div class="t m0 x8a hc1 y425e ff1a fs69 fc0 sc0 ls0 ws0">while ((c = getchar()) != EOF) {</div><div class="t m0 x9d hc1 y425f ff1a fs69 fc0 sc0 ls0 ws0">if (isupper(c))</div><div class="t m0 x1f hc1 y4260 ff1a fs69 fc0 sc0 lsf89 ws0">c=t<span class="_ _1d"></span><span class="ls0">olower(c);</span></div><div class="t m0 x9d hc1 y4261 ff1a fs69 fc0 sc0 ls0 ws0">if (putchar(c) == EOF)</div><div class="t m0 x1f hc1 y4262 ff1a fs69 fc0 sc0 ls0 ws0">err_sys(&quot;output error&quot;);</div><div class="t m0 x9d hc1 y4263 ff1a fs69 fc0 sc0 ls0 ws0">if (c == ’\n’)</div><div class="t m0 x1f hc1 y4264 ff1a fs69 fc0 sc0 ls0 ws0">fflush(stdout);</div><div class="t m0 x8a hc1 y4265 ff1a fs69 fc0 sc0 ls0 ws0">}</div><div class="t m0 x8a hc1 y4266 ff1a fs69 fc0 sc0 ls0 ws0">exit(0);</div><div class="t m0 x32 hc1 y4267 ff1a fs69 fc0 sc0 ls0 ws0">}</div><div class="t m0 x184 h32 y4268 ff18 fs15 fc0 sc0 ls0 ws0">Figure 15.14<span class="_ _5a"> </span><span class="ff19">Filter to convert uppercase characters to lowercase</span></div><div class="t m0 x3f h68 y4269 ff19 fs33 fc0 sc0 ls1d9 ws0">We <span class="_ _66"> </span>c<span class="_ _9"></span><span class="ls0">ompile <span class="_ _9"></span>this <span class="_ _9"></span>ﬁlter <span class="_ _9"></span>into <span class="_ _9"></span>the <span class="_ _9"></span>executable <span class="_ _9"></span>ﬁle<span class="_ _45"> </span><span class="ff1a">myuclc</span><span class="ls119b">,w<span class="_ _b"></span><span class="ls0">hich <span class="_ _9"></span>we <span class="_ _9"></span>then <span class="_ _23"></span>invoke <span class="_ _3"></span>from</span></span></span></div><div class="t m0 x32 h68 y426a ff19 fs33 fc0 sc0 ls0 ws0">the program in Figur<span class="_ _0"></span><span class="ls1d7">e1<span class="_ _d"></span><span class="ls0">5.15 using<span class="_"> </span><span class="ff1a">popen</span>.</span></span></div><div class="t m0 x32 hc6 y426b ff1a fs6b fc0 sc0 ls0 ws0">#include &quot;apue.h&quot;</div><div class="t m0 x32 hc6 y426c ff1a fs6b fc0 sc0 ls0 ws0">#include &lt;sys/wait.h&gt;</div><div class="t m0 x32 hc6 y426d ff1a fs6b fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 hc6 y426e ff1a fs6b fc0 sc0 ls0 ws0">main(void)</div><div class="t m0 x32 hc6 y426f ff1a fs6b fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a hc6 y4270 ff1a fs6b fc0 sc0 ls0 ws0">char <span class="_ _68"> </span>line[MAXLINE];</div><div class="t m0 x8a hc6 y4271 ff1a fs6b fc0 sc0 ls0 ws0">FILE <span class="_ _68"> </span>*fpin;</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
