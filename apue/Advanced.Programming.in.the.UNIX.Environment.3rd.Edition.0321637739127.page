<div id="pf7f" class="pf w4 h1f" data-page-no="7f"><div class="pc pc7f w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg7f.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x32 h47 y25f ff1e fsb fc0 sc0 ls0 ws0">4</div><div class="t m0 x32 h20 y8f ff15 fs2 fc0 sc0 ls0 ws0">Files <span class="_"> </span>and <span class="_"> </span>Director <span class="_ _7"></span>ies</div><div class="t m0 x35 h48 y90 ff16 fs1 fc0 sc0 ls0 ws0">4.1 <span class="_ _68"> </span>Introduction</div><div class="t m0 x32 h28 yddf ff19 fs5 fc0 sc0 ls0 ws0">In <span class="_ _35"> </span>the <span class="_ _35"> </span>previous <span class="_ _35"> </span>chapter <span class="_ _35"> </span>we <span class="_ _44"> </span>cover<span class="_ _0"></span>ed <span class="_ _35"> </span>the <span class="_ _35"> </span>basic <span class="_ _44"> </span>functions <span class="_ _35"> </span>that <span class="_ _35"> </span>perform <span class="_ _35"> </span>I/O.<span class="_ _98"> </span>The</div><div class="t m0 x32 h28 yde0 ff19 fs5 fc0 sc0 ls0 ws0">discussion <span class="_ _23"></span>centered <span class="_ _9"></span>on <span class="_ _23"></span>I/O <span class="_ _23"></span>for <span class="_ _9"></span>regular <span class="_ _23"></span>ﬁles<span class="_ _9"></span><span class="ls37">—o<span class="_ _6"></span><span class="ls0">pening <span class="_ _23"></span>a <span class="_ _23"></span>ﬁle, <span class="_ _9"></span>and <span class="_ _23"> </span>reading <span class="_ _9"></span>or <span class="_ _23"> </span>writing <span class="_ _23"> </span>a</span></span></div><div class="t m0 x32 h28 yde1 ff19 fs5 fc0 sc0 ls0 ws0">ﬁle. <span class="_ _47"> </span>W<span class="_ _6"></span>e’ll <span class="_ _2"></span>now <span class="_ _3"></span>look <span class="_ _3"></span>at <span class="_ _2"></span>additional <span class="_ _3"></span>features <span class="_ _2"></span>of <span class="_ _3"></span>the <span class="_ _3"></span>ﬁle <span class="_ _3"></span>system <span class="_ _2"></span>and <span class="_ _3"></span>the <span class="_ _3"></span>properties <span class="_ _2"></span>of <span class="_ _3"></span>a <span class="_ _3"></span>ﬁle.</div><div class="t m0 x32 h2c yde2 ff19 fs5 fc0 sc0 ls72 ws0">We<span class="_ _9"></span><span class="ls0">’ll <span class="_ _2"></span>start <span class="_ _2"></span>with <span class="_ _2"></span>the<span class="_ _47"> </span><span class="ff1a">stat<span class="_ _66"> </span></span>functions <span class="_ _2"></span>and <span class="_ _2"></span>go <span class="_ _2"></span>through <span class="_ _2"></span>each <span class="_ _2"></span>member <span class="_ _2"></span>of <span class="_ _2"></span>the<span class="_ _66"> </span><span class="ff1a">stat<span class="_ _47"> </span></span>structure,</span></div><div class="t m0 x32 h28 yde3 ff19 fs5 fc0 sc0 ls0 ws0">looking <span class="_ _53"> </span>at <span class="_ _53"> </span>all <span class="_ _53"> </span>the <span class="_ _53"> </span>attributes <span class="_ _53"> </span>of <span class="_ _53"> </span>a <span class="_ _53"> </span>ﬁle.<span class="_ _54"> </span>In <span class="_ _53"> </span>this <span class="_ _53"> </span>process, <span class="_ _53"> </span>we’ll <span class="_ _53"> </span>also <span class="_ _53"> </span>describe <span class="_ _53"> </span>each <span class="_ _53"> </span>of <span class="_ _53"> </span>the</div><div class="t m0 x32 h28 yde4 ff19 fs5 fc0 sc0 ls0 ws0">functions <span class="_ _9"></span>that <span class="_ _9"></span>modify <span class="_ _23"></span>these <span class="_ _9"></span>attributes: <span class="_ _9"></span>change <span class="_ _23"></span>the <span class="_ _9"></span>owner<span class="_ _1"></span><span class="ls46e">,c<span class="_ _b"></span><span class="ls0">hange <span class="_ _9"></span>the <span class="_ _9"></span>permissions, <span class="_ _23"></span>and</span></span></div><div class="t m0 x32 h28 yde5 ff19 fs5 fc0 sc0 ls0 ws0">so on.<span class="_ _46"> </span><span class="ls72">We<span class="_ _23"></span></span>’ll also look <span class="_ _2"></span>in mor<span class="ls46f">ed<span class="_ _d"></span><span class="ls0">etail at <span class="_ _2"></span>the structure<span class="_"> </span>of<span class="_"> </span>a<span class="_ _66"> </span>UNIX <span class="_ _2"></span>ﬁle system <span class="_ _2"></span>and symbolic</span></span></div><div class="t m0 x32 h28 yde6 ff19 fs5 fc0 sc0 ls0 ws0">links. <span class="_ _4b"> </span>W<span class="_ _6"></span><span class="ls470">eﬁ<span class="_ _55"></span><span class="ls0">nish <span class="_ _e"> </span>this <span class="_ _e"> </span>chapter <span class="_ _e"> </span>with <span class="_ _e"> </span>the <span class="_ _53"> </span>functions <span class="_"> </span>that <span class="_ _42"> </span>operate <span class="_"> </span>on <span class="_ _42"> </span>directories, <span class="_ _e"> </span>and <span class="_ _e"> </span>we</span></span></div><div class="t m0 x32 h28 yde7 ff19 fs5 fc0 sc0 ls0 ws0">develop a function that descends through a dir<span class="_ _0"></span>ectory hierar<span class="_ _0"></span>chy<span class="_ _4"></span>.</div><div class="t m0 x35 h94 yde8 ff16 fs1 fc0 sc0 ls0 ws0">4.2<span class="_ _72"> </span><span class="ff1f">stat</span>,<span class="_ _54"> </span><span class="ff1f">fstat</span>,<span class="_ _54"> </span><span class="ff1f">fstatat</span><span class="ls471">,a<span class="_ _52"></span><span class="ls0">nd<span class="_ _65"> </span><span class="ff1f">lstat<span class="_ _54"> </span></span>Functions</span></span></div><div class="t m0 x32 h2c yde9 ff19 fs5 fc0 sc0 ls0 ws0">The <span class="_ _9"></span>discussion <span class="_ _9"></span>in <span class="_ _23"></span>this <span class="_ _9"></span>chapter <span class="_ _9"></span>centers <span class="_ _9"></span>on <span class="_ _23"></span>the <span class="_ _9"></span>four<span class="_ _45"> </span><span class="ff1a">stat<span class="_ _45"> </span></span>functions <span class="_ _9"></span>and <span class="_ _9"></span>the <span class="_ _23"></span>information</div><div class="t m0 x32 h28 ydea ff19 fs5 fc0 sc0 ls0 ws0">they return.</div><div class="t m0 x3f h7a ydeb ff1a fs0 fc0 sc0 ls0 ws0">#include &lt;sys/stat.h&gt;</div><div class="t m0 x3f h7a ydec ff1a fs0 fc0 sc0 ls0 ws0">int stat(const char *restrict<span class="_"> </span><span class="ff1b">pathname</span><span class="ls472">,s<span class="_ _1d"></span><span class="ls0">truct stat *restrict<span class="_"> </span><span class="ff1b">buf<span class="_ _53"> </span></span>);</span></span></div><div class="t m0 x3f h7a yded ff1a fs0 fc0 sc0 ls0 ws0">int fstat(int<span class="_"> </span><span class="ff1b">fd</span><span class="ls472">,s<span class="_ _1d"></span><span class="ls0">truct stat *<span class="ff1b">buf<span class="_ _53"> </span></span>);</span></span></div><div class="t m0 x3f h7a ydee ff1a fs0 fc0 sc0 ls0 ws0">int lstat(const char *restrict<span class="_"> </span><span class="ff1b">pathname</span><span class="ls472">,s<span class="_ _1d"></span><span class="ls0">truct stat *restrict<span class="_"> </span><span class="ff1b">buf<span class="_ _53"> </span></span>);</span></span></div><div class="t m0 x3f h7a ydef ff1a fs0 fc0 sc0 ls0 ws0">int fstatat(int<span class="_"> </span><span class="ff1b">fd</span><span class="ls472">,c<span class="_ _1d"></span><span class="ls0">onst char *restrict<span class="_"> </span><span class="ff1b">pathname</span>,</span></span></div><div class="t m0 xda h7a ydf0 ff1a fs0 fc0 sc0 ls0 ws0">struct stat *restrict<span class="_"> </span><span class="ff1b">buf</span><span class="ls472">,i<span class="_ _1d"></span><span class="ls0">nt<span class="_"> </span><span class="ff1b">ﬂag<span class="_ _3"></span></span>);</span></span></div><div class="t m0 x17b h24 ydf1 ff19 fs0 fc0 sc0 ls0 ws0">All four return: 0 if OK,<span class="_"> </span><span class="ff20">−</span>1<span class="_"> </span>on<span class="_"> </span>err<span class="_ _0"></span>or</div><div class="t m0 xcf h95 ydf2 ff18 fs2d fc0 sc0 ls0 ws0">93</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:155.400000px;bottom:975.491961px;width:248.999985px;height:135.000000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.891993px;bottom:768.826788px;width:105.756005px;height:19.680023px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.891576px;bottom:451.306826px;width:309.239189px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
