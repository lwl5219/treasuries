<div id="pf116" class="pf w4 h1f" data-page-no="116"><div class="pc pc116 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg116.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">244<span class="_ _1b"> </span><span class="ff19">Process <span class="_"> </span>Contr<span class="_ _0"></span>ol <span class="_ _222"> </span>Chapter<span class="_ _4b"> </span>8</span></div><div class="t m0 x35 h75 y12f ff16 fs2b fc0 sc0 ls0 ws0">8.7<span class="_ _72"> </span><span class="ff1f">waitid<span class="_ _54"> </span></span>Function</div><div class="t m0 x32 h2a y4de ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _2"></span>Single <span class="_ _2"></span>UNIX <span class="_ _3"></span>Speciﬁcation <span class="_ _2"></span>includes <span class="_ _2"></span>an <span class="_ _3"></span>additional <span class="_ _2"></span>function <span class="_ _2"></span>to <span class="_ _3"></span>retrieve the <span class="_ _3"></span>exit <span class="_ _2"></span>status</div><div class="t m0 x32 h26 y6d0 ff19 fsf fc0 sc0 ls0 ws0">of a process. <span class="_"> </span>The<span class="_"> </span><span class="ff1a">waitid<span class="_ _80"> </span></span>function is similar to<span class="_"> </span><span class="ff1a">waitpid</span><span class="ls44">,b<span class="_ _d"></span><span class="ls0">ut provides extra ﬂexibility<span class="_ _4"></span>.</span></span></div><div class="t m0 x3f h57 y126b ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;sys/wait.h&gt;</div><div class="t m0 x3f h57 y2036 ff1a fs2d fc0 sc0 ls0 ws0">int waitid(idtype_t<span class="_"> </span><span class="ff1b">idtype</span><span class="ls15c">,i<span class="_ _1d"></span><span class="ls0">d_t<span class="_"> </span><span class="ff1b">id</span><span class="ls15c">,s<span class="_ _5b"></span><span class="ls0">iginfo_t *<span class="ff1b">infop</span><span class="ls15c">,i<span class="_ _1d"></span><span class="ls0">nt<span class="_"> </span><span class="ff1b">options</span>);</span></span></span></span></span></span></div><div class="t m0 x153 h5f y2037 ff19 fs2d fc0 sc0 ls0 ws0">Returns: 0 if OK,<span class="_"> </span><span class="ff20">−</span>1<span class="_"> </span>on<span class="_"> </span>error</div><div class="t m0 x3f h4d y2038 ff19 fs26 fc0 sc0 ls0 ws0">Like<span class="_ _59"> </span><span class="ff1a">waitpid</span>,<span class="_ _59"> </span><span class="ff1a">waitid<span class="_ _46"> </span></span>allows <span class="_"> </span>a <span class="_"> </span>pr<span class="_ _0"></span>ocess <span class="_"> </span>to <span class="_ _e"> </span>specify <span class="_"> </span>which <span class="_"> </span>children <span class="_ _e"> </span>to <span class="_"> </span>wait <span class="_"> </span>for<span class="_ _6"></span>.</div><div class="t m0 x32 h49 y2039 ff19 fs26 fc0 sc0 ls0 ws0">Instead of encoding this <span class="_ _2"></span>information in a <span class="_ _2"></span>single argument combined with the <span class="_ _2"></span>process ID</div><div class="t m0 x32 h4a y203a ff19 fs26 fc0 sc0 ls0 ws0">or <span class="_ _3"></span>process <span class="_ _2"></span>group <span class="_ _2"></span>ID, <span class="_ _3"></span>two <span class="_ _3"></span>separate <span class="_ _3"></span>arguments <span class="_ _2"></span>ar<span class="ls9b4">eu<span class="_ _8"></span><span class="ls0">sed. <span class="_ _47"> </span>The<span class="_ _47"> </span><span class="ff1b">id<span class="_ _45"> </span></span>parameter <span class="_ _2"></span>is <span class="_ _3"></span>interpreted</span></span></div><div class="t m0 x32 h4a y203b ff19 fs26 fc0 sc0 ls0 ws0">based on the value of<span class="_"> </span><span class="ff1b">idtype</span><span class="ls199">.T<span class="_ _4a"></span><span class="ls0">he types supported ar<span class="lsd3">es<span class="_ _4f"></span><span class="ls0">ummarized in Figur<span class="lsd3">e8<span class="_ _d"></span><span class="ls0">.9.</span></span></span></span></span></span></div><div class="t m0 x14b h2e y203c ff19 fs11 fc0 sc0 ls0 ws0">Constant <span class="_ _22c"> </span>Description</div><div class="t m0 x14b h6d y203d ff1a fs12 fc0 sc0 ls0 ws0">P_PID<span class="_ _170"> </span><span class="ff19 ls389">Wa<span class="_ _9"></span><span class="ls0">it for a particular process:<span class="_"> </span><span class="ff1b">id<span class="_"> </span></span>contains the process ID of the child to wait for<span class="_ _6"></span>.</span></span></div><div class="t m0 x14b h63 y203e ff1a fs13 fc0 sc0 ls0 ws0">P_PGID<span class="_ _179"> </span><span class="ff19 ls9b5">Wa<span class="_ _9"></span><span class="ls0">it for any child process in a particular pr<span class="_ _0"></span>ocess group:<span class="_"> </span><span class="ff1b">id<span class="_"> </span></span>contains the pr<span class="_ _0"></span>ocess</span></span></div><div class="t m0 x8 h30 y203f ff19 fs13 fc0 sc0 ls0 ws0">group ID of the childr<span class="_ _0"></span>en to wait for<span class="_ _1"></span>.</div><div class="t m0 x14b h6f y2040 ff1a fs14 fc0 sc0 ls0 ws0">P_ALL<span class="_ _170"> </span><span class="ff19 ls9b6">Wa<span class="_ _9"></span><span class="ls0">it for any child process:<span class="_"> </span><span class="ff1b">id<span class="_"> </span></span>is ignored.</span></span></div><div class="t m0 x1f7 h66 y2041 ff18 fs15 fc0 sc0 ls0 ws0">Figure 8.9<span class="_ _35"> </span><span class="ff19">The<span class="_"> </span><span class="ff1b">idtype<span class="_"> </span></span>constants for<span class="_"> </span><span class="ff1a">waitid</span></span></div><div class="t m0 x3f hd0 y2042 ff19 fs33 fc0 sc0 ls0 ws0">The<span class="_ _47"> </span><span class="ff1b">options<span class="_ _47"> </span></span>argument is <span class="_ _3"></span>a <span class="_ _3"></span>bitwise <span class="_ _3"></span>OR <span class="_ _2"></span>of <span class="_ _3"></span>the <span class="_ _3"></span>ﬂags <span class="_ _3"></span>shown <span class="_ _2"></span>in <span class="_ _3"></span>Figur<span class="ls9b7">e8<span class="_ _8"></span><span class="ls0">.10. <span class="_ _47"> </span>These<span class="_ _47"> </span>ﬂags</span></span></div><div class="t m0 x32 h67 y2043 ff19 fs33 fc0 sc0 ls0 ws0">indicate which state changes the caller is interested in.</div><div class="t m0 xf4 h33 y2044 ff19 fs16 fc0 sc0 ls0 ws0">Constant <span class="_ _22d"> </span>Description</div><div class="t m0 x1f8 h71 y2045 ff1a fs36 fc0 sc0 ls0 ws0">WCONTINUED<span class="_ _6e"> </span><span class="ff19 ls9b8">Wa<span class="_ _3"></span><span class="ls0">it for a process that has previously stopped and has been continued, and</span></span></div><div class="t m0 x184 h83 y2046 ff19 fs36 fc0 sc0 ls0 ws0">whose status has not yet been reported.</div><div class="t m0 x1f8 hcc y2047 ff1a fs17 fc0 sc0 ls0 ws0">WEXITED<span class="_ _6c"> </span><span class="ff19 ls9b9">Wa<span class="_ _9"></span><span class="ls0">it for processes that have exited.</span></span></div><div class="t m0 x1f8 hd4 y2048 ff1a fs18 fc0 sc0 ls0 ws0">WNOHANG<span class="_ _6c"> </span><span class="ff19">Return immediately instead of blocking if there<span class="_"> </span>is<span class="_"> </span>no<span class="_"> </span>child exit status available.</span></div><div class="t m0 x1f8 hd5 y2049 ff1a fs19 fc0 sc0 ls0 ws0">WNOWAIT<span class="_ _6c"> </span><span class="ff19">Don’t destroy the child exit status.<span class="_ _35"> </span>The child’s exit status can be retrieved by a</span></div><div class="t m0 x184 hd5 y204a ff19 fs19 fc0 sc0 ls0 ws0">subsequent call to<span class="_"> </span><span class="ff1a">wait</span>,<span class="_"> </span><span class="ff1a">waitid</span><span class="ls9ba">,o<span class="_ _84"></span><span class="ls0">r<span class="_"> </span><span class="ff1a">waitpid</span>.</span></span></div><div class="t m0 x1f8 h8d y204b ff1a fs1a fc0 sc0 ls0 ws0">WSTOPPED<span class="_ _15"> </span><span class="ff19 ls9bb">Wa<span class="_ _3"></span><span class="ls0">it for a process that has stopped and whose status has not yet been reported.</span></span></div><div class="t m0 xbf hd6 y204c ff18 fs1b fc0 sc0 ls0 ws0">Figure 8.10<span class="_ _35"> </span><span class="ff19">The<span class="_"> </span><span class="ff1b">options<span class="_"> </span></span>constants for<span class="_"> </span><span class="ff1a">waitid</span></span></div><div class="t m0 x32 hf9 y204d ff19 fs88 fc0 sc0 ls0 ws0">At <span class="_ _9"></span>least <span class="_ _23"></span>one <span class="_ _9"></span>of<span class="_ _45"> </span><span class="ff1a">WCONTINUED</span>,<span class="_ _35"> </span><span class="ff1a">WEXITED</span><span class="ls9bc">,o<span class="_ _b"></span><span class="ls0">r<span class="_ _45"> </span><span class="ff1a">WSTOPPED<span class="_ _45"> </span></span>must <span class="_ _9"></span>be <span class="_ _23"></span>speciﬁed <span class="_ _9"></span>in <span class="_ _9"></span>the<span class="_ _35"> </span><span class="ff1b">options</span></span></span></div><div class="t m0 x32 hfa y204e ff19 fs88 fc0 sc0 ls0 ws0">argument.</div><div class="t m0 x3f hf9 y204f ff19 fs88 fc0 sc0 ls0 ws0">The<span class="_ _44"> </span><span class="ff1b">infop<span class="_ _44"> </span></span>argument <span class="_ _42"> </span>is <span class="_ _53"> </span>a <span class="_ _53"> </span>pointer <span class="_ _53"> </span>to <span class="_ _53"> </span>a<span class="_ _44"> </span><span class="ff1a">siginfo<span class="_ _4b"> </span></span>structur<span class="_ _0"></span>e. <span class="_ _44"> </span>This<span class="_ _44"> </span>structur<span class="ls9bd">ec<span class="_ _c"></span><span class="ls0">ontains</span></span></div><div class="t m0 x32 hfa y2050 ff19 fs88 fc0 sc0 ls0 ws0">detailed information about the signal generated <span class="_ _2"></span>that caused the state change <span class="_ _2"></span>in the child</div><div class="t m0 x32 hf9 y2051 ff19 fs88 fc0 sc0 ls0 ws0">process. <span class="_"> </span>The<span class="_"> </span><span class="ff1a">siginfo<span class="_ _80"> </span></span>structur<span class="_ _0"></span>e<span class="_"> </span>is<span class="_"> </span>discussed further in Section 10.14.</div><div class="t m0 x76 h38 y2052 ff19 fs1b fc0 sc0 ls0 ws0">Of <span class="_ _3"></span>the <span class="_ _9"></span>four <span class="_ _3"></span>platforms <span class="_ _9"></span>covered <span class="_ _3"></span>in <span class="_ _9"></span>this <span class="_ _3"></span>book, <span class="_ _9"></span>only <span class="_ _9"></span>Linux <span class="_ _3"></span>3.2.0, <span class="_ _9"></span>Mac <span class="_ _3"></span>OS <span class="_ _9"></span>X <span class="_ _9"></span>10.6.8, <span class="_ _3"></span>and <span class="_ _9"></span>Solaris <span class="_ _3"></span>10</div><div class="t m0 x76 hd6 y2053 ff19 fs1b fc0 sc0 ls0 ws0">provide <span class="_ _80"> </span>support <span class="_ _66"> </span>for<span class="_ _59"> </span><span class="ff1a">waitid</span><span class="ls9be">.N<span class="_ _52"></span><span class="ls0">ote, <span class="_ _66"> </span>however<span class="_ _1"></span><span class="ls9bf">,t<span class="_ _55"></span><span class="ls0">hat <span class="_ _66"> </span>Mac <span class="_ _66"> </span>OS <span class="_ _66"> </span>X <span class="_ _66"> </span>10.6.8 <span class="_ _66"> </span>doesn’t <span class="_ _66"> </span>set <span class="_ _66"> </span>all <span class="_ _66"> </span>the</span></span></span></span></div><div class="t m0 x76 hd6 y2054 ff19 fs1b fc0 sc0 ls0 ws0">information we expect in the<span class="_"> </span><span class="ff1a">siginfo<span class="_ _53"> </span></span>structure.</div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.892409px;bottom:1236.288916px;width:136.535805px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
