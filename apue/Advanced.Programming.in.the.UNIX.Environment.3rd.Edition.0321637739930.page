<div id="pf3a2" class="pf w4 h1f" data-page-no="3a2"><div class="pc pc3a2 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg3a2.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">896<span class="_ _1b"> </span><span class="ff19">Miscellaneous <span class="_"> </span>Source <span class="_"> </span>Code<span class="_ _2c"> </span>Appendix <span class="_"> </span>B</span></div><div class="t m0 x32 h57 y425 ff1a fs2d fc0 sc0 ls0 ws0">#if defined(MACOS) || !defined(TIOCGWINSZ)</div><div class="t m0 x32 h57 y426 ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;sys/ioctl.h&gt;</div><div class="t m0 x32 h57 y800 ff1a fs2d fc0 sc0 ls0 ws0">#endif</div><div class="t m0 x32 h57 y4226 ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;stdio.h&gt;<span class="_ _189"> </span>/* for convenience */</div><div class="t m0 x32 h57 y5f5c ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;stdlib.h&gt;<span class="_ _8a"> </span>/* for convenience */</div><div class="t m0 x32 h57 y5f5d ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;stddef.h&gt;<span class="_ _8a"> </span>/* for offsetof */</div><div class="t m0 x32 h57 y4208 ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;string.h&gt;<span class="_ _8a"> </span>/* for convenience */</div><div class="t m0 x32 h57 y13df ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;unistd.h&gt;<span class="_ _8a"> </span>/* for convenience */</div><div class="t m0 x32 h57 y13e0 ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;signal.h&gt;<span class="_ _8a"> </span>/* for SIG_ERR */</div><div class="t m0 x32 h57 y8d8 ff1a fs2d fc0 sc0 ls0 ws0">#define MAXLINE 4096<span class="_ _82"> </span>/* max line length */</div><div class="t m0 x32 h57 y16e4 ff1a fs2d fc0 sc0 ls0 ws0">/*</div><div class="t m0 x140 h57 y16e5 ff1a fs2d fc0 sc0 ls15c ws0">*D<span class="_ _1d"></span><span class="ls0">efault file access permissions for new files.</span></div><div class="t m0 x140 h57 y16e6 ff1a fs2d fc0 sc0 ls0 ws0">*/</div><div class="t m0 x32 h57 y16e7 ff1a fs2d fc0 sc0 ls0 ws0">#define FILE_MODE<span class="_ _68"> </span>(S_IRUSR | S_IWUSR | S_IRGRP | S_IROTH)</div><div class="t m0 x32 h57 y2f72 ff1a fs2d fc0 sc0 ls0 ws0">/*</div><div class="t m0 x140 h57 y2f73 ff1a fs2d fc0 sc0 ls15c ws0">*D<span class="_ _1d"></span><span class="ls0">efault permissions for new directories.</span></div><div class="t m0 x140 h57 y8e0 ff1a fs2d fc0 sc0 ls0 ws0">*/</div><div class="t m0 x32 h57 y8e1 ff1a fs2d fc0 sc0 ls0 ws0">#define DIR_MODE<span class="_ _15"> </span>(FILE_MODE | S_IXUSR | S_IXGRP | S_IXOTH)</div><div class="t m0 x32 h57 y5f5e ff1a fs2d fc0 sc0 ls0 ws0">typedef void<span class="_ _15"> </span>Sigfunc(int); <span class="_ _d9"> </span>/*<span class="_"> </span>for signal handlers */</div><div class="t m0 x32 h57 y8e4 ff1a fs2d fc0 sc0 ls0 ws0">#define min(a,b)<span class="_ _15"> </span>((a) &lt; (b) ? (a) : (b))</div><div class="t m0 x32 h57 y8e5 ff1a fs2d fc0 sc0 ls0 ws0">#define max(a,b)<span class="_ _15"> </span>((a) &gt; (b) ? (a) : (b))</div><div class="t m0 x32 h57 y5f5f ff1a fs2d fc0 sc0 ls0 ws0">/*</div><div class="t m0 x140 h57 y5f60 ff1a fs2d fc0 sc0 ls15c ws0">*P<span class="_ _1d"></span><span class="ls0">rototypes for our own functions.</span></div><div class="t m0 x140 h57 y5f61 ff1a fs2d fc0 sc0 ls0 ws0">*/</div><div class="t m0 x32 h57 y5f62 ff1a fs2d fc0 sc0 ls0 ws0">char <span class="_ _68"> </span>*path_alloc(size_t<span class="_"> </span>*); <span class="_ _13d"> </span>/*<span class="_"> </span>Figure 2.16 */</div><div class="t m0 x32 h57 y5f63 ff1a fs2d fc0 sc0 ls0 ws0">long <span class="_ _15"> </span>open_max(void);<span class="_ _296"> </span>/* Figure 2.17 */</div><div class="t m0 x32 h57 y3f81 ff1a fs2d fc0 sc0 ls0 ws0">int <span class="_ _8a"> </span>set_cloexec(int);<span class="_ _cb"> </span>/* Figure 13.9 */</div><div class="t m0 x32 h57 y2f7f ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _15"> </span>clr_fl(int,<span class="_"> </span>int);</div><div class="t m0 x32 h57 y2f80 ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _15"> </span>set_fl(int,<span class="_"> </span>int); <span class="_ _ce"> </span>/*<span class="_"> </span>Figure 3.12 */</div><div class="t m0 x32 h57 y5f64 ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _15"> </span>pr_exit(int);<span class="_ _1e5"> </span>/* Figure 8.5 */</div><div class="t m0 x32 h57 y42bb ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _15"> </span>pr_mask(const<span class="_"> </span>char *);<span class="_ _166"> </span>/* Figure 10.14 */</div><div class="t m0 x32 h57 y42bc ff1a fs2d fc0 sc0 ls0 ws0">Sigfunc *signal_intr(int, Sigfunc *);<span class="_ _b7"> </span>/* Figure 10.19 */</div><div class="t m0 x32 h57 y5f65 ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _15"> </span>daemonize(const<span class="_"> </span>char *);<span class="_ _bd"> </span>/* Figure 13.1 */</div><div class="t m0 x32 h57 y342c ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _15"> </span>sleep_us(unsigned<span class="_"> </span>int); <span class="_ _bd"> </span>/*<span class="_"> </span>Exercise 14.5 */</div><div class="t m0 x32 h57 y42bf ff1a fs2d fc0 sc0 ls0 ws0">ssize_t <span class="_"> </span>readn(int,<span class="_"> </span>void *, size_t);<span class="_ _186"> </span>/* Figure 14.24 */</div><div class="t m0 x32 h57 y42c0 ff1a fs2d fc0 sc0 ls0 ws0">ssize_t <span class="_"> </span>writen(int,<span class="_"> </span>const void *, size_t); /* Figure 14.24 */</div><div class="t m0 x32 h57 y5f66 ff1a fs2d fc0 sc0 ls0 ws0">int <span class="_ _8a"> </span>fd_pipe(int<span class="_"> </span>*); <span class="_ _1e9"> </span>/*<span class="_"> </span>Figure 17.2 */</div><div class="t m0 x32 h57 y5f67 ff1a fs2d fc0 sc0 ls0 ws0">int <span class="_ _8a"> </span>recv_fd(int,<span class="_"> </span>ssize_t (*func)(int,</div><div class="t m0 x4 h57 y5f68 ff1a fs2d fc0 sc0 ls0 ws0">const void *, size_t));<span class="_ _15"> </span>/* Figure 17.14 */</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
