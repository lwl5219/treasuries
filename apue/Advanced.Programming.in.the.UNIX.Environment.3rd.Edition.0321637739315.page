<div id="pf13b" class="pf w4 h1f" data-page-no="13b"><div class="pc pc13b w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg13b.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>8.17<span class="_ _16b"> </span>Process <span class="_"> </span>T<span class="_ _6"></span>imes<span class="_ _1b"> </span><span class="ff18">281</span></div><div class="t m0 x32 h57 y362 ff1a fs2d fc0 sc0 ls0 ws0">#include &quot;apue.h&quot;</div><div class="t m0 x32 h57 y3c0 ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;sys/times.h&gt;</div><div class="t m0 x32 h57 y3c1 ff1a fs2d fc0 sc0 ls0 ws0">static void pr_times(clock_t, struct tms *, struct tms *);</div><div class="t m0 x32 h57 y3c2 ff1a fs2d fc0 sc0 ls0 ws0">static void do_cmd(char *);</div><div class="t m0 x32 h57 y1d34 ff1a fs2d fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 h57 y158d ff1a fs2d fc0 sc0 ls0 ws0">main(int argc, char *argv[])</div><div class="t m0 x32 h57 y158e ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y158f ff1a fs2d fc0 sc0 ls0 ws0">int <span class="_ _15"> </span>i;</div><div class="t m0 x8a h57 y1590 ff1a fs2d fc0 sc0 ls0 ws0">setbuf(stdout, NULL);</div><div class="t m0 x8a h57 y1591 ff1a fs2d fc0 sc0 ls0 ws0">for (i = 1; i &lt; argc; i++)</div><div class="t m0 x9d h57 y1d37 ff1a fs2d fc0 sc0 ls0 ws0">do_cmd(argv[i]); <span class="_ _68"> </span>/*<span class="_"> </span>once for each command-line arg */</div><div class="t m0 x8a h57 y1d38 ff1a fs2d fc0 sc0 ls0 ws0">exit(0);</div><div class="t m0 x32 h57 y3cb ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y1d39 ff1a fs2d fc0 sc0 ls0 ws0">static void</div><div class="t m0 x32 h57 y24c6 ff1a fs2d fc0 sc0 ls0 ws0">do_cmd(char *cmd)<span class="_ _b7"> </span>/* execute and time the &quot;cmd&quot; */</div><div class="t m0 x32 h57 y24c7 ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y1f3c ff1a fs2d fc0 sc0 ls0 ws0">struct tms<span class="_ _d9"> </span>tmsstart, tmsend;</div><div class="t m0 x8a h57 y1f3d ff1a fs2d fc0 sc0 ls0 ws0">clock_t <span class="_ _15"> </span>start,<span class="_"> </span>end;</div><div class="t m0 x8a h57 y1f3e ff1a fs2d fc0 sc0 ls0 ws0">int <span class="_ _186"> </span>status;</div><div class="t m0 x8a h57 y855 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;\ncommand: %s\n&quot;, cmd);</div><div class="t m0 x8a h57 y24c8 ff1a fs2d fc0 sc0 ls0 ws0">if ((start = times(&amp;tmsstart)) == -1)<span class="_ _68"> </span>/* starting values */</div><div class="t m0 x9d h57 y1d40 ff1a fs2d fc0 sc0 ls0 ws0">err_sys(&quot;times error&quot;);</div><div class="t m0 x8a h57 y24c9 ff1a fs2d fc0 sc0 ls0 ws0">if ((status = system(cmd)) &lt; 0)<span class="_ _176"> </span>/* execute command */</div><div class="t m0 x9d h57 y24ca ff1a fs2d fc0 sc0 ls0 ws0">err_sys(&quot;system() error&quot;);</div><div class="t m0 x8a h57 y24cb ff1a fs2d fc0 sc0 ls0 ws0">if ((end = times(&amp;tmsend)) == -1)<span class="_ _b7"> </span>/* ending values */</div><div class="t m0 x9d h57 y24cc ff1a fs2d fc0 sc0 ls0 ws0">err_sys(&quot;times error&quot;);</div><div class="t m0 x8a h57 y24cd ff1a fs2d fc0 sc0 ls0 ws0">pr_times(end-start, &amp;tmsstart, &amp;tmsend);</div><div class="t m0 x8a h57 y24ce ff1a fs2d fc0 sc0 ls0 ws0">pr_exit(status);</div><div class="t m0 x32 h57 y24cf ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y24d0 ff1a fs2d fc0 sc0 ls0 ws0">static void</div><div class="t m0 x32 h57 y24d1 ff1a fs2d fc0 sc0 ls0 ws0">pr_times(clock_t real, struct tms *tmsstart, struct tms *tmsend)</div><div class="t m0 x32 h57 y24d2 ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y863 ff1a fs2d fc0 sc0 ls0 ws0">static long<span class="_ _8a"> </span>clktck = 0;</div><div class="t m0 x8a h57 y24d3 ff1a fs2d fc0 sc0 ls0 ws0">if (clktck == 0)<span class="_ _15"> </span>/* fetch clock ticks per second first time */</div><div class="t m0 x9d h57 y24d4 ff1a fs2d fc0 sc0 ls0 ws0">if ((clktck = sysconf(_SC_CLK_TCK)) &lt; 0)</div><div class="t m0 x1f h57 y24d5 ff1a fs2d fc0 sc0 ls0 ws0">err_sys(&quot;sysconf error&quot;);</div><div class="t m0 x8a h57 y24d6 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot; <span class="_"> </span>real: <span class="_"> </span>%7.2f\n&quot;,<span class="_"> </span>real / (double) clktck);</div><div class="t m0 x8a h57 y24d7 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot; <span class="_"> </span>user: <span class="_"> </span>%7.2f\n&quot;,</div><div class="t m0 x194 h57 y24d8 ff1a fs2d fc0 sc0 ls0 ws0">(tmsend-&gt;tms_utime - tmsstart-&gt;tms_utime) / (double) clktck);</div><div class="t m0 x8a h57 y24d9 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot; <span class="_"> </span>sys:<span class="_ _68"> </span>%7.2f\n&quot;,</div><div class="t m0 x194 h57 y24da ff1a fs2d fc0 sc0 ls0 ws0">(tmsend-&gt;tms_stime - tmsstart-&gt;tms_stime) / (double) clktck);</div><div class="t m0 x8a h57 y24db ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot; <span class="_"> </span>child<span class="_"> </span>user: <span class="_"> </span>%7.2f\n&quot;,</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
