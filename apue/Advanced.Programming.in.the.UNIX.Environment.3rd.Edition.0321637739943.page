<div id="pf3af" class="pf w4 h1f" data-page-no="3af"><div class="pc pc3af w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg3af.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Appendix <span class="_"> </span>C<span class="_ _322"> </span>Chapter <span class="_"> </span>4<span class="_ _54"> </span>Solutions<span class="_ _1b"> </span><span class="ff18">909</span></div><div class="t m0 x1a7 h57 y6033 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">umask 777</span></div><div class="t m0 x1a7 h57 y6034 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">date &gt; temp.foo</span></div><div class="t m0 x1a7 h57 y6035 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">ls -l temp.foo</span></div><div class="t m0 x1a7 h57 y6036 ff1a fs2d fc0 sc0 ls0 ws0">---------- <span class="_"> </span>1<span class="_"> </span>sar <span class="_ _186"> </span>29<span class="_"> </span>Feb <span class="_"> </span>5<span class="_"> </span>14:06 temp.foo</div><div class="t m0 x32 h2a y6037 ff18 fsf fc0 sc0 ls0 ws0">4.3<span class="_ _9b"> </span><span class="ff19">The following shows what happens when user<span class="_ _1"></span>-read permission is turned off:</span></div><div class="t m0 x1a7 h57 y6038 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">date &gt; foo</span></div><div class="t m0 x1a7 h57 y6039 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">chmod u-r foo<span class="_ _195"> </span><span class="ff1b">turn off user-read permission</span></span></div><div class="t m0 x1a7 h57 y603a ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">ls -l foo<span class="_ _194"> </span><span class="ff1b">verify the ﬁle’<span class="_ _1"></span><span class="ls110">sp<span class="_ _5"></span><span class="ls0">ermissions</span></span></span></span></div><div class="t m0 x1a7 h57 y603b ff1a fs2d fc0 sc0 ls0 ws0">--w-r--r-- <span class="_"> </span>1<span class="_"> </span>sar <span class="_ _186"> </span>29<span class="_"> </span>Feb <span class="_"> </span>5<span class="_"> </span>14:21 foo</div><div class="t m0 x1a7 h57 y603c ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">cat foo<span class="_ _279"> </span><span class="ff1b">and try to r<span class="_ _0"></span>ead it</span></span></div><div class="t m0 x1a7 h57 y603d ff1a fs2d fc0 sc0 ls0 ws0">cat: foo: Permission denied</div><div class="t m0 x32 h26 y603e ff18 fsf fc0 sc0 ls0 ws0">4.4<span class="_ _9b"> </span><span class="ff19">If <span class="_ _2"></span>we <span class="_ _3"></span>try<span class="_ _4"></span><span class="ls1812">,u<span class="_ _4f"></span><span class="ls0">sing <span class="_ _3"></span>either<span class="_ _47"> </span><span class="ff1a">open<span class="_ _47"> </span></span>or<span class="_ _47"> </span><span class="ff1a">creat</span>,<span class="_ _47"> </span>to<span class="_ _47"> </span>c<span class="ls45">re<span class="_ _2"></span></span>ate <span class="_ _3"></span>a <span class="_ _3"></span>ﬁle <span class="_ _3"></span>that <span class="_ _3"></span>already <span class="_ _2"></span>exists, <span class="_ _3"></span>the <span class="_ _3"></span>ﬁle’s</span></span></span></div><div class="t m0 x215 h2a y603f ff19 fsf fc0 sc0 ls0 ws0">access <span class="_ _47"> </span>permission <span class="_ _45"> </span>bits <span class="_ _45"> </span>ar<span class="_ _0"></span><span class="ls952">en<span class="_ _62"></span><span class="ls0">ot <span class="_ _45"> </span>changed.<span class="_ _5f"> </span><span class="ls5f">We <span class="_ _46"> </span>c<span class="_ _9"></span></span>an <span class="_ _45"> </span>verify <span class="_ _47"> </span>this <span class="_ _45"> </span>by <span class="_ _45"> </span>running <span class="_ _47"> </span>the</span></span></div><div class="t m0 x215 h2a y6040 ff19 fsf fc0 sc0 ls0 ws0">program fr<span class="_ _0"></span>om Figur<span class="_ _0"></span><span class="ls44">e4<span class="_ _d"></span><span class="ls0">.9:</span></span></div><div class="t m0 x1a7 h57 y6041 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">rm foo bar<span class="_ _1db"> </span><span class="ff1b">delete the ﬁles in case they already exist</span></span></div><div class="t m0 x1a7 h57 y6042 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">date &gt; foo<span class="_ _1db"> </span><span class="ff1b">create them with some data</span></span></div><div class="t m0 x1a7 h57 y6043 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">date &gt; bar</span></div><div class="t m0 x1a7 h57 y6044 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">chmod a-r foo bar<span class="_ _131"> </span><span class="ff1b">turn off all read permissions</span></span></div><div class="t m0 x1a7 h57 y6045 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">ls -l foo bar<span class="_ _19f"> </span><span class="ff1b">verify their permissions</span></span></div><div class="t m0 x1a7 h57 y6046 ff1a fs2d fc0 sc0 ls0 ws0">--w------- <span class="_"> </span>1<span class="_"> </span>sar <span class="_ _186"> </span>29<span class="_"> </span>Feb <span class="_"> </span>5<span class="_"> </span>14:25 bar</div><div class="t m0 x1a7 h57 y6047 ff1a fs2d fc0 sc0 ls0 ws0">--w------- <span class="_"> </span>1<span class="_"> </span>sar <span class="_ _186"> </span>29<span class="_"> </span>Feb <span class="_"> </span>5<span class="_"> </span>14:25 foo</div><div class="t m0 x1a7 h57 y6048 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">./a.out<span class="_ _af"> </span><span class="ff1b">run program from Figur<span class="_ _0"></span><span class="ls110">e4<span class="_ _5"></span><span class="ls0">.9</span></span></span></span></div><div class="t m0 x1a7 h57 y6049 ff1a fs2d fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">ls -l foo bar<span class="_ _19f"> </span><span class="ff1b">check permissions and sizes</span></span></div><div class="t m0 x1a7 h57 y604a ff1a fs2d fc0 sc0 ls0 ws0">--w------- <span class="_"> </span>1<span class="_"> </span>sar <span class="_ _176"> </span>0<span class="_"> </span>Feb <span class="_"> </span>5<span class="_"> </span>14:26 bar</div><div class="t m0 x1a7 h57 y604b ff1a fs2d fc0 sc0 ls0 ws0">--w------- <span class="_"> </span>1<span class="_"> </span>sar <span class="_ _176"> </span>0<span class="_"> </span>Feb <span class="_"> </span>5<span class="_"> </span>14:26 foo</div><div class="t m0 x215 h2a y604c ff19 fsf fc0 sc0 ls0 ws0">Note that the permissions didn’t change but that the ﬁles wer<span class="ls44">et<span class="_ _4f"></span><span class="ls4e">ru<span class="_ _2"></span><span class="ls0">ncated.</span></span></span></div><div class="t m0 x32 h2a y604d ff18 fsf fc0 sc0 ls0 ws0">4.5<span class="_ _9b"> </span><span class="ff19">The size <span class="_ _3"></span>of <span class="_ _3"></span>a <span class="_ _2"></span>directory <span class="_ _2"></span>should <span class="_ _3"></span>never <span class="_ _2"></span>be <span class="_ _3"></span>0, <span class="_ _2"></span>since <span class="_ _3"></span>ther<span class="ls81c">es<span class="_ _8"></span><span class="ls0">hould <span class="_ _3"></span>always <span class="_ _2"></span>be <span class="_ _3"></span>entries <span class="_ _2"></span>for</span></span></span></div><div class="t m0 x215 h2a y604e ff19 fsf fc0 sc0 ls0 ws0">dot <span class="_ _23"> </span>and <span class="_ _42"> </span>dot-dot.<span class="_ _51"> </span>The <span class="_ _23"> </span>size <span class="_ _23"> </span>of <span class="_ _42"> </span>a <span class="_ _23"> </span>symbolic <span class="_ _42"> </span>link <span class="_ _23"> </span>is <span class="_ _23"> </span>the <span class="_ _42"> </span>number <span class="_ _23"> </span>of <span class="_ _42"> </span>characters <span class="_ _23"> </span>in <span class="_ _23"> </span>the</div><div class="t m0 x215 h2a y604f ff19 fsf fc0 sc0 ls0 ws0">pathname contained <span class="_ _2"></span>in <span class="_ _2"></span>the <span class="_ _2"></span>symbolic <span class="_ _2"></span>link, and <span class="_ _2"></span>this <span class="_ _2"></span>pathname <span class="_ _2"></span>must <span class="_ _2"></span>always contain</div><div class="t m0 x215 h2a y6050 ff19 fsf fc0 sc0 ls0 ws0">at least one character<span class="_ _6"></span>.</div><div class="t m0 x32 h2a y6051 ff18 fsf fc0 sc0 ls0 ws0">4.7<span class="_ _9b"> </span><span class="ff19">The kernel has a <span class="_ _2"></span>default setting for <span class="_ _2"></span>the ﬁle <span class="_ _2"></span>access permission <span class="_ _2"></span>bits when <span class="_ _2"></span>it creates a</span></div><div class="t m0 x215 h26 y6052 ff19 fsf fc0 sc0 ls0 ws0">new<span class="_ _35"> </span><span class="ff1a">core<span class="_ _35"> </span></span>ﬁle. <span class="_ _35"> </span>In<span class="_ _44"> </span>this <span class="_ _23"> </span>example, <span class="_ _42"> </span>it <span class="_ _23"> </span>was<span class="_ _35"> </span><span class="ff1a">rw-r--r--</span><span class="ls1268">.T<span class="_ _26"></span><span class="ls0">his <span class="_ _23"> </span>default <span class="_ _42"> </span>value <span class="_ _23"> </span>may <span class="_ _42"> </span>or</span></span></div><div class="t m0 x215 h26 y6053 ff19 fsf fc0 sc0 ls0 ws0">may <span class="_ _3"></span>not <span class="_ _3"></span>be <span class="_ _3"></span>modiﬁed <span class="_ _3"></span>by <span class="_ _3"></span>the<span class="_ _45"> </span><span class="ff1a">umask<span class="_ _47"> </span></span>value. <span class="_ _47"> </span>The<span class="_ _47"> </span>shell <span class="_ _3"></span>also <span class="_ _3"></span>has <span class="_ _3"></span>a <span class="_ _9"></span>default <span class="_ _3"></span>setting <span class="_ _3"></span>for</div><div class="t m0 x215 h2a y6054 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _23"> </span>ﬁle <span class="_ _42"> </span>access <span class="_ _23"> </span>permission <span class="_ _42"> </span>bits <span class="_ _23"> </span>when <span class="_ _42"> </span>it <span class="_ _23"> </span>creates <span class="_ _23"> </span>a <span class="_ _23"> </span>new <span class="_ _42"> </span>ﬁle <span class="_ _23"> </span>for <span class="_ _42"> </span>redir<span class="_ _0"></span>ection. <span class="_ _35"> </span>In<span class="_ _35"> </span>this</div><div class="t m0 x215 h26 y6055 ff19 fsf fc0 sc0 ls0 ws0">example, <span class="_ _42"> </span>it <span class="_ _42"> </span>was<span class="_ _44"> </span><span class="ff1a">rw-rw-rw-</span><span class="ls14f3">,a<span class="_ _43"></span><span class="ls0">nd <span class="_ _42"> </span>this <span class="_ _42"> </span>value <span class="_ _42"> </span>is <span class="_ _42"> </span>always <span class="_ _42"> </span>modiﬁed <span class="_ _42"> </span>by <span class="_ _53"> </span>our <span class="_ _42"> </span>current</span></span></div><div class="t m0 x215 h26 y6056 ff1a fsf fc0 sc0 ls0 ws0">umask<span class="ff19 ls86">.I<span class="_ _4a"></span><span class="ls44">nt<span class="_ _d"></span><span class="ls0">his example, our<span class="_"> </span><span class="ff1a">umask<span class="_ _80"> </span></span>was 02.</span></span></span></div><div class="t m0 x32 h26 y6057 ff18 fsf fc0 sc0 ls0 ws0">4.8<span class="_ _9b"> </span><span class="ff19 ls5f">We <span class="_"> </span>c<span class="_ _9"></span><span class="ls0">an’t use<span class="_"> </span><span class="ff1a">du</span><span class="ls44">,b<span class="_ _d"></span><span class="ls0">ecause it requires either the name of the ﬁle, as in</span></span></span></span></div><div class="t m0 x1a7 h57 y6058 ff1a fs2d fc0 sc0 ls0 ws0">du tempfile</div><div class="t m0 x215 h2a y6059 ff19 fsf fc0 sc0 ls0 ws0">or a directory name, as in</div><div class="t m0 x1a7 h57 y605a ff1a fs2d fc0 sc0 ls0 ws0">du .</div><div class="t m0 x215 h26 y605b ff19 fsf fc0 sc0 ls0 ws0">But when <span class="_ _2"></span>the<span class="_ _47"> </span><span class="ff1a">unlink<span class="_ _66"> </span></span>function <span class="_ _2"></span>returns, the <span class="_ _2"></span>directory entry <span class="_ _2"></span>for<span class="_ _47"> </span><span class="ff1a">tempfile<span class="_ _66"> </span></span>is <span class="_ _2"></span>gone.</div><div class="t m0 x215 h26 y605c ff19 fsf fc0 sc0 ls0 ws0">The<span class="_ _44"> </span><span class="ff1a">du <span class="_ _d"></span>.<span class="_ _44"> </span><span class="ff19">command <span class="_ _53"> </span>just <span class="_ _53"> </span>shown <span class="_ _42"> </span>would <span class="_ _53"> </span>not <span class="_ _53"> </span>account <span class="_ _53"> </span>for <span class="_ _42"> </span>the <span class="_ _53"> </span>space <span class="_ _53"> </span>still <span class="_ _53"> </span>taken <span class="_ _42"> </span>by</span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
