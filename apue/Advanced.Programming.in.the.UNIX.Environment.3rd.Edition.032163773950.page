<div id="pf32" class="pf w4 h1f" data-page-no="32"><div class="pc pc32 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg32.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">16<span class="_ _1b"> </span><span class="ff19">UNIX <span class="_"> </span>System <span class="_"> </span>Overview<span class="_ _85"> </span>Chapter <span class="_"> </span>1</span></div><div class="t m0 x32 h26 y12f ff19 fsf fc0 sc0 ls0 ws0">Note <span class="_ _9"></span>that <span class="_ _23"> </span>we <span class="_ _23"></span>pass <span class="_ _9"></span>the <span class="_ _23"></span>name <span class="_ _23"></span>of <span class="_ _9"></span>the <span class="_ _23"></span>program—<span class="ff1a">argv[0]</span><span class="ls60">,w<span class="_ _43"></span><span class="ls0">hose <span class="_ _23"></span>value <span class="_ _9"></span>is<span class="_ _35"> </span><span class="ff1a">./a.out</span>—as</span></span></div><div class="t m0 x32 h26 y130 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _2"></span>argument <span class="_ _2"></span>to<span class="_ _47"> </span><span class="ff1a">perror</span><span class="ls188">.T<span class="_ _1d"></span><span class="ls0">his <span class="_ _2"></span>is <span class="_ _3"></span>a <span class="_ _2"></span>standar<span class="ls189">dc<span class="_ _8"></span><span class="ls0">onvention <span class="_ _3"></span>in <span class="_ _2"></span>the <span class="_ _3"></span>UNIX <span class="_ _2"></span>System.<span class="_ _61"> </span>By <span class="_ _3"></span>doing</span></span></span></span></div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">this, if the program is executed as part of a pipeline, as in</div><div class="t m0 x3f h57 y449 ff1a fs2d fc0 sc0 ls0 ws0">prog1 &lt; inputfile | prog2 | prog3 &gt; outputfile</div><div class="t m0 x32 h2a y44a ff19 fsf fc0 sc0 ls0 ws0">we ar<span class="ls44">ea<span class="_ _4f"></span><span class="ls0">ble to tell which of the three programs generated a particular err<span class="_ _0"></span>or message.</span></span></div><div class="t m0 x3f h4d y44b ff19 fs26 fc0 sc0 ls0 ws0">Instead of <span class="_ _2"></span>calling <span class="_ _2"></span>either<span class="_"> </span><span class="ff1a">strerror<span class="_ _47"> </span></span>or<span class="_"> </span><span class="ff1a">perror<span class="_ _66"> </span></span>directly<span class="_ _4"></span><span class="ls18a">,t<span class="_ _d"></span><span class="ls0">he examples <span class="_ _2"></span>in <span class="_ _2"></span>this text <span class="_ _2"></span>use</span></span></div><div class="t m0 x32 h49 y44c ff19 fs26 fc0 sc0 ls0 ws0">the <span class="_"> </span>error <span class="_"> </span>functions <span class="_"> </span>shown <span class="_"> </span>in <span class="_"> </span>Appendix <span class="_"> </span>B.<span class="_ _50"> </span>These <span class="_"> </span>functions <span class="_"> </span>let <span class="_"> </span>us <span class="_"> </span>use <span class="_ _66"> </span>the <span class="_"> </span>variable</div><div class="t m0 x32 h49 y44d ff19 fs26 fc0 sc0 ls0 ws0">argument list facility of ISO C to handle err<span class="_ _0"></span>or conditions with a single C statement.</div><div class="t m0 x35 h4c y44e ff16 fs26 fc0 sc0 ls0 ws0">Error Reco<span class="_ _1"></span>ver <span class="_ _d"></span>y</div><div class="t m0 x32 h4d y44f ff19 fs26 fc0 sc0 ls0 ws0">The errors deﬁned in<span class="_"> </span><span class="ff1a">&lt;errno.h&gt;<span class="_ _66"> </span></span>can be divided <span class="_ _2"></span>into two categories: <span class="_ _2"></span>fatal and nonfatal.</div><div class="t m0 x32 h49 y450 ff19 fs26 fc0 sc0 ls18b ws0">Af<span class="_ _d"></span><span class="ls0">atal error has no recovery action.<span class="_ _59"> </span>The best we can do is print an error message on the</span></div><div class="t m0 x32 h49 y451 ff19 fs26 fc0 sc0 ls0 ws0">user <span class="_ _a"></span>’s<span class="_ _44"> </span>screen <span class="_ _42"> </span>or <span class="_ _53"> </span>to <span class="_ _42"> </span>a <span class="_ _53"> </span>log <span class="_ _53"> </span>ﬁle, <span class="_ _42"> </span>and <span class="_ _53"> </span>then <span class="_ _53"> </span>exit.<span class="_ _54"> </span>Nonfatal <span class="_ _53"> </span>errors, <span class="_ _42"> </span>on <span class="_ _53"> </span>the <span class="_ _42"> </span>other <span class="_ _53"> </span>hand, <span class="_ _53"> </span>can</div><div class="t m0 x32 h49 y452 ff19 fs26 fc0 sc0 ls0 ws0">sometimes <span class="_ _9"></span>be <span class="_ _9"></span>dealt <span class="_ _23"></span>with <span class="_ _9"></span>mor<span class="ls18c">er<span class="_ _43"></span><span class="ls0">obustly<span class="_ _6"></span><span class="ls18d">.M<span class="_ _26"></span><span class="ls0">ost <span class="_ _9"></span>nonfatal <span class="_ _23"></span>errors <span class="_ _3"></span>ar<span class="ls18c">et<span class="_ _b"></span><span class="ls0">emporary<span class="_ _4"></span><span class="ls18c">,s<span class="_ _b"></span><span class="ls0">uch <span class="_ _9"></span>as <span class="_ _23"></span>a</span></span></span></span></span></span></span></span></div><div class="t m0 x32 h49 y453 ff19 fs26 fc0 sc0 lscc ws0">re<span class="ls0">source shortage, and might not occur when there<span class="_"> </span>is<span class="_"> </span>less activity on the system.</span></div><div class="t m0 x3f h4d y454 ff19 fs26 fc0 sc0 ls0 ws0">Resource-r<span class="_ _0"></span>elated <span class="_ _45"> </span>nonfatal <span class="_ _45"> </span>errors <span class="_ _45"> </span>include<span class="_ _5a"> </span><span class="ff1a">EAGAIN</span>,<span class="_ _51"> </span><span class="ff1a">ENFILE</span>,<span class="_ _5a"> </span><span class="ff1a">ENOBUFS</span>,<span class="_ _5a"> </span><span class="ff1a">ENOLCK</span>,</div><div class="t m0 x32 h4d y455 ff1a fs26 fc0 sc0 ls0 ws0">ENOSPC<span class="ff19">,<span class="_ _4b"> </span></span>EWOULDBLOCK<span class="ff19 ls18e">,a<span class="_ _55"></span><span class="ls0">nd <span class="_ _e"> </span>sometimes<span class="_ _4b"> </span><span class="ff1a">ENOMEM</span>.<span class="_ _48"> </span><span class="ff1a">EBUSY<span class="_ _4b"> </span></span>can <span class="_ _e"> </span>be <span class="_ _e"> </span>treated <span class="_ _53"> </span>as <span class="_ _e"> </span>nonfatal</span></span></div><div class="t m0 x32 h4d y456 ff19 fs26 fc0 sc0 ls0 ws0">when it <span class="_ _2"></span>indicates that <span class="_ _2"></span>a <span class="_ _2"></span>shared resour<span class="_ _0"></span>ce is <span class="_ _2"></span>in use.<span class="_ _61"> </span>Sometimes,<span class="_"> </span><span class="ff1a">EINTR<span class="_ _66"> </span></span>can <span class="_ _2"></span>be treated as <span class="_ _2"></span>a</div><div class="t m0 x32 h49 y457 ff19 fs26 fc0 sc0 ls0 ws0">nonfatal error when it interr<span class="_ _0"></span>upts a slow system call (more<span class="_"> </span>on<span class="_"> </span>this in Section 10.5).</div><div class="t m0 x3f h49 y458 ff19 fs26 fc0 sc0 ls0 ws0">The typical recovery action for <span class="_ _2"></span>a resource-r<span class="_ _0"></span>elated nonfatal error is to delay <span class="_ _2"></span>and retry</div><div class="t m0 x32 h49 y459 ff19 fs26 fc0 sc0 ls0 ws0">later<span class="_ _6"></span><span class="ls18f">.T<span class="_ _7"></span><span class="ls0">his <span class="_ _42"> </span>technique <span class="_ _42"> </span>can <span class="_ _23"> </span>be <span class="_ _42"> </span>applied <span class="_ _23"> </span>in <span class="_ _42"> </span>other <span class="_ _42"> </span>circumstances. <span class="_ _35"> </span>For<span class="_ _35"> </span>example, <span class="_ _23"> </span>if <span class="_ _42"> </span>an <span class="_ _42"> </span>err<span class="_ _0"></span>or</span></span></div><div class="t m0 x32 h49 y45a ff19 fs26 fc0 sc0 ls0 ws0">indicates that a <span class="_ _2"></span>network connection is <span class="_ _2"></span>no longer <span class="_ _2"></span>functioning, it might <span class="_ _2"></span>be possible for <span class="_ _2"></span>the</div><div class="t m0 x32 h49 y45b ff19 fs26 fc0 sc0 ls0 ws0">application to delay a short time and then reestablish the connection.<span class="_ _46"> </span>Some applications</div><div class="t m0 x32 h49 y45c ff19 fs26 fc0 sc0 ls0 ws0">use <span class="_ _44"> </span>an <span class="_ _44"> </span>exponential <span class="_ _44"> </span>backof<span class="_ _0"></span><span class="ls190">fa<span class="_ _52"></span><span class="ls0">lgorithm, <span class="_ _44"> </span>waiting <span class="_ _44"> </span>a <span class="_ _44"> </span>longer <span class="_ _44"> </span>period <span class="_ _44"> </span>of <span class="_ _44"> </span>time <span class="_ _44"> </span>in <span class="_ _44"> </span>each</span></span></div><div class="t m0 x32 h49 y45d ff19 fs26 fc0 sc0 ls0 ws0">subsequent iteration.</div><div class="t m0 x3f h49 y45e ff19 fs26 fc0 sc0 ls0 ws0">Ultimately<span class="_ _4"></span>,<span class="_ _44"> </span>it<span class="_ _44"> </span>is<span class="_ _35"> </span>up<span class="_ _44"> </span>to<span class="_ _35"> </span>the <span class="_ _42"> </span>application <span class="_ _42"> </span>developer <span class="_ _42"> </span>to <span class="_ _42"> </span>determine <span class="_ _42"> </span>the <span class="_ _42"> </span>cases <span class="_ _42"> </span>wher<span class="ls191">ea<span class="_ _43"></span><span class="ls0">n</span></span></div><div class="t m0 x32 h49 y45f ff19 fs26 fc0 sc0 ls0 ws0">application can <span class="_ _2"></span>recover <span class="_ _2"></span>from an <span class="_ _2"></span>error<span class="_ _6"></span><span class="ls192">.I<span class="_ _5b"></span><span class="ls193">far<span class="_ _4f"></span><span class="ls0">easonable <span class="_ _2"></span>recovery strategy <span class="_ _2"></span>can <span class="_ _2"></span>be <span class="_ _2"></span>used, we</span></span></span></div><div class="t m0 x32 h49 y460 ff19 fs26 fc0 sc0 ls0 ws0">can improve the r<span class="_ _0"></span>obustness of our application by avoiding an abnormal exit.</div><div class="t m0 x35 h4b y461 ff16 fs27 fc0 sc0 ls0 ws0">1.8 <span class="_ _68"> </span>User<span class="_ _54"> </span>Identiﬁcation</div><div class="t m0 x35 h4c y462 ff16 fs26 fc0 sc0 ls0 ws0">User ID</div><div class="t m0 x32 h4a y463 ff19 fs26 fc0 sc0 ls0 ws0">The<span class="_ _47"> </span><span class="ff1b">user <span class="_ _9"></span>ID<span class="_ _45"> </span></span>fr<span class="_ _0"></span>om <span class="_ _3"></span>our <span class="_ _9"></span>entry <span class="_ _9"></span>in <span class="_ _3"></span>the <span class="_ _9"></span>passwor<span class="ls194">dﬁ<span class="_ _b"></span><span class="ls0">le <span class="_ _9"></span>is <span class="_ _3"></span>a <span class="_ _9"></span>numeric <span class="_ _3"></span>value <span class="_ _9"></span>that <span class="_ _9"></span>identiﬁes <span class="_ _3"></span>us <span class="_ _9"></span>to</span></span></div><div class="t m0 x32 h49 y464 ff19 fs26 fc0 sc0 ls0 ws0">the <span class="_ _2"></span>system.<span class="_ _16"> </span>This <span class="_ _3"></span>user <span class="_ _2"></span>ID <span class="_ _3"></span>is <span class="_ _3"></span>assigned <span class="_ _2"></span>by <span class="_ _3"></span>the <span class="_ _3"></span>system <span class="_ _2"></span>administrator <span class="_ _3"></span>when <span class="_ _3"></span>our <span class="_ _3"></span>login <span class="_ _2"></span>name</div><div class="t m0 x32 h49 y465 ff19 fs26 fc0 sc0 ls0 ws0">is assigned, <span class="_ _2"></span>and <span class="_ _2"></span>we <span class="_ _2"></span>cannot change <span class="_ _2"></span>it.<span class="_ _61"> </span>The user <span class="_ _2"></span>ID <span class="_ _2"></span>is <span class="_ _2"></span>normally assigned <span class="_ _2"></span>to <span class="_ _2"></span>be <span class="_ _2"></span>unique for</div><div class="t m0 x32 h49 y466 ff19 fs26 fc0 sc0 ls0 ws0">every <span class="_ _23"> </span>user<span class="_ _1"></span><span class="ls195">.W<span class="_ _5d"></span><span class="ls0">e’ll <span class="_ _42"> </span>see <span class="_ _42"> </span>how <span class="_ _23"> </span>the <span class="_ _42"> </span>kernel <span class="_ _23"> </span>uses <span class="_ _42"> </span>the <span class="_ _23"> </span>user <span class="_ _42"> </span>ID <span class="_ _23"> </span>to <span class="_ _42"> </span>check <span class="_ _42"> </span>whether <span class="_ _23"> </span>we <span class="_ _42"> </span>have <span class="_ _23"> </span>the</span></span></div><div class="t m0 x32 h49 y467 ff19 fs26 fc0 sc0 ls0 ws0">appropriate permissions to perform certain operations.</div><div class="t m0 x3f h4a y468 ff19 fs26 fc0 sc0 ls164 ws0">We <span class="_ _45"> </span>c<span class="_ _9"></span><span class="ls0">all <span class="_ _23"> </span>the <span class="_ _42"> </span>user <span class="_ _42"> </span>whose <span class="_ _42"> </span>user <span class="_ _23"> </span>ID <span class="_ _42"> </span>is <span class="_ _42"> </span>0 <span class="_ _42"> </span>either<span class="_ _35"> </span><span class="ff1b lscc">ro<span class="_ _2"></span><span class="ls0">ot<span class="_ _35"> </span></span></span>or <span class="_ _42"> </span>the<span class="_ _35"> </span><span class="ff1b">superuser</span><span class="ls196">.T<span class="_ _7"></span><span class="ls0">he <span class="_ _42"> </span>entry <span class="_ _42"> </span>in <span class="_ _42"> </span>the</span></span></span></div><div class="t m0 x32 h4d y469 ff19 fs26 fc0 sc0 ls0 ws0">passwor<span class="ls197">dﬁ<span class="_ _8"></span><span class="ls0">le <span class="_ _2"></span>normally <span class="_ _3"></span>has <span class="_ _2"></span>a <span class="_ _2"></span>login <span class="_ _3"></span>name <span class="_ _2"></span>of<span class="_ _47"> </span><span class="ff1a">root</span><span class="ls197">,a<span class="_ _4f"></span><span class="ls0">nd <span class="_ _2"></span>we <span class="_ _2"></span>refer <span class="_ _2"></span>to <span class="_ _2"></span>the <span class="_ _3"></span>special <span class="_ _2"></span>privileges</span></span></span></span></div><div class="t m0 x32 h49 y46a ff19 fs26 fc0 sc0 ls0 ws0">of this user as <span class="_ _2"></span>superuser privileges.<span class="_ _46"> </span>As we’ll see in <span class="_ _2"></span>Chapter 4, if <span class="_ _2"></span>a process has superuser</div><div class="t m0 x32 h49 y46b ff19 fs26 fc0 sc0 ls0 ws0">privileges, <span class="_ _3"></span>most <span class="_ _3"></span>ﬁle <span class="_ _3"></span>permission <span class="_ _3"></span>checks <span class="_ _3"></span>ar<span class="ls198">eb<span class="_ _b"></span><span class="ls0">ypassed. <span class="_ _45"> </span>Some<span class="_ _47"> </span>operating <span class="_ _2"></span>system <span class="_ _3"></span>functions</span></span></div><div class="t m0 x32 h49 y46c ff19 fs26 fc0 sc0 ls0 ws0">ar<span class="lsd3">er<span class="_ _4f"></span><span class="ls0">estricted to the superuser<span class="_ _6"></span><span class="ls199">.T<span class="_ _4a"></span><span class="ls0">he superuser has free r<span class="_ _1"></span>ein over the system.</span></span></span></span></div><a class="l" href="#pfb" data-dest-detail='[11,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.891576px;bottom:425.058878px;width:144.023201px;height:19.680023px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
