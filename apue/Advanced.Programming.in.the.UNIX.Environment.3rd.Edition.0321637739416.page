<div id="pf1a0" class="pf w4 h1f" data-page-no="1a0"><div class="pc pc1a0 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg1a0.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">382<span class="_ _1b"> </span><span class="ff19">Signals <span class="_ _24b"> </span>Chapter<span class="_ _21"> </span>10</span></div><div class="t m0 x32 h57 yddc ff18 fs2d fc0 sc0 ls0 ws0">10.10<span class="_ _48"> </span><span class="ff19 ls467">Wr<span class="_ _9"></span><span class="ls0">ite <span class="_ _23"></span>a <span class="_ _9"></span>program <span class="_ _23"></span>that <span class="_ _9"></span>calls<span class="_ _45"> </span><span class="ff1a">sleep(60)<span class="_ _45"> </span></span>in <span class="_ _23"></span>an <span class="_ _9"></span>inﬁnite <span class="_ _23"> </span>loop.<span class="_ _16"> </span>Every <span class="_ _23"> </span>ﬁve <span class="_ _23"></span>times <span class="_ _9"></span>through <span class="_ _23"></span>the</span></span></div><div class="t m0 xe1 h57 yddd ff19 fs2d fc0 sc0 ls0 ws0">loop <span class="_ _3"></span>(every <span class="_ _3"></span>5 <span class="_ _2"></span>minutes), <span class="_ _3"></span>fetch <span class="_ _3"></span>the <span class="_ _3"></span>current <span class="_ _3"></span>time <span class="_ _3"></span>of <span class="_ _3"></span>day <span class="_ _3"></span>and <span class="_ _3"></span>print <span class="_ _3"></span>the<span class="_ _66"> </span><span class="ff1a">tm_sec<span class="_ _66"> </span></span>ﬁeld. <span class="_ _47"> </span>Run<span class="_ _66"> </span>the</div><div class="t m0 xe1 h57 ydde ff19 fs2d fc0 sc0 ls0 ws0">program <span class="_ _53"> </span>overnight <span class="_ _53"> </span>and <span class="_"> </span>explain <span class="_ _53"> </span>the <span class="_"> </span>r<span class="_ _0"></span>esults. <span class="_ _44"> </span>How<span class="_ _44"> </span>would <span class="_"> </span>a <span class="_ _42"> </span>program <span class="_"> </span>such <span class="_ _42"> </span>as <span class="_"> </span>the<span class="_ _44"> </span><span class="ff1a">cron</span></div><div class="t m0 xe1 h5f y1451 ff19 fs2d fc0 sc0 ls0 ws0">daemon, which runs every minute on the minute, handle this situation?</div><div class="t m0 x32 h57 y1452 ff18 fs2d fc0 sc0 ls0 ws0">10.1<span class="_ _0"></span>1<span class="_ _60"> </span><span class="ff19">Modify <span class="_ _9"></span>Figur<span class="lsd6f">e3<span class="_ _8"></span><span class="ls0">.5 <span class="_ _9"></span>as <span class="_ _9"></span>follows: <span class="_ _23"> </span>(a) <span class="_ _9"></span>change<span class="_ _47"> </span><span class="ff1a">BUFFSIZE<span class="_ _45"> </span></span>to <span class="_ _9"></span>100; <span class="_ _9"></span>(b) <span class="_ _23"> </span>catch <span class="_ _9"></span>the<span class="_ _45"> </span><span class="ff1a">SIGXFSZ<span class="_ _47"> </span></span>signal</span></span></span></div><div class="t m0 xe1 h57 y1453 ff19 fs2d fc0 sc0 ls0 ws0">using <span class="_ _53"> </span>the<span class="_ _44"> </span><span class="ff1a">signal_intr<span class="_ _44"> </span></span>function, <span class="_ _53"> </span>printing <span class="_"> </span>a <span class="_ _42"> </span>message <span class="_"> </span>when <span class="_ _42"> </span>it’s <span class="_"> </span>caught, <span class="_ _42"> </span>and <span class="_ _53"> </span>returning</div><div class="t m0 xe1 h57 y1454 ff19 fs2d fc0 sc0 ls0 ws0">from the signal handler; and (c) print the <span class="_ _2"></span>return value from<span class="_"> </span><span class="ff1a">write<span class="_ _e"> </span></span>if the requested number</div><div class="t m0 xe1 h57 y1455 ff19 fs2d fc0 sc0 ls0 ws0">of <span class="_ _23"> </span>bytes <span class="_ _23"> </span>wasn’t <span class="_ _23"> </span>written.<span class="_ _5a"> </span>Modify <span class="_ _23"> </span>the <span class="_ _23"> </span>soft<span class="_ _45"> </span><span class="ff1a">RLIMIT_FSIZE<span class="_ _45"> </span></span><span class="ls1e7">re<span class="_ _2"></span></span>source <span class="_ _23"> </span>limit <span class="_ _23"> </span>(Section <span class="_ _23"> </span>7.1<span class="_ _1"></span>1) <span class="_ _23"> </span>to</div><div class="t m0 xe1 h5f y1456 ff19 fs2d fc0 sc0 ls0 ws0">1,024 <span class="_ _3"></span>bytes <span class="_ _3"></span>and <span class="_ _2"></span>run <span class="_ _3"></span>your <span class="_ _3"></span>new <span class="_ _3"></span>program, <span class="_ _3"></span>copying <span class="_ _2"></span>a <span class="_ _3"></span>ﬁle <span class="_ _3"></span>that <span class="_ _3"></span>is <span class="_ _3"></span>larger <span class="_ _3"></span>than <span class="_ _3"></span>1,024 <span class="_ _3"></span>bytes.<span class="_ _46"> </span>(T<span class="_ _6"></span>ry</div><div class="t m0 xe1 h5f y1457 ff19 fs2d fc0 sc0 ls0 ws0">to <span class="_ _42"> </span>set <span class="_ _42"> </span>the <span class="_ _42"> </span>soft <span class="_ _42"> </span>resour<span class="_ _0"></span>ce <span class="_ _42"> </span>limit <span class="_ _42"> </span>from <span class="_ _23"> </span>your <span class="_ _42"> </span>shell.<span class="_ _51"> </span>If <span class="_ _42"> </span>you <span class="_ _42"> </span>can’t <span class="_ _42"> </span>do <span class="_ _42"> </span>this <span class="_ _42"> </span>from <span class="_ _23"> </span>your <span class="_ _42"> </span>shell, <span class="_ _42"> </span>call</div><div class="t m0 xe1 h57 y30ce ff1a fs2d fc0 sc0 ls0 ws0">setrlimit<span class="_ _45"> </span><span class="ff19">dir<span class="_ _0"></span>ectly <span class="_ _9"></span>from <span class="_ _9"></span>the <span class="_ _23"> </span>program.) <span class="_ _47"> </span>Run<span class="_ _45"> </span>this <span class="_ _23"> </span>program <span class="_ _9"></span>on <span class="_ _9"></span>the <span class="_ _23"> </span>differ<span class="_ _0"></span>ent <span class="_ _9"></span>systems <span class="_ _23"> </span>that</span></div><div class="t m0 xe1 h5f y30cf ff19 fs2d fc0 sc0 ls0 ws0">you have access to.<span class="_ _4b"> </span>What happens and why?</div><div class="t m0 x32 h57 y30d0 ff18 fs2d fc0 sc0 ls0 ws0">10.12<span class="_ _48"> </span><span class="ff19 ls467">Wr<span class="_ _9"></span><span class="ls0">ite <span class="_ _2"></span>a <span class="_ _2"></span>program that <span class="_ _2"></span>calls<span class="_ _66"> </span><span class="ff1a">fwrite<span class="_ _80"> </span></span>with <span class="_ _2"></span>a <span class="_ _2"></span>large buffer <span class="_ _2"></span>(about <span class="_ _2"></span>one gigabyte).<span class="_ _59"> </span>Befor<span class="lsd70">ec<span class="_ _d"></span><span class="ls0">alling</span></span></span></span></div><div class="t m0 xe1 h57 y30d1 ff1a fs2d fc0 sc0 ls0 ws0">fwrite<span class="ff19 lsd71">,c<span class="_ _d"></span><span class="ls0">all<span class="_ _66"> </span><span class="ff1a">alarm<span class="_ _80"> </span></span>to <span class="_ _2"></span>schedule <span class="_ _2"></span>a <span class="_ _2"></span>signal in <span class="_ _2"></span>1 <span class="_ _2"></span>second.<span class="_ _59"> </span>In <span class="_ _2"></span>your <span class="_ _2"></span>signal <span class="_ _2"></span>handler<span class="_ _1"></span><span class="lsd72">,p<span class="_ _d"></span><span class="ls0">rint <span class="_ _2"></span>that <span class="_ _2"></span>the</span></span></span></span></div><div class="t m0 xe1 h57 y30d2 ff19 fs2d fc0 sc0 ls0 ws0">signal was caught and return. <span class="_"> </span>Does<span class="_"> </span>the call to<span class="_"> </span><span class="ff1a">fwrite<span class="_ _e"> </span></span>complete? <span class="_"> </span>What’s<span class="_"> </span>happening?</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
