<div id="pf9b" class="pf w4 h1f" data-page-no="9b"><div class="pc pc9b w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg9b.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>4.17<span class="_ _f1"> </span>Symbolic <span class="_"> </span>Links<span class="_ _1b"> </span><span class="ff18">121</span></div><div class="t m0 x76 h52 y2a3 ff19 fs2a fc0 sc0 ls0 ws0">Symbolic links wer<span class="ls562">ei<span class="_ _5"></span><span class="ls0">ntroduced with 4.2BSD.<span class="_ _44"> </span>Initially<span class="_ _6"></span>,<span class="_"> </span><span class="ff1a">chown<span class="_ _53"> </span></span>didn’t follow symbolic links, but</span></span></div><div class="t m0 x76 h51 y2a4 ff19 fs2a fc0 sc0 ls0 ws0">this <span class="_ _2"></span>behavior <span class="_ _2"></span>was <span class="_ _3"></span>changed <span class="_ _2"></span>in <span class="_ _3"></span>4.4BSD.<span class="_ _44"> </span>System <span class="_ _3"></span>V <span class="_ _2"></span>included <span class="_ _3"></span>support <span class="_ _2"></span>for <span class="_ _3"></span>symbolic <span class="_ _2"></span>links <span class="_ _2"></span>in <span class="_ _3"></span>SVR4,</div><div class="t m0 x76 h52 y2a5 ff19 fs2a fc0 sc0 ls0 ws0">but diverged from the original BSD behavior by implementing<span class="_"> </span><span class="ff1a">chown<span class="_ _53"> </span></span>to <span class="_ _2"></span>follow symbolic links.</div><div class="t m0 x76 h52 y2a6 ff19 fs2a fc0 sc0 ls0 ws0">In <span class="_ _9"></span>older <span class="_ _23"> </span>versions <span class="_ _9"></span>of <span class="_ _9"></span>Linux <span class="_ _23"> </span>(those <span class="_ _9"></span>befor<span class="ls563">ev<span class="_ _8"></span><span class="ls0">ersion <span class="_ _9"> </span>2.1.81),<span class="_ _47"> </span><span class="ff1a">chown<span class="_ _47"> </span></span>didn’t <span class="_ _23"> </span>follow <span class="_ _9"></span>symbolic <span class="_ _9"> </span>links.</span></span></div><div class="t m0 x76 h52 y2a7 ff19 fs2a fc0 sc0 ls0 ws0">From <span class="_ _42"> </span>version <span class="_ _42"> </span>2.1.81 <span class="_ _42"> </span>onward,<span class="_ _35"> </span><span class="ff1a">chown<span class="_ _45"> </span></span>follows <span class="_"> </span>symbolic <span class="_ _42"> </span>links.<span class="_ _16"> </span><span class="ls341">Wi<span class="_ _2"></span></span>th <span class="_"> </span>FreeBSD <span class="_ _23"> </span>8.0, <span class="_"> </span>Mac <span class="_ _42"> </span>OS <span class="_ _42"> </span>X</div><div class="t m0 x76 h52 y2a8 ff19 fs2a fc0 sc0 ls0 ws0">10.6.8, <span class="_ _45"> </span>and <span class="_ _45"> </span>Solaris <span class="_ _45"> </span>10,<span class="_ _61"> </span><span class="ff1a">chown<span class="_ _16"> </span></span>follows <span class="_ _45"> </span>symbolic <span class="_ _45"> </span>links.<span class="_ _60"> </span>All <span class="_ _45"> </span>of <span class="_ _45"> </span>these <span class="_ _45"> </span>platforms <span class="_ _45"> </span>provide</div><div class="t m0 x76 h52 y2a9 ff19 fs2a fc0 sc0 ls0 ws0">implementations of<span class="_"> </span><span class="ff1a">lchown<span class="_ _53"> </span></span>to change the ownership of symbolic links themselves.</div><div class="t m0 xe0 h2d y116b ff19 fs10 fc0 sc0 ls0 ws0">Does not follow<span class="_ _dc"> </span>Follows</div><div class="t m0 x1ab h2d y116c ff19 fs10 fc0 sc0 ls0 ws0">symbolic link<span class="_ _13"> </span>symbolic link</div><div class="t m0 x36 h2d y116d ff19 fs10 fc0 sc0 ls0 ws0">Function</div><div class="t m0 x36 h4f y116e ff1a fs11 fc0 sc0 ls0 ws0">access<span class="_ _1a2"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y116f ff1a fs11 fc0 sc0 ls0 ws0">chdir<span class="_ _1a4"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y1170 ff1a fs11 fc0 sc0 ls0 ws0">chmod<span class="_ _1a4"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y1171 ff1a fs11 fc0 sc0 ls0 ws0">chown<span class="_ _1a4"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y1172 ff1a fs11 fc0 sc0 ls0 ws0">creat<span class="_ _1a4"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y1173 ff1a fs11 fc0 sc0 ls0 ws0">exec<span class="_ _1a5"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y1174 ff1a fs11 fc0 sc0 ls0 ws0">lchown<span class="_ _b2"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y1175 ff1a fs11 fc0 sc0 ls0 ws0">link<span class="_ _1a5"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y1176 ff1a fs11 fc0 sc0 ls0 ws0">lstat<span class="_ _bc"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y1177 ff1a fs11 fc0 sc0 ls0 ws0">open<span class="_ _1a5"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y1178 ff1a fs11 fc0 sc0 ls0 ws0">opendir<span class="_ _1a6"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y1179 ff1a fs11 fc0 sc0 ls0 ws0">pathconf<span class="_ _1a7"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y117a ff1a fs11 fc0 sc0 ls0 ws0">readlink<span class="_ _b7"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y117b ff1a fs11 fc0 sc0 ls0 ws0">remove<span class="_ _b2"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y117c ff1a fs11 fc0 sc0 ls0 ws0">rename<span class="_ _b2"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y117d ff1a fs11 fc0 sc0 ls0 ws0">stat<span class="_ _1a5"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y117e ff1a fs11 fc0 sc0 ls0 ws0">truncate<span class="_ _1a7"> </span><span class="ff19">•</span></div><div class="t m0 x36 h4f y117f ff1a fs11 fc0 sc0 ls0 ws0">unlink<span class="_ _b2"> </span><span class="ff19">•</span></div><div class="t m0 x180 h2f y1180 ff18 fs12 fc0 sc0 ls0 ws0">Figure 4.17<span class="_ _5a"> </span><span class="ff19 ls425">Tr <span class="_ _1"></span>e<span class="_ _3"></span><span class="ls0">atment of symbolic links by various functions</span></span></div><div class="t m0 x3f h5c y1181 ff19 fs29 fc0 sc0 ls0 ws0">One <span class="_ _42"> </span>exception <span class="_ _23"> </span>to <span class="_ _42"> </span>the <span class="_ _42"> </span>behavior <span class="_ _23"> </span>summarized <span class="_ _42"> </span>in <span class="_ _42"> </span>Figur<span class="ls564">e4<span class="_ _43"></span><span class="ls0">.17 <span class="_ _23"> </span>occurs <span class="_ _42"> </span>when <span class="_ _42"> </span>the<span class="_ _35"> </span><span class="ff1a">open</span></span></span></div><div class="t m0 x32 h5c y1182 ff19 fs29 fc0 sc0 ls0 ws0">function <span class="_ _42"> </span>is <span class="_ _42"> </span>called <span class="_ _23"> </span>with <span class="_ _42"> </span>both<span class="_ _44"> </span><span class="ff1a">O_CREAT<span class="_ _35"> </span></span>and<span class="_ _44"> </span><span class="ff1a">O_EXCL<span class="_ _44"> </span></span>set. <span class="_ _35"> </span>In<span class="_ _44"> </span>this <span class="_ _23"> </span>case, <span class="_ _42"> </span>if <span class="_ _42"> </span>the <span class="_ _42"> </span>pathname</div><div class="t m0 x32 h5c y1183 ff19 fs29 fc0 sc0 lsdf ws0">re<span class="ls0">fers <span class="_ _42"> </span>to <span class="_ _42"> </span>a <span class="_ _23"> </span>symbolic <span class="_ _42"> </span>link,<span class="_ _35"> </span><span class="ff1a">open<span class="_ _44"> </span></span>will <span class="_ _23"> </span>fail <span class="_ _42"> </span>with<span class="_ _35"> </span><span class="ff1a">errno<span class="_ _44"> </span></span>set <span class="_ _23"> </span>to<span class="_ _44"> </span><span class="ff1a">EEXIST</span><span class="ls565">.T<span class="_ _52"></span><span class="ls0">his <span class="_ _42"> </span>behavior <span class="_ _42"> </span>is</span></span></span></div><div class="t m0 x32 h50 y1184 ff19 fs29 fc0 sc0 ls0 ws0">intended to close a <span class="_ _2"></span>security hole so <span class="_ _2"></span>that privileged processes can’t be <span class="_ _2"></span>fooled into writing</div><div class="t m0 x32 h50 y1185 ff19 fs29 fc0 sc0 ls0 ws0">to the wrong ﬁles.</div><div class="t m0 x35 h5a y1186 ff16 fs29 fc0 sc0 ls0 ws0">Example</div><div class="t m0 x32 h50 y1187 ff19 fs29 fc0 sc0 ls0 ws0">It <span class="_ _e"> </span>is <span class="_ _e"> </span>possible <span class="_ _e"> </span>to <span class="_ _e"> </span>introduce <span class="_ _e"> </span>loops <span class="_ _e"> </span>into <span class="_ _e"> </span>the <span class="_ _e"> </span>ﬁle <span class="_"> </span>system <span class="_ _53"> </span>by <span class="_ _e"> </span>using <span class="_ _e"> </span>symbolic <span class="_ _e"> </span>links.<span class="_ _48"> </span>Most</div><div class="t m0 x32 h5c y1188 ff19 fs29 fc0 sc0 ls0 ws0">functions <span class="_ _47"> </span>that <span class="_ _47"> </span>look <span class="_ _47"> </span>up <span class="_ _47"> </span>a <span class="_ _66"> </span>pathname <span class="_ _47"> </span>return <span class="_ _47"> </span>an<span class="_ _61"> </span><span class="ff1a">errno<span class="_ _16"> </span></span>of<span class="_ _61"> </span><span class="ff1a">ELOOP<span class="_ _16"> </span></span>when <span class="_ _47"> </span>this <span class="_ _47"> </span>occurs.</div><div class="t m0 x32 h50 y1189 ff19 fs29 fc0 sc0 ls0 ws0">Consider the following commands:</div><div class="t m0 x3f h62 y118a ff1a fs30 fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">mkdir foo<span class="_ _d4"> </span><span class="ff1b">make a new dir<span class="_ _0"></span>ectory</span></span></div><div class="t m0 x3f h62 y118b ff1a fs30 fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">touch foo/a<span class="_ _b0"> </span><span class="ff1b">create a 0-length ﬁle</span></span></div><div class="t m0 x3f h62 y118c ff1a fs30 fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">ln -s ../foo foo/testdir<span class="_ _1a8"> </span><span class="ff1b">create a symbolic link</span></span></div><div class="t m0 x3f h62 y118d ff1a fs30 fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">ls -l foo</span></div><div class="t m0 x3f h62 y118e ff1a fs30 fc0 sc0 ls0 ws0">total 0</div><div class="t m0 x3f h62 y118f ff1a fs30 fc0 sc0 ls0 ws0">-rw-r----- <span class="_"> </span>1<span class="_"> </span>sar <span class="_ _74"> </span>0<span class="_"> </span>Jan 22 00:16 a</div><div class="t m0 x3f h62 y1190 ff1a fs30 fc0 sc0 ls0 ws0">lrwxrwxrwx <span class="_"> </span>1<span class="_"> </span>sar <span class="_ _74"> </span>6<span class="_"> </span>Jan 22 00:16 testdir -&gt; ../foo</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
