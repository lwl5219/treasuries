<div id="pf87" class="pf w4 h1f" data-page-no="87"><div class="pc pc87 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg87.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>4.6<span class="_ _18e"> </span>Ownership <span class="_"> </span>of <span class="_"> </span>New <span class="_"> </span>Files <span class="_"> </span>and <span class="_"> </span>Directories<span class="_ _1b"> </span><span class="ff18">101</span></div><div class="t m0 x3f h2a y12f ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _9"></span>ﬁle <span class="_ _3"></span>access <span class="_ _9"></span>tests <span class="_ _9"></span>that <span class="_ _9"></span>the <span class="_ _9"></span>kernel <span class="_ _9"></span>performs <span class="_ _9"></span>each <span class="_ _9"></span>time <span class="_ _9"></span>a <span class="_ _3"></span>process <span class="_ _9"></span>opens, <span class="_ _9"></span>creates, <span class="_ _3"></span>or</div><div class="t m0 x32 h26 y130 ff19 fsf fc0 sc0 ls0 ws0">deletes <span class="_ _3"></span>a <span class="_ _9"></span>ﬁle <span class="_ _3"></span>depend <span class="_ _9"></span>on <span class="_ _9"></span>the <span class="_ _3"></span>owners <span class="_ _9"></span>of <span class="_ _3"></span>the <span class="_ _9"></span>ﬁle <span class="_ _9"></span>(<span class="ff1a">st_uid<span class="_ _47"> </span></span>and<span class="_ _45"> </span><span class="ff1a">st_gid</span>), <span class="_ _3"></span>the <span class="_ _9"></span>effective <span class="_ _3"></span>IDs</div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">of <span class="_ _3"></span>the <span class="_ _9"></span>process <span class="_ _2"></span>(effective <span class="_ _3"></span>user <span class="_ _9"></span>ID <span class="_ _3"></span>and <span class="_ _9"></span>effective <span class="_ _2"></span>group <span class="_ _3"></span>ID), <span class="_ _9"></span>and <span class="_ _3"></span>the <span class="_ _9"></span>supplementary <span class="_ _3"></span>group</div><div class="t m0 x32 h2a y132 ff19 fsf fc0 sc0 ls0 ws0">IDs <span class="_ _3"></span>of <span class="_ _9"></span>the <span class="_ _3"></span>process, <span class="_ _3"></span>if <span class="_ _3"></span>supported.<span class="_ _5a"> </span>The <span class="_ _3"></span>two <span class="_ _9"></span>owner <span class="_ _3"></span>IDs <span class="_ _9"></span>ar<span class="ls2f4">ep<span class="_ _b"></span><span class="ls45">ro<span class="ls0">perties <span class="_ _9"></span>of <span class="_ _3"></span>the <span class="_ _9"></span>ﬁle, <span class="_ _3"></span>whereas</span></span></span></div><div class="t m0 x32 h2a y133 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _23"> </span>two <span class="_ _23"> </span>effective <span class="_ _23"> </span>IDs <span class="_ _42"> </span>and <span class="_ _23"></span>the <span class="_ _23"> </span>supplementary <span class="_ _42"> </span>gr<span class="_ _0"></span>oup <span class="_ _23"> </span>IDs <span class="_ _42"> </span>ar<span class="ls4b8">ep<span class="_ _43"></span><span class="ls45">ro<span class="ls0">perties <span class="_ _23"> </span>of <span class="_ _42"> </span>the <span class="_ _23"></span>process.</span></span></span></div><div class="t m0 x32 h2a y134 ff19 fsf fc0 sc0 ls0 ws0">The tests performed by the kernel are<span class="_"> </span>as<span class="_"> </span>follows:</div><div class="t m0 x3f h2a y136 ff19 fsf fc0 sc0 ls0 ws0">1. <span class="_ _51"> </span>If<span class="_"> </span>the <span class="_ _2"></span>effective user ID of <span class="_ _2"></span>the process is 0 <span class="_ _2"></span>(the superuser), access <span class="_ _2"></span>is allowed.<span class="_ _46"> </span>This</div><div class="t m0 x41 h2a y137 ff19 fsf fc0 sc0 ls0 ws0">gives the superuser fr<span class="_ _0"></span>ee rein thr<span class="_ _0"></span>oughout the entir<span class="ls44">eﬁ<span class="_ _4f"></span><span class="ls0">le system.</span></span></div><div class="t m0 x3f h2a yeb6 ff19 fsf fc0 sc0 ls0 ws0">2. <span class="_ _51"> </span>If<span class="_ _35"> </span>the <span class="_ _42"> </span>effective <span class="_ _23"></span>user <span class="_ _23"></span>ID <span class="_ _23"> </span>of <span class="_ _42"> </span>the <span class="_ _23"> </span>process <span class="_ _23"> </span>equals <span class="_ _42"> </span>the <span class="_ _23"> </span>owner <span class="_ _42"> </span>ID <span class="_ _23"> </span>of <span class="_ _23"> </span>the <span class="_ _42"> </span>ﬁle <span class="_ _23"> </span>(i.e., <span class="_ _42"> </span>the</div><div class="t m0 x41 h2a yeb7 ff19 fsf fc0 sc0 ls0 ws0">process <span class="_ _44"> </span>owns <span class="_ _4b"> </span>the <span class="_ _59"> </span>ﬁle), <span class="_ _4b"> </span>access <span class="_ _4b"> </span>is <span class="_ _4b"> </span>allowed <span class="_ _4b"> </span>if <span class="_ _4b"> </span>the <span class="_ _4b"> </span>appropriate <span class="_ _4b"> </span>user <span class="_ _4b"> </span>access</div><div class="t m0 x41 h2b yeb8 ff19 fsf fc0 sc0 ls0 ws0">permission <span class="_"> </span>bit <span class="_ _e"> </span>is <span class="_"> </span>set.<span class="_ _48"> </span>Otherwise, <span class="_"> </span>permission <span class="_ _e"> </span>is <span class="_"> </span>denied.<span class="_ _48"> </span>By<span class="_ _46"> </span><span class="ff1b">appropriate <span class="_ _e"> </span>access</span></div><div class="t m0 x41 h2b yeb9 ff1b fsf fc0 sc0 ls0 ws0">permission <span class="_ _42"> </span>bit<span class="ff19">,<span class="_ _35"> </span>we<span class="_ _44"> </span>mean <span class="_ _42"> </span>that <span class="_ _42"> </span>if <span class="_ _42"> </span>the <span class="_ _42"> </span>process <span class="_ _23"> </span>is <span class="_ _42"> </span>opening <span class="_ _42"> </span>the <span class="_ _42"> </span>ﬁle <span class="_ _42"> </span>for <span class="_ _42"> </span>reading, <span class="_ _23"> </span>the</span></div><div class="t m0 x41 h2a yeba ff19 fsf fc0 sc0 ls0 ws0">user-r<span class="_ _0"></span>ead <span class="_ _e"> </span>bit <span class="_"> </span>must <span class="_ _e"> </span>be <span class="_"> </span>on.<span class="_ _65"> </span>If <span class="_"> </span>the <span class="_"> </span>pr<span class="_ _1"></span>ocess <span class="_"> </span>is <span class="_ _e"> </span>opening <span class="_"> </span>the <span class="_ _e"> </span>ﬁle <span class="_"> </span>for <span class="_ _e"> </span>writing, <span class="_"> </span>the</div><div class="t m0 x41 h2a yebb ff19 fsf fc0 sc0 ls0 ws0">user-write bit must be on.<span class="_ _59"> </span>If the process is executing the ﬁle, the user<span class="_ _0"></span>-execute bit</div><div class="t m0 x41 h2a yebc ff19 fsf fc0 sc0 ls0 ws0">must be on.</div><div class="t m0 x3f h2a yebd ff19 fsf fc0 sc0 ls0 ws0">3. <span class="_ _51"> </span>If<span class="_"> </span>the effective group ID of the process or one of the supplementary group IDs of</div><div class="t m0 x41 h2a yebe ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _9"></span>process <span class="_ _3"></span>equals <span class="_ _23"></span>the <span class="_ _9"></span>group <span class="_ _3"></span>ID <span class="_ _9"></span>of <span class="_ _23"></span>the <span class="_ _9"></span>ﬁle, <span class="_ _9"></span>access <span class="_ _9"></span>is <span class="_ _9"></span>allowed <span class="_ _9"></span>if <span class="_ _9"></span>the <span class="_ _23"></span>appr<span class="_ _0"></span>opriate</div><div class="t m0 x41 h2a yebf ff19 fsf fc0 sc0 ls0 ws0">group access permission bit is set.<span class="_ _59"> </span>Otherwise, permission is denied.</div><div class="t m0 x3f h2a yec0 ff19 fsf fc0 sc0 ls0 ws0">4. <span class="_ _51"> </span>If<span class="_ _65"> </span>the <span class="_ _59"> </span>appropriate <span class="_ _44"> </span>other <span class="_ _4b"> </span>access <span class="_ _59"> </span>permission <span class="_ _4b"> </span>bit <span class="_ _4b"> </span>is <span class="_ _4b"> </span>set, <span class="_ _4b"> </span>access <span class="_ _59"> </span>is <span class="_ _4b"> </span>allowed.</div><div class="t m0 x41 h2a yec1 ff19 fsf fc0 sc0 ls0 ws0">Otherwise, permission is denied.</div><div class="t m0 x3f h2a yec2 ff19 fsf fc0 sc0 ls0 ws0">These <span class="_"> </span>four <span class="_ _66"> </span>steps <span class="_ _66"> </span>ar<span class="ls4b9">et<span class="_ _5b"></span><span class="ls0">ried <span class="_ _66"> </span>in <span class="_ _66"> </span>sequence.<span class="_ _50"> </span>Note <span class="_ _66"> </span>that <span class="_ _66"> </span>if <span class="_ _66"> </span>the <span class="_ _66"> </span>process <span class="_"> </span>owns <span class="_ _66"> </span>the <span class="_ _66"> </span>ﬁle</span></span></div><div class="t m0 x32 h2a yec3 ff19 fsf fc0 sc0 ls0 ws0">(step 2),<span class="_ _4b"> </span>access <span class="_ _e"> </span>is <span class="_"> </span>granted <span class="_ _53"> </span>or <span class="_ _e"> </span>denied <span class="_ _e"> </span>based <span class="_"> </span>only <span class="_ _53"> </span>on <span class="_ _e"> </span>the <span class="_ _e"> </span>user <span class="_"> </span>access <span class="_ _53"> </span>permissions; <span class="_ _e"> </span>the</div><div class="t m0 x32 h2a yec4 ff19 fsf fc0 sc0 ls0 ws0">group <span class="_ _9"></span>permissions <span class="_ _23"></span>ar<span class="ls1e4">en<span class="_ _43"></span><span class="ls0">ever <span class="_ _23"></span>looked <span class="_ _23"></span>at.<span class="_ _5a"> </span>Similarly<span class="_ _6"></span>,<span class="_ _45"> </span>if<span class="_ _35"> </span>the <span class="_ _23"></span>process <span class="_ _9"></span>does <span class="_ _23"></span>not <span class="_ _9"></span>own <span class="_ _23"> </span>the <span class="_ _23"></span>ﬁle</span></span></div><div class="t m0 x32 h2a yc2b ff19 fsf fc0 sc0 ls0 ws0">but <span class="_ _53"> </span>belongs <span class="_ _53"> </span>to <span class="_ _53"> </span>an <span class="_ _53"> </span>appropriate <span class="_ _42"> </span>group, <span class="_ _53"> </span>access <span class="_ _53"> </span>is <span class="_ _53"> </span>granted <span class="_ _53"> </span>or <span class="_ _53"> </span>denied <span class="_ _53"> </span>based <span class="_ _53"> </span>only <span class="_ _53"> </span>on <span class="_ _53"> </span>the</div><div class="t m0 x32 h2a yec5 ff19 fsf fc0 sc0 ls0 ws0">group access permissions; the other permissions ar<span class="_ _0"></span><span class="ls44">en<span class="_ _d"></span><span class="ls0">ot looked at.</span></span></div><div class="t m0 x35 h53 yec6 ff16 fs2b fc0 sc0 ls0 ws0">4.6 <span class="_ _68"> </span>Ownership <span class="_"> </span>of <span class="_"> </span>Ne<span class="_ _0"></span><span class="ls1c3">wF<span class="_ _52"></span><span class="ls0">iles <span class="_"> </span>and <span class="_"> </span>Directories</span></span></div><div class="t m0 x32 h26 y525 ff19 fsf fc0 sc0 ls0 ws0">When <span class="_ _2"></span>we <span class="_ _2"></span>described <span class="_ _3"></span>the <span class="_ _2"></span>creation <span class="_ _2"></span>of <span class="_ _3"></span>a <span class="_ _2"></span>new <span class="_ _2"></span>ﬁle <span class="_ _3"></span>in <span class="_ _2"></span>Chapter <span class="_ _3"></span>3 <span class="_ _2"></span>using <span class="_ _3"></span>either<span class="_ _47"> </span><span class="ff1a">open<span class="_ _66"> </span></span>or<span class="_ _47"> </span><span class="ff1a">creat</span>,</div><div class="t m0 x32 h2a y526 ff19 fsf fc0 sc0 ls0 ws0">we <span class="_ _3"></span>never <span class="_ _3"></span>said <span class="_ _3"></span>which <span class="_ _3"></span>values <span class="_ _3"></span>wer<span class="ls4ba">ea<span class="_ _8"></span><span class="ls0">ssigned <span class="_ _3"></span>to <span class="_ _3"></span>the <span class="_ _3"></span>user <span class="_ _3"></span>ID <span class="_ _3"></span>and <span class="_ _3"></span>group <span class="_ _2"></span>ID <span class="_ _9"></span>of <span class="_ _2"></span>the <span class="_ _9"></span>new <span class="_ _2"></span>ﬁle.</span></span></div><div class="t m0 x32 h26 y527 ff19 fsf fc0 sc0 ls5f ws0">We<span class="_ _9"></span><span class="ls0">’ll <span class="_ _42"> </span>see <span class="_ _23"> </span>how <span class="_ _42"> </span>to <span class="_ _23"> </span>create <span class="_ _23"> </span>a <span class="_ _42"> </span>new <span class="_ _23"> </span>directory <span class="_ _42"> </span>in <span class="_ _23"> </span>Section <span class="_ _42"> </span>4.21 <span class="_ _23"> </span>when <span class="_ _42"> </span>we <span class="_ _23"> </span>describe <span class="_ _42"> </span>the<span class="_ _35"> </span><span class="ff1a">mkdir</span></span></div><div class="t m0 x32 h2a y528 ff19 fsf fc0 sc0 ls0 ws0">function. <span class="_"> </span>The<span class="_"> </span><span class="ls4e">ru</span>les <span class="_ _2"></span>for the ownership <span class="_ _2"></span>of a new <span class="_ _2"></span>directory ar<span class="_ _0"></span><span class="ls4bb">ei<span class="_ _d"></span><span class="ls0">dentical to the <span class="_ _2"></span>rules in this</span></span></div><div class="t m0 x32 h2a y529 ff19 fsf fc0 sc0 ls0 ws0">section for the ownership of a new ﬁle.</div><div class="t m0 x3f h2a y52a ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _42"> </span>user <span class="_ _53"> </span>ID <span class="_ _53"> </span>of <span class="_ _53"> </span>a <span class="_ _42"> </span>new <span class="_ _53"> </span>ﬁle <span class="_ _53"> </span>is <span class="_ _53"> </span>set <span class="_ _42"> </span>to <span class="_ _53"> </span>the <span class="_ _53"> </span>effective <span class="_ _42"> </span>user <span class="_ _53"> </span>ID <span class="_ _53"> </span>of <span class="_ _42"> </span>the <span class="_ _53"> </span>process. <span class="_ _44"> </span>POSIX.1</div><div class="t m0 x32 h2a y52c ff19 fsf fc0 sc0 ls0 ws0">allows <span class="_"> </span>an <span class="_ _e"> </span>implementation <span class="_"> </span>to <span class="_"> </span>choose <span class="_ _e"> </span>one <span class="_"> </span>of <span class="_"> </span>the <span class="_"> </span>following <span class="_ _e"> </span>options <span class="_"> </span>to <span class="_"> </span>determine <span class="_ _e"> </span>the</div><div class="t m0 x32 h2a y52d ff19 fsf fc0 sc0 ls0 ws0">group ID of a new ﬁle:</div><div class="t m0 x3f h2a yec7 ff19 fsf fc0 sc0 ls0 ws0">1. <span class="_ _51"> </span>The<span class="_"> </span>group ID of a new ﬁle can be the ef<span class="_ _0"></span>fective group ID of the pr<span class="_ _0"></span>ocess.</div><div class="t m0 x3f h2a yec8 ff19 fsf fc0 sc0 ls0 ws0">2. <span class="_ _51"> </span>The<span class="_ _66"> </span>group <span class="_ _2"></span>ID <span class="_ _2"></span>of <span class="_ _2"></span>a <span class="_ _2"></span>new <span class="_ _3"></span>ﬁle <span class="_ _2"></span>can <span class="_ _2"></span>be <span class="_ _2"></span>the <span class="_ _2"></span>group <span class="_ _2"></span>ID <span class="_ _2"></span>of <span class="_ _2"></span>the <span class="_ _2"></span>directory <span class="_ _2"></span>in <span class="_ _2"></span>which <span class="_ _2"></span>the <span class="_ _2"></span>ﬁle</div><div class="t m0 x41 h2a yec9 ff19 fsf fc0 sc0 ls0 ws0">is being created.</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.891785px;bottom:465.168890px;width:278.387101px;height:19.679016px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
