<div id="pf278" class="pf w4 h1f" data-page-no="278"><div class="pc pc278 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg278.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">598<span class="_ _1b"> </span><span class="ff19">Network <span class="_"> </span>IPC: <span class="_"> </span>Sockets<span class="_ _2c6"> </span>Chapter <span class="_"> </span>16</span></div><div class="t m0 x3f h2a y12f ff19 fsf fc0 sc0 ls5f ws0">We <span class="_ _53"> </span>c<span class="_ _9"></span><span class="ls0">an get network names and numbers with a similar set of interfaces.</span></div><div class="t m0 x3f h57 y47c4 ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;netdb.h&gt;</div><div class="t m0 x3f h57 y47c5 ff1a fs2d fc0 sc0 ls0 ws0">struct netent *getnetbyaddr(uint32_t<span class="_"> </span><span class="ff1b">net</span><span class="ls15c">,i<span class="_ _1d"></span><span class="ls0">nt<span class="_"> </span><span class="ff1b">type</span>);</span></span></div><div class="t m0 x3f h57 y47c6 ff1a fs2d fc0 sc0 ls0 ws0">struct netent *getnetbyname(const char *<span class="ff1b">name</span>);</div><div class="t m0 x3f h57 y47c7 ff1a fs2d fc0 sc0 ls0 ws0">struct netent *getnetent(void);</div><div class="t m0 x1fe h57 y47c8 ff19 fs2d fc0 sc0 ls0 ws0">All return: pointer if OK,<span class="_"> </span><span class="ff1a">NULL<span class="_ _e"> </span></span>on error</div><div class="t m0 x3f h57 y47c9 ff1a fs2d fc0 sc0 ls0 ws0">void setnetent(int<span class="_"> </span><span class="ff1b">stayopen</span>);</div><div class="t m0 x3f h57 y47ca ff1a fs2d fc0 sc0 ls0 ws0">void endnetent(void);</div><div class="t m0 x32 h4d y47cb ff19 fs26 fc0 sc0 ls0 ws0">The<span class="_"> </span><span class="ff1a">netent<span class="_ _80"> </span></span>structur<span class="lsd3">ec<span class="_ _4f"></span><span class="ls0">ontains at least the following ﬁelds:</span></span></div><div class="t m0 x3f h4e y47cc ff1a fs28 fc0 sc0 ls0 ws0">struct netent {</div><div class="t m0 xf4 h4e y47cd ff1a fs28 fc0 sc0 ls0 ws0">char <span class="_ _15"> </span>*n_name;<span class="_ _189"> </span>/* network name */</div><div class="t m0 xf4 h4e y47ce ff1a fs28 fc0 sc0 ls0 ws0">char <span class="_ _68"> </span>**n_aliases;<span class="_ _87"> </span>/* alternate network name array pointer */</div><div class="t m0 xf4 h4e y47cf ff1a fs28 fc0 sc0 ls0 ws0">int <span class="_ _189"> </span>n_addrtype;<span class="_ _3a"> </span>/* address type */</div><div class="t m0 xf4 h4e y47d0 ff1a fs28 fc0 sc0 ls0 ws0">uint32_t <span class="_"> </span>n_net;<span class="_ _b7"> </span>/* network number */</div><div class="t m0 xf4 h4e y47d1 ff1a fs28 fc0 sc0 ls0 ws0">.</div><div class="t m0 xf4 h4e y47d2 ff1a fs28 fc0 sc0 ls0 ws0">.</div><div class="t m0 xf4 h4e y47d3 ff1a fs28 fc0 sc0 ls0 ws0">.</div><div class="t m0 x3f h4e y47d4 ff1a fs28 fc0 sc0 ls0 ws0">};</div><div class="t m0 x32 h49 y47d5 ff19 fs26 fc0 sc0 ls0 ws0">The <span class="_ _3"></span>network <span class="_ _3"></span>number <span class="_ _3"></span>is <span class="_ _3"></span>returned <span class="_ _2"></span>in <span class="_ _3"></span>network <span class="_ _3"></span>byte <span class="_ _3"></span>order<span class="_ _6"></span><span class="ls1331">.T<span class="_ _1d"></span><span class="ls0">he <span class="_ _3"></span>address <span class="_ _3"></span>type <span class="_ _3"></span>is <span class="_ _3"></span>one <span class="_ _3"></span>of <span class="_ _3"></span>the</span></span></div><div class="t m0 x32 h4d y47d6 ff19 fs26 fc0 sc0 ls0 ws0">address family constants (<span class="ff1a">AF_INET</span><span class="lsd3">,f<span class="_ _4f"></span><span class="ls0">or example).</span></span></div><div class="t m0 x3f h49 y47d7 ff19 fs26 fc0 sc0 ls164 ws0">We <span class="_ _53"> </span>c<span class="_ _9"></span><span class="ls0">an map between protocol names and numbers with the following functions.</span></div><div class="t m0 x3f h4e y47d8 ff1a fs28 fc0 sc0 ls0 ws0">#include &lt;netdb.h&gt;</div><div class="t m0 x3f h4e y47d9 ff1a fs28 fc0 sc0 ls0 ws0">struct protoent *getprotobyname(const char *<span class="ff1b">name</span>);</div><div class="t m0 x3f h4e y47da ff1a fs28 fc0 sc0 ls0 ws0">struct protoent *getprotobynumber(int<span class="_"> </span><span class="ff1b">proto</span>);</div><div class="t m0 x3f h4e y47db ff1a fs28 fc0 sc0 ls0 ws0">struct protoent *getprotoent(void);</div><div class="t m0 x1fe h4e y47dc ff19 fs28 fc0 sc0 ls0 ws0">All return: pointer if OK,<span class="_"> </span><span class="ff1a">NULL<span class="_ _e"> </span></span>on error</div><div class="t m0 x3f h4e y47dd ff1a fs28 fc0 sc0 ls0 ws0">void setprotoent(int<span class="_"> </span><span class="ff1b">stayopen</span>);</div><div class="t m0 x3f h4e y47de ff1a fs28 fc0 sc0 ls0 ws0">void endprotoent(void);</div><div class="t m0 x32 h54 y47df ff19 fs2c fc0 sc0 ls0 ws0">The<span class="_"> </span><span class="ff1a">protoent<span class="_ _80"> </span></span>structure<span class="_"> </span>as<span class="_"> </span>deﬁned by POSIX.1 has at least the following members:</div><div class="t m0 x3f h5d y47e0 ff1a fs2f fc0 sc0 ls0 ws0">struct protoent {</div><div class="t m0 xf4 h5d y47e1 ff1a fs2f fc0 sc0 ls0 ws0">char <span class="_ _d9"> </span>*p_name;<span class="_ _8a"> </span>/* protocol name */</div><div class="t m0 xf4 h5d y47e2 ff1a fs2f fc0 sc0 ls0 ws0">char <span class="_"> </span>**p_aliases; <span class="_"> </span>/*<span class="_"> </span>pointer to alternate protocol name array */</div><div class="t m0 xf4 h5d y47e3 ff1a fs2f fc0 sc0 ls0 ws0">int <span class="_ _15"> </span>p_proto;<span class="_ _15"> </span>/* protocol number */</div><div class="t m0 xf4 h5d y47e4 ff1a fs2f fc0 sc0 ls0 ws0">.</div><div class="t m0 xf4 h5d y47e5 ff1a fs2f fc0 sc0 ls0 ws0">.</div><div class="t m0 xf4 h5d y47e6 ff1a fs2f fc0 sc0 ls0 ws0">.</div><div class="t m0 x3f h5d y47e7 ff1a fs2f fc0 sc0 ls0 ws0">};</div><div class="t m0 x3f h55 y47e8 ff19 fs2c fc0 sc0 ls0 ws0">Services <span class="_ _2"></span>ar<span class="ls1332">er<span class="_ _8"></span><span class="ls0">epresented by <span class="_ _3"></span>the <span class="_ _2"></span>port <span class="_ _3"></span>number <span class="_ _2"></span>portion <span class="_ _3"></span>of <span class="_ _2"></span>the <span class="_ _3"></span>address. <span class="_ _66"> </span>Each<span class="_ _47"> </span>service <span class="_ _2"></span>is</span></span></div><div class="t m0 x32 h55 y47e9 ff19 fs2c fc0 sc0 ls0 ws0">offer<span class="_ _0"></span>ed <span class="_ _23"></span>on <span class="_ _23"></span>a <span class="_ _23"></span>unique, <span class="_ _23"></span>well-known <span class="_ _23"> </span>port <span class="_ _23"> </span>number<span class="_ _1"></span><span class="ls1333">.W<span class="_ _64"></span><span class="ls1334">ec<span class="_ _43"></span><span class="ls0">an <span class="_ _23"> </span>map <span class="_ _23"> </span>a <span class="_ _23"> </span>service <span class="_ _42"> </span>name <span class="_ _23"></span>to <span class="_ _23"></span>a <span class="_ _23"></span>port</span></span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
