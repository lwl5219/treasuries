<div id="pf11d" class="pf w4 h1f" data-page-no="11d"><div class="pc pc11d w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg11d.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h7a ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>8.10<span class="_ _22f"> </span><span class="ff1a">exec<span class="_ _4b"> </span></span>Functions<span class="_ _1b"> </span><span class="ff18">251</span></div><div class="t m0 x32 h26 y12f ff19 fsf fc0 sc0 ls0 ws0">functions, however<span class="_ _1"></span><span class="ls9ea">,u<span class="_ _4f"></span><span class="ls0">se <span class="_ _2"></span>the<span class="_ _66"> </span><span class="ff1a">environ<span class="_ _47"> </span></span>variable in <span class="_ _2"></span>the <span class="_ _2"></span>calling process to <span class="_ _2"></span>copy <span class="_ _2"></span>the <span class="_ _2"></span>existing</span></span></div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">environment for <span class="_ _2"></span>the <span class="_ _2"></span>new <span class="_ _3"></span>program. <span class="_"> </span>(Recall<span class="_ _47"> </span>our <span class="_ _2"></span>discussion <span class="_ _2"></span>of <span class="_ _2"></span>the <span class="_ _2"></span>environment <span class="_ _2"></span>strings <span class="_ _2"></span>in</div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">Section 7.9 and Figur<span class="ls9eb">e7<span class="_ _d"></span><span class="ls0">.8. <span class="_"> </span>W<span class="_ _6"></span><span class="ls3df">em<span class="_ _d"></span><span class="ls0">entioned that if the <span class="_ _2"></span>system supported such functions as</span></span></span></span></div><div class="t m0 x32 h26 y132 ff1a fsf fc0 sc0 ls0 ws0">setenv<span class="_ _45"> </span><span class="ff19">and<span class="_ _45"> </span></span>putenv<span class="ff19">,<span class="_ _35"> </span>we<span class="_ _45"> </span>could <span class="_ _9"></span>change <span class="_ _23"></span>the <span class="_ _9"></span>current <span class="_ _9"></span>environment <span class="_ _9"></span>and <span class="_ _23"></span>the <span class="_ _9"></span>environment</span></div><div class="t m0 x32 h2a y133 ff19 fsf fc0 sc0 ls0 ws0">of <span class="_ _2"></span>any <span class="_ _2"></span>subsequent <span class="_ _3"></span>child <span class="_ _2"></span>processes, but <span class="_ _3"></span>we <span class="_ _2"></span>couldn’t <span class="_ _2"></span>affect <span class="_ _2"></span>the <span class="_ _2"></span>environment <span class="_ _2"></span>of <span class="_ _2"></span>the <span class="_ _3"></span>parent</div><div class="t m0 x32 h2a y134 ff19 fsf fc0 sc0 ls0 ws0">process.) <span class="_ _45"> </span>Normally<span class="_ _4"></span><span class="ls9ec">,ap<span class="_ _b"></span><span class="ls45">ro<span class="ls0">cess <span class="_ _23"></span>allows <span class="_ _9"></span>its <span class="_ _23"></span>envir<span class="_ _0"></span>onment <span class="_ _9"></span>to <span class="_ _23"></span>be <span class="_ _9"></span>propagated <span class="_ _9"></span>to <span class="_ _23"></span>its <span class="_ _9"></span>children,</span></span></span></div><div class="t m0 x32 h2a y135 ff19 fsf fc0 sc0 ls0 ws0">but <span class="_ _23"> </span>in <span class="_ _42"> </span>some <span class="_ _23"> </span>cases, <span class="_ _42"> </span>a <span class="_ _23"> </span>process <span class="_ _23"></span>wants <span class="_ _23"> </span>to <span class="_ _42"> </span>specify <span class="_ _23"> </span>a <span class="_ _42"> </span>certain <span class="_ _23"> </span>environment <span class="_ _23"> </span>for <span class="_ _42"> </span>a <span class="_ _23"> </span>child.<span class="_ _51"> </span>One</div><div class="t m0 x32 h26 y136 ff19 fsf fc0 sc0 ls0 ws0">example <span class="_ _47"> </span>of <span class="_ _47"> </span>the <span class="_ _45"> </span>latter <span class="_ _47"> </span>is <span class="_ _47"> </span>the<span class="_ _16"> </span><span class="ff1a">login<span class="_"> </span></span>pr<span class="_ _1"></span>ogram <span class="_ _45"> </span>when <span class="_ _47"> </span>a <span class="_ _47"> </span>new <span class="_ _45"> </span>login <span class="_ _47"> </span>shell <span class="_ _47"> </span>is <span class="_ _47"> </span>initiated.</div><div class="t m0 x32 h26 y137 ff19 fsf fc0 sc0 ls0 ws0">Normally<span class="_ _4"></span>,<span class="_ _45"> </span><span class="ff1a">login<span class="_ _47"> </span></span>creates <span class="_ _3"></span>a <span class="_ _9"></span>speciﬁc <span class="_ _3"></span>environment <span class="_ _9"></span>with <span class="_ _3"></span>only <span class="_ _9"></span>a <span class="_ _3"></span>few <span class="_ _9"></span>variables <span class="_ _3"></span>deﬁned <span class="_ _9"></span>and</div><div class="t m0 x32 h2a y138 ff19 fsf fc0 sc0 ls0 ws0">lets us, <span class="_ _2"></span>through the <span class="_ _2"></span>shell <span class="_ _2"></span>start-up <span class="_ _2"></span>ﬁle, add <span class="_ _2"></span>variables <span class="_ _2"></span>to <span class="_ _2"></span>the <span class="_ _2"></span>environment when <span class="_ _2"></span>we log <span class="_ _2"></span>in.</div><div class="t m0 x3f h26 y139 ff19 fsf fc0 sc0 ls0 ws0">Befor<span class="ls44">eu<span class="_ _4f"></span><span class="ls0">sing ISO C prototypes, the arguments to<span class="_"> </span><span class="ff1a">execle<span class="_ _80"> </span></span>wer<span class="ls44">es<span class="_ _4f"></span><span class="ls0">hown as</span></span></span></span></div><div class="t m0 x3f h57 y2112 ff1a fs2d fc0 sc0 ls0 ws0">char *<span class="ff1b">pathname</span><span class="ls15c">,c<span class="_ _1d"></span><span class="ls0">har *<span class="ff1b">arg0</span><span class="ls15c">,.<span class="_ _1d"></span><span class="ls0">.., char *<span class="ff1b">argn</span><span class="ls15c">,(<span class="_ _1d"></span><span class="ls0">char *)0, char *<span class="ff1b">envp</span>[]</span></span></span></span></span></span></div><div class="t m0 x32 h2a yd41 ff19 fsf fc0 sc0 ls0 ws0">This <span class="_ _53"> </span>syntax <span class="_ _53"> </span>speciﬁcally <span class="_ _53"> </span>shows <span class="_ _42"> </span>that <span class="_ _53"> </span>the <span class="_ _53"> </span>ﬁnal <span class="_ _53"> </span>argument <span class="_ _53"> </span>is <span class="_ _53"> </span>the <span class="_ _53"> </span>address <span class="_ _42"> </span>of <span class="_ _53"> </span>the <span class="_ _53"> </span>array <span class="_ _53"> </span>of</div><div class="t m0 x32 h2a y2113 ff19 fsf fc0 sc0 ls0 ws0">character <span class="_ _9"></span>pointers <span class="_ _3"></span>to <span class="_ _9"></span>the <span class="_ _9"></span>environment <span class="_ _3"></span>strings.<span class="_ _5a"> </span>The <span class="_ _9"></span>ISO <span class="_ _9"></span>C <span class="_ _9"></span>prototype <span class="_ _3"></span>doesn’t <span class="_ _9"></span>show <span class="_ _9"></span>this,</div><div class="t m0 x32 h2a y2114 ff19 fsf fc0 sc0 ls0 ws0">as <span class="_ _23"> </span>all <span class="_ _42"> </span>the <span class="_ _42"> </span>command</div><div class="t m0 x38 h2a y2115 ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 x161 h2b y2114 ff19 fsf fc0 sc0 ls0 ws0">line <span class="_ _23"> </span>arguments, <span class="_ _23"> </span>the <span class="_ _42"> </span>null <span class="_ _42"> </span>pointer<span class="_ _6"></span><span class="ls9ed">,a<span class="_ _43"></span><span class="ls0">nd <span class="_ _42"> </span>the<span class="_ _35"> </span><span class="ff1b">envp<span class="_ _35"> </span></span>pointer <span class="_ _42"> </span>ar<span class="ls9ed">es<span class="_ _43"></span><span class="ls0">hown</span></span></span></span></div><div class="t m0 x32 h26 y2116 ff19 fsf fc0 sc0 ls0 ws0">with the ellipsis notation (<span class="ff1a">...</span>).</div><div class="t m0 x3f h26 y2117 ff19 fsf fc0 sc0 ls0 ws0">The arguments for these seven<span class="_ _66"> </span><span class="ff1a">exec<span class="_ _66"> </span></span>functions ar<span class="ls9ee">ed<span class="_ _4f"></span><span class="ls0">ifﬁcult to remember<span class="_ _6"></span><span class="ls9ef">.T<span class="_ _4a"></span><span class="ls0">he letters</span></span></span></span></div><div class="t m0 x32 h26 y2118 ff19 fsf fc0 sc0 ls0 ws0">in <span class="_ _53"> </span>the <span class="_ _53"> </span>function <span class="_ _53"> </span>names <span class="_ _53"> </span>help <span class="_ _53"> </span>somewhat.<span class="_ _65"> </span>The <span class="_ _53"> </span>letter<span class="_ _4b"> </span><span class="ff1a">p<span class="_ _4b"> </span></span>means <span class="_ _53"> </span>that <span class="_ _53"> </span>the <span class="_ _53"> </span>function <span class="_ _53"> </span>takes <span class="_ _53"> </span>a</div><div class="t m0 x32 h26 y2119 ff1b fsf fc0 sc0 ls0 ws0">ﬁlename<span class="_ _45"> </span><span class="ff19">argument <span class="_ _23"></span>and <span class="_ _9"></span>uses <span class="_ _23"></span>the<span class="_ _45"> </span><span class="ff1a">PATH<span class="_ _35"> </span></span>environment <span class="_ _9"></span>variable <span class="_ _23"></span>to <span class="_ _9"></span>ﬁnd <span class="_ _23"> </span>the <span class="_ _23"></span>executable <span class="_ _23"></span>ﬁle.</span></div><div class="t m0 x32 h26 y211a ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _2"></span>letter<span class="_ _47"> </span><span class="ff1a">l<span class="_ _47"> </span></span>means <span class="_ _3"></span>that <span class="_ _3"></span>the <span class="_ _3"></span>function <span class="_ _2"></span>takes <span class="_ _3"></span>a <span class="_ _3"></span>list <span class="_ _3"></span>of <span class="_ _2"></span>arguments <span class="_ _3"></span>and <span class="_ _2"></span>is <span class="_ _3"></span>mutually <span class="_ _3"></span>exclusive</div><div class="t m0 x32 h26 y211b ff19 fsf fc0 sc0 ls0 ws0">with <span class="_ _2"></span>the <span class="_ _2"></span>letter<span class="_ _47"> </span><span class="ff1a">v</span><span class="ls9f0">,w<span class="_ _4f"></span><span class="ls0">hich <span class="_ _2"></span>means <span class="_ _2"></span>that <span class="_ _3"></span>it <span class="_ _2"></span>takes <span class="_ _2"></span>an<span class="_ _47"> </span><span class="ff1b">argv<span class="ff1a">[]<span class="_ _66"> </span></span></span>vector<span class="_ _1"></span><span class="ls428">.F<span class="_ _1d"></span><span class="ls0">inally<span class="_ _6"></span><span class="ls9f1">,t<span class="_ _4f"></span><span class="ls0">he <span class="_ _2"></span>letter<span class="_ _47"> </span><span class="ff1a">e<span class="_ _66"> </span></span>means</span></span></span></span></span></span></div><div class="t m0 x32 h26 y211c ff19 fsf fc0 sc0 ls0 ws0">that <span class="_"> </span>the <span class="_ _66"> </span>function <span class="_ _47"> </span>takes <span class="_"> </span>an<span class="_ _61"> </span><span class="ff1b">envp<span class="ff1a">[]<span class="_ _46"> </span></span></span>array <span class="_ _66"> </span>instead <span class="_ _66"> </span>of <span class="_ _47"> </span>using <span class="_"> </span>the <span class="_ _66"> </span>current <span class="_"> </span>environment.</div><div class="t m0 x32 h2a y211d ff19 fsf fc0 sc0 ls0 ws0">Figur<span class="ls44">e8<span class="_ _4f"></span><span class="ls0">.14 shows the differences among these seven functions.</span></span></div><div class="t m0 x1fa h5e y211e ff19 fs10 fc0 sc0 ls0 ws0">Function<span class="_ _18"> </span><span class="ff1b">pathname <span class="_ _1bb"> </span>ﬁlename<span class="_ _db"> </span>fd<span class="_ _1ad"> </span></span>Ar<span class="ls136">gl<span class="_ _84"></span><span class="ls0">ist<span class="_ _13"> </span><span class="ff1b">argv<span class="ff1a">[] <span class="_ _6e"> </span>environ<span class="_ _68"> </span></span>envp<span class="ff1a">[]</span></span></span></span></div><div class="t m0 x1c2 h4f y211f ff1a fs11 fc0 sc0 ls0 ws0">execl<span class="_ _b3"> </span><span class="ff19 ls9f2">••<span class="_ _230"></span><span class="ls0">•</span></span></div><div class="t m0 x1c2 h4f y2120 ff1a fs11 fc0 sc0 ls0 ws0">execlp<span class="_ _cb"> </span><span class="ff19 ls9f3">•••</span></div><div class="t m0 x1c2 h4f y2121 ff1a fs11 fc0 sc0 ls0 ws0">execle<span class="_ _1af"> </span><span class="ff19 ls9f2">•••</span></div><div class="t m0 x1c2 h4f y2122 ff1a fs11 fc0 sc0 ls0 ws0">execv<span class="_ _b3"> </span><span class="ff19 ls9f4">••<span class="_ _231"></span><span class="ls0">•</span></span></div><div class="t m0 x1c2 h4f y2123 ff1a fs11 fc0 sc0 ls0 ws0">execvp<span class="_ _cb"> </span><span class="ff19 ls9f2">••<span class="_ _232"></span><span class="ls0">•</span></span></div><div class="t m0 x1c2 h4f y2124 ff1a fs11 fc0 sc0 ls0 ws0">execve<span class="_ _1af"> </span><span class="ff19 ls9f4">••<span class="_ _232"></span><span class="ls0">•</span></span></div><div class="t m0 x1c2 h4f y2125 ff1a fs11 fc0 sc0 ls0 ws0">fexecve<span class="_ _233"> </span><span class="ff19 ls9f3">•••</span></div><div class="t m0 x1c2 h6d y2126 ff19 fs12 fc0 sc0 ls0 ws0">(letter in name)<span class="_ _19d"> </span><span class="ff1a ls9f5">pflv e</span></div><div class="t m0 x161 h63 y2127 ff18 fs13 fc0 sc0 ls0 ws0">Figure 8.14<span class="_ _5a"> </span><span class="ff19">Differences among the seven<span class="_"> </span><span class="ff1a">exec<span class="_ _53"> </span></span>functions</span></div><div class="t m0 x3f h6e y2128 ff19 fs31 fc0 sc0 ls0 ws0">Every <span class="_ _3"></span>system <span class="_ _3"></span>has <span class="_ _3"></span>a <span class="_ _3"></span>limit <span class="_ _3"></span>on <span class="_ _3"></span>the <span class="_ _3"></span>total <span class="_ _3"></span>size <span class="_ _3"></span>of <span class="_ _3"></span>the <span class="_ _3"></span>argument <span class="_ _2"></span>list <span class="_ _3"></span>and <span class="_ _3"></span>the <span class="_ _3"></span>environment</div><div class="t m0 x32 h64 y2129 ff19 fs31 fc0 sc0 ls0 ws0">list. <span class="_ _66"> </span>From <span class="_ _2"></span>Section <span class="_ _2"></span>2.5.2 <span class="_ _3"></span>and <span class="_ _2"></span>Figur<span class="ls9f6">e2<span class="_ _8"></span><span class="ls0">.8, <span class="_ _3"></span>this <span class="_ _2"></span>limit <span class="_ _2"></span>is <span class="_ _3"></span>given <span class="_ _2"></span>by<span class="_ _47"> </span><span class="ff1a">ARG_MAX</span><span class="ls9f7">.T<span class="_ _1d"></span><span class="ls0">his <span class="_ _2"></span>value <span class="_ _3"></span>must</span></span></span></span></div><div class="t m0 x32 h6e y212a ff19 fs31 fc0 sc0 ls0 ws0">be <span class="_ _9"></span>at <span class="_ _23"></span>least <span class="_ _9"></span>4,096 <span class="_ _23"></span>bytes <span class="_ _9"></span>on <span class="_ _23"></span>a <span class="_ _9"></span>POSIX.1 <span class="_ _9"></span>system.<span class="_ _51"> </span><span class="ls43f">We <span class="_ _66"> </span>s<span class="_ _23"></span></span>ometimes <span class="_ _9"></span>encounter <span class="_ _9"></span>this <span class="_ _23"></span>limit <span class="_ _9"></span>when</div><div class="t m0 x32 h6e y212b ff19 fs31 fc0 sc0 ls0 ws0">using <span class="_ _42"> </span>the <span class="_ _23"> </span>shell’s <span class="_ _42"> </span>ﬁlename <span class="_ _42"> </span>expansion <span class="_ _23"> </span>feature<span class="_ _35"> </span>to<span class="_ _44"> </span>generate <span class="_ _23"> </span>a <span class="_ _42"> </span>list <span class="_ _42"> </span>of <span class="_ _42"> </span>ﬁlenames.<span class="_ _51"> </span>On <span class="_ _42"> </span>some</div><div class="t m0 x32 h6e y212c ff19 fs31 fc0 sc0 ls0 ws0">systems, for example, the command</div><div class="t m0 x3f h65 y212d ff1a fs32 fc0 sc0 ls0 ws0">grep getrlimit /usr/share/man/*/*</div><div class="t m0 x32 h6e y212e ff19 fs31 fc0 sc0 ls0 ws0">can generate a shell error of the form</div><div class="t m0 x3f h65 y212f ff1a fs32 fc0 sc0 ls0 ws0">Argument list too long</div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
