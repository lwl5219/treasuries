<div id="pf2f1" class="pf w4 h1f" data-page-no="2f1"><div class="pc pc2f1 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg2f1.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>19.2<span class="_ _2e2"> </span>Overview<span class="_ _1b"> </span><span class="ff18">719</span></div><div class="t m0 x99 h51 y52f5 ff19 fs2a fc0 sc0 ls0 ws0">window manager</div><div class="t m0 x226 h2d y52f6 ff19 fs10 fc0 sc0 ls0 ws0">terminal emulator</div><div class="t m0 xd3 h2e y52f7 ff19 fs11 fc0 sc0 ls0 ws0">shell</div><div class="t m0 xa9 h2f y52f8 ff19 fs12 fc0 sc0 ls0 ws0">PTY master</div><div class="t m0 x68 h30 y52f9 ff19 fs13 fc0 sc0 ls0 ws0">terminal</div><div class="t m0 xc9 h30 y52fa ff19 fs13 fc0 sc0 ls0 ws0">line discipline</div><div class="t m0 x5f h31 y52fb ff19 fs14 fc0 sc0 ls0 ws0">PTY slave</div><div class="t m0 x6 h32 y52fc ff19 fs15 fc0 sc0 ls0 ws0">shell</div><div class="t m0 x11b h33 y52fd ff19 fs16 fc0 sc0 ls0 ws0">PTY master</div><div class="t m0 x1f h83 y52fe ff19 fs36 fc0 sc0 ls0 ws0">terminal</div><div class="t m0 x5 h83 y52ff ff19 fs36 fc0 sc0 ls0 ws0">line discipline</div><div class="t m0 x159 h34 y5300 ff19 fs17 fc0 sc0 ls0 ws0">PTY slave</div><div class="t m0 xd2 h35 y5301 ff19 fs18 fc0 sc0 ls0 ws0">kernel</div><div class="t m0 x5f h35 y5302 ff19 fs18 fc0 sc0 ls0 ws0">window 2<span class="_ _160"></span>window 1</div><div class="t m0 x15b hd5 y5303 ff1a fs19 fc0 sc0 ls0 ws0">fork</div><div class="t m0 x15b hd5 y5304 ff1a fs19 fc0 sc0 ls0 ws0">exec</div><div class="t m0 xfd h15a y5305 ff1b fs1f fc0 sc0 ls0 ws0">stdout</div><div class="t m0 x228 h15a y5306 ff1b fs1f fc0 sc0 ls0 ws0">stderr</div><div class="t m0 x1d7 h15a y5305 ff1b fs1f fc0 sc0 ls0 ws0">stdin</div><div class="t m0 x18 h12c y5307 ff1a fsa3 fc0 sc0 ls0 ws0">fork</div><div class="t m0 x18 h12c y5308 ff1a fsa3 fc0 sc0 ls0 ws0">exec</div><div class="t m0 x175 h17c y5309 ff1b fsc4 fc0 sc0 ls0 ws0">stdout</div><div class="t m0 x11a h17c y530a ff1b fsc4 fc0 sc0 ls0 ws0">stderr</div><div class="t m0 x38 h17c y5309 ff1b fsc4 fc0 sc0 ls0 ws0">stdin</div><div class="t m0 x1b h17d y530b ff18 fsc5 fc0 sc0 ls0 ws0">Figure 19.4<span class="_ _5a"> </span><span class="ff19">Arrangement of processes for windowing system</span></div><div class="t m0 x32 h17e y530c ff19 fsc6 fc0 sc0 ls0 ws0">process <span class="_ _2"></span>group <span class="_ _2"></span>of <span class="_ _2"></span>the <span class="_ _3"></span>PTY <span class="_ _3"></span>slave.<span class="_ _61"> </span>If <span class="_ _3"></span>the <span class="_ _2"></span>application <span class="_ _3"></span>needs <span class="_ _3"></span>to <span class="_ _2"></span>redraw <span class="_ _2"></span>the <span class="_ _3"></span>screen <span class="_ _2"></span>when <span class="_ _3"></span>the</div><div class="t m0 x32 h17f y530d ff19 fsc6 fc0 sc0 ls0 ws0">window <span class="_ _42"> </span>is <span class="_ _53"> </span>resized, <span class="_ _42"> </span>it <span class="_ _42"> </span>can <span class="_ _53"> </span>catch <span class="_ _53"> </span>the<span class="_ _44"> </span><span class="ff1a">SIGWINCH<span class="_ _44"> </span></span>signal, <span class="_ _53"> </span>issue <span class="_ _42"> </span>the<span class="_ _44"> </span><span class="ff1a">TIOCGWINSZ <span class="_ _a"></span>ioctl</span></div><div class="t m0 x32 h17e y530e ff19 fsc6 fc0 sc0 ls0 ws0">command to get the new screen dimensions, and r<span class="_ _0"></span>edraw the scr<span class="_ _0"></span>een.</div><div class="t m0 x35 h17f y530f ff1f fsc6 fc0 sc0 ls0 ws0">script<span class="_ _66"> </span><span class="ff16">Program</span></div><div class="t m0 x32 h17f y5310 ff19 fsc6 fc0 sc0 ls0 ws0">The<span class="_"> </span><span class="ff1a">script</span></div><div class="t m0 x20c h17e y5311 ff19 fsc6 fc0 sc0 ls0 ws0">(</div><div class="t m0 x227 h17e y5310 ff19 fsc6 fc0 sc0 ls0 ws0">1</div><div class="t m0 x1d h17e y5311 ff19 fsc6 fc0 sc0 ls0 ws0">)</div><div class="t m0 x206 h17e y5310 ff19 fsc6 fc0 sc0 ls0 ws0">program that is supplied with most UNIX systems makes a copy in a ﬁle</div><div class="t m0 x32 h17e y5312 ff19 fsc6 fc0 sc0 ls0 ws0">of everything that is input <span class="_ _2"></span>and output during a <span class="_ _2"></span>terminal session.<span class="_ _46"> </span>The program does this</div><div class="t m0 x32 h17e y5313 ff19 fsc6 fc0 sc0 ls0 ws0">by <span class="_ _45"> </span>placing <span class="_ _35"> </span>itself <span class="_ _45"> </span>between <span class="_ _45"> </span>the <span class="_ _35"> </span>terminal <span class="_ _45"> </span>and <span class="_ _45"> </span>a <span class="_ _35"> </span>new <span class="_ _45"> </span>invocation <span class="_ _45"> </span>of <span class="_ _45"> </span>our <span class="_ _35"> </span>login <span class="_ _45"> </span>shell.</div><div class="t m0 x32 h17f y5314 ff19 fsc6 fc0 sc0 ls0 ws0">Figur<span class="ls1573">e1<span class="_ _52"></span><span class="ls0">9.5 <span class="_ _35"> </span>details <span class="_ _44"> </span>the <span class="_ _35"> </span>interactions <span class="_ _35"> </span>involved <span class="_ _35"> </span>in <span class="_ _35"> </span>the<span class="_ _54"> </span><span class="ff1a">script<span class="_ _51"> </span></span>program. <span class="_ _51"> </span>Here, <span class="_ _35"> </span>we</span></span></div><div class="t m0 x32 h17f y5315 ff19 fsc6 fc0 sc0 ls0 ws0">speciﬁcally <span class="_ _23"></span>show <span class="_ _23"></span>that <span class="_ _23"></span>the<span class="_ _35"> </span><span class="ff1a">script<span class="_ _45"> </span></span>program <span class="_ _23"></span>is <span class="_ _23"> </span>normally <span class="_ _23"> </span>run <span class="_ _23"></span>from <span class="_ _9"></span>a <span class="_ _23"> </span>login <span class="_ _23"> </span>shell, <span class="_ _23"> </span>which</div><div class="t m0 x32 h17f y5316 ff19 fsc6 fc0 sc0 ls0 ws0">then waits for<span class="_"> </span><span class="ff1a">script<span class="_ _80"> </span></span>to terminate.</div><div class="t m0 x12a h17f y5317 ff19 fsc6 fc0 sc0 ls0 ws0">While<span class="_ _45"> </span><span class="ff1a">script<span class="_ _45"> </span></span>is <span class="_ _9"></span>running, <span class="_ _9"></span>everything <span class="_ _9"></span>output <span class="_ _23"></span>by <span class="_ _9"></span>the <span class="_ _9"></span>terminal <span class="_ _9"></span>line <span class="_ _9"></span>discipline <span class="_ _23"></span>above</div><div class="t m0 x32 h17f y5318 ff19 fsc6 fc0 sc0 ls0 ws0">the <span class="_"> </span>PTY <span class="_ _66"> </span>slave <span class="_ _47"> </span>is <span class="_"> </span>copied <span class="_ _66"> </span>to <span class="_ _66"> </span>the <span class="_ _66"> </span>script <span class="_ _66"> </span>ﬁle <span class="_ _47"> </span>(usually <span class="_"> </span>called<span class="_ _61"> </span><span class="ff1a">typescript</span>). <span class="_ _46"> </span>Since<span class="_ _61"> </span>our</div><div class="t m0 x32 h17e y5319 ff19 fsc6 fc0 sc0 ls0 ws0">keystrokes <span class="_"> </span>ar<span class="ls1574">en<span class="_ _1d"></span><span class="ls0">ormally <span class="_ _47"> </span>echoed <span class="_"> </span>by <span class="_ _66"> </span>that <span class="_ _47"> </span>line <span class="_"> </span>discipline <span class="_ _47"> </span>module, <span class="_"> </span>the <span class="_ _66"> </span>script <span class="_ _47"> </span>ﬁle <span class="_"> </span>also</span></span></div><div class="t m0 x32 h17e y531a ff19 fsc6 fc0 sc0 ls0 ws0">contains our <span class="_ _2"></span>input.<span class="_ _61"> </span>The <span class="_ _2"></span>script <span class="_ _2"></span>ﬁle <span class="_ _2"></span>won’t <span class="_ _2"></span>contain <span class="_ _2"></span>any <span class="_ _2"></span>passwords that <span class="_ _2"></span>we <span class="_ _2"></span>enter<span class="_ _1"></span><span class="ls1575">,h<span class="_ _4f"></span><span class="ls0">owever<span class="_ _1"></span>,</span></span></div><div class="t m0 x32 h17e y531b ff19 fsc6 fc0 sc0 ls0 ws0">since passwords ar<span class="_ _0"></span>en’t echoed.</div><div class="t m0 x139 h180 y531c ff19 fsc5 fc0 sc0 ls0 ws0">While <span class="_ _2"></span>writing <span class="_ _2"></span>the <span class="_ _2"></span>ﬁrst <span class="_ _2"></span>edition <span class="_ _2"></span>of <span class="_ _3"></span>this <span class="_ _2"></span>book, <span class="_ _2"></span>Rich <span class="_ _2"></span>Stevens <span class="_ _2"></span>used <span class="_ _3"></span>the<span class="_ _80"> </span><span class="ff1a">script<span class="_ _e"> </span></span>program <span class="_ _2"></span>to <span class="_ _2"></span>capture</div><div class="t m0 x139 h17d y531d ff19 fsc5 fc0 sc0 ls0 ws0">the <span class="_"> </span>output <span class="_"> </span>of <span class="_ _e"> </span>the <span class="_ _e"> </span>example <span class="_ _80"> </span>programs. <span class="_ _35"> </span>This<span class="_ _44"> </span>avoided <span class="_"> </span>typographical <span class="_"> </span>errors <span class="_"> </span>that <span class="_"> </span>could <span class="_ _80"> </span>have</div><div class="t m0 x139 h180 y531e ff19 fsc5 fc0 sc0 ls0 ws0">occurred <span class="_ _42"> </span>if <span class="_ _42"> </span>he <span class="_ _42"> </span>had <span class="_"> </span>copied <span class="_ _23"> </span>the <span class="_"> </span>pr<span class="_ _0"></span>ogram <span class="_ _42"> </span>output <span class="_"> </span>by <span class="_ _23"> </span>hand.<span class="_ _5a"> </span>The <span class="_ _42"> </span>drawback <span class="_ _42"> </span>to <span class="_"> </span>using<span class="_ _45"> </span><span class="ff1a">script</span>,</div><div class="t m0 x139 h17d y531f ff19 fsc5 fc0 sc0 ls0 ws0">however<span class="_ _1"></span>,<span class="_"> </span>is<span class="_"> </span>having to deal with control characters that ar<span class="_ _0"></span><span class="ls1576">ep<span class="_ _84"></span><span class="ls1577">re<span class="ls0">sent in the script ﬁle.</span></span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
