<div id="pf2c4" class="pf w4 h1f" data-page-no="2c4"><div class="pc pc2c4 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg2c4.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">674<span class="_ _1b"> </span><span class="ff19 ls719">Te<span class="_ _9"></span><span class="ls0">rminal <span class="_"> </span>I/O<span class="_ _eb"> </span>Chapter <span class="_"> </span>18</span></span></div><div class="t m0 x3f h2a y12f ff19 fsf fc0 sc0 ls0 ws0">All <span class="_ _35"> </span>the <span class="_ _44"> </span>terminal <span class="_ _35"> </span>device <span class="_ _35"> </span>characteristics <span class="_ _44"> </span>that <span class="_ _35"> </span>we <span class="_ _35"> </span>can <span class="_ _44"> </span>examine <span class="_ _35"> </span>and <span class="_ _35"> </span>change <span class="_ _44"> </span>are</div><div class="t m0 x32 h26 y130 ff19 fsf fc0 sc0 ls0 ws0">contained <span class="_ _5a"> </span>in <span class="_ _5a"> </span>a<span class="_ _5c"> </span><span class="ff1a">termios<span class="_ _1a3"> </span></span>structure. <span class="_ _1a3"> </span>This<span class="_ _1a3"> </span>structure<span class="_ _1a3"> </span>is<span class="_ _1a3"> </span>deﬁned <span class="_ _51"> </span>in <span class="_ _5a"> </span>the <span class="_ _5a"> </span>header</div><div class="t m0 x32 h26 y131 ff1a fsf fc0 sc0 ls0 ws0">&lt;termios.h&gt;<span class="ff19 ls44">,w<span class="_ _d"></span><span class="ls0">hich we use throughout this chapter:</span></span></div><div class="t m0 x3f h57 y4c55 ff1a fs2d fc0 sc0 ls0 ws0">struct termios {</div><div class="t m0 xf4 h57 y4c56 ff1a fs2d fc0 sc0 ls0 ws0">tcflag_t <span class="_"> </span>c_iflag;<span class="_ _15"> </span>/* input flags */</div><div class="t m0 xf4 h57 y4c57 ff1a fs2d fc0 sc0 ls0 ws0">tcflag_t <span class="_"> </span>c_oflag;<span class="_ _15"> </span>/* output flags */</div><div class="t m0 xf4 h57 y4c58 ff1a fs2d fc0 sc0 ls0 ws0">tcflag_t <span class="_"> </span>c_cflag;<span class="_ _15"> </span>/* control flags */</div><div class="t m0 xf4 h57 y4c59 ff1a fs2d fc0 sc0 ls0 ws0">tcflag_t <span class="_"> </span>c_lflag;<span class="_ _15"> </span>/* local flags */</div><div class="t m0 xf4 h57 y4c5a ff1a fs2d fc0 sc0 ls0 ws0">cc_t <span class="_ _8a"> </span>c_cc[NCCS];<span class="_"> </span>/* control characters */</div><div class="t m0 x3f h57 y4ecc ff1a fs2d fc0 sc0 ls0 ws0">};</div><div class="t m0 x32 h2a y4ecd ff19 fsf fc0 sc0 ls0 ws0">Roughly <span class="_ _2"></span>speaking, <span class="_ _2"></span>the <span class="_ _2"></span>input <span class="_ _3"></span>ﬂags <span class="_ _2"></span>control <span class="_ _2"></span>the <span class="_ _2"></span>input <span class="_ _2"></span>of <span class="_ _3"></span>characters <span class="_ _2"></span>by <span class="_ _2"></span>the <span class="_ _3"></span>terminal <span class="_ _2"></span>device</div><div class="t m0 x32 h2a y4ece ff19 fsf fc0 sc0 ls0 ws0">driver <span class="_ _42"> </span>(e.g., <span class="_ _42"> </span>strip <span class="_ _53"> </span>eighth <span class="_ _42"> </span>bit <span class="_ _42"> </span>on <span class="_ _53"> </span>input, <span class="_ _42"> </span>enable <span class="_ _53"> </span>input <span class="_ _42"> </span>parity <span class="_ _42"> </span>checking), <span class="_ _53"> </span>the <span class="_ _42"> </span>output <span class="_ _53"> </span>ﬂags</div><div class="t m0 x32 h2a y4ecf ff19 fsf fc0 sc0 ls0 ws0">control the <span class="_ _3"></span>driver <span class="_ _3"></span>output <span class="_ _2"></span>(e.g., <span class="_ _3"></span>perform <span class="_ _3"></span>output <span class="_ _2"></span>processing, <span class="_ _2"></span>map <span class="_ _3"></span>newline <span class="_ _2"></span>to <span class="_ _3"></span>CR/LF), <span class="_ _3"></span>the</div><div class="t m0 x32 h2a y4ed0 ff19 fsf fc0 sc0 ls0 ws0">control <span class="_ _9"></span>ﬂags <span class="_ _23"></span>affect <span class="_ _9"></span>the <span class="_ _23"></span>RS</div><div class="t m0 x27 h2a y4ed1 ff19 fsf fc0 sc0 ls0 ws0">-</div><div class="t m0 xf3 h2a y4ed0 ff19 fsf fc0 sc0 ls0 ws0">232 <span class="_ _9"></span>serial <span class="_ _23"> </span>lines <span class="_ _23"></span>(e.g., <span class="_ _23"></span>ignor<span class="_ _0"></span><span class="ls143a">em<span class="_ _b"></span><span class="ls0">odem <span class="_ _9"></span>status <span class="_ _23"></span>lines, <span class="_ _9"></span>one <span class="_ _23"> </span>or <span class="_ _23"></span>two</span></span></div><div class="t m0 x32 h2a y4ed2 ff19 fsf fc0 sc0 ls0 ws0">stop <span class="_ _9"></span>bits <span class="_ _23"> </span>per <span class="_ _23"></span>character), <span class="_ _9"></span>and <span class="_ _23"></span>the <span class="_ _23"></span>local <span class="_ _9"></span>ﬂags <span class="_ _23"></span>affect <span class="_ _9"></span>the <span class="_ _9"></span>interface <span class="_ _23"> </span>between <span class="_ _23"></span>the <span class="_ _9"></span>driver <span class="_ _23"></span>and</div><div class="t m0 x32 h2a y4ed3 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _47"> </span>user <span class="_ _47"> </span>(e.g., <span class="_ _47"> </span>echo <span class="_ _45"> </span>on <span class="_ _47"> </span>or <span class="_ _47"> </span>off, <span class="_ _47"> </span>visually <span class="_ _47"> </span>erase <span class="_ _47"> </span>characters, <span class="_ _47"> </span>enable <span class="_ _47"> </span>terminal-generated</div><div class="t m0 x32 h2a y4ed4 ff19 fsf fc0 sc0 ls0 ws0">signals, job control stop signal for backgr<span class="_ _0"></span>ound output).</div><div class="t m0 x3f h26 y4ed5 ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _e"> </span>type<span class="_ _4b"> </span><span class="ff1a">tcflag_t<span class="_ _59"> </span></span>is <span class="_ _e"> </span>big <span class="_ _e"> </span>enough <span class="_"> </span>to <span class="_ _53"> </span>hold <span class="_ _e"> </span>each <span class="_"> </span>of <span class="_ _53"> </span>the <span class="_ _e"> </span>ﬂag <span class="_"> </span>values <span class="_ _53"> </span>and <span class="_ _e"> </span>is <span class="_"> </span>often</div><div class="t m0 x32 h26 y4ed6 ff19 fsf fc0 sc0 ls0 ws0">deﬁned <span class="_ _9"></span>as <span class="_ _9"></span>an<span class="_ _45"> </span><span class="ff1a">unsigned <span class="_ _d"></span>int<span class="_ _45"> </span><span class="ff19">or <span class="_ _9"></span>an<span class="_ _45"> </span></span>unsigned <span class="_ _4f"></span>long<span class="ff19 ls143b">.T<span class="_ _62"></span><span class="ls0">he<span class="_ _45"> </span><span class="ff1a">c_cc<span class="_ _45"> </span></span>array <span class="_ _9"></span>contains <span class="_ _9"></span>all <span class="_ _9"></span>the</span></span></span></div><div class="t m0 x32 h26 y4ed7 ff19 fsf fc0 sc0 ls0 ws0">special characters that <span class="_ _2"></span>we can <span class="_ _2"></span>change.<span class="_ _46"> </span><span class="ff1a">NCCS<span class="_ _66"> </span></span>is the number <span class="_ _2"></span>of elements <span class="_ _2"></span>in this <span class="_ _2"></span>array and</div><div class="t m0 x32 h2a y4ed8 ff19 fsf fc0 sc0 ls0 ws0">is <span class="_ _47"> </span>typically <span class="_ _47"> </span>between <span class="_ _45"> </span>15 <span class="_ _47"> </span>and <span class="_ _47"> </span>20 <span class="_ _47"> </span>(since <span class="_ _45"> </span>most <span class="_ _47"> </span>implementations <span class="_ _47"> </span>of <span class="_ _45"> </span>the <span class="_ _47"> </span>UNIX <span class="_ _47"> </span>System</div><div class="t m0 x32 h26 y4ed9 ff19 fsf fc0 sc0 ls0 ws0">support <span class="_ _42"> </span>mor<span class="ls143c">et<span class="_ _c"></span><span class="ls0">han <span class="_ _42"> </span>the <span class="_ _53"> </span>1<span class="_ _1"></span><span class="ls143c">1P<span class="_ _43"></span><span class="ls0">OSIX-deﬁned <span class="_ _42"> </span>special <span class="_ _42"> </span>characters).<span class="_ _54"> </span>The<span class="_ _44"> </span><span class="ff1a">cc_t<span class="_ _44"> </span></span>type <span class="_ _42"> </span>is <span class="_ _53"> </span>large</span></span></span></span></div><div class="t m0 x32 h26 y4eda ff19 fsf fc0 sc0 ls0 ws0">enough to hold each special character and is typically an<span class="_"> </span><span class="ff1a">unsigned <span class="_ _b"></span>char<span class="ff19">.</span></span></div><div class="t m0 x76 h52 y4edb ff19 fs2a fc0 sc0 ls67a ws0">Ve<span class="_"> </span><span class="ls0">rsions of System V that pr<span class="_ _0"></span>edated the POSIX standar<span class="ls143d">dh<span class="_ _5"></span><span class="ls0">ad a header named<span class="_"> </span><span class="ff1a">&lt;termio.h&gt;<span class="_ _e"> </span></span>and</span></span></span></div><div class="t m0 x76 h52 y4edc ff19 fs2a fc0 sc0 ls143e ws0">as<span class="_ _5"></span><span class="ls0">tructur<span class="ls143f">en<span class="_ _5"></span><span class="ls0">amed<span class="_"> </span><span class="ff1a">termio</span><span class="ls1440">.P<span class="_ _43"></span><span class="ls0">OSIX.1 added <span class="_ _2"></span>an<span class="_"> </span><span class="ff1a">s<span class="_ _80"> </span></span>to the <span class="_ _2"></span>names, <span class="_ _2"></span>to differentiate them <span class="_ _2"></span>from their</span></span></span></span></span></div><div class="t m0 x76 h51 y4edd ff19 fs2a fc0 sc0 ls0 ws0">predecessors.</div><div class="t m0 x3f h2a y4ede ff19 fsf fc0 sc0 ls0 ws0">Figures <span class="_ _3"></span>18.3 <span class="_ _3"></span>through <span class="_ _3"></span>18.6 <span class="_ _9"></span>list <span class="_ _9"></span>all <span class="_ _3"></span>the <span class="_ _9"></span>terminal <span class="_ _9"></span>ﬂags <span class="_ _3"></span>that <span class="_ _9"></span>we <span class="_ _3"></span>can <span class="_ _9"></span>change <span class="_ _9"></span>to <span class="_ _3"></span>affect <span class="_ _3"></span>the</div><div class="t m0 x32 h2a y4edf ff19 fsf fc0 sc0 ls0 ws0">characteristics <span class="_ _46"> </span>of <span class="_ _59"> </span>a <span class="_ _46"> </span>terminal <span class="_ _46"> </span>device.<span class="_ _5e"> </span>Note <span class="_ _46"> </span>that <span class="_ _46"> </span>even <span class="_ _46"> </span>though <span class="_ _46"> </span>the <span class="_ _46"> </span>Single <span class="_ _46"> </span>UNIX</div><div class="t m0 x32 h2a y4ee0 ff19 fsf fc0 sc0 ls0 ws0">Speciﬁcation <span class="_ _16"> </span>deﬁnes <span class="_ _5a"> </span>a <span class="_ _16"> </span>common <span class="_ _5a"> </span>subset <span class="_ _16"> </span>that <span class="_ _5a"> </span>all <span class="_ _16"> </span>platforms <span class="_ _5a"> </span>start <span class="_ _5a"> </span>from, <span class="_ _61"> </span>all <span class="_ _5a"> </span>the</div><div class="t m0 x32 h2a y4ee1 ff19 fsf fc0 sc0 ls0 ws0">implementations <span class="_ _e"> </span>have <span class="_"> </span>their <span class="_ _e"> </span>own <span class="_"> </span>additions.<span class="_ _65"> </span>Most <span class="_"> </span>of <span class="_ _e"> </span>these <span class="_"> </span>additions <span class="_ _53"> </span>come <span class="_"> </span>from <span class="_ _53"> </span>the</div><div class="t m0 x32 h2a y4ee2 ff19 fsf fc0 sc0 ls0 ws0">historical <span class="_ _42"> </span>differ<span class="_ _0"></span>ences <span class="_ _42"> </span>between <span class="_ _42"> </span>the <span class="_ _42"> </span>systems.<span class="_ _54"> </span><span class="ls5f">We<span class="_ _9"></span></span>’ll <span class="_ _53"> </span>discuss <span class="_ _42"> </span>each <span class="_ _42"> </span>of <span class="_ _42"> </span>these <span class="_ _53"> </span>ﬂag <span class="_ _42"> </span>values <span class="_ _42"> </span>in</div><div class="t m0 x32 h2a y4ee3 ff19 fsf fc0 sc0 ls0 ws0">detail in Section 18.5.</div><div class="t m0 x3f h2a y4ee4 ff19 fsf fc0 sc0 ls0 ws0">Given <span class="_ _5a"> </span>all <span class="_ _5a"> </span>the <span class="_ _5a"> </span>options <span class="_ _5a"> </span>available, <span class="_ _5a"> </span>how <span class="_ _5a"> </span>do <span class="_ _5a"> </span>we <span class="_ _5a"> </span>examine <span class="_ _5a"> </span>and <span class="_ _5a"> </span>change <span class="_ _5a"> </span>these</div><div class="t m0 x32 h2a y4ee5 ff19 fsf fc0 sc0 ls0 ws0">characteristics <span class="_"> </span>of <span class="_ _47"> </span>a <span class="_"> </span>terminal <span class="_ _66"> </span>device?<span class="_ _50"> </span>Figur<span class="lsc18">e1<span class="_ _5b"></span><span class="ls0">8.7 <span class="_"> </span>summarizes <span class="_ _47"> </span>the <span class="_"> </span>various <span class="_ _66"> </span>functions</span></span></div><div class="t m0 x32 h2a y4ee6 ff19 fsf fc0 sc0 ls0 ws0">deﬁned <span class="_ _53"> </span>by <span class="_ _e"> </span>the <span class="_ _53"> </span>Single <span class="_ _e"> </span>UNIX <span class="_ _e"> </span>Speciﬁcation <span class="_ _53"> </span>that <span class="_ _e"> </span>operate <span class="_ _53"> </span>on <span class="_ _e"> </span>terminal <span class="_ _e"> </span>devices.<span class="_ _65"> </span>(All <span class="_ _e"> </span>the</div><div class="t m0 x32 h26 y4ee7 ff19 fsf fc0 sc0 ls0 ws0">functions <span class="_ _53"> </span>listed <span class="_ _53"> </span>ar<span class="ls1441">ep<span class="_ _55"></span><span class="ls0">art <span class="_ _53"> </span>of <span class="_ _e"> </span>the <span class="_ _53"> </span>base <span class="_ _53"> </span>POSIX <span class="_ _53"> </span>speciﬁcation.<span class="_ _65"> </span><span class="ls5f">We <span class="_ _35"> </span>d<span class="_ _9"></span></span>escribed<span class="_ _44"> </span><span class="ff1a">tcgetpgrp</span>,</span></span></div><div class="t m0 x32 h26 y4ee8 ff1a fsf fc0 sc0 ls0 ws0">tcgetsid<span class="ff19 ls44">,a<span class="_ _d"></span><span class="ls0">nd<span class="_"> </span><span class="ff1a">tcsetpgrp<span class="_ _66"> </span></span>in Section 9.7.)</span></span></div><div class="t m0 x3f h26 y4ee9 ff19 fsf fc0 sc0 ls0 ws0">Note <span class="_ _9"></span>that <span class="_ _9"></span>the <span class="_ _9"></span>Single <span class="_ _23"></span>UNIX <span class="_ _9"></span>Speciﬁcation <span class="_ _9"></span>doesn’t <span class="_ _9"></span>use <span class="_ _9"></span>the <span class="_ _23"></span>classic<span class="_ _45"> </span><span class="ff1a">ioctl<span class="_ _45"> </span></span>on <span class="_ _9"></span>terminal</div><div class="t m0 x32 h2a y4eea ff19 fsf fc0 sc0 ls0 ws0">devices. <span class="_ _45"> </span>Instead,<span class="_ _45"> </span>it <span class="_ _23"></span>uses <span class="_ _9"></span>the <span class="_ _23"></span>13 <span class="_ _9"></span>functions <span class="_ _23"></span>shown <span class="_ _9"></span>in <span class="_ _23"></span>Figur<span class="ls1442">e1<span class="_ _43"></span><span class="ls0">8.7. <span class="_ _35"> </span>The<span class="_ _45"> </span><span class="ls45">re</span>ason <span class="_ _23"></span>is <span class="_ _9"></span>that <span class="_ _23"></span>the</span></span></div><div class="t m0 x32 h26 y4eeb ff1a fsf fc0 sc0 ls0 ws0">ioctl<span class="_ _35"> </span><span class="ff19">function <span class="_ _23"> </span>for <span class="_ _42"> </span>terminal <span class="_ _23"> </span>devices <span class="_ _42"> </span>uses <span class="_ _23"> </span>a <span class="_ _42"> </span>differ<span class="_ _1"></span>ent <span class="_ _42"> </span>data <span class="_ _23"> </span>type <span class="_ _42"> </span>for <span class="_ _23"> </span>its <span class="_ _42"> </span>ﬁnal <span class="_ _23"> </span>argument,</span></div><div class="t m0 x32 h2a y4eec ff19 fsf fc0 sc0 ls0 ws0">which <span class="_ _47"> </span>depends <span class="_ _47"> </span>on <span class="_ _47"> </span>the <span class="_ _45"> </span>action <span class="_ _47"> </span>being <span class="_ _47"> </span>performed.<span class="_ _5f"> </span>This <span class="_ _47"> </span>makes <span class="_ _47"> </span>type <span class="_ _45"> </span>checking <span class="_ _47"> </span>of <span class="_ _47"> </span>the</div><div class="t m0 x32 h2a y4eed ff19 fsf fc0 sc0 ls0 ws0">arguments impossible.</div><div class="t m0 x3f h2a y4eee ff19 fsf fc0 sc0 ls0 ws0">Although <span class="_ _9"></span>only <span class="_ _23"></span>13 <span class="_ _9"></span>functions <span class="_ _23"></span>operate <span class="_ _9"></span>on <span class="_ _23"> </span>terminal <span class="_ _23"></span>devices, <span class="_ _9"></span>the <span class="_ _23"></span>ﬁrst <span class="_ _9"></span>two <span class="_ _23"></span>functions <span class="_ _9"></span>in</div><div class="t m0 x32 h26 y4eef ff19 fsf fc0 sc0 ls0 ws0">Figur<span class="ls1443">e1<span class="_ _4a"></span><span class="ls0">8.7 <span class="_"> </span>(<span class="ff1a">tcgetattr<span class="_ _44"> </span></span>and<span class="_ _59"> </span><span class="ff1a">tcsetattr</span><span class="ls1443">)m<span class="_ _55"></span><span class="ls0">anipulate <span class="_ _e"> </span>almost <span class="_ _e"> </span>70 <span class="_"> </span>dif<span class="_ _1"></span>ferent <span class="_ _e"> </span>ﬂags <span class="_ _e"> </span>(see</span></span></span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
