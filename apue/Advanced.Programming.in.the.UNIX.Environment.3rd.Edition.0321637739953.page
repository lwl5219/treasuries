<div id="pf3b9" class="pf w4 h1f" data-page-no="3b9"><div class="pc pc3b9 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg3b9.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Appendix <span class="_"> </span>C<span class="_ _322"> </span>Chapter <span class="_"> </span>7<span class="_ _54"> </span>Solutions<span class="_ _1b"> </span><span class="ff18">919</span></div><div class="t m0 xc4 h57 y425 ff1a fs2d fc0 sc0 ls0 ws0">printf(&quot;pw_passwd = %s\n&quot;, ptr-&gt;pw_passwd == NULL ||</div><div class="t m0 x1b0 h57 y426 ff1a fs2d fc0 sc0 ls0 ws0">ptr-&gt;pw_passwd[0] == 0 ?<span class="_ _d9"> </span>&quot;(null)&quot; : ptr-&gt;pw_passwd);</div><div class="t m0 xc4 h57 y800 ff1a fs2d fc0 sc0 ls0 ws0">exit(0);</div><div class="t m0 x215 h57 y801 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x1ca h2d y24dc ff18 fs10 fc0 sc0 ls0 ws0">Figure C.6<span class="_ _5a"> </span><span class="ff19">Print encrypted passwor<span class="ls136">du<span class="_ _84"></span><span class="ls0">nder FreeBSD and Mac OS X</span></span></span></div><div class="t m0 x32 h4d y60cc ff18 fs26 fc0 sc0 ls0 ws0">6.5<span class="_ _9b"> </span><span class="ff19">The <span class="_ _2"></span>program <span class="_ _3"></span>shown <span class="_ _3"></span>in <span class="_ _9"></span>Figur<span class="ls1825">eC<span class="_ _b"></span><span class="ls0">.7 <span class="_ _3"></span>prints <span class="_ _9"></span>the <span class="_ _3"></span>date <span class="_ _3"></span>in <span class="_ _9"></span>a <span class="_ _3"></span>format <span class="_ _3"></span>similar <span class="_ _9"></span>to <span class="_ _3"></span>the<span class="_ _47"> </span><span class="ff1a">date</span></span></span></span></div><div class="t m0 x215 h49 y60cd ff19 fs26 fc0 sc0 ls0 ws0">command.</div><div class="t m0 x215 h5d y60ce ff1a fs2f fc0 sc0 ls0 ws0">#include &quot;apue.h&quot;</div><div class="t m0 x215 h5d y60cf ff1a fs2f fc0 sc0 ls0 ws0">#include &lt;time.h&gt;</div><div class="t m0 x215 h5d y60d0 ff1a fs2f fc0 sc0 ls0 ws0">int</div><div class="t m0 x215 h5d y60d1 ff1a fs2f fc0 sc0 ls0 ws0">main(void)</div><div class="t m0 x215 h5d y60d2 ff1a fs2f fc0 sc0 ls0 ws0">{</div><div class="t m0 xc4 h5d y60d3 ff1a fs2f fc0 sc0 ls0 ws0">time_t <span class="_ _8a"> </span>caltime;</div><div class="t m0 xc4 h5d y60d4 ff1a fs2f fc0 sc0 ls0 ws0">struct tm<span class="_ _68"> </span>*tm;</div><div class="t m0 xc4 h5d y60d5 ff1a fs2f fc0 sc0 ls0 ws0">char <span class="_ _b7"> </span>line[MAXLINE];</div><div class="t m0 xc4 h5d y60d6 ff1a fs2f fc0 sc0 ls0 ws0">if ((caltime = time(NULL)) == -1)</div><div class="t m0 x206 h5d y60d7 ff1a fs2f fc0 sc0 ls0 ws0">err_sys(&quot;time error&quot;);</div><div class="t m0 xc4 h5d y60d8 ff1a fs2f fc0 sc0 ls0 ws0">if ((tm = localtime(&amp;caltime)) == NULL)</div><div class="t m0 x206 h5d y60d9 ff1a fs2f fc0 sc0 ls0 ws0">err_sys(&quot;localtime error&quot;);</div><div class="t m0 xc4 h5d y60da ff1a fs2f fc0 sc0 ls0 ws0">if (strftime(line, MAXLINE, &quot;%a %b %d %X %Z %Y\n&quot;, tm) == 0)</div><div class="t m0 x206 h5d y60db ff1a fs2f fc0 sc0 ls0 ws0">err_sys(&quot;strftime error&quot;);</div><div class="t m0 xc4 h5d y60dc ff1a fs2f fc0 sc0 ls0 ws0">fputs(line, stdout);</div><div class="t m0 xc4 h5d y60dd ff1a fs2f fc0 sc0 ls0 ws0">exit(0);</div><div class="t m0 x215 h5d y60de ff1a fs2f fc0 sc0 ls0 ws0">}</div><div class="t m0 x25 h6d y60df ff18 fs12 fc0 sc0 ls0 ws0">Figure C.7<span class="_ _5a"> </span><span class="ff19">Print the time and date in a format similar to<span class="_"> </span><span class="ff1a">date</span></span></div><div class="t m0 x11d h2f y60e0 ff19 fs12 fc0 sc0 ls0 ws0">(</div><div class="t m0 x16b h2f y60df ff19 fs12 fc0 sc0 ls0 ws0">1</div><div class="t m0 x3e h2f y60e0 ff19 fs12 fc0 sc0 ls0 ws0">)</div><div class="t m0 x215 h50 y60e1 ff19 fs29 fc0 sc0 ls0 ws0">Running this program gives us</div><div class="t m0 x1a7 h62 y60e2 ff1a fs30 fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">./a.out<span class="_ _168"> </span><span class="ff1b">author <span class="_ _84"></span>â€™<span class="_ _1"></span><span class="lsa5b">sd<span class="_ _5"></span><span class="ls0">efault is US/Eastern</span></span></span></span></div><div class="t m0 x1a7 h62 y60e3 ff1a fs30 fc0 sc0 ls0 ws0">Wed Jul 25 22:58:32 EDT 2012</div><div class="t m0 x1a7 h62 y60e4 ff1a fs30 fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">TZ=US/Mountain ./a.out<span class="_ _1f9"> </span><span class="ff1b">U.S. Mountain time zone</span></span></div><div class="t m0 x1a7 h62 y60e5 ff1a fs30 fc0 sc0 ls0 ws0">Wed Jul 25 20:58:32 MDT 2012</div><div class="t m0 x1a7 h62 y60e6 ff1a fs30 fc0 sc0 ls0 ws0">$<span class="_"> </span><span class="ff1f">TZ=Japan ./a.out<span class="_ _191"> </span><span class="ff1b">Japan</span></span></div><div class="t m0 x1a7 h62 y60e7 ff1a fs30 fc0 sc0 ls0 ws0">Thu Jul 26 11:58:32 JST 2012</div><div class="t m0 x35 h5a y60e8 ff16 fs29 fc0 sc0 ls0 ws0">Chapter <span class="_"> </span>7</div><div class="t m0 x32 h5c y60e9 ff18 fs29 fc0 sc0 ls0 ws0">7.1<span class="_ _9b"> </span><span class="ff19">It <span class="_ _9"></span>appears <span class="_ _9"></span>that <span class="_ _23"></span>the <span class="_ _9"></span>return <span class="_ _23"></span>value <span class="_ _9"></span>from<span class="_ _45"> </span><span class="ff1a">printf<span class="_ _45"> </span></span>(the <span class="_ _23"> </span>number <span class="_ _23"></span>of <span class="_ _9"></span>characters <span class="_ _23"></span>output)</span></div><div class="t m0 x215 h5c y60ea ff19 fs29 fc0 sc0 ls0 ws0">becomes <span class="_ _3"></span>the <span class="_ _3"></span>return <span class="_ _2"></span>value <span class="_ _3"></span>of<span class="_ _45"> </span><span class="ff1a">main</span><span class="ls1826">.T<span class="_ _52"></span><span class="ls1827">ov<span class="_ _8"></span><span class="ls0">erify <span class="_ _3"></span>this <span class="_ _3"></span>theory<span class="_ _6"></span><span class="ls1827">,c<span class="_ _8"></span><span class="ls0">hange <span class="_ _3"></span>the <span class="_ _3"></span>length <span class="_ _3"></span>of <span class="_ _3"></span>the</span></span></span></span></span></div><div class="t m0 x215 h50 y60eb ff19 fs29 fc0 sc0 ls0 ws0">string <span class="_ _9"></span>printed <span class="_ _9"></span>and <span class="_ _9"></span>see <span class="_ _3"></span>if <span class="_ _9"></span>the <span class="_ _9"></span>new <span class="_ _9"></span>length <span class="_ _9"></span>matches <span class="_ _9"></span>the <span class="_ _9"></span>return <span class="_ _3"></span>value.<span class="_ _5a"> </span>Note <span class="_ _9"></span>that <span class="_ _9"></span>not</div><div class="t m0 x215 h50 y60ec ff19 fs29 fc0 sc0 ls0 ws0">all systems exhibit this property<span class="_ _4"></span><span class="ls1828">.A<span class="_ _4a"></span><span class="ls0">lso note that if you <span class="_ _2"></span>enable the ISO C extensions</span></span></div><div class="t m0 x215 h5c y60ed ff19 fs29 fc0 sc0 ls0 ws0">in<span class="_"> </span><span class="ff1a">gcc</span><span class="lsdd">,t<span class="_ _d"></span><span class="ls0">hen the return value is always 0, as requir<span class="_ _1"></span>ed by the standard.</span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
