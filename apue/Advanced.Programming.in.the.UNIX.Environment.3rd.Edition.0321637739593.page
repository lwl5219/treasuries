<div id="pf251" class="pf w4 h1f" data-page-no="251"><div class="pc pc251 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="bg251.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>15.6<span class="_ _183"> </span>XSI <span class="_"> </span>IPC<span class="_ _1b"> </span><span class="ff18">559</span></div><div class="t m0 xe h51 y597 ff19 fs2a fc0 sc0 ls0 ws0">Permission <span class="_ _ba"> </span>Bit</div><div class="t m0 xff h5e y7b6 ff19 fs10 fc0 sc0 ls0 ws0">user-r<span class="_ _0"></span>ead<span class="_ _165"> </span><span class="ff1a">0400</span></div><div class="t m0 xff h5e y7b7 ff19 fs10 fc0 sc0 ls0 ws0">user-write (alter)<span class="_ _2b9"> </span><span class="ff1a">0200</span></div><div class="t m0 xff h4f y439b ff19 fs11 fc0 sc0 ls0 ws0">group-r<span class="_ _0"></span>ead<span class="_ _90"> </span><span class="ff1a">0040</span></div><div class="t m0 xff h4f y439c ff19 fs11 fc0 sc0 ls0 ws0">group-write (alter)<span class="_ _288"> </span><span class="ff1a">0020</span></div><div class="t m0 xff h6d y439d ff19 fs12 fc0 sc0 ls0 ws0">other-r<span class="_ _0"></span>ead<span class="_ _6f"> </span><span class="ff1a">0004</span></div><div class="t m0 xff h6d y439e ff19 fs12 fc0 sc0 ls0 ws0">other-write (alter)<span class="_ _2b"> </span><span class="ff1a">0002</span></div><div class="t m0 x128 h30 y439f ff18 fs13 fc0 sc0 ls0 ws0">Figure 15.24<span class="_ _5a"> </span><span class="ff19">XSI IPC permissions</span></div><div class="t m0 x3f h6e y43a0 ff19 fs31 fc0 sc0 ls0 ws0">Some <span class="_ _3"></span>implementations <span class="_ _3"></span>deﬁne <span class="_ _3"></span>symbolic <span class="_ _3"></span>constants <span class="_ _3"></span>to <span class="_ _3"></span>repr<span class="_ _0"></span>esent <span class="_ _3"></span>each <span class="_ _3"></span>permission, <span class="_ _3"></span>but</div><div class="t m0 x32 h6e y43a1 ff19 fs31 fc0 sc0 ls0 ws0">these constants ar<span class="ls229">en<span class="_ _4f"></span><span class="ls0">ot standardized by the Single UNIX Speciﬁcation.</span></span></div><div class="t m0 x32 h78 y43a2 ff16 fs3a fc0 sc0 ls0 ws0">15.6.3 <span class="_ _54"> </span>Conﬁguration<span class="_ _54"> </span>Limits</div><div class="t m0 x32 h6e y43a3 ff19 fs31 fc0 sc0 ls0 ws0">All <span class="_ _23"></span>three <span class="_ _9"></span>forms <span class="_ _42"> </span>of <span class="_ _23"></span>XSI <span class="_ _23"></span>IPC <span class="_ _23"></span>have <span class="_ _23"></span>built-in <span class="_ _23"> </span>limits <span class="_ _23"> </span>that <span class="_ _23"> </span>we <span class="_ _23"> </span>may <span class="_ _23"> </span>encounter<span class="_ _1"></span><span class="ls11f3">.M<span class="_ _26"></span><span class="ls0">ost <span class="_ _23"></span>of <span class="_ _23"></span>these</span></span></div><div class="t m0 x32 h6e y43a4 ff19 fs31 fc0 sc0 ls0 ws0">limits <span class="_ _53"> </span>can <span class="_ _53"> </span>be <span class="_ _53"> </span>changed <span class="_ _53"> </span>by <span class="_ _53"> </span>reconﬁguring <span class="_ _53"> </span>the <span class="_ _53"> </span>kernel.<span class="_ _65"> </span><span class="ls43f">We <span class="_ _35"> </span>d<span class="_ _9"></span></span>escribe <span class="_ _53"> </span>the <span class="_ _53"> </span>limits <span class="_ _53"> </span>when <span class="_ _53"> </span>we</div><div class="t m0 x32 h6e y43a5 ff19 fs31 fc0 sc0 ls0 ws0">describe each of the three forms of IPC.</div><div class="t m0 x76 h30 y1ffe ff19 fs13 fc0 sc0 ls0 ws0">Each <span class="_ _23"> </span>platform <span class="_ _42"> </span>provides <span class="_ _23"> </span>its <span class="_ _42"> </span>own <span class="_ _23"> </span>way <span class="_ _42"> </span>to <span class="_ _42"> </span>report <span class="_ _23"> </span>and <span class="_ _23"> </span>modify <span class="_ _42"> </span>a <span class="_ _42"> </span>particular <span class="_ _23"> </span>limit.<span class="_ _16"> </span>FreeBSD <span class="_ _23"> </span>8.0,</div><div class="t m0 x76 h63 y1fff ff19 fs13 fc0 sc0 ls0 ws0">Linux <span class="_ _9"></span>3.2.0, <span class="_ _9"></span>and <span class="_ _9"> </span>Mac <span class="_ _23"> </span>OS <span class="_ _9"></span>X <span class="_ _9"></span>10.6.8 <span class="_ _9"></span>provide <span class="_ _9"></span>the<span class="_ _47"> </span><span class="ff1a">sysctl<span class="_ _66"> </span></span>command <span class="_ _23"> </span>to <span class="_ _9"></span>view <span class="_ _9"></span>and <span class="_ _9"></span>modify <span class="_ _9"></span>kernel</div><div class="t m0 x76 h30 y2000 ff19 fs13 fc0 sc0 ls0 ws0">conﬁguration <span class="_"> </span>parameters.<span class="_ _16"> </span>On <span class="_"> </span>Solaris <span class="_"> </span>10, <span class="_"> </span>changes <span class="_"> </span>to <span class="_ _42"> </span>kernel <span class="_"> </span>IPC <span class="_"> </span>limits <span class="_"> </span>ar<span class="_ _0"></span><span class="ls11f4">em<span class="_ _43"></span><span class="ls0">ade <span class="_"> </span>with <span class="_"> </span>the</span></span></div><div class="t m0 x76 h63 y2001 ff1a fs13 fc0 sc0 ls0 ws0">prctl<span class="_ _53"> </span><span class="ff19">command.</span></div><div class="t m0 x76 h63 y43a6 ff19 fs13 fc0 sc0 ls0 ws0">On <span class="_ _3"></span>Linux, <span class="_ _3"></span>you <span class="_ _3"></span>can <span class="_ _3"></span>display <span class="_ _3"></span>the <span class="_ _3"></span>IPC-related <span class="_ _3"></span>limits <span class="_ _3"></span>by <span class="_ _3"></span>running<span class="_ _80"> </span><span class="ff1a">ipcs <span class="_ _84"></span>-l<span class="ff19 ls11f5">.O<span class="_ _55"></span><span class="ls11f6">nF<span class="_ _d"></span><span class="ls4d0">re<span class="_ _2"></span><span class="ls0">eBSD <span class="_ _3"></span>and <span class="_ _3"></span>Mac</span></span></span></span></span></div><div class="t m0 x76 h63 y43a7 ff19 fs13 fc0 sc0 ls0 ws0">OS <span class="_ _66"> </span>X, <span class="_ _47"> </span>the <span class="_ _66"> </span>equivalent <span class="_ _47"> </span>command <span class="_ _66"> </span>is<span class="_ _59"> </span><span class="ff1a">ipcs <span class="_ _84"></span>-T<span class="ff19 ls11f7">.O<span class="_ _52"></span><span class="ls11f8">nS<span class="_ _4a"></span><span class="ls0">olaris, <span class="_ _66"> </span>you <span class="_ _47"> </span>can <span class="_ _66"> </span>discover <span class="_ _47"> </span>the <span class="_ _66"> </span>tunable</span></span></span></span></div><div class="t m0 x76 h63 y43a8 ff19 fs13 fc0 sc0 ls0 ws0">parameters by running<span class="_"> </span><span class="ff1a">sysdef <span class="_ _5"></span>-i<span class="ff19">.</span></span></div><div class="t m0 x32 h78 y43a9 ff16 fs3a fc0 sc0 ls0 ws0">15.6.4 <span class="_ _54"> </span>Ad<span class="ls11f9">va</span>nta<span class="ls11fa">ge<span class="ls11fb">sa<span class="_ _52"></span><span class="ls0">nd <span class="_"> </span>Disad<span class="_ _0"></span><span class="ls11f9">va<span class="ls0">nta<span class="ls11fa">ge</span>s</span></span></span></span></span></div><div class="t m0 x32 h6e y43aa ff19 fs31 fc0 sc0 ls11fc ws0">Af<span class="_ _8"></span><span class="ls0">undamental <span class="_ _3"></span>problem <span class="_ _2"></span>with <span class="_ _3"></span>XSI <span class="_ _3"></span>IPC <span class="_ _3"></span>is <span class="_ _3"></span>that <span class="_ _3"></span>the <span class="_ _3"></span>IPC <span class="_ _2"></span>structures <span class="_ _2"></span>ar<span class="ls11fd">es<span class="_ _8"></span><span class="ls0">ystemwide <span class="_ _3"></span>and <span class="_ _3"></span>do</span></span></span></div><div class="t m0 x32 h6e y43ab ff19 fs31 fc0 sc0 ls0 ws0">not <span class="_ _42"> </span>have <span class="_ _53"> </span>a <span class="_ _53"> </span>reference <span class="_ _42"> </span>count.<span class="_ _54"> </span>For <span class="_ _53"> </span>example, <span class="_ _53"> </span>if <span class="_ _53"> </span>we <span class="_ _53"> </span>create <span class="_ _42"> </span>a <span class="_ _53"> </span>message <span class="_ _53"> </span>queue, <span class="_ _53"> </span>place <span class="_ _53"> </span>some</div><div class="t m0 x32 h6e y43ac ff19 fs31 fc0 sc0 ls0 ws0">messages <span class="_ _2"></span>on <span class="_ _3"></span>the <span class="_ _2"></span>queue, <span class="_ _3"></span>and <span class="_ _2"></span>then <span class="_ _3"></span>terminate, <span class="_ _2"></span>the <span class="_ _3"></span>message <span class="_ _2"></span>queue <span class="_ _3"></span>and <span class="_ _2"></span>its <span class="_ _3"></span>contents <span class="_ _2"></span>ar<span class="ls11fe">en<span class="_ _8"></span><span class="ls0">ot</span></span></div><div class="t m0 x32 h6e y43ad ff19 fs31 fc0 sc0 ls0 ws0">deleted. <span class="_ _45"> </span>They<span class="_ _35"> </span><span class="ls225">re</span>main <span class="_ _9"></span>in <span class="_ _23"></span>the <span class="_ _23"></span>system <span class="_ _9"></span>until <span class="_ _23"></span>speciﬁcally <span class="_ _9"></span>read <span class="_ _9"></span>or <span class="_ _23"></span>deleted <span class="_ _9"></span>by <span class="_ _23"></span>some <span class="_ _9"></span>process</div><div class="t m0 x32 h64 y43ae ff19 fs31 fc0 sc0 ls0 ws0">calling<span class="_ _35"> </span><span class="ff1a">msgrcv<span class="_ _35"> </span></span>or<span class="_ _35"> </span><span class="ff1a">msgctl</span>,<span class="_ _44"> </span>by<span class="_ _35"> </span>someone <span class="_ _23"> </span>executing <span class="_ _42"> </span>the<span class="_ _35"> </span><span class="ff1a">ipcrm</span></div><div class="t m0 xc h6e y43af ff19 fs31 fc0 sc0 ls0 ws0">(</div><div class="t m0 x6e h6e y43ae ff19 fs31 fc0 sc0 ls0 ws0">1</div><div class="t m0 x102 h6e y43af ff19 fs31 fc0 sc0 ls0 ws0">)</div><div class="t m0 x119 h6e y43ae ff19 fs31 fc0 sc0 ls0 ws0">command, <span class="_ _23"> </span>or <span class="_ _42"> </span>by <span class="_ _23"> </span>the</div><div class="t m0 x32 h6e y43b0 ff19 fs31 fc0 sc0 ls0 ws0">system <span class="_ _3"></span>being <span class="_ _9"></span>rebooted. <span class="_ _47"> </span>Compar<span class="ls11ff">et<span class="_ _b"></span><span class="ls0">his <span class="_ _3"></span>with <span class="_ _9"></span>a <span class="_ _3"></span>pipe, <span class="_ _3"></span>which <span class="_ _9"></span>is <span class="_ _3"></span>completely <span class="_ _9"></span>removed <span class="_ _2"></span>when</span></span></div><div class="t m0 x32 h6e y43b1 ff19 fs31 fc0 sc0 ls0 ws0">the <span class="_ _3"></span>last <span class="_ _3"></span>process <span class="_ _3"></span>to <span class="_ _3"></span>refer<span class="_ _0"></span>ence <span class="_ _3"></span>it <span class="_ _3"></span>terminates.<span class="_ _16"> </span><span class="ls439">Wi<span class="_ _3"></span></span>th <span class="_ _3"></span>a <span class="_ _9"></span>FIFO, <span class="_ _3"></span>although <span class="_ _3"></span>the <span class="_ _3"></span>name <span class="_ _3"></span>stays <span class="_ _9"></span>in <span class="_ _3"></span>the</div><div class="t m0 x32 h6e y43b2 ff19 fs31 fc0 sc0 ls0 ws0">ﬁle <span class="_ _23"></span>system <span class="_ _23"></span>until <span class="_ _9"></span>explicitly <span class="_ _23"> </span>removed, <span class="_ _23"></span>any <span class="_ _23"></span>data <span class="_ _23"></span>left <span class="_ _9"></span>in <span class="_ _23"> </span>a <span class="_ _23"> </span>FIFO <span class="_ _23"> </span>is <span class="_ _23"> </span>removed <span class="_ _9"></span>when <span class="_ _23"> </span>the <span class="_ _23"> </span>last</div><div class="t m0 x32 h6e y43b3 ff19 fs31 fc0 sc0 ls0 ws0">process to r<span class="_ _0"></span>efer<span class="_ _0"></span>ence the FIFO terminates.</div><div class="t m0 x3f h6e y43b4 ff19 fs31 fc0 sc0 ls0 ws0">Another <span class="_ _2"></span>problem with <span class="_ _2"></span>XSI <span class="_ _2"></span>IPC <span class="_ _2"></span>is <span class="_ _2"></span>that <span class="_ _3"></span>these <span class="_ _2"></span>IPC <span class="_ _2"></span>structures ar<span class="ls1200">en<span class="_ _8"></span><span class="ls0">ot <span class="_ _2"></span>known <span class="_ _3"></span>by <span class="_ _2"></span>names</span></span></div><div class="t m0 x32 h6e y43b5 ff19 fs31 fc0 sc0 ls0 ws0">in <span class="_ _2"></span>the <span class="_ _3"></span>ﬁle <span class="_ _3"></span>system.<span class="_ _16"> </span><span class="ls43f">We <span class="_ _80"> </span>c<span class="_ _9"></span></span>an’t <span class="_ _3"></span>access <span class="_ _3"></span>them <span class="_ _3"></span>and <span class="_ _3"></span>modify <span class="_ _3"></span>their <span class="_ _3"></span>properties <span class="_ _2"></span>with <span class="_ _3"></span>the <span class="_ _3"></span>functions</div><div class="t m0 x32 h64 y43b6 ff19 fs31 fc0 sc0 ls0 ws0">we <span class="_ _3"></span>described <span class="_ _9"></span>in <span class="_ _3"></span>Chapters <span class="_ _9"></span>3 <span class="_ _3"></span>and <span class="_ _9"></span>4.<span class="_ _5a"> </span>Almost <span class="_ _3"></span>a <span class="_ _9"></span>dozen <span class="_ _3"></span>new <span class="_ _9"></span>system <span class="_ _3"></span>calls <span class="_ _9"></span>(<span class="ff1a">msgget</span>,<span class="_ _45"> </span><span class="ff1a">semop</span>,</div><div class="t m0 x32 h64 y43b7 ff1a fs31 fc0 sc0 ls0 ws0">shmat<span class="ff19 ls1201">,a<span class="_ _8"></span><span class="ls0">nd <span class="_ _3"></span>so <span class="_ _3"></span>on) <span class="_ _3"></span>wer<span class="ls1202">ea<span class="_ _8"></span><span class="ls0">dded <span class="_ _3"></span>to <span class="_ _3"></span>the <span class="_ _3"></span>kernel <span class="_ _3"></span>to <span class="_ _3"></span>support <span class="_ _9"></span>these <span class="_ _2"></span>IPC <span class="_ _9"></span>objects.<span class="_ _61"> </span><span class="ls43f">We <span class="_ _80"> </span>c<span class="_ _23"></span></span>an’t <span class="_ _2"></span>see</span></span></span></span></div><div class="t m0 x32 h64 y43b8 ff19 fs31 fc0 sc0 ls0 ws0">the IPC objects <span class="_ _2"></span>with an<span class="_"> </span><span class="ff1a">ls<span class="_ _66"> </span></span>command, we <span class="_ _2"></span>can’t remove them with <span class="_ _2"></span>the<span class="_"> </span><span class="ff1a">rm<span class="_ _66"> </span></span>command, and</div><div class="t m0 x32 h64 y43b9 ff19 fs31 fc0 sc0 ls0 ws0">we <span class="_ _45"> </span>can’t <span class="_ _45"> </span>change <span class="_ _45"> </span>their <span class="_ _45"> </span>permissions <span class="_ _45"> </span>with <span class="_ _45"> </span>the<span class="_ _5a"> </span><span class="ff1a">chmod<span class="_"> </span></span>command. <span class="_ _5a"> </span>Instead,<span class="_ _5a"> </span>two <span class="_ _35"> </span>new</div><div class="t m0 x32 h64 y43ba ff19 fs31 fc0 sc0 ls0 ws0">commands <span class="_ _a"></span>—<span class="_ _9"></span><span class="ff1a">ipcs</span></div><div class="t m0 xe7 h6e y43bb ff19 fs31 fc0 sc0 ls0 ws0">(</div><div class="t m0 xe8 h6e y43ba ff19 fs31 fc0 sc0 ls0 ws0">1</div><div class="t m0 x161 h6e y43bb ff19 fs31 fc0 sc0 ls0 ws0">)</div><div class="t m0 x89 h64 y43ba ff19 fs31 fc0 sc0 ls0 ws0">and<span class="_"> </span><span class="ff1a">ipcrm</span></div><div class="t m0 x1e2 h6e y43bb ff19 fs31 fc0 sc0 ls0 ws0">(</div><div class="t m0 x5b h6e y43ba ff19 fs31 fc0 sc0 ls0 ws0">1</div><div class="t m0 xc1 h6e y43bb ff19 fs31 fc0 sc0 ls0 ws0">)</div><div class="t m0 x16 h6e y43ba ff19 fs31 fc0 sc0 ls417 ws0">—w<span class="_ _6"></span><span class="ls0">er<span class="ls229">ea<span class="_ _d"></span><span class="ls0">dded.</span></span></span></div><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:156.494092px;bottom:900.295197px;width:164.041000px;height:19.679992px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf12" data-dest-detail='[18,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:156.494092px;bottom:562.193082px;width:229.921005px;height:19.680023px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
