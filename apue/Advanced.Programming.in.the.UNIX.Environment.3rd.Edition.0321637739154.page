<div id="pf9a" class="pf w4 h1f" data-page-no="9a"><div class="pc pc9a w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg9a.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">120<span class="_ _1b"> </span><span class="ff19">Files <span class="_"> </span>and <span class="_"> </span>Directories <span class="_ _18d"> </span>Chapter<span class="_ _4b"> </span>4</span></div><div class="t m0 x3f h2b y12f ff19 fsf fc0 sc0 ls0 ws0">3. <span class="_ _51"> </span>If<span class="_ _4b"> </span>either<span class="_ _59"> </span><span class="ff1b">oldname<span class="_ _4b"> </span></span>or<span class="_ _59"> </span><span class="ff1b">newname<span class="_ _4b"> </span></span><span class="ls45">re<span class="_ _2"></span></span>fers <span class="_ _e"> </span>to <span class="_ _e"> </span>a <span class="_ _e"> </span>symbolic <span class="_ _e"> </span>link, <span class="_ _e"> </span>then <span class="_"> </span>the <span class="_ _53"> </span>link <span class="_ _e"> </span>itself <span class="_ _e"> </span>is</div><div class="t m0 x41 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">processed, not the ﬁle to which it r<span class="_ _0"></span>esolves.</div><div class="t m0 x3f h2a y114d ff19 fsf fc0 sc0 ls0 ws0">4. <span class="_ _51"> </span>W<span class="_ _6"></span><span class="ls552">ec<span class="_ _c"></span><span class="ls0">an’t <span class="_ _53"> </span>rename <span class="_ _42"> </span>dot <span class="_ _53"> </span>or <span class="_ _53"> </span>dot-dot.<span class="_ _65"> </span>Mor<span class="ls553">ep<span class="_ _55"></span><span class="ls45">re<span class="_ _2"></span><span class="ls0">cisely<span class="_ _6"></span><span class="ls553">,n<span class="_ _c"></span><span class="ls0">either <span class="_ _53"> </span>dot <span class="_ _42"> </span>nor <span class="_ _53"> </span>dot-dot <span class="_ _53"> </span>can</span></span></span></span></span></span></span></div><div class="t m0 x41 h2b y114e ff19 fsf fc0 sc0 ls0 ws0">appear as the last component of<span class="_"> </span><span class="ff1b">oldname<span class="_"> </span></span>or<span class="_"> </span><span class="ff1b">newname</span>.</div><div class="t m0 x3f h2b y114f ff19 fsf fc0 sc0 ls0 ws0">5. <span class="_ _51"> </span>As<span class="_ _44"> </span><span class="ls554">as<span class="_ _43"></span><span class="ls0">pecial <span class="_ _42"> </span>case, <span class="_ _42"> </span>if<span class="_ _44"> </span><span class="ff1b">oldname<span class="_ _44"> </span></span>and<span class="_ _44"> </span><span class="ff1b">newname<span class="_ _44"> </span></span><span class="ls45">re<span class="_ _2"></span></span>fer <span class="_ _53"> </span>to <span class="_ _42"> </span>the <span class="_ _53"> </span>same <span class="_ _42"> </span>ﬁle, <span class="_ _53"> </span>the <span class="_ _53"> </span>function</span></span></div><div class="t m0 x41 h2a y1150 ff19 fsf fc0 sc0 ls45 ws0">re<span class="ls0">turns successfully without changing anything.</span></div><div class="t m0 x32 h2b y1151 ff19 fsf fc0 sc0 ls0 ws0">If<span class="_ _47"> </span><span class="ff1b">newname<span class="_ _47"> </span></span>alr<span class="_ _0"></span>eady <span class="_ _2"></span>exists, <span class="_ _3"></span>we <span class="_ _3"></span>need <span class="_ _2"></span>permissions <span class="_ _3"></span>as <span class="_ _3"></span>if <span class="_ _3"></span>we <span class="_ _2"></span>wer<span class="ls555">ed<span class="_ _8"></span><span class="ls0">eleting <span class="_ _3"></span>it.<span class="_ _16"> </span>Also, <span class="_ _2"></span>because</span></span></div><div class="t m0 x32 h2b y1152 ff19 fsf fc0 sc0 ls0 ws0">we’r<span class="ls556">er<span class="_ _43"></span><span class="ls0">emoving <span class="_ _9"></span>the <span class="_ _23"></span>dir<span class="_ _0"></span>ectory <span class="_ _9"></span>entry <span class="_ _9"></span>for<span class="_ _45"> </span><span class="ff1b">oldname<span class="_ _45"> </span></span>and <span class="_ _9"></span>possibly <span class="_ _9"></span>creating <span class="_ _9"></span>a <span class="_ _9"></span>directory <span class="_ _9"></span>entry</span></span></div><div class="t m0 x32 h2b y1153 ff19 fsf fc0 sc0 ls0 ws0">for<span class="_ _5a"> </span><span class="ff1b">newname</span>,<span class="_ _51"> </span>we<span class="_ _51"> </span>need <span class="_ _45"> </span>write <span class="_ _35"> </span>permission <span class="_ _45"> </span>and <span class="_ _35"> </span>execute <span class="_ _45"> </span>permission <span class="_ _35"> </span>in <span class="_ _45"> </span>the <span class="_ _35"> </span>directory</div><div class="t m0 x32 h2b y1154 ff19 fsf fc0 sc0 ls0 ws0">containing<span class="_"> </span><span class="ff1b">oldname<span class="_"> </span></span>and in the directory containing<span class="_"> </span><span class="ff1b">newname</span>.</div><div class="t m0 x3f h26 y1155 ff19 fsf fc0 sc0 ls0 ws0">The<span class="_ _35"> </span><span class="ff1a">renameat<span class="_ _35"> </span></span>function <span class="_ _42"> </span>provides <span class="_ _23"> </span>the <span class="_ _42"> </span>same <span class="_ _23"> </span>functionality <span class="_ _42"> </span>as <span class="_ _42"> </span>the<span class="_ _35"> </span><span class="ff1a">rename<span class="_ _35"> </span></span>function,</div><div class="t m0 x32 h2b y961 ff19 fsf fc0 sc0 ls0 ws0">except <span class="_ _47"> </span>when <span class="_ _45"> </span>either<span class="_ _16"> </span><span class="ff1b">oldname<span class="_ _16"> </span></span>or<span class="_ _16"> </span><span class="ff1b">newname<span class="_ _5a"> </span></span><span class="ls45">re</span>fers <span class="_ _45"> </span>to <span class="_ _47"> </span>a <span class="_ _47"> </span>relative <span class="_ _47"> </span>pathname.<span class="_ _1a3"> </span>If<span class="_ _16"> </span><span class="ff1b">oldname</span></div><div class="t m0 x32 h2b y962 ff19 fsf fc0 sc0 ls0 ws0">speciﬁes a <span class="_ _2"></span>relative pathname, it <span class="_ _2"></span>is <span class="_ _2"></span>evaluated relative to <span class="_ _2"></span>the directory referenced by<span class="_"> </span><span class="ff1b">oldfd</span>.</div><div class="t m0 x32 h2b y963 ff19 fsf fc0 sc0 ls0 ws0">Similarly<span class="_ _4"></span>,<span class="_ _47"> </span><span class="ff1b">newname<span class="_ _45"> </span></span>is <span class="_ _2"></span>evaluated <span class="_ _9"></span>relative <span class="_ _2"></span>to <span class="_ _3"></span>the <span class="_ _3"></span>directory <span class="_ _3"></span>refer<span class="_ _0"></span>enced <span class="_ _3"></span>by<span class="_ _47"> </span><span class="ff1b">newfd<span class="_ _47"> </span></span>if<span class="_ _45"> </span><span class="ff1b">newname</span></div><div class="t m0 x32 h2b y964 ff19 fsf fc0 sc0 ls0 ws0">speciﬁes a <span class="_ _2"></span>relative pathname.<span class="_ _61"> </span>Either the<span class="_ _66"> </span><span class="ff1b">oldfd<span class="_ _47"> </span></span>or<span class="_"> </span><span class="ff1b">newfd<span class="_ _66"> </span></span>arguments (or <span class="_ _2"></span>both) <span class="_ _2"></span>can be <span class="_ _2"></span>set <span class="_ _2"></span>to</div><div class="t m0 x32 h26 yebd ff1a fsf fc0 sc0 ls0 ws0">AT_FDCWD<span class="_ _80"> </span><span class="ff19">to evaluate the corresponding pathname relative to the curr<span class="_ _1"></span>ent directory<span class="_ _4"></span>.</span></div><div class="t m0 x35 h53 y1156 ff16 fs2b fc0 sc0 ls0 ws0">4.17 <span class="_ _93"> </span>Symbolic<span class="_ _54"> </span>Links</div><div class="t m0 x32 h2a y1157 ff19 fsf fc0 sc0 ls557 ws0">As<span class="_ _43"></span><span class="ls0">ymbolic <span class="_ _23"> </span>link <span class="_ _42"> </span>is <span class="_ _23"> </span>an <span class="_ _42"> </span>indirect <span class="_ _23"></span>pointer <span class="_ _23"></span>to <span class="_ _23"> </span>a <span class="_ _42"> </span>ﬁle, <span class="_ _23"> </span>unlike <span class="_ _42"> </span>the <span class="_ _23"> </span>har<span class="ls557">dl<span class="_ _43"></span><span class="ls0">inks <span class="_ _23"> </span>described <span class="_ _42"> </span>in <span class="_ _23"></span>the</span></span></span></div><div class="t m0 x32 h2a y1158 ff19 fsf fc0 sc0 ls0 ws0">previous <span class="_ _9"></span>section, <span class="_ _9"></span>which <span class="_ _23"></span>pointed <span class="_ _9"></span>directly <span class="_ _9"></span>to <span class="_ _23"> </span>the <span class="_ _23"></span>i-node <span class="_ _9"></span>of <span class="_ _23"></span>the <span class="_ _9"></span>ﬁle.<span class="_ _51"> </span>Symbolic <span class="_ _9"></span>links <span class="_ _23"></span>wer<span class="_ _0"></span>e</div><div class="t m0 x32 h2a y1159 ff19 fsf fc0 sc0 ls0 ws0">introduced to get ar<span class="_ _0"></span>ound the limitations of har<span class="_ _0"></span><span class="ls44">dl<span class="_ _d"></span><span class="ls0">inks.</span></span></div><div class="t m0 x3f h2a y115a ff19 fsf fc0 sc0 ls49 ws0">•H<span class="_ _4d"></span><span class="ls0">ar<span class="ls558">dl<span class="_ _55"></span><span class="ls0">inks <span class="_ _53"> </span>normally <span class="_ _53"> </span>requir<span class="ls558">et<span class="_ _55"></span><span class="ls0">hat <span class="_ _53"> </span>the <span class="_ _e"> </span>link <span class="_ _53"> </span>and <span class="_ _e"> </span>the <span class="_ _53"> </span>ﬁle <span class="_ _53"> </span>reside <span class="_ _53"> </span>in <span class="_ _53"> </span>the <span class="_ _e"> </span>same <span class="_ _53"> </span>ﬁle</span></span></span></span></span></div><div class="t m0 x15 h2a y115b ff19 fsf fc0 sc0 ls0 ws0">system.</div><div class="t m0 x3f h2a y115c ff19 fsf fc0 sc0 ls49 ws0">•O<span class="_ _4d"></span><span class="ls0">nly <span class="_ _2"></span>the <span class="_ _2"></span>superuser <span class="_ _2"></span>can <span class="_ _3"></span>create a <span class="_ _3"></span>har<span class="ls559">dl<span class="_ _8"></span><span class="ls0">ink <span class="_ _2"></span>to <span class="_ _3"></span>a <span class="_ _2"></span>directory <span class="_ _2"></span>(when <span class="_ _2"></span>supported <span class="_ _3"></span>by <span class="_ _2"></span>the</span></span></span></div><div class="t m0 x15 h2a y115d ff19 fsf fc0 sc0 ls0 ws0">underlying ﬁle system).</div><div class="t m0 x32 h2a y115e ff19 fsf fc0 sc0 ls0 ws0">Ther<span class="ls55a">ea<span class="_ _4f"></span><span class="ls45">re <span class="_ _3"></span>n<span class="ls55a">oﬁ<span class="_ _5"></span><span class="ls0">le system limitations on a symbolic link and what it points <span class="_ _2"></span>to, and anyone</span></span></span></span></div><div class="t m0 x32 h2a y115f ff19 fsf fc0 sc0 ls0 ws0">can <span class="_ _2"></span>create <span class="_ _2"></span>a <span class="_ _3"></span>symbolic <span class="_ _3"></span>link <span class="_ _2"></span>to <span class="_ _3"></span>a <span class="_ _3"></span>directory<span class="_ _4"></span><span class="ls55b">.S<span class="_ _1d"></span><span class="ls0">ymbolic <span class="_ _3"></span>links <span class="_ _3"></span>ar<span class="ls55c">et<span class="_ _8"></span><span class="ls0">ypically <span class="_ _2"></span>used <span class="_ _3"></span>to <span class="_ _3"></span>‘<span class="_ _0"></span>‘move’<span class="_ _1"></span><span class="ls55c">’a</span></span></span></span></span></div><div class="t m0 x32 h2a y1160 ff19 fsf fc0 sc0 ls0 ws0">ﬁle or an entir<span class="ls44">ed<span class="_ _4f"></span><span class="ls0">irectory hierarchy to another location on a system.</span></span></div><div class="t m0 x3f h2a y1161 ff19 fsf fc0 sc0 ls0 ws0">When using <span class="_ _2"></span>functions that <span class="_ _2"></span>refer to <span class="_ _2"></span>a ﬁle <span class="_ _2"></span>by name, <span class="_ _2"></span>we <span class="_ _2"></span>always need <span class="_ _2"></span>to know <span class="_ _2"></span>whether</div><div class="t m0 x32 h2a yc23 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _45"> </span>function <span class="_ _35"> </span>follows <span class="_ _45"> </span>a <span class="_ _35"> </span>symbolic <span class="_ _45"> </span>link.<span class="_ _98"> </span>If <span class="_ _45"> </span>the <span class="_ _35"> </span>function <span class="_ _45"> </span>follows <span class="_ _35"> </span>a <span class="_ _45"> </span>symbolic <span class="_ _35"> </span>link, <span class="_ _45"> </span>a</div><div class="t m0 x32 h2a y1162 ff19 fsf fc0 sc0 ls0 ws0">pathname <span class="_ _23"> </span>argument <span class="_ _23"> </span>to <span class="_ _42"> </span>the <span class="_ _23"> </span>function <span class="_ _23"> </span>refers <span class="_ _23"> </span>to <span class="_ _42"> </span>the <span class="_ _23"> </span>ﬁle <span class="_ _42"> </span>pointed <span class="_ _23"> </span>to <span class="_ _42"> </span>by <span class="_ _23"> </span>the <span class="_ _42"> </span>symbolic <span class="_ _23"> </span>link.</div><div class="t m0 x32 h2a y1163 ff19 fsf fc0 sc0 ls0 ws0">Otherwise, <span class="_ _9"></span>a <span class="_ _9"></span>pathname <span class="_ _9"></span>argument <span class="_ _3"></span>refers <span class="_ _9"></span>to <span class="_ _9"></span>the <span class="_ _9"></span>link <span class="_ _9"></span>itself, <span class="_ _9"></span>not <span class="_ _9"></span>the <span class="_ _9"></span>ﬁle <span class="_ _9"></span>pointed <span class="_ _9"></span>to <span class="_ _9"></span>by <span class="_ _9"></span>the</div><div class="t m0 x32 h2a y1164 ff19 fsf fc0 sc0 ls0 ws0">link. <span class="_ _45"> </span>Figur<span class="ls55d">e4<span class="_ _b"></span><span class="ls0">.17 <span class="_ _3"></span>summarizes <span class="_ _23"></span>whether <span class="_ _9"></span>the <span class="_ _9"></span>functions <span class="_ _23"></span>described <span class="_ _9"></span>in <span class="_ _9"></span>this <span class="_ _23"></span>chapter <span class="_ _9"></span>follow <span class="_ _9"></span>a</span></span></div><div class="t m0 x32 h26 y1165 ff19 fsf fc0 sc0 ls0 ws0">symbolic <span class="_ _2"></span>link.<span class="_ _61"> </span>The <span class="_ _3"></span>functions<span class="_ _47"> </span><span class="ff1a">mkdir</span>,<span class="_ _66"> </span><span class="ff1a">mkfifo</span>,<span class="_ _47"> </span><span class="ff1a">mknod</span><span class="ls55e">,a<span class="_ _4f"></span><span class="ls0">nd<span class="_ _47"> </span><span class="ff1a">rmdir<span class="_ _66"> </span></span>do <span class="_ _3"></span>not <span class="_ _2"></span>appear <span class="_ _3"></span>in <span class="_ _2"></span>this</span></span></div><div class="t m0 x32 h2a y1166 ff19 fsf fc0 sc0 ls0 ws0">ﬁgure, <span class="_ _66"> </span>as <span class="_ _45"> </span>they <span class="_ _47"> </span>return <span class="_ _47"> </span>an <span class="_ _47"> </span>error <span class="_ _47"> </span>when <span class="_ _47"> </span>the <span class="_ _47"> </span>pathname <span class="_ _47"> </span>is <span class="_ _45"> </span>a <span class="_ _47"> </span>symbolic <span class="_ _47"> </span>link.<span class="_ _5f"> </span>Also, <span class="_ _47"> </span>the</div><div class="t m0 x32 h26 y1167 ff19 fsf fc0 sc0 ls0 ws0">functions <span class="_ _e"> </span>that <span class="_ _e"> </span>take <span class="_ _e"> </span>a <span class="_"> </span>ﬁle <span class="_ _53"> </span>descriptor <span class="_ _e"> </span>argument, <span class="_ _e"> </span>such <span class="_ _e"> </span>as<span class="_ _59"> </span><span class="ff1a">fstat<span class="_ _4b"> </span></span>and<span class="_ _59"> </span><span class="ff1a">fchmod</span><span class="ls55f">,a<span class="_ _55"></span><span class="ls45">re <span class="_"> </span>n<span class="_ _2"></span><span class="ls0">ot</span></span></span></div><div class="t m0 x32 h26 y1168 ff19 fsf fc0 sc0 ls0 ws0">listed, <span class="_ _45"> </span>as <span class="_ _47"> </span>the <span class="_ _45"> </span>function <span class="_ _45"> </span>that <span class="_ _47"> </span>returns <span class="_ _45"> </span>the <span class="_ _47"> </span>ﬁle <span class="_ _45"> </span>descriptor <span class="_ _45"> </span>(usually<span class="_ _16"> </span><span class="ff1a">open</span><span class="ls560">)h<span class="_ _62"></span><span class="ls0">andles <span class="_ _45"> </span>the</span></span></div><div class="t m0 x32 h26 y1169 ff19 fsf fc0 sc0 ls0 ws0">symbolic <span class="_ _23"> </span>link.<span class="_ _54"> </span>Historically<span class="_ _4"></span><span class="ls561">,i<span class="_ _43"></span><span class="ls0">mplementations <span class="_ _42"> </span>have <span class="_ _42"> </span>differ<span class="_ _0"></span>ed <span class="_ _23"> </span>in <span class="_ _42"> </span>whether<span class="_ _35"> </span><span class="ff1a">chown<span class="_ _44"> </span></span>follows</span></span></div><div class="t m0 x32 h26 y116a ff19 fsf fc0 sc0 ls0 ws0">symbolic links.<span class="_ _59"> </span>In all modern systems, however<span class="_ _1"></span>,<span class="_"> </span><span class="ff1a">chown<span class="_ _66"> </span></span>does follow symbolic links.</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.890519px;bottom:730.608878px;width:127.367698px;height:19.680023px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
