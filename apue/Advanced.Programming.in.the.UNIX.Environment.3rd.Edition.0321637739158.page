<div id="pf9e" class="pf w4 h1f" data-page-no="9e"><div class="pc pc9e w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg9e.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">124<span class="_ _1b"> </span><span class="ff19">Files <span class="_"> </span>and <span class="_"> </span>Directories <span class="_ _18d"> </span>Chapter<span class="_ _4b"> </span>4</span></div><div class="t m0 x32 h26 y12f ff19 fsf fc0 sc0 ls0 ws0">These <span class="_ _53"> </span>functions <span class="_ _53"> </span>combine <span class="_ _e"> </span>the <span class="_ _53"> </span>actions <span class="_ _e"> </span>of<span class="_ _4b"> </span><span class="ff1a">open</span>,<span class="_ _4b"> </span><span class="ff1a">read</span><span class="ls4b5">,a<span class="_ _55"></span><span class="ls0">nd<span class="_ _4b"> </span><span class="ff1a">close</span><span class="ls578">.I<span class="_ _52"></span><span class="ls4b5">fs<span class="_ _55"></span><span class="ls0">uccessful, <span class="_ _e"> </span>they</span></span></span></span></span></div><div class="t m0 x32 h2b y130 ff19 fsf fc0 sc0 ls45 ws0">re<span class="ls0">turn <span class="_ _23"></span>the <span class="_ _9"></span>number <span class="_ _9"></span>of <span class="_ _23"></span>bytes <span class="_ _9"></span>placed <span class="_ _23"></span>into<span class="_ _45"> </span><span class="ff1b">buf</span><span class="ls579">.T<span class="_ _26"></span><span class="ls0">he <span class="_ _23"></span>contents <span class="_ _9"></span>of <span class="_ _23"></span>the <span class="_ _9"></span>symbolic <span class="_ _9"></span>link <span class="_ _23"></span>that <span class="_ _9"></span>are</span></span></span></div><div class="t m0 x32 h2b y131 ff19 fsf fc0 sc0 ls45 ws0">re<span class="ls0">turned in<span class="_"> </span><span class="ff1b">buf<span class="_"> </span></span>ar<span class="ls44">en<span class="_ _d"></span><span class="ls0">ot null terminated.</span></span></span></div><div class="t m0 x3f h26 y132 ff19 fsf fc0 sc0 ls0 ws0">The<span class="_ _47"> </span><span class="ff1a">readlinkat<span class="_ _47"> </span></span>function <span class="_ _3"></span>behaves <span class="_ _3"></span>the <span class="_ _9"></span>same <span class="_ _3"></span>way <span class="_ _3"></span>as <span class="_ _3"></span>the<span class="_ _47"> </span><span class="ff1a">readlink<span class="_ _45"> </span></span>function <span class="_ _2"></span>when</div><div class="t m0 x32 h2b y133 ff19 fsf fc0 sc0 ls0 ws0">the<span class="_"> </span><span class="ff1b">pathname<span class="_ _47"> </span></span>argument speciﬁes <span class="_ _2"></span>an <span class="_ _2"></span>absolute <span class="_ _2"></span>pathname <span class="_ _2"></span>or <span class="_ _2"></span>when <span class="_ _2"></span>the<span class="_ _66"> </span><span class="ff1b">fd<span class="_ _66"> </span></span>argument <span class="_ _2"></span>has <span class="_ _2"></span>the</div><div class="t m0 x32 h26 y134 ff19 fsf fc0 sc0 ls0 ws0">special value<span class="_"> </span><span class="ff1a">AT_FDCWD</span><span class="ls57a">.H<span class="_ _4a"></span><span class="ls0">owever<span class="_ _6"></span><span class="ls57b">,w<span class="_ _d"></span><span class="ls0">hen <span class="_ _2"></span>the<span class="_"> </span><span class="ff1b">fd<span class="_ _66"> </span></span>argument is a <span class="_ _2"></span>valid ﬁle <span class="_ _2"></span>descriptor of an</span></span></span></span></div><div class="t m0 x32 h26 y135 ff19 fsf fc0 sc0 ls0 ws0">open <span class="_ _23"> </span>directory <span class="_ _23"> </span>and <span class="_ _42"> </span>the<span class="_ _35"> </span><span class="ff1b">pathname<span class="_ _35"> </span></span>argument <span class="_ _23"></span>is <span class="_ _23"> </span>a <span class="_ _42"> </span>relative <span class="_ _23"></span>pathname, <span class="_ _23"> </span>then<span class="_ _35"> </span><span class="ff1a">readlinkat</span></div><div class="t m0 x32 h2b y136 ff19 fsf fc0 sc0 ls0 ws0">evaluates the pathname relative to the open dir<span class="_ _0"></span>ectory r<span class="_ _0"></span>epresented by<span class="_"> </span><span class="ff1b">fd</span>.</div><div class="t m0 x35 h53 y11d1 ff16 fs2b fc0 sc0 ls0 ws0">4.19 <span class="_ _93"> </span>File<span class="_ _54"> </span>Times</div><div class="t m0 x32 h2a y11d2 ff19 fsf fc0 sc0 ls0 ws0">In <span class="_ _53"> </span>Section <span class="_"> </span>4.2, <span class="_ _42"> </span>we <span class="_"> </span>discussed <span class="_ _53"> </span>how <span class="_ _53"> </span>the <span class="_"> </span>2008 <span class="_ _42"> </span>version <span class="_"> </span>of <span class="_ _53"> </span>the <span class="_ _53"> </span>Single <span class="_"> </span>UNIX <span class="_ _53"> </span>Speciﬁcation</div><div class="t m0 x32 h26 y11d3 ff19 fsf fc0 sc0 ls0 ws0">increased the resolution of the time ﬁelds <span class="_ _2"></span>in the<span class="_ _66"> </span><span class="ff1a">stat<span class="_ _66"> </span></span>structur<span class="ls57c">ef<span class="_ _4f"></span><span class="ls45">ro<span class="_ _2"></span><span class="ls57c">ms<span class="_ _d"></span><span class="ls0">econds to seconds</span></span></span></span></div><div class="t m0 x32 h2a y11d4 ff19 fsf fc0 sc0 ls0 ws0">plus <span class="_ _23"></span>nanoseconds.<span class="_ _51"> </span>The <span class="_ _9"></span>actual <span class="_ _23"> </span>resolution <span class="_ _23"></span>stored <span class="_ _9"></span>with <span class="_ _23"> </span>each <span class="_ _23"> </span>ﬁle’s <span class="_ _23"> </span>attributes <span class="_ _23"></span>depends <span class="_ _23"></span>on</div><div class="t m0 x32 h2a y11d5 ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _47"> </span>ﬁle <span class="_ _45"> </span>system <span class="_ _47"> </span>implementation.<span class="_ _5f"> </span>For <span class="_ _45"> </span>ﬁle <span class="_ _47"> </span>systems <span class="_ _47"> </span>that <span class="_ _45"> </span>stor<span class="ls57d">et<span class="_ _26"></span><span class="ls0">imestamps <span class="_ _45"> </span>in <span class="_ _47"> </span>second</span></span></div><div class="t m0 x32 h2a y11d6 ff19 fsf fc0 sc0 ls0 ws0">granularity<span class="_ _4"></span><span class="ls57e">,t<span class="_ _8"></span><span class="ls0">he <span class="_ _9"></span>nanoseconds <span class="_ _3"></span>ﬁelds <span class="_ _9"></span>will <span class="_ _9"></span>be <span class="_ _3"></span>ﬁlled <span class="_ _9"></span>with <span class="_ _3"></span>zeros. <span class="_ _45"> </span>For<span class="_ _47"> </span>ﬁle <span class="_ _9"></span>systems <span class="_ _3"></span>that <span class="_ _9"></span>store</span></span></div><div class="t m0 x32 h2a y11d7 ff19 fsf fc0 sc0 ls0 ws0">timestamps <span class="_ _66"> </span>in <span class="_ _47"> </span>a <span class="_ _66"> </span>resolution <span class="_ _66"> </span>higher <span class="_ _47"> </span>than <span class="_ _47"> </span>seconds, <span class="_ _66"> </span>the <span class="_ _47"> </span>partial <span class="_ _66"> </span>seconds <span class="_ _47"> </span>value <span class="_ _66"> </span>will <span class="_ _47"> </span>be</div><div class="t m0 x32 h2a y11d8 ff19 fsf fc0 sc0 ls0 ws0">converted into nanoseconds and returned in the nanoseconds ﬁelds.</div><div class="t m0 x3f h2a y11d9 ff19 fsf fc0 sc0 ls0 ws0">Three <span class="_ _53"> </span>time <span class="_"> </span>ﬁelds <span class="_ _53"> </span>ar<span class="ls57f">em<span class="_ _4a"></span><span class="ls0">aintained <span class="_"> </span>for <span class="_ _53"> </span>each <span class="_"> </span>ﬁle.<span class="_ _65"> </span>Their <span class="_ _e"> </span>purpose <span class="_"> </span>is <span class="_ _53"> </span>summarized <span class="_"> </span>in</span></span></div><div class="t m0 x32 h2a y11da ff19 fsf fc0 sc0 ls0 ws0">Figur<span class="ls44">e4<span class="_ _4f"></span><span class="ls0">.19.</span></span></div><div class="t m0 x1b0 h5e y11db ff19 fs10 fc0 sc0 ls0 ws0">Field <span class="_ _131"> </span>Description<span class="_ _1ac"> </span>Example<span class="_ _1a8"> </span><span class="ff1a">ls</span></div><div class="t m0 x1b1 h2d y11dc ff19 fs10 fc0 sc0 ls0 ws0">(</div><div class="t m0 x160 h2d y11db ff19 fs10 fc0 sc0 ls0 ws0">1</div><div class="t m0 x152 h2d y11dc ff19 fs10 fc0 sc0 ls0 ws0">)</div><div class="t m0 x11f h2d y11db ff19 fs10 fc0 sc0 ls0 ws0">option</div><div class="t m0 x122 h4f y11dd ff1a fs11 fc0 sc0 ls0 ws0">st_atim<span class="_ _6e"> </span><span class="ff19">last-access time of ﬁle data<span class="_ _16d"> </span></span>read <span class="_ _d6"> </span>-u</div><div class="t m0 x122 h4f y11de ff1a fs11 fc0 sc0 ls0 ws0">st_mtim<span class="_ _6e"> </span><span class="ff19">last-modiﬁcation time of ﬁle data<span class="_ _6e"> </span></span>write<span class="_ _73"> </span><span class="ff19">default</span></div><div class="t m0 x122 h4f y11df ff1a fs11 fc0 sc0 ls0 ws0">st_ctim<span class="_ _6e"> </span><span class="ff19">last-change time of i-node status<span class="_ _2b"> </span></span>chmod, chown<span class="_ _1ad"> </span>-c</div><div class="t m0 x38 h2f y11e0 ff18 fs12 fc0 sc0 ls0 ws0">Figure 4.19<span class="_ _5a"> </span><span class="ff19">The three time values associated with each ﬁle</span></div><div class="t m0 x32 h5c y11e1 ff19 fs29 fc0 sc0 ls0 ws0">Note <span class="_ _23"></span>the <span class="_ _23"></span>differ<span class="_ _1"></span>ence <span class="_ _23"> </span>between <span class="_ _23"> </span>the <span class="_ _23"> </span>modiﬁcation <span class="_ _23"> </span>time <span class="_ _23"> </span>(<span class="ff1a">st_mtim</span><span class="ls580">)a<span class="_ _b"></span><span class="ls0">nd <span class="_ _9"></span>the <span class="_ _23"> </span>changed-status</span></span></div><div class="t m0 x32 h5c y11e2 ff19 fs29 fc0 sc0 ls0 ws0">time (<span class="ff1a">st_ctim</span>). <span class="_ _66"> </span>The<span class="_ _47"> </span>modiﬁcation time <span class="_ _2"></span>indicates <span class="_ _2"></span>when the <span class="_ _2"></span>contents <span class="_ _2"></span>of <span class="_ _2"></span>the ﬁle <span class="_ _2"></span>wer<span class="ls581">el<span class="_ _4f"></span><span class="ls0">ast</span></span></div><div class="t m0 x32 h50 y11e3 ff19 fs29 fc0 sc0 ls0 ws0">modiﬁed. <span class="_ _61"> </span>The<span class="_ _16"> </span>changed-status <span class="_ _47"> </span>time <span class="_ _47"> </span>indicates <span class="_ _66"> </span>when <span class="_ _47"> </span>the <span class="_ _47"> </span>i-node <span class="_ _47"> </span>of <span class="_ _47"> </span>the <span class="_ _47"> </span>ﬁle <span class="_ _47"> </span>was <span class="_ _47"> </span>last</div><div class="t m0 x32 h50 y11e4 ff19 fs29 fc0 sc0 ls0 ws0">modiﬁed. <span class="_ _61"> </span>In<span class="_ _61"> </span>this <span class="_ _47"> </span>chapter<span class="_ _1"></span><span class="ls582">,w<span class="_ _1d"></span><span class="ls0">e’ve <span class="_ _47"> </span>described <span class="_ _47"> </span>many <span class="_ _66"> </span>operations <span class="_ _47"> </span>that <span class="_ _47"> </span>affect <span class="_"> </span>the <span class="_ _47"> </span>i-node</span></span></div><div class="t m0 x32 h50 y11e5 ff19 fs29 fc0 sc0 ls0 ws0">without <span class="_ _23"> </span>changing <span class="_ _23"> </span>the <span class="_ _42"> </span>actual <span class="_ _23"> </span>contents <span class="_ _42"> </span>of <span class="_ _23"></span>the <span class="_ _23"> </span>ﬁle: <span class="_ _42"> </span>changing <span class="_ _23"> </span>the <span class="_ _23"> </span>ﬁle <span class="_ _42"> </span>access <span class="_ _23"> </span>permissions,</div><div class="t m0 x32 h50 y11e6 ff19 fs29 fc0 sc0 ls0 ws0">changing <span class="_ _47"> </span>the <span class="_ _47"> </span>user <span class="_ _47"> </span>ID, <span class="_ _47"> </span>changing <span class="_ _47"> </span>the <span class="_ _47"> </span>number <span class="_ _47"> </span>of <span class="_ _47"> </span>links, <span class="_ _47"> </span>and <span class="_ _47"> </span>so <span class="_ _47"> </span>on.<span class="_ _5f"> </span>Because <span class="_ _47"> </span>all <span class="_ _47"> </span>the</div><div class="t m0 x32 h50 y11e7 ff19 fs29 fc0 sc0 ls0 ws0">information <span class="_ _23"> </span>in <span class="_ _42"> </span>the <span class="_ _42"> </span>i-node <span class="_ _23"> </span>is <span class="_ _42"> </span>stored <span class="_ _23"> </span>separately <span class="_ _42"> </span>from <span class="_ _23"></span>the <span class="_ _42"> </span>actual <span class="_ _23"> </span>contents <span class="_ _42"> </span>of <span class="_ _42"> </span>the <span class="_ _23"> </span>ﬁle, <span class="_ _42"> </span>we</div><div class="t m0 x32 h50 y11e8 ff19 fs29 fc0 sc0 ls0 ws0">need the changed-status time, in addition to the modiﬁcation time.</div><div class="t m0 x3f h50 y11e9 ff19 fs29 fc0 sc0 ls0 ws0">Note <span class="_ _23"></span>that <span class="_ _9"></span>the <span class="_ _23"> </span>system <span class="_ _23"></span>does <span class="_ _23"></span>not <span class="_ _9"></span>maintain <span class="_ _23"> </span>the <span class="_ _23"></span>last-access <span class="_ _23"></span>time <span class="_ _9"></span>for <span class="_ _23"> </span>an <span class="_ _23"></span>i-node.<span class="_ _51"> </span>This <span class="_ _9"></span>is</div><div class="t m0 x32 h5c y11ea ff19 fs29 fc0 sc0 ls0 ws0">why the functions<span class="_"> </span><span class="ff1a">access<span class="_ _80"> </span></span>and<span class="_"> </span><span class="ff1a">stat</span><span class="lsdd">,f<span class="_ _5"></span><span class="ls0">or example, don’t change any of the thr<span class="_ _0"></span>ee times.</span></span></div><div class="t m0 x3f h50 y11eb ff19 fs29 fc0 sc0 ls0 ws0">The <span class="_ _3"></span>access <span class="_ _3"></span>time <span class="_ _9"></span>is <span class="_ _3"></span>often <span class="_ _3"></span>used <span class="_ _9"></span>by <span class="_ _3"></span>system <span class="_ _3"></span>administrators <span class="_ _9"></span>to <span class="_ _3"></span>delete <span class="_ _3"></span>ﬁles <span class="_ _9"></span>that <span class="_ _3"></span>have <span class="_ _3"></span>not</div><div class="t m0 x32 h50 y11ec ff19 fs29 fc0 sc0 ls0 ws0">been <span class="_ _3"></span>accessed <span class="_ _9"></span>for <span class="_ _9"></span>a <span class="_ _3"></span>certain <span class="_ _9"></span>amount <span class="_ _9"></span>of <span class="_ _3"></span>time.<span class="_ _5a"> </span>The <span class="_ _3"></span>classic <span class="_ _9"></span>example <span class="_ _9"></span>is <span class="_ _3"></span>the <span class="_ _9"></span>removal <span class="_ _3"></span>of <span class="_ _9"></span>ﬁles</div><div class="t m0 x32 h5c y11ed ff19 fs29 fc0 sc0 ls0 ws0">named<span class="_ _59"> </span><span class="ff1a">a.out<span class="_ _46"> </span></span>or<span class="_ _46"> </span><span class="ff1a">core<span class="_ _59"> </span></span>that <span class="_"> </span>haven’t <span class="_"> </span>been <span class="_"> </span>accessed <span class="_"> </span>in <span class="_"> </span>the <span class="_"> </span>past <span class="_"> </span>week.<span class="_ _60"> </span>The<span class="_ _59"> </span><span class="ff1a">find</span></div><div class="t m0 x40 h50 y11ee ff19 fs29 fc0 sc0 ls0 ws0">(</div><div class="t m0 x1b2 h50 y11ed ff19 fs29 fc0 sc0 ls0 ws0">1</div><div class="t m0 x17e h50 y11ee ff19 fs29 fc0 sc0 ls0 ws0">)</div><div class="t m0 x32 h50 y11ef ff19 fs29 fc0 sc0 ls0 ws0">command is often used for this type of operation.</div><div class="t m0 x3f h50 y11f0 ff19 fs29 fc0 sc0 ls0 ws0">The <span class="_ _53"> </span>modiﬁcation <span class="_ _e"> </span>time <span class="_ _e"> </span>and <span class="_ _e"> </span>the <span class="_ _e"> </span>changed-status <span class="_ _53"> </span>time <span class="_ _e"> </span>can <span class="_ _e"> </span>be <span class="_ _e"> </span>used <span class="_ _e"> </span>to <span class="_ _e"> </span>archive <span class="_ _53"> </span>only</div><div class="t m0 x32 h50 y11f1 ff19 fs29 fc0 sc0 ls0 ws0">those ﬁles that have had their contents modiﬁed or their i-node modiﬁed.</div><a class="l" href="#pfd" data-dest-detail='[13,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.890952px;bottom:974.208941px;width:98.027496px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
