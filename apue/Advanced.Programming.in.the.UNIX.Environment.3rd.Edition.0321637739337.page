<div id="pf151" class="pf w4 h1f" data-page-no="151"><div class="pc pc151 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg151.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>9.9<span class="_ _2c"> </span>Shell <span class="_"> </span>Execution <span class="_"> </span>of <span class="_"> </span>Programs<span class="_ _1b"> </span><span class="ff18">303</span></div><div class="t m0 x32 h2a y12f ff19 fsf fc0 sc0 ls0 ws0">driver<span class="_ _6"></span><span class="ls524">,t<span class="_ _5b"></span><span class="ls0">he <span class="_ _47"> </span>shell, <span class="_ _47"> </span>and <span class="_ _47"> </span>some <span class="_ _66"> </span>applications<span class="_ _9"></span><span class="ls9d">—i<span class="_ _1"></span><span class="ls524">sah<span class="_ _1d"></span><span class="ls0">ack. <span class="_ _61"> </span>Some<span class="_ _16"> </span>use <span class="_ _47"> </span>job <span class="_ _47"> </span>control <span class="_ _66"> </span>with <span class="_ _47"> </span>a</span></span></span></span></span></div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">windowing <span class="_ _2"></span>system, <span class="_ _2"></span>claiming <span class="_ _2"></span>a <span class="_ _2"></span>need <span class="_ _2"></span>for <span class="_ _2"></span>both.<span class="_ _61"> </span>Regardless of <span class="_ _3"></span>your <span class="_ _2"></span>opinion, <span class="_ _2"></span>job <span class="_ _2"></span>control is</div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls44 ws0">ar<span class="_ _4f"></span><span class="ls0">equired feature<span class="_"> </span>of<span class="_"> </span>POSIX.1.</span></div><div class="t m0 x35 h53 y134 ff16 fs2b fc0 sc0 ls0 ws0">9.9 <span class="_ _68"> </span>Shell<span class="_ _54"> </span>Execution <span class="_"> </span>of <span class="_"> </span>Pr<span class="_ _0"></span>ograms</div><div class="t m0 x32 h2a y6d4 ff19 fsf fc0 sc0 ls0 ws0">Let’s <span class="_ _3"></span>examine <span class="_ _9"></span>how <span class="_ _9"></span>the <span class="_ _9"></span>shells <span class="_ _3"></span>execute <span class="_ _9"></span>programs <span class="_ _3"></span>and <span class="_ _9"></span>how <span class="_ _9"></span>this <span class="_ _9"></span>relates <span class="_ _3"></span>to <span class="_ _9"></span>the <span class="_ _3"></span>concepts <span class="_ _9"></span>of</div><div class="t m0 x32 h26 y6d5 ff19 fsf fc0 sc0 ls0 ws0">process <span class="_ _47"> </span>groups, <span class="_ _47"> </span>controlling <span class="_ _45"> </span>terminals, <span class="_ _47"> </span>and <span class="_ _45"> </span>sessions.<span class="_ _1a3"> </span><span class="ls5f">To <span class="_ _46"> </span>d<span class="_ _9"></span><span class="lsb44">ot<span class="_ _1d"></span><span class="ls0">his, <span class="_ _45"> </span>we’ll <span class="_ _47"> </span>use <span class="_ _45"> </span>the<span class="_ _5a"> </span><span class="ff1a">ps</span></span></span></span></div><div class="t m0 x32 h2a y6d6 ff19 fsf fc0 sc0 ls0 ws0">command again.</div><div class="t m0 x3f h2a y6d7 ff19 fsf fc0 sc0 ls0 ws0">First, <span class="_ _42"> </span>we’ll <span class="_ _53"> </span>use <span class="_ _53"> </span>a <span class="_ _53"> </span>shell <span class="_ _53"> </span>that <span class="_ _53"> </span>doesn’t <span class="_ _53"> </span>support <span class="_ _53"> </span>job <span class="_ _53"> </span>control <span class="_ _84"></span>— <span class="_ _4"></span>the<span class="_ _44"> </span>classic <span class="_ _42"> </span>Bourne <span class="_ _53"> </span>shell</div><div class="t m0 x32 h2a y6d8 ff19 fsf fc0 sc0 ls4e ws0">ru<span class="ls0">nning on Solaris.<span class="_ _46"> </span>If we execute</span></div><div class="t m0 x3f h57 y271e ff1a fs2d fc0 sc0 ls0 ws0">ps -o pid,ppid,pgid,sid,comm</div><div class="t m0 x32 h2a y271f ff19 fsf fc0 sc0 ls0 ws0">the output is</div><div class="t m0 xf4 h57 y2720 ff1a fs2d fc0 sc0 ls0 ws0">PID <span class="_"> </span>PPID <span class="_"> </span>PGID<span class="_ _68"> </span>SID COMMAND</div><div class="t m0 xf4 h57 y2721 ff1a fs2d fc0 sc0 ls0 ws0">949 <span class="_ _d9"> </span>947 <span class="_ _3a"> </span>949 <span class="_ _3a"> </span>949<span class="_"> </span>sh</div><div class="t m0 x90 h57 y2722 ff1a fs2d fc0 sc0 ls0 ws0">1774 <span class="_ _d9"> </span>949 <span class="_ _3a"> </span>949 <span class="_ _3a"> </span>949<span class="_"> </span>ps</div><div class="t m0 x32 h26 y2723 ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _2"></span>parent <span class="_ _2"></span>of <span class="_ _2"></span>the<span class="_ _47"> </span><span class="ff1a">ps<span class="_ _47"> </span></span>command <span class="_ _2"></span>is <span class="_ _3"></span>the <span class="_ _2"></span>shell, <span class="_ _3"></span>which <span class="_ _2"></span>we <span class="_ _3"></span>would <span class="_ _2"></span>expect.<span class="_ _16"> </span>Both <span class="_ _2"></span>the <span class="_ _3"></span>shell <span class="_ _2"></span>and</div><div class="t m0 x32 h26 y2724 ff19 fsf fc0 sc0 ls0 ws0">the<span class="_ _45"> </span><span class="ff1a">ps<span class="_ _45"> </span></span>command <span class="_ _3"></span>are<span class="_ _45"> </span>in<span class="_ _45"> </span>the <span class="_ _3"></span>same <span class="_ _9"></span>session <span class="_ _9"></span>and <span class="_ _9"></span>foreground <span class="_ _3"></span>process <span class="_ _9"></span>group</div><div class="t m0 xb2 h2a y2725 ff19 fsf fc0 sc0 ls0 ws0">(</div><div class="t m0 x1ae h2a y2724 ff19 fsf fc0 sc0 ls0 ws0">949</div><div class="t m0 x1c8 h2a y2725 ff19 fsf fc0 sc0 ls0 ws0">)</div><div class="t m0 x20d h2a y2724 ff19 fsf fc0 sc0 lsb45 ws0">.W<span class="_ _52"></span><span class="lsb46">es<span class="_ _b"></span><span class="ls0">ay</span></span></div><div class="t m0 x32 h2a y2726 ff19 fsf fc0 sc0 ls0 ws0">that 949 is <span class="_ _2"></span>the foreground process gr<span class="_ _0"></span>oup because <span class="_ _2"></span>that is what <span class="_ _2"></span>you get <span class="_ _2"></span>when you <span class="_ _2"></span>execute</div><div class="t m0 x32 h2a y2727 ff19 fsf fc0 sc0 ls44 ws0">ac<span class="_ _d"></span><span class="ls0">ommand with a shell that doesn’t support job control.</span></div><div class="t m0 x76 h52 y2728 ff19 fs2a fc0 sc0 ls0 ws0">Some <span class="_ _23"> </span>platforms <span class="_ _42"> </span>support <span class="_ _23"> </span>an <span class="_ _42"> </span>option <span class="_ _23"> </span>to <span class="_ _42"> </span>have <span class="_ _42"> </span>the<span class="_ _45"> </span><span class="ff1a">ps</span></div><div class="t m0 x73 h51 y2729 ff19 fs2a fc0 sc0 ls0 ws0">(</div><div class="t m0 x1a8 h51 y2728 ff19 fs2a fc0 sc0 ls0 ws0">1</div><div class="t m0 x1cb h51 y2729 ff19 fs2a fc0 sc0 ls0 ws0">)</div><div class="t m0 x181 h51 y2728 ff19 fs2a fc0 sc0 ls0 ws0">command <span class="_ _23"> </span>print <span class="_ _42"> </span>the <span class="_ _23"> </span>process <span class="_ _42"> </span>group <span class="_ _23"> </span>ID</div><div class="t m0 x76 h51 y272a ff19 fs2a fc0 sc0 ls0 ws0">associated <span class="_"> </span>with <span class="_"> </span>the <span class="_"> </span>session’s <span class="_"> </span>controlling <span class="_"> </span>terminal. <span class="_"> </span>This <span class="_"> </span>value <span class="_"> </span>would <span class="_"> </span>be <span class="_"> </span>shown <span class="_"> </span>under <span class="_"> </span>the</div><div class="t m0 x76 h52 y272b ff19 fs2a fc0 sc0 ls0 ws0">TPGID column.<span class="_ _44"> </span>Unfortunately<span class="_ _6"></span><span class="lsb47">,t<span class="_ _84"></span><span class="ls0">he <span class="_ _2"></span>output of <span class="_ _2"></span>the<span class="_ _e"> </span><span class="ff1a">ps<span class="_ _80"> </span></span>command <span class="_ _2"></span>often differs among <span class="_ _2"></span>versions <span class="_ _2"></span>of</span></span></div><div class="t m0 x76 h51 y272c ff19 fs2a fc0 sc0 ls0 ws0">the <span class="_ _9"> </span>UNIX <span class="_ _23"> </span>System.<span class="_ _46"> </span>For <span class="_ _9"> </span>example, <span class="_ _23"> </span>Solaris <span class="_ _23"> </span>10 <span class="_ _9"></span>doesn’t <span class="_ _23"> </span>support <span class="_ _9"></span>this <span class="_ _23"> </span>option.<span class="_ _59"> </span>Under <span class="_ _23"> </span>FreeBSD <span class="_ _9"></span>8.0,</div><div class="t m0 x76 h51 y272d ff19 fs2a fc0 sc0 ls0 ws0">Linux 3.2.0, and Mac OS X 10.6.8, the command</div><div class="t m0 x50 h52 y272e ff1a fs2a fc0 sc0 ls0 ws0">ps -o pid,ppid,pgid,sid,tpgid,comm</div><div class="t m0 x76 h51 y272f ff19 fs2a fc0 sc0 ls0 ws0">prints exactly the information we want.</div><div class="t m0 x76 h51 y2730 ff19 fs2a fc0 sc0 ls0 ws0">Note <span class="_ _3"></span>that <span class="_ _3"></span>it <span class="_ _3"></span>is <span class="_ _3"></span>misleading <span class="_ _3"></span>to <span class="_ _3"></span>associate <span class="_ _3"></span>a <span class="_ _3"></span>process <span class="_ _2"></span>with <span class="_ _3"></span>a <span class="_ _3"></span>terminal <span class="_ _3"></span>process <span class="_ _3"></span>group <span class="_ _2"></span>ID <span class="_ _3"></span>(the <span class="_ _3"></span>TPGID</div><div class="t m0 x76 h51 y2731 ff19 fs2a fc0 sc0 ls0 ws0">column). <span class="_ _66"> </span>A<span class="_ _47"> </span>process <span class="_ _9"></span>does <span class="_ _9"></span>not <span class="_ _9"></span>have <span class="_ _9"></span>a <span class="_ _9"></span>terminal <span class="_ _9"> </span>process <span class="_ _9"></span>control <span class="_ _9"></span>group. <span class="_ _66"> </span>A<span class="_ _47"> </span>process <span class="_ _3"></span>belongs <span class="_ _9"> </span>to <span class="_ _9"> </span>a</div><div class="t m0 x76 h51 y2732 ff19 fs2a fc0 sc0 ls0 ws0">process group, and the process group belongs to <span class="_ _2"></span>a session.<span class="_ _44"> </span>The <span class="_ _2"></span>session may <span class="_ _2"></span>or may not <span class="_ _2"></span>have a</div><div class="t m0 x76 h51 y2733 ff19 fs2a fc0 sc0 ls0 ws0">controlling <span class="_ _2"></span>terminal.<span class="_ _59"> </span>If <span class="_ _3"></span>the <span class="_ _3"></span>session <span class="_ _3"></span>does <span class="_ _9"></span>have <span class="_ _3"></span>a <span class="_ _3"></span>controlling <span class="_ _3"></span>terminal, <span class="_ _3"></span>then <span class="_ _3"></span>the <span class="_ _3"></span>terminal <span class="_ _3"></span>device</div><div class="t m0 x76 h51 y2734 ff19 fs2a fc0 sc0 ls0 ws0">knows <span class="_ _3"></span>the <span class="_ _9"></span>process <span class="_ _3"></span>group <span class="_ _3"></span>ID <span class="_ _3"></span>of <span class="_ _9"></span>the <span class="_ _3"></span>foreground <span class="_ _3"></span>process. <span class="_ _80"> </span>This<span class="_ _47"> </span>value <span class="_ _3"></span>can <span class="_ _3"></span>be <span class="_ _9"></span>set <span class="_ _9"></span>in <span class="_ _3"></span>the <span class="_ _9"></span>terminal</div><div class="t m0 x76 h52 y2735 ff19 fs2a fc0 sc0 ls0 ws0">driver with the<span class="_ _80"> </span><span class="ff1a">tcsetpgrp<span class="_ _e"> </span></span>function, as <span class="_ _2"></span>we show <span class="_ _2"></span>in Figur<span class="lsb48">e9<span class="_ _5"></span><span class="ls0">.9. <span class="_ _e"> </span>The<span class="_ _80"> </span>foregr<span class="_ _0"></span>ound process group</span></span></div><div class="t m0 x76 h51 y2736 ff19 fs2a fc0 sc0 ls0 ws0">ID is an <span class="_ _2"></span>attribute of the <span class="_ _2"></span>terminal, not the <span class="_ _2"></span>process. <span class="_"> </span>This<span class="_"> </span>value from the <span class="_ _2"></span>terminal device driver <span class="_ _2"></span>is</div><div class="t m0 x76 h52 y2737 ff19 fs2a fc0 sc0 ls0 ws0">what<span class="_"> </span><span class="ff1a">ps<span class="_ _e"> </span></span>prints as the TPGID.<span class="_ _44"> </span>If it ﬁnds that the session <span class="_ _2"></span>doesn’t have a controlling terminal,<span class="_"> </span><span class="ff1a">ps</span></div><div class="t m0 x76 h51 y2738 ff19 fs2a fc0 sc0 ls0 ws0">prints either 0 or<span class="_"> </span><span class="ff20">−</span>1, depending on the platform.</div><div class="t m0 x32 h2a y2739 ff19 fsf fc0 sc0 ls0 ws0">If we execute the command in the background,</div><div class="t m0 x3f h57 y273a ff1a fs2d fc0 sc0 ls0 ws0">ps -o pid,ppid,pgid,sid,comm &amp;</div><div class="t m0 x32 h2a y273b ff19 fsf fc0 sc0 ls0 ws0">the only value that changes is the process ID of the command:</div><div class="t m0 xf4 h57 y273c ff1a fs2d fc0 sc0 ls0 ws0">PID <span class="_"> </span>PPID <span class="_"> </span>PGID<span class="_ _68"> </span>SID COMMAND</div><div class="t m0 xf4 h57 y273d ff1a fs2d fc0 sc0 ls0 ws0">949 <span class="_ _d9"> </span>947 <span class="_ _3a"> </span>949 <span class="_ _3a"> </span>949<span class="_"> </span>sh</div><div class="t m0 x90 h57 y273e ff1a fs2d fc0 sc0 ls0 ws0">1812 <span class="_ _d9"> </span>949 <span class="_ _3a"> </span>949 <span class="_ _3a"> </span>949<span class="_"> </span>ps</div><a class="l" href="#pff" data-dest-detail='[15,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.891368px;bottom:1110.288916px;width:209.028290px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
