<div id="pf311" class="pf w4 h1f" data-page-no="311"><div class="pc pc311 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg311.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff19 fs0 fc0 sc0 ls0 ws0">Section <span class="_"> </span>20.5<span class="_ _311"> </span>Centralized <span class="_"> </span>or <span class="_"> </span>Decentralized?<span class="_ _1b"> </span><span class="ff18">751</span></div><div class="t m0 x3f h2a y12f ff19 fsf fc0 sc0 ls5f ws0">We <span class="_ _47"> </span>p<span class="_ _23"></span><span class="ls0">urposely <span class="_ _23"> </span>show <span class="_ _42"> </span>the <span class="_ _23"> </span>IPC <span class="_ _42"> </span>going <span class="_ _42"> </span>through <span class="_ _23"></span>the <span class="_ _23"> </span>kernel, <span class="_ _42"> </span>as <span class="_ _23"> </span>most <span class="_ _42"> </span>forms <span class="_ _42"> </span>of <span class="_ _23"> </span>message</span></div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">passing <span class="_ _53"> </span>under <span class="_ _53"> </span>the <span class="_ _53"> </span>UNIX <span class="_ _42"> </span>System <span class="_ _53"> </span>operate <span class="_ _53"> </span>this <span class="_ _53"> </span>way<span class="_ _6"></span><span class="ls1633">.(<span class="_ _52"></span><span class="ls0">Shar<span class="_ _0"></span>ed <span class="_ _53"> </span>memory<span class="_ _4"></span>,<span class="_ _4b"> </span>as<span class="_ _44"> </span>described <span class="_ _53"> </span>in</span></span></div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">Section 15.9, <span class="_ _2"></span>avoids <span class="_ _2"></span>this copying <span class="_ _2"></span>of <span class="_ _2"></span>the data.)<span class="_ _61"> </span><span class="ls65">Wi<span class="_ _3"></span></span>th <span class="_ _2"></span>the centralized <span class="_ _2"></span>approach, a <span class="_ _2"></span>recor<span class="_ _0"></span><span class="ls11e7">di<span class="_ _4f"></span><span class="ls0">s</span></span></div><div class="t m0 x32 h2a y132 ff19 fsf fc0 sc0 ls45 ws0">re<span class="ls0">ad <span class="_ _2"></span>by <span class="_ _2"></span>the <span class="_ _2"></span>central process <span class="_ _2"></span>and then <span class="_ _2"></span>passed <span class="_ _2"></span>to <span class="_ _2"></span>the <span class="_ _2"></span>requesting process using <span class="_ _2"></span>IPC.<span class="_ _46"> </span>This <span class="_ _2"></span>is</span></div><div class="t m0 x32 h2a y133 ff19 fsf fc0 sc0 ls420 ws0">ad<span class="_ _b"></span><span class="ls0">isadvantage <span class="_ _9"></span>of <span class="_ _9"></span>this <span class="_ _23"></span>design.<span class="_ _5a"> </span>Note <span class="_ _23"></span>that <span class="_ _9"></span>the <span class="_ _23"></span>centralized <span class="_ _9"></span>database <span class="_ _9"></span>manager <span class="_ _23"></span>is <span class="_ _9"></span>the <span class="_ _23"></span>only</span></div><div class="t m0 x32 h2a y134 ff19 fsf fc0 sc0 ls0 ws0">process that does I/O with the database ﬁles.</div><div class="t m0 x3f h2a y135 ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _23"></span>centralized <span class="_ _9"></span>approach <span class="_ _23"></span>has <span class="_ _23"></span>the <span class="_ _23"></span>advantage <span class="_ _9"></span>that <span class="_ _23"> </span>customer <span class="_ _23"> </span>tuning <span class="_ _23"></span>of <span class="_ _23"></span>its <span class="_ _23"></span>operation</div><div class="t m0 x32 h2a y136 ff19 fsf fc0 sc0 ls0 ws0">may <span class="_ _47"> </span>be <span class="_ _47"> </span>possible.<span class="_ _5f"> </span>For <span class="_ _45"> </span>example, <span class="_ _47"> </span>we <span class="_ _47"> </span>might <span class="_ _47"> </span>be <span class="_ _45"> </span>able <span class="_ _47"> </span>to <span class="_ _47"> </span>assign <span class="_ _47"> </span>different <span class="_ _66"> </span>priorities <span class="_ _45"> </span>to</div><div class="t m0 x32 h2a y137 ff19 fsf fc0 sc0 ls0 ws0">differ<span class="_ _0"></span>ent <span class="_ _3"></span>processes <span class="_ _2"></span>through <span class="_ _3"></span>the <span class="_ _3"></span>centralized <span class="_ _3"></span>process. <span class="_ _47"> </span>This<span class="_ _45"> </span>could <span class="_ _3"></span>affect <span class="_ _2"></span>the <span class="_ _9"></span>scheduling <span class="_ _3"></span>of</div><div class="t m0 x32 h2a y138 ff19 fsf fc0 sc0 ls0 ws0">I/O <span class="_ _e"> </span>operations <span class="_"> </span>by <span class="_ _53"> </span>the <span class="_"> </span>centralized <span class="_ _53"> </span>process. <span class="_ _4b"> </span>W<span class="_ _0"></span>ith <span class="_ _e"> </span>the <span class="_ _e"> </span>decentralized <span class="_"> </span>appr<span class="_ _0"></span>oach, <span class="_ _e"> </span>this <span class="_ _e"> </span>is</div><div class="t m0 x32 h2a y139 ff19 fsf fc0 sc0 ls0 ws0">mor<span class="ls4aa">ed<span class="_ _43"></span><span class="ls0">ifﬁcult <span class="_ _9"></span>to <span class="_ _23"> </span>do.<span class="_ _51"> </span><span class="ls5f">We <span class="_ _47"> </span>a<span class="_ _9"></span><span class="ls45">re <span class="_ _42"> </span>u<span class="_ _2"></span></span></span>sually <span class="_ _23"> </span>at <span class="_ _23"> </span>the <span class="_ _23"></span>mercy <span class="_ _9"></span>of <span class="_ _23"> </span>the <span class="_ _23"> </span>kernel’s <span class="_ _23"> </span>disk <span class="_ _23"> </span>I/O <span class="_ _23"></span>scheduling</span></span></div><div class="t m0 x32 h2a y13a ff19 fsf fc0 sc0 ls0 ws0">policy <span class="_ _42"> </span>and <span class="_ _23"> </span>locking <span class="_ _42"> </span>policy; <span class="_ _42"> </span>that <span class="_ _42"> </span>is, <span class="_ _42"> </span>if <span class="_ _42"> </span>three <span class="_ _23"></span>processes <span class="_ _23"> </span>ar<span class="ls1634">ew<span class="_ _43"></span><span class="ls0">aiting <span class="_ _23"> </span>for <span class="_ _42"> </span>a <span class="_ _42"> </span>lock <span class="_ _42"> </span>to <span class="_ _23"> </span>become</span></span></div><div class="t m0 x32 h2a y254 ff19 fsf fc0 sc0 ls0 ws0">available, we cannot tell which process gets the lock next.</div><div class="t m0 x3f h2a y255 ff19 fsf fc0 sc0 ls0 ws0">Another <span class="_ _9"></span>advantage <span class="_ _9"></span>of <span class="_ _9"></span>the <span class="_ _3"></span>centralized <span class="_ _9"></span>approach <span class="_ _9"></span>is <span class="_ _9"></span>that <span class="_ _9"></span>recovery <span class="_ _3"></span>is <span class="_ _9"></span>easier <span class="_ _9"></span>than <span class="_ _9"></span>with</div><div class="t m0 x32 h2a y13b ff19 fsf fc0 sc0 ls0 ws0">the <span class="_ _3"></span>decentralized <span class="_ _9"></span>approach. <span class="_ _47"> </span>All<span class="_ _45"> </span>the <span class="_ _9"></span>state <span class="_ _3"></span>information <span class="_ _9"></span>is <span class="_ _9"></span>in <span class="_ _9"></span>one <span class="_ _3"></span>place <span class="_ _9"></span>in <span class="_ _9"></span>the <span class="_ _3"></span>centralized</div><div class="t m0 x32 h2a y13c ff19 fsf fc0 sc0 ls0 ws0">approach, <span class="_ _42"> </span>so <span class="_ _53"> </span>if <span class="_ _42"> </span>the <span class="_ _53"> </span>database <span class="_ _53"> </span>processes <span class="_ _42"> </span>ar<span class="lsa4">ek<span class="_ _c"></span><span class="ls0">illed, <span class="_ _53"> </span>we <span class="_ _42"> </span>have <span class="_ _53"> </span>only <span class="_ _53"> </span>one <span class="_ _53"> </span>place <span class="_ _53"> </span>to <span class="_ _42"> </span>look <span class="_ _53"> </span>to</span></span></div><div class="t m0 x32 h2a y256 ff19 fsf fc0 sc0 ls0 ws0">identify <span class="_ _42"> </span>the <span class="_ _53"> </span>outstanding <span class="_ _42"> </span>transactions <span class="_ _53"> </span>we <span class="_ _42"> </span>need <span class="_ _53"> </span>to <span class="_ _42"> </span>resolve <span class="_ _42"> </span>to <span class="_ _42"> </span>restor<span class="ls1635">et<span class="_ _c"></span><span class="ls0">he <span class="_ _42"> </span>database <span class="_ _53"> </span>to <span class="_ _42"> </span>a</span></span></div><div class="t m0 x32 h2a y257 ff19 fsf fc0 sc0 ls0 ws0">consistent state.</div><div class="t m0 x3f h2a y258 ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _23"></span>decentralized <span class="_ _23"> </span>approach <span class="_ _23"></span>is <span class="_ _23"></span>shown <span class="_ _23"></span>in <span class="_ _23"></span>Figur<span class="ls1636">e2<span class="_ _43"></span><span class="ls0">0.5. <span class="_ _35"> </span>This<span class="_ _35"> </span>is <span class="_ _23"></span>the <span class="_ _23"></span>design <span class="_ _23"></span>that <span class="_ _23"> </span>we’ll</span></span></div><div class="t m0 x32 h2a y161 ff19 fsf fc0 sc0 ls0 ws0">implement in this chapter<span class="_ _6"></span>.</div><div class="t m0 x22d h2d y563d ff19 fs10 fc0 sc0 ls21d ws0">re<span class="ls0">cor<span class="ls136">dl<span class="_ _84"></span><span class="ls0">ocking</span></span></span></div><div class="t m0 xdb h2e y563e ff19 fs11 fc0 sc0 ls0 ws0">I/O</div><div class="t m0 x13d h2f y563f ff19 fs12 fc0 sc0 ls0 ws0">kernel</div><div class="t m0 xa5 h30 y5640 ff19 fs13 fc0 sc0 ls0 ws0">index ﬁle</div><div class="t m0 x109 h31 y5641 ff19 fs14 fc0 sc0 ls0 ws0">data ﬁle</div><div class="t m0 x10c h34 y5642 ff19 fs17 fc0 sc0 ls0 ws0">db access</div><div class="t m0 xd0 h34 y5643 ff19 fs17 fc0 sc0 ls0 ws0">library</div><div class="t m0 xf6 h34 y5644 ff19 fs17 fc0 sc0 ls0 ws0">user process</div><div class="t m0 x158 h35 y5645 ff19 fs18 fc0 sc0 ls0 ws0">db access</div><div class="t m0 x164 h35 y5646 ff19 fs18 fc0 sc0 ls0 ws0">library</div><div class="t m0 x12d h35 y5647 ff19 fs18 fc0 sc0 ls0 ws0">user process</div><div class="t m0 x1ce h3e y5648 ff18 fs20 fc0 sc0 ls0 ws0">Figure 20.5<span class="_ _5a"> </span><span class="ff19">Decentralized approach for database access</span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
