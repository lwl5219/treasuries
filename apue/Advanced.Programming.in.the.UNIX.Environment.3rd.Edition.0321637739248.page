<div id="pff8" class="pf w4 h1f" data-page-no="f8"><div class="pc pcf8 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bgf8.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">214<span class="_ _1b"> </span><span class="ff19">Process <span class="_"> </span>Envir<span class="_ _0"></span>onment <span class="_ _1c1"> </span>Chapter<span class="_ _44"> </span>7</span></div><div class="t m0 x32 h57 y362 ff1a fs2d fc0 sc0 ls0 ws0">#include &quot;apue.h&quot;</div><div class="t m0 x32 h57 y1cc1 ff1a fs2d fc0 sc0 ls0 ws0">#define TOK_ADD<span class="_ _15"> </span>5</div><div class="t m0 x32 h57 y3c2 ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _68"> </span>do_line(char<span class="_"> </span>*);</div><div class="t m0 x32 h57 y3c3 ff1a fs2d fc0 sc0 ls0 ws0">void <span class="_ _68"> </span>cmd_add(void);</div><div class="t m0 x32 h57 y3c4 ff1a fs2d fc0 sc0 ls0 ws0">int <span class="_ _15"> </span>get_token(void);</div><div class="t m0 x32 h57 y1cc2 ff1a fs2d fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 h57 y1cc3 ff1a fs2d fc0 sc0 ls0 ws0">main(void)</div><div class="t m0 x32 h57 y1cc4 ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y1cc5 ff1a fs2d fc0 sc0 ls0 ws0">char <span class="_ _68"> </span>line[MAXLINE];</div><div class="t m0 x8a h57 y3ca ff1a fs2d fc0 sc0 ls0 ws0">while (fgets(line, MAXLINE, stdin) != NULL)</div><div class="t m0 x9d h57 y1cc6 ff1a fs2d fc0 sc0 ls0 ws0">do_line(line);</div><div class="t m0 x8a h57 y1cc7 ff1a fs2d fc0 sc0 ls0 ws0">exit(0);</div><div class="t m0 x32 h57 y1cc8 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y1cc9 ff1a fs2d fc0 sc0 ls0 ws0">char <span class="_ _68"> </span>*tok_ptr;<span class="_ _90"> </span>/* global pointer for get_token() */</div><div class="t m0 x32 h57 y3d0 ff1a fs2d fc0 sc0 ls0 ws0">void</div><div class="t m0 x32 h57 y3d1 ff1a fs2d fc0 sc0 ls0 ws0">do_line(char *ptr)<span class="_ _189"> </span>/* process one line of input */</div><div class="t m0 x32 h57 y1cca ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y1ccb ff1a fs2d fc0 sc0 ls0 ws0">int <span class="_ _15"> </span>cmd;</div><div class="t m0 x8a h57 y1ccc ff1a fs2d fc0 sc0 ls0 ws0">tok_ptr = ptr;</div><div class="t m0 x8a h57 y1ccd ff1a fs2d fc0 sc0 ls0 ws0">while ((cmd = get_token()) &gt; 0) {</div><div class="t m0 x9d h57 y1cce ff1a fs2d fc0 sc0 ls0 ws0">switch (cmd) {<span class="_ _d9"> </span>/* one case for each command */</div><div class="t m0 x9d h57 y1ccf ff1a fs2d fc0 sc0 ls0 ws0">case TOK_ADD:</div><div class="t m0 x1ca h57 y1cd0 ff1a fs2d fc0 sc0 ls0 ws0">cmd_add();</div><div class="t m0 x1ca h57 y1cd1 ff1a fs2d fc0 sc0 ls0 ws0">break;</div><div class="t m0 x9d h57 y1cd2 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x8a h57 y1cd3 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y1cd4 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y1cd5 ff1a fs2d fc0 sc0 ls0 ws0">void</div><div class="t m0 x32 h57 y1cd6 ff1a fs2d fc0 sc0 ls0 ws0">cmd_add(void)</div><div class="t m0 x32 h57 y1cd7 ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y1cd8 ff1a fs2d fc0 sc0 ls0 ws0">int <span class="_ _15"> </span>token;</div><div class="t m0 x8a h57 y1cd9 ff1a fs2d fc0 sc0 ls0 ws0">token = get_token();</div><div class="t m0 x8a h57 y1cda ff1a fs2d fc0 sc0 ls0 ws0">/* rest of processing for this command */</div><div class="t m0 x32 h57 y1cdb ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 x32 h57 y1cdc ff1a fs2d fc0 sc0 ls0 ws0">int</div><div class="t m0 x32 h57 y1cdd ff1a fs2d fc0 sc0 ls0 ws0">get_token(void)</div><div class="t m0 x32 h57 y1cde ff1a fs2d fc0 sc0 ls0 ws0">{</div><div class="t m0 x8a h57 y1cdf ff1a fs2d fc0 sc0 ls0 ws0">/* fetch next token from line pointed to by tok_ptr */</div><div class="t m0 x32 h57 y1ce0 ff1a fs2d fc0 sc0 ls0 ws0">}</div><div class="t m0 xe7 h2d y1ce1 ff18 fs10 fc0 sc0 ls0 ws0">Figure 7.9<span class="_ _5a"> </span><span class="ff19 ls277">Ty<span class="_ _9"></span><span class="ls0">pical program skeleton for command pr<span class="_ _0"></span>ocessing</span></span></div></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
