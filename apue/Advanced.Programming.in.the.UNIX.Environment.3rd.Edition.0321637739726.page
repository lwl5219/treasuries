<div id="pf2d6" class="pf w4 h1f" data-page-no="2d6"><div class="pc pc2d6 w4 h1f"><img class="bi x0 y0 w3 h4" alt="" src="apue/bg2d6.png"/><div class="t m0 x31 h2 y8e ff1 fs0 fc0 sc0 ls0 ws0"><span class="fc1 sc0">ptg10805159</span></div><div class="t m0 x35 h24 ya4 ff18 fs0 fc0 sc0 ls0 ws0">692<span class="_ _1b"> </span><span class="ff19 ls719">Te<span class="_ _9"></span><span class="ls0">rminal <span class="_"> </span>I/O<span class="_ _eb"> </span>Chapter <span class="_"> </span>18</span></span></div><div class="t m0 x32 h2a y12f ff19 fsf fc0 sc0 ls0 ws0">Option <span class="_"> </span>names <span class="_"> </span>preceded <span class="_"> </span>by <span class="_"> </span>a <span class="_"> </span>hyphen <span class="_"> </span>ar<span class="_ _1"></span><span class="ls14db">ed<span class="_ _4a"></span><span class="ls0">isabled. <span class="_ _46"> </span>The<span class="_ _46"> </span>last <span class="_"> </span>four <span class="_"> </span>lines <span class="_"> </span>display <span class="_"> </span>the</span></span></div><div class="t m0 x32 h2a y130 ff19 fsf fc0 sc0 ls0 ws0">current <span class="_ _3"></span>settings <span class="_ _9"></span>for <span class="_ _23"></span>each <span class="_ _3"></span>of <span class="_ _23"></span>the <span class="_ _9"></span>terminal <span class="_ _9"></span>special <span class="_ _9"></span>characters <span class="_ _9"></span>(Section <span class="_ _9"></span>18.3).<span class="_ _5a"> </span>The <span class="_ _9"></span>ﬁrst <span class="_ _9"></span>line</div><div class="t m0 x32 h2a y131 ff19 fsf fc0 sc0 ls0 ws0">displays <span class="_ _2"></span>the <span class="_ _3"></span>number <span class="_ _2"></span>of <span class="_ _3"></span>rows <span class="_ _2"></span>and <span class="_ _2"></span>columns <span class="_ _3"></span>for <span class="_ _3"></span>the <span class="_ _2"></span>current <span class="_ _2"></span>terminal <span class="_ _3"></span>window; <span class="_ _2"></span>we <span class="_ _3"></span>discuss</div><div class="t m0 x32 h2a y132 ff19 fsf fc0 sc0 ls0 ws0">the terminal window size in Section 18.12.</div><div class="t m0 x76 h52 y50a2 ff19 fs2a fc0 sc0 ls0 ws0">The<span class="_"> </span><span class="ff1a">stty<span class="_ _80"> </span></span>command <span class="_ _2"></span>uses its <span class="_ _2"></span>standar<span class="ls14dc">di<span class="_ _5"></span><span class="ls0">nput <span class="_ _2"></span>to get <span class="_ _2"></span>and <span class="_ _2"></span>set <span class="_ _2"></span>the <span class="_ _2"></span>terminal option <span class="_ _2"></span>ﬂags.<span class="_ _44"> </span>Although</span></span></div><div class="t m0 x76 h51 y50a3 ff19 fs2a fc0 sc0 ls0 ws0">some <span class="_ _9"></span>older <span class="_ _3"></span>implementations <span class="_ _9"> </span>used <span class="_ _9"></span>standar<span class="ls14dd">do<span class="_ _4f"></span><span class="ls0">utput, <span class="_ _9"></span>POSIX.1 <span class="_ _9"></span>requir<span class="_ _0"></span>es <span class="_ _9"></span>that <span class="_ _3"></span>the <span class="_ _9"></span>standar<span class="ls14dd">di<span class="_ _4f"></span><span class="ls0">nput</span></span></span></span></div><div class="t m0 x76 h52 y50a4 ff19 fs2a fc0 sc0 ls0 ws0">be used.<span class="_ _44"> </span>All four implementations <span class="_ _2"></span>discussed in this <span class="_ _2"></span>text provide versions of<span class="_ _e"> </span><span class="ff1a">stty<span class="_ _80"> </span></span>that operate</div><div class="t m0 x76 h51 y50a5 ff19 fs2a fc0 sc0 ls0 ws0">on the standar<span class="lse9">di<span class="_ _5"></span><span class="ls0">nput. <span class="_"> </span>This<span class="_"> </span>means that we can type</span></span></div><div class="t m0 x38 h52 y50a6 ff1a fs2a fc0 sc0 ls0 ws0">stty -a &lt;/dev/tty1a</div><div class="t m0 x76 h52 y50a7 ff19 fs2a fc0 sc0 ls0 ws0">if we ar<span class="lse9">ei<span class="_ _5"></span><span class="ls0">nterested in discovering the settings on the terminal named<span class="_"> </span><span class="ff1a">tty1a</span>.</span></span></div><div class="t m0 x35 h53 y50a8 ff16 fs2b fc0 sc0 ls0 ws0">18.7 <span class="_ _93"> </span>Baud<span class="_ _54"> </span>Rate <span class="_"> </span>Functions</div><div class="t m0 x32 h2b y4040 ff19 fsf fc0 sc0 ls0 ws0">The <span class="_ _53"> </span>term<span class="_ _4b"> </span><span class="ff1b">baud <span class="_ _53"> </span>rate<span class="_ _4b"> </span></span>is <span class="_ _53"> </span>a <span class="_ _e"> </span>historical <span class="_ _53"> </span>term <span class="_ _e"> </span>that <span class="_ _53"> </span>should <span class="_ _e"> </span>be <span class="_ _53"> </span>referred <span class="_ _42"> </span>to <span class="_ _53"> </span>today <span class="_ _e"> </span>as <span class="_ _53"> </span>‘‘bits <span class="_ _42"> </span>per</div><div class="t m0 x32 h2a y4041 ff19 fsf fc0 sc0 ls0 ws0">second.’<span class="_ _0"></span><span class="ls14de">’A<span class="_ _7"></span><span class="ls0">lthough <span class="_ _23"> </span>most <span class="_ _23"> </span>terminal <span class="_ _23"> </span>devices <span class="_ _42"> </span>use <span class="_ _23"></span>the <span class="_ _23"> </span>same <span class="_ _23"> </span>baud <span class="_ _23"> </span>rate <span class="_ _42"> </span>for <span class="_ _23"></span>both <span class="_ _23"></span>input <span class="_ _23"> </span>and</span></span></div><div class="t m0 x32 h2a y50a9 ff19 fsf fc0 sc0 ls0 ws0">output, <span class="_ _53"> </span>the <span class="_ _53"> </span>capability <span class="_ _e"> </span>exists <span class="_ _53"> </span>to <span class="_ _e"> </span>set <span class="_ _53"> </span>the <span class="_ _53"> </span>two <span class="_ _e"> </span>rates <span class="_ _53"> </span>to <span class="_ _e"> </span>differ<span class="_ _0"></span>ent <span class="_ _53"> </span>values, <span class="_ _53"> </span>if <span class="_ _e"> </span>the <span class="_ _53"> </span>hardware</div><div class="t m0 x32 h2a y50aa ff19 fsf fc0 sc0 ls0 ws0">allows this.</div><div class="t m0 x3f h57 y50ab ff1a fs2d fc0 sc0 ls0 ws0">#include &lt;termios.h&gt;</div><div class="t m0 x3f h57 y50ac ff1a fs2d fc0 sc0 ls0 ws0">speed_t cfgetispeed(const struct termios *<span class="ff1b">termptr</span>);</div><div class="t m0 x3f h57 y50ad ff1a fs2d fc0 sc0 ls0 ws0">speed_t cfgetospeed(const struct termios *<span class="ff1b">termptr</span>);</div><div class="t m0 x153 h5f y50ae ff19 fs2d fc0 sc0 ls0 ws0">Both return: baud rate value</div><div class="t m0 x3f h57 y50af ff1a fs2d fc0 sc0 ls0 ws0">int cfsetispeed(struct termios *<span class="ff1b">termptr</span><span class="ls15c">,s<span class="_ _1d"></span><span class="ls0">peed_t<span class="_"> </span><span class="ff1b">speed</span>);</span></span></div><div class="t m0 x3f h57 y50b0 ff1a fs2d fc0 sc0 ls0 ws0">int cfsetospeed(struct termios *<span class="ff1b">termptr</span><span class="ls15c">,s<span class="_ _1d"></span><span class="ls0">peed_t<span class="_"> </span><span class="ff1b">speed</span>);</span></span></div><div class="t m0 x1af h5f y50b1 ff19 fs2d fc0 sc0 ls0 ws0">Both return: 0 if OK,<span class="_"> </span><span class="ff20">−</span>1<span class="_"> </span>on<span class="_"> </span>err<span class="_ _0"></span>or</div><div class="t m0 x32 h4d y50b2 ff19 fs26 fc0 sc0 ls0 ws0">The <span class="_ _53"> </span>return <span class="_ _53"> </span>value <span class="_ _e"> </span>from <span class="_ _53"> </span>the <span class="_ _53"> </span>two<span class="_ _4b"> </span><span class="ff1a">cfget<span class="_ _4b"> </span></span>functions <span class="_ _e"> </span>and <span class="_ _53"> </span>the<span class="_ _4b"> </span><span class="ff1b">speed<span class="_ _4b"> </span></span>argument <span class="_ _53"> </span>to <span class="_ _e"> </span>the <span class="_ _53"> </span>two</div><div class="t m0 x32 h4d y50b3 ff1a fs26 fc0 sc0 ls0 ws0">cfset<span class="_ _80"> </span><span class="ff19">functions ar<span class="lsfcc">eo<span class="_ _d"></span><span class="ls0">ne of the following constants:<span class="_"> </span><span class="ff1a">B50</span>,<span class="_"> </span><span class="ff1a">B75</span>,<span class="_"> </span><span class="ff1a">B110</span>,<span class="_"> </span><span class="ff1a">B134</span>,<span class="_"> </span><span class="ff1a">B150</span>,<span class="_"> </span><span class="ff1a">B200</span>,</span></span></span></div><div class="t m0 x32 h4d y50b4 ff1a fs26 fc0 sc0 ls0 ws0">B300<span class="ff19">,<span class="_ _66"> </span></span>B600<span class="ff19">,<span class="_ _47"> </span></span>B1200<span class="ff19">,<span class="_ _47"> </span></span>B1800<span class="ff19">,<span class="_ _66"> </span></span>B2400<span class="ff19">,<span class="_ _47"> </span></span>B4800<span class="ff19">,<span class="_ _47"> </span></span>B9600<span class="ff19">,<span class="_ _66"> </span></span>B19200<span class="ff19 ls13e3">,o<span class="_ _4f"></span><span class="ls0">r<span class="_ _47"> </span><span class="ff1a">B38400</span><span class="ls5b7">.T<span class="_ _1d"></span><span class="ls0">he <span class="_ _3"></span>constant</span></span></span></span></div><div class="t m0 x32 h4d y50b5 ff1a fs26 fc0 sc0 ls0 ws0">B0<span class="_ _35"> </span><span class="ff19">means <span class="_ _23"></span>‘<span class="_ _1"></span>‘hang <span class="_ _23"> </span>up.’<span class="ls14df">’I<span class="_ _7"></span><span class="ls0">f<span class="_ _35"> </span><span class="ff1a">B0<span class="_ _35"> </span></span>is <span class="_ _23"></span>speciﬁed <span class="_ _23"></span>as <span class="_ _23"></span>the <span class="_ _23"></span>output <span class="_ _23"></span>baud <span class="_ _23"></span>rate <span class="_ _23"></span>when<span class="_ _35"> </span><span class="ff1a">tcsetattr<span class="_ _45"> </span></span>is</span></span></span></div><div class="t m0 x32 h49 y50b6 ff19 fs26 fc0 sc0 ls0 ws0">called, the modem control lines ar<span class="_ _0"></span>e<span class="_"> </span>no<span class="_"> </span>longer asserted.</div><div class="t m0 x76 h5e y50b7 ff19 fs10 fc0 sc0 ls0 ws0">Most systems deﬁne additional baud rate values, such as<span class="_"> </span><span class="ff1a">B57600<span class="_ _53"> </span></span>and<span class="_"> </span><span class="ff1a">B115200</span>.</div><div class="t m0 x3f h49 y50b8 ff19 fs26 fc0 sc0 ls164 ws0">To <span class="_ _45"> </span>u<span class="_ _9"></span><span class="ls0">se <span class="_ _23"> </span>these <span class="_ _42"> </span>functions, <span class="_ _42"> </span>we <span class="_ _42"> </span>must <span class="_ _23"> </span>realize <span class="_ _23"> </span>that <span class="_ _42"> </span>the <span class="_ _42"> </span>input <span class="_ _42"> </span>and <span class="_ _23"> </span>output <span class="_ _42"> </span>baud <span class="_ _42"> </span>rates <span class="_ _23"> </span>are</span></div><div class="t m0 x32 h4d y50b9 ff19 fs26 fc0 sc0 ls0 ws0">stored in <span class="_ _3"></span>the <span class="_ _3"></span>device’s<span class="_ _66"> </span><span class="ff1a">termios<span class="_ _47"> </span></span>structure, <span class="_ _2"></span>as <span class="_ _2"></span>shown <span class="_ _3"></span>in <span class="_ _2"></span>Figur<span class="ls14e0">e1<span class="_ _4f"></span><span class="ls0">8.8. <span class="_ _66"> </span>Befor<span class="ls14e0">ec<span class="_ _4f"></span><span class="ls0">alling <span class="_ _2"></span>either</span></span></span></span></div><div class="t m0 x32 h4d y50ba ff19 fs26 fc0 sc0 ls0 ws0">of <span class="_ _23"> </span>the<span class="_ _35"> </span><span class="ff1a">cfget<span class="_ _35"> </span></span>functions, <span class="_ _23"> </span>we <span class="_ _23"> </span>ﬁrst <span class="_ _42"> </span>have <span class="_ _23"></span>to <span class="_ _23"> </span>obtain <span class="_ _23"> </span>the <span class="_ _42"> </span>device’s<span class="_ _35"> </span><span class="ff1a">termios<span class="_ _35"> </span></span>structur<span class="_ _1"></span><span class="ls14e1">eu<span class="_ _b"></span><span class="ls0">sing</span></span></div><div class="t m0 x32 h4d y50bb ff1a fs26 fc0 sc0 ls0 ws0">tcgetattr<span class="ff19 ls14e2">.S<span class="_ _5b"></span><span class="ls0">imilarly<span class="_ _6"></span><span class="ls14e3">,a<span class="_ _4f"></span><span class="ls0">fter <span class="_ _2"></span>calling either <span class="_ _2"></span>of the <span class="_ _2"></span>two<span class="_"> </span><span class="ff1a">cfset<span class="_ _66"> </span></span>functions, all <span class="_ _2"></span>we’ve done <span class="_ _2"></span>is</span></span></span></span></div><div class="t m0 x32 h4d y50bc ff19 fs26 fc0 sc0 ls0 ws0">set <span class="_ _3"></span>the <span class="_ _3"></span>baud <span class="_ _3"></span>rate <span class="_ _3"></span>in <span class="_ _3"></span>a<span class="_ _47"> </span><span class="ff1a">termios<span class="_ _45"> </span></span>structur<span class="_ _0"></span>e. <span class="_ _47"> </span>For<span class="_ _47"> </span>this <span class="_ _3"></span>change <span class="_ _3"></span>to <span class="_ _3"></span>affect <span class="_ _3"></span>the <span class="_ _3"></span>device, <span class="_ _3"></span>we <span class="_ _3"></span>have</div><div class="t m0 x32 h4d y50bd ff19 fs26 fc0 sc0 ls0 ws0">to <span class="_ _9"></span>call<span class="_ _45"> </span><span class="ff1a">tcsetattr</span><span class="ls14e4">.I<span class="_ _26"></span><span class="ls14e5">ft<span class="_ _8"></span><span class="ls0">here<span class="_ _47"> </span>is<span class="_ _45"> </span>an<span class="_ _45"> </span>error <span class="_ _3"></span>in <span class="_ _9"></span>either <span class="_ _9"></span>of <span class="_ _3"></span>the <span class="_ _9"></span>baud <span class="_ _9"></span>rates <span class="_ _9"></span>that <span class="_ _9"></span>we <span class="_ _9"></span>set, <span class="_ _9"></span>we <span class="_ _9"></span>may</span></span></span></div><div class="t m0 x32 h4d y50be ff19 fs26 fc0 sc0 ls0 ws0">not ﬁnd out about the error until we call<span class="_"> </span><span class="ff1a">tcsetattr</span>.</div><a class="l" href="#pf13" data-dest-detail='[19,"XYZ",50,757,1]'><div class="d m1" style="border-style:none;position:absolute;left:80.890952px;bottom:925.488916px;width:162.683487px;height:19.679993px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[2.100000,0.000000,0.000000,2.100000,-115.668004,-156.491993]}'></div></div>
